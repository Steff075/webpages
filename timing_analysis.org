#+OPTIONS:    H:3 num:t toc:t \n:nil ::t |:t ^:t -:t f:t *:t tex:t d:(HIDE) tags:not-in-toc
#+STARTUP:    align fold nodlcheck hidestars oddeven lognotestate
#+SEQ_TODO:   TODO(t) INPROGRESS(i) WAITING(w@) | DONE(d) CANCELED(c@)
#+TAGS:       Write(w) Update(u) Fix(f) Check(c)
#+TITLE:      AGN Timing Analysis: the lag-frequency
#+AUTHOR:     Stephen Hancock
#+EMAIL:      steff.hancock@bristol.ac.uk
#+LANGUAGE:   enX1
#+PRIORITIES: A C B1
#+CATEGORY:   timing analysis

* The lag frequency overview

http://www.star.bris.ac.uk/steff/lags_explained.png

* Old Results
** Explore 1H0707-495 lags at different frequencies

Use =/home/steff075/phd_ecm/1h0707/lagfreq_multi_freq_script.sl=

Lets look at  the following 5 frequencies with 12 lags each:

9e-6, 2.0e-5, 5.0e-5, 8.0e-5, 1.0e-4

Lags in file =timelag-various-freq.ods= and associated csv'

Plot in Veusz =/home/steff075/phd_ecm/1h0707/1H0707-lag-results-various.vsz=

http://www.star.bris.ac.uk/steff/ecm/1H0707-lag-results-various.png

** All Lag results Combined overview

Use =/home/steff075/phd_ecm/results/lagfreq-results-lo-hi.csv=

Lets look at  ALL Combined lags

Plot in Veusz =/home/steff075/phd_ecm/results/lag-results-multi-AGN.vsz=

http://www.star.bris.ac.uk/steff/ecm/lag-results-multi-AGN.png

** Lags V black hole mass

Use =home/steff075/phd_ecm/results-lagfreq/ALL-AGN-flux-mass-lags-hi-lo.ods=
or the associated csv. A spreadsheet of the results and be found at:

http://www.star.bris.ac.uk/steff/ecm/ALL-AGN-flux-mass-lags-hi-lo.ods

Note that NGC6860 and PG1247+267 have only one observation hance do
not appear in the lo and hi flux graphs.


*Plot in Veusz* =home/steff075/phd_ecm/results/ALL-AGN-lag-V-LogM-hi-lo.vsz=

*Composite view* (combined, lo-flux and hi-flux):

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/ALL-AGN-lag-V-LogM-hi-lo.png

*Combined*

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/ALL-AGN-lag-V-LogM-combined.png

*Lo-flux*
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/ALL-AGN-lag-V-LogM-lo-flux.png

*Hi-flux*
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/ALL-AGN-lag-V-LogM-hi-flux.png

** Lags V black hole mass: Redshifted

*Combined redshifted*

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/ALL-AGN-lag-V-LogM-combined-Z.png

*Composite redshifted* (combined, lo-flux and hi-flux):
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/ALL-AGN-lag-V-LogM-hi-lo-Z.png

** Frequency V black hole mass: Redsifted

Again- use
=/home/steff075/phd_ecm/results-lag-freq/ALL-AGN-flux-mass-lags-hi-lo.ods=

Plotting with Veusz
=/home/steff075/phd_ecm/results-lag-freq/ALL-AGN-Frequency-V-LogM-hi-lo.vsz=

*Composite redshifted Frequency V M*

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/ALL-AGN-Frequency-V-LogM-composite.png

*Combined redshifted Frequency V M*

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/ALL-AGN-Frequency-V-LogM-combined.png


*Lo-flux redshifted Frequency V M*

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/ALL-AGN-Frequency-V-LogM-lo.png

*Hi-flux redshifted Frequency V M*

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/ALL-AGN-Frequency-V-LogM-hi.png

** Lag Energy

*** 1H0707-495

PATH =phd_ecm/1h0707/lagen-results.vsz=


#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495-lagen-results.png

* *New results from April 2021*
** Lags found

PATH =
=/home/steff075/phd_ecm/results-spectral/results-Final-spectra.csv=

| Data1                  | Lit-LogM |     + |     - |       z |    L_Edd | L_bol/erg s-1 | Log_Lbol | Edd Ratio | NED DL /cm | Soft-lag |       +- | Soft-lag-freq |           +- | total_counts |
| 1H0707-comb            |     6.31 |   0.5 |   0.5 |  0.0411 | 2.57E+44 |      2.69E+44 |     44.4 |      1.05 |   5.77E+26 | 2.92E+01 | 3.63E+00 |      1.55E-03 |     4.75E-04 |     4.10E+06 |
| 1H0707-hi              |     6.31 |   0.5 |   0.5 |  0.0411 | 2.57E+44 |      2.69E+44 |     44.4 |      1.05 |   5.77E+26 |    29.05 |    3.818 |      1.55E-03 |     0.000483 |     3.94E+06 |
| 1H0707-hi-cts>20       |     6.31 |   0.5 |   0.5 |  0.0411 | 2.57E+44 |      2.69E+44 |     44.4 |      1.05 |   5.77E+26 | 2.45E+01 |     7.75 |      9.66E-04 |     3.02E-04 |     1.85E+06 |
| 1H0707-med             |     6.31 |   0.5 |   0.5 |  0.0411 | 2.57E+44 |      2.69E+44 |     44.4 |      1.05 |   5.77E+26 | 3.54E+01 | 2.68E+01 |      1.01E-03 |     3.16E-04 |     1.13E+05 |
| 1H0707-lo              |     6.31 |   0.5 |   0.5 |  0.0411 | 2.57E+44 |      2.69E+44 |     44.4 |      1.05 |   5.77E+26 |    74.59 |    36.84 |      1.55E-03 | 0.0004830296 |     5.14E+04 |
| 1H0707-lo-cts<20       |     6.31 |   0.5 |   0.5 |  0.0411 | 2.57E+44 |      2.69E+44 |     44.4 |      1.05 |   5.77E+26 | 2.60E+01 | 4.97E+00 |      1.84E-03 |     5.76E-04 |     2.14E+06 |
| Ark564-comb            |     6.27 |   0.5 |   0.5 |   0.024 | 2.35E+44 |      2.29E+44 |     44.4 |     0.976 |   3.27E+26 |     36.2 |     10.5 |      6.07E-04 |      0.00019 |     1.71E+07 |
| Ark564-hi              |     6.27 |   0.5 |   0.5 |   0.024 | 2.35E+44 |      2.29E+44 |     44.4 |     0.976 |   3.27E+26 |     61.1 |     19.3 |      6.07E-04 |      0.00019 |     7.76E+06 |
| Ark564-lo              |     6.27 |   0.5 |   0.5 |   0.024 | 2.35E+44 |      2.29E+44 |     44.4 |     0.976 |   3.27E+26 |     15.6 |      5.6 |      2.21E-03 |     0.000692 |     6.42E+05 |
| IRAS-comb+2016-obs     |     6.28 |   0.2 |   0.2 |  0.0406 | 7.95E+44 |      5.50E+45 |     45.7 |      6.91 |   9.57E+26 | 3.93E+01 | 9.64E+00 |      5.06E-04 |     1.58E-04 |     2.21E+06 |
| IRAS-hi+2016+obs       |     6.28 |   0.2 |   0.2 |  0.0406 | 7.95E+44 |      5.50E+45 |     45.7 |      6.91 |   9.57E+26 | 4.37E+01 | 2.40E+01 |      5.06E-04 |     1.58E-04 |     5.38E+05 |
| IRAS-hi-cts>20         |     6.28 |   0.2 |   0.2 |  0.0406 | 7.95E+44 |      5.50E+45 |     45.7 |      6.91 |   9.57E+26 | 4.06E+01 | 6.28E+00 |      9.66E-04 |     1.58E-04 |     1.72E+06 |
| IRAS-med+2016+obs      |     6.28 |   0.2 |   0.2 |  0.0406 | 7.95E+44 |      5.50E+45 |     45.7 |      6.91 |   9.57E+26 | 3.77E+01 | 1.15E+01 |      5.06E-04 |     1.58E-04 |     1.47E+06 |
| IRAS-lo+2016+obs       |     6.28 |   0.2 |   0.2 |  0.0406 | 7.95E+44 |      5.50E+45 |     45.7 |      6.91 |   9.57E+26 | 6.70E+01 | 1.12E+01 |      9.66E-04 |     3.02E-04 |     1.96E+05 |
| IRAS-lo-cts<20         |     6.28 |   0.2 |   0.2 |  0.0406 | 7.95E+44 |      5.50E+45 |     45.7 |      6.91 |   9.57E+26 | 3.84E+01 | 1.33E+01 |      5.06E-04 |     1.58E-04 |     1.84E+06 |
| MCG-6-30-15-comb       |    6.295 | 0.157 | 0.237 | 0.00775 | 2.51E+44 |      1.20E+44 |     44.1 |     0.478 |   1.19E+26 |     15.9 |      5.9 |      9.66E-04 |     0.000302 |     9.40E+06 |
| MCG-6-30-15-hi         |    6.295 | 0.157 | 0.237 | 0.00775 | 2.51E+44 |      1.20E+44 |     44.1 |     0.478 |   1.19E+26 |     15.2 |     11.6 |      9.66E-04 |     0.000302 |     4.13E+06 |
| MCG-6-30-15-lo         |    6.295 | 0.157 | 0.237 | 0.00775 | 2.51E+44 |      1.20E+44 |     44.1 |     0.478 |   1.19E+26 |     16.1 |      7.1 |      9.66E-04 |     0.000302 |     3.08E+06 |
| Mrk335-comb            |     7.23 | 0.042 | 0.044 |  0.0258 | 2.14E+45 |      1.26E+45 |     45.1 |     0.588 |   3.43E+26 |    132.7 |     36.4 |      2.65E-04 |     8.28E-05 |     2.35E+06 |
| Mrk335-hi              |     7.23 | 0.042 | 0.044 |  0.0258 | 2.14E+45 |      1.26E+45 |     45.1 |     0.588 |   3.43E+26 |    141.4 |     56.3 |      2.65E-04 |     8.28E-05 |     1.80E+06 |
| Mrk335-lo              |     7.23 | 0.042 | 0.044 |  0.0258 | 2.14E+45 |      1.26E+45 |     45.1 |     0.588 |   3.43E+26 |       24 |     47.2 |      5.06E-04 |     0.000158 |     2.56E+06 |
| Mrk766-comb            |    6.822 |  0.05 | 0.057 |  0.0129 | 8.36E+44 |      9.55E+43 |       44 |     0.114 |   1.91E+26 |     23.9 |      6.7 |      9.66E-04 |     8.28E-05 |     5.24E+06 |
| Mrk766-hi              |    6.822 |  0.05 | 0.057 |  0.0129 | 8.36E+44 |      9.55E+43 |       44 |     0.114 |   1.91E+26 |     35.2 |     13.8 |      9.66E-04 |     0.000302 |     1.79E+06 |
| Mrk766-lo              |    6.822 |  0.05 | 0.057 |  0.0129 | 8.36E+44 |      9.55E+43 |       44 |     0.114 |   1.91E+26 |    157.6 |     98.2 |      2.65E-04 |     8.28E-05 |     2.22E+05 |
| Mrk766-med             |    6.822 |  0.05 | 0.057 |  0.0129 | 8.36E+44 |      9.55E+43 |       44 |     0.114 |   1.91E+26 |     10.2 |      8.4 |      9.66E-04 |     0.000302 |     3.22E+06 |
| Mrk841-comb            |     7.88 |   0.1 |   0.1 |  0.0365 | 4.17E+46 |      6.92E+45 |     45.8 |     0.166 |   5.18E+26 |   265.85 |   217.52 |      1.02E-04 |     3.18E-05 |     5.18E+05 |
| Mrk841-hi (2001)       |     7.88 |   0.1 |   0.1 |  0.0365 | 4.17E+46 |      6.92E+45 |     45.8 |     0.166 |   5.18E+26 |   211.96 |   122.36 |      4.77E-04 |     1.49E-04 |     2.67E+05 |
| Mrk841-lo (2005)       |     7.88 |   0.1 |   0.1 |  0.0365 | 4.17E+46 |      6.92E+45 |     45.8 |     0.166 |   5.18E+26 |   562.77 |   120.99 |      1.02E-04 |     3.18E-05 |     2.51E+05 |
| NGC1365-comb           |      7.6 |   0.5 |   0.5 |  0.0045 | 5.01E+45 |      9.77E+43 |       44 |    0.0195 |   7.04E+25 |    144.2 |    113.4 |      7.27E-05 |     2.27E-05 |      1015609 |
| NGC1365-hi             |      7.6 |   0.5 |   0.5 |  0.0045 | 5.01E+45 |      9.77E+43 |       44 |    0.0195 |   7.04E+25 |    108.9 |    104.3 |      7.27E-05 |     2.27E-05 |       465800 |
| NGC1365-lo             |      7.6 |   0.5 |   0.5 |  0.0045 | 5.01E+45 |      9.77E+43 |       44 |    0.0195 |   7.04E+25 |    156.7 |     95.1 |      2.65E-04 |     8.28E-05 |       549809 |
| NGC3516-comb           |      7.4 | 0.037 | 0.061 | 0.00886 | 3.13E+45 |      1.95E+44 |     44.3 |    0.0623 |   1.24E+26 |    256.6 |    144.4 |      7.27E-05 |     2.27E-05 |      4040090 |
| NGC3516-hi (Grp1)      |      7.4 | 0.037 | 0.061 | 0.00886 | 3.13E+45 |      1.95E+44 |     44.3 |    0.0623 |   1.24E+26 |   296.27 |   229.58 |      7.27E-05 |     2.27E-05 |      2783580 |
| NGC3516-lo (Grp3-2001) |      7.4 | 0.037 | 0.061 | 0.00886 | 3.13E+45 |      1.95E+44 |     44.3 |    0.0623 |   1.24E+26 |    143.7 |    79.64 |      2.65E-04 |     8.28E-05 |       717170 |
| NGC3516-med (Grp2)     |      7.4 | 0.037 | 0.061 | 0.00886 | 3.13E+45 |      1.95E+44 |     44.3 |    0.0623 |   1.24E+26 |    131.5 |    213.2 |      7.27E-05 |     2.27E-05 |       539340 |
| NGC4051-comb           |    5.891 | 0.084 | 0.145 | 0.00216 | 1.70E+44 |      1.82E+43 |     43.3 |     0.107 |   4.23E+25 |     17.2 |      7.1 |      9.66E-04 |     0.000158 |      6502280 |
| NGC4051-hi             |    5.891 | 0.084 | 0.145 | 0.00216 | 1.70E+44 |      1.82E+43 |     43.3 |     0.107 |   4.23E+25 |     17.2 |       10 |      5.06E-04 |     0.000158 |      4665700 |
| NGC4051-lo             |    5.891 | 0.084 | 0.145 | 0.00216 | 1.70E+44 |      1.82E+43 |     43.3 |     0.107 |   4.23E+25 |     19.8 |      6.7 |      9.66E-04 |     0.000302 |      1836580 |
| NGC4151-comb           |    7.555 | 0.051 | 0.047 |  0.0033 | 5.63E+45 |      1.02E+44 |       44 |    0.0182 |   5.68E+25 |   488.01 |    278.6 |      1.39E-04 |     4.34E-05 |      1865040 |
| NGC4151-hi             |    7.555 | 0.051 | 0.047 |  0.0033 | 5.63E+45 |      1.02E+44 |       44 |    0.0182 |   5.68E+25 |    585.5 |    380.8 |      1.39E-04 |     4.34E-05 |       959770 |
| NGC4151-lo             |    7.555 | 0.051 | 0.047 |  0.0033 | 5.63E+45 |      1.02E+44 |       44 |    0.0182 |   5.68E+25 |     41.9 |    142.2 |      2.65E-04 |     0.000174 |       905270 |
| NGC4395-comb           |    5.449 |  0.13 | 0.145 | 0.00106 | 3.54E+43 |      1.51E+41 |     41.2 |   0.00427 |   2.67E+25 |     23.9 |     16.2 |      5.06E-04 |     0.000158 |       138273 |
| NGC4395-hi (2003)      |    5.449 |  0.13 | 0.145 | 0.00106 | 3.54E+43 |      1.51E+41 |     41.2 |   0.00427 |   2.67E+25 |     22.4 |     17.4 |      5.06E-04 |     0.000158 |        92203 |
| NGC4395-lo (2014)      |    5.449 |  0.13 | 0.145 | 0.00106 | 3.54E+43 |      1.51E+41 |     41.2 |   0.00427 |   2.67E+25 |     59.2 |     26.7 |      8.60E-04 |     2.69E-04 |        46070 |
| NGC5548-comb           |    7.718 | 0.016 | 0.016 |  0.0172 | 6.58E+45 |      6.17E+44 |     44.8 |    0.0937 |   2.42E+26 |    156.7 |     55.9 |      2.65E-04 |     8.28E-05 |      2486670 |
| NGC5548-hi (2001)      |    7.718 | 0.016 | 0.016 |  0.0172 | 6.58E+45 |      6.17E+44 |     44.8 |    0.0937 |   2.42E+26 |    197.3 |     98.7 |      2.65E-04 |     8.28E-05 |      1239400 |
| NGC5548-lo             |    7.718 | 0.016 | 0.016 |  0.0172 | 6.58E+45 |      6.17E+44 |     44.8 |    0.0937 |   2.42E+26 |    300.4 |    240.3 |      1.39E-04 |     4.34E-05 |      1247270 |
| NGC6860                |      7.6 |   0.5 |   0.5 |  0.0153 | 5.02E+45 |      5.13E+43 |     43.7 |    0.0102 |   2.01E+26 |   186.65 |   192.49 |      1.94E-04 |     6.07E-05 |       835460 |
| NGC7314-comb           |      6.7 |   0.5 |   0.5 |  0.0048 | 6.31E+44 |      9.55E+42 |       43 |    0.0151 |   5.12E+25 |      1.6 |      5.8 |      1.84E-03 |     5.76E-04 |      1155960 |
| NGC7314-hi             |      6.7 |   0.5 |   0.5 |  0.0048 | 6.31E+44 |      9.55E+42 |       43 |    0.0151 |   5.12E+25 |    104.2 |    101.7 |      2.65E-04 |     8.28E-05 |       272400 |
| NGC7314-lo             |      6.7 |   0.5 |   0.5 |  0.0048 | 6.31E+44 |      9.55E+42 |       43 |    0.0151 |   5.12E+25 |      1.2 |    2.917 |      2.95E-03 |     9.22E-04 |       883560 |
| NGC7469-comb           |    6.956 | 0.048 |  0.05 |  0.0164 | 1.14E+45 |      1.26E+45 |     45.1 |      1.11 |   2.08E+26 |    82.15 |    51.07 |      3.71E-04 |     1.16E-04 |      2954310 |
| NGC7469-hi (Grp1)      |    6.956 | 0.048 |  0.05 |  0.0164 | 1.14E+45 |      1.26E+45 |     45.1 |      1.11 |   2.08E+26 |   292.29 |    80.25 |      3.71E-04 |     1.16E-04 |      1645620 |
| NGC7469-lo (Grp2)      |    6.956 | 0.048 |  0.05 |  0.0164 | 1.14E+45 |      1.26E+45 |     45.1 |      1.11 |   2.08E+26 |     18.4 |    12.09 |      1.35E-03 |     4.23E-04 |      1308690 |
| PG1211+143-comb        |     7.61 |   0.5 |   0.5 |  0.0809 | 5.13E+45 |      1.48E+46 |     46.2 |      2.88 |   1.19E+27 |    215.6 |    112.7 |      8.33E-05 |     2.60E-05 |      2900730 |
| PG1211+143-hi          |     7.61 |   0.5 |   0.5 |  0.0809 | 5.13E+45 |      1.48E+46 |     46.2 |      2.88 |   1.19E+27 |   162.09 |   140.36 |      8.33E-05 |     2.60E-05 |      2169130 |
| PG1211+143-lo          |     7.61 |   0.5 |   0.5 |  0.0809 | 5.13E+45 |      1.48E+46 |     46.2 |      2.88 |   1.19E+27 |    313.8 |    170.7 |      7.27E-05 |     2.27E-05 |       731600 |
| PG1244+026-comb        |     7.26 |   0.5 |   0.5 |  0.0482 | 2.29E+45 |      4.17E+44 |     44.6 |     0.182 |   6.97E+26 |     54.5 |     20.3 |      5.06E-04 |     0.000158 |      3138650 |
| PG1244+026-hi          |     7.26 |   0.5 |   0.5 |  0.0482 | 2.29E+45 |      4.17E+44 |     44.6 |     0.182 |   6.97E+26 |     72.8 |     45.2 |      5.06E-04 |     0.000158 |       739770 |
| PG1244+026-lo          |     7.26 |   0.5 |   0.5 |  0.0482 | 2.29E+45 |      4.17E+44 |     44.6 |     0.182 |   6.97E+26 |       45 |       23 |      5.06E-04 |     0.000158 |      2398880 |
| PG1247+267             |     8.92 |   0.5 |   0.5 |       2 | 1.05E+47 |      2.19E+47 |     47.3 |      2.09 |   5.03E+28 |   498.56 |   513.19 |      1.16E-04 |     3.64E-05 |         8163 |
| REJ1034+396-comb       |     6.18 |   0.5 |   0.5 |    0.04 | 1.91E+44 |      3.31E+44 |     44.5 |      1.74 |   6.11E+26 |     55.5 |     68.5 |      2.65E-04 |     8.28E-05 |       890520 |
| REJ1034+396-hi         |     6.18 |   0.5 |   0.5 |    0.04 | 1.91E+44 |      3.31E+44 |     44.5 |      1.74 |   6.11E+26 |        3 |        5 |      3.52E-03 |     0.000692 |       241460 |
| REJ1034+396-lo         |     6.18 |   0.5 |   0.5 |    0.04 | 1.91E+44 |      3.31E+44 |     44.5 |      1.74 |   6.11E+26 |     72.9 |       72 |      2.65E-04 |     8.28E-05 |       649060 |

** Correlate Mass

PATH = =/home/steff075/phd_ecm/results-spectral/correlate_Mass_Lag.py=

*Combined*

| M | and | Lag        | = |    0.8002090463821154 |
| M | and | Lag_freq   | = |    -0.544331094002734 |
| M | and | L2_10      | = |    0.5470778471880295 |
| M | and | L_edd      | = |    0.6689870503612572 |
| M | and | Edd_ratio  | = |  -0.08147330141003749 |
| M | and | L_bol      | = |    0.5628069715015582 |
| M | and | cts        | = |   -0.3791781552717119 |
| M | and | Ref_F      | = |    0.0830336910107934 |
| M | and | Plaw_F     | = |   0.03520194178930412 |
| M | and | Gamma_Relx | = |   0.12296879076817592 |
| M | and | xi         | = |  -0.11689665918033137 |
| M | and | Fe         | = | -0.040080102370858996 |
| M | and | RF         | = |   0.19787788615548763 |
| M | and | Cvr        | = |    0.3717545028418798 |
| M | and | nH         | = |   -0.3207372097483705 |

Spearmans:



*Hiflux*

| M | and | Lag        | = |     0.6098353372839784 |
| M | and | Lag_freq   | = |   -0.44493337165507946 |
| M | and | L2_10      | = |      0.558891560392171 |
| M | and | L_edd      | = |     0.5323153291730008 |
| M | and | Edd_ratio  | = |   -0.18605097657908076 |
| M | and | L_bol      | = |     0.3485264803636926 |
| M | and | cts        | = |    -0.3073244335250186 |
| M | and | Ref_F      | = |    0.30457326587775285 |
| M | and | Plaw_F     | = |     0.2833919828281001 |
| M | and | Gamma_Relx | = |   0.002493548273393596 |
| M | and | xi         | = | 0.00011127956728606195 |
| M | and | Fe         | = |    -0.2861887954126152 |
| M | and | RF         | = |    -0.1364355725937763 |
| M | and | Cvr        | = |    0.41300753512729815 |
| M | and | nH         | = |   -0.16738061241008306 |


*Loflux*

| M | and | Lag        | = |     0.607529197137279 |
| M | and | Lag_freq   | = |  -0.48861157493777674 |
| M | and | L2_10      | = |    0.5043242363751178 |
| M | and | L_edd      | = |    0.5323153291730008 |
| M | and | Edd_ratio  | = |  -0.18605097657908076 |
| M | and | L_bol      | = |    0.3485264803636926 |
| M | and | cts        | = |   0.06468192088765662 |
| M | and | Ref_F      | = |    0.2362626087439405 |
| M | and | Plaw_F     | = |    0.2126671251987355 |
| M | and | Gamma_Relx | = |   0.10416379166501659 |
| M | and | xi         | = |   -0.3125815530825886 |
| M | and | Fe         | = |   -0.1307539206207497 |
| M | and | RF         | = | -0.042370970667719006 |
| M | and | Cvr        | = |   0.15174291498985581 |
| M | and | nH         | = |   0.09615293844131917 |

** Correlate Lag and Lag-freq

PATH = =/home/steff075/phd_ecm/results-spectral/correlate_Lag.py=

*All Data*

| Lag      | and | M          | = |     0.7234022229552409 |
| Lag      | and | Lag_freq   | = |    -0.5138774943470306 |
| Lag      | and | L2_10      | = |    0.35351396941078894 |
| Lag      | and | L_edd      | = |     0.5744392547016561 |
| Lag      | and | Edd_ratio  | = |    -0.1430651585915701 |
| Lag      | and | L_bol      | = |     0.3803161839438176 |
| Lag      | and | cts        | = |   -0.22045851242118983 |
| Lag      | and | Ref_F      | = |     0.4698325494429421 |
| Lag      | and | Plaw_F     | = |    0.45195295868785895 |
| Lag      | and | Gamma_Relx | = |   -0.25072266278140926 |
| Lag      | and | xi         | = |   -0.12868691333119484 |
| Lag      | and | Fe         | = |    0.07767469717622243 |
| Lag      | and | RF         | = | -0.0028123570524686103 |
| Lag      | and | Cvr        | = |    0.27551693972795227 |
| Lag      | and | nH         | = |   -0.13592835499505546 |
| Lag_freq | and | M          | = |   -0.48407737661327516 |
| Lag_freq | and | Lag_freq   | = |                    1.0 |
| Lag_freq | and | L2_10      | = |   -0.10710622221497969 |
| Lag_freq | and | L_edd      | = |    -0.2386196052227897 |
| Lag_freq | and | Edd_ratio  | = |   0.021525477535740217 |
| Lag_freq | and | L_bol      | = |   -0.13539797022204575 |
| Lag_freq | and | cts        | = |   0.029712400079087663 |
| Lag_freq | and | Ref_F      | = |   -0.18138988117822924 |
| Lag_freq | and | Plaw_F     | = |   -0.17950608023167255 |
| Lag_freq | and | Gamma_Relx | = |      0.235466073206608 |
| Lag_freq | and | xi         | = |    0.20801317799779348 |
| Lag_freq | and | Fe         | = |    0.05832568423365906 |
| Lag_freq | and | RF         | = |   -0.06859096159171378 |
| Lag_freq | and | Cvr        | = |   0.005933450899874978 |
| Lag_freq | and | nH         | = |    0.08782348765199195 |


*Combined*

| Lag      | and | M          | = |    0.8037957088787023 |
| Lag      | and | Lag_freq   | = |   -0.6150473358265681 |
| Lag      | and | L2_10      | = |    0.5785973546107228 |
| Lag      | and | L_edd      | = |    0.6750280078960793 |
| Lag      | and | Edd_ratio  | = | -0.034807142654031724 |
| Lag      | and | L_bol      | = |    0.5904999972388668 |
| Lag      | and | cts        | = |  -0.35811830570557257 |
| Lag      | and | Ref_F      | = |   0.30907137355318653 |
| Lag      | and | Plaw_F     | = |   0.27505659716072134 |
| Lag      | and | Gamma_Relx | = |  -0.02841695193470548 |
| Lag      | and | xi         | = |   -0.1385121594362872 |
| Lag      | and | Fe         | = |  -0.12645377721622195 |
| Lag      | and | RF         | = |    0.2443975561267768 |
| Lag      | and | Cvr        | = |    0.4505953842979685 |
| Lag      | and | nH         | = |  -0.18420218170757716 |
| Lag_freq | and | M          | = |   -0.5464651618060312 |
| Lag_freq | and | Lag_freq   | = |                   1.0 |
| Lag_freq | and | L2_10      | = |  -0.19016685346538434 |
| Lag_freq | and | L_edd      | = |   -0.3013786480063675 |
| Lag_freq | and | Edd_ratio  | = |  -0.10082385151048459 |
| Lag_freq | and | L_bol      | = |  -0.21031998296159668 |
| Lag_freq | and | cts        | = |    0.2669637086581744 |
| Lag_freq | and | Ref_F      | = | -0.029285045221535595 |
| Lag_freq | and | Plaw_F     | = | -0.030370077285434702 |
| Lag_freq | and | Gamma_Relx | = |   0.18058903612460078 |
| Lag_freq | and | xi         | = |   0.06564267084965515 |
| Lag_freq | and | Fe         | = |   0.07696054238740138 |
| Lag_freq | and | RF         | = |  -0.11200042891267756 |
| Lag_freq | and | Cvr        | = |  -0.19151380788579722 |
| Lag_freq | and | nH         | = |   0.31883495869182843 |


*Hiflux*

| Lag      | and | M          | = |      0.59794403119797 |
| Lag      | and | Lag_freq   | = |   -0.5329441894562514 |
| Lag      | and | L2_10      | = |   0.12856668418413542 |
| Lag      | and | L_edd      | = |   0.25916081222822734 |
| Lag      | and | Edd_ratio  | = |  -0.17434002507933127 |
| Lag      | and | L_bol      | = |   0.05069735731407394 |
| Lag      | and | cts        | = |   -0.2589658458122738 |
| Lag      | and | Ref_F      | = |    0.8101331538738377 |
| Lag      | and | Plaw_F     | = |    0.7900467349054144 |
| Lag      | and | Gamma_Relx | = |   -0.3638717161261017 |
| Lag      | and | xi         | = |  -0.22168820029848027 |
| Lag      | and | Fe         | = |   0.14567982964818046 |
| Lag      | and | RF         | = |  -0.32359973246102536 |
| Lag      | and | Cvr        | = |    0.4511192629603859 |
| Lag      | and | nH         | = |   -0.1849323247117364 |
| Lag_freq | and | M          | = |   -0.4317943469207128 |
| Lag_freq | and | Lag_freq   | = |    0.9999999999999999 |
| Lag_freq | and | L2_10      | = |  -0.25602866510512434 |
| Lag_freq | and | L_edd      | = |  -0.15706469812731386 |
| Lag_freq | and | Edd_ratio  | = |   0.12140897317204957 |
| Lag_freq | and | L_bol      | = |  -0.19950798982939463 |
| Lag_freq | and | cts        | = | -0.012834792248244846 |
| Lag_freq | and | Ref_F      | = |    -0.276508891561485 |
| Lag_freq | and | Plaw_F     | = |   -0.2789071649708139 |
| Lag_freq | and | Gamma_Relx | = |   0.19739025520627462 |
| Lag_freq | and | xi         | = |   0.20752279070833907 |
| Lag_freq | and | Fe         | = |   0.03368234295275693 |
| Lag_freq | and | RF         | = |  -0.02697116959884148 |
| Lag_freq | and | Cvr        | = |   -0.4240216685291997 |
| Lag_freq | and | nH         | = |     0.101981375460078 |

*Loflux*

| Lag      | and | M          | = |    0.6985179456094626 |
| Lag      | and | Lag_freq   | = |   -0.5356396999782126 |
| Lag      | and | L2_10      | = |    0.7311308426764666 |
| Lag      | and | L_edd      | = |    0.8494265393763192 |
| Lag      | and | Edd_ratio  | = | -0.030436122025759304 |
| Lag      | and | L_bol      | = |    0.5933518741422015 |
| Lag      | and | cts        | = |   -0.3410329320537309 |
| Lag      | and | Ref_F      | = |  -0.14768692622305854 |
| Lag      | and | Plaw_F     | = |   -0.1572562902699599 |
| Lag      | and | Gamma_Relx | = |  -0.22304932325108429 |
| Lag      | and | xi         | = |   0.03957968894037749 |
| Lag      | and | Fe         | = |   0.16587148359805412 |
| Lag      | and | RF         | = |   0.23542098874097725 |
| Lag      | and | Cvr        | = |   0.03442721018127499 |
| Lag      | and | nH         | = |  -0.06462536933804722 |
| Lag_freq | and | M          | = |   -0.4980647460249334 |
| Lag_freq | and | Lag_freq   | = |    0.9999999999999999 |
| Lag_freq | and | L2_10      | = |  -0.36109317546224745 |
| Lag_freq | and | L_edd      | = |  -0.34108795546098125 |
| Lag_freq | and | Edd_ratio  | = |   0.01968346228547059 |
| Lag_freq | and | L_bol      | = |  -0.29271138215641895 |
| Lag_freq | and | cts        | = | -0.022528866432061548 |
| Lag_freq | and | Ref_F      | = |   0.10501436431835169 |
| Lag_freq | and | Plaw_F     | = |   0.13586979969206656 |
| Lag_freq | and | Gamma_Relx | = |    0.2536520855904042 |
| Lag_freq | and | xi         | = |    0.3669894603048321 |
| Lag_freq | and | Fe         | = |   0.11742359302245445 |
| Lag_freq | and | RF         | = |   -0.2674490213114305 |
| Lag_freq | and | Cvr        | = |   0.19538360758373927 |
| Lag_freq | and | nH         | = |  -0.06964810237432927 |

** Correlate L2-10

PATH = =/home/steff075/phd_ecm/results-spectral/correlate_L2-10.py=

*All Data*

| L2_10 | and | M          | = |   0.33829777244461157 |
| L2_10 | and | Lag_freq   | = |  -0.10710622221497967 |
| L2_10 | and | L_edd      | = |    0.8262908936136169 |
| L2_10 | and | Edd_ratio  | = |    0.0588417546752845 |
| L2_10 | and | L_bol      | = |    0.9925728993228767 |
| L2_10 | and | cts        | = |  -0.09994631790553163 |
| L2_10 | and | Ref_F      | = |  -0.09106255080009247 |
| L2_10 | and | Plaw_F     | = |  -0.09230536819728447 |
| L2_10 | and | Gamma_Relx | = |   0.06173046021570419 |
| L2_10 | and | xi         | = |  -0.23894979359131674 |
| L2_10 | and | Fe         | = | -0.017490337541534864 |
| L2_10 | and | RF         | = |   0.10959124360872538 |
| L2_10 | and | Cvr        | = |   0.03960253465646544 |
| L2_10 | and | nH         | = |  -0.02865917734515322 |


*Combined*

| L2_10 | and | M          | = |   0.33829777244461157 |
| L2_10 | and | Lag_freq   | = |  -0.10710622221497967 |
| L2_10 | and | L_edd      | = |    0.8262908936136169 |
| L2_10 | and | Edd_ratio  | = |    0.0588417546752845 |
| L2_10 | and | L_bol      | = |    0.9925728993228767 |
| L2_10 | and | cts        | = |  -0.09994631790553163 |
| L2_10 | and | Ref_F      | = |  -0.09106255080009247 |
| L2_10 | and | Plaw_F     | = |  -0.09230536819728447 |
| L2_10 | and | Gamma_Relx | = |   0.06173046021570419 |
| L2_10 | and | xi         | = |  -0.23894979359131674 |
| L2_10 | and | Fe         | = | -0.017490337541534864 |
| L2_10 | and | RF         | = |   0.10959124360872538 |
| L2_10 | and | Cvr        | = |   0.03960253465646544 |
| L2_10 | and | nH         | = |  -0.02865917734515322 |


*Hiflux*

| L2_10 | and | M          | = |    0.5973906515427361 |
| L2_10 | and | Lag_freq   | = |  -0.25602866510512434 |
| L2_10 | and | L_edd      | = |    0.5694134545929953 |
| L2_10 | and | Edd_ratio  | = |    0.2024459677391199 |
| L2_10 | and | L_bol      | = |    0.8356223649940859 |
| L2_10 | and | cts        | = |  0.001250535053290368 |
| L2_10 | and | Ref_F      | = |   -0.1472016317231728 |
| L2_10 | and | Plaw_F     | = |  -0.13075017316112955 |
| L2_10 | and | Gamma_Relx | = | 0.0066877271120373985 |
| L2_10 | and | xi         | = |   0.24552238321229392 |
| L2_10 | and | Fe         | = |  -0.27316064909900906 |
| L2_10 | and | RF         | = |  -0.22699277385952363 |
| L2_10 | and | Cvr        | = |    -0.340605136917137 |
| L2_10 | and | nH         | = | -0.059912758318447855 |



*Loflux*

| L2_10 | and | M          | = |    0.5361291993858961 |
| L2_10 | and | Lag_freq   | = |  -0.36109317546224745 |
| L2_10 | and | L_edd      | = |    0.5109805747315491 |
| L2_10 | and | Edd_ratio  | = |    0.1498661958953302 |
| L2_10 | and | L_bol      | = |    0.8576376664793676 |
| L2_10 | and | cts        | = |  -0.05590897436442529 |
| L2_10 | and | Ref_F      | = |  -0.17371777901120478 |
| L2_10 | and | Plaw_F     | = |  -0.16476891952946257 |
| L2_10 | and | Gamma_Relx | = |  -0.21619635284190172 |
| L2_10 | and | xi         | = |    0.0684874958924691 |
| L2_10 | and | Fe         | = |  -0.20547522526985063 |
| L2_10 | and | RF         | = |  -0.08239570246650918 |
| L2_10 | and | Cvr        | = | -0.021928182082354055 |
| L2_10 | and | nH         | = |  -0.32043547456942373 |

** Correlate Gamma

PATH = =/home/steff075/phd_ecm/results-spectral/correlate_Gamma.py=

*All Data*

| Gamma_Relx | and | M         | = | -0.08017526508155795 |
| Gamma_Relx | and | Lag_freq  | = |  0.23546607320660806 |
| Gamma_Relx | and | L_edd     | = | 0.015676443173231736 |
| Gamma_Relx | and | Edd_ratio | = |   0.5089222369190797 |
| Gamma_Relx | and | L_bol     | = |  0.07927671203497062 |
| Gamma_Relx | and | cts       | = |  0.03703888140742593 |
| Gamma_Relx | and | Ref_F     | = | -0.31188553112294376 |
| Gamma_Relx | and | Plaw_F    | = |  -0.3074731849329655 |
| Gamma_Relx | and | xi        | = |  0.07247947595176404 |
| Gamma_Relx | and | Fe        | = |  -0.3611132178026851 |
| Gamma_Relx | and | RF        | = |  0.24990697353105976 |
| Gamma_Relx | and | Cvr       | = | -0.01343685782725832 |
| Gamma_Relx | and | nH        | = | -0.07316802317401623 |


*Combined*

| Gamma_Relx | and | M         | = |  0.09771886347480764 |
| Gamma_Relx | and | Lag_freq  | = |  0.18058903612460078 |
| Gamma_Relx | and | L_edd     | = |  0.10345361063886489 |
| Gamma_Relx | and | Edd_ratio | = |  0.46227049223920197 |
| Gamma_Relx | and | L_bol     | = |  0.14936918008490407 |
| Gamma_Relx | and | cts       | = |   0.0722881103741419 |
| Gamma_Relx | and | Ref_F     | = |  -0.2094632253705778 |
| Gamma_Relx | and | Plaw_F    | = | -0.18950623577012818 |
| Gamma_Relx | and | xi        | = | 0.034378952802865924 |
| Gamma_Relx | and | Fe        | = | -0.31006414567955604 |
| Gamma_Relx | and | RF        | = |  0.04405459400212265 |
| Gamma_Relx | and | Cvr       | = | 0.031896733080275345 |
| Gamma_Relx | and | nH        | = | -0.05224759055418912 |



*Hiflux*

| Gamma_Relx | and | M         | = | -0.08017526508155795 |
| Gamma_Relx | and | Lag_freq  | = |  0.23546607320660806 |
| Gamma_Relx | and | L_edd     | = | 0.015676443173231736 |
| Gamma_Relx | and | Edd_ratio | = |   0.5089222369190797 |
| Gamma_Relx | and | L_bol     | = |  0.07927671203497062 |
| Gamma_Relx | and | cts       | = |  0.03703888140742593 |
| Gamma_Relx | and | Ref_F     | = | -0.31188553112294376 |
| Gamma_Relx | and | Plaw_F    | = |  -0.3074731849329655 |
| Gamma_Relx | and | xi        | = |  0.07247947595176404 |
| Gamma_Relx | and | Fe        | = |  -0.3611132178026851 |
| Gamma_Relx | and | RF        | = |  0.24990697353105976 |
| Gamma_Relx | and | Cvr       | = | -0.01343685782725832 |
| Gamma_Relx | and | nH        | = | -0.07316802317401623 |



*Loflux*

| Gamma_Relx | and | M         | = |  0.06962771167269939 |
| Gamma_Relx | and | Lag_freq  | = |   0.2536520855904042 |
| Gamma_Relx | and | L_edd     | = |  -0.0899398444045879 |
| Gamma_Relx | and | Edd_ratio | = |   0.5390768050426629 |
| Gamma_Relx | and | L_bol     | = |  0.04524164926737354 |
| Gamma_Relx | and | cts       | = |  -0.2342820810352132 |
| Gamma_Relx | and | Ref_F     | = |  0.09751288816934714 |
| Gamma_Relx | and | Plaw_F    | = |   0.0998299947997712 |
| Gamma_Relx | and | xi        | = | 0.048669465488315466 |
| Gamma_Relx | and | Fe        | = |  -0.3329025519556424 |
| Gamma_Relx | and | RF        | = |   0.1905364155434942 |
| Gamma_Relx | and | Cvr       | = |  0.33192263194354943 |
| Gamma_Relx | and | nH        | = |  0.35964237132807303 |

** Correlate Reflection flux

PATH =correlate_Refl_Flux.py=


*All Data*

| Ref_F | and | M         | = |   0.22235956931997036 |
| Ref_F | and | Lag_freq  | = |  -0.18138988117822924 |
| Ref_F | and | L_edd     | = | -0.056557590613534096 |
| Ref_F | and | Edd_ratio | = |  -0.29728064585721364 |
| Ref_F | and | L_bol     | = |  -0.11752534249089619 |
| Ref_F | and | cts       | = |    0.1266830484101021 |
| Ref_F | and | Ref_F     | = |                   1.0 |
| Ref_F | and | Plaw_F    | = |    0.9995311491006983 |
| Ref_F | and | xi        | = |  -0.06844754668174204 |
| Ref_F | and | Fe        | = |   0.19947742284909342 |
| Ref_F | and | RF        | = |   -0.2645646896287896 |
| Ref_F | and | Cvr       | = |   0.17425899580891674 |
| Ref_F | and | nH        | = |  0.020645602272989495 |

*Combined*

| Ref_F | and | M         | = |    0.0857829479036799 |
| Ref_F | and | Lag_freq  | = | -0.029285045221535588 |
| Ref_F | and | L_edd     | = |   -0.2194675823576951 |
| Ref_F | and | Edd_ratio | = |   -0.3848746170648805 |
| Ref_F | and | L_bol     | = |   -0.2550210957123373 |
| Ref_F | and | cts       | = |    0.3295725560648335 |
| Ref_F | and | Ref_F     | = |                   1.0 |
| Ref_F | and | Plaw_F    | = |      0.99903447276673 |
| Ref_F | and | xi        | = |   0.28920117555519936 |
| Ref_F | and | Fe        | = |   0.23060036112865137 |
| Ref_F | and | RF        | = | -0.025404882515802314 |
| Ref_F | and | Cvr       | = |   0.23045749365957238 |
| Ref_F | and | nH        | = |   0.03207371479619548 |

*Hiflux*

| Ref_F | and | M         | = |      0.289177965686401 |
| Ref_F | and | Lag_freq  | = |     -0.276508891561485 |
| Ref_F | and | L_edd     | = |   0.010680241738046159 |
| Ref_F | and | Edd_ratio | = |   -0.29382730308846916 |
| Ref_F | and | L_bol     | = |   -0.24558851509783947 |
| Ref_F | and | cts       | = |   0.014081829427647729 |
| Ref_F | and | Ref_F     | = |                    1.0 |
| Ref_F | and | Plaw_F    | = |     0.9998242745580816 |
| Ref_F | and | xi        | = |   -0.32616774510452895 |
| Ref_F | and | Fe        | = |     0.3116088849179553 |
| Ref_F | and | RF        | = |     -0.212861093392812 |
| Ref_F | and | Cvr       | = |    0.42596351846351305 |
| Ref_F | and | nH        | = | -0.0007520783163507781 |


*Loflux*

| Ref_F | and | M         | = |  0.22478999848052963 |
| Ref_F | and | Lag_freq  | = |   0.1050143643183517 |
| Ref_F | and | L_edd     | = | 0.017330590231365097 |
| Ref_F | and | Edd_ratio | = |  -0.3399121535833303 |
| Ref_F | and | L_bol     | = |  -0.2600389155835787 |
| Ref_F | and | cts       | = |   0.3432494513150885 |
| Ref_F | and | Ref_F     | = |                  1.0 |
| Ref_F | and | Plaw_F    | = |   0.9995196247350288 |
| Ref_F | and | xi        | = |  0.04663371779893117 |
| Ref_F | and | Fe        | = |   0.1656617016664001 |
| Ref_F | and | RF        | = |  -0.3479100590948415 |
| Ref_F | and | Cvr       | = | 0.020261635865022852 |

** Correlate Powerlaw flux

PATH =correlate_Plaw_Flux.py=


*All Data*

| Plaw_F | and | M         | = |    0.1976213144014626 |
| Plaw_F | and | Lag_freq  | = |  -0.17950608023167253 |
| Plaw_F | and | L_edd     | = |  -0.06193021817270594 |
| Plaw_F | and | Edd_ratio | = |  -0.29949120861511497 |
| Plaw_F | and | L_bol     | = |  -0.12018571034581577 |
| Plaw_F | and | cts       | = |   0.18108027994388134 |
| Plaw_F | and | Plaw_F    | = |                   1.0 |
| Plaw_F | and | Plaw_F    | = |                   1.0 |
| Plaw_F | and | xi        | = | -0.057871702424567975 |
| Plaw_F | and | Fe        | = |    0.2103515467749066 |
| Plaw_F | and | RF        | = |  -0.29065666447999133 |
| Plaw_F | and | Cvr       | = |   0.18323483453040823 |
| Plaw_F | and | nH        | = |   0.01660934663129715 |



*Combined*

| Plaw_F | and | M         | = | 0.035679373676489094 |
| Plaw_F | and | Lag_freq  | = | -0.03037007728543471 |
| Plaw_F | and | L_edd     | = | -0.22446346599226977 |
| Plaw_F | and | Edd_ratio | = |  -0.3628593667362603 |
| Plaw_F | and | L_bol     | = | -0.25158701263826144 |
| Plaw_F | and | cts       | = |  0.38523078917305664 |
| Plaw_F | and | Plaw_F    | = |                  1.0 |
| Plaw_F | and | Plaw_F    | = |                  1.0 |
| Plaw_F | and | xi        | = |  0.21179829227374683 |
| Plaw_F | and | Fe        | = |  0.19930574685403754 |
| Plaw_F | and | RF        | = | -0.10719475178503678 |
| Plaw_F | and | Cvr       | = |  0.24654974362076407 |
| Plaw_F | and | nH        | = | 0.003512889855608525 |


*Hiflux*

| Plaw_F | and | M         | = |    0.2692470993109623 |
| Plaw_F | and | Lag_freq  | = |   -0.2789071649708139 |
| Plaw_F | and | L_edd     | = |   0.01161267216260867 |
| Plaw_F | and | Edd_ratio | = |   -0.2953669739513046 |
| Plaw_F | and | L_bol     | = |  -0.24949822716049508 |
| Plaw_F | and | cts       | = |   0.06648956149960898 |
| Plaw_F | and | Plaw_F    | = |    0.9999999999999999 |
| Plaw_F | and | Plaw_F    | = |    0.9999999999999999 |
| Plaw_F | and | xi        | = |   -0.2917939153388256 |
| Plaw_F | and | Fe        | = |   0.31981815701960997 |
| Plaw_F | and | RF        | = |    -0.227832747907921 |
| Plaw_F | and | Cvr       | = |   0.42982065828641014 |
| Plaw_F | and | nH        | = | -0.006910694784270245 |


*Loflux*

| Plaw_F | and | M         | = |   0.19976177342447712 |
| Plaw_F | and | Lag_freq  | = |   0.13586979969206658 |
| Plaw_F | and | L_edd     | = |  0.004287784314011868 |
| Plaw_F | and | Edd_ratio | = |  -0.33849486984349403 |
| Plaw_F | and | L_bol     | = |   -0.2676777063938432 |
| Plaw_F | and | cts       | = |   0.33538486665215667 |
| Plaw_F | and | Plaw_F    | = |    0.9999999999999998 |
| Plaw_F | and | Plaw_F    | = |    0.9999999999999998 |
| Plaw_F | and | xi        | = |  0.061443993557049874 |
| Plaw_F | and | Fe        | = |   0.13990438240529415 |
| Plaw_F | and | RF        | = |   -0.3342480704928314 |
| Plaw_F | and | Cvr       | = |   0.03317778754246822 |
| Plaw_F | and | nH        | = | -0.061579087394326784 |

** Correlate CvrFrac flux

PATH =correlate_CvrFrac.py=


*All Data*

| Cvr | and | M         | = |   0.2488831234790346 |
| Cvr | and | Lag_freq  | = | 0.005933450899874978 |
| Cvr | and | L_edd     | = |  0.08736712238677431 |
| Cvr | and | Edd_ratio | = | -0.21520279932362085 |
| Cvr | and | L_bol     | = | 0.027370257855228546 |
| Cvr | and | cts       | = | -0.41701903788971384 |
| Cvr | and | Cvr       | = |                  1.0 |
| Cvr | and | Plaw_F    | = |  0.18323483453040823 |
| Cvr | and | xi        | = | -0.20644080896284808 |
| Cvr | and | Fe        | = |  0.29653908151596275 |
| Cvr | and | RF        | = |   0.0891586531058379 |
| Cvr | and | Cvr       | = |                  1.0 |
| Cvr | and | nH        | = |  -0.1658840417093645 |

*Combined*

| Cvr | and | M         | = |  0.35998316576486533 |
| Cvr | and | Lag_freq  | = |  -0.1915138078857972 |
| Cvr | and | L_edd     | = |  0.10873040656541315 |
| Cvr | and | Edd_ratio | = | -0.13343031692636972 |
| Cvr | and | L_bol     | = |  0.06652538417250815 |
| Cvr | and | cts       | = |  -0.6563945668263289 |
| Cvr | and | Cvr       | = |   0.9999999999999998 |
| Cvr | and | Plaw_F    | = |   0.2465497436207641 |
| Cvr | and | xi        | = |  -0.1613687822963161 |
| Cvr | and | Fe        | = | -0.14953957886760438 |
| Cvr | and | RF        | = | -0.12880533218250861 |
| Cvr | and | Cvr       | = |   0.9999999999999998 |
| Cvr | and | nH        | = |  -0.6187406532219284 |



*Hiflux*

| Cvr | and | M         | = |  0.31587769246618386 |
| Cvr | and | Lag_freq  | = |  -0.4240216685291997 |
| Cvr | and | L_edd     | = |   0.3767734413562772 |
| Cvr | and | Edd_ratio | = |  -0.3526742354182581 |
| Cvr | and | L_bol     | = | -0.36007825098680935 |
| Cvr | and | cts       | = |   -0.322869211896818 |
| Cvr | and | Cvr       | = |                  1.0 |
| Cvr | and | Plaw_F    | = |   0.4298206582864102 |
| Cvr | and | xi        | = | -0.49386481119781167 |
| Cvr | and | Fe        | = |  0.46873443166558837 |
| Cvr | and | RF        | = |  -0.0640323629307083 |
| Cvr | and | Cvr       | = |                  1.0 |
| Cvr | and | nH        | = |  -0.6130359293532286 |



*Loflux*

| Cvr | and | M         | = |  0.11278982223698267 |
| Cvr | and | Lag_freq  | = |  0.19538360758373927 |
| Cvr | and | L_edd     | = |  0.34021613346505947 |
| Cvr | and | Edd_ratio | = | -0.04830109457362567 |
| Cvr | and | L_bol     | = | -0.07568638777352157 |
| Cvr | and | cts       | = |  -0.3964201762053055 |
| Cvr | and | Cvr       | = |                  1.0 |
| Cvr | and | Plaw_F    | = |  0.03317778754246823 |
| Cvr | and | xi        | = |  -0.3693750888247758 |
| Cvr | and | Fe        | = |   0.2874312846198848 |
| Cvr | and | RF        | = |  0.40842311916080953 |
| Cvr | and | Cvr       | = |                  1.0 |
| Cvr | and | nH        | = |    0.550543779334256 |

** Correlate nH flux

PATH =correlate_nH.py=


*All Data*

| nH | and | M         | = |  -0.02553001863363427 |
| nH | and | Lag_freq  | = |   0.08782348765199197 |
| nH | and | L_edd     | = |  -0.06343398071203687 |
| nH | and | Edd_ratio | = |  -0.11085678670191833 |
| nH | and | L_bol     | = |   -0.0412671010017629 |
| nH | and | cts       | = |  0.036797820467529864 |
| nH | and | nH        | = |                   1.0 |
| nH | and | Plaw_F    | = |  0.016609346631297154 |
| nH | and | xi        | = |    0.2682536468845917 |
| nH | and | Fe        | = | -0.008334189730956305 |
| nH | and | RF        | = |  -0.06191660577490058 |
| nH | and | Cvr       | = |   -0.1658840417093645 |



*Combined*

| nH | and | M         | = |  -0.13743252243274473 |
| nH | and | Lag_freq  | = |   0.31883495869182843 |
| nH | and | L_edd     | = |  -0.13221229813505628 |
| nH | and | Edd_ratio | = |  -0.10006457154861818 |
| nH | and | L_bol     | = |  -0.09903880149443449 |
| nH | and | cts       | = |   0.09545846030085348 |
| nH | and | nH        | = |                   1.0 |
| nH | and | Plaw_F    | = | 0.0035128898556085254 |
| nH | and | xi        | = |    0.4445151183283383 |
| nH | and | Fe        | = |    0.1511520650117858 |
| nH | and | RF        | = |    0.2218658426308407 |
| nH | and | Cvr       | = |   -0.6187406532219283 |



*Hiflux*

| nH | and | M         | = | -0.034552161891858287 |
| nH | and | Lag_freq  | = |     0.101981375460078 |
| nH | and | L_edd     | = |  -0.09351060483306549 |
| nH | and | Edd_ratio | = |  -0.12401037760907162 |
| nH | and | L_bol     | = |  -0.11835887305956833 |
| nH | and | cts       | = | -0.017719071756722216 |
| nH | and | nH        | = |                   1.0 |
| nH | and | Plaw_F    | = | -0.006910694784270246 |
| nH | and | xi        | = |    0.1941990925785944 |
| nH | and | Fe        | = |  -0.26506902108021435 |
| nH | and | RF        | = |  -0.19927819311556436 |
| nH | and | Cvr       | = |   -0.6130359293532286 |



*Loflux*

| nH | and | M         | = |   0.06984987610655063 |
| nH | and | Lag_freq  | = |  -0.06964810237432928 |
| nH | and | L_edd     | = |  -0.06316833374626006 |
| nH | and | Edd_ratio | = |  -0.17686574046265605 |
| nH | and | L_bol     | = |  -0.22435142026209398 |
| nH | and | cts       | = |  -0.29310955294799945 |
| nH | and | nH        | = |                   1.0 |
| nH | and | Plaw_F    | = |  -0.06157908739432679 |
| nH | and | xi        | = |    0.1026048282550961 |
| nH | and | Fe        | = | -0.027840102208706162 |
| nH | and | RF        | = |   0.33877488026998587 |
| nH | and | Cvr       | = |     0.550543779334256 |

** Correlate 1H0707 and IRAS individual lags

Data is in
=/home/steff075/phd_ecm/results-spectral/1H0707_flux_lag_relxill_indobs.ods=

and

=/home/steff075/phd_ecm/results-spectral/IRAS_flux_lag_relxill_indobs.ods=

Use =spearman_1HandIRAS_indobs.py=

*1H0707-495*

| Spearmans | Lag      | and | L2_10:      | -0.382 |
| Spearmans | Lag      | and | L_edd:      |    nan |
| Spearmans | Lag      | and | Edd_Frac:   | -0.382 |
| Spearmans | Lag      | and | Gamma_Relx: | -0.048 |
| Spearmans | Lag      | and | xi:         | -0.034 |
| Spearmans | Lag      | and | Fe:         |  0.032 |
| Spearmans | Lag      | and | RF:         | -0.062 |
| Spearmans | Lag      | and | Cvr:        |  0.565 |
| Spearmans | Lag      | and | nH:         |  0.057 |
| Spearmans | Lag_freq | and | L2_10:      |  0.188 |
|           |          |     |             |        |

*IRAS*

| Spearmans | Lag      | and | L2_10:      |  0.238 |
| Spearmans | Lag      | and | L_edd:      |    nan |
| Spearmans | Lag      | and | Edd_Frac:   |  0.245 |
| Spearmans | Lag      | and | Gamma_Relx: |  0.201 |
| Spearmans | Lag      | and | xi:         |  0.129 |
| Spearmans | Lag      | and | Fe:         |  0.179 |
| Spearmans | Lag      | and | RF:         | -0.255 |
| Spearmans | Lag      | and | Cvr:        | -0.006 |
| Spearmans | Lag      | and | nH:         | -0.087 |
| Spearmans | Lag_freq | and | L2_10:      | -0.380 |
|           |          |     |             |        |

* Correlations from results
** Lags V black hole mass

All results included for:

Everything =
=/home/steff075/phd_ecm/results-spectral/results-Final-spectra.ods=

Combined only = =/home/steff075/phd_ecm/results-spectral/results-Final-spectra-COMBINED.ods=

Hiflux only = =/home/steff075/phd_ecm/results-spectral/results-Final-spectra-HIFLUX.ods=

Loflux only = =/home/steff075/phd_ecm/results-spectral/results-Final-spectra-LOFLUX.ods=


Use =home/steff075/phd_ecm/results-spectral/correlate_Mass_Lag.py=
and the associated csv for data sets above. A spreadsheet of the results and be found at:

http://www.star.bris.ac.uk/steff/ecm/results-Final-spectra.ods

Note that NGC6860 and PG1247+267 have only one observation hance do
not appear in the lo and hi flux graphs.

*Pearson correlations*

PATH = =/home/steff075/phd_ecm/results-spectral/correlate_Mass_Lag.py=

 | All data groups |  0.724714271600611 |
 | Combined        | 0.8065292256228326 |
 | Hiflux          | 0.5932824745709216 |
 | Loflux          |  0.779542599734271 |



 *All data Groups*

PATH =/home/steff075/phd_ecm/results-spectral/correlation_Mass_ALLdata.vsz=

http://www.star.bris.ac.uk/steff/ecm/correlation_Mass_ALLdata.png

pdf at
http://www.star.bris.ac.uk/steff/ecm/correlation_Mass_ALLdata.pdf


Groups

PATH  = =/home/steff075/phd_ecm/results-spectral/correlation_Mass_ONLY.vsz=

http://www.star.bris.ac.uk/steff/ecm/correlation_Mass_ONLY.png

pdf at

http://www.star.bris.ac.uk/steff/ecm/correlation_Mass_ONLY.pdf

** Lags V black hole mass and Lagfreq

PATH  = =/home/steff075/phd_ecm/results-spectral/plot_Mass_lag_All.py=

*Lag*

#+BEGIN_EXAMPLE
Spearmans M and Lag SpearmanrResult(correlation=0.7233770091185471, pvalue=1.4620796618219798e-11)

sigma_lag: 136.948
#+END_EXAMPLE


http://www.star.bris.ac.uk/steff/ecm/Mass-lag-best-fit-sigma-ALL.png

pdf at
http://www.star.bris.ac.uk/steff/ecm/Mass-lag-best-fit-sigma-ALL.pdf

*Lagfreq*


#+BEGIN_EXAMPLE
Spearmans M and Lag_freq SpearmanrResult(correlation=-0.6626495272772351, pvalue=2.453392576182553e-09)

sigma_lag_freq: 0.001
#+END_EXAMPLE


http://www.star.bris.ac.uk/steff/ecm/Mass-lagfreq-best-fit-sigma-ALL.png

pdf at
http://www.star.bris.ac.uk/steff/ecm/Mass-lagfreq-best-fit-sigma-ALL.pdf

** Plot best fit line on all lags v mass

PATH =/home/steff075/phd_ecm/results-spectral/likelihood_mass_lag.py=




** Lags and Freq V BH Mass

Groups

PATH  = =/home/steff075/phd_ecm/results-spectral/correlation_Mass_Freq_Lag.vsz=

Pearsons correlations

Combined


http://www.star.bris.ac.uk/steff/ecm/correlation_Mass_Freq_Lag.png

pdf at

http://www.star.bris.ac.uk/steff/ecm/correlation_Mass_Freq_Lag.pdf

** Additional plots for paper - Mass V lags and Freq

PATH  = =/home/steff075/phd_ecm/results-spectral/plot_Mass_lag_All.py=


#+BEGIN_EXAMPLE
Spearmans M and Lag SpearmanrResult(correlation=0.7233770091185471, pvalue=1.4620796618219798e-11)

sigma_lag: 136.948
#+END_EXAMPLE

http://www.star.bris.ac.uk/steff/ecm/Mass-lag-ALL.png


pdf at:


http://www.star.bris.ac.uk/steff/ecm/Mass-lag-ALL.pdf

PATH  = =/home/steff075/phd_ecm/results-spectral/plot_Mass_Lagfreq_All.py=

#+BEGIN_EXAMPLE
Spearmans M and Lag_freq SpearmanrResult(correlation=-0.6626495272772351, pvalue=2.453392576182553e-09)

sigma_lag_freq: 0.001

#+END_EXAMPLE


http://www.star.bris.ac.uk/steff/ecm/Mass-lagfreq-ALL.png


pdf at:


http://www.star.bris.ac.uk/steff/ecm/Mass-lagfreq-ALL.pdf

** Lags V L2-10

Groups

PATH  = =/home/steff075/phd_ecm/results-spectral/correlation_L2-10_ONLY.vsz=

http://www.star.bris.ac.uk/steff/ecm/correlation_L2-10_ONLY.png

pdf at

http://www.star.bris.ac.uk/steff/ecm/correlation_L2-10_ONLY.pdf

** Lags V LEdd

Groups

PATH  = =/home/steff075/phd_ecm/results-spectral/correlation_Ledd_ONLY.vsz=

http://www.star.bris.ac.uk/steff/ecm/correlation_Ledd_ONLY.png

pdf at

http://www.star.bris.ac.uk/steff/ecm/correlation_Ledd_ONLY.pdf

** Lags V Edd Fraction

Groups

PATH  = =/home/steff075/phd_ecm/results-spectral/correlation_Edd_Frac_ONLY.vsz=

http://www.star.bris.ac.uk/steff/ecm/correlation_Edd_Frac_ONLY.png

pdf at

http://www.star.bris.ac.uk/steff/ecm/correlation_Edd_Frac_ONLY.pdf

** Spearman rank correlations on Mass, Luminosity and Lag

#+BEGIN_EXAMPLE
python spearman_Lum_Lag.py
#+END_EXAMPLE


*All Data*

| Spearmans | M   | and | Lag:        |  0.723 |
| Spearmans | M   | and | Lag_freq:   | -0.663 |
| Spearmans | M   | and | L2_10:      |  0.504 |
| Spearmans | M   | and | Edd_Frac:   | -0.307 |
| Spearmans | M   | and | L_edd:      |  0.965 |
| Spearmans | M   | and | Edd_ratio:  | -0.198 |
| Spearmans | M   | and | Ref_F:      |    nan |
| Spearmans | M   | and | Plaw_F:     |    nan |
| Spearmans | M   | and | Gamma_Relx: | -0.056 |
| Spearmans | M   | and | xi:         | -0.103 |
| Spearmans | M   | and | Fe:         | -0.022 |
| Spearmans | M   | and | RF:         | -0.067 |
| Spearmans | M   | and | Cvr:        |    nan |
| Spearmans | M   | and | nH:         | -0.047 |
| Spearmans | Lag | and | L2_10:      |  0.486 |
| Spearmans | Lag | and | L_edd:      |  0.762 |
| Spearmans | Lag | and | Edd_Frac:   | -0.175 |
| Spearmans | Lag | and | Ref_F:      |    nan |
| Spearmans | Lag | and | Plaw_F:     |    nan |
| Spearmans | Lag | and | Gamma_Relx: | -0.143 |
| Spearmans | Lag | and | xi:         | -0.102 |
| Spearmans | Lag | and | Fe:         |  0.059 |
| Spearmans | Lag | and | RF:         |  0.086 |
| Spearmans | Lag | and | nH:         | -0.058 |


Lag - Cvr SpearmanrResult(correlation=0.15867362368937052, pvalue=0.32174301256107)


*Combined*

| Spearmans | M   | and | Lag:        |  0.817 |
| Spearmans | M   | and | Lag_freq:   | -0.709 |
| Spearmans | M   | and | L2_10:      |  0.548 |
| Spearmans | M   | and | Edd_Frac:   | -0.169 |
| Spearmans | M   | and | L_edd:      |  0.982 |
| Spearmans | M   | and | Edd_ratio:  | -0.034 |
| Spearmans | M   | and | Ref_F:      |    nan |
| Spearmans | M   | and | Plaw_F:     |  0.014 |
| Spearmans | M   | and | Gamma_Relx: |  0.120 |
| Spearmans | M   | and | xi:         | -0.127 |
| Spearmans | M   | and | Fe:         |  0.018 |
| Spearmans | M   | and | RF:         |  0.103 |
| Spearmans | M   | and | Cvr:        |    nan |
| Spearmans | M   | and | nH:         | -0.195 |
| Spearmans | Lag | and | L2_10:      |  0.470 |
| Spearmans | Lag | and | L_edd:      |  0.860 |
| Spearmans | Lag | and | Edd_Frac:   | -0.138 |
| Spearmans | Lag | and | Ref_F:      |    nan |
| Spearmans | Lag | and | Plaw_F:     | -0.041 |
| Spearmans | Lag | and | Gamma_Relx: |  0.035 |
| Spearmans | Lag | and | xi:         | -0.091 |
| Spearmans | Lag | and | Fe:         |  0.027 |
| Spearmans | Lag | and | RF:         |  0.203 |
| Spearmans | Lag | and | Cvr:        |    nan |
| Spearmans | Lag | and | nH:         | -0.217 |

*HI-FLUX*

| Spearmans | M   | and | Lag:        |  0.806 |
| Spearmans | M   | and | Lag_freq:   | -0.685 |
| Spearmans | M   | and | L2_10:      |  0.589 |
| Spearmans | M   | and | Edd_Frac:   | -0.309 |
| Spearmans | M   | and | L_edd:      |  0.981 |
| Spearmans | M   | and | Edd_ratio:  | -0.129 |
| Spearmans | M   | and | Ref_F:      |    nan |
| Spearmans | M   | and | Plaw_F:     |  0.176 |
| Spearmans | M   | and | Gamma_Relx: |  0.102 |
| Spearmans | M   | and | xi:         | -0.084 |
| Spearmans | M   | and | Fe:         | -0.282 |
| Spearmans | M   | and | RF:         |  0.028 |
| Spearmans | M   | and | Cvr:        |    nan |
| Spearmans | M   | and | nH:         | -0.061 |
| Spearmans | Lag | and | L2_10:      |  0.428 |
| Spearmans | Lag | and | L_edd:      |  0.839 |
| Spearmans | Lag | and | Edd_Frac:   | -0.350 |
| Spearmans | Lag | and | Ref_F:      |    nan |
| Spearmans | Lag | and | Plaw_F:     |  0.399 |
| Spearmans | Lag | and | Gamma_Relx: | -0.057 |
| Spearmans | Lag | and | xi:         | -0.032 |
| Spearmans | Lag | and | Fe:         | -0.004 |
| Spearmans | Lag | and | RF:         | -0.264 |
| Spearmans | Lag | and | Cvr:        |    nan |
| Spearmans | Lag | and | nH:         |  0.055 |

*LO-FLUX*

| Spearmans | M   | and | Lag:        |  0.573 |
| Spearmans | M   | and | Lag_freq:   | -0.680 |
| Spearmans | M   | and | L2_10:      |  0.513 |
| Spearmans | M   | and | Edd_Frac:   | -0.395 |
| Spearmans | M   | and | L_edd:      |  0.981 |
| Spearmans | M   | and | Edd_ratio:  | -0.129 |
| Spearmans | M   | and | Ref_F:      |    nan |
| Spearmans | M   | and | Plaw_F:     |  0.222 |
| Spearmans | M   | and | Gamma_Relx: |  0.201 |
| Spearmans | M   | and | xi:         | -0.289 |
| Spearmans | M   | and | Fe:         | -0.012 |
| Spearmans | M   | and | RF:         | -0.047 |
| Spearmans | M   | and | Cvr:        |    nan |
| Spearmans | M   | and | nH:         |  0.019 |
| Spearmans | Lag | and | L2_10:      |  0.420 |
| Spearmans | Lag | and | L_edd:      |  0.567 |
| Spearmans | Lag | and | Edd_Frac:   | -0.053 |
| Spearmans | Lag | and | Ref_F:      |    nan |
| Spearmans | Lag | and | Plaw_F:     | -0.390 |
| Spearmans | Lag | and | Gamma_Relx: | -0.173 |
| Spearmans | Lag | and | xi:         | -0.171 |
| Spearmans | Lag | and | Fe:         |  0.120 |
| Spearmans | Lag | and | RF:         |  0.522 |
| Spearmans | Lag | and | Cvr:        |    nan |
| Spearmans | Lag | and | nH:         |  0.060 |


** Lags V L2-10 and LEdd composite plot

Groups

PATH  = =/home/steff075/phd_ecm/results-spectral/correlation_Lags_Ledd_L2-10_composite.vsz=

http://www.star.bris.ac.uk/steff/ecm/correlation_Lags_Ledd_L2-10_composite.png


pdf at

http://www.star.bris.ac.uk/steff/ecm/correlation_Lags_Ledd_L2-10_composite.pdf

** Lags V CvrFrac

PATH  = =/home/steff075/phd_ecm/results-spectral/correlation_Cvr_ONLY.vsz=



#+BEGIN_EXAMPLE

All data
Lag - Cvr SpearmanrResult(correlation=0.15867362368937052,
pvalue=0.32174301256107)


Combined
Lag - Cvr SpearmanrResult(correlation=0.1576135330644099, pvalue=0.6070724334878848)

Hiflux
Lag - Cvr SpearmanrResult(correlation=0.30395277184003233, pvalue=0.3932011151432977)

Loflux
Lag - Cvr SpearmanrResult(correlation=-0.16788736670484342, pvalue=0.6217075984283869)


#############################################

There appears to be no correlation with the Lag and Covering fraction

############################################

#+END_EXAMPLE


http://www.star.bris.ac.uk/steff/ecm/correlation_Cvr_ONLY.png


pdf at

http://www.star.bris.ac.uk/steff/ecm/correlation_Cvr_ONLY.pdf


** nH V Cvr Fraction

#+BEGIN_EXAMPLE
All data

nH - Cvr SpearmanrResult(correlation=0.34388100840394265, pvalue=0.027704739602906227)


Combined

nH - Cvr SpearmanrResult(correlation=-0.03621521180082831, pvalue=0.9064989448508673)


#############################################

There appears to be no correlation with the nH and Covering fraction

############################################


#+END_EXAMPLE


** Lags V powerlaw Gamma

PATH =
=/home/steff075/phd_ecm/results-spectral/correlate_lag_powerlawGamma.py=

#+BEGIN_EXAMPLE


All data
Lag - Gamma_Plaw SpearmanrResult(correlation=-0.2569230593279063, pvalue=0.040421487177772594)


Combined
Lag - Gamma_Plaw SpearmanrResult(correlation=-0.12561114088755065, pvalue=0.5977234210548006)

Hiflux
Lag - Gamma_Plaw SpearmanrResult(correlation=-0.37254901960784315, pvalue=0.12787268607330357)

Loflux
Lag - Gamma_Plaw SpearmanrResult(correlation=-0.17853457172342618, pvalue=0.4784449329228029)

#+END_EXAMPLE

* *Polyfits - log plots of correlations to ALL data groups*
** Lags and Mass polyfits to ALL data groups

PATH =/home/steff075/phd_ecm/results-spectral/correlate_mass_lag.py=

#+BEGIN_EXAMPLE

mean_M: 30043798.971
sigma_M: 103051311.195
mean_Lag: 118.105
sigma_Lag: 136.948
log_sig_lag: 4.920
#+END_EXAMPLE

http://www.star.bris.ac.uk/steff/ecm/Mass_lag_log_polyfit_ALL.png


pdf at:

http://www.star.bris.ac.uk/steff/ecm/Mass_lag_log_polyfit_ALL.pdf



PATH = =/home/steff075/phd_ecm/results-spectral/correlate_mass_freq.py=


#+BEGIN_EXAMPLE
sigma_Lag-freq = 0.00

#+END_EXAMPLE

http://www.star.bris.ac.uk/steff/ecm/Mass_lag_freq_log_polyfit_ALL.png

pdf at:

http://www.star.bris.ac.uk/steff/ecm/Mass_lag_freq_log_polyfit_ALL.pdf



** Lags and L2-10 keV polyfits to ALL data groups

PATH =/home/steff075/phd_ecm/results-spectral/correlate_lag_lum.py=

#+BEGIN_EXAMPLE
Spearmas Lag - Lum = 0.4863, pvalue =4.609e-5


#+END_EXAMPLE

http://www.star.bris.ac.uk/steff/ecm/Lag_L2_10_log_polyfit_ALL.png


pdf at:

http://www.star.bris.ac.uk/steff/ecm/Lag_L2_10_log_polyfit_ALL.pdf







** Lags and Ledd polyfits to ALL data groups

PATH =/home/steff075/phd_ecm/results-spectral/correlate_lag_Ledd.py=

#+BEGIN_EXAMPLE
Lag - L_edd SpearmanrResult(correlation=0.7619347253013891, pvalue=2.633668802586504e-13)
#+END_EXAMPLE

http://www.star.bris.ac.uk/steff/ecm/Lag_Ledd_log_polyfit_ALL.png


pdf at:

http://www.star.bris.ac.uk/steff/ecm/Lag_Ledd_log_polyfit_ALL.pdf






** Lags and Edd Frac polyfits to ALL data groups

PATH =/home/steff075/phd_ecm/results-spectral/correlate_lag_Edd_frac.py=

#+BEGIN_EXAMPLE
Lag - Edd_Frac SpearmanrResult(correlation=-0.1745292198614729, pvalue=0.16779380597686153)
#+END_EXAMPLE

http://www.star.bris.ac.uk/steff/ecm/Lag_Edd_frac_log_polyfit_ALL.png


pdf at:

http://www.star.bris.ac.uk/steff/ecm/Lag_Edd_frac_log_polyfit_ALL.pdf

** Mass and L2-10keV polyfits to ALL data groups

PATH =/home/steff075/phd_ecm/results-spectral/correlate_mass_l2-10.py=

#+BEGIN_EXAMPLE
L_L2_10 - M SpearmanrResult(correlation=0.3495375525425479, pvalue=0.004639094745271498)
mean_M: 30043798.971
sigma_M: 103051311.195
mean_L2_10: 220989240625000004218616763568949110824239104.000
sigma_L2_10: 1660476373689999403389439316152484241076125696.000

#+END_EXAMPLE

http://www.star.bris.ac.uk/steff/ecm/Mass_L2-10_log_polyfit_ALL.png


pdf


http://www.star.bris.ac.uk/steff/ecm/Mass_L2-10_log_polyfit_ALL.pdf



** Mass and Lbol polyfits to ALL data groups

PATH =/home/steff075/phd_ecm/results-spectral/correlate_mass_lbol.py=

#+BEGIN_EXAMPLE
L_bol - M SpearmanrResult(correlation=0.3495375525425479, pvalue=0.004639094745271498)
mean_M: 30043798.971
sigma_M: 103051311.195
mean_L_bol: 5208939109375001874579231921339157398757048320.000
sigma_L_bol: 27162465269382021804440296444333394429787242496.000


#+END_EXAMPLE

http://www.star.bris.ac.uk/steff/ecm/Mass_Lbol_log_polyfit_ALL.png


pdf


http://www.star.bris.ac.uk/steff/ecm/Mass_Lbol_log_polyfit_ALL.pdf


* *1H0419-577*

1H0419−577 hosts a supermassive black hole with MBH=1.3×108M by
measuring its Hβline width (FW H M=2580±200km s−1Grupe et al. 2010).

That is Log 8.11 M/M

** Combined

Lets just have a look at the combined flux state lag-frequencies >1e-4 Hz:

use =lagfreq_multi_script.sl=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/ _lagfreq_comb.gif

Lags found in
=/homeb/steff075/phd_ecm//time_lags_comb2.csv=

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped

** Low - High Flux state results

Lets just have a look at the low and high flux state lag-frequencies:

use =lagfreq_multi_script.sl=

*Low flux*

Recall from the spectral fitting:
#+BEGIN_EXAMPLE

#+END_EXAMPLE

Group 1  = Hi flux and Group 2 & 3 = Lo Flux

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/ _lagfreq_lo_flux.PNG

Lags found in =/homeb/steff075/phd_ecm//lagvalues-lo-flux.csv=

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped



*High flux*

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/ lagfreq_hi_flux.PNG

Lags found:
file =/homeb/steff075/phd_ecm//time_lags_hi-flux2.csv=


#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped



Lets combine these results in Veusz

Use =homeb/steff075/phd_ecm//lag-results.ods= to obtain
the csv

Plot =homeb/steff075/phd_ecm//lag-results-lo-hi.vsz=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/ -lag-results-lo-hi-flux.png

*Genegenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28
accordingly. Run fits files to check:

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("-time-lags-combined.fits");
r=load_rmf("-time-lags-combined.rsp");
%d=load_data("-time-lags-lo-flux.fits");
%r=load_rmf("-time-lags-lo-flux.rsp");
%d=load_data("-time-lags-hi-flux.fits");
%r=load_rmf("-time-lags-hi-flux.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

Now copy these the BC4 for fitting to ECM model, e.g:

#+BEGIN_EXAMPLE
scp -time-lags-hi-flux.fits so14935@bc4login.acrc.bris.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/NGC7314-time-lag-fits
#+END_EXAMPLE

** 1H0419-577 Observation 0604720301 2010

Observation Start date 2010-05-30 Exp = 106 ks (100ks eff)

PATH TO DATA =/data/scratch3/steff/1H0419-577/=

*** Preprocessing
Unzip and pre-process in ODF directory

#+BEGIN_EXAMPLE
tar -zxvf

tar xvf

heainit
setsas
setenv SAS_CCFPATH /usr/local/XMM/ccf/
setenv SAS_ODF /data/scratch3/steff/1H0419-577/0604720301/ODF
cifbuild
setenv SAS_CCF ccf.cif
odfingest
#+END_EXAMPLE

Reset ODF variable
#+BEGIN_EXAMPLE
setenv SAS_ODF /data/scratch3/steff/1H0419-577/0604720301/ODF/Name of SUM.SAS
#+END_EXAMPLE

Copy summary and cif files to PROC directory:

#+BEGIN_EXAMPLE
cp ccf.cif /data/scratch3/steff/1H0419-577/0604720301/ODF

cp 0159_0110890201_SCX00000SUM.SAS /data/scratch3/steff/1H0419-577/0604720301/PROC

#+END_EXAMPLE

Move to Proc Directory

Create events files from the PN carmeras

#+BEGIN_EXAMPLE
epproc randomizetime=no randomizeposition=no randomizeenergy=no
#+END_EXAMPLE

Change name of imaging events to EPIC.fits for processing

*** Create lightcurve

#+BEGIN_EXAMPLE
evselect table=EPIC.fits withrateset=yes rateset=PN_flares_lc.fits maketimecolumn=yes timebinsize=100 makeratecolumn=yes expression='#XMMEA_EP && (PI>10000&&PI<12000) && (PATTERN==0)'
#+END_EXAMPLE

#+BEGIN_EXAMPLE
dsplot table=PN_flares_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

http://www.star.bris.ac.uk/steff/1H0419-577/1H0419-577_0604720301_PN_flares_lc.png

*** Remove flared region

The table ran from 391591000  to 391696000 (106 ks) and flares were removed from 391596000
to the end of the observation to give an effective time of  100 ks.

#+BEGIN_EXAMPLE
evselect table=EPIC.fits withfilteredset=yes filteredset=EPICclean.fits filtertype=expression  expression='TIME in [391596000:391696000]' keepfilteroutput=yes updateexposure=yes
#+END_EXAMPLE

Create the new light curve

#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withrateset=yes rateset=EPICclean_lc.fits maketimecolumn=yes timebinsize=100 makeratecolumn=yes timemin=391596000 timemax=391696000

dsplot table=EPICclean_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

http://www.star.bris.ac.uk/steff/1H0419-577/1H0419-577_0604720301_EPICclean_lc.png

*** Create image

#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withimageset=yes imageset=EPICclean_image.fits xcolumn=X ycolumn=Y imagebinning=imageSize ximagesize=600 yimagesize=600


ds9 EPICclean_image.fits
#+END_EXAMPLE

Scale = log, Bin = Block 16, Zoom = Zoom 4

Select Regions for source and background extraction. Areas selected for extraction are :

Source: 24425.75,27188,700

Background: 27746.25,29087.5,700

http://www.star.bris.ac.uk/steff/1H0419-577/1H0419-577_0604720301_SrcBkg_Regions.png

*** Post processing

Edit and run =sas_postproc_script.sl=

*** Check pileup

=PN_time_epat.ps= showed that no significant pileup is evident:

http://www.star.bris.ac.uk/steff/1H0419-577/1H0419-577_0604720301_Pileup.png

*** Group Spectral files

Create RMF and ARF files

#+BEGIN_EXAMPLE
heainit
setsas
setenv SAS_CCFPATH /usr/local/XMM/ccf/
setenv SAS_CCF ccf.cif


rmfgen rmfset=PN_time_0.3-10_src_pi_rmf.fits spectrumset=PN_time_0.3-10_src_pi.fits

arfgen arfset=PN_time_0.3-10_src_pi_arf.fits spectrumset=PN_time_0.3-10_src_pi.fits withrmfset=yes rmfset=PN_time_0.3-10_src_pi_rmf.fits withbadpixcorr=yes badpixlocation=PN_time_0.3-10.fits

grppha
PN_time_0.3-10_src_pi.fits
PN_time_0.3-10_pi_grp.fits
chkey BACKFILE PN_time_0.3-10_bkg_pi.fits
chkey RESPFILE PN_time_0.3-10_src_pi_rmf.fits
chkey ANCRFILE PN_time_0.3-10_src_pi_arf.fits
group min 25
exit

#+END_EXAMPLE

*** Create some lightcurves

#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withrateset=yes rateset=0604720301_0.3-10keV.fits maketimecolumn=yes timebinsize=300 makeratecolumn=yes expression='(FLAG==0)&&(PATTERN<=4)&&(PI in [300:10000])&&#XMMEA_EP'

dsplot table=0604720301_0.3-10keV.fits x=TIME y=RATE ymin=0 ymax=25 xmin=391596000  xmax=391696000 &
#+END_EXAMPLE

http://www.star.bris.ac.uk/steff/1H0419-577/1H0419-577_0604720301_0.3-10keV_lc.png


Rebin and create background subtracted lightcurves (0.8 and 1-4 keV)

#+BEGIN_EXAMPLE
evselect table=PN_time_soft_src.fits withrateset=yes rateset=PN_time_soft_src_lc.fits maketimecolumn=yes timecolumn=TIME timebinsize=300 makeratecolumn=yes timemin=391596000 timemax=391696000

evselect table=PN_time_soft_bkg.fits withrateset=yes rateset=PN_time_soft_bkg_lc.fits maketimecolumn=yes timecolumn=TIME timebinsize=300 makeratecolumn=yes timemin=391596000 timemax=391696000

epiclccorr srctslist=PN_time_soft_src_lc.fits eventlist=EPICclean.fits outset=0604720301_corrected_0.3-0.8keV.fits bkgtslist=PN_time_soft_bkg_lc.fits withbkgset=yes applyabsolutecorrections=yes

dsplot table=0604720301_corrected_0.3-0.8keV.fits x=TIME y=RATE ymin=0 &

evselect table=PN_time_hard_src.fits withrateset=yes rateset=PN_time_hard_src_lc.fits maketimecolumn=yes timecolumn=TIME timebinsize=300 makeratecolumn=yes timemin=391596000 timemax=391696000

evselect table=PN_time_hard_bkg.fits withrateset=yes rateset=PN_time_hard_bkg_lc.fits maketimecolumn=yes timecolumn=TIME timebinsize=300 makeratecolumn=yes timemin=391596000 timemax=391696000

epiclccorr srctslist=PN_time_hard_src_lc.fits eventlist=EPICclean.fits outset=0604720301_corrected_1-4keV.fits bkgtslist=PN_time_hard_bkg_lc.fits withbkgset=yes applyabsolutecorrections=yes

dsplot table=0604720301_corrected_1-4keV.fits x=TIME y=RATE ymin=0 &

#+END_EXAMPLE


http://www.star.bris.ac.uk/steff/1H0419-577/1H0419-577_0604720301_corrected_0.3-0.8keV_lc.png


http://www.star.bris.ac.uk/steff/1H0419-577/1H0419-577_0604720301_corrected_1-4keV_lc.png

*** Lag-frequency & Lag energy

edit and run =lagfreq_script.sl=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/1H0419-577/1H0419-577_0604720301_lagfreq.gif

Lag values:

#+BEGIN_EXAMPLE
1.163636e-04,-3.144039e+03,4.583701e+02
2.221488e-04,6.787279e+02,6.147106e+02
4.241022e-04,-4.727228e+02,4.328929e+02
8.096496e-04,4.766543e+02,9.601993e+01
1.545695e-03,-7.270744e+01,2.824085e+02
2.950872e-03,-2.120014e+01,3.915122e+01
5.633482e-03,-4.247423e+00,2.131143e+01
#+END_EXAMPLE


edit and run =sas_lagen_script1.py=

edit and run =isis_lagen_lf_script.sl= and =isis_lagen_hf_script.sl=

Low frequency 3.0 - 8.0e-04 Hz
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/1H0419-577/1H0419-577_0604720301_lagen_lf.gif

Lag values:
#+BEGIN_EXAMPLE
3.500000e+02,9.431841e+02,1.922738e+02
4.500000e+02,-7.715918e+02,2.360668e+02
5.500000e+02,5.246820e+02,3.395134e+02
7.000000e+02,8.037629e+02,1.222118e+02
9.000000e+02,-6.769884e+02,2.153126e+02
1.150000e+03,-7.609971e+02,2.631311e+02
1.650000e+03,-7.812358e+02,6.464831e+02
2.500000e+03,8.941641e+02,1.632886e+02
3.500000e+03,-9.967419e+02,5.175315e+02
4.500000e+03,-9.330974e+02,3.393971e+02
6.000000e+03,4.199718e+02,4.190198e+03
8.500000e+03,-6.263480e+02,2.784995e+02

#+END_EXAMPLE

Low frequency 1.0 - 5.0e-03 Hz
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/1H0419-577/1H0419-577_0604720301_lagen_hf.gif


#+BEGIN_EXAMPLE
3.500000e+02,-5.735905e+00,4.792770e+01
4.500000e+02,1.622891e+02,8.343696e+01
5.500000e+02,7.493578e+01,3.569283e+01
7.000000e+02,-8.058827e+01,5.577734e+01
9.000000e+02,8.455287e+01,9.023108e+01
1.150000e+03,9.722710e+00,4.196072e+01
1.650000e+03,-6.020471e+01,8.335259e+01
2.500000e+03,-1.287709e+01,2.222552e+01
3.500000e+03,-5.198691e+01,3.835726e+01
4.500000e+03,-1.624393e+02,8.497423e+01
6.000000e+03,-2.099705e+02,6.964566e+01
8.500000e+03,5.525739e+01,4.811524e+01

#+END_EXAMPLE

** 1H0419-577 Observation 0604720401 2010

Observation Start date 2010-05-28 Exp = 60 ks (60ks eff)

PATH TO DATA =/data/scratch3/steff/1H0419-577/=

*** Preprocessing
Unzip and pre-process in ODF directory

#+BEGIN_EXAMPLE
tar -zxvf

tar xvf

heainit
setsas
setenv SAS_CCFPATH /usr/local/XMM/ccf/
setenv SAS_ODF /data/scratch3/steff/1H0419-577/0604720401/ODF
cifbuild
setenv SAS_CCF ccf.cif
odfingest
#+END_EXAMPLE

Reset ODF variable
#+BEGIN_EXAMPLE
setenv SAS_ODF /data/scratch3/steff/1H0419-577/0604720401/ODF/Name of SUM.SAS
#+END_EXAMPLE

Copy summary and cif files to PROC directory:

#+BEGIN_EXAMPLE
cp ccf.cif /data/scratch3/steff/1H0419-577/0604720401/ODF

cp 0159_0110890201_SCX00000SUM.SAS /data/scratch3/steff/1H0419-577/0604720401/PROC

#+END_EXAMPLE

Move to Proc Directory

Create events files from the PN carmeras

#+BEGIN_EXAMPLE
epproc randomizetime=no randomizeposition=no randomizeenergy=no
#+END_EXAMPLE

Change name of imaging events to EPIC.fits for processing

*** Create lightcurve

#+BEGIN_EXAMPLE
evselect table=EPIC.fits withrateset=yes rateset=PN_flares_lc.fits maketimecolumn=yes timebinsize=100 makeratecolumn=yes expression='#XMMEA_EP && (PI>10000&&PI<12000) && (PATTERN==0)'
#+END_EXAMPLE

#+BEGIN_EXAMPLE
dsplot table=PN_flares_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

http://www.star.bris.ac.uk/steff/1H0419-577/1H0419-577_0604720401_PN_flares_lc.png

*** Remove flared region

The table ran from 391463000 to 391524000 (61 ks) and no flares were removed

Create the new light curve

#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withrateset=yes rateset=EPICclean_lc.fits maketimecolumn=yes timebinsize=100 makeratecolumn=yes

dsplot table=EPICclean_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

http://www.star.bris.ac.uk/steff/1H0419-577/1H0419-577_0604720401_EPICclean_lc.png

*** Create image

#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withimageset=yes imageset=EPICclean_image.fits xcolumn=X ycolumn=Y imagebinning=imageSize ximagesize=600 yimagesize=600


ds9 EPICclean_image.fits
#+END_EXAMPLE

Scale = log, Bin = Block 16, Zoom = Zoom 4

Select Regions for source and background extraction. Areas selected for extraction are :

Source: 24425.75,28079.75,700

Background: 27797,29232.5,700

http://www.star.bris.ac.uk/steff/1H0419-577/1H0419-577_0604720401_SrcBkg_Regions.png

*** Post processing

Edit and run =sas_postproc_script.sl=

*** Check pileup

=PN_time_epat.ps= showed that no significant pileup is evident:

http://www.star.bris.ac.uk/steff/1H0419-577/1H0419-577_0604720401_Pileup.png

*** Group Spectral files

Create RMF and ARF files

#+BEGIN_EXAMPLE
heainit
setsas
setenv SAS_CCFPATH /usr/local/XMM/ccf/
setenv SAS_CCF ccf.cif


rmfgen rmfset=PN_time_0.3-10_src_pi_rmf.fits spectrumset=PN_time_0.3-10_src_pi.fits

arfgen arfset=PN_time_0.3-10_src_pi_arf.fits spectrumset=PN_time_0.3-10_src_pi.fits withrmfset=yes rmfset=PN_time_0.3-10_src_pi_rmf.fits withbadpixcorr=yes badpixlocation=PN_time_0.3-10.fits

grppha
PN_time_0.3-10_src_pi.fits
PN_time_0.3-10_pi_grp.fits
chkey BACKFILE PN_time_0.3-10_bkg_pi.fits
chkey RESPFILE PN_time_0.3-10_src_pi_rmf.fits
chkey ANCRFILE PN_time_0.3-10_src_pi_arf.fits
group min 25
exit

#+END_EXAMPLE

*** Create some lightcurves

#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withrateset=yes rateset=0604720401_0.3-10keV.fits maketimecolumn=yes timebinsize=300 makeratecolumn=yes expression='(FLAG==0)&&(PATTERN<=4)&&(PI in [300:10000])&&#XMMEA_EP'

dsplot table=0604720401_0.3-10keV.fits x=TIME y=RATE ymin=0 &
#+END_EXAMPLE

http://www.star.bris.ac.uk/steff/1H0419-577/1H0419-577_0604720401_0.3-10keV_lc.png


Rebin and create background subtracted lightcurves (0.8 and 1-4 keV)

#+BEGIN_EXAMPLE
evselect table=PN_time_soft_src.fits withrateset=yes rateset=PN_time_soft_src_lc.fits maketimecolumn=yes timecolumn=TIME timebinsize=300 makeratecolumn=yes

evselect table=PN_time_soft_bkg.fits withrateset=yes rateset=PN_time_soft_bkg_lc.fits maketimecolumn=yes timecolumn=TIME timebinsize=300 makeratecolumn=yes

epiclccorr srctslist=PN_time_soft_src_lc.fits eventlist=EPICclean.fits outset=0604720401_corrected_0.3-0.8keV.fits bkgtslist=PN_time_soft_bkg_lc.fits withbkgset=yes applyabsolutecorrections=yes

dsplot table=0604720401_corrected_0.3-0.8keV.fits x=TIME y=RATE ymin=0 &

evselect table=PN_time_hard_src.fits withrateset=yes rateset=PN_time_hard_src_lc.fits maketimecolumn=yes timecolumn=TIME timebinsize=300 makeratecolumn=yes

evselect table=PN_time_hard_bkg.fits withrateset=yes rateset=PN_time_hard_bkg_lc.fits maketimecolumn=yes timecolumn=TIME timebinsize=300 makeratecolumn=yes

epiclccorr srctslist=PN_time_hard_src_lc.fits eventlist=EPICclean.fits outset=0604720401_corrected_1-4keV.fits bkgtslist=PN_time_hard_bkg_lc.fits withbkgset=yes applyabsolutecorrections=yes

dsplot table=0604720401_corrected_1-4keV.fits x=TIME y=RATE ymin=0 &

#+END_EXAMPLE


http://www.star.bris.ac.uk/steff/1H0419-577/1H0419-577_0604720401_corrected_0.3-0.8keV_lc.png


http://www.star.bris.ac.uk/steff/1H0419-577/1H0419-577_0604720401_corrected_1-4keV_lc.png

*** Lag-frequency & Lag energy

edit and run =lagfreq_script.sl=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/1H0419-577/1H0419-577_0604720401_lagfreq.gif

Lag values:

#+BEGIN_EXAMPLE
1.163636e-04,3.901800e+03,5.199853e+02
2.221488e-04,-1.505389e+03,8.340184e+02
4.241022e-04,9.837062e+02,1.585670e+02
8.096496e-04,4.330280e+02,1.785424e+02
1.545695e-03,1.569313e+02,7.603274e+01
2.950872e-03,-9.927628e+01,2.904817e+01
5.633482e-03,8.316447e+01,2.903627e+01
#+END_EXAMPLE


edit and run =sas_lagen_script1.py=

edit and run =isis_lagen_lf_script.sl= and =isis_lagen_hf_script.sl=

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/1H0419-577/1H0419-577_0604720401_lagen_lf.gif

Lag values:

#+BEGIN_EXAMPLE
3.500000e+02,3.832525e+03,5.778443e+03
4.500000e+02,-3.610433e+03,1.047434e+03
5.500000e+02,1.194920e+03,6.551243e+02
7.000000e+02,-4.508167e+02,1.717433e+03
9.000000e+02,-2.026190e+03,7.212651e+02
1.150000e+03,2.010213e+03,6.616181e+02
1.650000e+03,2.346681e+02,2.689386e+03
2.500000e+03,1.520458e+03,4.777940e+02
3.500000e+03,-2.297683e+03,1.008720e+03
4.500000e+03,2.096144e+03,9.804245e+02
6.000000e+03,-2.582043e+03,4.956619e+02
8.500000e+03,-1.493635e+02,4.341332e+02
#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/1H0419-577/1H0419-577_0604720401_lagen_hf.gif

Lag values:

#+BEGIN_EXAMPLE
3.500000e+02,-1.101238e+03,5.485832e+02
4.500000e+02,-9.482087e+02,5.341981e+02
5.500000e+02,-9.725161e+02,3.949053e+02
7.000000e+02,1.236999e+03,1.656348e+03
9.000000e+02,-9.755839e+02,2.818257e+02
1.150000e+03,5.573190e+02,3.054563e+02
1.650000e+03,-1.248294e+03,2.850833e+02
2.500000e+03,8.868560e+02,4.827835e+02
3.500000e+03,1.092951e+03,3.263010e+02
4.500000e+03,4.947307e+02,2.337320e+02
6.000000e+03,-9.701522e+01,4.327482e+02
8.500000e+03,3.915182e+02,2.754795e+02
#+END_EXAMPLE

** 1H0419-577 Combined

*** Lag-frequency & Lag energy

edit and run =lagfreq_script.sl=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/1H0419-577/1H0419-577_combined_lagfreq.gif

Lag values:

#+BEGIN_EXAMPLE
1.163636e-04,-4.041099e+03,5.045605e+02
2.221488e-04,3.432929e+02,2.238215e+03
4.241022e-04,-1.238767e+03,5.956913e+02
8.096496e-04,4.643431e+02,8.590867e+01
1.545695e-03,1.161471e+02,1.504644e+02
2.950872e-03,-5.772006e+01,3.202940e+01
5.633482e-03,2.242886e-01,4.223359e+01

#+END_EXAMPLE


edit and run =lagen_comb_lf_script.sl=

Low freq;

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/1H0419-577/1H0419-577_comb_lagen_lf.gif

#+BEGIN_EXAMPLE
3.500000e+02,2.826448e+03,5.295162e+02
4.500000e+02,-3.759864e+03,6.129998e+02
5.500000e+02,1.433098e+03,4.133543e+02
7.000000e+02,-3.484635e+03,9.081960e+02
9.000000e+02,-2.921224e+03,1.463780e+03
1.150000e+03,2.356272e+03,8.416316e+02
1.650000e+03,-2.229055e+03,1.988665e+03
2.500000e+03,-3.105019e+03,1.060974e+03
3.500000e+03,-2.189004e+03,6.591387e+02
4.500000e+03,-2.133151e+03,2.070871e+03
6.000000e+03,-2.106176e+03,7.430202e+02
8.500000e+03,-5.314622e+02,4.231598e+02

#+END_EXAMPLE


edit and run =lagen_comb_hf_script.sl=

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/1H0419-577/1H0419-577_comb_lagen_hf.gif

#+BEGIN_EXAMPLE
3.500000e+02,-1.005503e+03,2.883898e+02
4.500000e+02,-1.248941e+03,1.057080e+03
5.500000e+02,1.024650e+03,3.812890e+02
7.000000e+02,9.749625e+02,2.291557e+02
9.000000e+02,-8.941736e+02,1.377857e+02
1.150000e+03,8.953454e+02,6.145508e+02
1.650000e+03,-1.020236e+03,4.349377e+02
2.500000e+03,8.987720e+02,2.158593e+02
3.500000e+03,1.053274e+03,2.427389e+02
4.500000e+03,8.103087e+02,5.005091e+02
6.000000e+03,3.136352e+02,1.063795e+03
8.500000e+03,-2.651213e+02,3.182864e+02

#+END_EXAMPLE

* *1H0707-495*
** Spectra and flux
Lets have a look at the flux states for each data set by examinining
the spectra

USE =/home/steff075/phd_ecm/1h0707/multi_spectra_unfold_Grp1.sl=

Data Flux

#+BEGIN_EXAMPLE
isis> data_flux;

 (photon_flux, pflux_err, energy_flux, eflux_err) = data_flux(indx,lo,hi [; unit=string, pc=value, print]);

   Returns data fluxes (via flux_corr/get_data_flux) for data set indx evaluated over
   energy interval (keV) bounded by lo, hi. Error is error of the mean value of the flux.
   Outputs are units of:

      photons/cm^2/s, photons/cm^2/s, ergs/cm^2/s, ergs/cm^2/s  (if pc=NULL [DEFAULT])
      photons/s, photons/s, ergs/s, ergs/s                      (if pc>0)

   Optional qualifiers:

      unit  = Units (case insensitive string) for the values of lo, hi (default="kev")
      pc    = distance, in parsec, to the source (default=NULL)
      print - if exists, print results to screen without returning values (default off)

   See also:  model_flux, calc_flux
#+END_EXAMPLE

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_Spectra_all-NEW.gif


+------+-------------+------+-------------+------------------------+------------------------+------------------------+-----------------------+-------------+
| Data | Observation | Year | Colour      |     P-flux(0.3-10 kev) |                     +- | energy-flux(0.3-10keV) |                    +- | Exp (k/sec) |
+------+-------------+------+-------------+------------------------+------------------------+------------------------+-----------------------+-------------+
|    1 |  0110890201 | 2000 | black       |   3.58754648853547e-14 |  2.202915514389372e-12 |  9.802404306954798e-05 |   0.00206231024239426 |          41 |
+------+-------------+------+-------------+------------------------+------------------------+------------------------+-----------------------+-------------+
|    2 |  0148010301 | 2002 | red         |  3.517912127448938e-14 |   6.93891564447319e-12 |  0.0001039868985026403 |  0.006158730548237249 |          76 |
+------+-------------+------+-------------+------------------------+------------------------+------------------------+-----------------------+-------------+
|    3 |  0506200201 | 2007 | green       | 3.6792182073568214e-14 | 1.2733304026138922e-12 |  6.828443567429727e-05 | 0.0011691361330859575 |          38 |
+------+-------------+------+-------------+------------------------+------------------------+------------------------+-----------------------+-------------+
|    4 |  0506200301 | 2007 | blue        |   4.15009272014303e-14 |    3.7181104474847e-12 | 0.00011136779801245108 | 0.0034114238533176264 |          39 |
+------+-------------+------+-------------+------------------------+------------------------+------------------------+-----------------------+-------------+
|    5 |  0506200401 | 2007 | cyan        |  5.800527023237549e-14 |  7.740696360466725e-12 | 0.00015659762750319146 |  0.006996813582953083 |          41 |
+------+-------------+------+-------------+------------------------+------------------------+------------------------+-----------------------+-------------+
|    6 |  0506200501 | 2007 | magenta     |  5.843840622117871e-14 |  9.707245234938068e-12 | 0.00017092903316170475 |   0.00866170212880123 |          41 |
+------+-------------+------+-------------+------------------------+------------------------+------------------------+-----------------------+-------------+
|    7 |  0511580101 | 2008 | yellow      | 2.7856046974749922e-14 |  6.228975032214473e-12 |  8.336746905265116e-05 |  0.005510113055301409 |         111 |
+------+-------------+------+-------------+------------------------+------------------------+------------------------+-----------------------+-------------+
|    8 |  0511580201 | 2008 | orange      | 3.7605248960997335e-14 |  9.526691170298441e-12 | 0.00011150727271734511 |  0.008424288472706527 |          93 |
+------+-------------+------+-------------+------------------------+------------------------+------------------------+-----------------------+-------------+
|    9 |  0511580301 | 2008 | yllow-green | 3.7151725143225425e-14 |  7.864658967787371e-12 | 0.00010966877045950846 |  0.007212290215794602 |          84 |
+------+-------------+------+-------------+------------------------+------------------------+------------------------+-----------------------+-------------+
|   10 |  0511580401 | 2008 | green-cyan  | 3.4499032867599885e-14 |  6.498988059098462e-12 | 0.00010484123970804105 |  0.006069269482232469 |          81 |
+------+-------------+------+-------------+------------------------+------------------------+------------------------+-----------------------+-------------+
|   11 |  0554710801 | 2010 | indigo      | 2.3754871478258848e-14 |  7.849176923875304e-13 | 2.7905698263413746e-05 | 0.0004920471383524259 |         112 |
+------+-------------+------+-------------+------------------------+------------------------+------------------------+-----------------------+-------------+
|   12 |  0653510301 | 2010 | purple      |  2.943363190854268e-14 |  6.821246990361768e-12 |  9.279553539775503e-05 |   0.00651779093279944 |         118 |
+------+-------------+------+-------------+------------------------+------------------------+------------------------+-----------------------+-------------+
|   13 |  0653510401 | 2010 | brown       | 3.1283304711494797e-14 |  8.853013677292046e-12 |  9.781857804360535e-05 |   0.00833541120711404 |          93 |
+------+-------------+------+-------------+------------------------+------------------------+------------------------+-----------------------+-------------+
|   14 |  0653510501 | 2010 | dark grey   | 3.2544741133647386e-14 |  6.962257021009912e-12 | 0.00010335106725934342 |  0.006769583060591246 |         105 |
+------+-------------+------+-------------+------------------------+------------------------+------------------------+-----------------------+-------------+
|   15 |  0653510601 | 2011 | light grey  |  3.207805020641767e-14 |  8.050880788176101e-12 | 0.00010284178529837414 |  0.007863050772055841 |          86 |
+------+-------------+------+-------------+------------------------+------------------------+------------------------+-----------------------+-------------+

** Lag overview
PATH to original data =/data/scratch3/steff/1H0707-495=

PATH to new scripts and data =/homeb/steff075/phd_ecm/1h0707=

*Observations used:*

0110890201, 0148010301, 0506200201, 0506200301, 0506200401, 0506200501,
0511580101, 0511580201, 0511580301, 0511580401, 0554710801,
0653510301, 0653510401, 0653510501, 0653510601.

*Lag-frequency overview*

Combined

Plot =/homeb/steff075/phd_ecm/1h0707/1H0707-lag-results_comb-grp.vsz=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-lag-results_comb-test1.png


#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 1.163636e-04 | 3.636364e-05 |  1.180215e+02 | 5.899798e+01 |
+--------------+--------------+---------------+--------------+
| 2.221488e-04 | 6.942149e-05 |  1.632992e+02 | 2.182866e+01 |
+--------------+--------------+---------------+--------------+
| 4.241022e-04 | 1.325319e-04 |  4.437624e+01 | 1.171230e+01 |
+--------------+--------------+---------------+--------------+
| 8.096496e-04 | 2.530155e-04 | -1.550455e+01 | 6.565147e+00 |
+--------------+--------------+---------------+--------------+
| 1.545695e-03 | 4.830296e-04 | -2.915978e+01 | 3.632464e+00 |
+--------------+--------------+---------------+--------------+
| 2.950872e-03 | 9.221474e-04 | -1.699517e+01 | 3.925964e+00 |
+--------------+--------------+---------------+--------------+
| 5.633482e-03 | 1.760463e-03 | -9.626157e+00 | 7.423369e+00 |
+--------------+--------------+---------------+--------------+


Lets keep this combined lag for reference in the other groups as
shown below:


Combined/Year/Groups lags

Lets get some plost of all the lags in groups, so to begin lets look
at the combined, year and groups lags:

Plot =/homeb/steff075/phd_ecm/1h0707/1H0707-lag-results_comb-grp.vsz=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/1H0707-lag-results_comb-grp.png

Grouped lags by year:

Plot =/homeb/steff075/phd_ecm/1h0707/1H0707-year-lags.vsz=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/1H0707-year-lags.png


Grouped lags by flux state: low - medium -hi:

Plot =/homeb/steff075/phd_ecm/1h0707/1H0707-grouped-lags.vsz=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/1H0707-grouped-lags.png

** Low - High Flux state results

Lets just have a look at the low and high flux state lag-frequencies:

use =lagfreq_hi_flux.sl=

*High flux*

"0148010301","0506200401","0506200501","0511580101","0511580201","0511580301","0511580401","0653510301","0653510401","0653510501","0653510601"


*Low flux*

"0554710801","0506200201, "0506200301"


*High Flux State*

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_lagfreq_hi_flux.png

*Low Flux State* /note that this is with the 3 lower observations from
the multi-spectra in the paper.

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_lagfreq_lo_flux.png

Lags found:
#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+---------------+----------+--------------+------+---------------+----------+--------------+------+
| Lo-flux-freq1 |       +- | Lo-flux-lag1 |   +- | Hi-flux-freq1 |       +- | Hi-flux-lag1 |   +- |
+---------------+----------+--------------+------+---------------+----------+--------------+------+
|      0.000116 | 3.64E-05 |          165 | 89.6 |      0.000116 | 3.64E-05 |          118 | 62.9 |
+---------------+----------+--------------+------+---------------+----------+--------------+------+
|      0.000222 | 6.94E-05 |          129 | 39.8 |      0.000222 | 6.94E-05 |          164 | 23.2 |
+---------------+----------+--------------+------+---------------+----------+--------------+------+
|      0.000424 | 0.000133 |        -50.5 | 52.9 |      0.000424 | 0.000133 |         44.9 | 12.5 |
+---------------+----------+--------------+------+---------------+----------+--------------+------+
|       0.00081 | 0.000253 |        -62.2 | 49.6 |       0.00081 | 0.000253 |        -15.3 | 6.97 |
+---------------+----------+--------------+------+---------------+----------+--------------+------+
|       0.00155 | 0.000483 |        -36.8 | 16.7 |       0.00155 | 0.000483 |        -29.1 | 3.87 |
+---------------+----------+--------------+------+---------------+----------+--------------+------+
|       0.00295 | 0.000922 |        -46.4 | 21.1 |       0.00295 | 0.000922 |        -16.7 | 4.19 |
+---------------+----------+--------------+------+---------------+----------+--------------+------+
|       0.00563 |  0.00176 |         36.2 | 9.05 |       0.00563 |  0.00176 |        -11.1 | 7.84 |
+---------------+----------+--------------+------+---------------+----------+--------------+------+


Lets combine these results in Veusz

Use =homeb/steff075/phd_ecm/1h0707/1H0707-lag-results.ods= to obtain
the csv

Plot =homeb/steff075/phd_ecm/1h0707/1H0707-lag-results-lo-hi.vsz=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-lag-results-lo-hi-1.png

Now with just the 2 bottom lo-flux data sets included as the lo-flux
it will be:

*Hi-flux*

"0110890201","0148010301","0506200401","0506200301","0506200501","0511580101"
"0511580201","0511580301","0511580401","0653510301","0653510401","0653510501","0653510601"

*Lo-flux*

"0554710801","0506200201"

Lags found:

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+---------------+--------------+--------------+----------+---------------+--------------+--------------+----------+
| Lo-flux-freq2 |           +- | Lo-flux-lag2 |       +- | Hi-flux-freq2 |           +- | Hi-flux-lag2 |       +- |
+---------------+--------------+--------------+----------+---------------+--------------+--------------+----------+
|  0.0001163636 | 3.636364E-05 |     277.6155 | 109.2714 |  0.0001163636 | 3.636364E-05 |     117.5248 | 62.09066 |
+---------------+--------------+--------------+----------+---------------+--------------+--------------+----------+
|  0.0002221488 | 6.942149E-05 |     156.8702 |  49.3943 |  0.0002221488 | 6.942149E-05 |     163.3536 | 22.87762 |
+---------------+--------------+--------------+----------+---------------+--------------+--------------+----------+
|  0.0004241022 | 0.0001325319 |    -22.47539 | 63.43728 |  0.0004241022 | 0.0001325319 |     44.53511 | 12.36285 |
+---------------+--------------+--------------+----------+---------------+--------------+--------------+----------+
|  0.0008096496 | 0.0002530155 |     -93.3709 | 73.18847 |  0.0008096496 | 0.0002530155 |    -15.35697 |  6.89237 |
+---------------+--------------+--------------+----------+---------------+--------------+--------------+----------+
|   0.001545695 | 0.0004830296 |    -74.59788 | 36.84652 |   0.001545695 | 0.0004830296 |    -29.05419 | 3.818646 |
+---------------+--------------+--------------+----------+---------------+--------------+--------------+----------+
|   0.002950872 | 0.0009221474 |     -39.5939 | 32.90037 |   0.002950872 | 0.0009221474 |    -16.90896 |  4.12506 |
+---------------+--------------+--------------+----------+---------------+--------------+--------------+----------+
|   0.005633482 |  0.001760463 |      32.0495 |   9.2184 |   0.005633482 |  0.001760463 |    -10.61721 | 7.790558 |
+---------------+--------------+--------------+----------+---------------+--------------+--------------+----------+

Use =homeb/steff075/phd_ecm/1h0707/1H0707-lag-results.csv=

Where lags and Freq = Lo-flux-freq2, Lo-flux-lag2..... etc

Plot =homeb/steff075/phd_ecm/1h0707/1H0707-lag-results-lo-hi-2.vsz=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-lag-results-lo-hi-2.png

*Genegenerate fits and response*

Hi-flux

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("1H0707-495-time-lags-hi-flux.fits");
r=load_rmf("1H0707-495-time-lags-hi-flux.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

Lo-flux

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("1H0707-495-time-lags-lo-flux.fits");
r=load_rmf("1H0707-495-time-lags-lo-flux.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

Now copy these the BC4 for fitting to ECM model, e.g:

#+BEGIN_EXAMPLE
scp 1H0707-495-time-lags-lo-flux.fits so14935@bc4login.acrc.bris.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/1H0707-495-time-lag-fits
#+END_EXAMPLE

** Lag-energy (combined)


From the lag-frequencies obtained in the above combined section, lets
look at the lag-energy in the hi and low frequencies  relating to the
fluctuation and reverberation lags:


*Low-frequency*

PATH =/home/steff075/phd_ecm/1h0707/lagen_comb_lf.sl=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_lagen_lofreq.PNG

*High-frequency*

PATH =/home/steff075/phd_ecm/1h0707/lagen_comb_hf.sl=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_lagen_hifreq.PNG

*Lo-hi lag-energy*

PATH =/home/steff075/phd_ecm/1h0707/lagen-results.vsz=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495-lagen-results.png

** New lo-med-hi flux groups July 2020

Lets look at all lightcurves in the 0.3 - 10 keV range:

PATH =
=/home/steff075/phd_ecm/1h0707/lightcurves/1H0707_multi_lc_plots_ALL.vsz=


#+ATTR_HTML: :width 1000
http://www.star.bris.ac.uk/steff/ecm/1H0707_multi_lc_plots_ALL.png

Now the spectra of these:

PATH = =/home/steff075/phd_ecm/1H0707-495/multi_spectra_unfold.sl=

The groups above to not lend well to the fitting of the ECM model as
the combined lags and hi-flux lags were essentially the same. The aim
is to explore the variability so further scrutiny of the spectra was needed to obtain lo-medium and
high flux as associated with the variablity of each observation.

Now we can define:

#+BEGIN_EXAMPLE

Low-flux spectra =["0506200201","0554710801"];

Med flux spectra =["0110890201","0506200301"];

Hi flux spectra  =["0148010301","0506200401","0506200501","0511580101","0511580201","0511580301","0511580401","0653510301","0653510401","0653510501","0653510601"];

#+END_EXAMPLE


The lightcurves that represent this data are as follows:


PATH = =/home/steff/phd_ecm/1h0707/lightcurves/1H0707_multi_lc_plots2.vsz=

#+ATTR_HTML: :width 900
http://www.star.bris.ac.uk/steff/ecm/1H0707_multi_lc_plots3.png


This is the spectra selection colour-coded for clarity

#+ATTR_HTML: :width 900
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_lo_med_hi-1.png

Now lets create trhe lags for each of the groups:

*Combined Lags*

Same as used above

*Low Flux*

These lags are the same as used above! - No further action required!

*Med Flux*

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_medflux_lagfreq.gif

Lags stored in:

=/home/steff075/phd_ecm/1h0707/time_lags_medflux.csv=

=/home/steff075/phd_ecm/1h0707/time_lags_medflux2.csv=

|         Freq |           +- |           Lag |           +- |
| 1.454545e-04 | 4.545455e-05 |  1.299374e+02 | 2.755460e+02 |
| 2.776860e-04 | 8.677686e-05 |  2.892182e+01 | 4.381895e+01 |
| 5.301277e-04 | 1.656649e-04 |  2.094404e+01 | 3.696152e+01 |
| 1.012062e-03 | 3.162694e-04 |  3.538017e+01 | 2.675177e+01 |
| 1.932118e-03 | 6.037870e-04 | -3.400182e+01 | 1.182525e+01 |
| 3.688590e-03 | 1.152684e-03 | -1.702291e+01 | 1.954636e+01 |
| 7.041853e-03 | 2.200579e-03 |  1.125783e+01 | 1.819334e+01 |


*Hi Flux*

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_new_hiflux_lagfreq.gif

Lags stored in:

=/home/steff075/phd_ecm/1h0707/time_lags_hiflux_july20.csv=

=/home/steff075/phd_ecm/1h0707/time_lags_hiflux2_july20.csv=

|         Freq |           +- |           Lag |           +- |
| 1.018182e-04 | 3.181818e-05 |  1.291558e+02 | 6.652030e+01 |
| 1.943802e-04 | 6.074380e-05 |  1.943665e+02 | 2.768891e+01 |
| 3.710894e-04 | 1.159654e-04 |  8.169877e+01 | 1.470362e+01 |
| 7.084434e-04 | 2.213886e-04 | -1.441557e+01 | 8.357001e+00 |
| 1.352483e-03 | 4.226509e-04 | -2.682039e+01 | 4.251402e+00 |
| 2.582013e-03 | 8.068790e-04 | -1.886719e+01 | 4.034525e+00 |
| 4.929297e-03 | 1.540405e-03 | -1.386220e+01 | 5.612890e+00 |


*All lag states*

PATH =/home/steff075/phd_ecm/1h0707/1H0707-lag-results-lo-hi-2.vsz=

Using =/home/steff075/phd_ecm/1h0707/1H0707-lag-results.csv=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-lag-results-lo-med-hi-2.png


Also saved as =/home/steff075/phd_ecm/1h0707/1H0707-lag-results-lo-med-hi-2.pdf=

** Flux, Counts and Exposure info

PATH =/home/steff075/phd_ecm/results-for-all/1H0707_flux_counts.ods

|    obs_id | Data_Flux(0.3-10keV) |   counts | Eff_Exp ks | RelxillModel_Flux | Plaw-Flux | Spec_state |
| 110890201 |             3.16E-07 | 4.22E+04 |     36.257 |          7.53E-13 |  5.80E-13 | Med        |
| 148010301 |             2.06E-07 | 2.66E+05 |     69.699 |          3.04E-12 |  2.67E-12 | Hi         |
| 506200201 |             2.53E-07 | 2.45E+04 |     35.752 |          3.89E-13 |  3.60E-13 | Lo         |
| 506200301 |             2.89E-07 | 7.12E+04 |     35.826 |          1.42E-12 |  1.16E-12 | Med        |
| 506200401 |             1.77E-07 | 1.63E+05 |     37.589 |          3.24E-12 |  2.58E-12 | Hi         |
| 506200501 |             2.39E-07 | 2.02E+05 |     37.847 |          4.05E-12 |  3.61E-12 | Hi         |
| 511580101 |             1.68E-07 | 3.48E+05 |    102.684 |          2.70E-12 |  2.32E-12 | Hi         |
| 511580201 |             1.15E-07 | 4.54E+05 |     86.046 |          4.11E-12 |  3.69E-12 | Hi         |
| 511580301 |             1.15E-07 | 4.54E+05 |     86.046 |          3.12E-12 |  2.71E-12 | Hi         |
| 511580401 |             1.86E-07 | 2.78E+05 |      75.36 |          2.42E-12 |  2.02E-12 | Hi         |
| 653510301 |             1.91E-07 | 4.06E+05 |    103.743 |          4.74E-13 |  3.95E-13 | Hi         |
| 653510401 |             1.67E-07 | 5.55E+05 |    109.367 |          2.33E-12 |  1.97E-12 | Hi         |
| 653510501 |             2.23E-07 | 3.46E+05 |     86.327 |          3.32E-12 |  2.79E-12 | Hi         |
| 653510601 |             1.99E-07 | 4.59E+05 |     97.645 |          2.24E-12 |  1.84E-12 | Hi         |
| 554710801 |             9.63E-08 | 2.68E+04 |     79.974 |          2.69E-12 |  2.20E-12 | Lo         |
|  Combined |             1.96E-07 | 2.73E+05 |   1.08E+03 |          2.42E-12 |  2.06E-12 |            |
|   Hi-flux |             1.81E-07 | 3.27E+05 |   8.24E+02 |          2.82E-12 |  2.42E-12 |            |
|  Med-Flux |             3.03E-07 | 5.67E+04 |   7.21E+01 |          1.09E-12 |  8.70E-13 |            |
|   Lo-flux |             1.75E-07 | 2.45E+04 |   3.58E+01 |          1.54E-12 |  1.28E-12 |            |

*Note*: The Combined, Hi-flux, Med-flux, Lo-flux and counts are all shown
as a mean value of the data sets they contain as outlined above. The Exposure time is
the sum of the Exp data for those groups. (i.e, Mean flux, mean counts
and total exposure time)


Data Flux checking method:

PATH =/data/scratch3/steff/1H0707-495=

#+BEGIN_EXAMPLE

isis
d=load_data("/data/scratch3/steff/1H0707-495/0110890201/PROC/PN_time_0.3-10_pi_grp.fits");
data_flux(1,0.3,10);
list_data;

 data_flux(1,0.3,10);
3.1647248099937476e-07
2.2803368756508855e-12
25.391713003518895
0.002113871163647396
isis> list_data;

Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0    4096/ 4096   1   1  4.2198e+04    36.257


..............................................................................
isis
d=load_data("/data/scratch3/steff/1H0707-495/0148010301/PROC/PN_time_0.3-10_pi_grp.fits");
data_flux(1,0.3,10);
list_data;

data_flux(1,0.3,10);
2.0600129157443772e-07
7.05021690813364e-12
14.890906260302815
0.006263354359922373
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0    4096/ 4096   1   1  2.6646e+05    69.699
file:  /data/scratch3/steff/1H0707-495/0148010301/PROC/PN_time_0.3-10_pi_grp.fits
back:  /data/scratch3/steff/1H0707-495/0148010301/PROC/PN_time_0.3-10_bkg_pi.fits


..............................................................................
isis
d=load_data("/data/scratch3/steff/1H0707-495/0506200201/PROC/PN_time_0.3-10_pi_grp.fits");
data_flux(1,0.3,10);
list_data;

 data_flux(1,0.3,10);
2.527237103251507e-07
1.4801661342509132e-12
20.536287134071234
0.0012076584301500134
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0    4096/ 4096   1   1  2.4509e+04    35.752

..............................................................................
isis
d=load_data("/data/scratch3/steff/1H0707-495/0506200301/PROC/PN_time_0.3-10_pi_grp.fits");
data_flux(1,0.3,10);
list_data;

 data_flux(1,0.3,10);
2.8894458635501856e-07
3.831220936275082e-12
22.1300494634139
0.0034772698256896294
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0    4096/ 4096   1   1  7.1211e+04    35.826

..............................................................................
isis
d=load_data("/data/scratch3/steff/1H0707-495/0506200401/PROC/PN_time_0.3-10_pi_grp.fits");
data_flux(1,0.3,10);
list_data;

 data_flux(1,0.3,10);
1.7668669547368105e-07
8.00158637052612e-12
13.218891377620732
0.007134521332146155
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0    4096/ 4096   1   1  1.6336e+05    37.589

..............................................................................
isis
d=load_data("/data/scratch3/steff/1H0707-495/0506200501/PROC/PN_time_0.3-10_pi_grp.fits");
data_flux(1,0.3,10);
list_data;

 data_flux(1,0.3,10);
2.394556674792421e-07
9.889000175348508e-12
17.4853964568555
0.008816964562550579
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0    4096/ 4096   1   1  2.0238e+05    37.847


..............................................................................
isis
d=load_data("/data/scratch3/steff/1H0707-495/0511580101/PROC/PN_time_0.3-10_pi_grp.fits");
data_flux(1,0.3,10);
list_data;

 data_flux(1,0.3,10);
1.679739121531324e-07
6.3319079364247054e-12
11.90542268267093
0.005609462413425597
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0    4096/ 4096   1   1  3.4762e+05   102.684

..............................................................................
isis
d=load_data("/data/scratch3/steff/1H0707-495/0511580201/PROC/PN_time_0.3-10_pi_grp.fits");
data_flux(1,0.3,10);
list_data;

 data_flux(1,0.3,10);
1.1531670578033761e-07
9.685563903223987e-12
8.230376009220185
0.008573335755943734
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0    4096/ 4096   1   1  4.5403e+05    86.046


..............................................................................
isis
d=load_data("/data/scratch3/steff/1H0707-495/0511580301/PROC/PN_time_0.3-10_pi_grp.fits");
data_flux(1,0.3,10);
list_data;

data_flux(1,0.3,10);
1.1531670578033761e-07
9.685563903223987e-12
8.230376009220185
0.008573335755943734
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0    4096/ 4096   1   1  4.5403e+05    86.046


..............................................................................
isis
d=load_data("/data/scratch3/steff/1H0707-495/0511580401/PROC/PN_time_0.3-10_pi_grp.fits");
data_flux(1,0.3,10);
list_data;

 data_flux(1,0.3,10);
1.8559011913546489e-07
6.640740945581779e-12
13.406680769419147
0.0061862947848185905
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0    4096/ 4096   1   1  2.7764e+05    75.360


..............................................................................
isis
d=load_data("/data/scratch3/steff/1H0707-495/0653510301/PROC/PN_time_0.3-10_pi_grp.fits");
data_flux(1,0.3,10);
list_data;

 data_flux(1,0.3,10);
1.9107006000400213e-07
6.935721938246271e-12
13.738234575558737
0.006640952256322796
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0    4096/ 4096   1   1  4.0564e+05   103.743


..............................................................................
isis
d=load_data("/data/scratch3/steff/1H0707-495/0653510401/PROC/PN_time_0.3-10_pi_grp.fits");
data_flux(1,0.3,10);
list_data;

 data_flux(1,0.3,10);
1.6675694140188623e-07
8.98079882802016e-12
11.905422682672945
0.008479065901147404
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0    4096/ 4096   1   1  5.5507e+05   109.367


..............................................................................
isis
d=load_data("/data/scratch3/steff/1H0707-495/0653510501/PROC/PN_time_0.3-10_pi_grp.fits");
data_flux(1,0.3,10);
list_data;

data_flux(1,0.3,10);
2.231254647078535e-07
7.083733819625911e-12
16.27080481270396
0.006897098957949941
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0    4096/ 4096   1   1  3.4622e+05    86.327


..............................................................................
isis
d=load_data("/data/scratch3/steff/1H0707-495/0653510601/PROC/PN_time_0.3-10_pi_grp.fits");
data_flux(1,0.3,10);
list_data;


 data_flux(1,0.3,10);
1.9858001859849676e-07
8.176043752071367e-12
14.23864773260141
0.008005087992999312
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0    4096/ 4096   1   1  4.5895e+05    97.645


..............................................................................
isis
d=load_data("/data/scratch3/steff/1H0707-495/0554710801/PROC/PN_time_0.3-10_pi_grp.fits");
data_flux(1,0.3,10);
list_data;

 data_flux(1,0.3,10);
9.629383851734893e-08
9.356757220279442e-13
7.262168357519774
0.000511307313644378
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0    4096/ 4096   1   1  2.6845e+04    79.974

#+END_EXAMPLE

** Light curve data lo-hi at 20 cts $s^{-1}$

Lets look again at the full lightcurve plots:

PATH =
=/home/steff075/phd_ecm/1h0707/lightcurves/IRAS_multi_lc_plots_ALL.vsz=


#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707_multi_lc_plots_ALL.png

What does the lag-frequency spectra look loke for all observations
with < 20 cts per sec  compared to > 20 cts per sec?

pdf at:


http://www.star.bris.ac.uk/steff/ecm/1H0707_multi_lc_plots_ALL.pdf

*Under 20 cts $s^{-1}$*

Lets group data:

Spectral PATH =
=/home/steff075/phd_ecm/1h0707/combine_lo_cts_lc_data.sl=

Timing PATH =/home/steff075/phd_ecm/1h0707/lagfreq_lo_cts_lc_data.sl=

#+BEGIN_EXAMPLE
% Lo-cts-lc-data
variable obsid = ["0110890201","0148010301","0506200301","0506200501","0511580101","0653510301","0653510501","0653510601"];
#+END_EXAMPLE


#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_lagfreq_lo_cts_lc_data.gif


|         Freq |           +- |           Lag |           +- |
| 7.272727e-05 | 2.272727e-05 |  5.688366e+01 | 1.227154e+02 |
| 1.388430e-04 | 4.338843e-05 |  1.239309e+02 | 5.801659e+01 |
| 2.650639e-04 | 8.283246e-05 |  1.249241e+02 | 2.620557e+01 |
| 5.060310e-04 | 1.581347e-04 | -7.828063e+00 | 1.284589e+01 |
| 9.660592e-04 | 3.018935e-04 | -1.842608e+01 | 8.602379e+00 |
| 1.844295e-03 | 5.763421e-04 | -2.599854e+01 | 4.965152e+00 |
| 3.520927e-03 | 1.100290e-03 | -1.925595e+01 | 6.503213e+00 |


Lags saved in: "lagvalues_lo_cts_lc.csv" and
"lagvalues_lo_cts2_lc.csv"

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("1H0707-495-time-lags-lc-cts-below20.fits");
r=load_rmf("1H0707-495-time-lags-lc-cts-below20.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

*Over 20 cts $s^{-1}$*

Spectral PATH =
=/home/steff075/phd_ecm/1h0707/combine_hi_cts_lc_data.sl=

Timing PATH =/home/steff075/phd_ecm/1h0707/lagfreq_hi_cts_lc_data.sl=

#+BEGIN_EXAMPLE
% Hi-cts-lc-data
variable obsid = ["0506200201","0506200401","0511580201","0511580301","0511580401","0554710801","0653510401"];
#+END_EXAMPLE


#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_lagfreq_hi_cts_lc_data.gif


|         Freq |           +- |           Lag |           +- |
| 7.272727e-05 | 2.272727e-05 |  4.410710e+02 | 1.617574e+02 |
| 1.388430e-04 | 4.338843e-05 |  1.336834e+02 | 5.615105e+01 |
| 2.650639e-04 | 8.283246e-05 |  1.692736e+02 | 2.202636e+01 |
| 5.060310e-04 | 1.581347e-04 |  2.095797e+01 | 1.513477e+01 |
| 9.660592e-04 | 3.018935e-04 | -2.454998e+01 | 7.748230e+00 |
| 1.844295e-03 | 5.763421e-04 | -3.202336e+01 | 4.659396e+00 |
| 3.520927e-03 | 1.100290e-03 | -1.377628e+01 | 4.804491e+00 |



Lags saved in: "lagvalues_hi_cts_lc.csv" and "lagvalues_hi_cts2_lc.csv"

Time lags generated as:

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("1H0707-495-time-lags-lc-cts-above20.fits");
r=load_rmf("1H0707-495-time-lags-lc-cts-above20.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** Final Lag spectra - Comb, Hi, Lo, Hi-cts, Lo-cts

PATH = =/home/steff075/phd_ecm/1h0707/1H0707-lag-results-lo-hi.vsz=

Importing = =1H0707-lag-results.csv=

| Comb-freq |       +- |  Comb-lag |       +- | Lo-flux-freq |           +- | Lo-flux-lag |       +- | Hi-flux-freq |           +- | Hi-flux-lag |       +- | Med-flux-freq |       +- | Med-flux-lag |       +- | Lo-ctsFreq |       +- | Lo-cts-lag |       +- | Hi-ctsFreq |       +- | Hi-cts-lag |       +- |
|  1.16E-04 | 3.60E-05 |  1.18E+02 | 5.90E+01 | 0.0001163636 |     3.64E-05 |    277.6155 | 109.2714 | 0.0001163636 |     3.64E-05 |    117.5248 | 62.09066 |      1.45E-04 | 4.55E-05 |     1.30E+02 | 2.76E+02 |   7.27E-05 | 2.27E-05 |   5.69E+01 | 1.23E+02 |   7.27E-05 | 2.27E-05 |   4.41E+02 | 1.62E+02 |
|  2.22E-04 | 6.80E-05 |  1.63E+02 | 2.18E+01 | 0.0002221488 |     6.94E-05 |    156.8702 |  49.3943 | 0.0002221488 |     6.94E-05 |    163.3536 | 22.87762 |      2.78E-04 | 8.68E-05 |     2.89E+01 | 4.38E+01 |   1.39E-04 | 4.34E-05 |   1.24E+02 | 5.80E+01 |   1.39E-04 | 4.34E-05 |   1.34E+02 | 5.62E+01 |
|  4.24E-04 | 1.31E-04 |  4.44E+01 | 1.17E+01 | 0.0004241022 | 0.0001325319 |   -22.47539 | 63.43728 | 0.0004241022 | 0.0001325319 |    44.53511 | 12.36285 |      5.30E-04 | 1.66E-04 |     2.09E+01 | 3.70E+01 |   2.65E-04 | 8.28E-05 |   1.25E+02 | 2.62E+01 |   2.65E-04 | 8.28E-05 |   1.69E+02 | 2.20E+01 |
|  8.10E-04 | 2.49E-04 | -1.55E+01 | 6.57E+00 | 0.0008096496 | 0.0002530155 |    -93.3709 | 73.18847 | 0.0008096496 | 0.0002530155 |   -15.35697 |  6.89237 |      1.01E-03 | 3.16E-04 |     3.54E+01 | 2.68E+01 |   5.06E-04 | 1.58E-04 |  -7.83E+00 | 1.28E+01 |   5.06E-04 | 1.58E-04 |   2.10E+01 | 1.51E+01 |
|  1.55E-03 | 4.75E-04 | -2.92E+01 | 3.63E+00 |  0.001545695 | 0.0004830296 |   -74.59788 | 36.84652 |  0.001545695 | 0.0004830296 |   -29.05419 | 3.818646 |      1.93E-03 | 6.04E-04 |    -3.40E+01 | 1.18E+01 |   9.66E-04 | 3.02E-04 |  -1.84E+01 | 8.60E+00 |   9.66E-04 | 3.02E-04 |  -2.45E+01 | 7.75E+00 |
|  2.95E-03 | 9.20E-04 | -1.70E+01 | 3.93E+00 |  0.002950872 | 0.0009221474 |    -39.5939 | 32.90037 |  0.002950872 | 0.0009221474 |   -16.90896 |  4.12506 |      3.69E-03 | 1.15E-03 |    -1.70E+01 | 1.95E+01 |   1.84E-03 | 5.76E-04 |  -2.60E+01 | 4.97E+00 |   1.84E-03 | 5.76E-04 |  -3.20E+01 | 4.66E+00 |
|  5.63E-03 | 1.73E-03 | -9.63E+00 | 7.42E+00 |  0.005633482 |  0.001760463 |     32.0495 |   9.2184 |  0.005633482 |  0.001760463 |   -10.61721 | 7.790558 |      7.04E-03 | 2.20E-03 |     1.13E+01 | 1.82E+01 |   3.52E-03 | 1.10E-03 |  -1.93E+01 | 6.50E+00 |   3.52E-03 | 1.10E-03 |  -1.38E+01 | 4.80E+00 |


#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-lag-results-lo-hi.png

pdf at:

http://www.star.bris.ac.uk/steff/ecm/1H0707-lag-results-lo-hi.pdf

** OBS 0110890201 (2000)

Use script =/homeb/steff075/phd_ecm/1h0707/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.163636e-04,3.636364e-05,6.548397e+01,1.516530e+02
2.221488e-04,6.942149e-05,6.357663e+01,5.532529e+01
4.241022e-04,1.325319e-04,-6.318313e+01,6.917327e+01
8.096496e-04,2.530155e-04,-2.654700e+01,4.047363e+01
1.545695e-03,4.830296e-04,-1.847733e+01,1.321414e+01
2.950872e-03,9.221474e-04,-1.350947e+01,7.769919e+00
5.633482e-03,1.760463e-03,4.987827e+00,2.961163e+00
#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0110890201_lagfreq.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("1H0707-495-OBS-0110890201_time_lags.fits");
r=load_rmf("1H0707-495-OBS-0110890201_time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0148010301 (2002)

Use script =/homeb/steff075/phd_ecm/1h0707/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.163636e-04,3.636364e-05,3.941315e+02,2.271266e+02
2.221488e-04,6.942149e-05,1.290948e+01,8.684174e+01
4.241022e-04,1.325319e-04,7.088465e+01,4.014122e+01
8.096496e-04,2.530155e-04,-7.272201e+00,2.393687e+01
1.545695e-03,4.830296e-04,-3.250855e+01,1.056431e+01
2.950872e-03,9.221474e-04,-4.465458e+00,5.492189e+00
5.633482e-03,1.760463e-03,1.883308e+00,2.142938e+00
#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0148010301_lagfreq.gif

*Create fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("1H0707-495-OBS-0148010301-time-lags-A.fits");
r=load_rmf("1H0707-495-OBS-0148010301-time-lags-A.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0506200201 (2007)

Use script =/homeb/steff075/phd_ecm/1h0707/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.163636e-04,3.636364e-05,2.836469e+02,2.005688e+02
2.221488e-04,6.942149e-05,1.668635e+02,7.041854e+01
4.241022e-04,1.325319e-04,-5.953466e+01,6.398812e+01
8.096496e-04,2.530155e-04,-1.007791e+02,4.029137e+01
1.545695e-03,4.830296e-04,-4.074410e+01,1.784917e+01
2.950872e-03,9.221474e-04,-2.534027e+00,8.332047e+00
5.633482e-03,1.760463e-03,7.217243e+00,3.106336e+00
#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0506200201_lagfreq.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("1H0707-495-OBS-0506200201-time-lags-A.fits");
r=load_rmf("1H0707-495-OBS-0506200201-time-lags-A.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0506200301 (2007)

Use script =/homeb/steff075/phd_ecm/1h0707/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.454545e-04,4.545455e-05,1.683402e+02,4.185120e+02
2.776860e-04,8.677686e-05,2.568803e+01,4.321147e+01
5.301277e-04,1.656649e-04,4.518053e+01,3.016805e+01
1.012062e-03,3.162694e-04,3.284428e+01,2.340005e+01
1.932118e-03,6.037870e-04,-2.288342e+01,1.092775e+01
3.688590e-03,1.152684e-03,-4.646995e+00,6.627295e+00
7.041853e-03,2.200579e-03,1.495597e-01,2.439714e+00
#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0506200301_lagfreq.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("1H0707-495-OBS-0506200301-time-lags-A.fits");
r=load_rmf("1H0707-495-OBS-0506200301-time-lags-A.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0506200401 (2007)

Use script =/homeb/steff075/phd_ecm/1h0707/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.454545e-04,4.545455e-05,3.824884e+02,1.583569e+02
2.776860e-04,8.677686e-05,1.983684e+02,6.842174e+01
5.301277e-04,1.656649e-04,2.293652e+01,4.217472e+01
1.012062e-03,3.162694e-04,-3.203564e+01,1.916364e+01
1.932118e-03,6.037870e-04,4.033425e+00,9.869632e+00
3.688590e-03,1.152684e-03,-6.160146e+00,4.631582e+00
7.041853e-03,2.200579e-03,-2.250218e-01,1.991750e+00
#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0506200401_lagfreq.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("1H0707-495-OBS-0506200401-time-lags-A.fits");
r=load_rmf("1H0707-495-OBS-0506200401-time-lags-A.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0506200501 (2007)

Use script =/homeb/steff075/phd_ecm/1h0707/lagfreq_single_script.sl=

Lags found >1e-4Hz

#+BEGIN_EXAMPLE
1.454545e-04,4.545455e-05,4.111481e+02,5.169385e+01
2.776860e-04,8.677686e-05,3.529770e+01,6.210290e+01
5.301277e-04,1.656649e-04,-1.016316e+01,3.304281e+01
1.012062e-03,3.162694e-04,-2.974106e+01,2.024912e+01
1.932118e-03,6.037870e-04,2.852717e+00,1.340344e+01
3.688590e-03,1.152684e-03,-5.438101e+00,5.479473e+00
7.041853e-03,2.200579e-03,-2.062257e+00,1.943727e+00
#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0506200501_lagfreq.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("1H0707-495-OBS-0506200501-time-lags-A.fits");
r=load_rmf("1H0707-495-OBS-0506200501-time-lags-A.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0511580101 (2008)

Use script =/homeb/steff075/phd_ecm/1h0707/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.163636e-04,3.636364e-05,8.144057e+01,1.266207e+02
2.221488e-04,6.942149e-05,1.844079e+02,7.037267e+01
4.241022e-04,1.325319e-04,1.260465e+00,3.330093e+01
8.096496e-04,2.530155e-04,-2.756208e+01,1.486015e+01
1.545695e-03,4.830296e-04,-2.032813e+01,7.603805e+00
2.950872e-03,9.221474e-04,-1.189766e+01,4.687127e+00
5.633482e-03,1.760463e-03,-3.932569e-01,1.758843e+00
#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0511580101_lagfreq.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("1H0707-495-OBS-0511580101-time-lags-A.fits");
r=load_rmf("1H0707-495-OBS-0511580101-time-lags-A.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0511580201 (2008)

Use script =/homeb/steff075/phd_ecm/1h0707/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.163636e-04,3.636364e-05,1.883654e+02,2.461839e+02
2.221488e-04,6.942149e-05,1.664635e+02,5.509340e+01
4.241022e-04,1.325319e-04,6.612098e+01,3.640016e+01
8.096496e-04,2.530155e-04,-1.927557e+01,1.896721e+01
1.545695e-03,4.830296e-04,-3.361260e+01,8.320247e+00
2.950872e-03,9.221474e-04,5.669384e+00,4.544722e+00
5.633482e-03,1.760463e-03,-2.670102e+00,2.218247e+00
#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0511580201_lagfreq.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("1H0707-495-OBS-0511580201-time-lags-A.fits");
r=load_rmf("1H0707-495-OBS-0511580201-time-lags-A.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0511580301 (2008)

Use script =/homeb/steff075/phd_ecm/1h0707/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.163636e-04,3.636364e-05,2.051130e+01,1.466107e+02
2.221488e-04,6.942149e-05,3.731227e+02,6.582149e+01
4.241022e-04,1.325319e-04,-9.148262e+00,3.182743e+01
8.096496e-04,2.530155e-04,2.179021e+01,2.199061e+01
1.545695e-03,4.830296e-04,-3.129066e+01,9.283084e+00
2.950872e-03,9.221474e-04,-9.826425e+00,5.006751e+00
5.633482e-03,1.760463e-03,-1.871316e+00,2.223872e+00

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0511580301_lagfreq.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("1H0707-495-OBS-0511580301-time-lags-A.fits");
r=load_rmf("1H0707-495-OBS-0511580301-time-lags-A.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0511580401 (2008)

Use script =/homeb/steff075/phd_ecm/1h0707/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.163636e-04,3.636364e-05,8.807623e+01,1.602297e+02
2.221488e-04,6.942149e-05,1.863844e+02,8.255149e+01
4.241022e-04,1.325319e-04,1.551464e+02,3.792092e+01
8.096496e-04,2.530155e-04,-5.787836e+01,2.224952e+01
1.545695e-03,4.830296e-04,-2.913755e+01,1.166863e+01
2.950872e-03,9.221474e-04,-3.476872e+00,4.568918e+00
5.633482e-03,1.760463e-03,-9.960246e-01,2.050871e+00

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0511580401_lagfreq.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("1H0707-495-OBS-0511580401_time_lags.fits");
r=load_rmf("1H0707-495-OBS-0511580401_time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0554710801 (2011)

Use script =/homeb/steff075/phd_ecm/1h0707/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.163636e-04,3.636364e-05,2.271602e+02,2.146345e+02
2.221488e-04,6.942149e-05,-8.595560e+01,1.616738e+02
4.241022e-04,1.325319e-04,1.132464e+02,6.648597e+01
8.096496e-04,2.530155e-04,6.644807e+01,3.071537e+01
1.545695e-03,4.830296e-04,-2.331277e+00,1.367376e+01
2.950872e-03,9.221474e-04,-8.458852e+00,5.037530e+00
5.633482e-03,1.760463e-03,4.788745e+00,2.227398e+00

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0554710801_lagfreq.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("1H0707-495-OBS-0554710801-time-lags-A.fits");
r=load_rmf("1H0707-495-OBS-0554710801-time-lags-A.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0653510301 (2010)

Use script =/homeb/steff075/phd_ecm/1h0707/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.163636e-04,3.636364e-05,7.731012e+01,1.148896e+02
2.221488e-04,6.942149e-05,-5.518150e+01,6.342525e+01
4.241022e-04,1.325319e-04,9.283267e+01,3.552088e+01
8.096496e-04,2.530155e-04,-5.248269e+01,2.160328e+01
1.545695e-03,4.830296e-04,-1.272357e+01,9.804575e+00
2.950872e-03,9.221474e-04,9.413011e-01,4.346514e+00
5.633482e-03,1.760463e-03,2.656190e-01,1.697799e+00

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0653510301_lagfreq.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("1H0707-495-OBS-0653510301-time-lags-A.fits");
r=load_rmf("1H0707-495-OBS-0653510301-time-lags-A.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0653510401 (2010)

Use script =/homeb/steff075/phd_ecm/1h0707/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.163636e-04,3.636364e-05,1.787745e+01,1.702074e+02
2.221488e-04,6.942149e-05,1.051425e+02,5.350419e+01
4.241022e-04,1.325319e-04,-9.786102e+00,3.809831e+01
8.096496e-04,2.530155e-04,1.355377e+00,1.535934e+01
1.545695e-03,4.830296e-04,-3.803900e+01,7.739218e+00
2.950872e-03,9.221474e-04,-1.797363e+01,4.351728e+00
5.633482e-03,1.760463e-03,-1.279071e+00,1.677322e+00

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0653510401_lagfreq.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("1H0707-495-OBS-0653510401-time-lags-A.fits");
r=load_rmf("1H0707-495-OBS-0653510401-time-lags-A.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0653510501 (2010)

Use script =/homeb/steff075/phd_ecm/1h0707/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.163636e-04,3.636364e-05,-4.450079e+02,2.278669e+02
2.221488e-04,6.942149e-05,1.298060e+02,9.729007e+01
4.241022e-04,1.325319e-04,5.675206e+01,3.808999e+01
8.096496e-04,2.530155e-04,-2.138891e+01,1.557658e+01
1.545695e-03,4.830296e-04,-1.430898e+01,1.040606e+01
2.950872e-03,9.221474e-04,-1.152544e+01,5.019912e+00
5.633482e-03,1.760463e-03,2.251106e+00,1.948168e+00

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0653510501_lagfreq.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("1H0707-495-OBS-0653510501_time_lags.fits");
r=load_rmf("1H0707-495-OBS-0653510501_time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0653510601 (2010)

Use script =/homeb/steff075/phd_ecm/1h0707/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.163636e-04,3.636364e-05,4.248069e+02,1.262799e+02
2.221488e-04,6.942149e-05,3.124446e+02,5.847211e+01
4.241022e-04,1.325319e-04,4.903590e+01,3.536553e+01
8.096496e-04,2.530155e-04,-1.223158e+00,2.014476e+01
1.545695e-03,4.830296e-04,-2.205842e+01,1.091538e+01
2.950872e-03,9.221474e-04,-1.166931e+01,4.893659e+00
5.633482e-03,1.760463e-03,-3.203729e+00,1.877995e+00

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0653510601_lagfreq.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("1H0707-495-OBS-0653510601-time-lags-A.fits");
r=load_rmf("1H0707-495-OBS-0653510601-time-lags-A.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** Fully Combined Observations

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0110890201, 0148010301, 0506200201, 0506200301, 0506200401,0506200501, 0511580101, 0511580201,

0511580301, 0511580401, 0554710801, 0653510301, 0653510401, 0653510501, 0653510601.

script = =lagfreq_comb_script.sl=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_fullycomb_lagfreq.gif

Lag Values
#+BEGIN_EXAMPLE
Freq,+-,Lag,+-
1.163636e-04,3.636364e-05,1.180215e+02,5.899798e+01
2.221488e-04,6.942149e-05,1.632992e+02,2.182866e+01
4.241022e-04,1.325319e-04,4.437624e+01,1.171230e+01
8.096496e-04,2.530155e-04,-1.550455e+01,6.565147e+00
1.545695e-03,4.830296e-04,-2.915978e+01,3.632464e+00
2.950872e-03,9.221474e-04,-1.699517e+01,3.925964e+00
5.633482e-03,1.760463e-03,-9.626157e+00,7.423369e+00
#+END_EXAMPLE

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
|         Freq |           +- |           Lag |           +- |
| 1.163636e-04 | 3.636364e-05 |  1.180215e+02 | 5.899798e+01 |
| 2.221488e-04 | 6.942149e-05 |  1.632992e+02 | 2.182866e+01 |
| 4.241022e-04 | 1.325319e-04 |  4.437624e+01 | 1.171230e+01 |
| 8.096496e-04 | 2.530155e-04 | -1.550455e+01 | 6.565147e+00 |
| 1.545695e-03 | 4.830296e-04 | -2.915978e+01 | 3.632464e+00 |
| 2.950872e-03 | 9.221474e-04 | -1.699517e+01 | 3.925964e+00 |
| 5.633482e-03 | 1.760463e-03 | -9.626157e+00 | 7.423369e+00 |

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("fully_comb_time_lags.fits");
r=load_rmf("fully_comb_time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** Fully Combined Observations 14 bins

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0110890201, 0148010301, 0506200201, 0506200301, 0506200401,0506200501, 0511580101, 0511580201,

0511580301, 0511580401, 0554710801, 0653510301, 0653510401, 0653510501, 0653510601.

script = =lagfreq_comb_14_script.sl=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_fullycomb_lagfreq14.gif

Lag Values
#+BEGIN_EXAMPLE
Freq,+-,Lag,+-
1.333333e-04,1.111245e+02,4.781348e+01
2.222222e-04,1.661344e+02,2.209749e+01
3.703704e-04,8.075365e+01,1.415067e+01
6.172840e-04,-2.826152e+01,9.747267e+00
1.028807e-03,-1.823354e+01,5.826213e+00
1.714678e-03,-2.901019e+01,3.736564e+00
2.857796e-03,-1.842056e+01,4.525696e+00
4.762993e-03,-1.082232e+01,5.097642e+00
7.938322e-03,-1.807402e+01,2.231380e+01
1.323054e-02,-2.801749e+01,5.667241e+00
2.205090e-02,-2.143800e+01,3.138322e+00
3.675149e-02,-1.349891e+01,1.731970e+00
6.125249e-02,-8.370807e+00,1.255225e+00
1.020875e-01,-7.473223e-02,5.643191e-03

#+END_EXAMPLE

saved to =time_lags_comb14_1.csv=


#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 1.333333e-04 | 3.333333e-05 |  1.111245e+02 | 4.781348e+01 |
+--------------+--------------+---------------+--------------+
| 2.222222e-04 | 5.555556e-05 |  1.661344e+02 | 2.209749e+01 |
+--------------+--------------+---------------+--------------+
| 3.703704e-04 | 9.259259e-05 |  8.075365e+01 | 1.415067e+01 |
+--------------+--------------+---------------+--------------+
| 6.172840e-04 | 1.543210e-04 | -2.826152e+01 | 9.747267e+00 |
+--------------+--------------+---------------+--------------+
| 1.028807e-03 | 2.572016e-04 | -1.823354e+01 | 5.826213e+00 |
+--------------+--------------+---------------+--------------+
| 1.714678e-03 | 4.286694e-04 | -2.901019e+01 | 3.736564e+00 |
+--------------+--------------+---------------+--------------+
| 2.857796e-03 | 7.144490e-04 | -1.842056e+01 | 4.525696e+00 |
+--------------+--------------+---------------+--------------+
| 4.762993e-03 | 1.190748e-03 | -1.082232e+01 | 5.097642e+00 |
+--------------+--------------+---------------+--------------+
| 7.938322e-03 | 1.984581e-03 | -1.807402e+01 | 2.231380e+01 |
+--------------+--------------+---------------+--------------+
| 1.323054e-02 | 3.307634e-03 | -2.801749e+01 | 5.667241e+00 |
+--------------+--------------+---------------+--------------+
| 2.205090e-02 | 5.512724e-03 | -2.143800e+01 | 3.138322e+00 |
+--------------+--------------+---------------+--------------+
| 3.675149e-02 | 9.187873e-03 | -1.349891e+01 | 1.731970e+00 |
+--------------+--------------+---------------+--------------+
| 6.125249e-02 | 1.531312e-02 | -8.370807e+00 | 1.255225e+00 |
+--------------+--------------+---------------+--------------+
| 1.020875e-01 | 2.552187e-02 | -7.473223e-02 | 5.643191e-03 |
+--------------+--------------+---------------+--------------+

saved to =time_lags_comb14_2.csv=

*Generate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("1H0707-495-comb-time-lags14.fits");
r=load_rmf("1H0707-495-comb-time-lags14.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

Copy to BC4 e.g:
#+BEGIN_EXAMPLE
scp 1H0707-495-comb-time-lags14.fits so14935@bc4login.acrc.bris.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/1H0707-495-time-lag-fits
#+END_EXAMPLE

** 2007 Observations

This combination was selected from obsevations:

0506200201, 0506200301, 0506200401, 0506200501

Edit and run =lagfreq_comb2007_script.sl=

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_2007comb_lagfreq.png

Lag values:

#+BEGIN_EXAMPLE
Freq,+-,Lag,+-
1.163636e-04,3.636364e-05,6.225075e+02,1.753841e+02
2.221488e-04,6.942149e-05,1.281412e+02,4.977172e+01
4.241022e-04,1.325319e-04,-1.281581e+01,2.577278e+01
8.096496e-04,2.530155e-04,-8.434977e+00,1.490368e+01
1.545695e-03,4.830296e-04,-3.800459e+00,9.721066e+00
2.950872e-03,9.221474e-04,-1.174227e+01,1.037432e+01
5.633482e-03,1.760463e-03,-1.440126e+01,1.487283e+01

ps2pdf 1H0707-495_lagfreq_comb2007.ps 1H0707-495_lagfreq_comb2007.pdf
gvfs-open 1H0707-495_lagfreq_comb2007.pdf
#+END_EXAMPLE

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
|         Freq |           +- |           Lag |           +- |
| 1.163636e-04 | 3.636364e-05 |  6.225075e+02 | 1.753841e+02 |
| 2.221488e-04 | 6.942149e-05 |  1.281412e+02 | 4.977172e+01 |
| 4.241022e-04 | 1.325319e-04 | -1.281581e+01 | 2.577278e+01 |
| 8.096496e-04 | 2.530155e-04 | -8.434977e+00 | 1.490368e+01 |
| 1.545695e-03 | 4.830296e-04 | -3.800459e+00 | 9.721066e+00 |
| 2.950872e-03 | 9.221474e-04 | -1.174227e+01 | 1.037432e+01 |
| 5.633482e-03 | 1.760463e-03 | -1.440126e+01 | 1.487283e+01 |


*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("2007_comb_time_lags.fits");
r=load_rmf("2007_comb_time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** 2008 Observations
For this data, see directory
=/data/scratch3/steff/1H0707-495/combined=

This combination was selected from obsevations
0511580101, 0511580201, 0511580301, 0511580401

Edit and run =lagfreq_comb2008_script.sl=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_2008comb_lagfreq.png

#+BEGIN_EXAMPLE
ps2pdf 1H0707-495_lagfreq_comb2008.ps 1H0707-495_lagfreq_comb2008.pdf
gvfs-open 1H0707-495_lagfreq_comb2008.pdf
#+END_EXAMPLE

Lag values:

#+BEGIN_EXAMPLE
Freq,+-,Lag,+-
1.163636e-04,3.636364e-05,8.614541e+01,9.440954e+01
2.221488e-04,6.942149e-05,2.457248e+02,3.780859e+01
4.241022e-04,1.325319e-04,5.969616e+01,1.918712e+01
8.096496e-04,2.530155e-04,-2.023234e+01,1.100453e+01
1.545695e-03,4.830296e-04,-3.424797e+01,6.014568e+00
2.950872e-03,9.221474e-04,-7.866885e+00,5.681788e+00
5.633482e-03,1.760463e-03,-9.768980e+00,7.390832e+00
#+END_EXAMPLE


#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
|         Freq |           +- |           Lag |           +- |
| 1.163636e-04 | 3.636364e-05 |  8.614541e+01 | 9.440954e+01 |
| 2.221488e-04 | 6.942149e-05 |  2.457248e+02 | 3.780859e+01 |
| 4.241022e-04 | 1.325319e-04 |  5.969616e+01 | 1.918712e+01 |
| 8.096496e-04 | 2.530155e-04 | -2.023234e+01 | 1.100453e+01 |
| 1.545695e-03 | 4.830296e-04 | -3.424797e+01 | 6.014568e+00 |
| 2.950872e-03 | 9.221474e-04 | -7.866885e+00 | 5.681788e+00 |
| 5.633482e-03 | 1.760463e-03 | -9.768980e+00 | 7.390832e+00 |

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("2008_comb_time_lags.fits");
r=load_rmf("2008_comb_time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** 2010 Observations
For this data, see directory
=/data/scratch3/steff/1H0707-495/combined=

This combination was selected from obsevations: 0653510301,0653510401, 0653510501, 0653510601.

Edit and run =lagfreq_comb2010script.sl=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_2010comb_lagfreq.png

#+BEGIN_EXAMPLE
ps2pdf 1H0707-495_lagfreq_comb2010.ps 1H0707-495_lagfreq_comb2010.pdf
gvfs-open 1H0707-495_lagfreq_comb2010.pdf

Lag values:

Freq,+-,Lag,+-
1.163636e-04,3.636364e-05,6.309144e+01,9.322107e+01
2.221488e-04,6.942149e-05,1.267685e+02,3.617746e+01
4.241022e-04,1.325319e-04,4.388612e+01,2.085640e+01
8.096496e-04,2.530155e-04,-1.553361e+01,1.168042e+01
1.545695e-03,4.830296e-04,-3.006404e+01,6.204436e+00
2.950872e-03,9.221474e-04,-3.012234e+01,7.173169e+00
5.633482e-03,1.760463e-03,-1.999305e+01,2.802107e+01

#+END_EXAMPLE

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
|         Freq |           +- |           Lag |           +- |
| 1.163636e-04 | 3.636364e-05 |  6.309144e+01 | 9.322107e+01 |
| 2.221488e-04 | 6.942149e-05 |  1.267685e+02 | 3.617746e+01 |
| 4.241022e-04 | 1.325319e-04 |  4.388612e+01 | 2.085640e+01 |
| 8.096496e-04 | 2.530155e-04 | -1.553361e+01 | 1.168042e+01 |
| 1.545695e-03 | 4.830296e-04 | -3.006404e+01 | 6.204436e+00 |
| 2.950872e-03 | 9.221474e-04 | -3.012234e+01 | 7.173169e+00 |
| 5.633482e-03 | 1.760463e-03 | -1.999305e+01 | 2.802107e+01 |

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("2010_comb_time_lags.fits");
r=load_rmf("2010_comb_time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** Group 1 spectra


Now lets have a look at the lag-frequency for this group of
observations

use script =lagfreq_comb_Grp1.sl=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_lagfreq_Grp1.gif

Lag values

#+BEGIN_EXAMPLE

1.163636e-04,3.636364e-05,1.156379e+02,6.341921e+01
2.221488e-04,6.942149e-05,1.673608e+02,2.367800e+01
4.241022e-04,1.325319e-04,4.525099e+01,1.284897e+01
8.096496e-04,2.530155e-04,-1.651157e+01,7.074069e+00
1.545695e-03,4.830296e-04,-2.893330e+01,3.947370e+00
2.950872e-03,9.221474e-04,-1.711897e+01,4.294255e+00
5.633482e-03,1.760463e-03,-1.112300e+01,8.055998e+00

saved to: lag_values_Grp1.txt


#+END_EXAMPLE

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
|         Freq |           +- |           Lag |           +- |
| 1.163636e-04 | 3.636364e-05 |  1.156379e+02 | 6.341921e+01 |
| 2.221488e-04 | 6.942149e-05 |  1.673608e+02 | 2.367800e+01 |
| 4.241022e-04 | 1.325319e-04 |  4.525099e+01 | 1.284897e+01 |
| 8.096496e-04 | 2.530155e-04 | -1.651157e+01 | 7.074069e+00 |
| 1.545695e-03 | 4.830296e-04 | -2.893330e+01 | 3.947370e+00 |
| 2.950872e-03 | 9.221474e-04 | -1.711897e+01 | 4.294255e+00 |
| 5.633482e-03 | 1.760463e-03 | -1.112300e+01 | 8.055998e+00 |


*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("Grp1_time_lags.fits");
r=load_rmf("Grp1_time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

** Group 2 Spectra

Lag-frequency Group 2 Obserations

Obs data used here = 0110890201 and 0506200301

use script =lagfreq_comb_Grp2.sl=

Lag values
#+BEGIN_EXAMPLE

1.163636e-04,3.636364e-05,4.260097e+02,4.728891e+02
2.221488e-04,6.942149e-05,8.467851e+00,6.989345e+01
4.241022e-04,1.325319e-04,4.220892e+00,4.106117e+01
8.096496e-04,2.530155e-04,5.332109e+01,3.649707e+01
1.545695e-03,4.830296e-04,-3.400950e+01,1.512826e+01
2.950872e-03,9.221474e-04,-9.505591e+00,1.346331e+01
5.633482e-03,1.760463e-03,9.766124e+00,2.729860e+01

saved to time_lags_Grp2.csv
#+END_EXAMPLE

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
|         Freq |           +- |           Lag |           +- |
| 1.163636e-04 | 3.636364e-05 |  4.260097e+02 | 4.728891e+02 |
| 2.221488e-04 | 6.942149e-05 |  8.467851e+00 | 6.989345e+01 |
| 4.241022e-04 | 1.325319e-04 |  4.220892e+00 | 4.106117e+01 |
| 8.096496e-04 | 2.530155e-04 |  5.332109e+01 | 3.649707e+01 |
| 1.545695e-03 | 4.830296e-04 | -3.400950e+01 | 1.512826e+01 |
| 2.950872e-03 | 9.221474e-04 | -9.505591e+00 | 1.346331e+01 |
| 5.633482e-03 | 1.760463e-03 |  9.766124e+00 | 2.729860e+01 |

*Generate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("Grp2_time_lags.fits");
r=load_rmf("Grp2_time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_lagfreq_Grp2.gif

** Group 3 Spectra

Group 3 obs data used here = 0506200201 and 0554710801

use script =lagfreq_Grp3.sl=

Lag values
#+BEGIN_EXAMPLE
Freq,+-,Lag,+-
1.163636e-04,3.636364e-05,2.776155e+02,1.092714e+02
2.221488e-04,6.942149e-05,1.568702e+02,4.939430e+01
4.241022e-04,1.325319e-04,-2.247539e+01,6.343728e+01
8.096496e-04,2.530155e-04,-9.337090e+01,7.318847e+01
1.545695e-03,4.830296e-04,-7.459788e+01,3.684652e+01
2.950872e-03,9.221474e-04,-3.959390e+01,3.290037e+01
5.633482e-03,1.760463e-03,3.204950e+01,9.218400e+00

#+END_EXAMPLE

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 1.163636e-04 | 3.636364e-05 |  2.776155e+02 | 1.092714e+02 |
+--------------+--------------+---------------+--------------+
| 2.221488e-04 | 6.942149e-05 |  1.568702e+02 | 4.939430e+01 |
+--------------+--------------+---------------+--------------+
| 4.241022e-04 | 1.325319e-04 | -2.247539e+01 | 6.343728e+01 |
+--------------+--------------+---------------+--------------+
| 8.096496e-04 | 2.530155e-04 | -9.337090e+01 | 7.318847e+01 |
+--------------+--------------+---------------+--------------+
| 1.545695e-03 | 4.830296e-04 | -7.459788e+01 | 3.684652e+01 |
+--------------+--------------+---------------+--------------+
| 2.950872e-03 | 9.221474e-04 | -3.959390e+01 | 3.290037e+01 |
+--------------+--------------+---------------+--------------+
| 5.633482e-03 | 1.760463e-03 |  3.204950e+01 | 9.218400e+00 |
+--------------+--------------+---------------+--------------+

*Generate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("Grp3_time_lags.fits");
r=load_rmf("Grp3_time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_lagfreq_Grp3.gif

** Grouped Results

For the SNR>5 data the year/groupings are as follows:

*\Gamma_{relxill} V Model Flux*
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Flux_Logxi_V_CvrFrac.png

*\Gamma_{relxill} V Log\xi*
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Flux_Logxi_V_Gamma.png


1 - 8 keV with SNR>5 plots of Grouped data
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_lag_v_Afe.png

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_lag_v_logxi.png

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/

** Individual Obs Results

See core file =1H0707_ind_obs_flux.ods= and =1H0707_ind_obs_flux.csv=

*Table of Model Flux* Unsing the parameter file
=relxill_comb_zpcfabs_SNR5.par=

Phabs was obtained independently using
"phabs*(relxill+powerlaw+diskbb)" model and then fitting phabs only to
obtain the model flux


1H0707-495

|    Obs_ID | Model_Ph_flux | Model_En_flux | RELXILL_Refl_Flux | Powerlaw_Flux | Flux_nH_phabs | Cvr_Frac | Gamma_relxill | Log_xi | Ratio=Refl_Flux/PL_Flux |
| 110890201 |      8.59E-13 |      3.33E-04 |          1.12E-12 |      5.59E-13 |      6.29E-06 |     0.95 |         3.375 |   2.15 |        2.00590487605667 |
| 148010301 |      3.44E-12 |      1.62E-03 |          1.68E-12 |      3.13E-12 |      6.38E-06 |     0.85 |           3.4 |    2.3 |        0.53671965848112 |
| 506200201 |      4.25E-13 |      1.37E-04 |          7.01E-13 |      2.19E-13 |      5.94E-06 |     0.95 |         3.399 |    2.2 |        3.20506583425342 |
| 506200301 |      1.48E-12 |      5.76E-04 |          2.10E-12 |      9.70E-13 |      6.20E-06 |     0.94 |           3.4 |   2.32 |        2.16229568265667 |
| 506200401 |      3.35E-12 |      1.54E-03 |          2.21E-12 |      2.16E-12 |      6.47E-06 |     0.87 |         3.335 |   2.34 |        1.02013231881369 |
| 506200501 |      4.44E-12 |      1.98E-03 |          2.34E-12 |      4.03E-12 |      6.27E-06 |     0.89 |         3.361 |   2.35 |       0.579414823076205 |
| 511580101 |      2.75E-12 |      1.15E-03 |          1.67E-12 |      2.34E-12 |      6.27E-06 |     0.94 |         3.326 |   2.22 |       0.711134516084428 |
| 511580201 |      4.58E-12 |      2.09E-03 |          2.20E-12 |      3.14E-12 |      6.51E-06 |      0.8 |         3.319 |   2.33 |       0.701763564326018 |
| 511580301 |      3.46E-12 |      1.59E-03 |          1.28E-12 |      2.38E-12 |      6.51E-06 |     0.69 |         3.263 |   2.07 |       0.536767920640291 |
| 511580401 |      2.80E-12 |      2.80E-12 |          1.64E-12 |      1.81E-12 |      6.43E-06 |     0.74 |           3.4 |   2.32 |       0.906893502524762 |
| 653510301 |      2.90E-12 |      1.42E-03 |          1.77E-12 |      1.86E-12 |      6.41E-06 |     0.79 |           3.4 |   2.36 |       0.950971319809278 |
| 653510401 |      3.87E-12 |      1.91E-03 |          1.35E-12 |      3.12E-12 |      6.42E-06 |     0.72 |           3.4 |   2.33 |       0.430984583818472 |
| 653510501 |      2.68E-12 |      1.28E-03 |          1.86E-12 |      1.82E-12 |      6.43E-06 |     0.82 |           3.4 |   2.35 |        1.02262487783922 |
| 653510601 |      3.17E-12 |      1.59E-03 |          1.48E-12 |      2.16E-12 |      6.43E-06 |     0.77 |           3.4 |   2.36 |       0.686190623365612 |
| 554710801 |      4.79E-13 |      1.14E-04 |          7.84E-13 |      7.35E-14 |      6.07E-06 |     0.95 |          3.37 |   2.15 |        10.6709356277804 |

Next - work on the errors for the Powerlaw and reflectedModel flux.

Use isis scrtipt =data_flux.sl= and recoird results for plotting in
=1H0707_ind_obs_flux.csv= and =SNR5_results.vsz=

This will need automating!!!!

The plots are of the 15 indiviual observations for 1H0707-495 using
Relxill, Powerlaw and Covering Fraction modelling outlined above.

*Reflection Flux V Powerlaw Flux* (requires errors as stated above)
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_Flux.png

*Model Flux V Covering Fraction*
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Flux_V_CvrFrac.png


*Reflection Flux V Covering Fraction*
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Flux_Refl_V_CvrFrac.png


*Model Flux V Log$\xi$*
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Flux_V_Logxi.png


*All Flux V Log$\xi$*
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Flux_all_vs_Logion.png


*Flux Ratio V Log$\xi$*
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Flux_ratio_v_logxi.png


*Flux Ratio V n_H*
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Flux_ratio_v_nh.png

** *Segmented analysis* for $~f_{max}$

 PATH = =/data/scratch3/steff/1H0707-495/combined/lagfreq_segs_ECM.sl=

All observations were split into 53 segments of between 18 - 25 ks
 totalling 1158.6 ks of effective observation time.
 The combined lag-frequency of these observations is shown below.

%Max frequency is the vertical line x=  2.840621e-03 Hz%

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707_comb_segs_lagfreq.gif

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707_comb_segs_coh.gif

** Combined: $~f_{max} = 2.8 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_comb_script.sl=

Lags found

| 1.085714e-04 | 2.857143e-05 |  8.914646e+01 | 6.802465e+01 |
| 1.861224e-04 | 4.897959e-05 |  1.653453e+02 | 2.815588e+01 |
| 3.190671e-04 | 8.396501e-05 |  1.323586e+02 | 1.599274e+01 |
| 5.469721e-04 | 1.439400e-04 | -1.028120e+01 | 9.105510e+00 |
| 9.376664e-04 | 2.467543e-04 | -1.796084e+01 | 5.265051e+00 |
| 1.607428e-03 | 4.230074e-04 | -2.657116e+01 | 2.852366e+00 |
| 2.755591e-03 | 7.251556e-04 | -7.426622e+00 | 1.627332e+00 |


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_lagfreq_comb_fmax.gif

** Hi-flux: $~f_{max} = 2.8 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_hi_flux.sl=

Lags found

| 1.085714e-04 | 2.857143e-05 |  8.840774e+01 | 7.151235e+01 |
| 1.861224e-04 | 4.897959e-05 |  1.655761e+02 | 2.945983e+01 |
| 3.190671e-04 | 8.396501e-05 |  1.323719e+02 | 1.686690e+01 |
| 5.469721e-04 | 1.439400e-04 | -1.038081e+01 | 9.601972e+00 |
| 9.376664e-04 | 2.467543e-04 | -1.792205e+01 | 5.557540e+00 |
| 1.607428e-03 | 4.230074e-04 | -2.655711e+01 | 3.012106e+00 |
| 2.755591e-03 | 7.251556e-04 | -7.414404e+00 | 1.722310e+00 |


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_lagfreq_hiflux_fmax.gif

** Hi-cts>20: $~f_{max} = 2.8 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_hi_cts_lc_data.sl=

Lags found

| 1.085714e-04 | 2.857143e-05 |  1.884863e+01 | 9.813812e+01 |
| 1.861224e-04 | 4.897959e-05 |  2.356483e+02 | 3.918422e+01 |
| 3.190671e-04 | 8.396501e-05 |  1.464038e+02 | 2.042925e+01 |
| 5.469721e-04 | 1.439400e-04 | -1.276660e+00 | 1.269852e+01 |
| 9.376664e-04 | 2.467543e-04 | -1.763777e+01 | 7.276261e+00 |
| 1.607428e-03 | 4.230074e-04 | -3.251954e+01 | 3.934424e+00 |
| 2.755591e-03 | 7.251556e-04 | -7.657706e+00 | 2.240515e+00 |


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_lagfreq_hi_cts_lc_fmax.gif

** Med: $~f_{max} = 2.8 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_medflux.sl=

Lags found

| 1.085714e-04 | 2.857143e-05 |  6.233710e+02 | 6.191817e+02 |
| 1.861224e-04 | 4.897959e-05 |  2.254824e+01 | 1.211710e+02 |
| 3.190671e-04 | 8.396501e-05 | -4.903933e+00 | 3.250190e+01 |
| 5.469721e-04 | 1.439400e-04 |  1.749989e+01 | 3.857641e+01 |
| 9.376664e-04 | 2.467543e-04 |  4.711189e+01 | 2.138309e+01 |
| 1.607428e-03 | 4.230074e-04 | -3.568607e+01 | 9.631117e+00 |
| 2.755591e-03 | 7.251556e-04 | -7.437850e+00 | 7.081652e+00 |


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_lagfreq_medflux_fmax.gif

** Lo-flux: $~f_{max} = 2.8 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_lo_flux.sl=

Lags found

| 1.085714e-04 | 2.857143e-05 |  2.947609e+02 | 1.275105e+02 |
| 1.861224e-04 | 4.897959e-05 |  1.333415e+02 | 5.355345e+01 |
| 3.190671e-04 | 8.396501e-05 |  1.292101e+02 | 5.232859e+01 |
| 5.469721e-04 | 1.439400e-04 |  2.705473e+01 | 4.634820e+01 |
| 9.376664e-04 | 2.467543e-04 | -2.525674e+01 | 2.247588e+01 |
| 1.607428e-03 | 4.230074e-04 | -2.871260e+01 | 1.052060e+01 |
| 2.755591e-03 | 7.251556e-04 | -8.652118e+00 | 5.010411e+00 |


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_lagfreq_loflux_fmax.gif

** Lo-cts<20: $~f_{max} = 2.8 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_lo_cts_lc_data.sl=

Lags found

| 6.785714e-05 | 1.785714e-05 |  6.715279e+01 | 1.331887e+02 |
| 1.163265e-04 | 3.061224e-05 |  1.320719e+02 | 7.668210e+01 |
| 1.994169e-04 | 5.247813e-05 |  1.117502e+02 | 3.881146e+01 |
| 3.418576e-04 | 8.996252e-05 |  8.321893e+01 | 2.106502e+01 |
| 5.860415e-04 | 1.542215e-04 | -2.352985e+01 | 1.171150e+01 |
| 1.004643e-03 | 2.643796e-04 | -2.023512e+01 | 6.923334e+00 |
| 1.722244e-03 | 4.532222e-04 | -1.956463e+01 | 3.788993e+00 |


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_lagfreq_lo_cts_lc_fmax.gif

** All fmax lag groups together

PATH =/home/steff075/phd_ecm/1h0707/1H0707-lag-results-All-fmax.vsz=

Importing: =1H0707-lag-results-All-fmax.csv=


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-lag-results-All-fmax.png


pdf at:


http://www.star.bris.ac.uk/steff/ecm/1H0707-lag-results-All-fmax.pdf


** OBS 0110890201: $~f_{max} = 2.8 \times 10 ^{-3}$ Hz


PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_0110890201_segs.sl=

Lags found

#+BEGIN_EXAMPLE
1.066667e-04,2.666667e-05,1.878117e+02,1.976700e+02
1.777778e-04,4.444444e-05,-1.279947e+00,5.553634e+01
2.962963e-04,7.407407e-05,5.765143e+01,6.771361e+01
4.938272e-04,1.234568e-04,-1.033002e+02,6.700916e+01
8.230453e-04,2.057613e-04,-4.767803e+00,5.639420e+01
1.371742e-03,3.429355e-04,-7.315667e+00,1.663436e+01
2.286237e-03,5.715592e-04,-3.297055e+01,1.217980e+01
#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0110890201_lagfreq_segs.gif

** OBS 0148010301: $~f_{max} = 2.8 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_0148010301_segs.sl=

Lags found

#+BEGIN_EXAMPLE
1.066667e-04,2.666667e-05,5.372247e+02,3.905070e+02
1.777778e-04,4.444444e-05,9.229911e+01,6.826332e+01
2.962963e-04,7.407407e-05,1.316581e+02,8.507751e+01
4.938272e-04,1.234568e-04,-1.430773e+01,3.772658e+01
8.230453e-04,2.057613e-04,-7.462400e+00,2.488764e+01
1.371742e-03,3.429355e-04,-4.189236e+01,1.305377e+01
2.286237e-03,5.715592e-04,-7.080180e+00,7.680766e+00

cp 1H0707-495_0148010301_lagfreq_segs.gif /home/WWW/steff/ecm

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0148010301_lagfreq_segs.gif

*Create fits and response*


#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("1H0707-495-OBS-0148010301-time-lags-segs.fits");
r=load_rmf("1H0707-495-OBS-0148010301-time-lags-segs.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

** OBS 0506200201: $~f_{max} = 2.8 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_0506200201_segs.sl=

Lags found

#+BEGIN_EXAMPLE
1.066667e-04,2.666667e-05,3.035757e+02,2.146605e+02
1.777778e-04,4.444444e-05,1.627255e+02,8.771731e+01
2.962963e-04,7.407407e-05,1.636039e+02,6.106606e+01
4.938272e-04,1.234568e-04,-6.485203e+01,9.413600e+01
8.230453e-04,2.057613e-04,-1.097560e+02,3.925392e+01
1.371742e-03,3.429355e-04,-4.378059e+01,2.242304e+01
2.286237e-03,5.715592e-04,-1.806503e+00,1.250549e+01


cp 1H0707-495_0506200201_lagfreq_segs.gif /home/WWW/steff/ecm

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0506200201_lagfreq_segs.gif


*Create fits and response*

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("1H0707-495-OBS-0506200201-time-lags-segs.fits");
r=load_rmf("1H0707-495-OBS-0506200201-time-lags-segs.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

** OBS 0506200301: $~f_{max} = 2.8 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_0506200301_segs.sl=

Lags found

#+BEGIN_EXAMPLE
1.312500e-04,3.125000e-05,1.269831e+02,7.891763e+02
2.132812e-04,5.078125e-05,1.175443e+02,4.592325e+01
3.465820e-04,8.251953e-05,-1.054090e+01,3.179613e+01
5.631958e-04,1.340942e-04,3.083917e+01,3.583535e+01
9.151932e-04,2.179031e-04,5.521185e+01,2.631505e+01
1.487189e-03,3.540926e-04,-3.547902e+01,1.453027e+01
2.416682e-03,5.754005e-04,-1.529675e+01,1.209866e+01

cp 1H0707-495_0506200301_lagfreq_segs.gif /home/WWW/steff/ecm

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0506200301_lagfreq_segs.gif

*Create fits and response*

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("1H0707-495-OBS-0506200301-time-lags-segs.fits");
r=load_rmf("1H0707-495-OBS-0506200301-time-lags-segs.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

** OBS 0506200401: $~f_{max} = 2.8 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_0506200401_segs.sl=

Lags found

#+BEGIN_EXAMPLE
1.312500e-04,3.125000e-05,5.039638e+02,2.630737e+02
2.132812e-04,5.078125e-05,2.291321e+02,8.234404e+01
3.465820e-04,8.251953e-05,3.276263e+01,8.730814e+01
5.631958e-04,1.340942e-04,5.471602e+01,4.495312e+01
9.151932e-04,2.179031e-04,-5.237915e+01,2.374855e+01
1.487189e-03,3.540926e-04,3.578052e+01,1.357721e+01
2.416682e-03,5.754005e-04,-1.328048e+01,7.541249e+00


cp 1H0707-495_0506200401_lagfreq_segs.gif /home/WWW/steff/ecm

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0506200401_lagfreq_segs.gif


*Create fits and response*

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("1H0707-495-OBS-0506200401-time-lags-segs.fits");
r=load_rmf("1H0707-495-OBS-0506200401-time-lags-segs.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

** OBS 0506200501: $~f_{max} = 2.8 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_0506200501_segs.sl=

Lags found

#+BEGIN_EXAMPLE
1.312500e-04,3.125000e-05,4.386863e+02,5.627757e+01
2.132812e-04,5.078125e-05,8.462848e+01,9.064971e+01
3.465820e-04,8.251953e-05,-5.240799e+01,7.121278e+01
5.631958e-04,1.340942e-04,1.841197e+01,3.868045e+01
9.151932e-04,2.179031e-04,-4.040882e+01,2.430728e+01
1.487189e-03,3.540926e-04,1.869750e+00,1.778541e+01
2.416682e-03,5.754005e-04,-8.527553e+00,1.077171e+01

cp 1H0707-495_0506200501_lagfreq_segs.gif /home/WWW/steff/ecm

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0506200501_lagfreq_segs.gif


*Create fits and response*

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("1H0707-495-OBS-0506200501-time-lags-segs.fits");
r=load_rmf("1H0707-495-OBS-0506200501-time-lags-segs.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

** OBS 0511580101: $~f_{max} = 2.8 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_0511580101_segs.sl=

Lags found

#+BEGIN_EXAMPLE
1.066667e-04,2.666667e-05,4.027056e+00,1.761486e+02
1.777778e-04,4.444444e-05,2.299343e+02,7.096227e+01
2.962963e-04,7.407407e-05,-2.697799e+00,7.631445e+01
4.938272e-04,1.234568e-04,-9.293789e-01,2.735450e+01
8.230453e-04,2.057613e-04,-2.442992e+01,1.746226e+01
1.371742e-03,3.429355e-04,-2.392940e+01,8.846061e+00
2.286237e-03,5.715592e-04,-1.098380e+01,6.281350e+00

cp 1H0707-495_0511580101_lagfreq_segs.gif /home/WWW/steff/ecm

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0511580101_lagfreq_segs.gif



** OBS 0511580201: $~f_{max} = 2.8 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_0506200201_segs.sl=

Lags found

#+BEGIN_EXAMPLE
1.066667e-04,2.666667e-05,6.764132e+00,3.277222e+02
1.777778e-04,4.444444e-05,2.100921e+02,9.522877e+01
2.962963e-04,7.407407e-05,1.577844e+02,3.628768e+01
4.938272e-04,1.234568e-04,5.015799e+01,4.345053e+01
8.230453e-04,2.057613e-04,-3.947277e+01,1.755226e+01
1.371742e-03,3.429355e-04,-3.298410e+01,9.452702e+00
2.286237e-03,5.715592e-04,-9.077359e+00,6.288705e+00

cp 1H0707-495_0511580201_lagfreq_segs.gif /home/WWW/steff/ecm

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0511580201_lagfreq_segs.gif

** OBS 0511580301: $~f_{max} = 2.8 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_0506200301_segs.sl=

Lags found

#+BEGIN_EXAMPLE
1.066667e-04,2.666667e-05,-1.666007e+01,1.797000e+02
1.777778e-04,4.444444e-05,4.413816e+02,1.051678e+02
2.962963e-04,7.407407e-05,1.874171e+02,4.664492e+01
4.938272e-04,1.234568e-04,2.272179e+00,3.450658e+01
8.230453e-04,2.057613e-04,1.376407e+01,2.257395e+01
1.371742e-03,3.429355e-04,-3.622149e+01,1.040286e+01
2.286237e-03,5.715592e-04,-1.019017e+01,7.593014e+00


cp 1H0707-495_0511580301_lagfreq_segs.gif /home/WWW/steff/ecm

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0511580301_lagfreq_segs.gif

** OBS 0511580401: $~f_{max} = 2.8 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_0506200401_segs.sl=

Lags found

#+BEGIN_EXAMPLE
1.066667e-04,2.666667e-05,1.106299e+02,2.051051e+02
1.777778e-04,4.444444e-05,-6.228768e+01,1.091076e+02
2.962963e-04,7.407407e-05,2.511546e+02,4.753442e+01
4.938272e-04,1.234568e-04,8.350762e+01,3.677209e+01
8.230453e-04,2.057613e-04,-6.455807e+01,2.169240e+01
1.371742e-03,3.429355e-04,-2.143148e+01,1.635251e+01
2.286237e-03,5.715592e-04,-1.771468e+01,6.870665e+00


cp 1H0707-495_0511580401_lagfreq_segs.gif /home/WWW/steff/ecm

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0511580401_lagfreq_segs.gif


** OBS 0554710801: $~f_{max} = 2.8 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_0554710801_segs.sl=

Lags found

#+BEGIN_EXAMPLE
1.066667e-04,2.666667e-05,2.550338e+02,2.448186e+02
1.777778e-04,4.444444e-05,-1.769737e+02,1.544797e+02
2.962963e-04,7.407407e-05,2.361012e+02,1.732760e+02
4.938272e-04,1.234568e-04,7.333371e+01,5.801530e+01
8.230453e-04,2.057613e-04,8.336303e+01,2.989116e+01
1.371742e-03,3.429355e-04,-1.286934e+01,1.644881e+01
2.286237e-03,5.715592e-04,-1.161160e+01,8.655020e+00

cp 1H0707-495_0554710801_lagfreq_segs.gif /home/WWW/steff/ecm

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0554710801_lagfreq_segs.gif



** OBS 0653510301: $~f_{max} = 2.8 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_0653510301_segs.sl=

Lags found

#+BEGIN_EXAMPLE
1.066667e-04,2.666667e-05,2.713567e+01,1.324367e+02
1.777778e-04,4.444444e-05,9.500154e+01,1.047833e+02
2.962963e-04,7.407407e-05,6.464270e+01,5.144895e+01
4.938272e-04,1.234568e-04,-4.971814e+01,4.537982e+01
8.230453e-04,2.057613e-04,-3.237648e+01,2.248832e+01
1.371742e-03,3.429355e-04,-1.563589e+01,1.253628e+01
2.286237e-03,5.715592e-04,-7.286884e+00,6.327994e+00

cp 1H0707-495_0653510301_lagfreq_segs.gif /home/WWW/steff/ecm

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0653510301_lagfreq_segs.gif


** OBS 0653510401: $~f_{max} = 2.8 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_0653510401_segs.sl=

Lags found

#+BEGIN_EXAMPLE
1.066667e-04,2.666667e-05,-1.960195e+02,1.970254e+02
1.777778e-04,4.444444e-05,2.669537e+02,7.180777e+01
2.962963e-04,7.407407e-05,8.399273e+01,5.248735e+01
4.938272e-04,1.234568e-04,-4.367633e+01,3.007484e+01
8.230453e-04,2.057613e-04,-5.966367e+00,1.900698e+01
1.371742e-03,3.429355e-04,-3.746859e+01,9.737537e+00
2.286237e-03,5.715592e-04,-2.052073e+01,6.616190e+00


cp 1H0707-495_0653510401_lagfreq_segs.gif /home/WWW/steff/ecm

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0653510401_lagfreq_segs.gif





** OBS 0653510501: $~f_{max} = 2.8 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_0653510501_segs.sl=

Lags found

#+BEGIN_EXAMPLE
1.066667e-04,2.666667e-05,-3.868501e+02,2.621463e+02
1.777778e-04,4.444444e-05,-7.181922e+01,1.487609e+02
2.962963e-04,7.407407e-05,2.717288e+02,7.812591e+01
4.938272e-04,1.234568e-04,-5.016379e+01,3.291990e+01
8.230453e-04,2.057613e-04,5.191202e+00,1.876759e+01
1.371742e-03,3.429355e-04,-1.298630e+01,1.263349e+01
2.286237e-03,5.715592e-04,-1.665050e+01,8.059081e+00

cp 1H0707-495_0653510501_lagfreq_segs.gif /home/WWW/steff/ecm

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0653510501_lagfreq_segs.gif




** OBS 0653510601: $~f_{max} = 2.8 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_0653510601_segs.sl=

Lags found

#+BEGIN_EXAMPLE
1.066667e-04,2.666667e-05,5.481667e+02,1.212067e+02
1.777778e-04,4.444444e-05,2.415134e+02,1.192550e+02
2.962963e-04,7.407407e-05,1.667539e+02,4.473741e+01
4.938272e-04,1.234568e-04,2.850156e+01,3.697091e+01
8.230453e-04,2.057613e-04,4.478155e+00,2.083809e+01
1.371742e-03,3.429355e-04,-3.300627e+01,1.249321e+01
2.286237e-03,5.715592e-04,-1.810680e+00,8.829393e+00

cp 1H0707-495_0653510601_lagfreq_segs.gif /home/WWW/steff/ecm

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0653510601_lagfreq_segs.gif

** Results


PATH = =/home/steff075/phd_ecm/results-spectral/1H0707_flux_lag_relxill_indobs=

| 1H0707_obs |  1H_Ledd | 1H_Lbol/erg s-1 | 1H_LogLbol |       1H_Edd_frac | 1H-Lbol_LeddEdd-ratio | 1H-NED-DL | 1H-Soft-lag |     +- | 1H-Soft-lag-freq |       +- | 1H-totalcounts | 1H-exp/ks | 1H-L03-10 = (4*PI()*(H22)*P2) | 1H-L2-10 | 1H-spec-03-10-flux | 1H-spec-2-10-flux | 1H-Relxill-gamma |     + |     - | 1H-Relxill-ionise |     + |     - | 1H-Relxill-Afe |    + |    - | 1H-Relxill-RF |    + |    - | 1H-Relxill-incl |     + |     - | 1H-Cvr-Frac |     + |     - |    1H-nH |        + |     - |
|  110890201 | 2.57E+44 |        2.69E+44 |       44.4 | 0.007110189370718 |                  1.05 |  5.77E+26 |       103.3 |     67 |         4.94E-04 | 1.24E-04 |       4.22E+04 |    36.257 |                      3.18E+42 | 1.83E+42 |           7.59E-13 |          4.37E-13 |             2.64 |  0.01 |  0.02 |              0.76 |  0.31 |  0.34 |            0.5 | 1.94 |    0 |            10 |    0 | 2.43 |           77.95 |  2.04 |   0.3 |        0.74 | 0.005 |  0.11 | 3.18E+01 | 1.68E+01 |  8.82 |
|  148010301 | 2.57E+44 |        2.69E+44 |       44.4 | 0.017735996793272 |                  1.05 |  5.77E+26 |       41.89 |  13.05 |         1.37E-03 | 5.72E-04 |       2.66E+05 |    69.699 |                      1.31E+43 | 4.56E+42 |           3.13E-12 |          1.09E-12 |             3.01 | 0.005 | 0.005 |              0.38 |  2.54 |  0.14 |            0.5 | 1.88 |    0 |            10 |    0 | 2.17 |              80 |     0 |  2.41 |         0.8 |  0.15 |  0.19 | 2.08E+02 |    0.148 | 0.195 |
|  506200201 | 2.57E+44 |        2.69E+44 |       44.4 | 0.004004639936801 |                  1.05 |  5.77E+26 |      109.75 |  39.25 |         8.23E-04 | 2.06E-04 |       3.58E+01 |    35.752 |                      1.54E+42 | 1.03E+42 |           3.69E-13 |          2.46E-13 |              2.4 |  0.28 |  0.31 |              3.29 |  0.35 |  0.49 |           5.04 | 4.96 | 2.37 |            10 |    0 | 8.33 |           78.18 |  1.81 |    64 |         0.8 |  0.01 |  0.38 |    13.37 |    10.61 | 10.96 |
|  506200301 | 2.57E+44 |        2.69E+44 |       44.4 | 0.010060436914403 |                  1.05 |  5.77E+26 |       35.48 |  14.53 |         1.49E-03 | 3.54E-04 |       7.12E+04 |    35.826 |                      5.36E+42 | 2.59E+42 |           1.28E-12 |          6.18E-13 |             2.49 |  0.18 |  0.16 |              1.11 |  1.22 | 0.009 |          1.078 | 4.06 | 0.58 |            10 |    0 | 1.95 |           65.77 |  6.08 |  2.55 |        0.12 |  0.64 | 0.007 |     2.41 |        0 |   2.4 |
|  506200401 | 2.57E+44 |        2.69E+44 |       44.4 | 0.017385997774406 |                  1.05 |  5.77E+26 |       52.38 |  23.75 |         9.15E-04 | 2.18E-04 |       1.63E+05 |    37.589 |                      1.36E+43 | 4.47E+42 |           3.25E-12 |          1.07E-12 |             3.31 | 0.008 | 0.008 |              1.19 |  0.29 | 0.009 |            0.5 | 2.13 |    0 |            10 |    0 | 4.09 |           67.44 | 11.48 |  4.13 |        0.37 |  0.12 |   0.1 |    0.184 |    15.16 |  7.87 |
|  506200501 | 2.57E+44 |        2.69E+44 |       44.4 | 0.024092955717341 |                  1.05 |  5.77E+26 |       52.41 |  71.21 |         3.47E-04 | 8.25E-05 |       2.02E+05 |    37.847 |                      1.77E+43 | 6.19E+42 |           4.22E-12 |          1.48E-12 |             3.16 |  0.13 |  0.11 |              2.06 |  0.27 |  0.23 |            0.5 | 0.91 |    0 |          8.34 | 1.66 | 3.16 |           76.74 |  3.25 |  3.87 |        0.46 |  0.12 |  0.14 |    61.21 |    23.89 | 18.06 |
|  511580101 | 2.57E+44 |        2.69E+44 |       44.4 | 0.016604604616005 |                  1.05 |  5.77E+26 |       24.43 |  17.46 |         8.23E-04 | 2.06E-04 |       3.48E+05 |   102.684 |                      1.14E+43 | 4.27E+42 |           2.72E-12 |          1.02E-12 |             3.14 |  0.12 |  0.01 |              2.31 |  0.13 |  0.25 |           0.59 | 0.62 | 0.01 |            10 |    0 | 1.71 |            77.1 |  2.53 |  3.73 |        0.54 |  0.01 |  0.01 |    5.468 |     0.84 | 0.135 |
|  511580201 | 2.57E+44 |        2.69E+44 |       44.4 | 0.023718538162274 |                  1.05 |  5.77E+26 |       39.47 |  17.55 |         8.23E-04 | 2.08E-04 |       8.60E+01 |    86.046 |                      1.87E+43 | 6.10E+42 |           4.47E-12 |          1.46E-12 |             3.36 | 0.003 |  0.01 |              2.37 |  0.26 |  0.21 |            0.5 | 0.38 |    0 |            10 |    0 | 1.73 |           79.01 |  0.98 |  3.31 |        0.53 |  0.01 |  0.01 |   0.1068 |    5.719 |  2.08 |
|  511580301 | 2.57E+44 |        2.69E+44 |       44.4 | 0.017255765581339 |                  1.05 |  5.77E+26 |       36.22 |   10.4 |         1.37E-03 | 3.43E-04 |       3.46E+05 |    77.935 |                      1.39E+43 | 4.43E+42 |           3.33E-12 |          1.06E-12 |             3.36 |  0.01 |  0.01 |              2.21 |  0.15 |  0.21 |            0.5 | 0.62 |    0 |            10 |    0 | 1.42 |           72.82 |  3.15 |  3.27 |        0.52 |  0.01 |  0.13 |   29.432 |     6.32 |  7.54 |
|  511580401 | 2.57E+44 |        2.69E+44 |       44.4 | 0.013853449537471 |                  1.05 |  5.77E+26 |       64.56 |  21.69 |         8.23E-04 | 2.06E-04 |       7.54E+01 |     75.36 |                      1.04E+43 | 3.56E+42 |           2.49E-12 |          8.51E-13 |              3.4 |     0 |  0.15 |              1.92 |  0.17 |  0.51 |            0.5 | 1.85 |    0 |            10 |    0 | 3.37 |           69.29 |  6.91 | 10.75 |        0.51 | 0.001 |  0.19 |    5.179 |    1.008 | 1.095 |
|  653510301 | 2.57E+44 |        2.69E+44 |       44.4 | 0.012674848190217 |                  1.05 |  5.77E+26 |       49.72 |  45.37 |         4.94E-04 | 1.23E-04 |       4.06E+05 |   103.743 |                      1.02E+43 | 3.26E+42 |           2.44E-12 |          7.79E-13 |              3.4 |     0 |  0.01 |              2.17 |  0.13 |  0.12 |            0.5 | 1.01 |    0 |            10 |    0 | 0.54 |           71.59 |  3.03 |  4.19 |        0.55 |  0.01 |  0.01 |     8.26 |    1.965 | 3.837 |
|  653510401 | 2.57E+44 |        2.69E+44 |       44.4 | 0.016230187060939 |                  1.05 |  5.77E+26 |      196.02 | 197.02 |         1.07E-04 | 2.67E-05 |       5.55E+05 |   109.367 |                      1.35E+43 | 4.17E+42 |           3.23E-12 |          9.97E-13 |             3.25 | 0.003 | 0.004 |              0.76 | 0.007 | 0.003 |           2.28 | 1.22 | 1.78 |            10 |    0 | 0.29 |              80 |     0 |   0.6 |        0.95 |     0 |  0.07 |    6.144 |   0.2737 | 2.188 |
|  653510501 | 2.57E+44 |        2.69E+44 |       44.4 | 0.012339500293071 |                  1.05 |  5.77E+26 |      386.85 | 262.14 |         1.07E-04 | 2.67E-05 |       3.46E+05 |    86.327 |                      9.50E+42 | 3.17E+42 |           2.27E-12 |          7.58E-13 |             3.36 |  0.01 |  0.01 |              2.14 |  0.17 |  0.34 |            0.5 | 0.44 |    0 |            10 |    0 | 0.54 |           73.35 |  2.86 |  4.62 |        0.59 |  0.01 |  0.14 |    6.653 |    0.945 | 0.901 |
|  653510601 | 2.57E+44 |        2.69E+44 |       44.4 | 0.012827871017071 |                  1.05 |  5.77E+26 |          33 |  12.49 |         1.37E-03 | 3.43E-04 |       4.59E+05 |    97.645 |                      1.13E+43 | 3.30E+42 |           2.70E-12 |          7.88E-13 |              3.3 |     0 | 0.002 |              0.74 | 0.003 | 0.002 |            0.5 | 0.49 |    0 |            10 |    0 | 0.46 |              80 |     0 |  0.21 |        0.51 |  0.17 |     0 |    46.87 |    31.36 | 15.67 |
|  554710801 | 2.57E+44 |        2.69E+44 |       44.4 | 0.004997660408935 |                  1.05 |  5.77E+26 |      176.97 | 154.47 |         1.78E-04 | 4.44E-05 |       2.68E+04 |    79.974 |                      1.72E+42 | 1.28E+42 |           4.10E-13 |          3.07E-13 |             2.82 |  0.15 |  0.22 |              1.82 |  0.26 |  0.45 |            0.5 | 0.75 |    0 |            10 |    0 | 1.76 |              80 |     0 |  3.91 |        0.93 |  0.01 |  0.01 |    13.66 |    2.489 | 2.735 |

* *Ark564*

** Lag overview
PATH to data = =/homeb/steff075/phd_ecm/Ark564=

PATH to original data =/data/scratch3/steff/Ark564=

PATH to new scripts and data =/homeb/steff075/phd_ecm/Ark564=

*Observations used:*

"0110890201","0148010301","0506200201","0506200301","0506200401","0506200501"
"0511580101","0511580201","0511580301""0511580401","0554710801","0653510301"
"0653510401","0653510501","0653510601"

#+BEGIN_EXAMPLE
Group1 Hi-Flux    Green         = Obs ID 0670130201   2011
                  Purple        = Obs ID 0670130901   2011
                  Indigo        = Obs ID 0006810101   2000
                  Magenta       = Obs ID 0670130501   2011

Group 2 Med-Flux  Yellow        = Obs ID 0670130601   2011
                  Grey / Black  = Obs ID 0670130801   2011
                  Blue          = Obs ID 0670130301   2011
                  Cyan          = Obs ID 0670130401   2011
                  Red           = Obs ID 0206400101   2005

Group 3 Lo-flux   Orange        = Obs ID 0670130701   2011
#+END_EXAMPLE

*Lag-frequency overview*

 *Combined*

Core lag file =/homeb/steff075/phd_ecm/Ark564/lag-results.ods=

Plot =/homeb/steff075/phd_ecm/Ark564/lag-results-comb.vsz=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/Ark564_lagfreq_comb.PNG

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 8.727273e-05 | 2.727273e-05 |  2.535772e+02 | 1.098668e+02 |
+--------------+--------------+---------------+--------------+
| 1.666116e-04 | 5.206612e-05 |  2.981095e+02 | 5.045028e+01 |
+--------------+--------------+---------------+--------------+
| 3.180766e-04 | 9.939895e-05 | -2.336237e+01 | 2.900298e+01 |
+--------------+--------------+---------------+--------------+
| 6.072372e-04 | 1.897616e-04 | -3.619105e+01 | 1.054087e+01 |
+--------------+--------------+---------------+--------------+
| 1.159271e-03 | 3.622722e-04 | -2.237140e+01 | 4.197320e+00 |
+--------------+--------------+---------------+--------------+
| 2.213154e-03 | 6.916106e-04 | -1.548147e+01 | 2.047687e+00 |
+--------------+--------------+---------------+--------------+
| 4.225112e-03 | 1.320347e-03 | -3.335300e+00 | 1.167927e+00 |
+--------------+--------------+---------------+--------------+

** Low - Med - High Flux state results

Lets just have a look at the low and high flux state lag-frequencies:

use =lagfreq_hi_flux.sl=

*Low flux*

"0670130701"


Plot =/homeb/steff075/phd_ecm/Ark564/veusz lag-results-lo-flux.vsz=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Ark564_lagfreq_lo_flux.PNG

Lags found in =/homeb/steff075/phd_ecm/Ark564/lagvalues-lo-flux2.csv=

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 8.727273e-05 | 2.727273e-05 |  2.240101e+02 | 9.782360e+01 |
+--------------+--------------+---------------+--------------+
| 1.666116e-04 | 5.206612e-05 |  5.433726e+02 | 1.113884e+02 |
+--------------+--------------+---------------+--------------+
| 3.180766e-04 | 9.939895e-05 |  1.131796e+01 | 5.142669e+01 |
+--------------+--------------+---------------+--------------+
| 6.072372e-04 | 1.897616e-04 |  1.231545e+01 | 2.600476e+01 |
+--------------+--------------+---------------+--------------+
| 1.159271e-03 | 3.622722e-04 |  5.371205e+00 | 1.311252e+01 |
+--------------+--------------+---------------+--------------+
| 2.213154e-03 | 6.916106e-04 | -1.564861e+01 | 5.632060e+00 |
+--------------+--------------+---------------+--------------+
| 4.225112e-03 | 1.320347e-03 | -1.437807e+01 | 4.204352e+00 |
+--------------+--------------+---------------+--------------+

*Medium flux*

%variable obs_id = ["0206400101","0670130301","0670130401","0670130601","0670130801"]; %Group 2 Medium Flux

Plot =/homeb/steff075/phd_ecm/Ark564/veusz lag-results-lo-flux.vsz=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Ark564_lagfreq_medium_flux.PNG

Lags found in =/homeb/steff075/phd_ecm/Ark564/lagvalues-lo-flux2.csv=

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 8.727273e-05 | 2.727273e-05 |  3.998296e+02 | 1.194632e+02 |
+--------------+--------------+---------------+--------------+
| 1.666116e-04 | 5.206612e-05 |  3.062985e+02 | 5.777874e+01 |
+--------------+--------------+---------------+--------------+
| 3.180766e-04 | 9.939895e-05 | -4.973664e+01 | 3.360999e+01 |
+--------------+--------------+---------------+--------------+
| 6.072372e-04 | 1.897616e-04 | -1.736459e+01 | 1.259739e+01 |
+--------------+--------------+---------------+--------------+
| 1.159271e-03 | 3.622722e-04 | -2.009671e+01 | 5.465954e+00 |
+--------------+--------------+---------------+--------------+
| 2.213154e-03 | 6.916106e-04 | -1.337332e+01 | 2.645391e+00 |
+--------------+--------------+---------------+--------------+
| 4.225112e-03 | 1.320347e-03 | -3.083198e+00 | 1.544439e+00 |
+--------------+--------------+---------------+--------------+

*High flux*

"0006810101","0206400101","0670130201","0670130301","0670130401","0670130501","0670130601","0670130801","0670130901"

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Ark564_lagfreq_hi_flux.PNG

Lags found:
file =/homeb/steff075/phd_ecm/Ark564/lagvalues-hi-flux2.csv=

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 8.727273e-05 | 2.727273e-05 | -2.821563e+02 | 2.276621e+02 |
+--------------+--------------+---------------+--------------+
| 1.666116e-04 | 5.206612e-05 |  2.796230e+02 | 9.442446e+01 |
+--------------+--------------+---------------+--------------+
| 3.180766e-04 | 9.939895e-05 |  2.081948e+00 | 5.662770e+01 |
+--------------+--------------+---------------+--------------+
| 6.072372e-04 | 1.897616e-04 | -6.108527e+01 | 1.933393e+01 |
+--------------+--------------+---------------+--------------+
| 1.159271e-03 | 3.622722e-04 | -2.710234e+01 | 7.131486e+00 |
+--------------+--------------+---------------+--------------+
| 2.213154e-03 | 6.916106e-04 | -1.788616e+01 | 3.544459e+00 |
+--------------+--------------+---------------+--------------+
| 4.225112e-03 | 1.320347e-03 | -2.646812e+00 | 1.951410e+00 |
+--------------+--------------+---------------+--------------+

Lets combine these results in Veusz

Use =homeb/steff075/phd_ecm/Ark564/lag-results.ods= to obtain
the csv

Plot =homeb/steff075/phd_ecm/Ark564/Ark564-lag-results-lo-hi.vsz=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/Ark564-lag-results-lo-hi-flux.png

pdf at:

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/Ark564-lag-results-lo-hi-flux.pdf

*Genegenerate fits and response*

Lo-flux

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28
accordingly. Run fits files to check:

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("Ark564-time-lags-lo-flux.fits");
r=load_rmf("Ark564-time-lags-lo-flux.rsp");
d=load_data("Ark564-time-lags-hi-flux.fits");
r=load_rmf("Ark564-time-lags-hi-flux.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

Now copy these the BC4 for fitting to ECM model, e.g:

#+BEGIN_EXAMPLE
scp Ark564-time-lags-lo-flux.fits so14935@bc4login.acrc.bris.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/Ark564-time-lag-fits
#+END_EXAMPLE

** OBS 0006810101 (2000)

Only 35 ks !!!!

Use script =/homeb/steff075/phd_ecm/Ark564/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.309091e-04,-3.014965e+02,1.651639e-05
2.499174e-04,3.523705e+02,4.218935e+01
4.771150e-04,5.080216e+01,5.809485e+01
9.108558e-04,-4.538168e+01,1.881040e+01
1.738907e-03,-1.935815e+01,1.450508e+01
3.319731e-03,-3.705824e+00,1.345982e+01
6.337668e-03,4.193459e+01,1.715725e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Ark564_0006810101_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("Ark564_0006810101_time_lags.fits");
r=load_rmf("Ark564_0006810101_time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0206400101 (2005)

Use script =/homeb/steff075/phd_ecm/Ark564/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,1.610623e+02,2.543392e+02
1.388430e-04,4.003926e+02,9.455021e+01
2.650639e-04,1.291933e+02,7.629467e+01
5.060310e-04,-2.021144e+01,3.277072e+01
9.660592e-04,-1.987771e+01,1.330020e+01
1.844295e-03,-1.349937e+01,5.939443e+00
3.520927e-03,-1.444247e+01,8.253316e+00
#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Ark564_0206400101_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("Ark564_0206400101_time_lags.fits");
r=load_rmf("Ark564_0206400101_time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

** OBS 0670130201 (2007)

Use script =/homeb/steff075/phd_ecm/Ark564/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,1.641093e+02,4.143253e+02
1.388430e-04,2.723129e+02,8.392337e+01
2.650639e-04,2.578192e+02,6.625959e+01
5.060310e-04,-1.389636e+02,6.060581e+01
9.660592e-04,-3.466121e+01,1.385290e+01
1.844295e-03,-1.084758e+01,7.768566e+00
3.520927e-03,-1.057580e+01,8.102496e+00
#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Ark564_0670130201_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("Ark564_0670130201_time_lags.fits");
r=load_rmf("Ark564_0670130201_time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

** OBS 0670130301 (2011)

Use script =/homeb/steff075/phd_ecm/Ark564/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,5.536062e+02,2.438346e+02
1.388430e-04,1.430112e+01,1.099752e+02
2.650639e-04,-9.554454e+01,1.031879e+02
5.060310e-04,-9.170823e+01,3.390049e+01
9.660592e-04,-3.036817e+01,1.463112e+01
1.844295e-03,-1.933387e+01,8.655033e+00
3.520927e-03,-3.465951e+01,2.264493e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Ark564_0670130301_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("Ark564_0670130301_time_lags.fits");
r=load_rmf("Ark564_0670130301_time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

** OBS 0670130401 (2011)

Use script =/homeb/steff075/phd_ecm/Ark564/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,5.827261e+02,2.077455e+02
1.388430e-04,5.368575e+02,1.989954e+02
2.650639e-04,-9.450286e+01,7.747374e+01
5.060310e-04,-3.596069e+01,4.315928e+01
9.660592e-04,-6.041917e+00,2.102360e+01
1.844295e-03,-1.370921e+01,7.137979e+00
3.520927e-03,-1.370175e+01,8.578973e+00

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Ark564_0670130401_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("Ark564_0670130401_time_lags.fits");
r=load_rmf("Ark564_0670130401_time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

** OBS 0670130501 (2011)

Use script =/homeb/steff075/phd_ecm/Ark564/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,1.474826e+03,5.923314e+02
1.388430e-04,1.337811e+01,6.853290e+02
2.650639e-04,5.253377e+00,1.625460e+02
5.060310e-04,-7.197458e+01,3.330831e+01
9.660592e-04,-3.824452e+01,1.587624e+01
1.844295e-03,-1.775517e+01,6.679567e+00
3.520927e-03,-3.644550e+00,1.459248e+01


#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Ark564_0670130501_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("Ark564_0670130501_time_lags.fits");
r=load_rmf("Ark564_0670130501_time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

** OBS 0670130601 (2011)

Use script =/homeb/steff075/phd_ecm/Ark564/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,8.080343e+02,1.640087e+02
1.388430e-04,6.099746e+02,1.421714e+02
2.650639e-04,-1.894694e+02,1.372987e+02
5.060310e-04,5.052512e+01,4.963097e+01
9.660592e-04,-1.235478e+01,1.197164e+01
1.844295e-03,-1.143502e+01,6.832125e+00
3.520927e-03,-1.319794e+01,7.151681e+00

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Ark564_0670130601_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("Ark564_0670130601_time_lags.fits");
r=load_rmf("Ark564_0670130601_time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

** OBS 0670130701 (2011)

Use script =/homeb/steff075/phd_ecm/Ark564/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,2.491497e+02,0.000000e+00
1.388430e-04,6.812239e+02,1.247728e+02
2.650639e-04,9.850287e+00,7.261060e+01
5.060310e-04,2.496231e+01,3.195833e+01
9.660592e-04,1.757485e+01,1.613379e+01
1.844295e-03,-1.942065e+01,7.952515e+00
3.520927e-03,-4.583153e+01,1.842246e+01


#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Ark564_0670130701_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("Ark564_0670130701_time_lags.fits");
r=load_rmf("Ark564_0670130701_time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

** OBS 0670130801 (2011)

Use script =/homeb/steff075/phd_ecm/Ark564/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,4.112589e+02,5.251967e+02
1.388430e-04,5.442573e+01,1.984077e+02
2.650639e-04,1.618795e+02,6.995122e+01
5.060310e-04,-7.277671e+01,5.308854e+01
9.660592e-04,-3.651168e+01,1.796757e+01
1.844295e-03,-1.655058e+01,1.231589e+01
3.520927e-03,-3.177274e+01,1.366845e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Ark564_0670130801_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("Ark564_0670130801_time_lags.fits");
r=load_rmf("Ark564_0670130801_time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

** OBS 0670130901 (2011)

Use script =/homeb/steff075/phd_ecm/Ark564/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,-2.678576e+02,1.403277e+02
1.388430e-04,-4.801689e+02,6.176472e+02
2.650639e-04,2.168883e+02,1.537545e+02
5.060310e-04,-1.200853e+02,4.359283e+01
9.660592e-04,-4.515198e+01,1.501048e+01
1.844295e-03,-4.205977e+01,9.757886e+00
3.520927e-03,-1.273672e+01,8.560919e+00

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Ark564_0670130901_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("Ark564_0670130901_time_lags.fits");
r=load_rmf("Ark564_0670130901_time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

** Combined Observations

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0006810101, 0206400101, 0670130201, 0670130301, 0670130401
0670130501, 0670130601, 0670130701, 0670130801, 0670130901

Total time 549.2 ks

script = =lagfreq_comb_script.sl=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Ark564_lagfreq_comb.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,2.833991e+02,1.358025e+02
1.388430e-04,2.019589e+02,7.524572e+01
2.650639e-04,1.241811e+02,3.531470e+01
5.060310e-04,-6.193249e+01,1.670238e+01
9.660592e-04,-2.781872e+01,5.371850e+00
1.844295e-03,-1.712748e+01,2.695126e+00
3.520927e-03,-1.438070e+01,3.276771e+00
#+END_EXAMPLE

and with the freq errors >8e-5 Hz:


+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 1.163636e-04 | 3.636364e-05 |  2.886785e+02 | 8.752252e+01 |
+--------------+--------------+---------------+--------------+
| 2.221488e-04 | 6.942149e-05 |  1.585438e+02 | 4.331558e+01 |
+--------------+--------------+---------------+--------------+
| 4.241022e-04 | 1.325319e-04 | -4.875704e+01 | 2.109240e+01 |
+--------------+--------------+---------------+--------------+
| 8.096496e-04 | 2.530155e-04 | -3.133195e+01 | 7.249408e+00 |
+--------------+--------------+---------------+--------------+
| 1.545695e-03 | 4.830296e-04 | -2.154712e+01 | 3.151027e+00 |
+--------------+--------------+---------------+--------------+
| 2.950872e-03 | 9.221474e-04 | -1.141599e+01 | 2.730858e+00 |
+--------------+--------------+---------------+--------------+
| 5.633482e-03 | 1.760463e-03 | -6.815778e+00 | 5.209484e+00 |
+--------------+--------------+---------------+--------------+


*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:

** 2000 Observations

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0006810101 Total time 10.2 ks

script = =lagfreq_comb2000_script.sl=

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Ark564_lagfreq_2000.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-04,-3.416780e+01,2.958982e+01
1.388430e-03,-4.437447e+01,1.288859e+01
2.650639e-03,-1.524845e+01,1.109441e+01
5.060310e-03,9.152889e+00,3.098471e+01
9.660592e-03,-3.814805e+01,3.414757e+01
1.844295e-02,-9.652165e+00,1.290670e+01
3.520927e-02,-1.122494e+01,3.167831e+00

#+END_EXAMPLE

and above 2.5e-4 Hz:

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Ark564_lagfreq_2000_loFreq.png

#+ATTR_HTML: :border 2 :rules all :frame border
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 3.636364e-04 | 1.136364e-04 |  1.961401e+02 | 1.708863e+02 |
+--------------+--------------+---------------+--------------+
| 6.942149e-04 | 2.169421e-04 | -4.448585e+01 | 2.863439e+01 |
+--------------+--------------+---------------+--------------+
| 1.325319e-03 | 4.141623e-04 | -5.776056e+01 | 9.981378e+00 |
+--------------+--------------+---------------+--------------+
| 2.530155e-03 | 7.906735e-04 | -6.162535e+00 | 1.110520e+01 |
+--------------+--------------+---------------+--------------+
| 4.830296e-03 | 1.509467e-03 | -3.594851e+00 | 3.276018e+01 |
+--------------+--------------+---------------+--------------+
| 9.221474e-03 | 2.881711e-03 |  4.981676e+01 | 6.403935e+01 |
+--------------+--------------+---------------+--------------+
| 1.760463e-02 | 5.501448e-03 | -1.243663e+01 | 1.212791e+01 |
+--------------+--------------+---------------+--------------+


*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:

** 2005 Observation

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0206400101 Total time  96 ks

script = =lagfreq_comb_script.sl=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Ark564_lagfreq_2005.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-04,-9.193718e+00,1.676176e+01
1.388430e-03,-1.787273e+01,7.897351e+00
2.650639e-03,-1.255803e+01,6.940855e+00
5.060310e-03,-8.592015e+00,8.970843e+00
9.660592e-03,5.385490e+00,1.853447e+01
1.844295e-02,-2.707246e+01,4.288549e+00
3.520927e-02,9.853724e-01,3.350204e+00
#+END_EXAMPLE

And >8e-5 Hz:

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Ark564_lagfreq_2005_loFreq.png

+--------------+--------------+---------------+--------------+
|              |         Freq |            +- |          Lag |
+--------------+--------------+---------------+--------------+
| 1.163636e-04 | 3.636364e-05 |  5.584275e+02 | 1.579110e+02 |
+--------------+--------------+---------------+--------------+
| 2.221488e-04 | 6.942149e-05 |  2.353735e+02 | 8.448385e+01 |
+--------------+--------------+---------------+--------------+
| 4.241022e-04 | 1.325319e-04 | -6.734432e+01 | 4.319832e+01 |
+--------------+--------------+---------------+--------------+
| 8.096496e-04 | 2.530155e-04 | -1.981567e+01 | 1.397557e+01 |
+--------------+--------------+---------------+--------------+
| 1.545695e-03 | 4.830296e-04 | -1.240548e+01 | 6.865001e+00 |
+--------------+--------------+---------------+--------------+
| 2.950872e-03 | 9.221474e-04 | -1.086665e+01 | 6.553909e+00 |
+--------------+--------------+---------------+--------------+
| 5.633482e-03 | 1.760463e-03 | -7.684510e+00 | 1.815619e+01 |
+--------------+--------------+---------------+--------------+


*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:

** 2011 Observation

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):


0670130201,0670130301,0670130401,0670130501,0670130601,0670130701,0670130801,0670130901

Total time  443 ks

script = =lagfreq_comb_script.sl=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Ark564_lagfreq_2011.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-04,-4.097813e+01,9.934828e+00
1.388430e-03,-2.207026e+01,3.981505e+00
2.650639e-03,-1.527078e+01,2.938451e+00
5.060310e-03,-5.190987e+00,5.530576e+00
9.660592e-03,4.083490e+00,9.341945e+00
1.844295e-02,-2.715119e+01,4.865573e+00
3.520927e-02,1.315343e+01,2.643698e+00
#+END_EXAMPLE


And above 8e-5

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Ark564_lagfreq_2011_loFreq.png

+--------------+--------------+---------------+--------------+
|              |         Freq |            +- |          Lag |
+--------------+--------------+---------------+--------------+
| 1.163636e-04 | 3.636364e-05 |  3.001232e+02 | 9.842725e+01 |
+--------------+--------------+---------------+--------------+
| 2.221488e-04 | 6.942149e-05 |  1.210562e+02 | 5.084044e+01 |
+--------------+--------------+---------------+--------------+
| 4.241022e-04 | 1.325319e-04 | -5.585173e+01 | 2.378276e+01 |
+--------------+--------------+---------------+--------------+
| 8.096496e-04 | 2.530155e-04 | -3.310914e+01 | 8.321444e+00 |
+--------------+--------------+---------------+--------------+
| 1.545695e-03 | 4.830296e-04 | -2.289721e+01 | 3.576806e+00 |
+--------------+--------------+---------------+--------------+
| 2.950872e-03 | 9.221474e-04 | -1.168190e+01 | 3.105595e+00 |
+--------------+--------------+---------------+--------------+
| 5.633482e-03 | 1.760463e-03 | -7.306396e+00 | 5.309617e+00 |
+--------------+--------------+---------------+--------------+

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:

** Group 1 spectra

*Lag-frequency*

Observations "0006810101","0670130201","0670130501","0670130901"

Lets have a look at the lag frequency for this single observation:

Use script =combine_spectra2000.sl=

Lag values:
#+BEGIN_EXAMPLE
7.272727e-04,-5.334082e+01,1.522078e+01
1.388430e-03,-2.631358e+01,5.898208e+00
2.650639e-03,-1.460392e+01,4.404211e+00
5.060310e-03,2.370197e+00,8.201039e+00
9.660592e-03,-1.026549e-01,1.057216e+01
1.844295e-02,2.468763e+01,8.161795e+00
3.520927e-02,1.192371e+01,1.860204e+00
#+END_EXAMPLE
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Ark564_lagfreq_grp1.gif

And above 8e-4 Hz:

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Ark564_lagfreq_Grp1_loFreq.png

+--------------+--------------+---------------+--------------+
|         Freq |          +-  |            Lag|         +-   |
+--------------+--------------+---------------+--------------+
| 1.163636e-04 | 3.636364e-05 |  1.287044e+02 | 1.631649e+02 |
+--------------+--------------+---------------+--------------+
| 2.221488e-04 | 6.942149e-05 |  1.966544e+02 | 8.266475e+01 |
+--------------+--------------+---------------+--------------+
| 4.241022e-04 | 1.325319e-04 | -6.975574e+01 | 4.297317e+01 |
+--------------+--------------+---------------+--------------+
| 8.096496e-04 | 2.530155e-04 | -3.913776e+01 | 1.254292e+01 |
+--------------+--------------+---------------+--------------+
| 1.545695e-03 | 4.830296e-04 | -2.980597e+01 | 5.368388e+00 |
+--------------+--------------+---------------+--------------+
| 2.950872e-03 | 9.221474e-04 | -8.878055e+00 | 4.415243e+00 |
+--------------+--------------+---------------+--------------+
| 5.633482e-03 | 1.760463e-03 | -3.616666e+00 | 8.886731e+00 |
+--------------+--------------+---------------+--------------+


** Group 2 spectra

*Lag-frequency*

Lets have a look at the lag frequency for this single observation:

Use script =combine_spectra2000.sl=

Lag values:
#+BEGIN_EXAMPLE
7.272727e-04,-2.209062e+01,1.094756e+01
1.388430e-03,-1.827956e+01,4.616412e+00
2.650639e-03,-1.464030e+01,3.539773e+00
5.060310e-03,-7.602428e+00,5.748840e+00
9.660592e-03,6.230413e+00,1.507110e+01
1.844295e-02,-2.374563e+01,3.939950e+00
3.520927e-02,-3.034913e+00,6.371840e+00


#+END_EXAMPLE
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Ark564_lagfreq_grp2.gif

And above 8e-5 Hz:

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Ark564_lagfreq_Grp2_loFreq.png

+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 1.163636e-04 | 3.636364e-05 |  3.773032e+02 | 1.004905e+02 |
+--------------+--------------+---------------+--------------+
| 2.221488e-04 | 6.942149e-05 |  1.345987e+02 | 5.054821e+01 |
+--------------+--------------+---------------+--------------+
| 4.241022e-04 | 1.325319e-04 | -4.042874e+01 | 2.298226e+01 |
+--------------+--------------+---------------+--------------+
| 8.096496e-04 | 2.530155e-04 | -2.662376e+01 | 9.355832e+00 |
+--------------+--------------+---------------+--------------+
| 1.545695e-03 | 4.830296e-04 | -1.488831e+01 | 4.091797e+00 |
+--------------+--------------+---------------+--------------+
| 2.950872e-03 | 9.221474e-04 | -1.346932e+01 | 3.671430e+00 |
+--------------+--------------+---------------+--------------+
| 5.633482e-03 | 1.760463e-03 | -4.361441e+00 | 6.720659e+00 |
+--------------+--------------+---------------+--------------+



** Group 3 spectra

*Lag-frequency*

Lets have a look at the lag frequency for this single observation:

variable obs_id = ["0670130701"];

Use script =combine_spectra2000.sl=

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Ark564_lagfreq_grp3.gif

Lag values:
#+BEGIN_EXAMPLE
7.272727e-05,2.491497e+02,0.000000e+00
1.388430e-04,6.812239e+02,1.247728e+02
2.650639e-04,9.850287e+00,7.261060e+01
5.060310e-04,2.496231e+01,3.195833e+01
9.660592e-04,1.757485e+01,1.613379e+01
1.844295e-03,-1.942065e+01,7.952515e+00
3.520927e-03,-4.583153e+01,1.842246e+01

#+END_EXAMPLE
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Ark564_lagfreq_Grp3_loFreq.png

+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 2.909091e-04 | 9.090909e-05 |  1.279368e+01 | 6.306766e+01 |
+--------------+--------------+---------------+--------------+
| 5.553719e-04 | 1.735537e-04 |  7.867982e+00 | 2.928459e+01 |
+--------------+--------------+---------------+--------------+
| 1.060255e-03 | 3.313298e-04 |  1.362448e+01 | 1.460715e+01 |
+--------------+--------------+---------------+--------------+
| 2.024124e-03 | 6.325388e-04 | -1.921593e+01 | 7.633344e+00 |
+--------------+--------------+---------------+--------------+
| 3.864237e-03 | 1.207574e-03 | -5.217555e+01 | 1.377373e+01 |
+--------------+--------------+---------------+--------------+
| 7.377179e-03 | 2.305369e-03 | -2.534073e+01 | 3.262071e+01 |
+--------------+--------------+---------------+--------------+
| 1.408371e-02 | 4.401158e-03 |  2.666966e+01 | 1.260053e+01 |
+--------------+--------------+---------------+--------------+

* *IRAS13224-3809*
** Old Spectra and flux

Lets have a look at the flux states for each data set by examinining
the spectra

USE
=/home/steff075/phd_ecm/IRAS13224-3809/multi_spectra_unfold_Grp1.sl=

PATH to data = =/homeb/steff075/phd_ecm/IRAS13224-3809=
Data used 0110890101, 0673580101, 0673580201, 0673580301 and
0673580401 Total duration 404 ks.

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_Spectra_all_unfolded.gif

+------+-------------+------+---------+--------------------------+------------------------+------------------------+-----------------------+-------------+
| Data | Observation | Year | Colour  | 0.3-10keV Flux / cm-2s-1 |                     +- | energy-flux(0.3-10keV) |                    +- | Exp (k/sec) |
+------+-------------+------+---------+--------------------------+------------------------+------------------------+-----------------------+-------------+
|    1 |  0110890101 | 2002 | black   |   3.2942760083037245e-14 | 3.3172412660432237e-12 |  9.880943678779296e-05 |   0.00317075151039813 |        61.0 |
+------+-------------+------+---------+--------------------------+------------------------+------------------------+-----------------------+-------------+
|    2 |  0673580101 | 2011 | red     |    2.890604016875766e-14 |  4.338027415952786e-12 |  5.694632211990189e-05 |  0.003952247079761683 |        49.0 |
+------+-------------+------+---------+--------------------------+------------------------+------------------------+-----------------------+-------------+
|    3 |  0673580201 | 2011 | magenta |    2.493751411452918e-14 |  3.221033692907476e-12 |  3.448174506615052e-05 |  0.002971926842297343 |        99.0 |
+------+-------------+------+---------+--------------------------+------------------------+------------------------+-----------------------+-------------+
|    4 |  0673580301 | 2011 | blue    |   2.0718020164586616e-14 | 1.9434913636054924e-12 | 3.2592871109056954e-05 | 0.0019027277153493307 |        82.0 |
+------+-------------+------+---------+--------------------------+------------------------+------------------------+-----------------------+-------------+
|    5 |  0673580401 | 2011 | cyan    |   1.7185331928512603e-14 | 3.5318228826049235e-12 | 3.5083754160885735e-05 | 0.0032945523486960187 |       113.0 |
+------+-------------+------+---------+--------------------------+------------------------+------------------------+-----------------------+-------------+



** New Spectra (July 2020)

Include all 12 x 2016 observations

PATH =/home/steff075/phd_ecm/IRAS13224-3809/multi_spectra_unfold.sl=

#+BEGIN_EXAMPLE
% Load the required spectra
variable path_to_data = "/data/scratch3/steff/IRAS13224-3809";

variable obsid = ["0110890101","0673580101","0673580201","0673580301","0673580401","0780560101","0780561301","0780561401","0780561501","0780561601","0780561701","0792180101","0792180201","0792180301","0792180401","0792180501 ","0792180601"];
variable i;

% Read in all data sets
for (i=0; i<length(obsid); i++) {
  () = chdir(path_to_data + "/" + obsid[i] + "/PROC");
  () = load_data("PN_time_0.3-10_pi_grp.fits");
}

%set required energy ranges
xnotice_en(all_data(),0.35, 10.0);
ignore_en(all_data(),0,0.35);
ignore_en(all_data(),10,20);

variable min_cts = 100;
variable i;
for (i=1; i<=17; i++) {
    rebin_data(i, min_cts);
}

chdir("/homeb/steff075/phd_ecm/IRAS13224-3809");
popt.xrange = [0.35, 10.0];
popt.yrange = [1.0e-5, 8, -10.0, 10.0];
xlog;
ylog;
%group(2; min_sn=2.0);
% Plot all Unfolded spectra
%open_plot("IRAS13224-3809_all_spectra.gif/gif");
%title ("IRAS13224-3809 Unfolded Spectra (2002-2016)");
%plot_unfold({1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17};power=3,  dsym=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1], dcol=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,1,2,4], yrange = [2.0e-5, 4e-03]);
%close_plot;

% Create ps image of plot
%variable pid = open_plot("IRAS13224-3809_spec_2002-2016.ps/cps");
%charsize(1.3); %good font size
%nice_width; %good line ratios
%_pgscf(2); %make font roman
%plot_unfold({1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17};power=3, dsym=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],dcol=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,1,2,4],yrange = [2.0e-5, 4e-03]);
%close_plot(pid);
#+END_EXAMPLE

#+ATTR_HTML: :width 900
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_spec_2002-2016-1.png

*Sorting spectra*

There are 3 distinct groups of high, medium and low flux emerging in the
above plot. Lets isolate these spectra into lo - med - hi resplectively:

#+BEGIN_EXAMPLE
%All Spectra for Combined
%plot_unfold({1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17};power=3,  dsym=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1], dcol=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,1,2,4], yrange = [2.0e-5, 4e-03]);

% High Flux Spectra
% OBS "0792180401 ","0792180601"
plot_unfold({15,17};power=3,  dsym=[1,1], dcol=[2,4], yrange = [2.0e-5, 4e-03]);

% Medium Flux Spectra
% OBS "0110890101","0673580101","0673580201","0673580401","0780560101","0780561301","0780561401","0780561501","0780561601","0780561701","0792180101","0792180201","0792180501"
plot_unfold({1,2,3,5,6,7,8,9,10,11,12,13,16};power=3,  dsym=[1,1,1,1,1,1,1,1,1,1,1,1,1], dcol=[1,2,3,5,6,7,8,9,10,11,12,13,1], yrange = [2.0e-5, 4e-03]);

% Low Flux Spectra
% OBS "0673580301","0792180301"
plot_unfold({4,14};power=3,  dsym=[1,1], dcol=[4,14], yrange = [2.0e-5, 4e-03]);


Therefore:

Hi  Flux   = "0792180401","0792180601"

Med Flux   = "0110890101","0673580101","0673580201","0673580401","0780560101","0780561301","0780561401","0780561501","0780561601","0780561701","0792180101","0792180201","0792180501"

Lo Flux    = "0673580301","0792180301"

#+END_EXAMPLE

This is the spectra selection colour-coded for clarity

#+ATTR_HTML: :width 900
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_lo_med_hi-1.png

** Flux, Counts and exposure information

*Spectral Flux, counts and exposure times*

PATH =/home/steff075/phd_ecm/results-for-all/IRAS13224_flux_counts.ods=

+-----------+----------------------+----------+----------+
|       obs | Data_Flux(0.5-10keV) |   counts |      Exp |
+-----------+----------------------+----------+----------+
| 110890101 |             3.21E-14 | 1.01E+05 | 6.10E+01 |
+-----------+----------------------+----------+----------+
| 673580101 |             2.96E-14 | 1.09E+05 | 4.90E+01 |
+-----------+----------------------+----------+----------+
| 673580201 |             2.24E-14 | 1.74E+05 | 9.90E+01 |
+-----------+----------------------+----------+----------+
| 673580301 |             1.91E-14 | 8.89E+04 | 8.20E+01 |
+-----------+----------------------+----------+----------+
| 673580401 |             1.64E-14 | 2.17E+05 | 1.13E+02 |
+-----------+----------------------+----------+----------+
| 780560101 |             4.23E-14 | 6.83E+04 | 1.41E+02 |
+-----------+----------------------+----------+----------+
| 780561301 |             1.51E-14 | 2.81E+05 | 1.41E+02 |
+-----------+----------------------+----------+----------+
| 780561401 |             2.09E-14 | 2.11E+05 | 1.38E+02 |
+-----------+----------------------+----------+----------+
| 780561501 |             1.34E-14 | 1.76E+05 | 1.41E+02 |
+-----------+----------------------+----------+----------+
| 780561601 |             1.80E-14 | 4.08E+05 | 1.41E+02 |
+-----------+----------------------+----------+----------+
| 780561701 |             1.49E-14 | 2.23E+05 | 1.41E+02 |
+-----------+----------------------+----------+----------+
| 792180101 |             1.34E-14 | 1.83E+05 | 1.40E+02 |
+-----------+----------------------+----------+----------+
| 792180201 |             1.46E-14 | 2.51E+05 | 1.41E+02 |
+-----------+----------------------+----------+----------+
| 792180301 |             1.32E-14 | 1.08E+05 | 1.41E+02 |
+-----------+----------------------+----------+----------+
| 792180401 |             2.17E-14 | 5.22E+05 | 1.41E+02 |
+-----------+----------------------+----------+----------+
| 792180501 |             1.49E-14 | 2.19E+05 | 1.38E+02 |
+-----------+----------------------+----------+----------+
| 792180601 |             2.02E-14 | 5.38E+05 | 1.36E+02 |
+-----------+----------------------+----------+----------+
|  Combined |             2.01E-14 | 2.28E+05 | 2.08E+03 |
+-----------+----------------------+----------+----------+
|   Hi-flux |             2.09E-14 | 5.30E+05 | 2.77E+02 |
+-----------+----------------------+----------+----------+
|  Med-flux |             2.06E-14 | 2.00E+05 | 1.44E+03 |
+-----------+----------------------+----------+----------+
|   Lo-flux |             1.61E-14 | 9.83E+04 | 2.23E+02 |
+-----------+----------------------+----------+----------+

*Note*: The data flux was obtained in the original spectral plotting
regime. The Combined, Hi-flux, Med-flux, Lo-flux and counts are all shown
as a mean value of the data sets they contain as outlined above. The Exposure time is
the sum of the Exp data for those groups. (i.e, Mean flux, mean counts
and total exposure time)


*Flux and data counts checking method*

PATH =/home/steff075/phd_ecm/results-for-all/IRAS13224_flux_counts_check_method.ods=

#+BEGIN_EXAMPLE
isis
d=load_data("/data/scratch3/steff/IRAS13224-3809/0110890101/PROC/PN_time_0.3-10_pi_grp.fits");
data_flux(1,0.3,10);
list_data;

 data_flux(1,0.3,10);
2.6649544156139913e-07
3.410803462859954e-12
20.315981129472235
0.003245867097493135
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0    4096/ 4096   1   1  1.0113e+05    54.760

..................................................................................

isis
d=load_data("/data/scratch3/steff/IRAS13224-3809/0673580101/PROC/PN_time_0.3-10_pi_grp.fits");
data_flux(1,0.3,10);
list_data;

 data_flux(1,0.3,10);
2.6262711165682775e-07
4.452671348821773e-12
20.018468704002323
0.004029593292705895
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0    4096/ 4096   1   1  1.0897e+05    42.958

..................................................................................

isis
d=load_data("/data/scratch3/steff/IRAS13224-3809/0673580201/PROC/PN_time_0.3-10_pi_grp.fits");
data_flux(1,0.3,10);
list_data;

 data_flux(1,0.3,10);
9.623227792227648e-08
3.379124923566982e-12
7.192988895654694
0.0030376479521703223
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0    4096/ 4096   1   1  1.7448e+05    91.945

..................................................................................

isis
d=load_data("/data/scratch3/steff/IRAS13224-3809/0673580301/PROC/PN_time_0.3-10_pi_grp.fits");
data_flux(1,0.3,10);
list_data;

 data_flux(1,0.3,10);
1.9347085739287395e-07
2.0712904911529952e-12
15.222978987471462
0.001952820040642655
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0    4096/ 4096   1   1  8.8891e+04    76.187
file:  /data/scratch3/steff/IRAS13224-3809/0673580301/PROC/PN_time_0.3-10_pi_grp.fits
back:  /data/scratch3/steff/IRAS13224-3809/0673580301/PROC/PN_time_0.3-10_bkg_pi.fits


..................................................................................

isis
d=load_data("/data/scratch3/steff/IRAS13224-3809/0673580401/PROC/PN_time_0.3-10_pi_grp.fits");
data_flux(1,0.3,10);
list_data;

data_flux(1,0.3,10);
2.0011207869254478e-07
3.6165825617682745e-12
14.585578125429505
0.003365114738988356
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0    4096/ 4096   1   1  2.1708e+05   104.938
file:  /data/scratch3/steff/IRAS13224-3809/0673580401/PROC/PN_time_0.3-10_pi_grp.fits
back:  /data/scratch3/steff/IRAS13224-3809/0673580401/PROC/PN_time_0.3-10_bkg_pi.fits

..................................................................................

isis
d=load_data("/data/scratch3/steff/IRAS13224-3809/0780560101/PROC/PN_time_0.3-10_pi_grp.fits");
data_flux(1,0.3,10);
list_data;

data_flux(1,0.3,10);
2.0291476115543118e-07
3.810404039593708e-12
15.866287822082917
0.003598176442213975
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0    4096/ 4096   1   1  6.8267e+04    31.859
file:  /data/scratch3/steff/IRAS13224-3809/0780560101/PROC/PN_time_0.3-10_pi_grp.fits
back:  /data/scratch3/steff/IRAS13224-3809/0780560101/PROC/PN_time_0.3-10_bkg_pi.fits


..................................................................................

isis
d=load_data("/data/scratch3/steff/IRAS13224-3809/0780561301/PROC/PN_time_0.3-10_pi_grp.fits");
data_flux(1,0.3,10);
list_data;

 data_flux(1,0.3,10);
2.0523340260206353e-07
4.090265649845174e-12
14.619818372777761
0.003908091310223939
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0    4096/ 4096   1   1  2.8064e+05   117.957
file:  /data/scratch3/steff/IRAS13224-3809/0780561301/PROC/PN_time_0.3-10_pi_grp.fits
back:  /data/scratch3/steff/IRAS13224-3809/0780561301/PROC/PN_time_0.3-10_bkg_pi.fits


..................................................................................

isis
d=load_data("/data/scratch3/steff/IRAS13224-3809/0780561401/PROC/PN_time_0.3-10_pi_grp.fits");
data_flux(1,0.3,10);
list_data;

 data_flux(1,0.3,10);
2.255278546905776e-07
4.777913534071138e-12
16.33214894779806
0.004572475695910355
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0    4096/ 4096   1   1  2.1072e+05    76.210
file:  /data/scratch3/steff/IRAS13224-3809/0780561401/PROC/PN_time_0.3-10_pi_grp.fits
back:  /data/scratch3/steff/IRAS13224-3809/0780561401/PROC/PN_time_0.3-10_bkg_pi.fits

..................................................................................

isis
d=load_data("/data/scratch3/steff/IRAS13224-3809/0780561501/PROC/PN_time_0.3-10_pi_grp.fits");
data_flux(1,0.3,10);
list_data;

 data_flux(1,0.3,10);
2.0048357904520423e-07
2.5808668519121095e-12
14.8572907776953
0.0025477707647270516
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0    4096/ 4096   1   1  1.7607e+05   117.074
file:  /data/scratch3/steff/IRAS13224-3809/0780561501/PROC/PN_time_0.3-10_pi_grp.fits
back:  /data/scratch3/steff/IRAS13224-3809/0780561501/PROC/PN_time_0.3-10_bkg_pi.fits


..................................................................................

isis
d=load_data("/data/scratch3/steff/IRAS13224-3809/0780561601/PROC/PN_time_0.3-10_pi_grp.fits");
data_flux(1,0.3,10);
list_data;

 data_flux(1,0.3,10);
1.6853935750650518e-07
5.923924746088337e-12
12.030755971801568
0.005702103487973288
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0    4096/ 4096   1   1  4.0806e+05   117.954
file:  /data/scratch3/steff/IRAS13224-3809/0780561601/PROC/PN_time_0.3-10_pi_grp.fits
back:  /data/scratch3/steff/IRAS13224-3809/0780561601/PROC/PN_time_0.3-10_bkg_pi.fits


..................................................................................

isis
d=load_data("/data/scratch3/steff/IRAS13224-3809/0780561701/PROC/PN_time_0.3-10_pi_grp.fits");
data_flux(1,0.3,10);
list_data;

 data_flux(1,0.3,10);
1.3804685680239442e-07
3.0307354091800854e-12
10.13602926460809
0.0029136257387635503
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0    4096/ 4096   1   1  2.2300e+05   127.117
file:  /data/scratch3/steff/IRAS13224-3809/0780561701/PROC/PN_time_0.3-10_pi_grp.fits
back:  /data/scratch3/steff/IRAS13224-3809/0780561701/PROC/PN_time_0.3-10_bkg_pi.fits

..................................................................................

isis
d=load_data("/data/scratch3/steff/IRAS13224-3809/0792180101/PROC/PN_time_0.3-10_pi_grp.fits");
data_flux(1,0.3,10);
list_data;

 data_flux(1,0.3,10);
2.1737293147162126e-07
2.7677289020354053e-12
15.803135424750147
0.0026929619516831687
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0    4096/ 4096   1   1  1.8324e+05   114.179
file:  /data/scratch3/steff/IRAS13224-3809/0792180101/PROC/PN_time_0.3-10_pi_grp.fits
back:  /data/scratch3/steff/IRAS13224-3809/0792180101/PROC/PN_time_0.3-10_bkg_pi.fits

..................................................................................

isis
d=load_data("/data/scratch3/steff/IRAS13224-3809/0792180201/PROC/PN_time_0.3-10_pi_grp.fits");
data_flux(1,0.3,10);
list_data;

 data_flux(1,0.3,10);
2.0443991565702147e-07
3.5511290058985662e-12
14.823599065443075
0.0035431261098923025
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0    4096/ 4096   1   1  2.5110e+05   119.630
file:  /data/scratch3/steff/IRAS13224-3809/0792180201/PROC/PN_time_0.3-10_pi_grp.fits
back:  /data/scratch3/steff/IRAS13224-3809/0792180201/PROC/PN_time_0.3-10_bkg_pi.fits

..................................................................................

isis
d=load_data("/data/scratch3/steff/IRAS13224-3809/0792180301/PROC/PN_time_0.3-10_pi_grp.fits");
data_flux(1,0.3,10);
list_data;


 data_flux(1,0.3,10);
1.542846802275022e-07
1.616075333735982e-12
11.390306811186965
0.0015075914692105155
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0    4096/ 4096   1   1  1.0760e+05   119.508
file:  /data/scratch3/steff/IRAS13224-3809/0792180301/PROC/PN_time_0.3-10_pi_grp.fits
back:  /data/scratch3/steff/IRAS13224-3809/0792180301/PROC/PN_time_0.3-10_bkg_pi.fits

..................................................................................

isis
d=load_data("/data/scratch3/steff/IRAS13224-3809/0792180401/PROC/PN_time_0.3-10_pi_grp.fits");
data_flux(1,0.3,10);
list_data;

 data_flux(1,0.3,10);
1.4235804208398756e-07
8.23109029713372e-12
9.93675446275469
0.007522922887825254
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0    4096/ 4096   1   1  5.2155e+05   111.297
file:  /data/scratch3/steff/IRAS13224-3809/0792180401/PROC/PN_time_0.3-10_pi_grp.fits
back:  /data/scratch3/steff/IRAS13224-3809/0792180401/PROC/PN_time_0.3-10_bkg_pi.fits

..................................................................................

isis
d=load_data("/data/scratch3/steff/IRAS13224-3809/0792180501/PROC/PN_time_0.3-10_pi_grp.fits");
data_flux(1,0.3,10);
list_data;

 data_flux(1,0.3,10);
1.9088613411994684e-07
3.4663452583353994e-12
13.701791461447662
0.0031690487394010793
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0    4096/ 4096   1   1  2.1865e+05   112.297
file:  /data/scratch3/steff/IRAS13224-3809/0792180501/PROC/PN_time_0.3-10_pi_grp.fits
back:  /data/scratch3/steff/IRAS13224-3809/0792180501/PROC/PN_time_0.3-10_bkg_pi.fits

..................................................................................

isis
d=load_data("/data/scratch3/steff/IRAS13224-3809/0792180601/PROC/PN_time_0.3-10_pi_grp.fits");
data_flux(1,0.3,10);
list_data;

 data_flux(1,0.3,10);
1.578484832802056e-07
8.014107842474396e-12
11.07876749702177
0.007367980447500107
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0    4096/ 4096   1   1  5.3759e+05   117.033
file:  /data/scratch3/steff/IRAS13224-3809/0792180601/PROC/PN_time_0.3-10_pi_grp.fits
back:  /data/scratch3/steff/IRAS13224-3809/0792180601/PROC/PN_time_0.3-10_bkg_pi.fits


#+END_EXAMPLE

PATH =/home/steff075/phd_ecm/results-for-all/IRAS13224_flux_counts_check_method.ods=

+-----------+----------------------+----------+----------+------------+
|    obs_id | Data_Flux(0.3-10keV) |   counts |  Eff_Exp | spec_state |
+-----------+----------------------+----------+----------+------------+
| 110890101 |             2.66E-07 | 1.01E+05 | 5.48E+01 | Med        |
+-----------+----------------------+----------+----------+------------+
| 673580101 |             2.63E-07 | 1.09E+05 | 4.30E+01 | Med        |
+-----------+----------------------+----------+----------+------------+
| 673580201 |             9.62E-08 | 1.74E+05 | 9.19E+01 | Med        |
+-----------+----------------------+----------+----------+------------+
| 673580301 |             1.93E-07 | 8.89E+04 | 7.62E+01 | Lo         |
+-----------+----------------------+----------+----------+------------+
| 673580401 |             2.00E-07 | 1.05E+02 | 1.05E+02 | Med        |
+-----------+----------------------+----------+----------+------------+
| 780560101 |             2.03E-07 | 6.83E+04 | 3.19E+01 | Med        |
+-----------+----------------------+----------+----------+------------+
| 780561301 |             2.05E-07 | 1.18E+02 | 1.18E+02 | Med        |
+-----------+----------------------+----------+----------+------------+
| 780561401 |             2.26E-07 | 7.62E+01 | 7.62E+01 | Med        |
+-----------+----------------------+----------+----------+------------+
| 780561501 |             2.00E-07 | 1.76E+05 | 1.17E+02 | Med        |
+-----------+----------------------+----------+----------+------------+
| 780561601 |             1.69E-07 | 4.08E+05 | 1.18E+02 | Med        |
+-----------+----------------------+----------+----------+------------+
| 780561701 |             1.38E-07 | 1.27E+02 | 1.27E+02 | Med        |
+-----------+----------------------+----------+----------+------------+
| 792180101 |             2.17E-07 | 1.83E+05 | 1.14E+02 | Med        |
+-----------+----------------------+----------+----------+------------+
| 792180201 |             2.04E-07 | 2.51E+05 | 1.20E+02 | Med        |
+-----------+----------------------+----------+----------+------------+
| 792180301 |             1.54E-07 | 1.08E+05 | 1.20E+02 | Lo         |
+-----------+----------------------+----------+----------+------------+
| 792180401 |             1.42E-07 | 1.11E+02 | 1.11E+02 | Hi         |
+-----------+----------------------+----------+----------+------------+
| 792180501 |             1.91E-07 | 1.12E+02 | 1.12E+02 | Med        |
+-----------+----------------------+----------+----------+------------+
| 792180601 |             1.58E-07 | 5.38E+05 | 1.17E+02 | Hi         |
+-----------+----------------------+----------+----------+------------+
|      comb |             1.90E-07 | 1.30E+05 | 1.65E+03 |            |
+-----------+----------------------+----------+----------+------------+
|   Hi-flux |             1.50E-07 | 2.69E+05 | 2.28E+02 |            |
+-----------+----------------------+----------+----------+------------+
|  Med-flux |             1.98E-07 | 1.23E+05 | 1.10E+03 |            |
+-----------+----------------------+----------+----------+------------+
|   Lo-flux |             1.74E-07 | 9.82E+04 | 1.96E+02 |            |
+-----------+----------------------+----------+----------+------------+

*Note*: The Combined, Hi-flux, Med-flux, Lo-flux and counts are all shown
as a mean value of the data sets they contain as outlined above. The Exposure time is
the sum of the Exp data for those groups. (i.e, Mean flux, mean counts
and total exposure time)

** New Combined (July 2020)

PATH =/home/steff075/phd_ecm/IRAS13224-3809/lagfreq_multi_script.sl=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_lagfreq_comb_add2016.gif


|         Freq |           +- |           Lag |           +- |
| 7.272727e-05 | 2.272727e-05 |  7.659602e+02 | 1.074817e+02 |
| 1.388430e-04 | 4.338843e-05 |  2.454899e+02 | 4.795118e+01 |
| 2.650639e-04 | 8.283246e-05 |  2.046964e+01 | 2.400882e+01 |
| 5.060310e-04 | 1.581347e-04 | -3.929524e+01 | 9.642049e+00 |
| 9.660592e-04 | 3.018935e-04 | -3.759035e+01 | 4.297845e+00 |
| 1.844295e-03 | 5.763421e-04 | -1.976542e+01 | 3.477470e+00 |
| 3.520927e-03 | 1.100290e-03 | -2.532500e+01 | 4.908051e+00 |

Lags for time-lag-fits in =/home/steff075/phd_ecm/IRAS13224-3809/lagvalues_comb_add2016.csv=

Lags for Veusz plot in =/home/steff075/phd_ecm/IRAS13224-3809/lagvalues_comb_add2016.csv=

Create Time Lag fits

*IRAS13224-3809-comb-time-lags-add2016.fits*

*IRAS13224-3809-comb-time-lags-add2016.rsp*

Check lags in ISIS:

#+BEGIN_EXAMPLE

Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-comb-time-lags-add2016.fits");
r=load_rmf("IRAS13224-3809-comb-time-lags-add2016.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

** New combined fmax (July 2020)


PATH =/home/steff075/phd_ecm/IRAS13224-3809/lagfreq_comb_script.sl=

#+BEGIN_EXAMPLE
%declare frequency bins
variable n_bins = 7;
variable df_f = 1.0/1.2;
variable lo = Double_Type[n_bins];
variable hi = Double_Type[n_bins];
lo[0]=0.00005;
hi[0]=(lo[0] + lo[0]*df_f);

for(i=1;i<n_bins;i++){
    lo[i]=hi[i-1];
    hi[i]=lo[i]+lo[i]*df_f;
 }
#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_lagfreq_comb_fmax.gif


|         Freq |           +- |           Lag |           +- |
| 7.083333e-05 | 2.083333e-05 |  7.981263e+02 | 1.120158e+02 |
| 1.298611e-04 | 3.819444e-05 |  2.814159e+02 | 5.119275e+01 |
| 2.380787e-04 | 7.002315e-05 |  2.217994e+01 | 2.605012e+01 |
| 4.364776e-04 | 1.283758e-04 | -4.968591e+01 | 1.053331e+01 |
| 8.002090e-04 | 2.353556e-04 | -3.409732e+01 | 4.739953e+00 |
| 1.467050e-03 | 4.314852e-04 | -2.247776e+01 | 2.604454e+00 |
| 2.689591e-03 | 7.910563e-04 | -6.169462e+00 | 1.320600e+00 |

=time_lags_comb_fmax.csv=

=time_lags_comb_fmax2.csv=

** Final Lag spectra - Comb, Hi, Lo, Med, Hi-cts, Lo-cts (Apr 2021)


PATH = =/home/steff075/phd_ecm/IRAS13224-3809/IRAS13224-lag-results-All-flux.vsz=

Importing = =IRAS13224-lag-results.csv=

| IRAS-comb-Freq |       +- | IRAS-Comb-Lag |       +- | IRAS-Hi_Freq |       +- | IRAS_Hi-Lag |       +- | IRAS-Med_Freq |       +- | IRAS_Med-Lag |       +- | IRAS-Lo_Freq |       +- | IRAS_Lo-Lag |       +- | IRAS-hicts_Freq |       +- | IRAS_hicts-Lag |       +- | IRAS-locts_Freq |       +- | IRAS_locts-Lag |       +- |
|       7.27E-05 | 2.27E-05 |      7.66E+02 | 1.07E+02 |     7.27E-05 | 2.27E-05 |    1.30E+03 | 3.56E+02 |      7.27E-05 | 2.27E-05 |     6.59E+02 | 1.06E+02 |     7.27E-05 | 2.27E-05 |    2.65E+02 | 2.08E+02 |        7.27E-05 | 2.27E-05 |       1.06E+03 | 1.97E+02 |        7.27E-05 | 2.27E-05 |       6.25E+02 | 1.31E+02 |
|       1.39E-04 | 4.34E-05 |      2.45E+02 | 4.80E+01 |     1.39E-04 | 4.34E-05 |    3.45E+02 | 8.47E+01 |      1.39E-04 | 4.34E-05 |     1.24E+02 | 6.63E+01 |     1.39E-04 | 4.34E-05 |    3.58E+02 | 1.66E+02 |        1.39E-04 | 4.34E-05 |       3.35E+02 | 5.62E+01 |        1.39E-04 | 4.34E-05 |       5.51E+01 | 9.23E+01 |
|       2.65E-04 | 8.28E-05 |      2.05E+01 | 2.40E+01 |     2.65E-04 | 8.28E-05 |    5.95E+01 | 5.64E+01 |      2.65E-04 | 8.28E-05 |    -1.87E+00 | 2.73E+01 |     2.65E-04 | 8.28E-05 |   -5.77E+00 | 7.82E+01 |        2.65E-04 | 8.28E-05 |       5.12E+01 | 3.66E+01 |        2.65E-04 | 8.28E-05 |       1.37E+01 | 3.34E+01 |
|       5.06E-04 | 1.58E-04 |     -3.93E+01 | 9.64E+00 |     5.06E-04 | 1.58E-04 |   -4.37E+01 | 2.40E+01 |      5.06E-04 | 1.58E-04 |    -3.77E+01 | 1.15E+01 |     5.06E-04 | 1.58E-04 |   -1.73E+01 | 2.78E+01 |        5.06E-04 | 1.58E-04 |      -3.51E+01 | 1.49E+01 |        5.06E-04 | 1.58E-04 |      -3.84E+01 | 1.33E+01 |
|       9.66E-04 | 3.02E-04 |     -3.76E+01 | 4.30E+00 |     9.66E-04 | 3.02E-04 |   -4.29E+01 | 9.92E+00 |      9.66E-04 | 3.02E-04 |    -3.22E+01 | 5.23E+00 |     9.66E-04 | 3.02E-04 |   -6.70E+01 | 1.12E+01 |        9.66E-04 | 3.02E-04 |      -4.06E+01 | 6.28E+00 |        9.66E-04 | 3.02E-04 |      -3.50E+01 | 6.24E+00 |
|       1.84E-03 | 5.76E-04 |     -1.98E+01 | 3.48E+00 |     1.84E-03 | 5.76E-04 |   -1.39E+01 | 9.61E+00 |      1.84E-03 | 5.76E-04 |    -2.19E+01 | 3.90E+00 |     1.84E-03 | 5.76E-04 |   -1.66E+01 | 5.74E+00 |        1.84E-03 | 5.76E-04 |      -1.73E+01 | 6.04E+00 |        1.84E-03 | 5.76E-04 |      -2.21E+01 | 4.65E+00 |
|       3.52E-03 | 1.10E-03 |     -2.53E+01 | 4.91E+00 |     3.52E-03 | 1.10E-03 |   -3.33E+01 | 1.23E+01 |      3.52E-03 | 1.10E-03 |    -2.07E+01 | 5.36E+00 |     3.52E-03 | 1.10E-03 |   -1.45E-01 | 2.81E+00 |        3.52E-03 | 1.10E-03 |      -2.46E+01 | 8.20E+00 |        3.52E-03 | 1.10E-03 |      -2.59E+01 | 6.21E+00 |


#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-lag-results-All-flux.png

pdf at:

http://www.star.bris.ac.uk/steff/ecm/IRAS13224-lag-results-All-flux.pdf

** New low - medium - high flux (July 2020)


Lets look at all lightcurves in the 0.3 - 10 keV range:

PATH =
=/home/steff075/phd_ecm/IRAS13224-3809/lightcurves/IRAS_multi_lc_plots_ALL.vsz=


#+ATTR_HTML: :width 1000
http://www.star.bris.ac.uk/steff/ecm/IRAS_multi_lc_plots_ALL.png

Now the spectra of these:

PATH = =/home/steff075/phd_ecm/1H0707-495/multi_spectra_unfold.sl=



*Low flux*

Lo Flux    = "0673580301 (82ks)","0792180301 (140.5 ks)"

PATH =/home/steff075/phd_ecm/IRAS13224-3809/lagfreq_multi_script.sl=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_lagfreq_loflux_add2016.gif

|         Freq |           +- |           Lag |           +- |
| 7.272727e-05 | 2.272727e-05 |  2.653795e+02 | 2.083722e+02 |
| 1.388430e-04 | 4.338843e-05 |  3.575388e+02 | 1.656542e+02 |
| 2.650639e-04 | 8.283246e-05 | -5.768124e+00 | 7.823094e+01 |
| 5.060310e-04 | 1.581347e-04 | -1.731971e+01 | 2.776493e+01 |
| 9.660592e-04 | 3.018935e-04 | -6.700475e+01 | 1.118235e+01 |
| 1.844295e-03 | 5.763421e-04 | -1.658179e+01 | 5.737501e+00 |
| 3.520927e-03 | 1.100290e-03 | -1.445359e-01 | 2.813753e+00 |


Lags for time-lag-fits in =/home/steff075/phd_ecm/IRAS13224-3809/lagvalues_loflux_add2016.csv=

Lags for Veusz plot in =/home/steff075/phd_ecm/IRAS13224-3809/lagvalues_loflux_add2016.csv=

*Medium Flux*

Med Flux   = "0110890101","0673580101","0673580201","0673580401","0780560101","0780561301","0780561401","0780561501","0780561601","0780561701","0792180101","0792180201","0792180501"


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_lagfreq_medflux_add2016.gif

|         Freq |           +- |           Lag |           +- |
| 7.272727e-05 | 2.272727e-05 |  6.591017e+02 | 1.062690e+02 |
| 1.388430e-04 | 4.338843e-05 |  1.243071e+02 | 6.629647e+01 |
| 2.650639e-04 | 8.283246e-05 | -1.869898e+00 | 2.725150e+01 |
| 5.060310e-04 | 1.581347e-04 | -3.769770e+01 | 1.145799e+01 |
| 9.660592e-04 | 3.018935e-04 | -3.220231e+01 | 5.228265e+00 |
| 1.844295e-03 | 5.763421e-04 | -2.187394e+01 | 3.899691e+00 |
| 3.520927e-03 | 1.100290e-03 | -2.066668e+01 | 5.362667e+00 |

Lags for time-lag-fits in =/home/steff075/phd_ecm/IRAS13224-3809/lagvalues_medflux_add2016.csv=

Lags for Veusz plot in =/home/steff075/phd_ecm/IRAS13224-3809/lagvalues_medflux_add2016.csv=


*High Flux*

Hi  Flux   = "0792180401","0792180601"


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_lagfreq_hiflux_add2016.gif

Lags for time-lag-fits in =/home/steff075/phd_ecm/IRAS13224-3809/lagvalues_hiflux_add2016.csv=

Lags for Veusz plot in =/home/steff075/phd_ecm/IRAS13224-3809/lagvalues_hiflux_add2016.csv=

|         Freq |           +- |           Lag |           +- |
| 7.272727e-05 | 2.272727e-05 |  1.295933e+03 | 3.557145e+02 |
| 1.388430e-04 | 4.338843e-05 |  3.454322e+02 | 8.473398e+01 |
| 2.650639e-04 | 8.283246e-05 |  5.950823e+01 | 5.643594e+01 |
| 5.060310e-04 | 1.581347e-04 | -4.365789e+01 | 2.403858e+01 |
| 9.660592e-04 | 3.018935e-04 | -4.294368e+01 | 9.923466e+00 |
| 1.844295e-03 | 5.763421e-04 | -1.392943e+01 | 9.611077e+00 |
| 3.520927e-03 | 1.100290e-03 | -3.331812e+01 | 1.225319e+01 |

*All lag states*

PATH =/home/steff075/phd_ecm/IRAS13224-3809/IRAS13224-3809-lag-results-lo-hi-flux.vsz=

Using =/home/steff075/phd_ecm/IRAS13224-3809/IRAS13224-3809-lag-results.csv=


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809-lag-results-lo-med-hi-flux.png

Also saved as =/home/steff075/phd_ecm/IRAS13224-3809-lag-results-lo-med-hi-flux.pdf=

** Old Combined

Lets just have a look at the combined flux state lag-frequencies >5e-5 Hz:

use =lagfreq_multi_script.sl=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809-lag-results-comb.png

Lags found in
=/homeb/steff075/phd_ecm/IRAS13224-3809/lagvalues-combined.csv=

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 7.272727e-05 | 2.272727e-05 |  5.596631e+02 | 1.509663e+02 |
+--------------+--------------+---------------+--------------+
| 1.388430e-04 | 4.338843e-05 |  2.071069e+02 | 9.776028e+01 |
+--------------+--------------+---------------+--------------+
| 2.650639e-04 | 8.283246e-05 | -7.544134e+01 | 4.748104e+01 |
+--------------+--------------+---------------+--------------+
| 5.060310e-04 | 1.581347e-04 | -5.011103e+01 | 2.422348e+01 |
+--------------+--------------+---------------+--------------+
| 9.660592e-04 | 3.018935e-04 | -2.348180e+01 | 1.136203e+01 |
+--------------+--------------+---------------+--------------+
| 1.844295e-03 | 5.763421e-04 | -2.071284e+01 | 7.126319e+00 |
+--------------+--------------+---------------+--------------+
| 3.520927e-03 | 1.100290e-03 | -3.395289e+00 | 1.449182e+01 |
+--------------+--------------+---------------+--------------+

** Old Low - High Flux state results

Lets just have a look at the low and high flux state lag-frequencies:

use =lagfreq_multi_script.sl=

*Low flux*

0673580401 113 ks 2011

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_lagfreq_lo_flux.PNG


Lags found in =/homeb/steff075/phd_ecm/IRAS13224-3809/lagvalues-lo-flux.csv=

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 5.818182e-05 | 1.818182e-05 |  5.281419e+02 | 3.540285e+02 |
+--------------+--------------+---------------+--------------+
| 1.110744e-04 | 3.471074e-05 |  1.480904e+02 | 2.724272e+02 |
+--------------+--------------+---------------+--------------+
| 2.120511e-04 | 6.626597e-05 | -2.607849e+02 | 7.878196e+01 |
+--------------+--------------+---------------+--------------+
| 4.048248e-04 | 1.265078e-04 | -1.242622e+02 | 3.879420e+01 |
+--------------+--------------+---------------+--------------+
| 7.728474e-04 | 2.415148e-04 | -4.629820e+01 | 1.924289e+01 |
+--------------+--------------+---------------+--------------+
| 1.475436e-03 | 4.610737e-04 | -1.738049e+01 | 1.083326e+01 |
+--------------+--------------+---------------+--------------+
| 2.816741e-03 | 8.802316e-04 | -1.093465e+01 | 1.229720e+01 |
+--------------+--------------+---------------+--------------+

*Genegenerate fits and response*

Lo-flux

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28
accordingly. Run fits files to check:

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-time-lags-lo-flux.fits");
r=load_rmf("IRAS13224-3809-time-lags-lo-flux.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

*High flux*

"0110890101","0673580101","0673580201","0673580301"

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_lagfreq_hi_flux.PNG

Lags found:
file =/homeb/steff075/phd_ecm/IRAS13224-3809/time_lags_Hi-Flux.csv=

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 1.454545e-04 | 4.545455e-05 |  2.686811e+02 | 1.014244e+02 |
+--------------+--------------+---------------+--------------+
| 2.776860e-04 | 8.677686e-05 |  4.981235e+01 | 6.055010e+01 |
+--------------+--------------+---------------+--------------+
| 5.301277e-04 | 1.656649e-04 | -2.398762e+01 | 2.970455e+01 |
+--------------+--------------+---------------+--------------+
| 1.012062e-03 | 3.162694e-04 | -1.757587e+01 | 1.549604e+01 |
+--------------+--------------+---------------+--------------+
| 1.932118e-03 | 6.037870e-04 | -2.222416e+01 | 1.377181e+01 |
+--------------+--------------+---------------+--------------+
| 3.688590e-03 | 1.152684e-03 | -3.826122e+00 | 1.650256e+01 |
+--------------+--------------+---------------+--------------+
| 7.041853e-03 | 2.200579e-03 | -5.603093e+00 | 3.288519e+01 |
+--------------+--------------+---------------+--------------+

Now Genegenerate fits and response files as above

Lets combine these results in Veusz

Use =homeb/steff075/phd_ecm/IRAS13224-3809/lag-results.ods= to obtain
the csv

Plot =homeb/steff075/phd_ecm/IRAS13224-3809/lag-results-lo-hi-flux.vsz=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809-lag-results-lo-hi-flux.png

Now copy these the BC4 for fitting to ECM model, e.g:

#+BEGIN_EXAMPLE
scp IRAS13224-3809-time-lags-lo-flux.fits so14935@bc4login.acrc.bris.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/IRAS13224-3809-time-lag-fits
#+END_EXAMPLE
** Lag-energy (combined)

From the lag-frequencies obtained in the above combined section, lets
look at the lag-energy in the hi and low frequencies  relating to the
fluctuation and reverberation lags:


*Low-frequency*

PATH =/home/steff075/phd_ecm/IRAS13224-3809/lagen_comb_lf.sl=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_lagen_lofreq.PNG

*High-frequency*

PATH =/home/steff075/phd_ecm/IRAS13224-3809/lagen_comb_hf.sl=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_lagen_hifreq.PNG

*Lo-hi lag-energy*

PATH =/home/steff075/phd_ecm/IRAS13224-3809/lagen-results.vsz=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_lagen_results.png

** Corrected Old Lo -Hi Flux

Now just the high flux from Table  - OBS 0110890101 = hi and OBS
0110890101  = lo.
This gives:

+----------------+----------+---------------+------+--------------+--------------+-------------+----------+--------------+--------------+-------------+----------+
| IRAS-comb-Freq |       +- | IRAS-Comb-Lag |   +- | IRAS-Lo-Freq |           +- | IRAS-Lo-Lag |       +- | IRAS-Hi_Freq |           +- | IRAS_Hi-Lag |       +- |
+----------------+----------+---------------+------+--------------+--------------+-------------+----------+--------------+--------------+-------------+----------+
|       7.27E-05 | 2.27E-05 |           560 |  151 | 7.272727E-05 | 2.272727E-05 |    516.0719 | 267.2399 | 7.272727E-05 | 2.272727E-05 |    1029.471 | 365.4683 |
+----------------+----------+---------------+------+--------------+--------------+-------------+----------+--------------+--------------+-------------+----------+
|       0.000139 | 4.34E-05 |           207 | 97.8 |  0.000138843 | 4.338843E-05 |   -87.20117 | 200.0757 |  0.000138843 | 4.338843E-05 |    183.1865 | 265.7501 |
+----------------+----------+---------------+------+--------------+--------------+-------------+----------+--------------+--------------+-------------+----------+
|       0.000265 | 8.28E-05 |         -75.4 | 47.5 | 0.0002650639 | 8.283246E-05 |   -239.9313 | 50.70954 | 0.0002650639 | 8.283246E-05 |   -61.82428 | 131.5723 |
+----------------+----------+---------------+------+--------------+--------------+-------------+----------+--------------+--------------+-------------+----------+
|       0.000506 | 0.000158 |         -50.1 | 24.2 |  0.000506031 | 0.0001581347 |   -94.11921 | 35.68659 |  0.000506031 | 0.0001581347 |    148.1032 | 113.3431 |
+----------------+----------+---------------+------+--------------+--------------+-------------+----------+--------------+--------------+-------------+----------+
|       0.000966 | 0.000302 |         -23.5 | 11.4 | 0.0009660592 | 0.0003018935 |   -29.80652 | 17.14381 | 0.0009660592 | 0.0003018935 |   -20.50896 | 30.06422 |
+----------------+----------+---------------+------+--------------+--------------+-------------+----------+--------------+--------------+-------------+----------+
|        0.00184 | 0.000576 |         -20.7 | 7.13 |  0.001844295 | 0.0005763421 |    -18.1567 | 8.457213 |  0.001844295 | 0.0005763421 |   -21.31293 | 31.89782 |
+----------------+----------+---------------+------+--------------+--------------+-------------+----------+--------------+--------------+-------------+----------+
|        0.00352 |   0.0011 |          -3.4 | 14.5 |  0.003520927 |   0.00110029 |    -26.1426 | 20.65788 |  0.003520927 |   0.00110029 |    81.61367 | 27.75944 |
+----------------+----------+---------------+------+--------------+--------------+-------------+----------+--------------+--------------+-------------+----------+


Now use =IRAS13224-3809-lag-results-lo-hi-2.vsz=

** Light curve data lo-hi at 20 cts $s^{-1}$

Lets look again at the full lightcurve plots:

PATH =
=/home/steff075/phd_ecm/IRAS13224-3809/lightcurves/IRAS_multi_lc_plots_ALL.vsz=


#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS_multi_lc_plots_ALL.png

What does the lag-frequency spectra look loke for all observations
with < 20 cts per sec  compared to > 20 cts per sec?


pdf at:

http://www.star.bris.ac.uk/steff/ecm/IRAS_multi_lc_plots_ALL.pdf


*Under 20 cts $s^{-1}$*

Lets group data:

Spectral PATH =
=/home/steff075/phd_ecm/IRAS13224-3809/combine_lo_cts_lc_data.sl=

Timing PATH =/home/steff075/phd_ecm/IRAS13224-3809/lagfreq_lo_cts_lc_data.sl=

#+BEGIN_EXAMPLE
% Lo-cts-lc-data
variable obsid = ["0673580101","0780561301","0780561401","0780561501","0780561601","0792180101","0792180201","0792180501"];
#+END_EXAMPLE


#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_lagfreq_lo_cts_lc_data.gif


|         Freq |           +- |           Lag |           +- |
| 7.272727e-05 | 2.272727e-05 |  6.248102e+02 | 1.313838e+02 |
| 1.388430e-04 | 4.338843e-05 |  5.510606e+01 | 9.232792e+01 |
| 2.650639e-04 | 8.283246e-05 |  1.369603e+01 | 3.344967e+01 |
| 5.060310e-04 | 1.581347e-04 | -3.838169e+01 | 1.334151e+01 |
| 9.660592e-04 | 3.018935e-04 | -3.498148e+01 | 6.238894e+00 |
| 1.844295e-03 | 5.763421e-04 | -2.210232e+01 | 4.653642e+00 |
| 3.520927e-03 | 1.100290e-03 | -2.592402e+01 | 6.209589e+00 |

Lags saved in: "lagvalues_lo_cts_lc.csv" and
"lagvalues_lo_cts2_lc.csv"

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-time-lags-lc-cts-below20.fits");
r=load_rmf("IRAS13224-3809-time-lags-lc-cts-below20.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

*Over 20 cts $s^{-1}$*

Spectral PATH =
=/home/steff075/phd_ecm/IRAS13224-3809/combine_hi_cts_lc_data.sl=

Timing PATH =/home/steff075/phd_ecm/IRAS13224-3809/lagfreq_hi_cts_lc_data.sl=

#+BEGIN_EXAMPLE
% Hi-cts-lc-data
variable obsid = ["0110890101","0673580201","0673580301","0780560101","0780561701","0792180301","0792180401","0792180601"];
#+END_EXAMPLE


#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_lagfreq_hi_cts_lc_data.gif


|         Freq |           +- |           Lag |           +- |
| 7.272727e-05 | 2.272727e-05 |  1.061512e+03 | 1.967432e+02 |
| 1.388430e-04 | 4.338843e-05 |  3.351204e+02 | 5.624820e+01 |
| 2.650639e-04 | 8.283246e-05 |  5.121774e+01 | 3.660725e+01 |
| 5.060310e-04 | 1.581347e-04 | -3.506036e+01 | 1.488330e+01 |
| 9.660592e-04 | 3.018935e-04 | -4.063875e+01 | 6.278714e+00 |
| 1.844295e-03 | 5.763421e-04 | -1.732346e+01 | 6.035641e+00 |
| 3.520927e-03 | 1.100290e-03 | -2.460028e+01 | 8.197435e+00 |

Lags saved in: "lagvalues_hi_cts_lc.csv" and "lagvalues_hi_cts2_lc.csv"

Time lags generated as:

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-time-lags-lc-cts-above20.fits");
r=load_rmf("IRAS13224-3809-time-lags-lc-cts-above20.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0110890101 (2002) 61 ks

First lets look at the spectra:

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_Spectra_0110890101.gif

data flux(1,0.3,10)

3.2942760083037245e-14
3.3172412660432237e-12
9.880943678779296e-05
0.00317075151039813

Use script =/homeb/steff075/phd_ecm/IRAS13224-3809/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
Freq,+-,Lag,+-
7.272727e-05,2.272727e-05,1.029471e+03,3.654683e+02
1.388430e-04,4.338843e-05,1.820973e+02,2.614657e+02
2.650639e-04,8.283246e-05,-5.302168e+01,8.644067e+01
5.060310e-04,1.581347e-04,9.587622e+01,6.301444e+01
9.660592e-04,3.018935e-04,-1.811446e+01,2.483539e+01
1.844295e-03,5.763421e-04,-8.880375e+00,1.143634e+01
3.520927e-03,1.100290e-03,9.500845e+00,4.779324e+00
#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0110890101_lagfreq.gif

*** Segment analysis

PATH = =/data/scratch3/steff/IRAS13224-3809/0110890101/PROC=

Initiate sas

#+BEGIN_EXAMPLE
heainit
setsas
setenv SAS_CCFPATH /usr/local/XMM/ccf/
setenv SAS_ODF /data/scratch3/steff/IRAS13224-3809/0110890101/ODF
setenv SAS_CCF ccf.cif
#+END_EXAMPLE

Obtain lightcurve time

Make the lightcurve


#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withrateset=yes rateset=EPICclean_lc.fits maketimecolumn=yes timebinsize=100 makeratecolumn=yes

dsplot table=EPICclean_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

The table ran from 127798000 to 127858000 giving a total time of 60000s.

seg1 127798000:127818000
seg2 127818000:127838000
seg3 127838000:127858000


#Copy Background Subtracted Light Curve to make the lightcurves with time above periods


#+BEGIN_EXAMPLE
cp PN_time_hard_lccorr.fits /data/scratch3/steff/IRAS13224-3809/0110890101_0.3-4k/seg1
cp PN_time_soft_lccorr.fits /data/scratch3/steff/IRAS13224-3809/0110890101_0.3-4k/seg1

#Change to segs directory
cd /data/scratch3/steff/IRAS13224-3809/0110890101_0.3-4k/seg1

# Rename these files as the output file needs to be the same name
mv PN_time_hard_lccorr.fits PN_time_hard_lccorr_full.fits
mv PN_time_soft_lccorr.fits PN_time_soft_lccorr_full.fits


# Filter by the appropriate time
evselect table=PN_time_soft_lccorr_full.fits withfilteredset=yes filteredset=PN_time_soft_lccorr.fits filtertype=expression  expression='TIME in [127838000:127858000]' keepfilteroutput=yes updateexposure=yes
evselect table=PN_time_hard_lccorr_full.fits withfilteredset=yes filteredset=PN_time_hard_lccorr.fits filtertype=expression  expression='TIME in [127838000:127858000]' keepfilteroutput=yes updateexposure=yes

# Plot the light curve
dsplot table=PN_time_soft_lccorr.fits x=TIME y=RATE &
dsplot table=PN_time_hard_lccorr.fits x=TIME y=RATE &


#+END_EXAMPLE

** OBS 0673580101 (2011) 49 ks

First lets look at the spectra:

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_Spectra_0673580101.gif

data flux(1,0.3,10)
2.890604016875766e-14
4.338027415952786e-12
5.694632211990189e-05
0.003952247079761683


Use script =/homeb/steff075/phd_ecm/IRAS13224-3809/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
Freq,+-,Lag,+-
1.163636e-04,3.636364e-05,3.562002e+02,1.323744e+02
2.221488e-04,6.942149e-05,-1.266549e+02,2.022130e+02
4.241022e-04,1.325319e-04,-1.651821e+02,6.190456e+01
8.096496e-04,2.530155e-04,2.932161e+00,3.715238e+01
1.545695e-03,4.830296e-04,4.810878e+00,1.303665e+01
2.950872e-03,9.221474e-04,-2.248954e+00,6.717099e+00
5.633482e-03,1.760463e-03,-2.286225e+00,2.979585e+00


#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0673580101_lagfreq.gif

*** Segment analysis

PATH = =/data/scratch3/steff/IRAS13224-3809/0673580101/PROC=

Initiate sas

#+BEGIN_EXAMPLE
heainit
setsas
setenv SAS_CCFPATH /usr/local/XMM/ccf/
setenv SAS_ODF /data/scratch3/steff/IRAS13224-3809/0673580101/ODF
setenv SAS_CCF ccf.cif
#+END_EXAMPLE

Obtain lightcurve time

Make the lightcurve


#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withrateset=yes rateset=EPICclean_lc.fits maketimecolumn=yes timebinsize=100 makeratecolumn=yes

dsplot table=EPICclean_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

The table ran from 427432000 to 427481000 giving a total time of 49000s.

seg1 427432000:427454000
seg2 427454000:427476000


#Copy Background Subtracted Light Curve to make the lightcurves with time above periods


#+BEGIN_EXAMPLE
cp PN_time_hard_lccorr.fits /data/scratch3/steff/IRAS13224-3809/0673580101_0.3-4k/seg1
cp PN_time_soft_lccorr.fits /data/scratch3/steff/IRAS13224-3809/0673580101_0.3-4k/seg1

#Change to segs directory
cd /data/scratch3/steff/IRAS13224-3809/0673580101_0.3-4k/seg1

# Rename these files as the output file needs to be the same name
mv PN_time_hard_lccorr.fits PN_time_hard_lccorr_full.fits
mv PN_time_soft_lccorr.fits PN_time_soft_lccorr_full.fits


# Filter by the appropriate time
evselect table=PN_time_soft_lccorr_full.fits withfilteredset=yes filteredset=PN_time_soft_lccorr.fits filtertype=expression  expression='TIME in [427454000:427476000]' keepfilteroutput=yes updateexposure=yes
evselect table=PN_time_hard_lccorr_full.fits withfilteredset=yes filteredset=PN_time_hard_lccorr.fits filtertype=expression  expression='TIME in [427454000:427476000]' keepfilteroutput=yes updateexposure=yes

# Plot the light curve
dsplot table=PN_time_soft_lccorr.fits x=TIME y=RATE &
dsplot table=PN_time_hard_lccorr.fits x=TIME y=RATE &


#+END_EXAMPLE

** OBS 0673580201 (2011) 99 ks

First lets look at the spectra:

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_Spectra_0673580201.gif

data flux(1,0.3,10)
2.493751411452918e-14
3.221033692907476e-12
3.448174506615052e-05
0.002971926842297343


Use script =/homeb/steff075/phd_ecm/IRAS13224-3809/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,6.116706e+02,3.001014e+02
1.388430e-04,4.067131e+02,1.492622e+02
2.650639e-04,6.201421e+01,1.091642e+02
5.060310e-04,1.210218e+01,4.559140e+01
9.660592e-04,-6.288922e+00,2.003334e+01
1.844295e-03,-6.077008e+01,3.192267e+01
3.520927e-03,-7.994944e+00,1.434831e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0673580201_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-38091_0673580201_time_lags.fits");
r=load_rmf("IRAS13224-3809_0673580201_time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

*** Segment analysis

PATH = =/data/scratch3/steff/IRAS13224-3809/0673580101/PROC=

Initiate sas

#+BEGIN_EXAMPLE
heainit
setsas
setenv SAS_CCFPATH /usr/local/XMM/ccf/
setenv SAS_ODF /data/scratch3/steff/IRAS13224-3809/0673580201/ODF
setenv SAS_CCF ccf.cif
#+END_EXAMPLE

Obtain lightcurve time

Make the lightcurve


#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withrateset=yes rateset=EPICclean_lc.fits maketimecolumn=yes timebinsize=100 makeratecolumn=yes

dsplot table=EPICclean_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

The table ran from 427612000 to 427710000 giving a total time of 98000s.

seg1 427612000:427632000
seg2 427632000:427652000
seg3 427652000:427672000
seg4 427672000:427692000
seg5 427692000:427710000


#Copy Background Subtracted Light Curve to make the lightcurves with time above periods


#+BEGIN_EXAMPLE
cp PN_time_hard_lccorr.fits /data/scratch3/steff/IRAS13224-3809/0673580201_0.3-4k/seg1
cp PN_time_soft_lccorr.fits /data/scratch3/steff/IRAS13224-3809/0673580201_0.3-4k/seg1

#Change to segs directory
cd /data/scratch3/steff/IRAS13224-3809/0673580201_0.3-4k/seg1

# Rename these files as the output file needs to be the same name
mv PN_time_hard_lccorr.fits PN_time_hard_lccorr_full.fits
mv PN_time_soft_lccorr.fits PN_time_soft_lccorr_full.fits


# Filter by the appropriate time
evselect table=PN_time_soft_lccorr_full.fits withfilteredset=yes filteredset=PN_time_soft_lccorr.fits filtertype=expression  expression='TIME in [427692000:427710000]' keepfilteroutput=yes updateexposure=yes
evselect table=PN_time_hard_lccorr_full.fits withfilteredset=yes filteredset=PN_time_hard_lccorr.fits filtertype=expression  expression='TIME in [427692000:427710000]' keepfilteroutput=yes updateexposure=yes

# Plot the light curve
dsplot table=PN_time_soft_lccorr.fits x=TIME y=RATE &
dsplot table=PN_time_hard_lccorr.fits x=TIME y=RATE &


#+END_EXAMPLE

** OBS 0673580301 (2011) 82 ks

First lets look at the spectra:

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_Spectra_0673580301.gif

data flux(1,0.3,10)
2.0718020164586616e-14
1.9434913636054924e-12
3.2592871109056954e-05
0.0019027277153493307


Use script =/homeb/steff075/phd_ecm/IRAS13224-3809/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
Freq,+-,Lag,+-
7.272727e-05,2.272727e-05,3.648642e+02,4.066856e+02
1.388430e-04,4.338843e-05,2.799550e+02,1.756290e+02
2.650639e-04,8.283246e-05,8.226428e+01,8.336178e+01
5.060310e-04,1.581347e-04,-7.741598e+00,4.434704e+01
9.660592e-04,3.018935e-04,-7.135680e+01,2.055614e+01
1.844295e-03,5.763421e-04,-1.585661e+01,9.490610e+00
3.520927e-03,1.100290e-03,3.828762e+00,4.281605e+00

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0673580301_lagfreq.gif


*** Segment analysis

PATH = =/data/scratch3/steff/IRAS13224-3809/0673580101/PROC=

Initiate sas

#+BEGIN_EXAMPLE
heainit
setsas
setenv SAS_CCFPATH /usr/local/XMM/ccf/
setenv SAS_ODF /data/scratch3/steff/IRAS13224-3809/0673580301/ODF
setenv SAS_CCF ccf.cif
#+END_EXAMPLE

Obtain lightcurve time

Make the lightcurve


#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withrateset=yes rateset=EPICclean_lc.fits maketimecolumn=yes timebinsize=100 makeratecolumn=yes

dsplot table=EPICclean_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

The table ran from 427950000 to 428031000 giving a total time of 81000s.

seg1 427950000:427970000
seg2 427970000:427990000
seg3 427990000:428010000
seg4 428010000:428030000


#Copy Background Subtracted Light Curve to make the lightcurves with time above periods


#+BEGIN_EXAMPLE
cp PN_time_hard_lccorr.fits /data/scratch3/steff/IRAS13224-3809/0673580301_0.3-4k/seg1
cp PN_time_soft_lccorr.fits /data/scratch3/steff/IRAS13224-3809/0673580301_0.3-4k/seg1

#Change to segs directory
cd /data/scratch3/steff/IRAS13224-3809/0673580301_0.3-4k/seg1

# Rename these files as the output file needs to be the same name
mv PN_time_hard_lccorr.fits PN_time_hard_lccorr_full.fits
mv PN_time_soft_lccorr.fits PN_time_soft_lccorr_full.fits


# Filter by the appropriate time
evselect table=PN_time_soft_lccorr_full.fits withfilteredset=yes filteredset=PN_time_soft_lccorr.fits filtertype=expression  expression='TIME in [428010000:428030000]' keepfilteroutput=yes updateexposure=yes
evselect table=PN_time_hard_lccorr_full.fits withfilteredset=yes filteredset=PN_time_hard_lccorr.fits filtertype=expression  expression='TIME in [428010000:428030000]' keepfilteroutput=yes updateexposure=yes

# Plot the light curve
dsplot table=PN_time_soft_lccorr.fits x=TIME y=RATE &
dsplot table=PN_time_hard_lccorr.fits x=TIME y=RATE &


#+END_EXAMPLE

** OBS 0673580401 (2011) 113 ks

First lets look at the spectra:

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_Spectra_0673580401.gif

data flux(1,0.3,10)
1.7185331928512603e-14
3.5318228826049235e-12
3.5083754160885735e-05
0.0032945523486960187


Use script =/homeb/steff075/phd_ecm/IRAS13224-3809/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,5.160719e+02,2.672399e+02
1.388430e-04,-8.720117e+01,2.000757e+02
2.650639e-04,-2.399313e+02,5.070954e+01
5.060310e-04,-9.411921e+01,3.568659e+01
9.660592e-04,-2.980652e+01,1.714381e+01
1.844295e-03,-1.815670e+01,8.457213e+00
3.520927e-03,-2.614260e+01,2.065788e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0673580401_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-38091_0673580401_time_lags.fits");
r=load_rmf("IRAS13224-3809_0673580401_time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

*** Segment analysis

PATH = =/data/scratch3/steff/IRAS13224-3809/0673580101/PROC=

Initiate sas

#+BEGIN_EXAMPLE
heainit
setsas
setenv SAS_CCFPATH /usr/local/XMM/ccf/
setenv SAS_ODF /data/scratch3/steff/IRAS13224-3809/0673580401/ODF
setenv SAS_CCF ccf.cif
#+END_EXAMPLE

Obtain lightcurve time

Make the lightcurve


#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withrateset=yes rateset=EPICclean_lc.fits maketimecolumn=yes timebinsize=100 makeratecolumn=yes

dsplot table=EPICclean_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

The table ran from 428293000 to 428405000 giving a total time of
112000s. (5 x 22400ks segments)

seg1 428293000:428315400
seg2 428315400:428337800
seg3 428337800:428360200
seg4 428360200:428382600
seg5 428382600:428405000

#Copy Background Subtracted Light Curve to make the lightcurves with time above periods


#+BEGIN_EXAMPLE
cp PN_time_hard_lccorr.fits /data/scratch3/steff/IRAS13224-3809/0673580401_0.3-4k/seg1
cp PN_time_soft_lccorr.fits /data/scratch3/steff/IRAS13224-3809/0673580401_0.3-4k/seg1

#Change to segs directory
cd /data/scratch3/steff/IRAS13224-3809/0673580401_0.3-4k/seg1

# Rename these files as the output file needs to be the same name
mv PN_time_hard_lccorr.fits PN_time_hard_lccorr_full.fits
mv PN_time_soft_lccorr.fits PN_time_soft_lccorr_full.fits


# Filter by the appropriate time
evselect table=PN_time_soft_lccorr_full.fits withfilteredset=yes filteredset=PN_time_soft_lccorr.fits filtertype=expression  expression='TIME in [428382600:428405000]' keepfilteroutput=yes updateexposure=yes
evselect table=PN_time_hard_lccorr_full.fits withfilteredset=yes filteredset=PN_time_hard_lccorr.fits filtertype=expression  expression='TIME in [428382600:428405000]' keepfilteroutput=yes updateexposure=yes

# Plot the light curve
dsplot table=PN_time_soft_lccorr.fits x=TIME y=RATE &
dsplot table=PN_time_hard_lccorr.fits x=TIME y=RATE &

#+END_EXAMPLE

** OBS 0780560101 (2016) 141.3 (34) ks

*** Preprocessing

First ensure that the cshrc file ponts to the current version of
SAS and then resource the cshrc file:

#+BEGIN_EXAMPLE
setenv SAS_DIR /usr/local/xmmsas_20190531_1155
source /usr/local/xmmsas_20190531_1155/sas-setup.csh
source ~/.cshrc
#+END_EXAMPLE

PATH =/data/scratch3/steff/IRAS13224-3809/0780560101/ODF=

#+BEGIN_EXAMPLE
#### ODF dir

tar -zxvf 0780560101.tar.gz
tar xvf "the TAR file"

heainit
setsas
setenv SAS_CCFPATH /usr/local/XMM/ccf/
setenv SAS_ODF /data/scratch3/steff/IRAS13224-3809/ "Current ODF dir"
cifbuild
setenv SAS_CCF ccf.cif
odfingest

setenv SAS_ODF /data/scratch3/steff/IRAS13224-3809/"SUMSAS File"

cp ccf.cif /data/scratch3/steff/IRAS13224-3809/Obs ID"/PROC"

cp SUMSAS PROC

######   Move to PROC directory

setenv SAS_ODF /data/scratch3/steff/IRAS13224-3809/ "ODF Dir" / "SUMSAS file"

epproc randomizetime=no randomizeposition=no randomizeenergy=no

cp ImagingEvts.ds EPIC.fits

#+END_EXAMPLE

*** Create light curve 10-12 keV

*Must use mensa machine for dsplot*

#+BEGIN_EXAMPLE
evselect table=EPIC.fits withrateset=yes rateset=EPIC_flares_lc.fits maketimecolumn=yes timebinsize=100 makeratecolumn=yes expression='#XMMEA_EP && (PI>10000&&PI<12000) && (PATTERN==0)'

dsplot table=EPIC_flares_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

Table start = 5.84482e+08
Table stop = 5.84534e+08

Time = 61000s

*** Create image file from xmgrace

#+BEGIN_EXAMPLE
    Open the menu File -> Print setup. There you can choose the desired graphics format in the Device pulldown

    Output:
    Slecet the 'print to file' check box
    Enter filename e.g: IRAS_0780560101_EPIC_flares.ps

    Confirm your changes with the Accept button.
    Open the menu File -> Print … this will save the file with the filename chosen above.
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS_0780560101_EPIC_flares.png

*** Select source & background and run post-processing script

Note - no flaring regions were removed

To save disk space rename  EPIC.fits to EPICclean.fits

#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withimageset=yes imageset=EPICclean_image.fits xcolumn=X ycolumn=Y imagebinning=imageSize ximagesize=600 yimagesize=600

ds9 EPICclean_image.fits &
#+END_EXAMPLE

Once image is showing select

Scale = log

Bin = Block 16

Zoom = Zoom 2

*Select regions*

=Source = 26535,27840,700=

=Background = 29102,22968,700=

*Post-processing & check pileup*

Enter source & background regions and run script
=sas_postproc_script.sl=

*** Create lightcurves (optional)

#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withrateset=yes rateset=0780560101_0.3-10keV.fits maketimecolumn=yes timebinsize=300 makeratecolumn=yes expression='(FLAG==0)&&(PATTERN<=4)&&(PI in [300:10000])&&#XMMEA_EP'

dsplot table=0780560101_0.3-10keV.fits x=TIME y=RATE ymin=0 &
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/0780560101_0.3-10keV.jpg

*** Group Spectral files

#+BEGIN_EXAMPLE
grppha
PN_time_0.3-10_src_pi.fits
PN_time_0.3-10_pi_grp.fits
chkey BACKFILE PN_time_0.3-10_bkg_pi.fits
chkey RESPFILE PN_time_0.3-10_src_pi_rmf.fits
chkey ANCRFILE PN_time_0.3-10_src_pi_arf.fits
group min 25
exit


#+END_EXAMPLE

*** Plot spectrum

#+BEGIN_EXAMPLE
isis
d=load_data("PN_time_0.3-10_pi_grp.fits");
r=load_rmf("PN_time_0.3-10_src_pi_rmf.fits");
a=load_arf("PN_time_0.3-10_src_pi_arf.fits");
assign_rsp(a,r,d);
define_back(d, "PN_time_0.3-10_bkg_pi.fits");
fit_fun("powerlaw");
rebin_data(1, 10);
xnotice_en(d, 1.0, 10.0);
set_par(2, 2.0);
fancy_plot_unit(“keV”);
()=fit_counts;
popt.xrange = [1.0, 10.0];
popt.yrange = [1.0E-4, 1.0, -10.0, 10.0];
popt.dsym = 1;
popt.res = 1;
xlog;
ylog;
title ("IRAS13224-3809 0780560101 Spectrum");
%open_plot("IRAS13224-3809_0780560101_Spectrum.gif/gif");
plot_data(d, popt; dsym=1);
fit;
()=eval_counts;
plot_data(d,popt);
%close_plot;


 list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0     451/  586   2   2  6.8267e+04    31.859
file:  PN_time_0.3-10_pi_grp.fits
back:  PN_time_0.3-10_bkg_pi.fits

isis> data_flux(1,0.3,10);
4.2252086554649005e-14
3.5461933857805704e-12
6.827513442286744e-05
0.003503179118548581

list_par;
powerlaw
 idx  param             tie-to  freeze         value         min         max
  1  powerlaw(1).norm       0     0     0.0003482752           0       1e+10
  2  powerlaw(1).PhoIndex   0     0         2.946094          -2           9

#+END_EXAMPLE


#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0780560101_Spectrum.gif

*** Lag-frequency

Plot =lagfreq_script.sl=

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0780560101_lagfreq.gif

*** Segment analysis

PATH = =/data/scratch3/steff/IRAS13224-3809/0780560101/PROC=

Initiate sas

#+BEGIN_EXAMPLE
heainit
setsas
setenv SAS_CCFPATH /usr/local/XMM/ccf/
setenv SAS_ODF /data/scratch3/steff/IRAS13224-3809/0780560101/ODF
setenv SAS_CCF ccf.cif
#+END_EXAMPLE

Copy the soft and hard corrected lccorr

#+BEGIN_EXAMPLE
dsplot table=EPICclean_lc.fits x=TIME y=RATE &
#+END_EXAMPLE


Obtain lightcurve time


584397000 to 584431000 otal 34000 s

584397000:584417000


#Copy Background Subtracted Light Curve to make the lightcurves with time above periods


#+BEGIN_EXAMPLE
cp PN_time_hard_lccorr.fits /data/scratch3/steff/IRAS13224-3809/0780560101_0.3-4k/seg1
cp PN_time_soft_lccorr.fits /data/scratch3/steff/IRAS13224-3809/0780560101_0.3-4k/seg1

#Change to segs directory
cd /data/scratch3/steff/IRAS13224-3809/0780561301_0.3-4k/seg1

# Rename these files as the output file needs to be the same name
mv PN_time_hard_lccorr.fits PN_time_hard_lccorr_full.fits
mv PN_time_soft_lccorr.fits PN_time_soft_lccorr_full.fits


# Filter by the appropriate time
evselect table=PN_time_soft_lccorr_full.fits withfilteredset=yes filteredset=PN_time_soft_lccorr.fits filtertype=expression  expression='TIME in [584397000:584417000]' keepfilteroutput=yes updateexposure=yes
evselect table=PN_time_hard_lccorr_full.fits withfilteredset=yes filteredset=PN_time_hard_lccorr.fits filtertype=expression  expression='TIME in [584397000:584417000]' keepfilteroutput=yes updateexposure=yes

# Plot the light curve
dsplot table=PN_time_soft_lccorr.fits x=TIME y=RATE &
dsplot table=PN_time_soft_lccorr.fits x=TIME y=RATE &

#+END_EXAMPLE

** OBS 0780561301 (2016) 141.0 (127) ks

PATH =/data/scratch3/steff/IRAS13224-3809/0780561301/ODF=

Repeat Pre-Processing above
*** Create light curve 10-12 keV

*Must use mensa machine for dsplot*

#+BEGIN_EXAMPLE
evselect table=EPIC.fits withrateset=yes rateset=EPIC_flares_lc.fits maketimecolumn=yes timebinsize=100 makeratecolumn=yes expression='#XMMEA_EP && (PI>10000&&PI<12000) && (PATTERN==0)'

dsplot table=EPIC_flares_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

*** Create image file from xmgrace

#+BEGIN_EXAMPLE
    Open the menu File -> Print setup. There you can choose the desired graphics format in the Device pulldown

    Output:
    Slecet the 'print to file' check box
    Enter filename e.g: IRAS_0780561301_EPIC_flares.ps

    Confirm your changes with the Accept button.
    Open the menu File -> Print … this will save the file with the filename chosen above.
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS_0780561301_EPIC_flares.jpg

*** Remove flared region

 The table ran from 5.84569E+8 to 5.84703E+8 giving a total time of
134000s. Removed the flares from 584696000 to 584703000 to create an effective time observation of 127,000s

This was done by:

#+BEGIN_EXAMPLE
evselect table=EPIC.fits withfilteredset=yes filteredset=EPICclean.fits filtertype=expression  expression='TIME in [5.84569E+08:5.84696E+08]' keepfilteroutput=yes updateexposure=yes
#+END_EXAMPLE

 Then a filtered lightcurve was created (note min and max times required to fit the data):

Recreate the table as =EPICclean_lc.fits=

#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withrateset=yes rateset=EPICclean_lc.fits maketimecolumn=yes timebinsize=100 makeratecolumn=yes

dsplot table=EPICclean_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS_0780561301_EPICclean_lc.jpg

*** Select source & background and run post-processing script

#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withimageset=yes imageset=EPICclean_image.fits xcolumn=X ycolumn=Y imagebinning=imageSize ximagesize=600 yimagesize=600

ds9 EPICclean_image.fits &
#+END_EXAMPLE

Once image is showing select

Scale = log

Bin = Block 16

Zoom = Zoom 2

*Select regions*

=Source = 26623,27884,700=

=Background = 27536,21837,700=

*Post-processing & check pileup*

Enter source & background regions and run script
=sas_postproc_script.sl=

*** Create lightcurves (optional)


#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withrateset=yes rateset=0780561301_0.3-10keV.fits maketimecolumn=yes timebinsize=300 makeratecolumn=yes expression='(FLAG==0)&&(PATTERN<=4)&&(PI in [300:10000])&&#XMMEA_EP'

dsplot table=0780561301_0.3-10keV.fits x=TIME y=RATE ymin=0 xmax=584696000 &
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/0780561301_0.3-10keV.jpg

*** Group Spectral files

#+BEGIN_EXAMPLE
grppha
PN_time_0.3-10_src_pi.fits
PN_time_0.3-10_pi_grp.fits
chkey BACKFILE PN_time_0.3-10_bkg_pi.fits
chkey RESPFILE PN_time_0.3-10_src_pi_rmf.fits
chkey ANCRFILE PN_time_0.3-10_src_pi_arf.fits
group min 25
exit


#+END_EXAMPLE

*** Plot spectrum

#+BEGIN_EXAMPLE
isis
d=load_data("PN_time_0.3-10_pi_grp.fits");
r=load_rmf("PN_time_0.3-10_src_pi_rmf.fits");
a=load_arf("PN_time_0.3-10_src_pi_arf.fits");
assign_rsp(a,r,d);
define_back(d, "PN_time_0.3-10_bkg_pi.fits");
fit_fun("powerlaw");
rebin_data(1, 10);
xnotice_en(d, 1.0, 10.0);
set_par(2, 2.0);
fancy_plot_unit(“keV”);
()=fit_counts;
popt.xrange = [1.0, 10.0];
popt.yrange = [1.0E-4, 1.0, -10.0, 10.0];
popt.dsym = 1;
popt.res = 1;
xlog;
ylog;
title ("IRAS13224-3809 0780561301 Spectrum");
%open_plot("IRAS13224-3809_0780561301_Spectrum.gif/gif");
plot_data(d, popt; dsym=1);
fit;
()=eval_counts;
plot_data(d,popt);
%close_plot;

list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0     775/  910   2   2  2.8064e+05   117.957
file:  PN_time_0.3-10_pi_grp.fits
back:  PN_time_0.3-10_bkg_pi.fits

data_flux(1,0.3,10);
1.5133168058642416e-14
4.017620788414124e-12
3.5623345264104695e-05
0.003828311630357958


list_par;
 idx  param             tie-to  freeze         value         min         max
  1  powerlaw(1).norm       0     0     0.0006465204           0       1e+10
  2  powerlaw(1).PhoIndex   0     0         3.037008          -2           9
#+END_EXAMPLE


#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0780561301_Spectrum.gif

*** Lag-frequency

Plot =lagfreq_script.sl=

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0780561301_lagfreq.gif

*** Segment analysis

PATH = =/data/scratch3/steff/IRAS13224-3809/0780561301/PROC=

Initiate sas

#+BEGIN_EXAMPLE
heainit
setsas
setenv SAS_CCFPATH /usr/local/XMM/ccf/
setenv SAS_ODF /data/scratch3/steff/IRAS13224-3809/0780561301/ODF
setenv SAS_CCF ccf.cif
#+END_EXAMPLE

Obtain lightcurve time

#+BEGIN_EXAMPLE
dsplot table=EPICclean.fits x=TIME y=RATE &
#+END_EXAMPLE

Start = 5.84569e+08
Stop = 5.84696e+08

Time = 127,000s = 6 segs

seg1 584569000:584589000
seg2 584589000:584609000
seg3 584609000:584629000
seg4 584629000:584649000
seg5 584649000:584669000
seg6 584669000:584689000

#Copy Background Subtracted Light Curve to make the lightcurves with time above periods


#+BEGIN_EXAMPLE
cp PN_time_hard_lccorr.fits /data/scratch3/steff/IRAS13224-3809/0780561301_0.3-4k/seg1
cp PN_time_soft_lccorr.fits /data/scratch3/steff/IRAS13224-3809/0780561301_0.3-4k/seg1

#Change to segs directory
cd /data/scratch3/steff/IRAS13224-3809/0780561301_0.3-4k/seg1

# Rename these files as the output file needs to be the same name
mv PN_time_hard_lccorr.fits PN_time_hard_lccorr_full.fits
mv PN_time_soft_lccorr.fits PN_time_soft_lccorr_full.fits

# Filter by the appropriate time
evselect table=PN_time_soft_lccorr_full.fits withfilteredset=yes filteredset=PN_time_soft_lccorr.fits filtertype=expression  expression='TIME in [584669000:584689000]' keepfilteroutput=yes updateexposure=yes
evselect table=PN_time_hard_lccorr_full.fits withfilteredset=yes filteredset=PN_time_hard_lccorr.fits filtertype=expression  expression='TIME in []' keepfilteroutput=yes updateexposure=yes

# Plot the light curve
dsplot table=PN_time_soft_lccorr.fits x=TIME y=RATE &


#+END_EXAMPLE

** OBS 0780561401 (2016) 138.1 (86) ks

Repeat Pre-Processing above

*** Create light curve 10-12 keV

*Must use mensa machine for dsplot*

#+BEGIN_EXAMPLE
evselect table=EPIC.fits withrateset=yes rateset=EPIC_flares_lc.fits maketimecolumn=yes timebinsize=100 makeratecolumn=yes expression='#XMMEA_EP && (PI>10000&&PI<12000) && (PATTERN==0)'

dsplot table=EPIC_flares_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

*** Create image file from xmgrace

#+BEGIN_EXAMPLE
    Open the menu File -> Print setup. There you can choose the desired graphics format in the Device pulldown

    Output:
    Slecet the 'print to file' check box
    Enter filename e.g: IRAS_0780561301_EPIC_flares.ps

    Confirm your changes with the Accept button.
    Open the menu File -> Print … this will save the file with the filename chosen above.
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS_0780561401_flares_lc.jpg

*** Remove flared region

 The table ran from 5.84741E+8 to 5.84827E+8 giving a total time of
134000s. Removed the flares from 584741000 to 584745000 to create an effective time observation of 127,000s

This was done by:

#+BEGIN_EXAMPLE
evselect table=EPIC.fits withfilteredset=yes filteredset=EPICclean.fits filtertype=expression  expression='TIME in [584745000:5.84827E+8]' keepfilteroutput=yes updateexposure=yes
#+END_EXAMPLE

 Then a filtered lightcurve was created (note min and max times required to fit the data):

Recreate the table as =EPICclean_lc.fits=

#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withrateset=yes rateset=EPICclean_lc.fits maketimecolumn=yes timebinsize=100 makeratecolumn=yes timemin=584745000 timemax=5.84827E+8

dsplot table=EPICclean_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS_0780561401_EPICclean_lc.jpg

*** Select source & background and run post-processing script

#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withimageset=yes imageset=EPICclean_image.fits xcolumn=X ycolumn=Y imagebinning=imageSize ximagesize=600 yimagesize=600

ds9 EPICclean_image.fits &
#+END_EXAMPLE

Once image is showing select

Scale = log

Bin = Block 16

Zoom = Zoom 2

*Select regions*

=Source = 27057,27623,700=

=Background = 29275,21576,700=

*Post-processing & check pileup*

Enter source & background regions and run script
=sas_postproc_script.sl=

*** Create lightcurves (optional)

#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withrateset=yes rateset=0780561401_0.3-10keV.fits maketimecolumn=yes timebinsize=300 makeratecolumn=yes expression='(FLAG==0)&&(PATTERN<=4)&&(PI in [300:10000])&&#XMMEA_EP'

dsplot table=0780561401_0.3-10keV.fits x=TIME y=RATE ymin=0 xmin=584745000 &
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/0780561401_0.3-10keV.jpg

*** Group Spectral files

#+BEGIN_EXAMPLE
grppha
PN_time_0.3-10_src_pi.fits
PN_time_0.3-10_pi_grp.fits
chkey BACKFILE PN_time_0.3-10_bkg_pi.fits
chkey RESPFILE PN_time_0.3-10_src_pi_rmf.fits
chkey ANCRFILE PN_time_0.3-10_src_pi_arf.fits
group min 25
exit


#+END_EXAMPLE

*** Plot spectrum

#+BEGIN_EXAMPLE
isis
d=load_data("PN_time_0.3-10_pi_grp.fits");
r=load_rmf("PN_time_0.3-10_src_pi_rmf.fits");
a=load_arf("PN_time_0.3-10_src_pi_arf.fits");
assign_rsp(a,r,d);
define_back(d, "PN_time_0.3-10_bkg_pi.fits");
fit_fun("powerlaw");
rebin_data(1, 10);
xnotice_en(d, 1.0, 10.0);
set_par(2, 2.0);
fancy_plot_unit(“keV”);
()=fit_counts;
popt.xrange = [1.0, 10.0];
popt.yrange = [1.0E-4, 1.0, -10.0, 10.0];
popt.dsym = 1;
popt.res = 1;
xlog;
ylog;
title ("IRAS13224-3809 0780561401 Spectrum");
%open_plot("IRAS13224-3809_0780561401_Spectrum.gif/gif");
plot_data(d, popt; dsym=1);
fit;
()=eval_counts;
plot_data(d,popt);
%close_plot;

list_data;
data_flux(1,0.3,10);
list_par;

list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0     679/  814   2   2  2.1072e+05    76.210
file:  PN_time_0.3-10_pi_grp.fits
back:  PN_time_0.3-10_bkg_pi.fits

isis> data_flux(1,0.3,10);
2.0886177904814974e-14
4.6838872346775085e-12
4.914718539536792e-05
0.004473697692841161

isis> list_par;
powerlaw
 idx  param             tie-to  freeze         value         min         max
  1  powerlaw(1).norm       0     0     0.0006783619           0       1e+10
  2  powerlaw(1).PhoIndex   0     0         2.931882          -2           9
#+END_EXAMPLE


#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0780561401_Spectrum.gif

*** Lag-frequency

Plot =lagfreq_script.sl=

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_lagfreq_0780561401.gif

*** Segment analysis

PATH = =/data/scratch3/steff/IRAS13224-3809/0780561301/PROC=

Initiate sas

#+BEGIN_EXAMPLE
heainit
setsas
setenv SAS_CCFPATH /usr/local/XMM/ccf/
setenv SAS_ODF /data/scratch3/steff/IRAS13224-3809/0780561401/ODF
setenv SAS_CCF ccf.cif
#+END_EXAMPLE

Obtain lightcurve time

#+BEGIN_EXAMPLE
dsplot table=EPICclean_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

The table ran from 5.84745E+8 to 5.84827E+8 giving a total time of 86000s.

Start =
Stop =

Time = 127,000s = 6 segs

seg1 584745000:584765000
seg2 584765000:584785000
seg3 584785000:584805000
seg4 584805000:584825000


#Copy Background Subtracted Light Curve to make the lightcurves with time above periods


#+BEGIN_EXAMPLE
cp PN_time_hard_lccorr.fits /data/scratch3/steff/IRAS13224-3809/0780561401_0.3-4k/seg1
cp PN_time_soft_lccorr.fits /data/scratch3/steff/IRAS13224-3809/0780561401_0.3-4k/seg1

#Change to segs directory
cd /data/scratch3/steff/IRAS13224-3809/0780561401_0.3-4k/seg1

# Rename these files as the output file needs to be the same name
mv PN_time_hard_lccorr.fits PN_time_hard_lccorr_full.fits
mv PN_time_soft_lccorr.fits PN_time_soft_lccorr_full.fits

# Filter by the appropriate time
evselect table=PN_time_soft_lccorr_full.fits withfilteredset=yes filteredset=PN_time_soft_lccorr.fits filtertype=expression  expression='TIME in [584805000:584825000]' keepfilteroutput=yes updateexposure=yes
evselect table=PN_time_hard_lccorr_full.fits withfilteredset=yes filteredset=PN_time_hard_lccorr.fits filtertype=expression  expression='TIME in [584805000:584825000]' keepfilteroutput=yes updateexposure=yes

# Plot the light curve
dsplot table=PN_time_soft_lccorr.fits x=TIME y=RATE &
dsplot table=PN_time_hard_lccorr.fits x=TIME y=RATE &

#+END_EXAMPLE

** OBS 0780561501 (2016) 140.8 (126) ks

Repeat Pre-Processing above

*** Create light curve 10-12 keV

*Must use mensa machine for dsplot*

#+BEGIN_EXAMPLE
evselect table=EPIC.fits withrateset=yes rateset=EPIC_flares_lc.fits maketimecolumn=yes timebinsize=100 makeratecolumn=yes expression='#XMMEA_EP && (PI>10000&&PI<12000) && (PATTERN==0)'

dsplot table=EPIC_flares_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

*** Create image file from xmgrace

#+BEGIN_EXAMPLE
    Open the menu File -> Print setup. There you can choose the desired graphics format in the Device pulldown

    Output:
    Slecet the 'print to file' check box
    Enter filename e.g: IRAS_0780561501_EPIC_flares.ps

    Confirm your changes with the Accept button.
    Open the menu File -> Print … this will save the file with the filename chosen above.
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS_0780561501_flares_lc.jpg

*** Remove flared region

 The table ran from 5.8543E+8 to 5.85568E+8. Remove the flares from
 beginning and end to create an effective time observation of 126,000s

This was done by:

#+BEGIN_EXAMPLE
evselect table=EPIC.fits withfilteredset=yes filteredset=EPICclean.fits filtertype=expression  expression='TIME in [585438000:585564000]' keepfilteroutput=yes updateexposure=yes
#+END_EXAMPLE

 Then a filtered lightcurve was created (note min and max times required to fit the data):

Recreate the table as =EPICclean_lc.fits=

#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withrateset=yes rateset=EPICclean_lc.fits maketimecolumn=yes timebinsize=100 makeratecolumn=yes timemin=585438000 timemax=585564000

dsplot table=EPICclean_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS_0780561501_EPICclean_lc.jpg

*** Select source & background and run post-processing script

#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withimageset=yes imageset=EPICclean_image.fits xcolumn=X ycolumn=Y imagebinning=imageSize ximagesize=600 yimagesize=600

ds9 EPICclean_image.fits &
#+END_EXAMPLE

Once image is showing select

Scale = log

Bin = Block 16

Zoom = Zoom 2

*Select regions*

=Source = 26405,27927,700=

=Background = 27710,22011,700=

*Post-processing & check pileup*

Enter source & background regions and run script
=sas_postproc_script.sl=

*** Create lightcurves (optional)

#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withrateset=yes rateset=0780561501_0.3-10keV.fits maketimecolumn=yes timebinsize=300 makeratecolumn=yes expression='(FLAG==0)&&(PATTERN<=4)&&(PI in [300:10000])&&#XMMEA_EP'

dsplot table=0780561501_0.3-10keV.fits x=TIME y=RATE ymin=0 xmin=585439000 xmax=585564000 &
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/0780561501_0.3-10keV.jpg

*** Group Spectral files

#+BEGIN_EXAMPLE
grppha
PN_time_0.3-10_src_pi.fits
PN_time_0.3-10_pi_grp.fits
chkey BACKFILE PN_time_0.3-10_bkg_pi.fits
chkey RESPFILE PN_time_0.3-10_src_pi_rmf.fits
chkey ANCRFILE PN_time_0.3-10_src_pi_arf.fits
group min 25
exit


#+END_EXAMPLE

*** Plot spectrum

#+BEGIN_EXAMPLE
isis
d=load_data("PN_time_0.3-10_pi_grp.fits");
r=load_rmf("PN_time_0.3-10_src_pi_rmf.fits");
a=load_arf("PN_time_0.3-10_src_pi_arf.fits");
assign_rsp(a,r,d);
define_back(d, "PN_time_0.3-10_bkg_pi.fits");
fit_fun("powerlaw");
rebin_data(1, 10);
xnotice_en(d, 1.0, 10.0);
set_par(2, 2.0);
fancy_plot_unit(“keV”);
()=fit_counts;
popt.xrange = [1.0, 10.0];
popt.yrange = [1.0E-4, 1.0, -10.0, 10.0];
popt.dsym = 1;
popt.res = 1;
xlog;
ylog;
title ("IRAS13224-3809 0780561501 Spectrum");
%open_plot("IRAS13224-3809_0780561501_Spectrum.gif/gif");
plot_data(d, popt; dsym=1);
fit;
()=eval_counts;
plot_data(d,popt);
%close_plot;

list_data;
data_flux(1,0.3,10);
list_par;

 list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0     626/  761   2   2  1.7607e+05   117.074
file:  PN_time_0.3-10_pi_grp.fits
back:  PN_time_0.3-10_bkg_pi.fits

isis> data_flux(1,0.3,10);
1.335137353572689e-14
2.5130001710619975e-12
2.96102299642517e-05
0.002492023511362602

isis> list_par;
powerlaw
 idx  param             tie-to  freeze         value         min         max
  1  powerlaw(1).norm       0     0     0.0002520022           0       1e+10
  2  powerlaw(1).PhoIndex   0     0         2.772068          -2           9
#+END_EXAMPLE


#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0780561501_Spectrum.gif

*** Lag-frequency

Plot =lagfreq_script.sl=

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0780561501_lagfreq.gif

*** Segment analysis

PATH = =/data/scratch3/steff/IRAS13224-3809/0780561501/PROC=

Initiate sas

#+BEGIN_EXAMPLE
heainit
setsas
setenv SAS_CCFPATH /usr/local/XMM/ccf/
setenv SAS_ODF /data/scratch3/steff/IRAS13224-3809/0780561501/ODF
setenv SAS_CCF ccf.cif
#+END_EXAMPLE

Obtain lightcurve time

#+BEGIN_EXAMPLE
dsplot table=EPICclean_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

The table ran from 585438000 to 585564000 giving a total time of 126000s.

seg1 585438000:585458000
seg2 585458000:585478000
seg3 585478000:585498000
seg4 585498000:585518000
seg5 585518000:585538000
seg6 585538000:585558000


#Copy Background Subtracted Light Curve to make the lightcurves with time above periods


#+BEGIN_EXAMPLE
cp PN_time_hard_lccorr.fits /data/scratch3/steff/IRAS13224-3809/0780561501_0.3-4k/seg1
cp PN_time_soft_lccorr.fits /data/scratch3/steff/IRAS13224-3809/0780561501_0.3-4k/seg1

#Change to segs directory
cd /data/scratch3/steff/IRAS13224-3809/0780561401_0.3-4k/seg1

# Rename these files as the output file needs to be the same name
mv PN_time_hard_lccorr.fits PN_time_hard_lccorr_full.fits
mv PN_time_soft_lccorr.fits PN_time_soft_lccorr_full.fits

# Filter by the appropriate time
evselect table=PN_time_soft_lccorr_full.fits withfilteredset=yes filteredset=PN_time_soft_lccorr.fits filtertype=expression  expression='TIME in [585538000:585558000]' keepfilteroutput=yes updateexposure=yes
evselect table=PN_time_hard_lccorr_full.fits withfilteredset=yes filteredset=PN_time_hard_lccorr.fits filtertype=expression  expression='TIME in [585538000:585558000]' keepfilteroutput=yes updateexposure=yes

# Plot the light curve
dsplot table=PN_time_soft_lccorr.fits x=TIME y=RATE &
dsplot table=PN_time_hard_lccorr.fits x=TIME y=RATE &

#+END_EXAMPLE

** OBS 0780561601 (2016) 140.8 (127) ks

Repeat Pre-Processing above

*** Create light curve 10-12 keV

#+BEGIN_EXAMPLE
evselect table=EPIC.fits withrateset=yes rateset=EPIC_flares_lc.fits maketimecolumn=yes timebinsize=100 makeratecolumn=yes expression='#XMMEA_EP && (PI>10000&&PI<12000) && (PATTERN==0)'

dsplot table=EPIC_flares_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

*** Create image file from xmgrace

#+BEGIN_EXAMPLE
    Open the menu File -> Print setup. There you can choose the desired graphics format in the Device pulldown

    Output:
    Slecet the 'print to file' check box
    Enter filename e.g: IRAS_0780561601_EPIC_flares.ps

    Confirm your changes with the Accept button.
    Open the menu File -> Print … this will save the file with the filename chosen above.
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS_0780561601_flares_lc.jpg

*** Remove flared region

 The table ran from 5.85603+8 to 5.8574E+8. Remove the flares from the end
 beginning and end to create an effective time observation of 137,000s

This was done by:

#+BEGIN_EXAMPLE
evselect table=EPIC.fits withfilteredset=yes filteredset=EPICclean.fits filtertype=expression  expression='TIME in [585603000:585730000]' keepfilteroutput=yes updateexposure=yes
#+END_EXAMPLE

 Then a filtered lightcurve was created (note min and max times required to fit the data):

Recreate the table as =EPICclean_lc.fits=

#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withrateset=yes rateset=EPICclean_lc.fits maketimecolumn=yes timebinsize=100 makeratecolumn=yes timemin=585603000 timemax=585730000

dsplot table=EPICclean_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS_0780561601_EPICclean_lc.jpg

*** Select source & background and run post-processing script

#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withimageset=yes imageset=EPICclean_image.fits xcolumn=X ycolumn=Y imagebinning=imageSize ximagesize=600 yimagesize=600

ds9 EPICclean_image.fits &
#+END_EXAMPLE

Once image is showing select

Scale = log

Bin = Block 16

Zoom = Zoom 2

*Select regions*

=Source = 26361,27884,700=

=Background = 27709,21881,700=

*Post-processing & check pileup*

Enter source & background regions and run script
=sas_postproc_script.sl=

*** Create lightcurves (optional)

#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withrateset=yes rateset=0780561601_0.3-10keV.fits maketimecolumn=yes timebinsize=300 makeratecolumn=yes expression='(FLAG==0)&&(PATTERN<=4)&&(PI in [300:10000])&&#XMMEA_EP'

dsplot table=0780561601_0.3-10keV.fits x=TIME y=RATE ymin=0 xmax=585730000 &
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/0780561601_0.3-10keV.jpg

*** Group Spectral files

#+BEGIN_EXAMPLE
grppha
PN_time_0.3-10_src_pi.fits
PN_time_0.3-10_pi_grp.fits
chkey BACKFILE PN_time_0.3-10_bkg_pi.fits
chkey RESPFILE PN_time_0.3-10_src_pi_rmf.fits
chkey ANCRFILE PN_time_0.3-10_src_pi_arf.fits
group min 25
exit


#+END_EXAMPLE

*** Plot spectrum

#+BEGIN_EXAMPLE
isis
d=load_data("PN_time_0.3-10_pi_grp.fits");
r=load_rmf("PN_time_0.3-10_src_pi_rmf.fits");
a=load_arf("PN_time_0.3-10_src_pi_arf.fits");
assign_rsp(a,r,d);
define_back(d, "PN_time_0.3-10_bkg_pi.fits");
fit_fun("powerlaw");
rebin_data(1, 10);
xnotice_en(d, 1.0, 10.0);
set_par(2, 2.0);
fancy_plot_unit(“keV”);
()=fit_counts;
popt.xrange = [1.0, 10.0];
popt.yrange = [1.0E-4, 1.0, -10.0, 10.0];
popt.dsym = 1;
popt.res = 1;
xlog;
ylog;
title ("IRAS13224-3809 0780561601 Spectrum");
%open_plot("IRAS13224-3809_0780561601_Spectrum.gif/gif");
plot_data(d, popt; dsym=1);
fit;
()=eval_counts;
plot_data(d,popt);
%close_plot;

list_data;
data_flux(1,0.3,10);
list_par;

Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0     894/ 1029   2   2  4.0806e+05   117.954
file:  PN_time_0.3-10_pi_grp.fits
back:  PN_time_0.3-10_bkg_pi.fits

isis> data_flux(1,0.3,10);
1.7964537401735668e-14
5.829550197623061e-12
4.345109700653729e-05
0.005584053601410913

isis> list_par;
powerlaw
 idx  param             tie-to  freeze         value         min         max
  1  powerlaw(1).norm       0     0      0.000933447           0       1e+10
  2  powerlaw(1).PhoIndex   0     0         3.043735          -2           9
#+END_EXAMPLE


#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0780561601_Spectrum.gif

*** Lag-frequency

Plot =lagfreq_script.sl=

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0780561601_lagfreq.gif

*** Segment analysis

PATH = =/data/scratch3/steff/IRAS13224-3809/0780561601/PROC=

Initiate sas

#+BEGIN_EXAMPLE
heainit
setsas
setenv SAS_CCFPATH /usr/local/XMM/ccf/
setenv SAS_ODF /data/scratch3/steff/IRAS13224-3809/0780561601/ODF
setenv SAS_CCF ccf.cif
#+END_EXAMPLE

Obtain lightcurve time

#+BEGIN_EXAMPLE
dsplot table=EPICclean_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

The table ran from 585603000 to 585730000  giving a total time of 127000s.

seg1 585603000:585623000
seg2 585623000:585643000
seg3 585643000:585663000
seg4 585663000:585683000
seg5 585683000:585703000
seg6 585703000:585723000

#Copy Background Subtracted Light Curve to make the lightcurves with time above periods


#+BEGIN_EXAMPLE
cp PN_time_hard_lccorr.fits /data/scratch3/steff/IRAS13224-3809/0780561601_0.3-4k/seg1
cp PN_time_soft_lccorr.fits /data/scratch3/steff/IRAS13224-3809/0780561601_0.3-4k/seg1

#Change to segs directory
cd /data/scratch3/steff/IRAS13224-3809/0780561601_0.3-4k/seg1

# Rename these files as the output file needs to be the same name
mv PN_time_hard_lccorr.fits PN_time_hard_lccorr_full.fits
mv PN_time_soft_lccorr.fits PN_time_soft_lccorr_full.fits

# Filter by the appropriate time
evselect table=PN_time_soft_lccorr_full.fits withfilteredset=yes filteredset=PN_time_soft_lccorr.fits filtertype=expression  expression='TIME in [585603000:585623000]' keepfilteroutput=yes updateexposure=yes
evselect table=PN_time_hard_lccorr_full.fits withfilteredset=yes filteredset=PN_time_hard_lccorr.fits filtertype=expression  expression='TIME in [585603000:585623000]' keepfilteroutput=yes updateexposure=yes

# Plot the light curve
dsplot table=PN_time_soft_lccorr.fits x=TIME y=RATE &
dsplot table=PN_time_hard_lccorr.fits x=TIME y=RATE &


#+END_EXAMPLE

** OBS 0780561701 (2016) 140.8 (123) ks

Repeat Pre-Processing above

*** Create light curve 10-12 keV

#+BEGIN_EXAMPLE
evselect table=EPIC.fits withrateset=yes rateset=EPIC_flares_lc.fits maketimecolumn=yes timebinsize=100 makeratecolumn=yes expression='#XMMEA_EP && (PI>10000&&PI<12000) && (PATTERN==0)'

dsplot table=EPIC_flares_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

*** Create image file from xmgrace

#+BEGIN_EXAMPLE
    Open the menu File -> Print setup. There you can choose the desired graphics format in the Device pulldown

    Output:
    Slecet the 'print to file' check box
    Enter filename e.g: IRAS_0780561701_EPIC_flares.ps

    Confirm your changes with the Accept button.
    Open the menu File -> Print … this will save the file with the filename chosen above.
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS_0780561701_flares_lc.jpg

*** Remove flared region

 The table ran from 5.85775+8 to 5.85912E+8. Remove the flares from the
 beginning and end to create an effective time observation of 123,000s

This was done by:

#+BEGIN_EXAMPLE
evselect table=EPIC.fits withfilteredset=yes filteredset=EPICclean.fits filtertype=expression  expression='TIME in [585789000:585912000]' keepfilteroutput=yes updateexposure=yes
#+END_EXAMPLE

 Then a filtered lightcurve was created (note min and max times required to fit the data):

Recreate the table as =EPICclean_lc.fits=

#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withrateset=yes rateset=EPICclean_lc.fits maketimecolumn=yes timebinsize=100 makeratecolumn=yes timemin=585789000 timemax=585912000

dsplot table=EPICclean_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS_0780561701_EPICclean_lc.jpg

*** Select source & background and run post-processing script

#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withimageset=yes imageset=EPICclean_image.fits xcolumn=X ycolumn=Y imagebinning=imageSize ximagesize=600 yimagesize=600

ds9 EPICclean_image.fits &
#+END_EXAMPLE

Once image is showing select

Scale = log

Bin = Block 16

Zoom = Zoom 2

*Select regions*

=Source = 26405,27927,700=

=Background = 27884,22098,700=

*Post-processing & check pileup*

Enter source & background regions and run script
=sas_postproc_script.sl=

*** Create lightcurves (optional)


#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withrateset=yes rateset=0780561701_0.3-10keV.fits maketimecolumn=yes timebinsize=300 makeratecolumn=yes expression='(FLAG==0)&&(PATTERN<=4)&&(PI in [300:10000])&&#XMMEA_EP'

dsplot table=0780561701_0.3-10keV.fits x=TIME y=RATE ymin=0 &
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/0780561701_0.3-10keV.jpg

*** Group Spectral files

#+BEGIN_EXAMPLE
grppha
PN_time_0.3-10_src_pi.fits
PN_time_0.3-10_pi_grp.fits
chkey BACKFILE PN_time_0.3-10_bkg_pi.fits
chkey RESPFILE PN_time_0.3-10_src_pi_rmf.fits
chkey ANCRFILE PN_time_0.3-10_src_pi_arf.fits
group min 25
exit


#+END_EXAMPLE

*** Plot spectrum

#+BEGIN_EXAMPLE
isis
d=load_data("PN_time_0.3-10_pi_grp.fits");
r=load_rmf("PN_time_0.3-10_src_pi_rmf.fits");
a=load_arf("PN_time_0.3-10_src_pi_arf.fits");
assign_rsp(a,r,d);
define_back(d, "PN_time_0.3-10_bkg_pi.fits");
fit_fun("powerlaw");
rebin_data(1, 10);
xnotice_en(d, 1.0, 10.0);
set_par(2, 2.0);
fancy_plot_unit(“keV”);
()=fit_counts;
popt.xrange = [1.0, 10.0];
popt.yrange = [1.0E-4, 1.0, -10.0, 10.0];
popt.dsym = 1;
popt.res = 1;
xlog;
ylog;
title ("IRAS13224-3809 0780561701 Spectrum");
%open_plot("IRAS13224-3809_0780561701_Spectrum.gif/gif");
plot_data(d, popt; dsym=1);
fit;
()=eval_counts;
plot_data(d,popt);
%close_plot;

list_data;
data_flux(1,0.3,10);
list_par;

list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0     767/  902   2   2  2.2300e+05   127.117
file:  PN_time_0.3-10_pi_grp.fits
back:  PN_time_0.3-10_bkg_pi.fits

isis> data_flux(1,0.3,10);
1.4921721502477263e-14
2.9482461426126526e-12
2.9842291873398402e-05
0.0028521229672251198

isis> list_par;
powerlaw
 idx  param             tie-to  freeze         value         min         max
  1  powerlaw(1).norm       0     0     0.0003728823           0       1e+10
  2  powerlaw(1).PhoIndex   0     0         2.821118          -2           9


#+END_EXAMPLE


#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0780561701_Spectrum.gif

*** Lag-frequency

Plot =lagfreq_script.sl=

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0780561701_lagfreq.gif

*** Segment analysis

PATH = =/data/scratch3/steff/IRAS13224-3809/0780561701/PROC=

Initiate sas

#+BEGIN_EXAMPLE
heainit
setsas
setenv SAS_CCFPATH /usr/local/XMM/ccf/
setenv SAS_ODF /data/scratch3/steff/IRAS13224-3809/0780561701/ODF
setenv SAS_CCF ccf.cif
#+END_EXAMPLE

Obtain lightcurve time

#+BEGIN_EXAMPLE
dsplot table=EPICclean_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

The table ran from 585789000 to 585912000  giving a total time of 123000s.

seg1 585789000:585809000
seg2 585809000:585829000
seg3 585829000:585849000
seg4 585849000:585869000
seg5 585869000:585889000
seg6 585889000:585909000

#Copy Background Subtracted Light Curve to make the lightcurves with time above periods


#+BEGIN_EXAMPLE
cp PN_time_hard_lccorr.fits /data/scratch3/steff/IRAS13224-3809/0780561701_0.3-4k/seg1
cp PN_time_soft_lccorr.fits /data/scratch3/steff/IRAS13224-3809/0780561701_0.3-4k/seg1

#Change to segs directory
cd /data/scratch3/steff/IRAS13224-3809/0780561701_0.3-4k/seg1

# Rename these files as the output file needs to be the same name
mv PN_time_hard_lccorr.fits PN_time_hard_lccorr_full.fits
mv PN_time_soft_lccorr.fits PN_time_soft_lccorr_full.fits

# Filter by the appropriate time
evselect table=PN_time_soft_lccorr_full.fits withfilteredset=yes filteredset=PN_time_soft_lccorr.fits filtertype=expression  expression='TIME in [585889000:585909000]' keepfilteroutput=yes updateexposure=yes
evselect table=PN_time_hard_lccorr_full.fits withfilteredset=yes filteredset=PN_time_hard_lccorr.fits filtertype=expression  expression='TIME in [585889000:585909000]' keepfilteroutput=yes updateexposure=yes

# Plot the light curve
dsplot table=PN_time_soft_lccorr.fits x=TIME y=RATE &
dsplot table=PN_time_hard_lccorr.fits x=TIME y=RATE &


#+END_EXAMPLE

** OBS 0792180101 (2016) 141.0 (123) ks

Repeat Pre-Processing above

*** Create light curve 10-12 keV

#+BEGIN_EXAMPLE
evselect table=EPIC.fits withrateset=yes rateset=EPIC_flares_lc.fits maketimecolumn=yes timebinsize=100 makeratecolumn=yes expression='#XMMEA_EP && (PI>10000&&PI<12000) && (PATTERN==0)'

dsplot table=EPIC_flares_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

*** Create image file from xmgrace

#+BEGIN_EXAMPLE
    Open the menu File -> Print setup. There you can choose the desired graphics format in the Device pulldown

    Output:
    Slecet the 'print to file' check box
    Enter filename e.g: IRAS_0792180101_EPIC_flares.jpg

    Confirm your changes with the Accept button.
    Open the menu File -> Print … this will save the file with the filename chosen above.
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180101_flares_lc.jpg

*** Remove flared region

 Remove the flares from the beginning and end to create an effective time observation of 123,000s

This was done by:

#+BEGIN_EXAMPLE
evselect table=EPIC.fits withfilteredset=yes filteredset=EPICclean.fits filtertype=expression  expression='TIME in [585951000:586074000]' keepfilteroutput=yes updateexposure=yes
#+END_EXAMPLE

 Then a filtered lightcurve was created (note min and max times required to fit the data):

Recreate the table as =EPICclean_lc.fits=

#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withrateset=yes rateset=EPICclean_lc.fits maketimecolumn=yes timebinsize=100 makeratecolumn=yes timemin=585951000 timemax=586074000

dsplot table=EPICclean_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180101_EPICclean_lc.jpg

*** Select source & background and run post-processing script

#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withimageset=yes imageset=EPICclean_image.fits xcolumn=X ycolumn=Y imagebinning=imageSize ximagesize=600 yimagesize=600

ds9 EPICclean_image.fits &
#+END_EXAMPLE

Once image is showing select

Scale = log

Bin = Block 16

Zoom = Zoom 2

*Select regions*

=Source = 26318,27927,700=

=Background = 28014,22054,700=

*Post-processing & check pileup*

Enter source & background regions and run script
=sas_postproc_script.sl=

*** Create lightcurves (optional)


#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withrateset=yes rateset=0792180101_0.3-10keV.fits maketimecolumn=yes timebinsize=300 makeratecolumn=yes expression='(FLAG==0)&&(PATTERN<=4)&&(PI in [300:10000])&&#XMMEA_EP'

dsplot table=0792180101_0.3-10keV.fits x=TIME y=RATE ymin=0 xmin=585952000 xmax=586073000 &
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/0792180101_0.3-10keV.jpg


*** Group Spectral files

#+BEGIN_EXAMPLE
grppha
PN_time_0.3-10_src_pi.fits
PN_time_0.3-10_pi_grp.fits
chkey BACKFILE PN_time_0.3-10_bkg_pi.fits
chkey RESPFILE PN_time_0.3-10_src_pi_rmf.fits
chkey ANCRFILE PN_time_0.3-10_src_pi_arf.fits
group min 25
exit


#+END_EXAMPLE

*** Plot spectrum

#+BEGIN_EXAMPLE
isis
d=load_data("PN_time_0.3-10_pi_grp.fits");
r=load_rmf("PN_time_0.3-10_src_pi_rmf.fits");
a=load_arf("PN_time_0.3-10_src_pi_arf.fits");
assign_rsp(a,r,d);
define_back(d, "PN_time_0.3-10_bkg_pi.fits");
fit_fun("powerlaw");
rebin_data(1, 10);
xnotice_en(d, 1.0, 10.0);
set_par(2, 2.0);
fancy_plot_unit(“keV”);
()=fit_counts;
popt.xrange = [1.0, 10.0];
popt.yrange = [1.0E-4, 1.0, -10.0, 10.0];
popt.dsym = 1;
popt.res = 1;
xlog;
ylog;
title ("IRAS13224-3809 0792180101 Spectrum");
%open_plot("IRAS13224-3809_0792180101_Spectrum.gif/gif");
plot_data(d, popt; dsym=1);
fit;
()=eval_counts;
plot_data(d,popt);
%close_plot;

list_data;
data_flux(1,0.3,10);
list_par;

 list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0     643/  778   2   2  1.8324e+05   114.179
file:  PN_time_0.3-10_pi_grp.fits
back:  PN_time_0.3-10_bkg_pi.fits

isis> data_flux(1,0.3,10);
1.3391928363730183e-14
2.7017515177622354e-12
3.060169614217233e-05
0.0026353419761577642

isis> list_par;
powerlaw
 idx  param             tie-to  freeze         value         min         max
  1  powerlaw(1).norm       0     0     0.0002974296           0       1e+10
  2  powerlaw(1).PhoIndex   0     0          2.77296          -2           9

#+END_EXAMPLE


#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0792180101_Spectrum.gif

*** Lag-frequency

Plot =lagfreq_script.sl=

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0792180101_lagfreq.gif

*** Segment analysis

PATH = =/data/scratch3/steff/IRAS13224-3809/0792180101/PROC=

Initiate sas

#+BEGIN_EXAMPLE
heainit
setsas
setenv SAS_CCFPATH /usr/local/XMM/ccf/
setenv SAS_ODF /data/scratch3/steff/IRAS13224-3809/0792180101/ODF
setenv SAS_CCF ccf.cif
#+END_EXAMPLE

Obtain lightcurve time

#+BEGIN_EXAMPLE
dsplot table=EPICclean_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

The table ran from 585951000 to 586074000 giving a total time of 123000s.

seg1 585951000:585971000
seg2 585971000:585991000
seg3 585991000:586011000
seg4 586011000:586031000
seg5 586031000:586051000
seg6 586051000:586071000

#Copy Background Subtracted Light Curve to make the lightcurves with time above periods


#+BEGIN_EXAMPLE
cp PN_time_hard_lccorr.fits /data/scratch3/steff/IRAS13224-3809/0792180101_0.3-4k/seg1
cp PN_time_soft_lccorr.fits /data/scratch3/steff/IRAS13224-3809/0792180101_0.3-4k/seg1

#Change to segs directory
cd /data/scratch3/steff/IRAS13224-3809/0792180101_0.3-4k/seg1

# Rename these files as the output file needs to be the same name
mv PN_time_hard_lccorr.fits PN_time_hard_lccorr_full.fits
mv PN_time_soft_lccorr.fits PN_time_soft_lccorr_full.fits

# Filter by the appropriate time
evselect table=PN_time_soft_lccorr_full.fits withfilteredset=yes filteredset=PN_time_soft_lccorr.fits filtertype=expression  expression='TIME in [586051000:586071000]' keepfilteroutput=yes updateexposure=yes
evselect table=PN_time_hard_lccorr_full.fits withfilteredset=yes filteredset=PN_time_hard_lccorr.fits filtertype=expression  expression='TIME in [586051000:586071000]' keepfilteroutput=yes updateexposure=yes

# Plot the light curve
dsplot table=PN_time_soft_lccorr.fits x=TIME y=RATE &
dsplot table=PN_time_hard_lccorr.fits x=TIME y=RATE &


#+END_EXAMPLE

** OBS 0792180201 (2016) 140.5 (129) ks

Repeat Pre-Processing above

*** Create light curve 10-12 keV

#+BEGIN_EXAMPLE
evselect table=EPIC.fits withrateset=yes rateset=EPIC_flares_lc.fits maketimecolumn=yes timebinsize=100 makeratecolumn=yes expression='#XMMEA_EP && (PI>10000&&PI<12000) && (PATTERN==0)'

dsplot table=EPIC_flares_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

*** Create image file from xmgrace

#+BEGIN_EXAMPLE
    Open the menu File -> Print setup. There you can choose the desired graphics format in the Device pulldown

    Output:
    Slecet the 'print to file' check box
    Enter filename e.g: IRAS_0792180201_EPIC_flares.jpg

    Confirm your changes with the Accept button.
    Open the menu File -> Print … this will save the file with the filename chosen above.
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180201_flares_lc.jpg

*** Remove flared region

 Remove the flares from the beginning to create an effective time observation of 129,000s

This was done by:

#+BEGIN_EXAMPLE
evselect table=EPIC.fits withfilteredset=yes filteredset=EPICclean.fits filtertype=expression  expression='TIME in [586300000:586429000]' keepfilteroutput=yes updateexposure=yes
#+END_EXAMPLE

 Then a filtered lightcurve was created (note min and max times required to fit the data):

Recreate the table as =EPICclean_lc.fits=

#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withrateset=yes rateset=EPICclean_lc.fits maketimecolumn=yes timebinsize=100 makeratecolumn=yes timemin=586300000 timemax=586429000

dsplot table=EPICclean_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180201_EPICclean_lc.jpg

*** Select source & background and run post-processing script

#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withimageset=yes imageset=EPICclean_image.fits xcolumn=X ycolumn=Y imagebinning=imageSize ximagesize=600 yimagesize=600

ds9 EPICclean_image.fits &
#+END_EXAMPLE

Once image is showing select

Scale = log

Bin = Block 16

Zoom = Zoom 2

*Select regions*

=Source = 26274,27927,700=

=Background = 27970,22272,700=

*Post-processing & check pileup*

Enter source & background regions and run script
=sas_postproc_script.sl=

*** Create lightcurves (optional)

#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withrateset=yes rateset=0792180201_0.3-10keV.fits maketimecolumn=yes timebinsize=300 makeratecolumn=yes expression='(FLAG==0)&&(PATTERN<=4)&&(PI in [300:10000])&&#XMMEA_EP'

dsplot table=0792180201_0.3-10keV.fits x=TIME y=RATE ymin=0 xmin=586301000 &
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/0792180201_0.3-10keV.jpg

*** Group Spectral files

#+BEGIN_EXAMPLE
grppha
PN_time_0.3-10_src_pi.fits
PN_time_0.3-10_pi_grp.fits
chkey BACKFILE PN_time_0.3-10_bkg_pi.fits
chkey RESPFILE PN_time_0.3-10_src_pi_rmf.fits
chkey ANCRFILE PN_time_0.3-10_src_pi_arf.fits
group min 25
exit


#+END_EXAMPLE

*** Plot spectrum

#+BEGIN_EXAMPLE
isis
d=load_data("PN_time_0.3-10_pi_grp.fits");
r=load_rmf("PN_time_0.3-10_src_pi_rmf.fits");
a=load_arf("PN_time_0.3-10_src_pi_arf.fits");
assign_rsp(a,r,d);
define_back(d, "PN_time_0.3-10_bkg_pi.fits");
fit_fun("powerlaw");
rebin_data(1, 10);
xnotice_en(d, 1.0, 10.0);
set_par(2, 2.0);
fancy_plot_unit(“keV”);
()=fit_counts;
popt.xrange = [1.0, 10.0];
popt.yrange = [1.0E-4, 1.0, -10.0, 10.0];
popt.dsym = 1;
popt.res = 1;
xlog;
ylog;
title ("IRAS13224-3809 0792180201 Spectrum");
%open_plot("IRAS13224-3809_0792180201_Spectrum.gif/gif");
plot_data(d, popt; dsym=1);
fit;
()=eval_counts;
plot_data(d,popt);
%close_plot;

list_data;
data_flux(1,0.3,10);
list_par;

list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0     710/  845   2   2  2.5110e+05   119.630
file:  PN_time_0.3-10_pi_grp.fits
back:  PN_time_0.3-10_bkg_pi.fits

isis> data_flux(1,0.3,10);
1.4557945291657446e-14
3.4741989938648686e-12
3.48567172730358e-05
0.0034650096846177963

isis> list_par;
powerlaw
 idx  param             tie-to  freeze         value         min         max
  1  powerlaw(1).norm       0     0     0.0004016516           0       1e+10
  2  powerlaw(1).PhoIndex   0     0         2.866344          -2           9
#+END_EXAMPLE


#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0792180201_Spectrum.gif

*** Lag-frequency

Plot =lagfreq_script.sl=

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0792180201_lagfreq.gif

*** Segment analysis

PATH = =/data/scratch3/steff/IRAS13224-3809/0792180201/PROC=

Initiate sas

#+BEGIN_EXAMPLE
heainit
setsas
setenv SAS_CCFPATH /usr/local/XMM/ccf/
setenv SAS_ODF /data/scratch3/steff/IRAS13224-3809/0792180201/ODF
setenv SAS_CCF ccf.cif
#+END_EXAMPLE

Obtain lightcurve time

#+BEGIN_EXAMPLE
dsplot table=EPICclean_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

The table ran from 586300000 to 586429000 giving a total time of 000s.

seg1 586300000:586320000
seg2 586320000:586340000
seg3 586340000:586360000
seg4 586360000:586380000
seg5 586380000:586400000
seg6 586400000:586420000

#Copy Background Subtracted Light Curve to make the lightcurves with time above periods


#+BEGIN_EXAMPLE
cp PN_time_hard_lccorr.fits /data/scratch3/steff/IRAS13224-3809/0792180201_0.3-4k/seg1
cp PN_time_soft_lccorr.fits /data/scratch3/steff/IRAS13224-3809/0792180201_0.3-4k/seg1

#Change to segs directory
cd /data/scratch3/steff/IRAS13224-3809/0792180201_0.3-4k/seg1

# Rename these files as the output file needs to be the same name
mv PN_time_hard_lccorr.fits PN_time_hard_lccorr_full.fits
mv PN_time_soft_lccorr.fits PN_time_soft_lccorr_full.fits

# Filter by the appropriate time
evselect table=PN_time_soft_lccorr_full.fits withfilteredset=yes filteredset=PN_time_soft_lccorr.fits filtertype=expression  expression='TIME in [586400000:586420000]' keepfilteroutput=yes updateexposure=yes
evselect table=PN_time_hard_lccorr_full.fits withfilteredset=yes filteredset=PN_time_hard_lccorr.fits filtertype=expression  expression='TIME in [586400000:586420000]' keepfilteroutput=yes updateexposure=yes

# Plot the light curve
dsplot table=PN_time_soft_lccorr.fits x=TIME y=RATE &
dsplot table=PN_time_hard_lccorr.fits x=TIME y=RATE &


#+END_EXAMPLE

** OBS 0792180301 (2016) 140.5 (129) ks

Repeat Pre-Processing above

*** Create light curve 10-12 keV

#+BEGIN_EXAMPLE
evselect table=EPIC.fits withrateset=yes rateset=EPIC_flares_lc.fits maketimecolumn=yes timebinsize=100 makeratecolumn=yes expression='#XMMEA_EP && (PI>10000&&PI<12000) && (PATTERN==0)'

dsplot table=EPIC_flares_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

*** Create image file from xmgrace

#+BEGIN_EXAMPLE
    Open the menu File -> Print setup. There you can choose the desired graphics format in the Device pulldown

    Output:
    Slecet the 'print to file' check box
    Enter filename e.g: IRAS_0792180301_EPIC_flares.jpg

    Confirm your changes with the Accept button.
    Open the menu File -> Print … this will save the file with the filename chosen above.
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180301_flares_lc.jpg

*** Remove flared region

 Remove the flares from the end to create an effective time observation of 129,000s

This was done by:

#+BEGIN_EXAMPLE
evselect table=EPIC.fits withfilteredset=yes filteredset=EPICclean.fits filtertype=expression  expression='TIME in [586464000:586593000]' keepfilteroutput=yes updateexposure=yes
#+END_EXAMPLE

 Then a filtered lightcurve was created (note min and max times required to fit the data):

Recreate the table as =EPICclean_lc.fits=

#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withrateset=yes rateset=EPICclean_lc.fits maketimecolumn=yes timebinsize=100 makeratecolumn=yes timemin=586464000 timemax=586593000

dsplot table=EPICclean_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180301_EPICclean_lc.jpg

*** Select source & background and run post-processing script

#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withimageset=yes imageset=EPICclean_image.fits xcolumn=X ycolumn=Y imagebinning=imageSize ximagesize=600 yimagesize=600

ds9 EPICclean_image.fits &
#+END_EXAMPLE

Once image is showing select

Scale = log

Bin = Block 16

Zoom = Zoom 2

*Select regions*

=Source = 26230,27884,700=

=Background = 28144,21707,700=

*Post-processing & check pileup*

Enter source & background regions and run script
=sas_postproc_script.sl=

*** Create lightcurves (optional)

#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withrateset=yes rateset=0792180301_0.3-10keV.fits maketimecolumn=yes timebinsize=300 makeratecolumn=yes expression='(FLAG==0)&&(PATTERN<=4)&&(PI in [300:10000])&&#XMMEA_EP'

dsplot table=0792180301_0.3-10keV.fits x=TIME y=RATE ymin=0 xmax=586592000 &
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/0792180301_0.3-10keV.jpg

*** Group Spectral files

#+BEGIN_EXAMPLE
grppha
PN_time_0.3-10_src_pi.fits
PN_time_0.3-10_pi_grp.fits
chkey BACKFILE PN_time_0.3-10_bkg_pi.fits
chkey RESPFILE PN_time_0.3-10_src_pi_rmf.fits
chkey ANCRFILE PN_time_0.3-10_src_pi_arf.fits
group min 25
exit


#+END_EXAMPLE

*** Plot spectrum

#+BEGIN_EXAMPLE
isis
d=load_data("PN_time_0.3-10_pi_grp.fits");
r=load_rmf("PN_time_0.3-10_src_pi_rmf.fits");
a=load_arf("PN_time_0.3-10_src_pi_arf.fits");
assign_rsp(a,r,d);
define_back(d, "PN_time_0.3-10_bkg_pi.fits");
fit_fun("powerlaw");
rebin_data(1, 10);
xnotice_en(d, 1.0, 10.0);
set_par(2, 2.0);
fancy_plot_unit(“keV”);
()=fit_counts;
popt.xrange = [1.0, 10.0];
popt.yrange = [1.0E-4, 1.0, -10.0, 10.0];
popt.dsym = 1;
popt.res = 1;
xlog;
ylog;
title ("IRAS13224-3809 0792180301 Spectrum");
%open_plot("IRAS13224-3809_0792180301_Spectrum.gif/gif");
plot_data(d, popt; dsym=1);
fit;
()=eval_counts;
plot_data(d,popt);
%close_plot;

list_data;
data_flux(1,0.3,10);
list_par;

list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0     605/  740   2   2  1.0760e+05   119.508
file:  PN_time_0.3-10_pi_grp.fits
back:  PN_time_0.3-10_bkg_pi.fits

isis> data_flux(1,0.3,10);
1.315543518279772e-14
1.5433681398509921e-12
2.294884243223696e-05
0.0014714062402610192

isis> list_par;
powerlaw
 idx  param             tie-to  freeze         value         min         max
  1  powerlaw(1).norm       0     0     0.0001321308           0       1e+10
  2  powerlaw(1).PhoIndex   0     0         2.494906          -2           9


#+END_EXAMPLE


#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0792180301_Spectrum.gif

*** Lag-frequency

Plot =lagfreq_script.sl=

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0792180301_lagfreq.gif
#+BEGIN_EXAMPLE

#+END_EXAMPLE

*** Segment analysis

PATH = =/data/scratch3/steff/IRAS13224-3809/0792180301/PROC=

Initiate sas

#+BEGIN_EXAMPLE
heainit
setsas
setenv SAS_CCFPATH /usr/local/XMM/ccf/
setenv SAS_ODF /data/scratch3/steff/IRAS13224-3809/0792180301/ODF
setenv SAS_CCF ccf.cif
#+END_EXAMPLE

Obtain lightcurve time

#+BEGIN_EXAMPLE
dsplot table=EPICclean_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

The table ran from 586464000 to 586593000 giving a total time of 129000s.

seg1 586464000:586484000
seg2 586484000:586504000
seg3 586504000:586524000
seg4 586524000:586544000
seg5 586544000:586564000
seg6 586564000:586584000

#Copy Background Subtracted Light Curve to make the lightcurves with time above periods


#+BEGIN_EXAMPLE
cp PN_time_hard_lccorr.fits /data/scratch3/steff/IRAS13224-3809/0792180301_0.3-4k/seg1
cp PN_time_soft_lccorr.fits /data/scratch3/steff/IRAS13224-3809/0792180301_0.3-4k/seg1

#Change to segs directory
cd /data/scratch3/steff/IRAS13224-3809/0792180301_0.3-4k/seg1

# Rename these files as the output file needs to be the same name
mv PN_time_hard_lccorr.fits PN_time_hard_lccorr_full.fits
mv PN_time_soft_lccorr.fits PN_time_soft_lccorr_full.fits

# Filter by the appropriate time
evselect table=PN_time_soft_lccorr_full.fits withfilteredset=yes filteredset=PN_time_soft_lccorr.fits filtertype=expression  expression='TIME in [586564000:586584000]' keepfilteroutput=yes updateexposure=yes
evselect table=PN_time_hard_lccorr_full.fits withfilteredset=yes filteredset=PN_time_hard_lccorr.fits filtertype=expression  expression='TIME in [586564000:586584000]' keepfilteroutput=yes updateexposure=yes

# Plot the light curve
dsplot table=PN_time_soft_lccorr.fits x=TIME y=RATE &
dsplot table=PN_time_hard_lccorr.fits x=TIME y=RATE &


#+END_EXAMPLE

** OBS 0792180401 (2016) 140.8 (120) ks



Repeat Pre-Processing above

*** Create light curve 10-12 keV

#+BEGIN_EXAMPLE
evselect table=EPIC.fits withrateset=yes rateset=EPIC_flares_lc.fits maketimecolumn=yes timebinsize=100 makeratecolumn=yes expression='#XMMEA_EP && (PI>10000&&PI<12000) && (PATTERN==0)'

dsplot table=EPIC_flares_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

*** Create image file from xmgrace

#+BEGIN_EXAMPLE
    Open the menu File -> Print setup. There you can choose the desired graphics format in the Device pulldown

    Output:
    Slecet the 'print to file' check box
    Enter filename e.g: IRAS_0792180401_EPIC_flares.jpg

    Confirm your changes with the Accept button.
    Open the menu File -> Print … this will save the file with the filename chosen above.
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180401_flares_lc.jpg

*** Remove flared region

 Remove the flares from the begining and end to create an effective time observation of 120,000s

This was done by:

#+BEGIN_EXAMPLE
evselect table=EPIC.fits withfilteredset=yes filteredset=EPICclean.fits filtertype=expression  expression='TIME in [586645000:586765000]' keepfilteroutput=yes updateexposure=yes
#+END_EXAMPLE

 Then a filtered lightcurve was created (note min and max times required to fit the data):

Recreate the table as =EPICclean_lc.fits=

#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withrateset=yes rateset=EPICclean_lc.fits maketimecolumn=yes timebinsize=100 makeratecolumn=yes timemin=586645000 timemax=586765000

dsplot table=EPICclean_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180401_EPICclean_lc.jpg

*** Select source & background and run post-processing script

#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withimageset=yes imageset=EPICclean_image.fits xcolumn=X ycolumn=Y imagebinning=imageSize ximagesize=600 yimagesize=600

ds9 EPICclean_image.fits &
#+END_EXAMPLE

Once image is showing select

Scale = log

Bin = Block 16

Zoom = Zoom 2

*Select regions*

=Source = 26187,27884,700=

=Background = 28188,22577,700=

*Post-processing & check pileup*

Enter source & background regions and run script
=sas_postproc_script.sl=

*** Create lightcurves (optional)


#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withrateset=yes rateset=0792180401_0.3-10keV.fits maketimecolumn=yes timebinsize=300 makeratecolumn=yes expression='(FLAG==0)&&(PATTERN<=4)&&(PI in [300:10000])&&#XMMEA_EP'

dsplot table=0792180401_0.3-10keV.fits x=TIME y=RATE ymin=0 xmin=586646000 xmax=586764000 &
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/0792180401_0.3-10keV.jpg

*** Group Spectral files

#+BEGIN_EXAMPLE
grppha
PN_time_0.3-10_src_pi.fits
PN_time_0.3-10_pi_grp.fits
chkey BACKFILE PN_time_0.3-10_bkg_pi.fits
chkey RESPFILE PN_time_0.3-10_src_pi_rmf.fits
chkey ANCRFILE PN_time_0.3-10_src_pi_arf.fits
group min 25
exit


#+END_EXAMPLE

*** Plot spectrum

#+BEGIN_EXAMPLE
isis
d=load_data("PN_time_0.3-10_pi_grp.fits");
r=load_rmf("PN_time_0.3-10_src_pi_rmf.fits");
a=load_arf("PN_time_0.3-10_src_pi_arf.fits");
assign_rsp(a,r,d);
define_back(d, "PN_time_0.3-10_bkg_pi.fits");
fit_fun("powerlaw");
rebin_data(1, 10);
xnotice_en(d, 1.0, 10.0);
set_par(2, 2.0);
fancy_plot_unit(“keV”);
()=fit_counts;
popt.xrange = [1.0, 10.0];
popt.yrange = [1.0E-4, 1.0, -10.0, 10.0];
popt.dsym = 1;
popt.res = 1;
xlog;
ylog;
title ("IRAS13224-3809 0792180401 Spectrum");
%open_plot("IRAS13224-3809_0792180401_Spectrum.gif/gif");
plot_data(d, popt; dsym=1);
fit;
()=eval_counts;
plot_data(d,popt);
%close_plot;

list_data;
data_flux(1,0.3,10);
list_par;

 list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0    1032/ 1167   2   2  5.2155e+05   111.297
file:  PN_time_0.3-10_pi_grp.fits
back:  PN_time_0.3-10_bkg_pi.fits

isis> data_flux(1,0.3,10);
2.1683184349904486e-14
8.120257452142836e-12
5.011641618242653e-05
0.007376012289092551

isis> list_par;
powerlaw
 idx  param             tie-to  freeze         value         min         max
  1  powerlaw(1).norm       0     0      0.001649907           0       1e+10
  2  powerlaw(1).PhoIndex   0     0         3.066222          -2           9
#+END_EXAMPLE


#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0792180401_Spectrum.gif

*** Lag-frequency

Plot =lagfreq_script.sl=

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0792180401_lagfreq.gif
#+BEGIN_EXAMPLE

#+END_EXAMPLE

*** Segment analysis

PATH = =/data/scratch3/steff/IRAS13224-3809/0792180401/PROC=

Initiate sas

#+BEGIN_EXAMPLE
heainit
setsas
setenv SAS_CCFPATH /usr/local/XMM/ccf/
setenv SAS_ODF /data/scratch3/steff/IRAS13224-3809/0792180401/ODF
setenv SAS_CCF ccf.cif
#+END_EXAMPLE

Obtain lightcurve time

#+BEGIN_EXAMPLE
dsplot table=EPICclean_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

The table ran from 586645000 to 586765000 giving a total time of 000s.

seg1 586645000:586665000
seg2 586665000:586685000
seg3 586685000:586705000
seg4 586705000:586725000
seg5 586725000:586745000
seg6 586745000:586765000

#Copy Background Subtracted Light Curve to make the lightcurves with time above periods


#+BEGIN_EXAMPLE
cp PN_time_hard_lccorr.fits /data/scratch3/steff/IRAS13224-3809/0792180401_0.3-4k/seg1
cp PN_time_soft_lccorr.fits /data/scratch3/steff/IRAS13224-3809/0792180401_0.3-4k/seg1

#Change to segs directory
cd /data/scratch3/steff/IRAS13224-3809/0792180401_0.3-4k/seg1

# Rename these files as the output file needs to be the same name
mv PN_time_hard_lccorr.fits PN_time_hard_lccorr_full.fits
mv PN_time_soft_lccorr.fits PN_time_soft_lccorr_full.fits

# Filter by the appropriate time
evselect table=PN_time_soft_lccorr_full.fits withfilteredset=yes filteredset=PN_time_soft_lccorr.fits filtertype=expression  expression='TIME in [586745000:586765000]' keepfilteroutput=yes updateexposure=yes
evselect table=PN_time_hard_lccorr_full.fits withfilteredset=yes filteredset=PN_time_hard_lccorr.fits filtertype=expression  expression='TIME in [586745000:586765000]' keepfilteroutput=yes updateexposure=yes

# Plot the light curve
dsplot table=PN_time_soft_lccorr.fits x=TIME y=RATE &
dsplot table=PN_time_hard_lccorr.fits x=TIME y=RATE &



#+END_EXAMPLE

** OBS 0792180501 (2016) 138.0 (122) ks

Repeat Pre-Processing above

*** Create light curve 10-12 keV

#+BEGIN_EXAMPLE
evselect table=EPIC.fits withrateset=yes rateset=EPIC_flares_lc.fits maketimecolumn=yes timebinsize=100 makeratecolumn=yes expression='#XMMEA_EP && (PI>10000&&PI<12000) && (PATTERN==0)'

dsplot table=EPIC_flares_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

*** Create image file from xmgrace

#+BEGIN_EXAMPLE
    Open the menu File -> Print setup. There you can choose the desired graphics format in the Device pulldown

    Output:
    Slecet the 'print to file' check box
    Enter filename e.g: IRAS_0792180501_EPIC_flares.jpg

    Confirm your changes with the Accept button.
    Open the menu File -> Print … this will save the file with the filename chosen above.
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180501_flares_lc.jpg

*** Remove flared region

 Remove the flares from the begining and end to create an effective time observation of 122,000s

This was done by:

#+BEGIN_EXAMPLE
evselect table=EPIC.fits withfilteredset=yes filteredset=EPICclean.fits filtertype=expression  expression='TIME in [586992000:587114000]' keepfilteroutput=yes updateexposure=yes
#+END_EXAMPLE

 Then a filtered lightcurve was created (note min and max times required to fit the data):

Recreate the table as =EPICclean_lc.fits=

#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withrateset=yes rateset=EPICclean_lc.fits maketimecolumn=yes timebinsize=100 makeratecolumn=yes timemin=586992000 timemax=587114000

dsplot table=EPICclean_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180501_EPICclean_lc.jpg

*** Select source & background and run post-processing script

#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withimageset=yes imageset=EPICclean_image.fits xcolumn=X ycolumn=Y imagebinning=imageSize ximagesize=600 yimagesize=600

ds9 EPICclean_image.fits &
#+END_EXAMPLE

Once image is showing select

Scale = log

Bin = Block 16

Zoom = Zoom 2

*Select regions*

=Source =26144,27971,700=

=Background = 28275,22446,700=

*Post-processing & check pileup*

Enter source & background regions and run script
=sas_postproc_script.sl=

*** Create lightcurves (optional)


#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withrateset=yes rateset=0792180501_0.3-10keV.fits maketimecolumn=yes timebinsize=300 makeratecolumn=yes expression='(FLAG==0)&&(PATTERN<=4)&&(PI in [300:10000])&&#XMMEA_EP'

dsplot table=0792180501_0.3-10keV.fits x=TIME y=RATE ymin=0 xmin=586992000 xmax=587113000 &
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/0792180501_0.3-10keV.jpg


*** Group Spectral files

#+BEGIN_EXAMPLE
grppha
PN_time_0.3-10_src_pi.fits
PN_time_0.3-10_pi_grp.fits
chkey BACKFILE PN_time_0.3-10_bkg_pi.fits
chkey RESPFILE PN_time_0.3-10_src_pi_rmf.fits
chkey ANCRFILE PN_time_0.3-10_src_pi_arf.fits
group min 25
exit


#+END_EXAMPLE

*** Plot spectrum

#+BEGIN_EXAMPLE
isis
d=load_data("PN_time_0.3-10_pi_grp.fits");
r=load_rmf("PN_time_0.3-10_src_pi_rmf.fits");
a=load_arf("PN_time_0.3-10_src_pi_arf.fits");
assign_rsp(a,r,d);
define_back(d, "PN_time_0.3-10_bkg_pi.fits");
fit_fun("powerlaw");
rebin_data(1, 10);
xnotice_en(d, 1.0, 10.0);
set_par(2, 2.0);
fancy_plot_unit(“keV”);
()=fit_counts;
popt.xrange = [1.0, 10.0];
popt.yrange = [1.0E-4, 1.0, -10.0, 10.0];
popt.dsym = 1;
popt.res = 1;
xlog;
ylog;
title ("IRAS13224-3809 0792180501 Spectrum");
%open_plot("IRAS13224-3809_0792180501_Spectrum.gif/gif");
plot_data(d, popt; dsym=1);
fit;
()=eval_counts;
plot_data(d,popt);
%close_plot;

list_data;
data_flux(1,0.3,10);
list_par;

 list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0     771/  906   2   2  2.1865e+05   112.297
file:  PN_time_0.3-10_pi_grp.fits
back:  PN_time_0.3-10_bkg_pi.fits

isis> data_flux(1,0.3,10);
1.4924770051899746e-14
3.398874133966731e-12
3.2521959640091305e-05
0.003105254536177533

isis> list_par;
powerlaw
 idx  param             tie-to  freeze         value         min         max
  1  powerlaw(1).norm       0     0     0.0005250797           0       1e+10
  2  powerlaw(1).PhoIndex   0     0         2.810302          -2           9
#+END_EXAMPLE


#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0792180501_Spectrum.gif

*** Lag-frequency

Plot =lagfreq_script.sl=

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0792180501_lagfreq.gif

*** Segment analysis

PATH = =/data/scratch3/steff/IRAS13224-3809/0792180501/PROC=

Initiate sas

#+BEGIN_EXAMPLE
heainit
setsas
setenv SAS_CCFPATH /usr/local/XMM/ccf/
setenv SAS_ODF /data/scratch3/steff/IRAS13224-3809/0792180501/ODF
setenv SAS_CCF ccf.cif
#+END_EXAMPLE

Obtain lightcurve time

#+BEGIN_EXAMPLE
dsplot table=EPICclean_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

The table ran from 586992000 to 587114000 giving a total time of 122000s.

seg1 586992000:587012000
seg2 587012000:587032000
seg3 587032000:587052000
seg4 587052000:587072000
seg5 587072000:587092000
seg6 587092000:587112000

#Copy Background Subtracted Light Curve to make the lightcurves with time above periods


#+BEGIN_EXAMPLE
cp PN_time_hard_lccorr.fits /data/scratch3/steff/IRAS13224-3809/0792180501_0.3-4k/seg1
cp PN_time_soft_lccorr.fits /data/scratch3/steff/IRAS13224-3809/0792180501_0.3-4k/seg1

#Change to segs directory
cd /data/scratch3/steff/IRAS13224-3809/0792180501_0.3-4k/seg1

# Rename these files as the output file needs to be the same name
mv PN_time_hard_lccorr.fits PN_time_hard_lccorr_full.fits
mv PN_time_soft_lccorr.fits PN_time_soft_lccorr_full.fits

# Filter by the appropriate time
evselect table=PN_time_soft_lccorr_full.fits withfilteredset=yes filteredset=PN_time_soft_lccorr.fits filtertype=expression  expression='TIME in [587092000:587112000]' keepfilteroutput=yes updateexposure=yes
evselect table=PN_time_hard_lccorr_full.fits withfilteredset=yes filteredset=PN_time_hard_lccorr.fits filtertype=expression  expression='TIME in [587092000:587112000]' keepfilteroutput=yes updateexposure=yes

# Plot the light curve
dsplot table=PN_time_soft_lccorr.fits x=TIME y=RATE &
dsplot table=PN_time_hard_lccorr.fits x=TIME y=RATE &

#+END_EXAMPLE

** OBS 0792180601 (2016) 136.0 (126) ks

Repeat Pre-Processing above
*** Create light curve 10-12 keV

#+BEGIN_EXAMPLE
evselect table=EPIC.fits withrateset=yes rateset=EPIC_flares_lc.fits maketimecolumn=yes timebinsize=100 makeratecolumn=yes expression='#XMMEA_EP && (PI>10000&&PI<12000) && (PATTERN==0)'

dsplot table=EPIC_flares_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

*** Create image file from xmgrace

#+BEGIN_EXAMPLE
    Open the menu File -> Print setup. There you can choose the desired graphics format in the Device pulldown

    Output:
    Slecet the 'print to file' check box
    Enter filename e.g: IRAS_0792180601_EPIC_flares.jpg

    Confirm your changes with the Accept button.
    Open the menu File -> Print … this will save the file with the filename chosen above.
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180601_flares_lc.jpg

*** Remove flared region

 Remove the flares from the begining and end to create an effective time observation of 122,000s

This was done by:

#+BEGIN_EXAMPLE
evselect table=EPIC.fits withfilteredset=yes filteredset=EPICclean.fits filtertype=expression  expression='TIME in [587164000:587290000]' keepfilteroutput=yes updateexposure=yes
#+END_EXAMPLE

 Then a filtered lightcurve was created (note min and max times required to fit the data):

Recreate the table as =EPICclean_lc.fits=

#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withrateset=yes rateset=EPICclean_lc.fits maketimecolumn=yes timebinsize=100 makeratecolumn=yes timemin=587164000 timemax=587290000

dsplot table=EPICclean_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180601_EPICclean_lc.jpg

*** Select source & background and run post-processing script

#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withimageset=yes imageset=EPICclean_image.fits xcolumn=X ycolumn=Y imagebinning=imageSize ximagesize=600 yimagesize=600

ds9 EPICclean_image.fits &
#+END_EXAMPLE

Once image is showing select

Scale = log

Bin = Block 16

Zoom = Zoom 2

*Select regions*

=Source =25752,27840,700=

=Background =29058,22620,700=

*Post-processing & check pileup*

Enter source & background regions and run script
=sas_postproc_script.sl=

*** Create lightcurves (optional)


#+BEGIN_EXAMPLE
evselect table=EPICclean.fits withrateset=yes rateset=0792180601_0.3-10keV.fits maketimecolumn=yes timebinsize=300 makeratecolumn=yes expression='(FLAG==0)&&(PATTERN<=4)&&(PI in [300:10000])&&#XMMEA_EP'

dsplot table=0792180601_0.3-10keV.fits x=TIME y=RATE ymin=0 xmin=587165000 &
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/0792180601_0.3-10keV.jpg

*** Group Spectral files

#+BEGIN_EXAMPLE
grppha
PN_time_0.3-10_src_pi.fits
PN_time_0.3-10_pi_grp.fits
chkey BACKFILE PN_time_0.3-10_bkg_pi.fits
chkey RESPFILE PN_time_0.3-10_src_pi_rmf.fits
chkey ANCRFILE PN_time_0.3-10_src_pi_arf.fits
group min 25
exit


#+END_EXAMPLE

*** Plot spectrum

#+BEGIN_EXAMPLE
isis
d=load_data("PN_time_0.3-10_pi_grp.fits");
r=load_rmf("PN_time_0.3-10_src_pi_rmf.fits");
a=load_arf("PN_time_0.3-10_src_pi_arf.fits");
assign_rsp(a,r,d);
define_back(d, "PN_time_0.3-10_bkg_pi.fits");
fit_fun("powerlaw");
rebin_data(1, 10);
xnotice_en(d, 1.0, 10.0);
set_par(2, 2.0);
fancy_plot_unit(“keV”);
()=fit_counts;
popt.xrange = [1.0, 10.0];
popt.yrange = [1.0E-4, 1.0, -10.0, 10.0];
popt.dsym = 1;
popt.res = 1;
xlog;
ylog;
title ("IRAS13224-3809 0792180601 Spectrum");
%open_plot("IRAS13224-3809_0792180601_Spectrum.gif/gif");
plot_data(d, popt; dsym=1);
fit;
()=eval_counts;
plot_data(d,popt);
%close_plot;

list_data;
data_flux(1,0.3,10);
list_par;

 list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1           EPN          0    1006/ 1141   2   2  5.3759e+05   117.033
file:  PN_time_0.3-10_pi_grp.fits
back:  PN_time_0.3-10_bkg_pi.fits

isis> data_flux(1,0.3,10);
2.0181798858208872e-14
7.913806181460716e-12
4.8167109697033624e-05
0.007225717282906764

isis> list_par;
powerlaw
 idx  param             tie-to  freeze         value         min         max
  1  powerlaw(1).norm       0     0      0.001693982           0       1e+10
  2  powerlaw(1).PhoIndex   0     0         3.119785          -2           9
#+END_EXAMPLE


#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0792180601_Spectrum.gif

*** Lag-frequency

Plot =lagfreq_script.sl=

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0792180601_lagfreq.gif

*** Segment analysis

PATH = =/data/scratch3/steff/IRAS13224-3809/0792180601/PROC=

Initiate sas

#+BEGIN_EXAMPLE
heainit
setsas
setenv SAS_CCFPATH /usr/local/XMM/ccf/
setenv SAS_ODF /data/scratch3/steff/IRAS13224-3809/0792180601/ODF
setenv SAS_CCF ccf.cif
#+END_EXAMPLE

Obtain lightcurve time

#+BEGIN_EXAMPLE
dsplot table=EPICclean_lc.fits x=TIME y=RATE &
#+END_EXAMPLE

The table ran from 587164000  to  587290000 giving a total time of 126000s.

seg1 587164000:587184000
seg2 587184000:587204000
seg3 587204000:587224000
seg4 587224000:587244000
seg5 587244000:587264000
seg6 587264000:587284000

#Copy Background Subtracted Light Curve to make the lightcurves with time above periods


#+BEGIN_EXAMPLE
cp PN_time_hard_lccorr.fits /data/scratch3/steff/IRAS13224-3809/0792180601_0.3-4k/seg1
cp PN_time_soft_lccorr.fits /data/scratch3/steff/IRAS13224-3809/0792180601_0.3-4k/seg1

#Change to segs directory
cd /data/scratch3/steff/IRAS13224-3809/0792180601_0.3-4k/seg1

# Rename these files as the output file needs to be the same name


mv PN_time_hard_lccorr.fits PN_time_hard_lccorr_full.fits
mv PN_time_soft_lccorr.fits PN_time_soft_lccorr_full.fits

# Filter by the appropriate time

evselect table=PN_time_soft_lccorr_full.fits withfilteredset=yes filteredset=PN_time_soft_lccorr.fits filtertype=expression  expression='TIME in [587264000:587284000]' keepfilteroutput=yes updateexposure=yes
evselect table=PN_time_hard_lccorr_full.fits withfilteredset=yes filteredset=PN_time_hard_lccorr.fits filtertype=expression  expression='TIME in [587264000:587284000]' keepfilteroutput=yes updateexposure=yes

# Plot the light curve
dsplot table=PN_time_soft_lccorr.fits x=TIME y=RATE &
dsplot table=PN_time_hard_lccorr.fits x=TIME y=RATE &




#+END_EXAMPLE

** Combined Observations

0110890101, 0673580101, 0673580201,0673580301,0673580401

Total time  404 ks

script =lagfreq_comb_script.sl=

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_lagfreq_comb.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,5.596631e+02,1.509663e+02
1.388430e-04,2.071069e+02,9.776028e+01
2.650639e-04,-7.544134e+01,4.748104e+01
5.060310e-04,-5.011103e+01,2.422348e+01
9.660592e-04,-2.348180e+01,1.136203e+01
1.844295e-03,-2.071284e+01,7.126319e+00
3.520927e-03,-3.395289e+00,1.449182e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-combined-time-lags.fits");
r=load_rmf("IRAS13224-3809-combined-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH =/homeb/steff075/phd_ecm/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-combined-time-lags.fits=

** Combined Lags 14 bins

PATH =/home/steff075/phd_ecm/IRAS13224-3809=

USE =lagfreq_comb_14_script.sl=

=variable n_bins = 14;=

=variable df_f = 1.0/3.0;=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_lagfreq_comb_14bins.gif

saved to =IRAS13224-3809-comb_14_2.csv=

Lags:
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 1.166667e-04 | 1.666667e-05 |  3.703103e+02 | 1.147318e+02 |
+--------------+--------------+---------------+--------------+
| 1.555556e-04 | 2.222222e-05 |  1.355832e+01 | 1.339107e+02 |
+--------------+--------------+---------------+--------------+
| 2.074074e-04 | 2.962963e-05 |  3.798060e+00 | 1.114474e+02 |
+--------------+--------------+---------------+--------------+
| 2.765432e-04 | 3.950617e-05 | -8.969967e+01 | 5.056021e+01 |
+--------------+--------------+---------------+--------------+
| 3.687243e-04 | 5.267490e-05 |  9.185114e-01 | 5.507857e+01 |
+--------------+--------------+---------------+--------------+
| 4.916324e-04 | 7.023320e-05 | -5.393988e+01 | 3.917346e+01 |
+--------------+--------------+---------------+--------------+
| 6.555098e-04 | 9.364426e-05 | -4.689658e+01 | 1.883298e+01 |
+--------------+--------------+---------------+--------------+
| 8.740131e-04 | 1.248590e-04 | -2.995889e+01 | 1.759343e+01 |
+--------------+--------------+---------------+--------------+
| 1.165351e-03 | 1.664787e-04 | -1.717440e+01 | 1.669665e+01 |
+--------------+--------------+---------------+--------------+
| 1.553801e-03 | 2.219716e-04 | -2.765971e+01 | 1.158983e+01 |
+--------------+--------------+---------------+--------------+
| 2.071735e-03 | 2.959621e-04 | -1.507269e+01 | 1.056425e+01 |
+--------------+--------------+---------------+--------------+
| 2.762313e-03 | 3.946161e-04 | -1.080217e+01 | 1.659924e+01 |
+--------------+--------------+---------------+--------------+
| 3.683084e-03 | 5.261549e-04 | -1.102342e+01 | 1.986183e+01 |
+--------------+--------------+---------------+--------------+
| 4.910779e-03 | 7.015398e-04 | -3.885597e+01 | 2.958673e+01 |
+--------------+--------------+---------------+--------------+


saved at =IRAS13224-3809-comb_14_2.csv=


Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28
accordingly. Run fits files to check:

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-comb-time-lags14.fits");
r=load_rmf("IRAS13224-3809-comb-time-lags14.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

Copy to BC 4:

#+BEGIN_EXAMPLE
scp IRAS13224-3809-comb-time-lags14.fits so14935@bc4login.acrc.bris.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/IRAS13224-3809-time-lag-fits
#+END_EXAMPLE

** Combined Lags 50 bins for P. Chainakun

PATH =/home/steff075/phd_ecm/IRAS13224-3809=

USE =lagfreq_comb_forPC.sl=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_lagfreq_comb_50bins.gif

+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 1.081967e-04 | 8.196721e-06 |  4.164650e+02 | 1.980629e+02 |
+--------------+--------------+---------------+--------------+
| 1.259339e-04 | 9.540446e-06 |  3.228804e+02 | 1.067240e+02 |
+--------------+--------------+---------------+--------------+
| 1.465788e-04 | 1.110445e-05 |  1.372027e+02 | 2.273665e+02 |
+--------------+--------------+---------------+--------------+
| 1.706081e-04 | 1.292486e-05 | -5.253477e+00 | 1.495715e+02 |
+--------------+--------------+---------------+--------------+
| 1.985766e-04 | 1.504368e-05 | -3.330846e+01 | 2.062889e+02 |
+--------------+--------------+---------------+--------------+
| 2.311302e-04 | 1.750986e-05 | -1.083858e+02 | 1.033262e+02 |
+--------------+--------------+---------------+--------------+
| 2.690204e-04 | 2.038033e-05 | -8.884463e+01 | 7.422730e+01 |
+--------------+--------------+---------------+--------------+
| 3.131221e-04 | 2.372137e-05 | -8.427945e+01 | 6.316300e+01 |
+--------------+--------------+---------------+--------------+
| 3.644536e-04 | 2.761012e-05 | -4.302731e+01 | 7.824747e+01 |
+--------------+--------------+---------------+--------------+
| 4.242001e-04 | 3.213637e-05 | -9.262267e+01 | 6.434468e+01 |
+--------------+--------------+---------------+--------------+
| 4.937411e-04 | 3.740463e-05 |  8.493921e+00 | 4.757191e+01 |
+--------------+--------------+---------------+--------------+
| 5.746822e-04 | 4.353653e-05 | -4.411158e+01 | 3.495400e+01 |
+--------------+--------------+---------------+--------------+
| 6.688924e-04 | 5.067367e-05 | -4.772135e+01 | 2.777542e+01 |
+--------------+--------------+---------------+--------------+
| 7.785469e-04 | 5.898083e-05 | -4.101562e+01 | 2.064131e+01 |
+--------------+--------------+---------------+--------------+
| 9.061775e-04 | 6.864981e-05 | -2.416302e+01 | 2.600613e+01 |
+--------------+--------------+---------------+--------------+
| 1.054731e-03 | 7.990388e-05 | -7.391469e+00 | 3.420050e+01 |
+--------------+--------------+---------------+--------------+
| 1.227638e-03 | 9.300288e-05 | -1.714937e+01 | 1.654488e+01 |
+--------------+--------------+---------------+--------------+
| 1.428890e-03 | 1.082493e-04 | -6.362679e+00 | 1.741816e+01 |
+--------------+--------------+---------------+--------------+
| 1.663134e-03 | 1.259950e-04 | -3.629012e+01 | 1.405162e+01 |
+--------------+--------------+---------------+--------------+
| 1.935779e-03 | 1.466500e-04 | -5.090301e+00 | 1.638618e+01 |
+--------------+--------------+---------------+--------------+
| 2.253120e-03 | 1.706909e-04 | -2.502359e+01 | 1.230813e+01 |
+--------------+--------------+---------------+--------------+
| 2.622484e-03 | 1.986730e-04 | -3.596042e+01 | 3.650567e+01 |
+--------------+--------------+---------------+--------------+
| 3.052400e-03 | 2.312424e-04 |  5.072932e+00 | 1.451251e+01 |
+--------------+--------------+---------------+--------------+
| 3.552793e-03 | 2.691510e-04 |  3.499017e+01 | 2.151260e+01 |
+--------------+--------------+---------------+--------------+
| 4.135218e-03 | 3.132741e-04 | -6.209144e+01 | 1.804674e+01 |
+--------------+--------------+---------------+--------------+
| 4.813123e-03 | 3.646305e-04 | -3.554221e+01 | 1.717742e+01 |
+--------------+--------------+---------------+--------------+
| 5.602159e-03 | 4.244060e-04 |  3.918623e+01 | 5.380556e+01 |
+--------------+--------------+---------------+--------------+
| 6.520546e-03 | 4.939808e-04 |  2.668784e+01 | 1.560014e+01 |
+--------------+--------------+---------------+--------------+
| 7.589488e-03 | 5.749612e-04 | -6.279805e+01 | 3.290111e+01 |
+--------------+--------------+---------------+--------------+
| 8.833666e-03 | 6.692172e-04 |  1.794968e+00 | 1.082963e+01 |
+--------------+--------------+---------------+--------------+
| 1.028181e-02 | 7.789249e-04 | -8.286994e+00 | 2.254348e+01 |
+--------------+--------------+---------------+--------------+
| 1.196735e-02 | 9.066175e-04 | -2.101229e+01 | 2.254077e+01 |
+--------------+--------------+---------------+--------------+
| 1.392921e-02 | 1.055243e-03 |  2.641706e+01 | 4.688919e+00 |
+--------------+--------------+---------------+--------------+
| 1.621269e-02 | 1.228234e-03 |  1.206515e+01 | 5.183509e+00 |
+--------------+--------------+---------------+--------------+
| 1.887051e-02 | 1.429584e-03 | -1.748872e+01 | 3.585196e+00 |
+--------------+--------------+---------------+--------------+
| 2.196403e-02 | 1.663942e-03 | -2.132392e+01 | 5.631698e+00 |
+--------------+--------------+---------------+--------------+
| 2.556469e-02 | 1.936719e-03 | -1.194222e+01 | 5.651017e+00 |
+--------------+--------------+---------------+--------------+
| 2.975563e-02 | 2.254214e-03 | -1.587688e+01 | 4.323902e+00 |
+--------------+--------------+---------------+--------------+
| 3.463360e-02 | 2.623757e-03 |  1.353197e+01 | 3.983477e+00 |
+--------------+--------------+---------------+--------------+
| 4.031124e-02 | 3.053882e-03 | -1.109179e+01 | 4.191196e+00 |
+--------------+--------------+---------------+--------------+
| 4.691964e-02 | 3.554518e-03 | -8.228267e+00 | 1.677895e+00 |
+--------------+--------------+---------------+--------------+
| 5.461138e-02 | 4.137226e-03 |  7.289620e+00 | 1.607993e+00 |
+--------------+--------------+---------------+--------------+
| 6.356407e-02 | 4.815460e-03 |  7.431359e+00 | 2.779909e+00 |
+--------------+--------------+---------------+--------------+
| 7.398441e-02 | 5.604879e-03 |  5.852067e+00 | 1.037565e+00 |
+--------------+--------------+---------------+--------------+
| 8.611300e-02 | 6.523712e-03 | -5.351074e+00 | 8.070385e+00 |
+--------------+--------------+---------------+--------------+
| 1.002299e-01 | 7.593173e-03 | -8.643541e-02 | 1.194401e-02 |
+--------------+--------------+---------------+--------------+
| 1.166610e-01 | 8.837955e-03 |          -nan |         -nan |
+--------------+--------------+---------------+--------------+
| 1.357858e-01 | 1.028680e-02 |          -nan |         -nan |
+--------------+--------------+---------------+--------------+
| 1.580457e-01 | 1.197316e-02 |          -nan |         -nan |
+--------------+--------------+---------------+--------------+
| 1.839549e-01 | 1.393597e-02 |          -nan |         -nan |
+--------------+--------------+---------------+--------------+

saved to =IRAS13224-3809-comb_50_2.csv=

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28
accordingly. Run fits files to check:

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-comb-time-lags50.fits");
r=load_rmf("IRAS13224-3809-comb-time-lags50.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

These fits files are downloadable here:

http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809-comb-time-lags50.fits

http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809-comb-time-lags50.rsp

** 2002 Observation

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0110890101 Total time 61 ks

script = =lagfreq_comb2002_script.sl=

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_lagfreq_2002.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,1.029471e+03,3.654683e+02
1.388430e-04,1.831865e+02,2.657501e+02
2.650639e-04,-6.182428e+01,1.315723e+02
5.060310e-04,1.481032e+02,1.133431e+02
9.660592e-04,-2.050896e+01,3.006422e+01
1.844295e-03,-2.131293e+01,3.189782e+01
3.520927e-03,8.161367e+01,2.775944e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-2002-time-lags.fits");
r=load_rmf("IRAS13224-3809-2002-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH
=/homeb/steff075/phd_ecm/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-2002-time-lags.fits=

** 2011 Observation

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0673580101, 0673580201,0673580301,0673580401 Total time  343 ks

script = =lagfreq_comb_script.sl=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_lagfreq_2011.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,5.130857e+02,1.591671e+02
1.388430e-04,2.113293e+02,1.048651e+02
2.650639e-04,-7.738468e+01,5.088425e+01
5.060310e-04,-6.540826e+01,2.356222e+01
9.660592e-04,-2.392002e+01,1.225493e+01
1.844295e-03,-2.065838e+01,7.194619e+00
3.520927e-03,-1.170463e+01,1.278311e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-2011-time-lags.fits");
r=load_rmf("IRAS13224-3809-2011-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH
=/homeb/steff075/phd_ecm/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-2011-time-lags.fits=

** Group 1 spectra

See 2002 Observation (below)

** Group 2 spectra

*Lag-frequency*

Lets have a look at the lag frequency for this single observation:

Use script =lagfreq_comb_script_Grp2.sl=

Lag values:
#+BEGIN_EXAMPLE
7.272727e-05,5.091639e+02,2.008918e+02
1.388430e-04,3.150206e+02,1.173456e+02
2.650639e-04,7.753000e+01,7.400081e+01
5.060310e-04,-4.070452e+01,3.123187e+01
9.660592e-04,-1.792519e+01,1.774370e+01
1.844295e-03,-2.486775e+01,1.326044e+01
3.520927e-03,-3.498757e+00,1.559257e+01
#+END_EXAMPLE
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_lagfreq_Grp2.gif


*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-Grp2-time-lags.fits");
r=load_rmf("IRAS13224-3809-Grp2-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH
=/homeb/steff075/phd_ecm/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-Grp2-time-lags.fits=

** Group 3 spectra

*Lag-frequency*

Lets have a look at the lag frequency for this single observation:

Use script =lagfreq_comb_script_Grp3.sl=

Lag values:
#+BEGIN_EXAMPLE
7.272727e-05,5.160719e+02,2.672399e+02
1.388430e-04,-8.720117e+01,2.000757e+02
2.650639e-04,-2.399313e+02,5.070954e+01
5.060310e-04,-9.411921e+01,3.568659e+01
9.660592e-04,-2.980652e+01,1.714381e+01
1.844295e-03,-1.815670e+01,8.457213e+00
3.520927e-03,-2.614260e+01,2.065788e+01
#+END_EXAMPLE
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_lagfreq_Grp3.gif


*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-Grp3-time-lags.fits");
r=load_rmf("IRAS13224-3809-Grp3-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH
=/homeb/steff075/phd_ecm/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-Grp3-time-lags.fits=

** *Segmented Analysis* for $~f_{max}$

PATH =
=/data/scratch3/steff/IRAS13224-3809/combined/lagfreq_segs_ECM.sl=

=/data/scratch3/steff/IRAS13224-3809/combined/coh_segs_ECM.sl=

All observations were split into 84 segments of between 18 - 25 ks
 totalling 1776 ks of effective observation time.
 The combined lag-frequency of these observations is shown below.

Coherence = 0.0674


drops below this line between :

x=  2.260967e-03  y=  7.131404e-02  ch=A
x=  3.702703e-03  y=  7.131404e-02  ch=A

3.702 - 2.261 = 1.4409999999999998 and 2.261 + 1.441

%Max frequency is the vertical line x=  x=  2.861610e-03 Hz%

#+BEGIN_EXAMPLE
1.454545e-04,2.014736e+02,3.282029e+01, total_segment=8.400000e+01
2.776860e-04,7.938896e+01,2.118112e+01, total_segment=8.400000e+01
5.301277e-04,-2.718185e+01,7.665374e+00, total_segment=8.400000e+01
1.012062e-03,-2.527058e+01,3.664825e+00, total_segment=8.400000e+01
1.932118e-03,-9.066008e+00,1.930193e+00, total_segment=8.400000e+01
3.688590e-03,-3.670053e+00,9.116588e-01, total_segment=8.400000e+01
7.041853e-03,-1.401952e-01,3.592274e-01, total_segment=8.400000e+01
1.344354e-02,-2.626091e-01,4.702364e-01, total_segment=8.400000e+01
2.566494e-02,-nan,-nan, total_segment=8.400000e+01
4.899669e-02,-nan,-nan, total_segment=8.400000e+01
9.353914e-02,-nan,-nan, total_segment=8.400000e+01
1.785747e-01,-nan,-nan, total_segment=8.400000e+01
3.409154e-01,-nan,-nan, total_segment=8.400000e+01
6.508385e-01,-nan,-nan, total_segment=8.400000e+01
#+END_EXAMPLE

PATH = =/data/scratch3/steff/IRAS13224-3809/combined/lagfreq_segs_ECM.sl=
#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS_comb_segs_lagfreq.gif


PATH =
=/data/scratch3/steff/IRAS13224-3809/combined/lagfreq_coh_segs_ECM.sl=

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS_comb_segs_coh.gif

** Combined: for $~f_{max}$ = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/=

Lags found


| 7.083333e-05 | 2.083333e-05 |  7.981263e+02 | 1.120158e+02 |
| 1.298611e-04 | 3.819444e-05 |  2.814159e+02 | 5.119275e+01 |
| 2.380787e-04 | 7.002315e-05 |  2.217994e+01 | 2.605012e+01 |
| 4.364776e-04 | 1.283758e-04 | -4.968591e+01 | 1.053331e+01 |
| 8.002090e-04 | 2.353556e-04 | -3.409732e+01 | 4.739953e+00 |
| 1.467050e-03 | 4.314852e-04 | -2.247776e+01 | 2.604454e+00 |
| 2.689591e-03 | 7.910563e-04 | -6.169462e+00 | 1.320600e+00 |


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_lagfreq_comb_fmax.gif

Create fits & respones files

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-comb-time-lags-fmax.fits");
r=load_rmf("IRAS13224-3809-comb-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE


Fit ECM


#+BEGIN_EXAMPLE


#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/


** Hi-flux: for $~f_{max}$ = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/lagfreq_hiflux.sl=

Lags found


| 7.083333e-05 | 2.083333e-05 |  1.329635e+03 | 4.340756e+02 |
| 1.298611e-04 | 3.819444e-05 |  4.515146e+02 | 8.299254e+01 |
| 2.380787e-04 | 7.002315e-05 |  4.479640e+01 | 6.295103e+01 |
| 4.364776e-04 | 1.283758e-04 | -6.728490e+01 | 2.603642e+01 |
| 8.002090e-04 | 2.353556e-04 | -3.276015e+01 | 1.225958e+01 |
| 1.467050e-03 | 4.314852e-04 | -2.195015e+01 | 6.805187e+00 |
| 2.689591e-03 | 7.910563e-04 | -8.241462e+00 | 3.363079e+00 |


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_lagfreq_hiflux_fmax.gif

Create fits & respones files

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-hiflux-time-lags-fmax.fits");
r=load_rmf("IRAS13224-3809-hiflux-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE


Fit ECM


#+BEGIN_EXAMPLE


#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/

** Hi-cts>20: for $~f_{max}$ = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/lagfreq_hi_cts_lc_data.sl=

Lags found


| 7.083333e-05 | 2.083333e-05 |  1.038242e+03 | 2.214157e+02 |
| 1.298611e-04 | 3.819444e-05 |  4.276114e+02 | 5.826332e+01 |
| 2.380787e-04 | 7.002315e-05 |  5.547560e+01 | 4.055147e+01 |
| 4.364776e-04 | 1.283758e-04 | -5.079647e+01 | 1.591973e+01 |
| 8.002090e-04 | 2.353556e-04 | -2.952727e+01 | 7.254004e+00 |
| 1.467050e-03 | 4.314852e-04 | -2.116085e+01 | 4.029812e+00 |
| 2.689591e-03 | 7.910563e-04 | -6.624675e+00 | 1.965802e+00 |


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_lagfreq_hi_cts_fmax.gif

Create fits & respones files

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-hi-cts-time-lags-fmax.fits");
r=load_rmf("IRAS13224-3809-hi-cts-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE


Fit ECM


#+BEGIN_EXAMPLE


#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/

** Medflux: for $~f_{max}$ = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/lagfreq_multi_script.sl=

Lags found


| 7.083333e-05 | 2.083333e-05 |  6.744005e+02 | 1.075213e+02 |
| 1.298611e-04 | 3.819444e-05 |  1.153358e+02 | 7.014495e+01 |
| 2.380787e-04 | 7.002315e-05 |  4.775480e+01 | 3.109980e+01 |
| 4.364776e-04 | 1.283758e-04 | -3.515540e+01 | 1.218787e+01 |
| 8.002090e-04 | 2.353556e-04 | -3.170385e+01 | 5.534643e+00 |
| 1.467050e-03 | 4.314852e-04 | -2.177732e+01 | 2.995375e+00 |
| 2.689591e-03 | 7.910563e-04 | -6.073837e+00 | 1.546086e+00 |



#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_lagfreq_medflux_fmax.gif

Create fits & respones files

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-medflux-time-lags-fmax.fits");
r=load_rmf("IRAS13224-3809-medflux-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE


Fit ECM


#+BEGIN_EXAMPLE


#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/

** Lo-flux: for $~f_{max}$ = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/lagfreq_loflux.sl=

Lags found


| 7.083333e-05 | 2.083333e-05 |  2.871740e+02 | 2.226201e+02 |
| 1.298611e-04 | 3.819444e-05 |  3.620365e+02 | 1.743542e+02 |
| 2.380787e-04 | 7.002315e-05 |  9.489076e+01 | 9.817560e+01 |
| 4.364776e-04 | 1.283758e-04 | -7.639594e+01 | 3.422604e+01 |
| 8.002090e-04 | 2.353556e-04 | -5.886574e+01 | 1.486053e+01 |
| 1.467050e-03 | 4.314852e-04 | -3.813417e+01 | 7.667376e+00 |
| 2.689591e-03 | 7.910563e-04 |  4.591165e+00 | 4.134213e+00 |



#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_lagfreq_loflux_fmax.gif

Create fits & respones files

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-loflux-time-lags-fmax.fits");
r=load_rmf("IRAS13224-3809-loflux-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE


Fit ECM


#+BEGIN_EXAMPLE


#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/

** Lo-cts<20: for $~f_{max}$ = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/lagfreq_lo_cts_lc_data.sl=

Lags found


| 7.083333e-05 | 2.083333e-05 |  6.571534e+02 | 1.328373e+02 |
| 1.298611e-04 | 3.819444e-05 |  2.144514e+01 | 9.448135e+01 |
| 2.380787e-04 | 7.002315e-05 |  7.496660e+01 | 3.864880e+01 |
| 4.364776e-04 | 1.283758e-04 | -4.166728e+01 | 1.438416e+01 |
| 8.002090e-04 | 2.353556e-04 | -3.471094e+01 | 6.786426e+00 |
| 1.467050e-03 | 4.314852e-04 | -2.424331e+01 | 3.609670e+00 |
| 2.689591e-03 | 7.910563e-04 | -6.230490e+00 | 1.908649e+00 |


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_lagfreq_loflux_fmax.gif

Create fits & respones files

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-lo-cts-time-lags-fmax.fits");
r=load_rmf("IRAS13224-3809-lo-cts-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE


Fit ECM


#+BEGIN_EXAMPLE


#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/

** All fmax lag groups together

PATH =/home/steff075/phd_ecm/IRAS13224-3809/IRAS13224-lag-results-All-fmax.vsz=

Importing: =IRAS13224-lag-results-fmax.csv=


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-lag-results-All-fmax.png

pdf at:

http://www.star.bris.ac.uk/steff/ecm/IRAS13224-lag-results-All-fmax.pdf


** OBS: 0110890101 $~f_{max} = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/lagfreq_0110890101_segs.sl=

Lags found

#+BEGIN_EXAMPLE
1.085714e-04,2.857143e-05,5.653414e+02,4.192824e+02
1.861224e-04,4.897959e-05,-2.729925e+01,2.105225e+02
3.190671e-04,8.396501e-05,2.261247e+01,1.003749e+02
5.469721e-04,1.439400e-04,8.773214e+01,5.805564e+01
9.376664e-04,2.467543e-04,-6.179177e+00,2.730958e+01
1.607428e-03,4.230074e-04,-1.220468e+01,1.436716e+01
2.755591e-03,7.251556e-04,1.695148e+00,6.930887e+00
#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0110890101_lagfreq_segs.gif

Create fits & respones files

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-comb-time-lags-fmax.fits");
r=load_rmf("IRAS13224-3809-comb-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

Fit ECM


#+BEGIN_EXAMPLE


#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/

** OBS: 0673580101 $~f_{max} = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/lagfreq_0110890101_segs.sl=

Lags found

#+BEGIN_EXAMPLE
7.083333e-05,2.083333e-05,4.047179e+02,1.602366e+02
1.298611e-04,3.819444e-05,4.966788e-01,3.118986e+02
2.380787e-04,7.002315e-05,2.164247e+02,2.470414e+02
4.364776e-04,1.283758e-04,-1.506122e+02,6.063845e+01
8.002090e-04,2.353556e-04,3.152865e+00,3.756237e+01
1.467050e-03,4.314852e-04,1.924323e+00,1.428588e+01
2.689591e-03,7.910563e-04,1.815148e+00,8.014087e+00

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0673580101_lagfreq_segs.gif

Create fits & respones files

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0673580101-time-lags-fmax.fits");
r=load_rmf("IRAS13224-3809-0673580101-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

** OBS: 0673580201 $~f_{max} = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/lagfreq_0110890201_segs.sl=

Lags found

#+BEGIN_EXAMPLE
7.083333e-05,2.083333e-05,6.247906e+02,3.061137e+02
1.298611e-04,3.819444e-05,5.575001e+02,1.753896e+02
2.380787e-04,7.002315e-05,-3.938316e+00,8.379908e+01
4.364776e-04,1.283758e-04,7.081461e+01,5.821883e+01
8.002090e-04,2.353556e-04,1.244237e+00,1.952472e+01
1.467050e-03,4.314852e-04,-2.712603e+01,1.272134e+01
2.689591e-03,7.910563e-04,-6.734292e+00,5.821462e+00
#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0673580201_lagfreq_segs.gif

Create fits & respones files

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0673580201-time-lags-fmax.fits");
r=load_rmf("IRAS13224-3809-0673580201-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

** OBS: 0673580301 $~f_{max} = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/lagfreq_0110890301_segs.sl=

Lags found

#+BEGIN_EXAMPLE
7.083333e-05,2.083333e-05,3.719778e+02,4.150101e+02
1.298611e-04,3.819444e-05,3.842502e+02,1.772887e+02
2.380787e-04,7.002315e-05,1.319902e+01,1.059566e+02
4.364776e-04,1.283758e-04,3.584630e+01,4.926134e+01
8.002090e-04,2.353556e-04,-1.203126e+02,2.172508e+01
1.467050e-03,4.314852e-04,-2.841632e+01,1.251139e+01
2.689591e-03,7.910563e-04,4.563036e+00,6.655548e+00
#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0673580301_lagfreq_segs.gif

Create fits & respones files

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0673580301-time-lags-fmax.fits");
r=load_rmf("IRAS13224-3809-0673580301-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

** OBS: 0673580401 $~f_{max} = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/lagfreq_0110890401_segs.sl=

Lags found

#+BEGIN_EXAMPLE
7.083333e-05,2.083333e-05,5.266090e+02,2.726993e+02
1.298611e-04,3.819444e-05,-9.462809e+01,1.778824e+02
2.380787e-04,7.002315e-05,-2.265662e+02,4.836129e+01
4.364776e-04,1.283758e-04,-7.685915e+01,4.220672e+01
8.002090e-04,2.353556e-04,-4.913205e+01,1.689221e+01
1.467050e-03,4.314852e-04,-1.724365e+01,8.779869e+00
2.689591e-03,7.910563e-04,-6.502086e+00,4.877373e+00

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0673580401_lagfreq_segs.gif

Create fits & respones files

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0673580401-time-lags-fmax.fits");
r=load_rmf("IRAS13224-3809-0673580401-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

** OBS: 0780560101 $~f_{max} = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/lagfreq_0780560101_segs.sl=

Lags found

#+BEGIN_EXAMPLE
1.085714e-04,2.857143e-05,4.830241e+02,2.648113e+02
1.861224e-04,4.897959e-05,1.841068e+02,1.608516e+02
3.190671e-04,8.396501e-05,2.946652e+02,1.455711e+02
5.469721e-04,1.439400e-04,4.566903e+01,5.330852e+01
9.376664e-04,2.467543e-04,-3.788366e+01,4.128970e+01
1.607428e-03,4.230074e-04,2.246132e+01,2.103022e+01
2.755591e-03,7.251556e-04,-1.473685e+01,8.081820e+00

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0780560101_lagfreq_segs.gif

Create fits & respones files

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0780560101-time-lags-fmax.fits");
r=load_rmf("IRAS13224-3809-0780560101-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

** OBS: 0780561301 $~f_{max} = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/lagfreq_0780561301_segs.sl=

Lags found

#+BEGIN_EXAMPLE
7.083333e-05,2.083333e-05,1.542441e+03,2.676531e+02
1.298611e-04,3.819444e-05,1.239141e+02,2.608332e+02
2.380787e-04,7.002315e-05,1.959086e+02,8.339507e+01
4.364776e-04,1.283758e-04,3.342337e+01,2.582444e+01
8.002090e-04,2.353556e-04,-1.358860e+01,1.599928e+01
1.467050e-03,4.314852e-04,-4.234219e+01,9.993571e+00
2.689591e-03,7.910563e-04,-6.196642e-01,5.684037e+00

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0780561301_lagfreq_segs.gif

Create fits & respones files

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0780561301-time-lags-fmax.fits");
r=load_rmf("IRAS13224-3809-0780561301-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

** OBS: 0780561401 $~f_{max} = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/lagfreq_0780561401_segs.sl=

Lags found

#+BEGIN_EXAMPLE
7.083333e-05,2.083333e-05,1.864317e+02,3.401785e+02
1.298611e-04,3.819444e-05,-6.026426e+02,2.103469e+02
2.380787e-04,7.002315e-05,-8.055291e+01,8.071130e+01
4.364776e-04,1.283758e-04,-9.788466e+01,4.711209e+01
8.002090e-04,2.353556e-04,-7.560154e+01,2.579713e+01
1.467050e-03,4.314852e-04,-2.761608e+01,1.159356e+01
2.689591e-03,7.910563e-04,1.872222e+00,6.203546e+00

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0780561401_lagfreq_segs.gif


Create fits & respones files

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0780561401-time-lags-fmax.fits");
r=load_rmf("IRAS13224-3809-0780561401-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

** OBS: 0780561501 $~f_{max} = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/lagfreq_0780561501_segs.sl=

Lags found

#+BEGIN_EXAMPLE
7.083333e-05,2.083333e-05,6.022653e+02,3.226929e+02
1.298611e-04,3.819444e-05,2.423351e+02,2.434007e+02
2.380787e-04,7.002315e-05,1.614389e+02,9.852909e+01
4.364776e-04,1.283758e-04,1.947468e+01,6.095783e+01
8.002090e-04,2.353556e-04,-5.779660e+00,2.240028e+01
1.467050e-03,4.314852e-04,-2.567552e+01,9.837219e+00
2.689591e-03,7.910563e-04,-1.415230e+01,5.190195e+00

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0780561501_lagfreq_segs.gif


Create fits & respones files

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0780561501-time-lags-fmax.fits");
r=load_rmf("IRAS13224-3809-0780561501-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE
** OBS: 0780561601 $~f_{max} = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/lagfreq_0780561601_segs.sl=

Lags found

#+BEGIN_EXAMPLE
7.083333e-05,2.083333e-05,4.450236e+02,2.355980e+02
1.298611e-04,3.819444e-05,-2.566982e+02,1.738044e+02
2.380787e-04,7.002315e-05,-1.511810e+02,7.497958e+01
4.364776e-04,1.283758e-04,-4.730672e+01,3.573024e+01
8.002090e-04,2.353556e-04,-5.184986e+01,1.383522e+01
1.467050e-03,4.314852e-04,-2.699276e+01,9.006343e+00
2.689591e-03,7.910563e-04,-1.972536e+01,4.742840e+00
#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0780561601_lagfreq_segs.gif

Create fits & respones files

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0780561601-time-lags-fmax.fits");
r=load_rmf("IRAS13224-3809-0780561601-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

** OBS: 0780561701 $~f_{max} = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/lagfreq_0780561701_segs.sl=

Lags found

#+BEGIN_EXAMPLE
7.083333e-05,2.083333e-05,5.071765e+02,4.812368e+02
1.298611e-04,3.819444e-05,4.503260e+02,1.767015e+02
2.380787e-04,7.002315e-05,1.077899e+02,1.020269e+02
4.364776e-04,1.283758e-04,-3.573063e+01,3.629432e+01
8.002090e-04,2.353556e-04,-2.110914e+01,1.619940e+01
1.467050e-03,4.314852e-04,-1.365392e+01,9.484278e+00
2.689591e-03,7.910563e-04,-3.005858e+00,4.767679e+00
#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0780561701_lagfreq_segs.gif

Create fits & respones files

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0780561701-time-lags-fmax.fits");
r=load_rmf("IRAS13224-3809-0780561701-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

** OBS: 0792180101 $~f_{max} = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/lagfreq_0792180101_segs.sl=

Lags found

#+BEGIN_EXAMPLE
7.083333e-05,2.083333e-05,1.048514e+03,1.655445e+02
1.298611e-04,3.819444e-05,3.236687e+02,2.975471e+02
2.380787e-04,7.002315e-05,2.844080e+01,1.144854e+02
4.364776e-04,1.283758e-04,-5.139056e+01,4.116507e+01
8.002090e-04,2.353556e-04,-2.648884e+01,1.666900e+01
1.467050e-03,4.314852e-04,-9.337301e+00,1.062999e+01
2.689591e-03,7.910563e-04,5.704731e+00,4.336145e+00

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180101_lagfreq_segs.gif


Create fits & respones files

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0792180101-time-lags-fmax.fits");
r=load_rmf("IRAS13224-3809-0792180101-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

** OBS: 0792180201 $~f_{max} = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/lagfreq_0792180201_segs.sl=

Lags found

#+BEGIN_EXAMPLE
7.083333e-05,2.083333e-05,7.119606e+02,2.553545e+02
1.298611e-04,3.819444e-05,8.418171e+02,2.343215e+02
2.380787e-04,7.002315e-05,4.394161e+02,1.075792e+02
4.364776e-04,1.283758e-04,-8.142641e+00,3.569433e+01
8.002090e-04,2.353556e-04,-7.992184e+00,1.921710e+01
1.467050e-03,4.314852e-04,-1.115233e+01,8.883178e+00
2.689591e-03,7.910563e-04,-3.604234e+00,4.587467e+00
#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180201_lagfreq_segs.gif


Create fits & respones files

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0792180201-time-lags-fmax.fits");
r=load_rmf("IRAS13224-3809-0792180201-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

** OBS: 0792180301 $~f_{max} = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/lagfreq_0792180301_segs.sl=

Lags found

#+BEGIN_EXAMPLE
7.083333e-05,2.083333e-05,2.722178e+02,2.716429e+02
1.298611e-04,3.819444e-05,3.415825e+02,2.798957e+02
2.380787e-04,7.002315e-05,2.538013e+02,1.835712e+02
4.364776e-04,1.283758e-04,-1.410011e+02,4.184583e+01
8.002090e-04,2.353556e-04,-2.955988e+01,1.855373e+01
1.467050e-03,4.314852e-04,-4.514723e+01,9.601746e+00
2.689591e-03,7.910563e-04,4.614665e+00,5.225292e+00

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180301_lagfreq_segs.gif


Create fits & respones files

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0792180301-time-lags-fmax.fits");
r=load_rmf("IRAS13224-3809-0792180301-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

** OBS: 0792180401 $~f_{max} = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/lagfreq_0792180401_segs.sl=

Lags found

#+BEGIN_EXAMPLE
7.083333e-05,2.083333e-05,1.698732e+03,4.929555e+02
1.298611e-04,3.819444e-05,4.402195e+02,1.268831e+02
2.380787e-04,7.002315e-05,9.275365e+00,9.239616e+01
4.364776e-04,1.283758e-04,-8.291837e+01,3.573280e+01
8.002090e-04,2.353556e-04,-3.078729e+01,1.922469e+01
1.467050e-03,4.314852e-04,-2.176589e+01,9.295332e+00
2.689591e-03,7.910563e-04,-1.074312e+01,5.231860e+00

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180401_lagfreq_segs.gif


Create fits & respones files

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0792180101-time-lags-fmax.fits");
r=load_rmf("IRAS13224-3809-0792180101-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE
** OBS: 0792180501 $~f_{max} = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/lagfreq_0792180501_segs.sl=

Lags found

#+BEGIN_EXAMPLE
7.083333e-05,2.083333e-05,8.805477e+02,1.976764e+02
1.298611e-04,3.819444e-05,4.776428e+02,1.836624e+02
2.380787e-04,7.002315e-05,1.181588e+02,7.727528e+01
4.364776e-04,1.283758e-04,-6.169803e+01,3.156024e+01
8.002090e-04,2.353556e-04,-5.285256e+01,1.890197e+01
1.467050e-03,4.314852e-04,-2.544754e+01,8.330762e+00
2.689591e-03,7.910563e-04,-2.674773e+00,5.099174e+00

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180501_lagfreq_segs.gif


Create fits & respones files

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0792180501-time-lags-fmax.fits");
r=load_rmf("IRAS13224-3809-0792180501-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE
** OBS: 0792180601 $~f_{max} = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/lagfreq_0792180601_segs.sl=

Lags found

#+BEGIN_EXAMPLE
7.083333e-05,2.083333e-05,7.307548e+02,7.093214e+02
1.298611e-04,3.819444e-05,4.643938e+02,1.048797e+02
2.380787e-04,7.002315e-05,9.553984e+01,8.152410e+01
4.364776e-04,1.283758e-04,-5.323358e+01,3.713090e+01
8.002090e-04,2.353556e-04,-3.444072e+01,1.554056e+01
1.467050e-03,4.314852e-04,-2.214600e+01,9.941035e+00
2.689591e-03,7.910563e-04,-6.228050e+00,4.354478e+00

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180601_lagfreq_segs.gif


Create fits & respones files

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0792180601-time-lags-fmax.fits");
r=load_rmf("IRAS13224-3809-0792180601-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE
** Results

PATH = =/home/steff075/phd_ecm/results-spectral/IRAS_flux_lag_relxill_indobs.ods=

|  IRAS_obs | IRAS_Ledd | IRAS_Lbol/erg s-1 | IRAS_LogLbol |     IRAS_Edd_frac | IRAS_NED-DL | IRAS_Soft-lag |       +- | IRAS_Soft-lag-freq |       +- | IRAS_totalcounts | IRAS-exp/ks | IRAS-L03-10 = (4*PI()*(H22)*P2) | IRAS-L2-10 | IRAS-spec-03-10-flux | IRAS-spec-2-10-flux | IRAS-Relxill-gamma |    + |    - | IRAS-Relxill-ionise |        + |    - | IRAS-Relxill-Afe |    + |    - | IRAS-Relxill-RF |        + |        - | IRAS-Relxill-incl |     + |     - | IRAS-Cvr-Frac |    + |        - |  IRAS-nH |        + |      - |
| 110890101 |  7.95E+44 |          5.50E+45 |         45.7 | 0.006777884429153 |    9.57E+26 |      2.73E+01 | 2.11E+02 |           1.86E-04 | 4.90E-05 |         1.01E+05 |       54.76 |           1.39474337202327E+043 |   5.39E+42 |             1.21E-12 |            4.69E-13 |               3.21 | 0.17 | 0.22 |                2.26 |     0.24 | 0.27 |              0.5 | 0.39 |    0 |              10 |        0 |     2.07 |             67.55 |   6.6 |  3.12 |           0.7 | 0.07 |     0.18 | 9.69E-01 | 1.75E+01 | 0.5858 |
| 673580101 |  7.95E+44 |          5.50E+45 |         45.7 |  0.00904960417871 |    9.57E+26 |      1.51E+02 | 6.06E+01 |           4.36E-04 | 1.28E-04 |         1.09E+05 |      42.958 |           2.10685687651793E+043 |   7.19E+42 |             1.83E-12 |            6.26E-13 |               3.23 | 0.12 | 0.09 |                1.93 |     0.17 |  0.4 |             6.93 | 3.07 | 2.55 |              10 |        0 |     2.58 |             64.92 |  9.72 |  5.23 |           0.4 | 0.15 |     0.14 | 1.64E+01 |  2287.59 |  0.817 |
| 673580201 |  7.95E+44 |          5.50E+45 |         45.7 | 0.007369771961426 |    9.57E+26 |      2.71E+01 | 1.27E+01 |           1.47E-03 | 4.31E-04 |         1.74E+05 |      91.945 |           1.42685066193321E+043 |   5.86E+42 |             1.24E-12 |            5.10E-13 |               3.11 | 0.18 | 0.16 |                1.77 |     0.42 | 0.38 |              0.5 | 2.97 |    0 |             9.3 |     0.69 |     2.95 |                80 |     0 | 12.69 |           0.6 | 0.15 |     0.14 |     0.38 |    0.185 |  0.082 |
| 673580301 |  7.95E+44 |          5.50E+45 |         45.7 | 0.003918925500685 |    9.57E+26 |      1.20E+02 | 2.17E+01 |           8.00E-04 | 2.35E-04 |         8.89E+04 |      76.187 |             6.776968650707E+042 |   3.12E+42 |             5.89E-13 |            2.71E-13 |               3.14 | 0.19 | 0.12 |                1.46 |     0.72 | 0.34 |              0.5 | 0.41 |    0 |              10 |        0 |     3.42 |             63.96 | 12.39 |  4.38 |          0.64 | 0.18 |     0.11 |    0.317 |    23.23 | 0.0059 |
| 673580401 |  7.95E+44 |          5.50E+45 |         45.7 | 0.007730886522048 |    9.57E+26 |      2.27E+02 | 4.84E+01 |           2.38E-04 | 7.00E-05 |         2.17E+05 |     104.938 |           1.53512089791705E+043 |   6.15E+42 |             1.33E-12 |            5.34E-13 |               3.14 | 0.16 | 0.15 |                1.45 |     0.39 | 0.15 |              0.5 | 2.91 |    0 |              10 |        0 |     3.45 |             79.07 |  0.93 |   9.9 |          0.57 | 0.09 |      0.1 |    0.313 |     0.01 | 0.0052 |
| 780560101 |  7.95E+44 |          5.50E+45 |         45.7 | 0.005527887081699 |    9.57E+26 |      3.79E+01 | 4.13E+01 |           9.38E-04 | 2.47E-04 |         6.83E+04 |      31.859 |           1.11441843574543E+043 |   4.39E+42 |             9.69E-13 |            3.82E-13 |                3.4 |    0 | 0.06 |                2.14 |     0.22 | 0.14 |              0.5 |  1.5 |    0 |              10 |        0 |     1.11 |             67.41 |   3.7 |  2.26 |          0.83 | 0.03 |     0.03 |    0.362 |     0.05 |   0.05 |
| 780561301 |  7.95E+44 |          5.50E+45 |         45.7 | 0.007760761766766 |    9.57E+26 |      4.23E+01 | 9.99E+00 |           1.47E-03 | 4.31E-04 |         2.81E+05 |     117.957 |           1.73540819722049E+043 |   6.17E+42 |             1.51E-12 |            5.37E-13 |               3.32 | 0.07 | 0.07 |                2.17 | 2.00E-01 | 0.13 |              0.5 | 0.28 |    0 |              10 |        0 |     0.83 |             75.91 |  3.31 |  2.98 |          0.62 | 0.07 |     0.04 |     3.84 |     4.82 |   2.38 |
| 780561401 |  7.95E+44 |          5.50E+45 |         45.7 |  0.00894838842851 |    9.57E+26 |      6.03E+02 | 2.10E+02 |           2.30E-04 | 3.19E-05 |         2.11E+05 |       76.21 |           1.90945666875047E+043 |   7.11E+42 |             1.66E-12 |            6.19E-13 |               3.26 | 0.14 | 0.15 |                2.03 |     0.29 | 0.26 |              0.5 | 1.37 |    0 |              10 |        0 |     1.74 |              73.7 |  3.61 |  3.12 |          0.65 | 0.05 | 1.30E-01 |     0.29 |     0.05 |   0.06 |
| 780561501 |  7.95E+44 |          5.50E+45 |         45.7 | 0.004764618848551 |    9.57E+26 |      2.57E+01 | 9.84E+00 |           1.47E-03 | 4.31E-04 |         1.76E+05 |     117.074 |            8.4485464766244E+042 |   3.79E+42 |             7.35E-13 |            3.29E-13 |               3.36 | 0.04 | 0.12 |                1.91 |     0.16 | 0.19 |             0.96 | 1.71 | 0.46 |              10 |        0 |     1.56 |             66.95 |  6.15 |  4.11 |          0.78 | 0.04 |     0.05 |     8.66 |     9.98 |   8.88 |
| 780561601 |  7.95E+44 |          5.50E+45 |         45.7 | 0.010972210704442 |    9.57E+26 |      2.57E+02 | 1.74E+02 |           1.30E-04 | 3.82E-05 |         4.08E+05 |     117.954 |           2.46839951180331E+043 |   8.72E+42 |             2.15E-12 |            7.59E-13 |                3.3 | 0.07 | 0.09 |                2.18 |     0.21 | 0.14 |              0.5 | 0.26 |    0 |              10 |        0 |     1.13 |             77.41 |  2.58 |  2.54 |           0.6 | 0.07 |     0.07 |    0.917 |     0.27 |  0.317 |
| 780561701 |  7.95E+44 |          5.50E+45 |         45.7 | 0.005743943400254 |    9.57E+26 |      3.57E+01 | 3.63E+01 |           4.36E-04 | 1.28E-04 |         2.23E+05 |     127.117 |           1.13826189123344E+043 |   4.57E+42 |             9.90E-13 |            3.97E-13 |               3.32 | 0.08 | 0.15 |                 2.1 |     0.22 | 0.31 |              0.5 | 2.79 |    0 |              10 |        0 |      1.3 |             70.19 |  4.91 |  3.86 |          0.66 | 0.07 |     0.15 |    1.949 |     3.19 |   0.56 |
| 792180101 |  7.95E+44 |          5.50E+45 |         45.7 | 0.005480011843767 |    9.57E+26 |      5.14E+01 | 4.12E+01 |           4.36E-04 | 1.28E-04 |         1.83E+05 |     114.179 |            9.7551554312406E+042 |   4.36E+42 |             8.48E-13 |            3.79E-13 |               3.19 | 0.09 | 0.13 |                1.92 |     0.13 | 0.21 |             0.99 | 2.11 | 0.49 |              10 |        0 |     1.32 |             69.02 |   4.2 |  2.33 |          0.76 | 0.04 |     0.07 |     0.23 |     0.04 |   0.03 |
| 792180201 |  7.95E+44 |          5.50E+45 |         45.7 | 0.005964846057189 |    9.57E+26 |      1.12E+01 | 8.88E+00 |           1.47E-03 | 4.31E-04 |         1.20E+02 |      119.63 |           1.21020898155548E+043 |   4.74E+42 |             1.05E-12 |            4.12E-13 |                3.3 | 0.07 | 0.17 |                2.11 |     0.19 |  0.1 |              0.5 | 0.22 |    0 |              10 |        0 |     0.62 |             69.15 |  2.82 |  1.97 |          0.67 | 0.04 |     0.12 |      2.4 |     0.68 |   0.59 |
| 792180301 |  7.95E+44 |          5.50E+45 |         45.7 | 0.003560673393694 |    9.57E+26 |      1.41E+02 | 4.18E+01 |           4.36E-04 | 1.28E-04 |         1.08E+05 |     119.508 |            5.8037950631359E+042 |   2.83E+42 |             5.05E-13 |            2.46E-13 |               3.33 | 0.07 | 0.17 |                1.84 |     0.54 | 0.71 |              2.8 | 3.91 |  2.3 |              10 |        0 |     3.64 |             58.47 | 12.91 |  9.32 |          0.76 | 0.08 |     0.07 |     3.15 |     6.86 |   2.61 |
| 792180401 |  7.95E+44 |          5.50E+45 |         45.7 | 0.017576078147079 |    9.57E+26 |      8.29E+01 | 3.57E+01 |           4.36E-04 | 1.28E-04 |         5.22E+05 |     111.297 |           3.96198708997569E+043 |   1.40E+43 |             3.45E-12 |            1.22E-12 |               3.01 | 0.04 | 0.03 |                1.11 |     0.16 | 0.08 |             2.35 | 0.98 | 1.13 |              10 | 0.00E+00 | 4.30E-01 |             79.84 |  0.16 |  2.72 |          0.15 | 0.08 |     0.09 |        0 |        0 |      0 |
| 792180501 |  7.95E+44 |          5.50E+45 |         45.7 | 0.008015042413129 |    9.57E+26 |      6.17E+01 | 3.16E+01 |           4.36E-04 | 1.28E-04 |         2.19E+05 |     112.297 |           1.57013539198129E+043 |   6.37E+42 |             1.37E-12 |            5.54E-13 |               3.16 | 0.15 | 0.16 |                1.43 |     0.39 | 0.11 |              0.5 | 1.04 |    0 |              10 |        0 |     3.79 |             70.06 |  9.06 |  3.77 |          0.49 | 0.15 |     0.11 |     0.25 |     0.08 |   0.11 |
| 792180601 |  7.95E+44 |          5.50E+45 |         45.7 | 0.016559340060772 |    9.57E+26 |      5.32E+01 | 3.71E+01 |           4.36E-04 | 1.28E-04 |         5.38E+05 |     117.033 |           3.93167029545318E+043 |   1.32E+43 |             3.42E-12 |            1.14E-12 |                3.3 | 0.08 | 0.06 |                1.48 |     0.49 | 0.11 |             2.92 | 1.63 | 1.85 |              10 |        0 |     1.77 |             74.39 |  2.52 |  2.21 |          0.29 | 0.08 |     0.08 |     0.18 |     0.16 |   0.09 |

* *MCG-6-30-15*

PATH to data = =/homeb/steff075/phd_ecm/MCG-6-30-15=


** Combined

Lets just have a look at the combined flux state lag-frequencies >1e-4 Hz:

use =lagfreq_multi_script.sl=
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/MCG-6-30-15_lagfreq_comb.gif


Lags found in
=/homeb/steff075/phd_ecm/MCG-6-30-15/time_lags_comb2.csv=

+----------+----------+-----------+----------+
|     Freq |       +- |       Lag |       +- |
+----------+----------+-----------+----------+
| 7.27E-05 | 2.27E-05 | -5.17E+01 | 8.59E+01 |
+----------+----------+-----------+----------+
| 1.39E-04 | 4.34E-05 |  5.17E+01 | 4.14E+01 |
+----------+----------+-----------+----------+
| 2.65E-04 | 8.28E-05 |  1.14E+02 | 1.84E+01 |
+----------+----------+-----------+----------+
| 5.06E-04 | 1.58E-04 |  3.31E+01 | 1.04E+01 |
+----------+----------+-----------+----------+
| 9.66E-04 | 3.02E-04 | -1.59E+01 | 5.92E+00 |
+----------+----------+-----------+----------+
| 1.84E-03 | 5.76E-04 | -6.86E-01 | 3.42E+00 |
+----------+----------+-----------+----------+
| 3.52E-03 | 1.10E-03 |  2.15E+00 | 1.48E+00 |
+----------+----------+-----------+----------+

** Low - High Flux state results

Lets just have a look at the low and high flux state lag-frequencies:

use =lagfreq_multi_script.sl=

*Low flux*

Recall from the spectral fitting:
#+BEGIN_EXAMPLE
Group 1   Green      = Obs ID 0693781201 2013

Group 2   Red        = Obs ID 0029740701 2001
          Black      = Obs ID 0029740101 2001
          Yellow     = Obs ID 0029740801 2001

Group 3   Magenta    = Obs ID 0693781301 2013
          Cyan       = Obs ID 0111570201 2000

Group 4   Orange     = Obs ID 0693781401 2013
          Blue       = Obs ID 0111570101 2000
#+END_EXAMPLE

Group 1 & 2 = Hi flux and Group 3 & 4 = LO Flux

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/MCG-6-30-15_lagfreq_lo_flux.gif

Lags found in =/homeb/steff075/phd_ecm/MCG-6-30-15/time_lags_lo_flux.csv=
+----------+----------+-----------+----------+
|     Freq |       +- |       Lag |       +- |
+----------+----------+-----------+----------+
| 7.27E-05 | 2.27E-05 | -4.97E+01 | 1.03E+02 |
+----------+----------+-----------+----------+
| 1.39E-04 | 4.34E-05 |  5.14E+01 | 5.15E+01 |
+----------+----------+-----------+----------+
| 2.65E-04 | 8.28E-05 |  1.16E+02 | 2.25E+01 |
+----------+----------+-----------+----------+
| 5.06E-04 | 1.58E-04 |  3.28E+01 | 1.29E+01 |
+----------+----------+-----------+----------+
| 9.66E-04 | 3.02E-04 | -1.61E+01 | 7.11E+00 |
+----------+----------+-----------+----------+
| 1.84E-03 | 5.76E-04 | -1.60E+00 | 4.17E+00 |
+----------+----------+-----------+----------+
| 3.52E-03 | 1.10E-03 |  2.30E+00 | 1.82E+00 |
+----------+----------+-----------+----------+



*High flux*

Grp 2 & 1

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/MCG-6-30-15_lagfreq_hi_flux.gif

Lags found:
file =/homeb/steff075/phd_ecm/MCG-6-30-15/time_lags_hi-flux2.csv=
+----------+----------+-----------+----------+
|     Freq |       +- |       Lag |       +- |
+----------+----------+-----------+----------+
| 7.27E-05 | 2.27E-05 | -6.59E+01 | 1.70E+02 |
+----------+----------+-----------+----------+
| 1.39E-04 | 4.34E-05 |  5.27E+01 | 7.00E+01 |
+----------+----------+-----------+----------+
| 2.65E-04 | 8.28E-05 |  1.07E+02 | 3.50E+01 |
+----------+----------+-----------+----------+
| 5.06E-04 | 1.58E-04 |  3.40E+01 | 1.75E+01 |
+----------+----------+-----------+----------+
| 9.66E-04 | 3.02E-04 | -1.52E+01 | 1.16E+01 |
+----------+----------+-----------+----------+
| 1.84E-03 | 5.76E-04 |  2.72E+00 | 6.28E+00 |
+----------+----------+-----------+----------+
| 3.52E-03 | 1.10E-03 |  1.63E+00 | 2.61E+00 |
+----------+----------+-----------+----------+


Lets combine these results in Veusz

Use =homeb/steff075/phd_ecm/MCG-6-30-15/-lag-results.ods= to obtain
the csv

Plot =homeb/steff075/phd_ecm/MCG-6-30-15/-lag-results-lo-hi.vsz=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/MCG-lag-results-lo-hi-flux.png


pdf at:

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/MCG-lag-results-lo-hi-flux.pdf




*Genegenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28
accordingly. Run fits files to check:

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
%d=load_data("MCG-6-30-15-time-lags-combined.fits");
%r=load_rmf("MCG-6-30-15-time-lags-combined.rsp");
%d=load_data("MCG-6-30-15-time-lags-lo-flux.fits");
%r=load_rmf("MCG-6-30-15-time-lags-lo-flux.rsp");
d=load_data("MCG-6-30-15-time-lags-hi-flux.fits");
r=load_rmf("MCG-6-30-15-time-lags-hi-flux.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

Now copy these the BC4 for fitting to ECM model, e.g:

#+BEGIN_EXAMPLE
scp MCG-6-30-15-time-lags-hi-flux.fits so14935@bc4login.acrc.bris.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/MCG-6-30-15-time-lag-fits
#+END_EXAMPLE

** OBS 0029740101 (2001)

Use script =/homeb/steff075/phd_ecm/MCG-6-30-15/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,1.427193e+02,1.015927e+02
1.388430e-04,7.742604e+01,1.561513e+02
2.650639e-04,1.211790e+02,5.742994e+01
5.060310e-04,1.514027e+01,2.987309e+01
9.660592e-04,-3.869375e+01,2.038701e+01
1.844295e-03,-1.276668e+01,2.729193e+01
3.520927e-03,3.457619e+01,3.026655e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/MCG-6-30-15_0029740101_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("MCG-6-30-15_0029740101_time_lags.fits");
r=load_rmf("MCG-6-30-15_0029740101_time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0029740701 (2001)

Use script =/homeb/steff075/phd_ecm/MCG-6-30-15/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,-4.677927e+01,1.704360e+02
1.388430e-04,-7.493412e+01,1.052249e+02
2.650639e-04,1.456515e+02,4.279304e+01
5.060310e-04,3.588820e+01,2.193817e+01
9.660592e-04,-1.300259e+01,1.587164e+01
1.844295e-03,-2.338514e+01,1.713352e+01
3.520927e-03,-9.986784e+00,1.589998e+01
#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/MCG-6-30-15_0029740701_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("MCG-6-30-15_0029740701_time_lags.fits");
r=load_rmf("MCG-6-30-15_0029740701_time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0029740801 (2001)

Use script =/homeb/steff075/phd_ecm/MCG-6-30-15/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,-2.123339e+02,2.231180e+02
1.388430e-04,-8.322793e+01,8.356747e+01
2.650639e-04,8.650273e+01,3.570117e+01
5.060310e-04,3.415806e+01,2.239083e+01
9.660592e-04,-1.439384e+01,1.650143e+01
1.844295e-03,-3.995897e+00,1.187138e+01
3.520927e-03,6.136095e+00,1.174212e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/MCG-6-30-15_0029740801_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("MCG-6-30-15_0029740801_time_lags.fits");
r=load_rmf("MCG-6-30-15_0029740801_time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE


MCG-6-30-15_0029740801_lag-freq.PNG

** OBS 0111570101 (2000)

Use script =/homeb/steff075/phd_ecm/MCG-6-30-15/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.309091e-04,-1.037298e+02,1.082270e+02
2.499174e-04,-1.271545e+02,1.102962e+02
4.771150e-04,8.533723e+01,3.960779e+01
9.108558e-04,-9.388362e+00,3.461633e+01
1.738907e-03,-4.418664e+01,3.905174e+01
3.319731e-03,-2.161955e+01,3.002109e+01
6.337668e-03,2.949353e+01,2.597570e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/MCG-6-30-15_0111570101_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("MCG-6-30-15_0111570101_time_lags.fits");
r=load_rmf("MCG-6-30-15_0111570101_time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0111570201 (2000)

Use script =/homeb/steff075/phd_ecm/MCG-6-30-15/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.309091e-04,5.387685e+02,1.598592e+02
2.499174e-04,2.935090e+02,8.061462e+01
4.771150e-04,6.561031e+01,4.912665e+01
9.108558e-04,-2.634458e+01,2.235300e+01
1.738907e-03,1.126269e+01,2.127794e+01
3.319731e-03,7.095586e+00,4.510465e+01
6.337668e-03,1.734148e+01,1.745122e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/MCG-6-30-15_0111570201_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("MCG-6-30-15_0111570201_time_lags.fits");
r=load_rmf("MCG-6-30-15_0111570201_time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0693781201 (2013)

Use script =/homeb/steff075/phd_ecm/MCG-6-30-15/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,-8.779557e+01,2.563017e+02
1.388430e-04,1.744231e+02,8.261463e+01
2.650639e-04,1.325782e+02,5.342466e+01
5.060310e-04,4.655823e+01,3.891529e+01
9.660592e-04,-1.110576e+01,1.518689e+01
1.844295e-03,2.101032e+01,1.873372e+01
3.520927e-03,3.354224e+01,2.346506e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/MCG-6-30-15_0693781201_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("MCG-6-30-15_0693781201_time_lags.fits");
r=load_rmf("MCG-6-30-15_0693781201_time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0693781301 (2013)

Use script =/homeb/steff075/phd_ecm/MCG-6-30-15/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,1.035389e+01,2.093115e+02
1.388430e-04,-7.180707e+01,8.698825e+01
2.650639e-04,8.950406e+01,5.051134e+01
5.060310e-04,1.707549e+01,2.509879e+01
9.660592e-04,-2.432456e+01,2.344403e+01
1.844295e-03,4.933503e+01,4.290507e+01
3.520927e-03,4.145837e+01,9.836107e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/MCG-6-30-15_0693781301_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("MCG-6-30-15_0693781301_time_lags.fits");
r=load_rmf("MCG-6-30-15_0693781301_time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0693781401 (2013)

Use script =/homeb/steff075/phd_ecm/MCG-6-30-15/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,-4.070324e+02,2.801838e+02
1.388430e-04,2.809525e+02,1.580137e+02
2.650639e-04,-1.995792e+00,5.855266e+01
5.060310e-04,5.623661e+01,3.825904e+01
9.660592e-04,-6.283703e+01,3.682474e+01
1.844295e-03,-1.339534e+01,2.392610e+01
3.520927e-03,3.237633e+01,3.376640e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/MCG-6-30-15_0693781401_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("MCG-6-30-15_0693781401_time_lags.fits");
r=load_rmf("MCG-6-30-15_0693781401_time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** Combined Observations

First replot the fully combined lag-frequency  for observations
(running the absolute values for the real sum CPS):

0029740101, 0029740701, 0029740801, 0111570101

0111570201, 0693781201, 0693781301, 0693781401

Total time 709.8 ks

script = =lagfreq_comb_script.sl=
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/MCG-6-30-15_lagfreq_comb.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,-5.168579e+01,8.585187e+01
1.388430e-04,5.165160e+01,4.136285e+01
2.650639e-04,1.141486e+02,1.839940e+01
5.060310e-04,3.305268e+01,1.036176e+01
9.660592e-04,-1.594262e+01,5.918292e+00
1.844295e-03,-6.857322e-01,3.420781e+00
3.520927e-03,2.148282e+00,1.479523e+00

#+END_EXAMPLE
=/home/steff075/phd_ecm/MCG-6-30-15/time_lags_comb.csv=


Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,2.272727e-05,-5.168579e+01,8.585187e+01
1.388430e-04,4.338843e-05,5.165160e+01,4.136285e+01
2.650639e-04,8.283246e-05,1.141486e+02,1.839940e+01
5.060310e-04,1.581347e-04,3.305268e+01,1.036176e+01
9.660592e-04,3.018935e-04,-1.594262e+01,5.918292e+00
1.844295e-03,5.763421e-04,-6.857322e-01,3.420781e+00
3.520927e-03,1.100290e-03,2.148282e+00,1.479523e+00
#+END_EXAMPLE
=/home/steff075/phd_ecm/MCG-6-30-15/time_lags_comb2.csv=
*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("MCG-6-30-15-combined-time-lags.fits");
r=load_rmf("MCG-6-30-15-combined-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

PATH=/homeb/steff075/phd_ecm/MCG-6-30-15/MCG-6-30-15-time-lag-fits/MCG-6-30-15-combined-time-lags.fits=

** 2000 Observations

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0111570101, 0111570201

Total time 83.8 ks

script = =lagfreq_comb_script.sl=

*Fully Combined Lag-frequency*

http://www.star.bris.ac.uk/steff/ecm/MCG-6-30-15_lagfreq_2000comb.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,-1.587580e+02,3.419749e+02
1.388430e-04,2.490335e+02,1.199815e+02
2.650639e-04,1.842434e+02,6.548912e+01
5.060310e-04,5.287871e+01,3.029117e+01
9.660592e-04,5.298852e+00,2.134504e+01
1.844295e-03,-1.347210e+01,2.277276e+01
3.520927e-03,-2.776127e+00,2.382314e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("MCG-6-30-15-2000-time-lags.fits");
r=load_rmf("MCG-6-30-15-2000-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);


#+END_EXAMPLE

PATH =/homeb/steff075/phd_ecm/MCG-6-30-15/MCG-6-30-15-time-lag-fits/MCG-6-30-15-2000-time-lags.fits=

** 2001 Observations

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0029740101, 0029740701, 0029740801

Total time 326 ks

script = =lagfreq_comb_script.sl=

http://www.star.bris.ac.uk/steff/ecm/MCG-6-30-15_lagfreq_2001comb.gif


Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,-3.662947e+01,1.060083e+02
1.388430e-04,-4.634089e+01,6.274217e+01
2.650639e-04,1.132999e+02,2.583376e+01
5.060310e-04,3.035515e+01,1.398359e+01
9.660592e-04,-2.103726e+01,1.007362e+01
1.844295e-03,-1.078863e+01,9.205615e+00
3.520927e-03,3.659216e+00,9.770527e+00
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("MCG-6-30-15-2001-time-lags.fits");
r=load_rmf("MCG-6-30-15-2001-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH =/homeb/steff075/phd_ecm/MCG-6-30-15/MCG-6-30-15-time-lag-fits/MCG-6-30-15-2001-time-lags.fits=

** 2013 Observations

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0693781201, 0693781301, 0693781401 Total time  300 ks

script = =lagfreq_comb_script.sl=

http://www.star.bris.ac.uk/steff/ecm/MCG-6-30-15_lagfreq_2013comb.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,-7.356586e+01,1.576537e+02
1.388430e-04,1.219017e+02,5.710460e+01
2.650639e-04,1.028838e+02,3.347726e+01
5.060310e-04,3.574474e+01,2.135190e+01
9.660592e-04,-1.582871e+01,1.124421e+01
1.844295e-03,2.231078e+01,1.486288e+01
3.520927e-03,3.414840e+01,1.961695e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("MCG-6-30-15-2013-time-lags.fits");
r=load_rmf("MCG-6-30-15-2013-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH =/homeb/steff075/phd_ecm/MCG-6-30-15/MCG-6-30-15-time-lag-fits/MCG-6-30-15-2013-time-lags.fits=

** Group 1 Observation Spectra

*Lag-frequency*

Lets have a look at the lag frequency for this single observation:

Use script =lagfreq_comb_script_Grp1.sl=

Lag values:
#+BEGIN_EXAMPLE
7.272727e-05,-8.779557e+01,2.563017e+02
1.388430e-04,1.744231e+02,8.261463e+01
2.650639e-04,1.325782e+02,5.342466e+01
5.060310e-04,4.655823e+01,3.891529e+01
9.660592e-04,-1.110576e+01,1.518689e+01
1.844295e-03,2.101032e+01,1.873372e+01
3.520927e-03,3.354224e+01,2.346506e+01
#+END_EXAMPLE
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/MCG-6-30-15_lagfreq_Grp1.gif


*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("MCG-6-30-15-Grp1-time-lags.fits");
r=load_rmf("MCG-6-30-15-Grp1-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

PATH =/homeb/steff075/phd_ecm/MCG-6-30-15/MCG-6-30-15-time-lag-fits/MCG-6-30-15-Grp1-time-lags.fits=

** Group 2 Observation Spectra

See 2001 Observations (below)

** Group 3 Observation Spectra

*Lag-frequency*

Lets have a look at the lag frequency for this single observation:

Use script =lagfreq_comb_script_Grp3.sl=


Lag values:
#+BEGIN_EXAMPLE
7.272727e-05,-5.997243e+00,1.742025e+02
1.388430e-04,5.935119e+01,8.805330e+01
2.650639e-04,1.457499e+02,4.354972e+01
5.060310e-04,2.670099e+01,2.365685e+01
9.660592e-04,-1.921948e+01,1.755801e+01
1.844295e-03,3.007646e+01,2.547866e+01
3.520927e-03,1.975474e+01,5.875001e+01
#+END_EXAMPLE
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/MCG-6-30-15_lagfreq_Grp3.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("MCG-6-30-15-Grp3-time-lags.fits");
r=load_rmf("MCG-6-30-15-Grp3-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

PATH
=/homeb/steff075/phd_ecm/MCG-6-30-15/MCG-6-30-15-time-lag-fits/MCG-6-30-15-Grp3-time-lags.fits=

** Group 4 Observation Spectra

*Lag-frequency*

Lets have a look at the lag frequency for this single observation:

Use script =lagfreq_comb_script_Grp4.sl=

Lag values:
#+BEGIN_EXAMPLE
7.272727e-05,-5.002746e+02,4.913715e+02
1.388430e-04,2.911791e+01,1.114543e+02
2.650639e-04,-3.708199e+01,5.410802e+01
5.060310e-04,5.638735e+01,2.665518e+01
9.660592e-04,-1.276517e+01,3.223288e+01
1.844295e-03,-3.645705e+01,2.270224e+01
3.520927e-03,1.187429e+01,2.222687e+01
#+END_EXAMPLE
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/MCG-6-30-15_lagfreq_Grp4.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("MCG-6-30-15-Grp4-time-lags.fits");
r=load_rmf("MCG-6-30-15-Grp4-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

PATH
=/homeb/steff075/phd_ecm/MCG-6-30-15/MCG-6-30-15-time-lag-fits/MCG-6-30-15-Grp4-time-lags.fits=

* *Mrk335*
** Combined

Lets just have a look at the combined flux state lag-frequencies >1e-4 Hz:

use =lagfreq_multi_script.sl=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk335_lagfreq_comb.gif

Lags found in
=/homeb/steff075/phd_ecm/Mrk335/lagvalues_combined.txt=

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
|         Freq |           +- |       Lag |       +- |
| 7.272727E-05 | 2.272727E-05 |  318.2114 | 172.4674 |
|  0.000138843 | 4.338843E-05 |  43.28358 | 69.33345 |
| 0.0002650639 | 8.283246E-05 | -132.6986 | 36.38826 |
|  0.000506031 | 0.0001581347 | -9.338724 | 22.92557 |
| 0.0009660592 | 0.0003018935 | -22.52562 | 15.48116 |
|  0.001844295 | 0.0005763421 |  7.135439 | 6.110641 |
|  0.003520927 |   0.00110029 | -4.440452 | 2.296716 |




** Low - High Flux state results

Lets just have a look at the low and high flux state lag-frequencies:

use =lagfreq_multi_script.sl=

*Low flux*

Recall from the spectral fitting:
#+BEGIN_EXAMPLE
Group 1    Magenta   = Obs ID 0306870101   2006

Group 2    Green     = Obs ID 0600540501   2009
           Blue      = Obs ID 0600540601   2009
#+END_EXAMPLE

Group 1  = Hi flux and Group 2 & 3 = Lo Flux

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk335_lagfreq_lo_flux.gif

Lags found in =/homeb/steff075/phd_ecm/Mrk335/time_lags_lo_flux2.csv=

+----------+----------+-----------+----------+
|     Freq |       +- |       Lag |       +- |
+----------+----------+-----------+----------+
| 7.27E-05 | 2.27E-05 |  1.61E+02 | 4.52E+02 |
+----------+----------+-----------+----------+
| 1.39E-04 | 4.34E-05 |  1.72E+01 | 1.45E+02 |
+----------+----------+-----------+----------+
| 2.65E-04 | 8.28E-05 |  6.08E+01 | 7.09E+01 |
+----------+----------+-----------+----------+
| 5.06E-04 | 1.58E-04 | -2.40E+01 | 4.72E+01 |
+----------+----------+-----------+----------+
| 9.66E-04 | 3.02E-04 |  1.34E+01 | 1.94E+01 |
+----------+----------+-----------+----------+
| 1.84E-03 | 5.76E-04 |  6.46E+00 | 7.58E+00 |
+----------+----------+-----------+----------+
| 3.52E-03 | 1.10E-03 | -2.03E+00 | 2.88E+00 |
+----------+----------+-----------+----------+


*High flux*

"0673580301" was dominating the hi-flux regions

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk335_0306870101_lag-freq.gif

Lags found:
file =/homeb/steff075/phd_ecm/Mrk335/time_lags_hi_flux2.csv=

#+BEGIN_EXAMPLE
7.272727e-05,2.272727e-05,3.246800e+02,2.470253e+02
1.388430e-04,4.338843e-05,4.413164e+01,1.088097e+02
2.650639e-04,8.283246e-05,-1.413810e+02,5.630428e+01
5.060310e-04,1.581347e-04,-8.343145e+00,3.475208e+01
9.660592e-04,3.018935e-04,-2.815184e+01,2.481506e+01
1.844295e-03,5.763421e-04,7.264772e+00,9.809402e+00
3.520927e-03,1.100290e-03,-4.903463e+00,3.689522e+00
#+END_EXAMPLE

Lets combine these results in Veusz

Use =homeb/steff075/phd_ecm/Mrk335/lag-results.ods= to obtain
the csv

Plot =homeb/steff075/phd_ecm/Mrk335/Mrk335-lag-results-lo-hi-flux.vsz=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/Mrk335-lag-results-lo-hi-flux.png

pdf at
http://www.star.bris.ac.uk/steff/ecm/Mrk335-lag-results-lo-hi-flux.pdf



*Genegenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28
accordingly. Run fits files to check:

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
%d=load_data("Mrk335-time-lags-combined.fits");
%r=load_rmf("Mrk335-time-lags-combined.rsp");
d=load_data("Mrk335-time-lags-lo-flux.fits");
r=load_rmf("Mrk335-time-lags-lo-flux.rsp");
%d=load_data("Mrk335-time-lags-hi-flux.fits");
%r=load_rmf("Mrk335-time-lags-hi-flux.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

Now copy these the BC4 for fitting to ECM model, e.g:

#+BEGIN_EXAMPLE
scp Mrk335-time-lags-hi-flux.fits so14935@bc4login.acrc.bris.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/Mrk335-time-lag-fits
#+END_EXAMPLE

** OBS 0306870101 (2006)

Use script =/homeb/steff075/phd_ecm/MCG-6-30-15/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,2.272727e-05,3.246800e+02,2.470253e+02
1.388430e-04,4.338843e-05,4.413164e+01,1.088097e+02
2.650639e-04,8.283246e-05,-1.413810e+02,5.630428e+01
5.060310e-04,1.581347e-04,-8.343145e+00,3.475208e+01
9.660592e-04,3.018935e-04,-2.815184e+01,2.481506e+01
1.844295e-03,5.763421e-04,7.264772e+00,9.809402e+00
3.520927e-03,1.100290e-03,-4.903463e+00,3.689522e+00
#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk335_0306870101_lag-freq.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("Mrk335_0306870101_time_lags.fits");
r=load_rmf(" Mrk335_0306870101_time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0600540501 (2009)

Use script =/homeb/steff075/phd_ecm/Mrk335/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,1.725291e+03,3.606506e+02
1.388430e-04,2.882922e+00,2.395584e+02
2.650639e-04,6.877266e+01,1.394006e+02
5.060310e-04,1.923891e+01,9.810082e+01
9.660592e-04,1.186868e+02,8.706655e+01
1.844295e-03,9.485179e+01,5.855885e+01
3.520927e-03,-7.100115e+01,5.612223e+01


#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk335_0600540501_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("Mrk335_0600540501_time_lags.fits");
r=load_rmf("Mrk335_0600540501_time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0600540601 (2009)

Use script =/homeb/steff075/phd_ecm/Mrk335/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,-8.537458e+02,2.053641e+02
1.388430e-04,4.121348e+01,1.668612e+02
2.650639e-04,6.981009e+01,1.180064e+02
5.060310e-04,-4.428630e+02,3.585811e+02
9.660592e-04,-1.836189e+02,1.848726e+02
1.844295e-03,-1.861554e+02,1.180402e+02
3.520927e-03,1.230107e+02,2.677545e+02

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk335_0600540601_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("Mrk335_0600540601_time_lags.fits");
r=load_rmf("Mrk335_0600540601_time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** Combined observations

PATH to data = =/homeb/steff075/phd_ecm/Mrk335=

Data used here: Observations 0306870101, 0600540501 and 0600540601
Totalling 307 ks.

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0306870101, 0600540501, 0600540601

Total time 307  ks

script = =lagfreq_comb_script.sl=

http://www.star.bris.ac.uk/steff/ecm/Mrk335_lagfreq_comb.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,3.182114e+02,1.724674e+02
1.388430e-04,4.328358e+01,6.933345e+01
2.650639e-04,-1.326986e+02,3.638826e+01
5.060310e-04,-9.338724e+00,2.292557e+01
9.660592e-04,-2.252562e+01,1.548116e+01
1.844295e-03,7.135439e+00,6.110641e+00
3.520927e-03,-4.440452e+00,2.296716e+00
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("Mrk335-combined-time-lags.fits");
r=load_rmf("Mrk335-combined-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH =/homeb/steff075/phd_ecm/Mrk335/Mrk335-time-lag-fits/Mrk335-combined-time-lags.fits=

** 2006 Observations

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0306870101

Total time 120 ks

script = =lagfreq_comb2006_script.sl=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk335_lagfreq2006.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,3.246800e+02,2.470253e+02
1.388430e-04,4.418189e+01,1.096920e+02
2.650639e-04,-1.415494e+02,5.657757e+01
5.060310e-04,-8.941512e+00,4.001724e+01
9.660592e-04,-2.095583e+02,1.655163e+02
1.844295e-03,2.238881e+02,8.791354e+01
3.520927e-03,-3.328006e+01,2.639730e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("Mrk335-2006-time-lags.fits");
r=load_rmf("Mrk335-2006-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH =/homeb/steff075/phd_ecm/Mrk335/Mrk335-time-lag-fits/Mrk335-2006-time-lags.fits=

** 2009 Observations

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0600540501, 0600540601 Total time 187 ks

script = =lagfreq_comb2009_script.sl=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk335_lagfreq2009.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,1.614270e+02,4.530223e+02
1.388430e-04,1.731124e+01,1.490787e+02
2.650639e-04,6.927441e+01,9.155664e+01
5.060310e-04,-5.495287e+01,1.246708e+02
9.660592e-04,6.312222e+01,1.036693e+02
1.844295e-03,9.257760e+01,1.048095e+02
3.520927e-03,-7.807664e+01,7.766242e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("Mrk335-2009-time-lags.fits");
r=load_rmf("Mrk335-2009-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

PATH
=/homeb/steff075/phd_ecm/Mrk335/Mrk335-time-lag-fits/Mrk335-2009-time-lags.fits=

* *Mrk766*

PATH to data = =/homeb/steff075/phd_ecm/Mrk766=
** Combined

"0096020101","0109141301","0304030101","0304030301","0304030401","0304030501","0304030601","0304030701"

Lets just have a look at the combined flux state lag-frequencies >1e-4 Hz:

use =lagfreq_multi_script.sl=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk766_lagfreq_comb.PNG

Lags found in
=/homeb/steff075/phd_ecm/Mrk766/time_lags_comb2.csv=

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 7.272727e-05 | 2.272727e-05 | -8.342834e+01 | 1.358048e+02 |
+--------------+--------------+---------------+--------------+
| 1.388430e-04 | 4.338843e-05 |  1.136977e+02 | 6.280142e+01 |
+--------------+--------------+---------------+--------------+
| 2.650639e-04 | 8.283246e-05 |  4.619402e+00 | 2.224789e+01 |
+--------------+--------------+---------------+--------------+
| 5.060310e-04 | 1.581347e-04 |  1.745087e+01 | 1.168099e+01 |
+--------------+--------------+---------------+--------------+
| 9.660592e-04 | 3.018935e-04 | -2.393620e+01 | 6.700960e+00 |
+--------------+--------------+---------------+--------------+
| 1.844295e-03 | 5.763421e-04 | -4.979725e+00 | 3.944270e+00 |
+--------------+--------------+---------------+--------------+
| 3.520927e-03 | 1.100290e-03 | -1.227543e+00 | 1.705415e+00 |
+--------------+--------------+---------------+--------------+


** Low - Med - High Flux state results

*Low flux*

0304030101

Lets just have a look at the low and high flux state lag-frequencies:

use =lagfreq_multi_script.sl=


Recall from the spectral fitting:
#+BEGIN_EXAMPLE
Group 1    Red      = Obs ID 0109141301 2001

Group 2    Magenta  = Obs ID 0304030501 2005
           Black    = Obs ID 0096020101 2000

Group 3    Yellow   = Obs ID 0304030601 2005
           Cyan     = Obs ID 0304030401 2005

Group 4    Orange   = Obs ID 0304030701 2005
           Blue     = Obs ID 0304030301 2005

Group 5    Green    = Obs ID 0304030101 2005
#+END_EXAMPLE

Group 1 - 4 = Hi flux and Group 5 = Lo Flux

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk766_lagfreq_lo_flux.PNG

Lags found in =/homeb/steff075/phd_ecm/ /lagvalues-lo-flux.csv=

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 7.272727e-05 | 2.272727e-05 |  1.979392e+02 | 1.749646e+02 |
+--------------+--------------+---------------+--------------+
| 1.388430e-04 | 4.338843e-05 |  8.191668e+01 | 1.714921e+02 |
+--------------+--------------+---------------+--------------+
| 2.650639e-04 | 8.283246e-05 | -1.575974e+02 | 9.818183e+01 |
+--------------+--------------+---------------+--------------+
| 5.060310e-04 | 1.581347e-04 | -9.250710e+01 | 2.759623e+01 |
+--------------+--------------+---------------+--------------+
| 9.660592e-04 | 3.018935e-04 | -1.371956e+01 | 3.067021e+01 |
+--------------+--------------+---------------+--------------+
| 1.844295e-03 | 5.763421e-04 | -1.971132e+01 | 1.198517e+01 |
+--------------+--------------+---------------+--------------+
| 3.520927e-03 | 1.100290e-03 | -1.462175e+00 | 4.527425e+00 |
+--------------+--------------+---------------+--------------+

*Medium flux*

"0096020101","0304030101","0304030301","0304030401","0304030501","0304030601","0304030701"

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk766_lagfreq_medium.PNG

Lags found:
file =/homeb/steff075/phd_ecm/Mrk766/time_lags_hi-flux2.csv=


#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 7.272727e-05 | 2.272727e-05 |  3.894394e+02 | 1.395415e+02 |
+--------------+--------------+---------------+--------------+
| 1.388430e-04 | 4.338843e-05 |  1.640381e+02 | 5.336483e+01 |
+--------------+--------------+---------------+--------------+
| 2.650639e-04 | 8.283246e-05 |  3.349792e+01 | 2.154454e+01 |
+--------------+--------------+---------------+--------------+
| 5.060310e-04 | 1.581347e-04 |  2.144011e+01 | 1.227056e+01 |
+--------------+--------------+---------------+--------------+
| 9.660592e-04 | 3.018935e-04 | -1.001726e+01 | 8.417400e+00 |
+--------------+--------------+---------------+--------------+
| 1.844295e-03 | 5.763421e-04 | -8.028224e+00 | 4.223875e+00 |
+--------------+--------------+---------------+--------------+
| 3.520927e-03 | 1.100290e-03 | -1.305111e+00 | 1.812710e+00 |
+--------------+--------------+---------------+--------------+


*High flux*


"0109141301"

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk766_lagfreq_hi_flux.PNG

Lags found:
file =/homeb/steff075/phd_ecm/Mrk766/time_lags_hi-flux2.csv=


#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 7.272727e-05 | 2.272727e-05 | -3.819927e+02 | 3.136863e+02 |
+--------------+--------------+---------------+--------------+
| 1.388430e-04 | 4.338843e-05 |  4.669289e+01 | 1.758284e+02 |
+--------------+--------------+---------------+--------------+
| 2.650639e-04 | 8.283246e-05 | -2.790312e+01 | 5.796464e+01 |
+--------------+--------------+---------------+--------------+
| 5.060310e-04 | 1.581347e-04 |  1.336908e+01 | 2.921693e+01 |
+--------------+--------------+---------------+--------------+
| 9.660592e-04 | 3.018935e-04 | -3.515299e+01 | 1.382213e+01 |
+--------------+--------------+---------------+--------------+
| 1.844295e-03 | 5.763421e-04 | -1.170769e-01 | 9.763663e+00 |
+--------------+--------------+---------------+--------------+
| 3.520927e-03 | 1.100290e-03 | -1.088371e+00 | 4.285077e+00 |
+--------------+--------------+---------------+--------------+

Lets combine these results in Veusz

Use =homeb/steff075/phd_ecm/Mrk766/-lag-results.ods= to obtain
the csv

Plot =homeb/steff075/phd_ecm/Mrk766/Mrk766-lag-results-lo-hi-flux.vsz=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/Mrk766-lag-results-lo-hi-flux.png

pdf at

http://www.star.bris.ac.uk/steff/ecm/Mrk766-lag-results-lo-hi-flux.pdf


*Genegenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28
accordingly. Run fits files to check:

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
%d=load_data("Mrk766-time-lags-combined.fits");
%r=load_rmf("Mrk766-time-lags-combined.rsp");
%d=load_data("Mrk766-time-lags-lo-flux.fits");
%r=load_rmf("Mrk766-time-lags-lo-flux.rsp");
d=load_data("Mrk766-time-lags-hi-flux.fits");
r=load_rmf("Mrk766-time-lags-hi-flux.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

Now copy these the BC4 for fitting to ECM model, e.g:

#+BEGIN_EXAMPLE
scp Mrk766-time-lags-hi-flux.fits so14935@bc4login.acrc.bris.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/-time-lag-fits
#+END_EXAMPLE

** OBS 0096020101 (2000)

Use script =/homeb/steff075/phd_ecm/Mrk766/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.309091e-04,3.458560e+00,3.157807e+02
2.499174e-04,-3.433329e+01,1.316194e+02
4.771150e-04,1.655106e+02,8.503306e+01
9.108558e-04,-3.790374e+01,4.175238e+01
1.738907e-03,-3.444506e+00,7.634437e+01
3.319731e-03,2.009013e+01,2.747102e+01
6.337668e-03,-6.437032e+01,2.607693e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk766_0096020101_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0109141301 (2001)

Use script =/homeb/steff075/phd_ecm/Mrk766/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,-3.819927e+02,3.136863e+02
1.388430e-04,4.744508e+01,1.858638e+02
2.650639e-04,-2.879379e+01,6.555161e+01
5.060310e-04,1.360364e+01,3.073158e+01
9.660592e-04,-3.921042e+01,1.715217e+01
1.844295e-03,-2.118919e-01,1.977787e+01
3.520927e-03,-7.855251e+00,3.463264e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk766_0109141301_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0304030101 (2005)

Use script =/homeb/steff075/phd_ecm/Mrk766/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,1.979392e+02,1.749646e+02
1.388430e-04,8.191668e+01,1.714921e+02
2.650639e-04,-1.595995e+02,1.014765e+02
5.060310e-04,-9.399275e+01,2.923382e+01
9.660592e-04,-2.635701e+01,6.562512e+01
1.844295e-03,-6.516265e+01,4.153584e+01
3.520927e-03,-5.982895e+01,1.612214e+02

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk766_0304030101_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("Mrk766-0304030101-time-lags.fits");
r=load_rmf("Mrk766-0304030101-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

Copy to BC4

#+BEGIN_EXAMPLE
mv Mrk766-0304030101-time-lags.fits Mrk766-time-lag-fits
mv Mrk766-0304030101-time-lags.rsp Mrk766-time-lag-fits

cd Mrk766-time-lag-fits

scp  Mrk766-0304030101-time-lags.fits Mrk766-0304030101-time-lags.rsp so14935@bc4login.acrc.bris.ac.uk://mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/Mrk766-time-lag-fits
#+END_EXAMPLE

** OBS 0304030301 (2005)

Use script =/homeb/steff075/phd_ecm/Mrk766/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,2.549287e+02,9.407291e+01
1.388430e-04,4.043701e+01,9.474288e+01
2.650639e-04,8.814369e+01,3.836207e+01
5.060310e-04,2.030451e+01,2.761186e+01
9.660592e-04,2.518469e+01,1.797892e+01
1.844295e-03,-1.182485e+01,1.532648e+01
3.520927e-03,-2.679684e+01,1.678408e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk766_0304030301_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE
** OBS 0304030401 (2005)

Use script =/homeb/steff075/phd_ecm/Mrk766/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,7.684899e+02,4.253634e+02
1.388430e-04,3.064425e+02,1.151037e+02
2.650639e-04,8.867949e+01,6.870427e+01
5.060310e-04,1.142684e+01,3.333492e+01
9.660592e-04,-4.169532e+01,4.446684e+01
1.844295e-03,-3.542993e+01,4.578370e+01
3.520927e-03,7.417633e+00,3.174964e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk766_0304030401_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

** OBS 0304030501 (2005)

Use script =/homeb/steff075/phd_ecm/Mrk766/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,1.680288e+03,7.685367e+02
1.388430e-04,2.324398e+02,1.847020e+02
2.650639e-04,1.481253e+01,5.170697e+01
5.060310e-04,1.346978e+01,3.142662e+01
9.660592e-04,1.763334e+00,2.823619e+01
1.844295e-03,-2.232969e+00,4.492207e+01
3.520927e-03,8.383882e+01,7.097280e+01


#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk766_0304030501_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

** OBS 0304030601 (2005)

Use script =/homeb/steff075/phd_ecm/Mrk766/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,-1.188154e+02,1.377346e+02
1.388430e-04,-2.618384e+01,1.023484e+02
2.650639e-04,4.586678e+01,2.794818e+01
5.060310e-04,6.544622e+00,2.592413e+01
9.660592e-04,-3.013229e+01,1.918725e+01
1.844295e-03,-2.623888e+01,2.074790e+01
3.520927e-03,-2.592120e+01,2.502366e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk766_0304030601_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

** OBS 0304030701 (2005)

Use script =/homeb/steff075/phd_ecm/Mrk766/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.163636e-04,3.023575e+02,1.219398e+02
2.221488e-04,1.825226e+02,1.477015e+02
4.241022e-04,-6.326792e+01,4.474069e+01
8.096496e-04,-5.982346e+01,9.413568e+01
1.545695e-03,2.207202e+00,2.953447e+01
2.950872e-03,-6.017591e+01,2.833887e+01
5.633482e-03,7.902021e+01,2.821358e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk766_0304030701_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

** Fully Combined Observations

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0096020101, 0109141301, 0304030101, 0304030301, 0304030401,
0304030501, 0304030601, 0304030701

Total time  586.4 ks

script =lagfreq_comb_script.sl=

http://www.star.bris.ac.uk/steff/ecm/Mrk766_lagfreq_comb.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,-8.355572e+01,1.371113e+02
1.388430e-04,1.146200e+02,6.515020e+01
2.650639e-04,4.691217e+00,2.395218e+01
5.060310e-04,1.784106e+01,1.248975e+01
9.660592e-04,-2.749751e+01,8.520952e+00
1.844295e-03,-1.035001e+01,9.337548e+00
3.520927e-03,-9.692940e+00,1.522994e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("Mrk766-combined-time-lags.fits");
r=load_rmf("Mrk766-combined-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE
PATH
=/homeb/steff075/phd_ecm/Mrk766/Mrk766-time-lag-fits/Mrk766-combined-time-lags.fits=

** 2000 Observation

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0096020101 time 27.4 ks

script = =lagfreq_comb2002_script.sl=

http://www.star.bris.ac.uk/steff/ecm/Mrk766_lagfreq_2000.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-04,2.585362e+01,8.040768e+01
1.388430e-03,-5.948178e+00,5.986386e+01
2.650639e-03,-2.850699e+00,3.119672e+01
5.060310e-03,8.442702e+01,4.091614e+01
9.660592e-03,4.650865e+01,1.541632e+01
1.844295e-02,2.648774e+01,1.161072e+01
3.520927e-02,1.443863e+01,1.672661e+00
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("Mrk766-2000-time-lags.fits");
r=load_rmf("Mrk766-2000-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

PATH
=/homeb/steff075/phd_ecm/Mrk766/Mrk766-time-lag-fits/Mrk766-2000-time-lags.fits=

** 2001 Observation

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0096020101 Total time  104 ks

script = =lagfreq_comb_script.sl=

http://www.star.bris.ac.uk/steff/ecm/Mrk766_lagfreq_2001.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,-3.819927e+02,3.136863e+02
1.388430e-04,4.744508e+01,1.858638e+02
2.650639e-04,-2.879379e+01,6.555161e+01
5.060310e-04,1.360364e+01,3.073158e+01
9.660592e-04,-3.921042e+01,1.715217e+01
1.844295e-03,-2.118919e-01,1.977787e+01
3.520927e-03,-7.855251e+00,3.463264e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("Mrk766-2001-time-lags.fits");
r=load_rmf("Mrk766-2001-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

PATH
=/homeb/steff075/phd_ecm/Mrk766/Mrk766-time-lag-fits/Mrk766-2001-time-lags.fits=

** 2005 Observations

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0304030101, 0304030301, 0304030401, 0304030501, 0304030601, 0304030701 Total time 455 ks

script = =lagfreq_comb_script.sl=

http://www.star.bris.ac.uk/steff/ecm/Mrk766_lagfreq_2005.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,3.962942e+02,1.509063e+02
1.388430e-04,1.681259e+02,5.512365e+01
2.650639e-04,4.241388e+01,2.161506e+01
5.060310e-04,8.241397e+00,1.295553e+01
9.660592e-04,-7.889816e+00,1.145536e+01
1.844295e-03,-2.159372e+01,1.079284e+01
3.520927e-03,-1.464577e+01,1.851318e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("Mrk766-2005-time-lags.fits");
r=load_rmf("Mrk766-2005-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH
=/homeb/steff075/phd_ecm/Mrk766/Mrk766-time-lag-fits/Mrk766-2005-time-lags.fits=

** Group 1 Observation Spectra

See 2001 Observation (below)

** Group 2 Observation Spectra

*Lag-frequency*

Lets have a look at the lag frequency for these single observations:

Use script =lagfreq_Grp2_script.sl=

Lag values:
#+BEGIN_EXAMPLE
7.272727e-05,1.065318e+03,5.630126e+02
1.388430e-04,2.032903e+02,1.606499e+02
2.650639e-04,-6.167886e+00,4.871930e+01
5.060310e-04,5.610918e+01,3.156280e+01
9.660592e-04,-1.372462e+01,2.369222e+01
1.844295e-03,1.786141e+01,4.262497e+01
3.520927e-03,4.720679e+01,5.274506e+01
#+END_EXAMPLE
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk766_lagfreq_Grp2.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("Mrk766-Grp2-time-lags.fits");
r=load_rmf("Mrk766-Grp2-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

PATH
=/homeb/steff075/phd_ecm/Mrk766/Mrk766-time-lag-fits/Mrk766-Grp2-time-lags.fits=

** Group 3 Observation Spectra

*Lag-frequency*

Lets have a look at the lag frequency for this single observation:

Use script =combine_spectra2000.sl=

Lag values:
#+BEGIN_EXAMPLE
7.272727e-05,3.016929e+02,2.483628e+02
1.388430e-04,1.323323e+02,8.658143e+01
2.650639e-04,5.771636e+01,3.204301e+01
5.060310e-04,8.510420e+00,2.086480e+01
9.660592e-04,-3.297794e+01,1.839557e+01
1.844295e-03,-2.892730e+01,1.992716e+01
3.520927e-03,-1.146715e+01,2.105793e+01
#+END_EXAMPLE
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk766_lagfreq_Grp3.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("Mrk766-Grp3-time-lags.fits");
r=load_rmf("Mrk766-Grp3-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

PATH
=/homeb/steff075/phd_ecm/Mrk766/Mrk766-time-lag-fits/Mrk766-Grp3-time-lags.fits=

** Group 4 Observation Spectra

*Lag-frequency*

Lets have a look at the lag frequency for this single observation:

Use script =lagfreq_Grp4_script.sl=

Lag values:
#+BEGIN_EXAMPLE
7.272727e-05,2.794114e+02,9.387339e+01
1.388430e-04,1.842353e+02,7.217518e+01
2.650639e-04,5.374032e+01,4.564413e+01
5.060310e-04,1.402015e+01,2.416640e+01
9.660592e-04,2.100657e+01,1.869446e+01
1.844295e-03,-1.733556e+01,1.233624e+01
3.520927e-03,-3.125607e+01,2.092394e+01
#+END_EXAMPLE
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk766_lagfreq_Grp4.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("Mrk766-Grp4-time-lags.fits");
r=load_rmf("Mrk766-Grp4-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

PATH
=/homeb/steff075/phd_ecm/Mrk766/Mrk766-time-lag-fits/Mrk766-Grp4-time-lags.fits=

** Group 5 Observation Spectra

*Lag-frequency*

Lets have a look at the lag frequency for this single observation:

Use script =lagfreq_Grp5_script.sl=

Lag values:
#+BEGIN_EXAMPLE
7.272727e-05,1.979392e+02,1.749646e+02
1.388430e-04,8.191668e+01,1.714921e+02
2.650639e-04,-1.595995e+02,1.014765e+02
5.060310e-04,-9.399275e+01,2.923382e+01
9.660592e-04,-2.635701e+01,6.562512e+01
1.844295e-03,-6.516265e+01,4.153584e+01
3.520927e-03,-5.982895e+01,1.612214e+02

#+END_EXAMPLE
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk766_lagfreq_Grp5.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("Mrk766-Grp5-time-lags.fits");
r=load_rmf("Mrk766-Grp5-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

PATH
=/homeb/steff075/phd_ecm/Mrk766/Mrk766-time-lag-fits/Mrk766-Grp5-time-lags.fits=

* *Mrk841*

PATH to data = =/homeb/steff075/phd_ecm/Mrk841=
** Combined

"0070740101","0070740301","0205340201","0205340401"

Lets just have a look at the combined flux state lag-frequencies >1e-4 Hz:

use =lagfreq_multi_script.sl=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk841_lagfreq_comb.gif

Lags found in
=/homeb/steff075/phd_ecm/Mrk841/time_lags_comb2.csv=

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped

|         Freq |           +- |           Lag |           +- |
| 1.018182e-04 | 3.181818e-05 | -2.658597e+02 | 2.175206e+02 |
| 1.943802e-04 | 6.074380e-05 |  3.293810e+01 | 2.203241e+02 |
| 3.710894e-04 | 1.159654e-04 |  6.581551e+00 | 1.024902e+02 |
| 7.084434e-04 | 2.213886e-04 | -9.409181e+01 | 4.035902e+01 |
| 1.352483e-03 | 4.226509e-04 | -2.581369e+01 | 1.951306e+01 |
| 2.582013e-03 | 8.068790e-04 |  8.368471e+00 | 7.801691e+00 |
| 4.929297e-03 | 1.540405e-03 | -1.353546e+00 | 2.821580e+00 |



** Low - High Flux state results

Lets just have a look at the low and high flux state lag-frequencies:

use =lagfreq_multi_script.sl=

*Low flux*

Recall from the spectral fitting:
#+BEGIN_EXAMPLE
Group1   Red        = Obs ID 0070740101   2001
         Black      = Obs ID 0070740301   2001

Group 2  Blue       = Obs ID 0205340401   2005
         Green      = Obs ID 0205340201   2005
#+END_EXAMPLE

Group 1 = Hi flux and Group 2 = Lo Flux

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk841_lagfreq_loflux.gif

Lags found in =/homeb/steff075/phd_ecm/Mrk841/lagvalues-lo-flux.csv=

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped

|         Freq |           +- |         Lag+- |              |
| 1.018182e-04 | 3.181818e-05 | -5.627760e+02 | 1.209955e+02 |
| 1.943802e-04 | 6.074380e-05 |  2.653786e+02 | 1.866441e+02 |
| 3.710894e-04 | 1.159654e-04 | -1.159918e+02 | 1.387244e+02 |
| 7.084434e-04 | 2.213886e-04 | -4.473525e+01 | 5.233758e+01 |
| 1.352483e-03 | 4.226509e-04 | -1.453616e+01 | 1.798432e+01 |
| 2.582013e-03 | 8.068790e-04 |  8.206615e+00 | 1.003335e+01 |
| 4.929297e-03 | 1.540405e-03 |  4.074970e+00 | 3.010689e+00 |


*High flux*

"0070740101","0070740301"

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk841_lagfreq_hiflux.gif

Lags found:
file =/homeb/steff075/phd_ecm/Mrk841/time_lags_hiflux2.csv=


#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped

|         Freq |           +- |           Lag |           +- |
| 1.309091e-04 | 4.090909e-05 | -1.396310e+02 | 1.727997e+02 |
| 2.499174e-04 | 7.809917e-05 | -5.444006e+01 | 2.942939e+02 |
| 4.771150e-04 | 1.490984e-04 | -2.119608e+02 | 1.223642e+02 |
| 9.108558e-04 | 2.846424e-04 | -4.541296e+01 | 5.754040e+01 |
| 1.738907e-03 | 5.434083e-04 | -4.423250e+01 | 2.275167e+01 |
| 3.319731e-03 | 1.037416e-03 |  5.817300e+00 | 8.675427e+00 |
| 6.337668e-03 | 1.980521e-03 | -2.827003e+00 | 3.585391e+00 |

Lets combine these results in Veusz

Use =homeb/steff075/phd_ecm/Mrk841/Mrk841-lag-results.ods= to obtain
the csv

Plot =homeb/steff075/phd_ecm/Mrk841/Mrk841-lag-results-lo-hi.vsz=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/Mrk841-lag-results-lo-hi-flux.png

pdf at

http://www.star.bris.ac.uk/steff/ecm/Mrk841-lag-results-lo-hi-flux.pdf


*Genegenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28
accordingly. Run fits files to check:

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
%d=load_data("Mrk841-time-lags-combined.fits");
%r=load_rmf("Mrk841-time-lags-combined.rsp");
%d=load_data("Mrk841-time-lags-lo-flux.fits");
%r=load_rmf("Mrk841-time-lags-lo-flux.rsp");
d=load_data("Mrk841-time-lags-hi-flux.fits");
r=load_rmf("Mrk841-time-lags-hi-flux.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

Now copy these the BC4 for fitting to ECM model, e.g:

#+BEGIN_EXAMPLE
scp Mrk841-time-lags-hi-flux.fits so14935@bc4login.acrc.bris.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/Mrk841-time-lag-fits
#+END_EXAMPLE

** OBS 0070740101 (2001)

Use script =/homeb/steff075/phd_ecm/Mrk841/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.381818e-03,-8.716103e+01,1.505688e+02
2.638017e-03,3.416123e+01,1.348031e+02
5.036213e-03,-3.943571e+01,6.702729e+01
9.614589e-03,2.366558e+01,1.258657e+02
1.835512e-02,2.087217e+01,1.554930e+01
3.504160e-02,2.399320e+00,4.981690e+00
6.689760e-02,-4.171684e+00,6.416494e+00

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk841_0070740101_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0070740301 (2001)

Use script =/homeb/steff075/phd_ecm/Mrk841/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.381818e-03,-3.166183e+02,8.920027e+01
2.638017e-03,1.151134e+02,7.035589e+01
5.036213e-03,-4.687814e+01,3.222188e+01
9.614589e-03,-2.123665e+01,5.657517e+01
1.835512e-02,-1.747040e+01,8.219650e+00
3.504160e-02,-5.685586e+00,3.598066e+00
6.689760e-02,4.141217e+00,1.832740e+00


#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk841_0070740301_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE
** OBS 0205340201 (2005)

Use script =/homeb/steff075/phd_ecm/Mrk841/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.454545e-04,2.383378e+02,2.755831e+02
2.776860e-04,-2.051074e+02,2.929552e+02
5.301277e-04,-7.715926e+01,2.617849e+02
1.012062e-03,-7.765681e+01,5.922081e+01
1.932118e-03,6.736277e+01,6.806648e+01
3.688590e-03,2.990715e+01,6.687076e+02
7.041853e-03,-5.597168e+01,1.644308e+01


#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk841_0205340201_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0205340401 (2005)

Use script =/homeb/steff075/phd_ecm/Mrk841/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.454545e-04,9.052233e+01,1.040951e+02
2.776860e-04,-9.441725e+00,7.258886e+01
5.301277e-04,-4.315597e+02,2.525366e+02
1.012062e-03,2.008942e+02,1.903219e+02
1.932118e-03,1.863432e+02,1.540514e+02
3.688590e-03,6.520381e+01,2.236340e+01
7.041853e-03,5.600279e+01,5.846720e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk841_0205340401_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** Combined Observations

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0070740101, 0070740301, 0205340201, 0205340401 Total time  84 ks

script =lagfreq_comb_script.sl=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk841_lagfreq_comb.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,-2.457749e+02,3.351919e+02
1.388430e-04,3.007636e+02,2.411909e+02
2.650639e-04,-6.672286e+01,1.527675e+02
5.060310e-04,-1.279705e+02,8.380506e+01
9.660592e-04,-1.312822e+02,1.235741e+02
1.844295e-03,-1.408815e+02,1.347816e+02
3.520927e-03,4.186196e+01,6.556626e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("Mrk841-combined-time-lags.fits");
r=load_rmf("Mrk841-combined-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH
=/homeb/steff075/phd_ecm/Mrk841/Mrk841-time-lag-fits/Mrk841-combined-time-lags.fits=

** 2001 Observation

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0070740101, 0070740301 Total time 21 KS

script = =lagfreq_comb_script.sl=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk841_lagfreq_2001.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,-1.962452e+02,4.768324e+02
1.388430e-04,1.542445e+03,0.000000e+00
2.650639e-04,-5.132920e+01,2.774771e+02
5.060310e-04,-1.296899e+02,9.958846e+01
9.660592e-04,-2.539766e+02,2.293069e+02
1.844295e-03,-1.640400e+02,8.458135e+01
3.520927e-03,-1.777891e+00,6.938903e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("Mrk841-2001-time-lags.fits");
r=load_rmf("Mrk841-2001-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

PATH
=/homeb/steff075/phd_ecm/Mrk841/Mrk841-time-lag-fits/Mrk841-2001-time-lags.fits=

** 2005 Observations

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0205340201, 0205340401 Total time 61 ks

script = =lagfreq_comb_script.sl=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk841_lagfreq_2005.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,-3.334455e+02,3.171356e+02
1.388430e-04,1.683976e+02,2.220488e+02
2.650639e-04,-1.098557e+02,1.740904e+02
5.060310e-04,-1.195154e+02,2.462229e+02
9.660592e-04,-3.191015e+01,9.616532e+01
1.844295e-03,9.064120e+01,8.554153e+01
3.520927e-03,9.293161e+01,4.088861e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("Mrk841-2005-time-lags.fits");
r=load_rmf("Mrk841-2005-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

PATH
=/homeb/steff075/phd_ecm/Mrk841/Mrk841-time-lag-fits/Mrk841-2005-time-lags.fits=

* *NGC1365*

PATH to data =/homeb/steff075/phd_ecm/NGC1365= and =data/scratch4/gpres/data/NGC1365/=

Observations used here (x12):
#+BEGIN_EXAMPLE
Obd ID       Start                  End                    Duration
0151370101   2003-02-09 20:43:55    2003-02-09 23:46:59     19417
0151370201   2003-02-09 20:43:55    2003-02-09 23:46:59     10984
0151370701   2003-08-13 00:19:12    2003-08-13 03:29:29     11417
0205590301   2004-01-17 03:11:00    2004-01-17 19:46:14     59714
0205590401   2004-07-24 06:40:02    2004-07-25 01:46:53     68811
0505140201   2007-06-30 07:08:06    2007-07-01 18:56:04    128878
0505140401   2007-07-02 06:17:13    2007-07-03 18:42:43    131130
0505140501   2007-07-04 06:09:23    2007-07-05 18:31:27    130924
0692840201   2012-07-25 23:29:12    2012-07-27 13:58:10    138538
0692840301   2012-12-24 15:34:25    2012-12-26 02:37:58    126213
0692840401   2013-01-23 12:42:41    2013-01-25 01:49:36    133615
0692840501   2013-02-12 10:57:39    2013-02-14 00:22:55    134716
#+END_EXAMPLE

** Combined

Lets just have a look at the combined flux state lag-frequencies >1e-4 Hz:

use =lagfreq_multi_script.sl=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC1365_lagfreq_comb.PNG

Lags found in
=/homeb/steff075/phd_ecm/NGC1365/time_lags_comb2.csv=

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 7.272727e-05 | 2.272727e-05 | -1.442017e+02 | 1.134070e+02 |
+--------------+--------------+---------------+--------------+
| 1.388430e-04 | 4.338843e-05 |  2.324431e+01 | 6.229896e+01 |
+--------------+--------------+---------------+--------------+
| 2.650639e-04 | 8.283246e-05 | -3.934673e+01 | 3.971134e+01 |
+--------------+--------------+---------------+--------------+
| 5.060310e-04 | 1.581347e-04 | -8.156980e+00 | 2.836798e+01 |
+--------------+--------------+---------------+--------------+
| 9.660592e-04 | 3.018935e-04 |  1.172526e+01 | 1.152320e+01 |
+--------------+--------------+---------------+--------------+
| 1.844295e-03 | 5.763421e-04 |  4.984419e+00 | 4.565048e+00 |
+--------------+--------------+---------------+--------------+
| 3.520927e-03 | 1.100290e-03 |  2.894034e+00 | 1.626594e+00 |
+--------------+--------------+---------------+--------------+


** Low - High Flux state results

Lets just have a look at the low and high flux state lag-frequencies:

use =lagfreq_multi_script.sl=

*Low flux*

Recall from the spectral fitting:
#+BEGIN_EXAMPLE
Group 1    Purple          = Obs ID 0692840401
           Red             = Obs ID 0692840301

Group 2    Green (upper)   = Obs ID 0692840501_1
           Blue            = Obs ID 0205590301
           Green (middle)  = Obs ID 0692840501_2

Group 3    Indigo          = Obs ID 0692840201
           Cyan            = Obs ID 0205590401

Group 4    Yellow          = Obs ID 0151370201
           Black           = Obs ID 0151370101
           Green (lower)   = Obs ID 0151370701

Group 5    Magenta         = Obs ID 0505140501 and 0505140501_2
           Orange (unseen) = Obs ID 0505140401
           Purple (lower)  = Obs ID 0505140201
#+END_EXAMPLE

Group 1 = Hi flux and Group 2-5 = Lo Flux

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC1365_lagfreq_lo_flux.PNG

Lags found in =/homeb/steff075/phd_ecm/NGC1365/lagvalues-lo-flux.csv=

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 7.272727e-05 | 2.272727e-05 | -5.995384e+02 | 5.017796e+02 |
+--------------+--------------+---------------+--------------+
| 1.388430e-04 | 4.338843e-05 |  4.158246e+01 | 2.029184e+02 |
+--------------+--------------+---------------+--------------+
| 2.650639e-04 | 8.283246e-05 | -1.567454e+02 | 9.508833e+01 |
+--------------+--------------+---------------+--------------+
| 5.060310e-04 | 1.581347e-04 |  3.744871e+01 | 4.272222e+01 |
+--------------+--------------+---------------+--------------+
| 9.660592e-04 | 3.018935e-04 | -4.059987e+01 | 1.254428e+01 |
+--------------+--------------+---------------+--------------+
| 1.844295e-03 | 5.763421e-04 |  4.370966e+00 | 4.659881e+00 |
+--------------+--------------+---------------+--------------+
| 3.520927e-03 | 1.100290e-03 | -2.794094e+00 | 1.621529e+00 |
+--------------+--------------+---------------+--------------+


*High flux*

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC1365_lagfreq_hi_flux.PNG

Lags found:
file =/homeb/steff075/phd_ecm/NGC1365/time_lags_hi-flux2.csv=


#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 7.272727e-05 | 2.272727e-05 | -1.088820e+02 | 1.043063e+02 |
+--------------+--------------+---------------+--------------+
| 1.388430e-04 | 4.338843e-05 |  2.151071e+01 | 8.694659e+01 |
+--------------+--------------+---------------+--------------+
| 2.650639e-04 | 8.283246e-05 | -1.846079e+01 | 5.144684e+01 |
+--------------+--------------+---------------+--------------+
| 5.060310e-04 | 1.581347e-04 | -1.859491e+01 | 3.857003e+01 |
+--------------+--------------+---------------+--------------+
| 9.660592e-04 | 3.018935e-04 |  3.843318e+01 | 1.648950e+01 |
+--------------+--------------+---------------+--------------+
| 1.844295e-03 | 5.763421e-04 |  5.464508e+00 | 8.458957e+00 |
+--------------+--------------+---------------+--------------+
| 3.520927e-03 | 1.100290e-03 |  9.442915e+00 | 3.316985e+00 |
+--------------+--------------+---------------+--------------+

Lets combine these results in Veusz

Use =homeb/steff075/phd_ecm/NGC1365/NGC1365-lag-results.ods= to obtain
the csv

Plot =homeb/steff075/phd_ecm/NGC1365/NGC1365-lag-results-lo-hi.vsz=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/NGC1365-lag-results-lo-hi-flux.png

pdf at

http://www.star.bris.ac.uk/steff/ecm/NGC1365-lag-results-lo-hi-flux.pdf


*Genegenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28
accordingly. Run fits files to check:

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
%d=load_data("NGC1365-time-lags-combined.fits");
%r=load_rmf("NGC1365-time-lags-combined.rsp");
%d=load_data("NGC1365-time-lags-lo-flux.fits");
%r=load_rmf("NGC1365-time-lags-lo-flux.rsp");
d=load_data("NGC1365-time-lags-hi-flux.fits");
r=load_rmf("NGC1365-time-lags-hi-flux.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

Now copy these the BC4 for fitting to ECM model, e.g:

#+BEGIN_EXAMPLE
scp NGC1365-time-lags-hi-flux.fits so14935@bc4login.acrc.bris.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/NGC1365-time-lag-fits
#+END_EXAMPLE

** 2003 Observations

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

"0151370101","0151370201","0151370701" Total time 41.8 ks

script =lagfreq_comb_script.sl=

http://www.star.bris.ac.uk/steff/ecm/NGC1365_lagfreq_2003.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,-1.267833e+03,2.427403e-05
1.388430e-04,5.885311e+02,2.519836e+03
2.650639e-04,-1.749380e+03,4.894780e+02
5.060310e-04,-6.697067e+02,7.516118e+02
9.660592e-04,2.551940e+02,9.552462e+01
1.844295e-03,-1.163327e+01,1.737403e+03
3.520927e-03,-7.234943e+01,2.361496e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC1365-2003-time-lags.fits");
r=load_rmf("NGC1365-2003-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

PATH =/homeb/steff075/phd_ecm/NGC1365/NGC1365-time-lag-fits/NGC1365-2003-time-lags.fits=

** 2004 Observations

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

"0205590301","0205590401" Total time 128.5 ks

script = =lagfreq_comb_script.sl=

http://www.star.bris.ac.uk/steff/ecm/NGC1365_lagfreq_2004.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,-8.943117e+02,2.305844e+03
1.388430e-04,2.613238e+03,1.337837e+03
2.650639e-04,-1.025939e+03,5.263914e+02
5.060310e-04,5.940130e+02,7.681158e+02
9.660592e-04,-3.007895e+02,5.664916e+01
1.844295e-03,2.777642e+01,8.472838e+01
3.520927e-03,-8.066902e+01,2.281128e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC1365-2004-time-lags.fits");
r=load_rmf("NGC1365-2004-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH
=/homeb/steff075/phd_ecm/NGC1365/NGC1365-time-lag-fits/NGC1365-2004-time-lags.fits=

** 2007 Observations

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

"0505140201","0505140401","0505140501","0505140501_2" Total time 391 ks

script = =lagfreq_comb_script.sl=

http://www.star.bris.ac.uk/steff/ecm/NGC1365_lagfreq_2007.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,-1.870563e+03,9.445607e+02
1.388430e-04,-2.168110e+03,1.009091e+03
2.650639e-04,-1.843775e+03,5.386933e+02
5.060310e-04,-1.453948e+01,1.553465e+02
9.660592e-04,4.766706e+02,1.187921e+02
1.844295e-03,1.038585e+02,4.375744e+01
3.520927e-03,9.882302e+01,9.364959e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC1365-2007-time-lags.fits");
r=load_rmf("NGC1365-2007-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH
=/homeb/steff075/phd_ecm/NGC1365/NGC1365-time-lag-fits/NGC1365-2007-time-lags.fits=

** 2012 Observations

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

"0692840201","0692840301" Total time 264.8 ks

script = =lagfreq_comb_script.sl=

http://www.star.bris.ac.uk/steff/ecm/NGC1365_lagfreq_2012.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,2.660509e+02,2.885152e+02
1.388430e-04,9.085851e+01,3.252244e+02
2.650639e-04,-1.549246e+02,2.092060e+02
5.060310e-04,8.143908e+01,2.405344e+02
9.660592e-04,3.245209e+02,2.228459e+02
1.844295e-03,2.819586e+02,2.270643e+02
3.520927e-03,-6.373313e+01,3.000621e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC1365-2012-time-lags.fits");
r=load_rmf("NGC1365-2012-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH
=/homeb/steff075/phd_ecm/NGC1365/NGC1365-time-lag-fits/NGC1365-2012-time-lags.fits=

** 2013 Observations

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0692840401,0692840501,0692840501-2 Total time 268.3 ks

script = =lagfreq_comb_script.sl=

http://www.star.bris.ac.uk/steff/ecm/NGC1365_lagfreq_2013.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,-1.707555e+02,1.533473e+02
1.388430e-04,1.772121e+01,8.189715e+01
2.650639e-04,-3.127680e+01,5.592474e+01
5.060310e-04,-1.490514e+01,4.395179e+01
9.660592e-04,3.695548e+01,4.053259e+01
1.844295e-03,2.326640e+01,4.632644e+01
3.520927e-03,5.583828e+01,1.528197e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC1365-2013-time-lags.fits");
r=load_rmf("NGC1365-2013-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH
=/homeb/steff075/phd_ecm/NGC1365/NGC1365-time-lag-fits/NGC1365-2013-time-lags.fits=

** Group 1 Observation Spectra

*Lag-frequency*

Lets have a look at the lag frequency for this single observation:

Use script =lagfreq_comb_script_Grp2.sl=

Lag values:
#+BEGIN_EXAMPLE
7.272727e-05,-1.097967e+02,1.321141e+02
1.388430e-04,2.181512e+01,9.680592e+01
2.650639e-04,-1.942072e+01,6.149364e+01
5.060310e-04,-2.071118e+01,4.610054e+01
9.660592e-04,9.501497e+01,4.802993e+01
1.844295e-03,3.072215e+01,5.376131e+01
3.520927e-03,4.953350e+01,1.655410e+01
#+END_EXAMPLE

saved as =time_lags_Grp1.csv=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC1365_lagfreq_Grp1.gif


*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC1365-Grp1-time-lags.fits");
r=load_rmf("NGC1365-Grp1-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH
=/homeb/steff075/phd_ecm/NGC1365/NGC1365-time-lag-fits/NGC1365-Grp1-time-lags.fits=

** Group 2 Observation Spectra

*Lag-frequency*

Lets have a look at the lag frequency for this single observation:

Use script =lagfreq_comb_script_Grp2.sl=

Lag values:
#+BEGIN_EXAMPLE
7.272727e-05,-5.375534e+02,6.335103e+02
1.388430e-04,1.237022e+02,2.616174e+02
2.650639e-04,-2.675616e+02,1.559557e+02
5.060310e-04,1.939768e+02,2.031694e+02
9.660592e-04,-1.445892e+02,4.003967e+01
1.844295e-03,1.253534e+00,1.308163e+02
3.520927e-03,-9.823970e+01,2.424963e+01
#+END_EXAMPLE

saved as =time_lags_Grp2.csv=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC1365_lagfreq_Grp2.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC1365-Grp2-time-lags.fits");
r=load_rmf("NGC1365-Grp2-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH
=/homeb/steff075/phd_ecm/NGC1365/NGC1365-time-lag-fits/NGC1365-Grp2-time-lags.fits=

** Group 3 Observation Spectra

*Lag-frequency*

Lets have a look at the lag frequency for this single observation:

Use script =lagfreq_comb_script_Grp3.sl=

Lag values:
#+BEGIN_EXAMPLE
7.272727e-05,-3.657539e+03,1.377863e+03
1.388430e-04,-2.497006e+03,5.875587e+02
2.650639e-04,-2.014974e+01,3.651728e+02
5.060310e-04,8.661345e+01,2.173433e+02
9.660592e-04,-2.432230e+02,1.158554e+02
1.844295e-03,-6.426243e+01,2.913228e+02
3.520927e-03,-4.807427e+01,5.082462e+01

#+END_EXAMPLE

saved as =time_lags_Grp31.csv=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC1365_lagfreq_Grp3.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC1365-Grp3-time-lags.fits");
r=load_rmf("NGC1365-Grp3-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH
=/homeb/steff075/phd_ecm/NGC1365/NGC1365-time-lag-fits/NGC1365-Grp3-time-lags.fits=

** Group 4 Observation Spectra

*Lag-frequency*

Lets have a look at the lag frequency for this single observation:

Use script =lagfreq_comb_script_Grp3.sl=

Lag values:
#+BEGIN_EXAMPLE
1.163636e-04,3.061819e+03,1.148484e+03
2.221488e-04,-1.908560e+03,7.335216e+02
4.241022e-04,-5.633038e+02,2.664666e+02
8.096496e-04,4.287595e+02,1.349241e+02
1.545695e-03,1.605841e+02,1.148692e+02
2.950872e-03,-6.799629e+01,2.855290e+01
5.633482e-03,6.937172e+01,5.118399e+01
#+END_EXAMPLE

saved as =time_lags_Grp4.csv=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC1365_lagfreq_Grp4.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC1365-Grp4-time-lags.fits");
r=load_rmf("NGC1365-Grp4-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH
=/homeb/steff075/phd_ecm/NGC1365/NGC1365-time-lag-fits/NGC1365-Grp4-time-lags.fits=

** Group 5 Observation Spectra

*Lag-frequency*

Lets have a look at the lag frequency for this single observation:

Use script =lagfreq_comb_script_Grp3.sl=

Lag values:
#+BEGIN_EXAMPLE
7.272727e-05,-1.870563e+03,9.445607e+02
1.388430e-04,-2.168110e+03,1.009091e+03
2.650639e-04,-1.843775e+03,5.386933e+02
5.060310e-04,-1.453948e+01,1.553465e+02
9.660592e-04,4.766706e+02,1.187921e+02
1.844295e-03,1.038585e+02,4.375744e+01
3.520927e-03,9.882302e+01,9.364959e+01

#+END_EXAMPLE

saved as =time_lags_Grp5.csv=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC1365_lagfreq_Grp5.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC1365-Grp5-time-lags.fits");
r=load_rmf("NGC1365-Grp5-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH
=/homeb/steff075/phd_ecm/NGC1365/NGC1365-time-lag-fits/NGC1365-Grp5-time-lags.fits=

* *NGC3516*

PATH to data = =/homeb/steff075/phd_ecm/NGC3516=
** Combined

Lets just have a look at the combined flux state lag-frequencies >1e-4 Hz:

use =lagfreq_multi_script.sl=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC3516_lagfreq_comb.PNG

Lags found in
=/homeb/steff075/phd_ecm/NGC3516/time_lags_comb2.csv=

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 7.272727e-05 | 2.272727e-05 | -2.566018e+02 | 1.444581e+02 |
+--------------+--------------+---------------+--------------+
| 1.388430e-04 | 4.338843e-05 | -9.786866e+01 | 8.099991e+01 |
+--------------+--------------+---------------+--------------+
| 2.650639e-04 | 8.283246e-05 |  3.605445e+01 | 3.679397e+01 |
+--------------+--------------+---------------+--------------+
| 5.060310e-04 | 1.581347e-04 | -9.895707e+00 | 2.770563e+01 |
+--------------+--------------+---------------+--------------+
| 9.660592e-04 | 3.018935e-04 | -1.014538e+01 | 1.265926e+01 |
+--------------+--------------+---------------+--------------+
| 1.844295e-03 | 5.763421e-04 | -1.076905e+01 | 4.769868e+00 |
+--------------+--------------+---------------+--------------+
| 3.520927e-03 | 1.100290e-03 |  1.802460e+00 | 1.828602e+00 |
+--------------+--------------+---------------+--------------+


** Low - High Flux state results

"0107460601","0107460701"

Lets just have a look at the low and high flux state lag-frequencies:

use =lagfreq_multi_script.sl=

*Low flux*

Recall from the spectral fitting:
#+BEGIN_EXAMPLE
Group1    Green      = Obs ID 0401210401  2006
          Blue       = Obs ID 0401210501  2006
          Magenta    = Obs ID 0401211001  2006

Group 2   Cyan       = Obs ID 0401210601  2006

Group 3   Black      = Obs ID 0107460601  2001
          Red        = Obs ID 0107460701  2001
#+END_EXAMPLE

Group 1 = Hi flux, Group 2 = Med flux and Group 3 = Lo Flux

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC3516_lagfreq_lo_flux.PNG

Lags found in =/homeb/steff075/phd_ecm/NGC3516 /lagvalues-lo-flux.csv=

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 7.272727e-05 | 2.272727e-05 |  2.194669e+02 | 4.210639e+02 |
+--------------+--------------+---------------+--------------+
| 1.388430e-04 | 4.338843e-05 | -6.765073e+01 | 2.469880e+02 |
+--------------+--------------+---------------+--------------+
| 2.650639e-04 | 8.283246e-05 | -1.436873e+02 | 7.964728e+01 |
+--------------+--------------+---------------+--------------+
| 5.060310e-04 | 1.581347e-04 | -8.170359e+01 | 5.182027e+01 |
+--------------+--------------+---------------+--------------+
| 9.660592e-04 | 3.018935e-04 |  4.800979e+01 | 1.687289e+01 |
+--------------+--------------+---------------+--------------+
| 1.844295e-03 | 5.763421e-04 | -1.561224e+01 | 6.251095e+00 |
+--------------+--------------+---------------+--------------+
| 3.520927e-03 | 1.100290e-03 |  9.538894e-01 | 2.705994e+00 |
+--------------+--------------+---------------+--------------+


*Medium flux*

Ob ID "0401210601" Only

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC3516_lagfreq_medflux.PNG

Lags found in =/homeb/steff075/phd_ecm/NGC3516 /lagvalues-med-flux.csv=

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 7.272727e-05 | 2.272727e-05 | -1.315089e+02 | 2.132469e+02 |
+--------------+--------------+---------------+--------------+
| 1.388430e-04 | 4.338843e-05 |  2.533431e+01 | 7.126190e+01 |
+--------------+--------------+---------------+--------------+
| 2.650639e-04 | 8.283246e-05 |  6.021653e+01 | 5.870497e+01 |
+--------------+--------------+---------------+--------------+
| 5.060310e-04 | 1.581347e-04 | -4.285166e+00 | 4.193354e+01 |
+--------------+--------------+---------------+--------------+
| 9.660592e-04 | 3.018935e-04 |  1.456922e+01 | 2.582418e+01 |
+--------------+--------------+---------------+--------------+
| 1.844295e-03 | 5.763421e-04 | -2.048930e+01 | 1.320878e+01 |
+--------------+--------------+---------------+--------------+
| 3.520927e-03 | 1.100290e-03 |  7.708562e+00 | 5.328776e+00 |
+--------------+--------------+---------------+--------------+


*High flux*

"0401210401","0401210501","0401211001"

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC3516_lagfreq_hi_flux.PNG

Lags found:
file =/homeb/steff075/phd_ecm/NGC3516/time_lags_hi-flux2.csv=


#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 7.272727e-05 | 2.272727e-05 | -2.962780e+02 | 2.295869e+02 |
+--------------+--------------+---------------+--------------+
| 1.388430e-04 | 4.338843e-05 | -1.522017e+02 | 1.420096e+02 |
+--------------+--------------+---------------+--------------+
| 2.650639e-04 | 8.283246e-05 |  3.648362e+01 | 6.471655e+01 |
+--------------+--------------+---------------+--------------+
| 5.060310e-04 | 1.581347e-04 | -5.062151e-02 | 5.291497e+01 |
+--------------+--------------+---------------+--------------+
| 9.660592e-04 | 3.018935e-04 | -3.640379e+01 | 2.162477e+01 |
+--------------+--------------+---------------+--------------+
| 1.844295e-03 | 5.763421e-04 | -7.173076e+00 | 7.822269e+00 |
+--------------+--------------+---------------+--------------+
| 3.520927e-03 | 1.100290e-03 |  1.015863e+00 | 2.870676e+00 |
+--------------+--------------+---------------+--------------+


Lets combine these results in Veusz

Use =homeb/steff075/phd_ecm/NGC3516/NGC3516-lag-results.ods= to obtain
the csv

Plot =homeb/steff075/phd_ecm/NGC3516/NGC3516-lag-results-lo-hi.vsz=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/NGC3516-lag-results-lo-hi-flux.png


pdf at

http://www.star.bris.ac.uk/steff/ecm/NGC3516-lag-results-lo-hi-flux.pdf

*Genegenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28
accordingly. Run fits files to check:

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
%d=load_data("NGC3516-time-lags-combined.fits");
%r=load_rmf("NGC3516-time-lags-combined.rsp");
%d=load_data("NGC3516-time-lags-lo-flux.fits");
%r=load_rmf("NGC3516-time-lags-lo-flux.rsp");
d=load_data("NGC3516-time-lags-hi-flux.fits");
r=load_rmf("NGC3516-time-lags-hi-flux.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

Now copy these the BC4 for fitting to ECM model, e.g:

#+BEGIN_EXAMPLE
scp NGC3516-time-lags-hi-flux.fits so14935@bc4login.acrc.bris.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/NGC3516-time-lag-fits
#+END_EXAMPLE

#+BEGIN_EXAMPLE

#+END_EXAMPLE

** OBS 0107460601 (2001)

Use script =/homeb/steff075/phd_ecm/NGC3516/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,2.154600e+02,5.668659e+02
1.388430e-04,-4.123786e+01,3.544760e+02
2.650639e-04,-1.466459e+02,1.371300e+02
5.060310e-04,-2.819572e+02,2.053209e+02
9.660592e-04,2.769741e+02,7.813647e+01
1.844295e-03,-1.101188e+02,4.456138e+01
3.520927e-03,1.418627e+02,3.357838e+01


#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC3516_0107460601_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0107460701 (2001)

Use script =/homeb/steff075/phd_ecm/NGC3516/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,5.647285e+03,5.913824e+03
1.388430e-04,-5.143308e+02,6.702784e+02
2.650639e-04,-1.026371e+03,5.001385e+02
5.060310e-04,-8.812454e+02,2.921930e+02
9.660592e-04,4.685280e+02,1.018234e+02
1.844295e-03,-7.952818e+01,1.196823e+02
3.520927e-03,1.453185e+02,2.101179e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC3516_0107460701_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0401210401 (2006)

Use script =/homeb/steff075/phd_ecm/NGC3516/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,-1.002931e+02,3.831329e+02
1.388430e-04,-2.185183e+02,3.775343e+02
2.650639e-04,1.395993e+01,2.410912e+02
5.060310e-04,3.366112e+02,2.469894e+02
9.660592e-04,-1.839516e+02,1.256327e+02
1.844295e-03,-2.575668e+02,1.744982e+02
3.520927e-03,-1.053137e+01,2.149003e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC3516_0401210401_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0401210501 (2006)

Use script =/homeb/steff075/phd_ecm/NGC3516/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,-1.575961e+03,1.115604e+01
1.388430e-04,-3.386615e+02,1.998978e+02
2.650639e-04,4.413557e-01,2.292164e+02
5.060310e-04,-1.060544e+02,2.572040e+02
9.660592e-04,-2.646167e+02,1.153087e+02
1.844295e-03,-2.375991e+02,1.568613e+02
3.520927e-03,3.232541e+00,6.333651e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC3516_0401210501_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0401210601 (2006)

Use script =/homeb/steff075/phd_ecm/NGC3516/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,-1.315089e+02,2.132469e+02
1.388430e-04,2.533431e+01,7.126190e+01
2.650639e-04,6.021653e+01,5.870497e+01
5.060310e-04,-4.455634e+00,4.608118e+01
9.660592e-04,2.238063e+01,4.602529e+01
1.844295e-03,-7.163787e+01,4.769360e+01
3.520927e-03,4.628438e+01,3.088942e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC3516_0401210601_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0401211001 (2006)

Use script =/homeb/steff075/phd_ecm/NGC3516/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,-2.773766e+02,3.153253e+02
1.388430e-04,5.592239e+01,2.127354e+02
2.650639e-04,5.109396e+01,7.973696e+01
5.060310e-04,-5.115947e+02,3.024283e+02
9.660592e-04,1.802402e+01,1.080792e+02
1.844295e-03,-2.337044e+02,5.065904e+01
3.520927e-03,6.197692e+01,4.976010e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC3516_0401211001_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** Combined Observations

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0107460601, 0107460701, 0401210401, 0401210501, 0401210601, 0401211001 Total time 467  ks

script =lagfreq_comb_script.sl=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC3516_lagfreq_comb.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,-2.566727e+02,1.447638e+02
1.388430e-04,-1.003120e+02,8.801116e+01
2.650639e-04,3.827234e+01,4.305667e+01
5.060310e-04,-1.921678e+01,6.270170e+01
9.660592e-04,-3.961731e+01,5.615750e+01
1.844295e-03,-1.762370e+02,4.341728e+01
3.520927e-03,2.245543e+01,2.529870e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC3516-combined-time-lags.fits");
r=load_rmf("NGC3516-combined-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH =/homeb/steff075/phd_ecm/NGC3516/NGC3516-time-lag-fits/NGC3516-combined-time-lags.fits=

** 2001 Observations

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0107460601, 0107460701 Total time 135 KS

script =lagfreq_comb_script.sl=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC3516_lagfreq_2001.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,2.245322e+02,4.448576e+02
1.388430e-04,-7.185138e+01,2.706269e+02
2.650639e-04,-2.058863e+02,1.341403e+02
5.060310e-04,-3.881816e+02,2.194808e+02
9.660592e-04,3.254363e+02,6.825307e+01
1.844295e-03,-1.057254e+02,3.941841e+01
3.520927e-03,1.432566e+02,2.007351e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC3516-2001-time-lags.fits");
r=load_rmf("NGC3516-2001-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH =/homeb/steff075/phd_ecm/NGC3516/NGC3516-time-lag-fits/NGC3516-2001-time-lags.fits=

** 2006 Observations

For these observations, see Mehdipour et al (2010), The warm absorber
and X-ray variability of the Seyfert 1 galaxy NGC 3516 as seen by the
XMM-Newton RGS, A&A, 514, A100.

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0401210401, 0401210501, 0401210601, 0401211001 Total time 232 ks

script = =lagfreq_comb_script.sl=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC3516_lagfreq_2006.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,-2.624658e+02,2.016713e+02
1.388430e-04,-1.006661e+02,1.195849e+02
2.650639e-04,4.571581e+01,5.666869e+01
5.060310e-04,-3.674885e+00,7.559481e+01
9.660592e-04,-6.579089e+01,5.812235e+01
1.844295e-03,-1.992047e+02,6.013016e+01
3.520927e-03,1.571833e+01,2.269698e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC3516-2006-time-lags.fits");
r=load_rmf("NGC3516-2006-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH
=/homeb/steff075/phd_ecm/NGC3516/NGC3516-time-lag-fits/NGC3516-2006-time-lags.fits=

** Group 1 Observation Spectra

*Lag-frequency*

Use script =lagfreq_Grp1_script.sl=

Lag values:
#+BEGIN_EXAMPLE
7.272727e-05,-2.962780e+02,2.295869e+02
1.388430e-04,-1.575971e+02,1.577290e+02
2.650639e-04,3.911993e+01,7.669152e+01gv
5.060310e-04,-2.572871e-01,3.130698e+02
9.660592e-04,-1.461978e+02,8.793739e+01
1.844295e-03,-2.389669e+02,5.605174e+01
3.520927e-03,8.177391e+00,2.684362e+01
#+END_EXAMPLE
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC3516_lagfreq_Grp1.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC3516-Grp1-time-lags.fits");
r=load_rmf("NGC3516-Grp1-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH
=/homeb/steff075/phd_ecm/NGC3516/NGC3516-time-lag-fits/NGC3516-Grp1-time-lags.fits=

** Group 2 Observation Spectra

Obs used here: 0401210601  2006
use script =combine_spectra_Grp2.sl=

*Lag-frequency*

#+BEGIN_EXAMPLE
7.272727e-05,-1.315089e+02,2.132469e+02
1.388430e-04,2.533431e+01,7.126190e+01
2.650639e-04,6.021653e+01,5.870497e+01
5.060310e-04,-4.455634e+00,4.608118e+01
9.660592e-04,2.238063e+01,4.602529e+01
1.844295e-03,-7.163787e+01,4.769360e+01
3.520927e-03,4.628438e+01,3.088942e+01
#+END_EXAMPLE
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC3516_lagfreq_Grp2.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC3516-Grp2-time-lags.fits");
r=load_rmf("NGC3516-Grp2-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH
=/homeb/steff075/phd_ecm/NGC3516/NGC3516-time-lag-fits/NGC3516-Grp2-time-lags.fits=

** Group 3 Observation Spectra

See the 2001 Observations

* *NGC4051*

PATH to data = =/homeb/steff075/phd_ecm/NGC4051=
** Combined

Lets just have a look at the combined flux state lag-frequencies >1e-4 Hz:

use =lagfreq_multi_script.sl=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4051_lagfreq_comb.PNG

Lags found in
=/homeb/steff075/phd_ecm/NGC4051/time_lags_comb2.csv=

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 7.272727e-05 | 2.272727e-05 |  1.837080e+02 | 6.696081e+01 |
+--------------+--------------+---------------+--------------+
| 1.388430e-04 | 4.338843e-05 |  2.724312e+01 | 4.039316e+01 |
+--------------+--------------+---------------+--------------+
| 2.650639e-04 | 8.283246e-05 |  6.730243e+01 | 1.553259e+01 |
+--------------+--------------+---------------+--------------+
| 5.060310e-04 | 1.581347e-04 | -1.721574e+01 | 7.066635e+00 |
+--------------+--------------+---------------+--------------+
| 9.660592e-04 | 3.018935e-04 | -5.946037e+00 | 3.232443e+00 |
+--------------+--------------+---------------+--------------+
| 1.844295e-03 | 5.763421e-04 |  2.930943e-01 | 1.912541e+00 |
+--------------+--------------+---------------+--------------+
| 3.520927e-03 | 1.100290e-03 |  9.311158e-01 | 9.851596e-01 |
+--------------+--------------+---------------+--------------+

** Low - High Flux state results

Lets just have a look at the low and high flux state lag-frequencies:

use =lagfreq_multi_script.sl=

*Low flux*

Recall from the spectral fitting:
#+BEGIN_EXAMPLE
Group 1   Black upper   = Obs ID 0109141401 2001
          Purple        = Obs ID 0606321601 2009

Group 2   Red           = Obs ID 0606321301 2009
          Cyan          = Obs ID 0606320301 2009
          Orange upper  = Obs ID 0606321401 2009
          Blue upper    = Obs ID 0606320201 2009
          Green upper   = Obs ID 0606321501 2009

Group 3   Orange lower  = Obs ID 0606322301 2009
          Indigo        = Obs ID 0606320101 2009
          Black middle  = Obs ID 0606322001 2009
          Red lower     = Obs ID 0606321701 2009
          Dark Grey     = Obs ID 0606321801 2009

Group 4   Magenta       = Obs ID 0606320401 2009
          Blue lower    = Obs ID 0606322201 2009
          Yellow        = Obs ID 0157560101 2002
          Black lower   = Obs ID 0606321901 2009

Group 5   Green lower   = Obs ID 0606322101 2009
#+END_EXAMPLE

Group 1 & 2 = Hi flux and Group 3 -5 = Lo Flux

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4051_lagfreq_lo_flux.PNG

Lags found in =/homeb/steff075/phd_ecm/NGC4051/time_lags_lo_flux.csv=

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 7.272727e-05 | 2.272727e-05 |  2.666891e+02 | 1.409966e+02 |
+--------------+--------------+---------------+--------------+
| 1.388430e-04 | 4.338843e-05 |  2.040159e+01 | 6.046521e+01 |
+--------------+--------------+---------------+--------------+
| 2.650639e-04 | 8.283246e-05 |  4.375087e+01 | 3.038929e+01 |
+--------------+--------------+---------------+--------------+
| 5.060310e-04 | 1.581347e-04 | -1.721344e+01 | 1.353577e+01 |
+--------------+--------------+---------------+--------------+
| 9.660592e-04 | 3.018935e-04 | -1.982719e+01 | 6.699903e+00 |
+--------------+--------------+---------------+--------------+
| 1.844295e-03 | 5.763421e-04 | -1.699788e+00 | 3.786154e+00 |
+--------------+--------------+---------------+--------------+
| 3.520927e-03 | 1.100290e-03 | -3.747950e+00 | 1.853573e+00 |
+--------------+--------------+---------------+--------------+



*High flux*


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4051_lagfreq_hi_flux.PNG

Lags found:
file =/homeb/steff075/phd_ecm/NGC4051/NGC4051 time_lags_hi-flux2.csv=


#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 7.272727e-05 | 2.272727e-05 |  1.749325e+02 | 9.047251e+01 |
+--------------+--------------+---------------+--------------+
| 1.388430e-04 | 4.338843e-05 |  2.829905e+01 | 5.772472e+01 |
+--------------+--------------+---------------+--------------+
| 2.650639e-04 | 8.283246e-05 |  6.948613e+01 | 2.126714e+01 |
+--------------+--------------+---------------+--------------+
| 5.060310e-04 | 1.581347e-04 | -1.721588e+01 | 1.000660e+01 |
+--------------+--------------+---------------+--------------+
| 9.660592e-04 | 3.018935e-04 | -4.891970e+00 | 4.456043e+00 |
+--------------+--------------+---------------+--------------+
| 1.844295e-03 | 5.763421e-04 |  4.863098e-01 | 2.640611e+00 |
+--------------+--------------+---------------+--------------+
| 3.520927e-03 | 1.100290e-03 |  1.561437e+00 | 1.349374e+00 |
+--------------+--------------+---------------+--------------+


Lets combine these results in Veusz

Use =homeb/steff075/phd_ecm/NGC4051/-lag-results.ods= to obtain
the csv

Plot =homeb/steff075/phd_ecm/NGC4051/NGC4051-lag-results-lo-hi.vsz=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/NGC4051-lag-results-lo-hi-flux.png

pdf at

http://www.star.bris.ac.uk/steff/ecm/NGC4051-lag-results-lo-hi-flux.pdf


*Genegenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28
accordingly. Run fits files to check:

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
%d=load_data("NGC4051-time-lags-combined.fits");
%r=load_rmf("NGC4051-time-lags-combined.rsp");
%d=load_data("NGC4051-time-lags-lo-flux.fits");
%r=load_rmf("NGC4051-time-lags-lo-flux.rsp");
d=load_data("NGC4051-time-lags-hi-flux.fits");
r=load_rmf("NGC4051-time-lags-hi-flux.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

Now copy these the BC4 for fitting to ECM model, e.g:

#+BEGIN_EXAMPLE
scp NGC4051-time-lags-hi-flux.fits so14935@bc4login.acrc.bris.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/NGC4051-time-lag-fits
#+END_EXAMPLE

** OBS 0109141401 (2001)

Use script =/homeb/steff075/phd_ecm/NGC4051/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,2.651791e+02,1.210881e+02
1.388430e-04,4.585155e+01,9.678135e+01
2.650639e-04,7.225782e+01,3.061752e+01
5.060310e-04,-1.522423e+01,1.832294e+01
9.660592e-04,-4.704271e+00,7.412650e+00
1.844295e-03,-2.939497e+00,5.366784e+00
3.520927e-03,-1.638757e-01,2.621772e+00

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4051_0109141401_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0157560101 (2002)

Use script =/homeb/steff075/phd_ecm/NGC4051/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,5.264787e+02,1.320703e+02
1.388430e-04,-3.306983e+01,5.005807e+01
2.650639e-04,1.357867e+01,4.881857e+01
5.060310e-04,-6.512497e+01,4.732685e+01
9.660592e-04,2.229347e+01,5.316135e+01
1.844295e-03,4.320786e+01,3.367635e+01
3.520927e-03,-3.275540e+01,6.272479e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4051_0157560101_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0606320101 (2009)

Use script =/homeb/steff075/phd_ecm/NGC4051/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,4.990574e+02,4.268658e+02
1.388430e-04,3.160628e+02,3.252576e+02
2.650639e-04,3.444629e+01,1.097137e+02
5.060310e-04,-2.340035e+01,4.007376e+01
9.660592e-04,-2.676757e+01,1.988070e+01
1.844295e-03,-1.560030e+01,1.296735e+01
3.520927e-03,-1.210900e+01,6.407321e+00

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4051_0606320101_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0606320201 (2009)

Use script =/homeb/steff075/phd_ecm/NGC4051/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.309091e-04,6.535763e+01,1.779747e+02
2.499174e-04,1.051202e+02,5.003758e+01
4.771150e-04,1.726160e+01,2.157485e+01
9.108558e-04,-6.778950e+00,1.193262e+01
1.738907e-03,5.951120e+00,6.780611e+00
3.319731e-03,2.829069e+00,5.495120e+00
6.337668e-03,-1.972917e+01,6.681149e+00

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4051_0606320201_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0606320301 (2009)

Use script =/homeb/steff075/phd_ecm/NGC4051/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.309091e-04,-1.293637e+02,6.275775e+01
2.499174e-04,1.254172e+02,9.365901e+01
4.771150e-04,4.828488e+01,4.845995e+01
9.108558e-04,9.629142e-01,2.016455e+01
1.738907e-03,1.360360e+01,1.049109e+01
3.319731e-03,1.350458e+01,7.165025e+00
6.337668e-03,-6.666523e+00,4.093110e+00

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4051_0606320301_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE
** OBS 0606320401 (2009)

Use script =/homeb/steff075/phd_ecm/NGC4051/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.309091e-04,3.604966e+02,6.800990e+01
2.499174e-04,-4.129805e+01,8.839765e+01
4.771150e-04,1.506929e+01,3.340669e+01
9.108558e-04,8.510667e+00,3.416273e+01
1.738907e-03,-7.722901e+00,3.844899e+01
3.319731e-03,-3.138865e+00,1.394092e+01
6.337668e-03,-1.352647e+01,6.038183e+00

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4051_0606320401_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0606321301 (2009)

Use script =/homeb/steff075/phd_ecm/NGC4051/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.309091e-04,-9.345827e+01,2.687958e+02
2.499174e-04,3.089424e+01,8.162019e+01
4.771150e-04,-4.796431e+01,2.084022e+01
9.108558e-04,-1.339966e+00,1.889499e+01
1.738907e-03,5.548456e+00,1.178158e+01
3.319731e-03,-2.000099e+00,6.090237e+00
6.337668e-03,-5.950865e+00,9.178838e+00


#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4051_0606321301_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0606321401 (2009)

Use script =/homeb/steff075/phd_ecm/NGC4051/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.309091e-04,-8.148293e+02,4.754257e+02
2.499174e-04,1.212107e+02,4.440090e+01
4.771150e-04,-4.221536e+01,2.284500e+01
9.108558e-04,2.081056e+01,1.706881e+01
1.738907e-03,-1.987896e+00,1.135158e+01
3.319731e-03,1.025293e+00,6.497801e+00
6.337668e-03,5.352839e-01,4.629054e+00

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4051_0606321401_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0606321501 (2009)

Use script =/homeb/steff075/phd_ecm/NGC4051/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.309091e-04,-2.252286e+02,1.701876e+02
2.499174e-04,-1.137532e+01,1.004593e+02
4.771150e-04,6.722026e+01,2.432029e+01
9.108558e-04,3.393894e+00,9.309482e+00
1.738907e-03,-1.455133e+01,6.955797e+00
3.319731e-03,1.022015e+01,4.957275e+00
6.337668e-03,-3.260699e+00,1.343725e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4051_0606321501_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0606321601 (2009)

Use script =/homeb/steff075/phd_ecm/NGC4051/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.309091e-04,1.304850e+02,8.816719e+01
2.499174e-04,6.038825e+01,4.861246e+01
4.771150e-04,-2.709306e+01,3.970645e+01
9.108558e-04,-2.334660e+01,1.435982e+01
1.738907e-03,-1.762607e+00,6.616684e+00
3.319731e-03,2.885254e+00,4.111632e+00
6.337668e-03,-9.800539e+00,5.150263e+00

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4051_0606321601_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0606321701 (2009)

Use script =/homeb/steff075/phd_ecm/NGC4051/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.309091e-04,5.277558e+01,7.586482e+01
2.499174e-04,-5.094258e+01,3.824904e+01
4.771150e-04,9.383824e+01,4.176447e+01
9.108558e-04,-2.435644e+01,1.552782e+01
1.738907e-03,1.039321e+01,8.779484e+00
3.319731e-03,1.218115e+01,7.744732e+00
6.337668e-03,1.947982e+01,7.222074e+00

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4051_0606321701_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0606321801 (2009)

Use script =/homeb/steff075/phd_ecm/NGC4051/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.309091e-04,1.604179e+02,2.636087e+02
2.499174e-04,-9.975240e+01,4.503692e+01
4.771150e-04,-3.792128e+01,2.643581e+01
9.108558e-04,-1.907683e+01,1.854661e+01
1.738907e-03,-1.525887e+01,9.737900e+00
3.319731e-03,-5.177122e-01,8.364939e+00
6.337668e-03,-1.364046e+01,6.449922e+00

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4051_0606321801_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0606321901 (2009)

Use script =/homeb/steff075/phd_ecm/NGC4051/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.309091e-04,-5.593193e+02,4.185327e+02
2.499174e-04,2.321892e+02,1.874144e+02
4.771150e-04,8.921210e+01,9.690756e+01
9.108558e-04,2.633775e+01,7.349492e+01
1.738907e-03,2.833238e+01,2.535505e+01
3.319731e-03,-1.373692e+01,1.750955e+01
6.337668e-03,-4.200934e+00,3.007373e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4051_0606321901_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0606322001 (2009)

Use script =/homeb/steff075/phd_ecm/NGC4051/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.309091e-04,-1.219532e+01,1.160143e+02
2.499174e-04,2.437224e+02,6.083908e+01
4.771150e-04,-2.565554e+01,4.990271e+01
9.108558e-04,-9.678095e+00,2.749261e+01
1.738907e-03,7.518612e+00,1.570539e+01
3.319731e-03,-7.901951e+00,2.271967e+01
6.337668e-03,8.498303e+00,2.183558e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4051_0606322001_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0606322101 (2009)

Use script =/homeb/steff075/phd_ecm/NGC4051/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.309091e-04,-2.229730e+03,3.390472e+02
2.499174e-04,-5.254264e+02,9.317192e+03
4.771150e-04,-5.205982e+02,3.017408e+02
9.108558e-04,4.618901e+02,9.833899e+01
1.738907e-03,2.029916e+02,3.207102e+01
3.319731e-03,6.504329e+01,1.542784e+02
6.337668e-03,-7.761510e+01,1.639079e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4051_0606322101_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0606322201 (2009)

Use script =/homeb/steff075/phd_ecm/NGC4051/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.309091e-04,-5.578954e+02,4.283078e+02
2.499174e-04,2.423280e+02,2.012668e+02
4.771150e-04,8.041915e+01,9.133786e+01
9.108558e-04,3.340877e+01,6.505118e+01
1.738907e-03,2.833514e+01,2.613736e+01
3.319731e-03,-1.457017e+01,1.653194e+01
6.337668e-03,2.560424e+00,2.955958e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4051_0606322201_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0606322301 (2009)

Use script =/homeb/steff075/phd_ecm/NGC4051/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.309091e-04,-1.675289e+02,1.634580e+02
2.499174e-04,-1.722925e+02,1.100109e+02
4.771150e-04,-6.479324e+01,5.814944e+01
9.108558e-04,-3.296608e+01,2.483635e+01
1.738907e-03,-3.959795e+01,2.041069e+01
3.319731e-03,-2.721006e+01,1.994566e+01
6.337668e-03,4.045407e+01,1.314834e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4051_0606322301_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** Combined Observations

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0109141401, 0157560101, 0606320101, 0606320201, 0606320301,
0606320401, 0606321301, 0606321401, 0606321501, 0606321601
0606321701, 0606321801, 0606321901, 0606322001, 0606322101
0606322201, 0606322301

Total time   ks

script =lagfreq_comb_script.sl=

http://www.star.bris.ac.uk/steff/ecm/NGC4051_lagfreq_comb.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,1.837080e+02,6.696081e+01
1.388430e-04,2.729085e+01,4.101364e+01
2.650639e-04,6.738803e+01,1.570373e+01
5.060310e-04,-1.727591e+01,7.220151e+00
9.660592e-04,-5.989240e+00,3.340072e+00
1.844295e-03,3.072652e-01,2.136236e+00
3.520927e-03,1.087985e+00,1.269977e+00
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC4051-combined-time-lags.fits");
r=load_rmf("NGC4051-combined-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

PATH =/homeb/steff075/phd_ecm/NGC4051/NGC4051-time-lag-fits/NGC4051-combined-time-lags.fits=

** 2001 Observation

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0109141401 Total time 106 KS

script =lagfreq_comb_script.sl=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4051_lagfreq_2001.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,2.651791e+02,1.210881e+02
1.388430e-04,4.585155e+01,9.678135e+01
2.650639e-04,7.225782e+01,3.061752e+01
5.060310e-04,-1.522423e+01,1.832294e+01
9.660592e-04,-4.704271e+00,7.412650e+00
1.844295e-03,-2.939497e+00,5.366784e+00
3.520927e-03,-1.638757e-01,2.621772e+00
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC4051-2001-time-lags.fits");
r=load_rmf("NGC4051-2001-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

PATH =/homeb/steff075/phd_ecm/NGC4051/NGC4051-time-lag-fits/NGC4051-2001-time-lags.fits=

** 2002 Observations

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

Obs 0157560101 Total time 42 ks

script = =lagfreq_comb_script.sl=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4051_lagfreq_2002.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,5.264787e+02,1.320703e+02
1.388430e-04,-3.306983e+01,5.005807e+01
2.650639e-04,1.357867e+01,4.881857e+01
5.060310e-04,-6.512497e+01,4.732685e+01
9.660592e-04,2.229347e+01,5.316135e+01
1.844295e-03,4.320786e+01,3.367635e+01
3.520927e-03,-3.275540e+01,6.272479e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC4051-2002-time-lags.fits");
r=load_rmf("NGC4051-2002-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH =/homeb/steff075/phd_ecm/NGC4051/NGC4051-time-lag-fits/NGC4051-2002-time-lags.fits=

** 2009 Observations

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

 Total time  ks

script = =lagfreq_comb_script.sl=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4051_lagfreq_2009.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,1.278143e+02,8.648617e+01
1.388430e-04,2.089750e+01,4.611541e+01
2.650639e-04,6.452173e+01,1.908306e+01
5.060310e-04,-1.826898e+01,7.901430e+00
9.660592e-04,-6.892422e+00,3.959911e+00
1.844295e-03,2.358532e+00,2.316287e+00
3.520927e-03,2.018738e+00,1.593540e+00
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC4051-2009-time-lags.fits");
r=load_rmf("NGC4051-2009-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH =/homeb/steff075/phd_ecm/NGC4051/NGC4051-time-lag-fits/NGC4051-2009-time-lags.fits=

** Group 1 Observation Spectra

Observations used
#+BEGIN_EXAMPLE
Group 1   Black upper   = Obs ID 0109141401 2001
          Purple        = Obs ID 0606321601 2009
#+END_EXAMPLE

*Lag-frequency*

Lets have a look at the lag frequency for this single observation:

Use script =lagfreq_comb_script_Grp1.sl=

Lag values:
#+BEGIN_EXAMPLE
7.272727e-05,2.881299e+02,1.025575e+02
1.388430e-04,7.868203e+01,6.085790e+01
2.650639e-04,7.534032e+01,2.991184e+01
5.060310e-04,-2.023956e+01,1.695350e+01
9.660592e-04,-1.067161e+01,6.879583e+00
1.844295e-03,-4.004593e-02,4.219901e+00
3.520927e-03,8.288356e-01,2.218128e+00
#+END_EXAMPLE
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4051_lagfreq_comb_Grp1.gif


Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC4051-Grp1-time-lags.fits");
r=load_rmf("NGC4051-Grp1-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH
=/homeb/steff075/phd_ecm/NGC4051/NGC4051-time-lag-fits/NGC4051-Grp1-time-lags.fits=

** Group 2 Observation Spectra

*Lag-frequency*

Lets have a look at the lag frequency for this single observation:

Use script =lagfreq_comb_script_Grp2.sl=

Lag values:
#+BEGIN_EXAMPLE
7.272727e-05,-3.095159e-01,1.360261e+02
1.388430e-04,-7.866495e+01,1.048383e+02
2.650639e-04,6.321045e+01,2.913310e+01
5.060310e-04,-1.429137e+01,1.174108e+01
9.660592e-04,3.854272e+00,5.928180e+00
1.844295e-03,1.626201e+00,4.031544e+00
3.520927e-03,3.410160e+00,2.509645e+00

#+END_EXAMPLE
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4051_lagfreq_comb_Grp2.gif

*Gegenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC4051-Grp2-time-lags.fits");
r=load_rmf("NGC4051-Grp2-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH
=/homeb/steff075/phd_ecm/NGC4051/NGC4051-time-lag-fits/NGC4051-Grp2-time-lags.fits=

** Group 3 Observation Spectra

#+BEGIN_EXAMPLE
Group 3   Orange lower  = Obs ID 0606322301 2009
          Indigo        = Obs ID 0606320101 2009
          Black middle  = Obs ID 0606322001 2009
          Red lower     = Obs ID 0606321701 2009
          Dark Grey     = Obs ID 0606321801 2009 Checked - ok!
#+END_EXAMPLE

*Lag-frequency*

Lets have a look at the lag frequency for this single observation:

Use script =lagfreq_comb_script_Grp3.sl=

Lag values:
#+BEGIN_EXAMPLE
7.272727e-05,3.451885e+02,2.081796e+02
1.388430e-04,8.151395e+01,1.142034e+02
2.650639e-04,-1.710174e+01,4.264337e+01
5.060310e-04,-1.967265e+01,1.823810e+01
9.660592e-04,-2.542728e+01,8.764135e+00
1.844295e-03,-8.097660e+00,5.620752e+00
3.520927e-03,-7.816927e+00,3.744977e+00
#+END_EXAMPLE
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4051_lagfreq_Grp3.gif

*Gegenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC4051-Grp3-time-lags.fits");
r=load_rmf("NGC4051-Grp3-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH
=/homeb/steff075/phd_ecm/NGC4051/NGC4051-time-lag-fits/NGC4051-Grp3-time-lags.fits=

** Group 4 Observation Spectra

#+BEGIN_EXAMPLE
Group 4   Magenta       = Obs ID 0606320401 2009
          Blue lower    = Obs ID 0606322201 2009
          Yellow        = Obs ID 0157560101 2002
          Black lower   = Obs ID 0606321901 2009 Checked - ok!
#+END_EXAMPLE

*Lag-frequency*

Lets have a look at the lag frequency for this single observation:

Use script =lagfreq_comb_script_Grp3.sl=

Lag values:
#+BEGIN_EXAMPLE
7.272727e-05,1.530804e+02,9.424480e+01
1.388430e-04,1.510373e+02,1.152836e+02
2.650639e-04,8.224307e+01,5.109248e+01
5.060310e-04,-7.610850e+00,2.712043e+01
9.660592e-04,2.479928e+01,2.354813e+01
1.844295e-03,1.843623e+01,1.374268e+01
3.520927e-03,-1.140980e+01,8.961414e+00
#+END_EXAMPLE
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4051_lagfreq_Grp4.gif

*Gegenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC4051-Grp4-time-lags.fits");
r=load_rmf("NGC4051-Grp4-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH
=/homeb/steff075/phd_ecm/NGC4051/NGC4051-time-lag-fits/NGC4051-Grp4-time-lags.fits=

** Group 5 Observation Spectra

#+BEGIN_EXAMPLE
Group 5   Green lower   = Obs ID 0606322101 2009 Checked - ok!
#+END_EXAMPLE

*Lag-frequency*

Lets have a look at the lag frequency for this single observation:

Use script =lagfreq_comb_script_Grp5.sl=

Lag values:
#+BEGIN_EXAMPLE
7.272727e-05,2.385013e+03,0.000000e+00
1.388430e-04,-2.102317e+03,3.196730e+02
2.650639e-04,-9.565673e+02,9.443283e+02
5.060310e-04,-2.706066e+02,1.052784e+03
9.660592e-04,4.651043e+02,7.921089e+01
1.844295e-03,1.954741e+02,2.700215e+01
3.520927e-03,4.371271e+01,4.450513e+01

#+END_EXAMPLE
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4051_lagfreq_Grp5.gif

*Gegenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC4051-Grp5-time-lags.fits");
r=load_rmf("NGC4051-Grp5-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH
=/homeb/steff075/phd_ecm/NGC4051/NGC4051-time-lag-fits/NGC4051-Grp5-time-lags.fits=

* *NGC4151*

PATH to data = =/homeb/steff075/phd_ecm/NGC4151=

NGC4151 Mass estimate M_{BH} = 4.7^{+057}_{-0.47} (Bentz et al (2006))
** Combined

Lets just have a look at the combined flux state lag-frequencies >2e-4 Hz:

use =lagfreq_multi_script.sl=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4151_lagfreq_comb.PNG

Lags found in
=/homeb/steff075/phd_ecm/NGC4151/time_lags_comb2.csv=

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
|         Freq |           +- |           Lag |           +- |
| 7.272727e-05 | 2.272727e-05 |  4.268777e+02 | 4.666803e+02 |
| 1.388430e-04 | 4.338843e-05 | -4.880158e+02 | 2.785792e+02 |
| 2.650639e-04 | 8.283246e-05 |  1.032066e+02 | 2.190085e+02 |
| 5.060310e-04 | 1.581347e-04 |  6.626865e+01 | 4.305749e+01 |
| 9.660592e-04 | 3.018935e-04 | -8.598514e+00 | 1.765712e+01 |
| 1.844295e-03 | 5.763421e-04 | -4.485760e+00 | 7.479531e+00 |
| 3.520927e-03 | 1.100290e-03 |  3.878124e+00 | 2.601532e+00 |



** Low - High Flux state results

Lets just have a look at the low and high flux state lag-frequencies:

use =lagfreq_multi_script.sl=

*Low flux*

Recall from the spectral fitting:
#+BEGIN_EXAMPLE
Group 1   Magenta    = Obs ID 0143500301 2003
          Blue       = Obs ID 0143500101 2003
          Cyan       = Obs ID 0143500201 2003

Group 2   Orange     = Obs ID 0402660201 2006

Group 3   Indigo     = Obs ID 0112830501 2000
          Black      = Obs ID 0112310101 2000
          Yellow     = Obs ID 0112830201 2000
          Red        = Obs ID 0402660101 2006
#+END_EXAMPLE

Group 1  = Hi flux and Group 2 & 3 = Lo Flux

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4151_lagfreq_loflux.gif

Lags found in =/homeb/steff075/phd_ecm/NGC4151/lagvalues-lo-flux.csv=

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
|         Freq |           +- |           Lag |           +- |
| 1.309091e-04 | 4.090909e-05 | -3.665392e+02 | 2.917727e+02 |
| 2.499174e-04 | 7.809917e-05 |  8.209496e+01 | 1.427724e+02 |
| 4.771150e-04 | 1.490984e-04 | -6.917311e+00 | 6.636303e+01 |
| 9.108558e-04 | 2.846424e-04 |  8.033740e+00 | 2.073423e+01 |
| 1.738907e-03 | 5.434083e-04 |  2.325167e+00 | 8.905413e+00 |
| 3.319731e-03 | 1.037416e-03 | -8.416776e-01 | 3.259886e+00 |
| 6.337668e-03 | 1.980521e-03 | -3.928620e+00 | 1.236107e+00 |




*High flux*


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4151_lagfreq_hi_flux.PNG

Lags found:
file =/homeb/steff075/phd_ecm/NGC4151/time_lags_hi-flux2.csv=


#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
|         Freq |           +- |           Lag |           +- |
| 7.272727e-05 | 2.272727e-05 |  4.292178e+02 | 7.396790e+02 |
| 1.388430e-04 | 4.338843e-05 | -5.855321e+02 | 3.808335e+02 |
| 2.650639e-04 | 8.283246e-05 |  2.118451e+02 | 4.149388e+02 |
| 5.060310e-04 | 1.581347e-04 |  1.075693e+02 | 6.468590e+01 |
| 9.660592e-04 | 3.018935e-04 | -2.407753e+01 | 3.218001e+01 |
| 1.844295e-03 | 5.763421e-04 | -9.909229e+00 | 1.447858e+01 |
| 3.520927e-03 | 1.100290e-03 |  7.674646e+00 | 4.647455e+00 |



Lets combine these results in Veusz

Use =homeb/steff075/phd_ecm/NGC4151/lag-results.ods= to obtain
the csv

Plot =homeb/steff075/phd_ecm/NGC4151/NGC4151-lag-results-lo-hi.vsz=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/NGC4151-lag-results-lo-hi-flux.png

pdf at

http://www.star.bris.ac.uk/steff/ecm/NGC4151-lag-results-lo-hi-flux.pdf


*Genegenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28
accordingly. Run fits files to check:

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
%d=load_data("NGC4151-time-lags-combined.fits");
%r=load_rmf("NGC4151-time-lags-combined.rsp");
%d=load_data("NGC4151-time-lags-lo-flux.fits");
%r=load_rmf("NGC4151-time-lags-lo-flux.rsp");
d=load_data("NGC4151-time-lags-hi-flux.fits");
r=load_rmf("NGC4151-time-lags-hi-flux.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

Now copy these the BC4 for fitting to ECM model, e.g:

#+BEGIN_EXAMPLE
scp NGC4151-time-lags-hi-flux.fits so14935@bc4login.acrc.bris.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/NGC4151-time-lag-fits
#+END_EXAMPLE

** OBS 0112310101 (2000)

Use script =/homeb/steff075/phd_ecm/NGC4151/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.163636e-04,-6.086150e+02,8.721610e+02
2.221488e-04,1.577988e+03,1.347746e+03
4.241022e-04,8.467567e+00,2.173597e+02
8.096496e-04,-1.473111e+02,2.362517e+02
1.545695e-03,-2.567978e+02,6.814290e+01
2.950872e-03,-1.092263e+02,6.303443e+01
5.633482e-03,-5.774122e+01,2.316024e+01


#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4151_0112310101_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0112830201 (2000)

Use script =/homeb/steff075/phd_ecm/NGC4151/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,6.845001e+03,9.434058e+03
1.388430e-04,7.273025e+01,1.782187e+03
2.650639e-04,1.343998e+03,5.110740e+02
5.060310e-04,-5.338338e+02,3.202830e+02
9.660592e-04,2.621324e+02,1.292895e+02
1.844295e-03,9.841230e+01,1.060822e+02
3.520927e-03,6.036896e+01,1.305752e+02


#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4151_0112830201_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0112830501 (2000)

Use script =/homeb/steff075/phd_ecm/NGC4151/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.163636e-04,-6.300517e+02,1.058283e+03
2.221488e-04,-9.426910e+02,3.879824e+02
4.241022e-04,-2.584649e+02,2.468639e+02
8.096496e-04,6.315875e+02,1.327643e+02
1.545695e-03,-2.795670e+02,8.936948e+01
2.950872e-03,1.620309e+02,5.208363e+01
5.633482e-03,5.850734e+01,1.339768e+02

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4151_0112830501_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0143500101 (2003)

Use script =/homeb/steff075/phd_ecm/NGC4151/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.309091e-04,-1.924335e+03,1.573162e+02
2.499174e-04,7.899186e+02,3.236793e+02
4.771150e-04,7.507494e+02,3.345488e+02
9.108558e-04,-3.863107e+02,7.617334e+01
1.738907e-03,5.708681e+01,7.125997e+01
3.319731e-03,5.454760e+00,1.838573e+02
6.337668e-03,-8.256271e+01,2.797583e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4151_0143500101_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0143500201 (2003)

Use script =/homeb/steff075/phd_ecm/NGC4151/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.309091e-04,-9.594503e+02,4.555990e+02
2.499174e-04,5.168252e+02,5.586326e+02
4.771150e-04,3.680940e+02,1.943164e+02
9.108558e-04,5.231451e+01,1.268305e+02
1.738907e-03,2.062808e+02,5.190024e+01
3.319731e-03,1.143167e+02,1.244651e+02
6.337668e-03,3.811819e+01,3.369699e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4151_0143500201_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0143500301 (2003)

Use script =/homeb/steff075/phd_ecm/NGC4151/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.309091e-04,-1.922677e+02,2.392032e+02
2.499174e-04,-2.147226e+02,8.820695e+02
4.771150e-04,5.078846e+01,3.687848e+02
9.108558e-04,-4.583972e+02,1.736641e+02
1.738907e-03,-1.714495e+02,7.178446e+01
3.319731e-03,2.960972e+01,3.208573e+01
6.337668e-03,8.291972e+01,3.818511e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4151_0143500301_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0402660101 (2006)

Use script =/homeb/steff075/phd_ecm/NGC4151/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.309091e-04,-3.212853e+03,6.468465e+02
2.499174e-04,-5.490278e+02,7.852659e+02
4.771150e-04,-4.565049e+02,1.713991e+02
9.108558e-04,1.054580e+02,1.894933e+02
1.738907e-03,9.992361e+01,8.109724e+01
3.319731e-03,1.937524e+01,4.408254e+01
6.337668e-03,-4.719995e+01,1.420402e+01


#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4151_0402660101_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0402660201 (2000)

Use script =/homeb/steff075/phd_ecm/NGC4151/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.309091e-04,-3.539427e+03,3.679014e+02
2.499174e-04,3.807313e+02,6.418560e+02
4.771150e-04,6.297692e+02,2.153576e+02
9.108558e-04,4.574131e+02,1.258423e+03
1.738907e-03,-2.783513e+02,2.224371e+02
3.319731e-03,-2.546561e+01,7.808683e+01
6.337668e-03,-3.143689e+01,2.902553e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4151_0402660201_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** Combined Observations

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0112310101, 0112830201, 0112830501, 0143500101, 0143500201,
0143500301, 0402660101, 0402660201

Total time 236.4 ks

script =lagfreq_comb_script.sl=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4151_lagfreq_comb.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,5.165013e+02,6.465546e+02
1.388430e-04,-6.071800e+02,3.639139e+02
2.650639e-04,1.704323e+02,3.713514e+02
5.060310e-04,2.667213e+02,1.821182e+02
9.660592e-04,-2.698967e+02,4.122190e+02
1.844295e-03,-2.109983e+02,1.248378e+02
3.520927e-03,2.692362e+01,1.964011e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC4151-combined-time-lags.fits");
r=load_rmf("NGC4151-combined-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH =/homeb/steff075/phd_ecm/NGC4151/NGC4151-time-lag-fits=

** 2000 Observation

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0112310101, 0112830201, 0112830501 Total time  106.4 Ks

script =lagfreq_comb_script.sl=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4151_lagfreq_2000.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,1.522529e+03,3.930805e+03
1.388430e-04,2.223632e+01,1.459029e+03
2.650639e-04,-5.693264e+01,1.303848e+03
5.060310e-04,-1.450080e+02,3.085773e+02
9.660592e-04,1.296845e+02,4.577862e+02
1.844295e-03,-2.395069e+02,6.294035e+01
3.520927e-03,-5.707653e+01,1.589402e+02
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC4151-2000-time-lags.fits");
r=load_rmf("NGC4151-2000-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH =/homeb/steff075/phd_ecm/NGC4151/NGC4151-time-lag-fits=

** 2003 Observations

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0143500101, 0143500201, 0143500301 Total time 56 ks

script = =lagfreq_comb_script.sl=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4151_lagfreq_2003.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,4.965988e+02,1.012126e+03
1.388430e-04,-5.855321e+02,3.808335e+02
2.650639e-04,2.496518e+02,4.937665e+02
5.060310e-04,3.242179e+02,2.141080e+02
9.660592e-04,-3.052778e+02,2.732351e+02
1.844295e-03,-1.435233e+02,1.521465e+02
3.520927e-03,3.692310e+01,2.401593e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC4151-2003-time-lags.fits");
r=load_rmf("NGC4151-2003-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH =/homeb/steff075/phd_ecm/NGC4151/NGC4151-time-lag-fits=

** 2006 Observations

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0402660101, 0402660201 Total time 74 ks

script = =lagfreq_comb_script.sl=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4151_lagfreq_2006.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,6.898496e+03,3.094032e+03
1.388430e-04,-3.644721e+03,6.712736e+02
2.650639e-04,-1.778198e+02,5.064701e+02
5.060310e-04,4.698405e+02,1.439830e+03
9.660592e-04,2.357310e+02,4.016778e+02
1.844295e-03,1.636308e+02,7.881180e+01
3.520927e-03,-5.804157e+00,3.080697e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC4151-2006-time-lags.fits");
r=load_rmf("NGC4151-2006-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH =/homeb/steff075/phd_ecm/NGC4151/NGC4151-time-lag-fits=

** Group 1 Observation Spectra

See 2003 Observations (below)

** Group 2 Observation Spectra

*Lag-frequency*

Lets have a look at the lag frequency for these single observations:

Use script =lagfreq_Grp2_script.sl=

Lag values:
#+BEGIN_EXAMPLE
7.272727e-04,-5.432536e+02,3.884206e+02
1.388430e-03,2.894257e+02,1.238388e+02
2.650639e-03,4.940167e+01,7.195640e+01
5.060310e-03,-7.813832e+01,2.405078e+01
9.660592e-03,9.914412e+00,1.366742e+01
1.844295e-02,1.729450e+01,4.986903e+00
3.520927e-02,2.181783e+00,8.378075e+00
#+END_EXAMPLE
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4151_lagfreq_Grp2.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC4151-Grp2-time-lags.fits");
r=load_rmf("NGC4151-Grp2-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH =/homeb/steff075/phd_ecm/NGC4151/NGC4151-time-lag-fits=

** Group 3 Observation Spectra

*Lag-frequency*

Lets have a look at the lag frequency for this single observation:

Use script =lagfreq_comb_Grp3_script.sl=

Lag values:
#+BEGIN_EXAMPLE
7.272727e-04,-1.867327e+01,1.964402e+02
1.388430e-03,2.526868e+02,3.790138e+02
2.650639e-03,7.169638e+01,8.952714e+01
5.060310e-03,-4.876258e+01,1.283150e+01
9.660592e-03,-5.399138e+01,7.351970e+00
1.844295e-02,-1.941612e+01,7.081101e+00
3.520927e-02,-7.315175e+00,2.464669e+00
#+END_EXAMPLE
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4151_lagfreq_Grp3.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC4151-Grp3-time-lags.fits");
r=load_rmf("NGC4151-Grp3-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH =/homeb/steff075/phd_ecm/NGC4151/NGC4151-time-lag-fits=

* *NGC4395*

PATH to data = =/homeb/steff075/phd_ecm/NGC4395=
** Combined

Lets just have a look at the combined flux state lag-frequencies >1e-4 Hz:

use =lagfreq_multi_script.sl=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4395_lagfreq_comb.PNG

Lags found in
=/homeb/steff075/phd_ecm/NGC4395/time_lags_comb2.csv=

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 7.272727e-05 | 2.272727e-05 | -9.432038e+01 | 1.811771e+02 |
+--------------+--------------+---------------+--------------+
| 1.388430e-04 | 4.338843e-05 |  4.706969e+01 | 1.051775e+02 |
+--------------+--------------+---------------+--------------+
| 2.650639e-04 | 8.283246e-05 |  2.557955e+01 | 2.979310e+01 |
+--------------+--------------+---------------+--------------+
| 5.060310e-04 | 1.581347e-04 | -2.391085e+01 | 1.622251e+01 |
+--------------+--------------+---------------+--------------+
| 9.660592e-04 | 3.018935e-04 |  4.385525e-01 | 9.361237e+00 |
+--------------+--------------+---------------+--------------+
| 1.844295e-03 | 5.763421e-04 | -3.749483e+00 | 3.986729e+00 |
+--------------+--------------+---------------+--------------+
| 3.520927e-03 | 1.100290e-03 |  1.958586e+00 | 1.677868e+00 |
+--------------+--------------+---------------+--------------+

** Low - High Flux state results

Lets just have a look at the low and high flux state lag-frequencies:

use =lagfreq_multi_script.sl=

*Low flux*

Recall from the spectral fitting:
#+BEGIN_EXAMPLE
Group 1       Black = Obs ID  0142830101  2003

Group 2       Red   = Obs ID  0744010101  2014
              Blue  = Obs ID  0744010201  2014
#+END_EXAMPLE

Group 1 = Hi flux and Group 2 = Lo Flux

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4395_lagfreq_loflux.gif

Lags found in =/homeb/steff075/phd_ecm/NGC4395/lagvalues-lo-flux.csv=

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped

|         Freq |           +- |           Lag |           +- |
| 1.236364e-04 | 3.863636e-05 |  2.768309e+01 | 3.634601e+02 |
| 2.360331e-04 | 7.376033e-05 |  4.859374e+01 | 3.469704e+02 |
| 4.506086e-04 | 1.408152e-04 |  1.096815e+01 | 6.051970e+01 |
| 8.602527e-04 | 2.688290e-04 | -5.922952e+01 | 2.669192e+01 |
| 1.642301e-03 | 5.132189e-04 | -1.985804e+01 | 1.264542e+01 |
| 3.135301e-03 | 9.797816e-04 |  5.279846e+00 | 5.465548e+00 |
| 5.985575e-03 | 1.870492e-03 | -1.143791e+00 | 1.804571e+00 |




*High flux*


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4395_lagfreq_hi_flux.PNG

Lags found:
file =/homeb/steff075/phd_ecm/NGC4395/time_lags_hi-flux2.csv=


#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 7.272727e-05 | 2.272727e-05 | -9.604389e+01 | 1.191326e+02 |
+--------------+--------------+---------------+--------------+
| 1.388430e-04 | 4.338843e-05 |  4.519607e+01 | 1.160854e+02 |
+--------------+--------------+---------------+--------------+
| 2.650639e-04 | 8.283246e-05 |  2.561790e+01 | 2.364293e+01 |
+--------------+--------------+---------------+--------------+
| 5.060310e-04 | 1.581347e-04 | -2.243746e+01 | 1.742184e+01 |
+--------------+--------------+---------------+--------------+
| 9.660592e-04 | 3.018935e-04 |  1.471111e+00 | 9.452771e+00 |
+--------------+--------------+---------------+--------------+
| 1.844295e-03 | 5.763421e-04 | -3.147819e+00 | 4.776391e+00 |
+--------------+--------------+---------------+--------------+
| 3.520927e-03 | 1.100290e-03 |  1.745504e+00 | 2.010535e+00 |
+--------------+--------------+---------------+--------------+

Lets combine these results in Veusz

Use =homeb/steff075/phd_ecm/NGC4395/lag-results.ods= to obtain
the csv

Plot =homeb/steff075/phd_ecm/NGC4395/NGC4395-lag-results-lo-hi.vsz=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/NGC4395-lag-results-lo-hi-flux.png

pdf at:

http://www.star.bris.ac.uk/steff/ecm/NGC4395-lag-results-lo-hi-flux.pdf





*Genegenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28
accordingly. Run fits files to check:

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC4395-time-lags-combined.fits");
r=load_rmf("NGC4395-time-lags-combined.rsp");
%d=load_data("NGC4395-time-lags-lo-flux.fits");
%r=load_rmf("NGC4395-time-lags-lo-flux.rsp");
%d=load_data("NGC4395-time-lags-hi-flux.fits");
%r=load_rmf("NGC4395-time-lags-hi-flux.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

Now copy these the BC4 for fitting to ECM model, e.g:

#+BEGIN_EXAMPLE
scp NGC4395-time-lags-hi-flux.fits so14935@bc4login.acrc.bris.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/NGC4395-time-lag-fits
#+END_EXAMPLE

** OBS 0142830101 (2003)

Use script =/homeb/steff075/phd_ecm/NGC4395/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,-9.604389e+01,1.191326e+02
1.388430e-04,4.519607e+01,1.160854e+02
2.650639e-04,2.564434e+01,2.424099e+01
5.060310e-04,-2.246127e+01,1.755894e+01
9.660592e-04,1.500548e+00,1.020899e+01
1.844295e-03,-3.226071e+00,5.096818e+00
3.520927e-03,1.858572e+00,2.312366e+00

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4395_0142830101_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0744010101 (2003)

Use script =/homeb/steff075/phd_ecm/NGC4395/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.163636e-04,-3.993513e+03,9.964278e+02
2.221488e-04,1.323445e+03,3.600053e+02
4.241022e-04,-1.224506e+03,1.711781e+02
8.096496e-04,-2.515163e+02,2.029638e+02
1.545695e-03,-2.645179e+02,5.845806e+01
2.950872e-03,-6.761101e+01,4.045526e+01
5.633482e-03,-2.442448e+01,2.515798e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4395_0744010101_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0744010201 (2003)

Use script =/homeb/steff075/phd_ecm/NGC4395/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.163636e-04,-3.598450e+01,7.646861e+02
2.221488e-04,-8.823178e+02,1.728619e+03
4.241022e-04,6.188992e+02,1.018969e+03
8.096496e-04,-2.883187e+02,1.348560e+02
1.545695e-03,-2.205127e+02,7.780978e+01
2.950872e-03,1.442476e+02,3.615916e+01
5.633482e-03,3.000800e+01,9.209996e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4395_0744010201_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE
** Combined Observations

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0142830101, 0744010101, 0744010201 Total time 190 ks

script =lagfreq_comb_script.sl=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4395_lagfreq_comb.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,-9.435428e+01,1.818984e+02
1.388430e-04,4.735690e+01,1.082665e+02
2.650639e-04,2.580682e+01,3.185635e+01
5.060310e-04,-2.443336e+01,1.775010e+01
9.660592e-04,4.633931e-01,1.064000e+01
1.844295e-03,-4.111911e+00,4.790254e+00
3.520927e-03,2.285391e+00,2.192843e+00
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC4395-combined-time-lags.fits");
r=load_rmf("NGC4395-combined-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH =/homeb/steff075/phd_ecm/NGC4395/NGC4395-time-lag-fits=

** 2003 Observation

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0142830101 Total time  90 Ks

script =lagfreq_comb_script.sl=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4395_lagfreq_2003.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,-9.604389e+01,1.191326e+02
1.388430e-04,4.519607e+01,1.160854e+02
2.650639e-04,2.564434e+01,2.424099e+01
5.060310e-04,-2.246127e+01,1.755894e+01
9.660592e-04,1.500548e+00,1.020899e+01
1.844295e-03,-3.226071e+00,5.096818e+00
3.520927e-03,1.858572e+00,2.312366e+00
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC4395-2003-time-lags.fits");
r=load_rmf("NGC4395-2003-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH =/homeb/steff075/phd_ecm/NGC4395/NGC4395-time-lag-fits=

** 2014 Observations

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0744010101, 0744010201 Total time 100 ks

script = =lagfreq_comb_script.sl=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC4395_lagfreq_2014.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,5.031858e+02,2.012483e+03
1.388430e-04,5.242959e+02,1.143699e+03
2.650639e-04,4.797564e+02,4.703317e+03
5.060310e-04,-7.338354e+02,1.547516e+02
9.660592e-04,-1.865024e+02,1.803624e+02
1.844295e-03,-2.209971e+02,5.165862e+01
3.520927e-03,1.144344e+02,3.531692e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC4395-2014-time-lags.fits");
r=load_rmf("NGC4395-2014-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH =/homeb/steff075/phd_ecm/NGC4395/NGC4395-time-lag-fits=

* *NGC5548*

PATH to data = =/homeb/steff075/phd_ecm/NGC5548=

** Combined

Lets just have a look at the combined flux state lag-frequencies >1e-4 Hz:

use =lagfreq_multi_script.sl=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC5548_lagfreq_comb.PNG

Lags found in
=/homeb/steff075/phd_ecm/NGC5548/time_lags_comb2.csv=

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 7.272727e-05 | 2.272727e-05 |  9.688465e+01 | 2.114824e+02 |
+--------------+--------------+---------------+--------------+
| 1.388430e-04 | 4.338843e-05 |  9.610447e+01 | 8.113796e+01 |
+--------------+--------------+---------------+--------------+
| 2.650639e-04 | 8.283246e-05 | -1.566766e+02 | 5.593457e+01 |
+--------------+--------------+---------------+--------------+
| 5.060310e-04 | 1.581347e-04 | -1.322540e+02 | 3.447244e+01 |
+--------------+--------------+---------------+--------------+
| 9.660592e-04 | 3.018935e-04 |  3.100114e+00 | 1.315673e+01 |
+--------------+--------------+---------------+--------------+
| 1.844295e-03 | 5.763421e-04 |  3.746861e+00 | 5.111084e+00 |
+--------------+--------------+---------------+--------------+
| 3.520927e-03 | 1.100290e-03 |  4.221855e+00 | 1.941720e+00 |
+--------------+--------------+---------------+--------------+


** Low - High Flux state results

Lets just have a look at the low and high flux state lag-frequencies:

use =lagfreq_multi_script.sl=

*Low flux*

Recall from the spectral fitting:
#+BEGIN_EXAMPLE
Group 1    Black    = Obs ID 0089960301  2001

Group 2    Red      = Obs ID 0720110801  2013
           Green    = Obs ID 0720110901  2013
           Blue     = Obs ID 0720111001  2013
           Cyan     = Obs ID 0720111101  2013
           Magenta  = Obs ID 0720111201  2013
           Yellow   = Obs ID 0720111301  2013
           Orange   = Obs ID 0720111401  2013
           Indigo   = Obs ID 0720111501  2013

Group 3    Purple   = Obs ID 0720111601  2014
#+END_EXAMPLE

Group 1 = Hi flux and Group 2 & 3 = Lo Flux

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC5548_lagfreq_lo_flux.PNG

Lags found in =/homeb/steff075/phd_ecm/NGC5548/lagvalues-lo-flux.csv=

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 7.272727e-05 | 2.272727e-05 |  1.155454e+02 | 4.975801e+02 |
+--------------+--------------+---------------+--------------+
| 1.388430e-04 | 4.338843e-05 | -3.003904e+02 | 2.403693e+02 |
+--------------+--------------+---------------+--------------+
| 2.650639e-04 | 8.283246e-05 |  1.029191e+02 | 6.954677e+01 |
+--------------+--------------+---------------+--------------+
| 5.060310e-04 | 1.581347e-04 |  8.911838e+00 | 3.359405e+01 |
+--------------+--------------+---------------+--------------+
| 9.660592e-04 | 3.018935e-04 | -1.679998e+00 | 1.210252e+01 |
+--------------+--------------+---------------+--------------+
| 1.844295e-03 | 5.763421e-04 | -8.703774e-01 | 4.594228e+00 |
+--------------+--------------+---------------+--------------+
| 3.520927e-03 | 1.100290e-03 | -5.313642e-01 | 1.802424e+00 |
+--------------+--------------+---------------+--------------+


*High flux*


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC5548_lagfreq_hi_flux.PNG

Lags found:
file =/homeb/steff075/phd_ecm/NGC5548/time_lags_hi-flux2.csv=


#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 7.272727e-05 | 2.272727e-05 |  9.631914e+01 | 2.019475e+02 |
+--------------+--------------+---------------+--------------+
| 1.388430e-04 | 4.338843e-05 |  1.106403e+02 | 1.066068e+02 |
+--------------+--------------+---------------+--------------+
| 2.650639e-04 | 8.283246e-05 | -1.973033e+02 | 9.871722e+01 |
+--------------+--------------+---------------+--------------+
| 5.060310e-04 | 1.581347e-04 | -1.838513e+02 | 6.724591e+01 |
+--------------+--------------+---------------+--------------+
| 9.660592e-04 | 3.018935e-04 |  5.569731e+00 | 2.987445e+01 |
+--------------+--------------+---------------+--------------+
| 1.844295e-03 | 5.763421e-04 |  7.379114e+00 | 1.301121e+01 |
+--------------+--------------+---------------+--------------+
| 3.520927e-03 | 1.100290e-03 |  8.062755e+00 | 4.826287e+00 |
+--------------+--------------+---------------+--------------+

Lets combine these results in Veusz

Use =homeb/steff075/phd_ecm/NGC5548/lag-results.ods= to obtain
the csv

Plot =homeb/steff075/phd_ecm/NGC5548/NGC5548-lag-results-lo-hi.vsz=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/NGC5548-lag-results-lo-hi-flux.png

pdf at:

http://www.star.bris.ac.uk/steff/ecm/NGC5548-lag-results-lo-hi-flux.pdf




*Genegenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28
accordingly. Run fits files to check:

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
%d=load_data("NGC5548-time-lags-combined.fits");
%r=load_rmf("NGC5548-time-lags-combined.rsp");
%d=load_data("NGC5548-time-lags-lo-flux.fits");
%r=load_rmf("NGC5548-time-lags-lo-flux.rsp");
d=load_data("NGC5548-time-lags-hi-flux.fits");
r=load_rmf("NGC5548-time-lags-hi-flux.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

Now copy these the BC4 for fitting to ECM model, e.g:

#+BEGIN_EXAMPLE
scp NGC5548-time-lags-hi-flux.fits so14935@bc4login.acrc.bris.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/NGC5548-time-lag-fits
#+END_EXAMPLE

** OBS 0112310101 (2001)

Use script =/homeb/steff075/phd_ecm/NGC5548/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,9.631914e+01,2.019475e+02
1.388430e-04,1.106403e+02,1.066068e+02
2.650639e-04,-1.973033e+02,9.871722e+01
5.060310e-04,-2.436372e+02,9.295133e+01
9.660592e-04,1.105142e+01,6.614458e+01
1.844295e-03,2.041112e+01,3.946560e+01
3.520927e-03,4.666893e+01,2.662342e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC5548_0112310101_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0720110801 (2013)

Use script =/homeb/steff075/phd_ecm/NGC5548/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.309091e-04,-2.889279e+03,1.830586e+03
2.499174e-04,1.807633e+03,2.619557e+02
4.771150e-04,1.390878e+02,3.627011e+02
9.108558e-04,4.914747e+02,2.395642e+02
1.738907e-03,-4.903877e+01,5.184791e+01
3.319731e-03,8.299285e+01,1.167268e+02
6.337668e-03,-3.233351e+01,1.787750e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC5548_0720110801_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0720110901 (2013)

Use script =/homeb/steff075/phd_ecm/NGC5548/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.163636e-04,-1.050542e+03,1.643185e+03
2.221488e-04,1.675218e+03,4.875996e+02
4.241022e-04,4.529129e+02,1.925379e+02
8.096496e-04,8.853158e+01,2.179223e+02
1.545695e-03,-3.394947e+02,9.247926e+01
2.950872e-03,-9.448904e+00,4.406613e+01
5.633482e-03,2.800541e+01,2.037814e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC5548_0720110901_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0720111001 (2013)

Use script =/homeb/steff075/phd_ecm/NGC5548/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.309091e-04,1.442029e+02,1.145976e+03
2.499174e-04,2.033367e+03,3.868009e+02
4.771150e-04,-1.065978e+03,1.285740e+02
9.108558e-04,-2.594526e+02,1.139428e+02
1.738907e-03,2.741564e+02,4.653223e+01
3.319731e-03,8.968259e+01,3.110158e+01
6.337668e-03,4.684520e+01,1.701485e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC5548_0720111001_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0720111101 (2013)

Use script =/homeb/steff075/phd_ecm/NGC5548/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.163636e-04,4.614307e+02,2.675903e+03
2.221488e-04,-8.952551e+01,1.082064e+02
4.241022e-04,-1.049356e+03,8.937279e+02
8.096496e-04,1.275345e+02,2.245381e+02
1.545695e-03,-2.664568e+02,2.311067e+02
2.950872e-03,1.468337e+02,1.163630e+02
5.633482e-03,2.635833e+01,1.771180e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC5548_0720111101_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0720111201 (2013)

Use script =/homeb/steff075/phd_ecm/NGC5548/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.163636e-04,2.155617e+03,9.688635e+02
2.221488e-04,7.451063e+02,1.651715e+03
4.241022e-04,7.729374e+02,1.765935e+02
8.096496e-04,5.563211e+02,8.411130e+01
1.545695e-03,-2.632341e+02,3.909992e+01
2.950872e-03,-1.052867e+02,4.116834e+01
5.633482e-03,-6.511158e+01,3.139322e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC5548_0720111201_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0720111301 (2013)

Use script =/homeb/steff075/phd_ecm/NGC5548/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.163636e-04,-2.919508e+03,8.663918e+02
2.221488e-04,1.122861e+03,1.461457e+03
4.241022e-04,-1.235977e+03,1.452224e+02
8.096496e-04,-5.617450e+02,1.658268e+02
1.545695e-03,3.377981e+01,1.880425e+02
2.950872e-03,-9.491858e+01,3.287955e+01
5.633482e-03,-3.084197e+00,1.478881e+01
#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC5548_0720111301_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0720111401 (2013)

Use script =/homeb/steff075/phd_ecm/NGC5548/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.163636e-04,-4.358275e+03,9.947001e+02
2.221488e-04,-3.275375e+02,4.189883e+02
4.241022e-04,6.525824e+02,3.153343e+02
8.096496e-04,1.204709e+02,1.680188e+02
1.545695e-03,-4.683111e+01,9.883358e+01
2.950872e-03,-9.655304e+00,4.002113e+01
5.633482e-03,6.339009e+01,2.868969e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC5548_0720111401_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0720111501 (2013)

Use script =/homeb/steff075/phd_ecm/NGC5548/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.163636e-04,4.032737e+03,2.970588e+03
2.221488e-04,1.952414e+03,6.671002e+02
4.241022e-04,-1.141844e+03,1.919518e+02
8.096496e-04,-4.218353e+02,1.669433e+02
1.545695e-03,2.360943e+02,5.558453e+01
2.950872e-03,-1.478394e+02,2.639559e+01
5.633482e-03,-2.128687e+01,3.648313e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC5548_0720111501_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0720111601 (2014)

Use script =/homeb/steff075/phd_ecm/NGC5548/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.163636e-04,-2.169205e+03,5.717594e+02
2.221488e-04,6.594143e+02,4.273240e+02
4.241022e-04,-3.800661e+02,2.711248e+02
8.096496e-04,-4.820257e+02,1.189866e+02
1.545695e-03,2.756805e+02,9.170472e+01
2.950872e-03,1.213664e+02,3.245634e+01
5.633482e-03,-3.552870e+00,5.226628e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC5548_0720111601_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** Combined Observations

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0089960301, 0720110801, 0720110901, 0720111001, 0720111101, 0720111201
0720111301, 0720111401, 0720111501, 0720111601

Total time 546.1 ks

script =lagfreq_comb_script.sl=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC5548_lagfreq_comb.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,9.832611e+01,2.216360e+02
1.388430e-04,1.001066e+02,9.166378e+01
2.650639e-04,-1.809548e+02,6.969836e+01
5.060310e-04,-2.631310e+02,6.903016e+01
9.660592e-04,1.106909e+01,5.233313e+01
1.844295e-03,2.180030e+01,3.284906e+01
3.520927e-03,4.210320e+01,1.893074e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC5548-combined-time-lags.fits");
r=load_rmf("NGC5548-combined-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH =/homeb/steff075/phd_ecm/NGC5548/NGC5548-time-lag-fits

** 2001 Observation

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0089960301 Total time 84 Ks
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC5548_lagfreq_2001.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,9.631914e+01,2.019475e+02
1.388430e-04,1.106403e+02,1.066068e+02
2.650639e-04,-1.973033e+02,9.871722e+01
5.060310e-04,-2.436372e+02,9.295133e+01
9.660592e-04,1.105142e+01,6.614458e+01
1.844295e-03,2.041112e+01,3.946560e+01
3.520927e-03,4.666893e+01,2.662342e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28
accordingly. Run fits files to check:

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC5548-2001-time-lags.fits");
r=load_rmf("NGC5548-2001-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH =/homeb/steff075/phd_ecm/NGC5548/NGC5548-time-lag-fits

** 2013 Observations

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0720110801, 0720110901, 0720111001, 0720111101, 0720111201
0720111301, 0720111401, 0720111501

Total time 406.1 ks
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC5548_lagfreq_2013.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,1.269801e+02,1.147510e+03
1.388430e-04,-2.827782e+03,1.119346e+03
2.650639e-04,1.271428e+03,7.820516e+02
5.060310e-04,9.044427e+02,1.399161e+02
9.660592e-04,-5.138255e+02,1.650668e+02
1.844295e-03,-2.736370e+02,7.596650e+01
3.520927e-03,-5.382182e+01,3.715273e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC5548-2013-time-lags.fits");
r=load_rmf("NGC5548-2013-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH =/homeb/steff075/phd_ecm/NGC5548/NGC5548-time-lag-fits

** 2014 Observations

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0720111601 Total time 56 ks
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC5548_lagfreq_2014.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,4.295949e+03,3.658487e+03
1.388430e-04,-1.680565e+03,1.171162e+03
2.650639e-04,5.364923e+02,3.182661e+02
5.060310e-04,-3.938205e+02,1.914727e+02
9.660592e-04,5.362796e+02,8.373137e+01
1.844295e-03,-2.671329e+02,3.396411e+02
3.520927e-03,7.408192e+01,2.746692e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC5548-2014-time-lags.fits");
r=load_rmf("NGC5548-2014-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH =/homeb/steff075/phd_ecm/NGC5548/NGC5548-time-lag-fits

* *NGC6860*

PATH to data = =/homeb/steff075/phd_ecm/NGC6860=

** 2009 Observations

First replot the fully combined lag-frequency for observations
(without running the absolute values for the real sum CPS):

0552170301 Total time 117 ks

script =lagfreq_comb_script.sl=

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC6860-lag-results.png

Taken > 9e-5 Hz
Lag Values
#+BEGIN_EXAMPLE
Freq,+-,Lag,+-
1.309091e-04,4.090909e-05,1.216714e+02,1.783590e+02
2.499174e-04,7.809917e-05,8.863017e+01,1.456236e+02
4.771150e-04,1.490984e-04,1.430938e+02,7.240407e+01
9.108558e-04,2.846424e-04,-1.313383e+01,3.500030e+01
1.738907e-03,5.434083e-04,-2.027358e-01,9.965317e+00
3.319731e-03,1.037416e-03,2.256244e+00,3.887162e+00
6.337668e-03,1.980521e-03,8.054905e-01,1.595509e+00
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC6860-2009-time-lags.fits");
r=load_rmf("NGC6860-2009-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH =/homeb/steff075/phd_ecm/NGC6860=

** Re-process in (0.3-1) and (1-5) keV energy range (see DeMarco2013)

PATH = =/data/scratch3/steff/NGC6860/0552170301/PROC=

*Set environments*

First ensure that the cshrc file ponts to the current version of
SAS and then resource the cshrc file:

#+BEGIN_EXAMPLE
setenv SAS_DIR /usr/local/xmmsas_20190531_1155
source /usr/local/xmmsas_20190531_1155/sas-setup.csh
source ~/.cshrc
#+END_EXAMPLE

#+BEGIN_EXAMPLE
heainit
setsas
setenv SAS_CCFPATH /usr/local/XMM/ccf/
setenv SAS_ODF /data/scratch3/steff/NGC6860/0552170301/ODF
#+END_EXAMPLE

Run by =sas_postproc_script.sl= to produce:

Find and replace 'soft' with 03-1 and 'hard' with 1-5 and comment out
all the Spectrum production code.

*Lag-frequency between 0.3-1 and 1-5 keV*

Plot =lagfreq_script03-1and1-5keV.sl=

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/NGC6860_lagfreq_03-5kev.gif

Lags found:

|          Feq |           +- |           Lag |           +- |
| 1.018182e-04 | 3.181818e-05 |  3.407245e+02 | 1.630352e+02 |
| 1.943802e-04 | 6.074380e-05 | -1.866575e+02 | 1.924977e+02 |
| 3.710894e-04 | 1.159654e-04 |  1.239371e+02 | 7.997089e+01 |
| 7.084434e-04 | 2.213886e-04 |  9.575381e-01 | 4.255489e+01 |
| 1.352483e-03 | 4.226509e-04 |  1.038167e+01 | 1.532055e+01 |
| 2.582013e-03 | 8.068790e-04 |  1.073320e+01 | 5.582384e+00 |
| 4.929297e-03 | 1.540405e-03 | -2.326066e+00 | 2.155300e+00 |


Make good images:

Plot =NGC6860-lag-results-lo-hi-flux.vsz=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/NGC6860-lag-results-lo-hi-flux.png

pdf at:

http://www.star.bris.ac.uk/steff/ecm/NGC6860-lag-results-lo-hi-flux.pdf

* *NGC7314*

PATH to data = =/homeb/steff075/phd_ecm/NGC7314=
** Combined

Lets just have a look at the combined flux state lag-frequencies >5e-5 Hz:

use =lagfreq_multi_script.sl=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC7314_lagfreq_comb.gif

Lags found in
=/homeb/steff075/phd_ecm/time_lags_comb_flux2.csv=

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
|         Freq |           +- |           Lag |           +- |
| 7.272727e-05 | 2.272727e-05 |  2.479250e+02 | 1.828579e+02 |
| 1.388430e-04 | 4.338843e-05 |  1.431032e+02 | 7.716661e+01 |
| 2.650639e-04 | 8.283246e-05 |  2.114891e+01 | 4.778578e+01 |
| 5.060310e-04 | 1.581347e-04 |  8.923114e+00 | 2.779235e+01 |
| 9.660592e-04 | 3.018935e-04 |  3.206881e+01 | 1.107714e+01 |
| 1.844295e-03 | 5.763421e-04 | -1.599821e+00 | 5.802032e+00 |
| 3.520927e-03 | 1.100290e-03 |  1.535774e+00 | 2.065800e+00 |



** Low - High Flux state results

Lets just have a look at the low and high flux state lag-frequencies:

use =lagfreq_multi_script.sl=

*Low flux*

Recall from the spectral fitting:
#+BEGIN_EXAMPLE
Group1      Black      = Obs ID 0111790101   2001

Group 2     Red        = Obs ID 0311190101   2006

Group 3     Blue       = Obs ID 0725200301   2013
            Green      = Obs ID 0725200101   2013
#+END_EXAMPLE

However, few lags were discovered by combining these groups,
instead, lets just look at the low flux using all obs except 011790101 (2001)


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC7314_lagfreq_loflux.gif

Lags found in =/homeb/steff075/phd_ecm/NGC7314/time_lags_loflux2.csv=

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped

|         Freq |           +- |           Lag |           +- |
| 1.163636e-04 | 3.636364e-05 |  2.109223e+02 | 1.010994e+02 |
| 2.221488e-04 | 6.942149e-05 |  7.665119e+01 | 7.137260e+01 |
| 4.241022e-04 | 1.325319e-04 |  3.958218e+01 | 3.536351e+01 |
| 8.096496e-04 | 2.530155e-04 |  2.240897e+01 | 1.615862e+01 |
| 1.545695e-03 | 4.830296e-04 |  6.186905e+00 | 7.434343e+00 |
| 2.950872e-03 | 9.221474e-04 | -1.218868e+00 | 2.917061e+00 |
| 5.633482e-03 | 1.760463e-03 |  4.252894e-01 | 1.098991e+00 |

*High flux*

Using just the black obs which was 0111790101 (2001)

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC7314_lagfreq_hiflux.gif

Lags found:
file =/homeb/steff075/phd_ecm/NGC7314/time_lags_hi-flux2.csv=


#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
|         Freq |           +- |           Lag |           +- |
| 7.272727e-05 | 2.272727e-05 |  5.817760e+02 | 3.440071e+02 |
| 1.388430e-04 | 4.338843e-05 |  1.624691e+02 | 1.413292e+02 |
| 2.650639e-04 | 8.283246e-05 | -1.044883e+02 | 1.017122e+02 |
| 5.060310e-04 | 1.581347e-04 | -6.228175e+01 | 7.698400e+01 |
| 9.660592e-04 | 3.018935e-04 |  5.447787e+01 | 2.617170e+01 |
| 1.844295e-03 | 5.763421e-04 | -5.580881e-01 | 1.618773e+01 |
| 3.520927e-03 | 1.100290e-03 |  5.361958e+00 | 6.083402e+00 |

Lets combine these results in Veusz

Use =homeb/steff075/phd_ecm/NGC7314/lag-results.ods= to obtain
the csv

Plot =homeb/steff075/phd_ecm/NGC7314/NGC7314-lag-results-lo-hi.vsz=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/NGC7314-lag-results-lo-hi-flux.png


pdf at:

http://www.star.bris.ac.uk/steff/ecm/NGC7314-lag-results-lo-hi-flux.pdf



*Genegenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28
accordingly. Run fits files to check:

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC7314-time-lags-combined.fits");
r=load_rmf("NGC7314-time-lags-combined.rsp");
%d=load_data("NGC7314-time-lags-lo-flux.fits");
%r=load_rmf("NGC7314-time-lags-lo-flux.rsp");
%d=load_data("NGC7314-time-lags-hi-flux.fits");
%r=load_rmf("NGC7314-time-lags-hi-flux.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

Now copy these the BC4 for fitting to ECM model, e.g:

#+BEGIN_EXAMPLE
scp NGC7314-time-lags-hi-flux.fits so14935@bc4login.acrc.bris.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/NGC7314-time-lag-fits
#+END_EXAMPLE

** OBS 0111790101 (2001)

Use script =/homeb/steff075/phd_ecm/NGC7314/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.163636e-04,2.536361e+02,2.130953e+02
2.221488e-04,-4.293748e+01,9.013674e+01
4.241022e-04,1.463622e+00,9.725037e+01
8.096496e-04,2.387767e+01,4.263083e+01
1.545695e-03,8.597118e+00,3.388223e+01
2.950872e-03,2.048476e+01,2.241029e+01
5.633482e-03,9.951546e+00,2.366768e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC7314_0111790101_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0311190101 (2006)

Use script =/homeb/steff075/phd_ecm/NGC7314/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.163636e-04,3.428512e+02,9.089191e+01
2.221488e-04,-1.174308e+02,2.354539e+02
4.241022e-04,7.226210e+01,1.600362e+02
8.096496e-04,9.641672e+00,1.689888e+02
1.545695e-03,-2.332129e+01,1.362759e+02
2.950872e-03,1.498383e+02,1.926774e+01
5.633482e-03,-8.308665e+01,1.140510e+02


#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC7314_0311190101_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0725200101 (2013)

Use script =/homeb/steff075/phd_ecm/NGC7314/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,5.176522e+02,3.517241e+02
1.388430e-04,2.194292e+02,1.551789e+02
2.650639e-04,9.577387e+01,1.195776e+02
5.060310e-04,5.881685e+01,4.398062e+01
9.660592e-04,3.462805e+01,5.855344e+01
1.844295e-03,-4.891480e+01,3.550964e+01
3.520927e-03,-4.610333e+01,3.470994e+01


#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC7314_0725200101_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0725200301 (2013)

Use script =/homeb/steff075/phd_ecm/NGC7314/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,7.695805e+01,2.384867e+02
1.388430e-04,3.527785e+01,1.547185e+02
2.650639e-04,1.046919e+02,8.793407e+01
5.060310e-04,4.328767e+01,7.043285e+01
9.660592e-04,6.581116e+01,4.457658e+01
1.844295e-03,1.284807e+02,9.748133e+01
3.520927e-03,2.363823e+01,4.358302e+01


#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC7314_0725200301_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** Combined Observations

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0111790101, 0311190101, 0725200101, 0725200301 Total time 367 ks

script =lagfreq_comb_script.sl=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC7314_lagfreq_comb.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,2.479250e+02,1.828579e+02
1.388430e-04,1.433561e+02,7.783560e+01
2.650639e-04,2.290812e+01,5.697587e+01
5.060310e-04,9.956592e+00,3.280872e+01
9.660592e-04,5.087745e+01,2.010654e+01
1.844295e-03,-6.444326e+00,2.633062e+01
3.520927e-03,1.400899e+01,2.138006e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC7314-combined-time-lags.fits");
r=load_rmf("NGC7314-combined-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH =/homeb/steff075/phd_ecm/NGC7314/NCG7314-time-lags-fits=

** 2001 Observation

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0111790101 Total time 43 Ks
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC7314_lagfreq_2001.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,5.817760e+02,3.440071e+02
1.388430e-04,1.624691e+02,1.413292e+02
2.650639e-04,-1.057490e+02,1.058051e+02
5.060310e-04,-6.293348e+01,7.834122e+01
9.660592e-04,5.754856e+01,2.874013e+01
1.844295e-03,-1.182151e+00,3.825493e+01
3.520927e-03,1.778714e+01,2.245098e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NCG7314-2001-time-lags.fits");
r=load_rmf("NCG7314-2001-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH =/homeb/steff075/phd_ecm/NGC7314/NCG7314-time-lags-fits=

** 2006 Observation

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0311190101 Total time 74 Ks
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC7314_lagfreq_2006.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,7.929937e+01,3.178522e+02
1.388430e-04,1.288982e+02,1.719059e+02
2.650639e-04,1.387151e+02,3.150069e+02
5.060310e-04,2.082193e+02,1.041654e+02
9.660592e-04,-8.282735e+01,1.502340e+02
1.844295e-03,1.488017e+02,1.930624e+02
3.520927e-03,1.068800e+02,2.453344e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NCG7314-2006-time-lags.fits");
r=load_rmf("NCG7314-2006-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH =/homeb/steff075/phd_ecm/NGC7314/NCG7314-time-lags-fits=

** 2013 Observations

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0725200101, 0725200301 Total time 250 ks
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC7314_lagfreq_2013.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,2.236130e+02,2.054056e+02
1.388430e-04,1.331490e+02,1.121262e+02
2.650639e-04,1.008580e+02,7.215455e+01
5.060310e-04,5.305616e+01,3.847052e+01
9.660592e-04,5.143234e+01,3.622549e+01
1.844295e-03,-2.166842e+01,4.910561e+01
3.520927e-03,-2.024260e+01,3.567648e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NCG7314-2013-time-lags.fits");
r=load_rmf("NCG7314-2013-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH =/homeb/steff075/phd_ecm/NGC7314/NCG7314-time-lags-fits=

* *NGC7469*

PATH to data = =/homeb/steff075/phd_ecm/NGC7469=
** Combined

Lets just have a look at the combined flux state lag-frequencies >5e-5 Hz:

use =lagfreq_multi_script.sl=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC7469_lagfreq_comb.PNG

Lags found in
=/homeb/steff075/phd_ecm/NGC7469/time_lags_comb_flux2.csv=

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 1.163636e-04 | 3.636364e-05 | -1.766405e+02 | 1.479955e+02 |
+--------------+--------------+---------------+--------------+
| 2.221488e-04 | 6.942149e-05 |  9.387162e+01 | 7.157505e+01 |
+--------------+--------------+---------------+--------------+
| 4.241022e-04 | 1.325319e-04 | -4.033246e+01 | 4.652899e+01 |
+--------------+--------------+---------------+--------------+
| 8.096496e-04 | 2.530155e-04 | -8.829869e+00 | 2.031145e+01 |
+--------------+--------------+---------------+--------------+
| 1.545695e-03 | 4.830296e-04 | -1.671221e-01 | 8.947895e+00 |
+--------------+--------------+---------------+--------------+
| 2.950872e-03 | 9.221474e-04 | -1.198178e+00 | 3.428240e+00 |
+--------------+--------------+---------------+--------------+
| 5.633482e-03 | 1.760463e-03 | -2.067588e-02 | 1.384435e+00 |
+--------------+--------------+---------------+--------------+

** Low - High Flux state results

Lets just have a look at the low and high flux state lag-frequencies:

use =lagfreq_multi_script.sl=

*Low flux*

Recall from the spectral fitting:
#+BEGIN_EXAMPLE
Group 1   Green     = Obs ID 0207090101   2004
          Red       = Obs ID 0112170301   2000

Group 2   Blue      = Obs ID 0207090201   2004
          Black     = Obs ID 0112170101   2000
#+END_EXAMPLE

Group 1 = Hi flux and Group 2 = Lo Flux >8e-5 Hz

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC7469_lagfreq_lo_flux.PNG

Lags found in =/homeb/steff075/phd_ecm/NGC7469/lagvalues-lo-flux.csv=

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 1.163636e-04 | 3.636364e-05 | -3.833379e+01 | 1.648836e+02 |
+--------------+--------------+---------------+--------------+
| 2.221488e-04 | 6.942149e-05 |  1.021893e+02 | 8.540348e+01 |
+--------------+--------------+---------------+--------------+
| 4.241022e-04 | 1.325319e-04 |  2.728681e+01 | 4.971993e+01 |
+--------------+--------------+---------------+--------------+
| 8.096496e-04 | 2.530155e-04 | -5.507760e+01 | 2.679474e+01 |
+--------------+--------------+---------------+--------------+
| 1.545695e-03 | 4.830296e-04 | -5.881911e+00 | 1.174573e+01 |
+--------------+--------------+---------------+--------------+
| 2.950872e-03 | 9.221474e-04 |  2.838381e+00 | 4.260594e+00 |
+--------------+--------------+---------------+--------------+
| 5.633482e-03 | 1.760463e-03 | -1.366148e+00 | 1.990613e+00 |
+--------------+--------------+---------------+--------------+


*High flux*

Using only the longer data set obs 0207090101

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC7469_lagfreq_hi_flux.PNG

Lags found:
file =/homeb/steff075/phd_ecm/NGC7469/time_lags_hi-flux2.csv=


#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 7.272727e-05 | 2.272727e-05 |  2.965439e+01 | 5.924323e+02 |
+--------------+--------------+---------------+--------------+
| 1.388430e-04 | 4.338843e-05 | -1.478576e+02 | 2.363609e+02 |
+--------------+--------------+---------------+--------------+
| 2.650639e-04 | 8.283246e-05 | -4.040262e+02 | 1.708869e+02 |
+--------------+--------------+---------------+--------------+
| 5.060310e-04 | 1.581347e-04 |  5.250081e+00 | 8.142407e+01 |
+--------------+--------------+---------------+--------------+
| 9.660592e-04 | 3.018935e-04 |  2.661421e+01 | 2.710969e+01 |
+--------------+--------------+---------------+--------------+
| 1.844295e-03 | 5.763421e-04 | -4.403291e+00 | 1.152120e+01 |
+--------------+--------------+---------------+--------------+
| 3.520927e-03 | 1.100290e-03 |  5.919958e+00 | 4.641953e+00 |
+--------------+--------------+---------------+--------------+

Lets combine these results in Veusz

Use =homeb/steff075/phd_ecm/NGC7469/lag-results.ods= to obtain
the csv

Plot =homeb/steff075/phd_ecm/NGC7469/NGC7469-lag-results-lo-hi.vsz=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/NGC7469-lag-results-lo-hi-flux.png


pdf at
http://www.star.bris.ac.uk/steff/ecm/NGC7469-lag-results-lo-hi-flux.pdf



*Genegenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28
accordingly. Run fits files to check:

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC7469-time-lags-combined.fits");
r=load_rmf("NGC7469-time-lags-combined.rsp");
%d=load_data("NGC7469-time-lags-lo-flux.fits");
%r=load_rmf("NGC7469-time-lags-lo-flux.rsp");
%d=load_data("NGC7469-time-lags-hi-flux.fits");
%r=load_rmf("NGC7469-time-lags-hi-flux.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

Now copy these the BC4 for fitting to ECM model, e.g:

#+BEGIN_EXAMPLE
scp NGC7469-time-lags-hi-flux.fits so14935@bc4login.acrc.bris.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/NGC7469-time-lag-fits
#+END_EXAMPLE

** OBS 0112170101 (2000)

Use script =/homeb/steff075/phd_ecm/NGC7314/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.309091e-04,-8.759998e+01,1.587817e+01
2.499174e-04,2.252617e+02,1.330701e+02
4.771150e-04,-5.148643e+01,5.897638e+01
9.108558e-04,-4.745889e+01,4.652783e+01
1.738907e-03,2.622771e+01,3.505008e+01
3.319731e-03,8.465476e+01,1.010008e+02
6.337668e-03,-2.489685e+01,2.859828e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC7469_0112170101_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0112170301 (2000)

Use script =/homeb/steff075/phd_ecm/NGC7314/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.018182e-04,-1.096210e+02,1.630859e+02
1.943802e-04,-5.838418e+02,3.591597e+02
3.710894e-04,-7.236117e+02,5.238286e+02
7.084434e-04,6.806791e+02,1.118585e+02
1.352483e-03,6.753196e+01,1.149194e+02
2.582013e-03,-1.244985e+02,5.190088e+01
4.929297e-03,1.036241e+02,1.911712e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC7469_0112170301_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0207090101 (2000)

Use script =/homeb/steff075/phd_ecm/NGC7314/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,2.965439e+01,5.924323e+02
1.388430e-04,-1.478576e+02,2.363609e+02
2.650639e-04,-9.486338e+02,3.275548e+02
5.060310e-04,1.024959e+03,2.658599e+02
9.660592e-04,6.720718e+01,7.745434e+01
1.844295e-03,-2.340375e+01,6.931290e+01
3.520927e-03,1.100802e+02,3.111598e+01


#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC7469_0207090101_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0207090201 (2000)

Use script =/homeb/steff075/phd_ecm/NGC7314/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,8.659257e+02,1.662345e+02
1.388430e-04,2.021799e+02,2.808252e+02
2.650639e-04,3.891547e+02,6.466851e+02
5.060310e-04,2.888763e+02,2.683787e+02
9.660592e-04,-5.846619e+01,7.912075e+01
1.844295e-03,-2.422260e+02,6.949946e+01
3.520927e-03,4.071345e+01,1.054999e+02


#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC7469_0207090201_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** 2000 Observation

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0112170101, 0112170301 Total time 40.5 Ks

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC7469_lagfreq_2000.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,1.408645e+02,2.933027e+01
1.388430e-04,-1.118209e+02,6.425912e+01
2.650639e-04,1.578377e+02,1.206418e+02
5.060310e-04,-8.228497e+01,9.819747e+01
9.660592e-04,2.545912e+01,4.933985e+01
1.844295e-03,-5.197134e+01,3.465339e+01
3.520927e-03,8.543955e+01,4.251430e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC7469-2000-time-lags.fits");
r=load_rmf("NGC7469-2000-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH =/homeb/steff075/phd_ecm/NGC7469/NCG7469-time-lags-fits=

** 2004 Observation

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0207090101, 0207090201 Total time 163 Ks
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC7469_lagfreq_2004.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,7.045124e+02,2.941310e+02
1.388430e-04,6.510253e+01,1.959670e+02
2.650639e-04,-5.621246e+02,6.123924e+02
5.060310e-04,6.942912e+02,4.318311e+02
9.660592e-04,1.356333e+01,5.937083e+01
1.844295e-03,-1.211976e+02,1.377728e+02
3.520927e-03,9.861243e+01,3.877459e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC7469-2004-time-lags.fits");
r=load_rmf("NGC7469-2004-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH =/homeb/steff075/phd_ecm/NGC7469/NCG7469-time-lags-fits=

** Group 1 Observation Spectra

#+BEGIN_EXAMPLE
Group 1   Green     = Obs ID 0207090101   2004
          Red       = Obs ID 0112170301   2000
#+END_EXAMPLE

Lets have a look at the lag frequency for this single observation:

Use script =lagfreq_comb_script_Grp1.sl=

Lag values:
#+BEGIN_EXAMPLE
7.272727e-05,1.424880e+01,5.332887e+02
1.388430e-04,-2.465332e+02,2.089037e+02
2.650639e-04,-8.651033e+02,3.297773e+02
5.060310e-04,1.027686e+03,1.451441e+02
9.660592e-04,9.050621e+01,7.083468e+01
1.844295e-03,-5.067816e+01,5.230073e+01
3.520927e-03,1.101576e+02,2.934243e+01

#+END_EXAMPLE
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC7469_lagfreq_Grp1.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NCG7469-Grp1-time-lags.fits");
r=load_rmf("NCG7469-Grp1-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH =/homeb/steff075/phd_ecm/NGC7469/NCG7469-time-lags-fits=

** Group 2 Observation Spectra

#+BEGIN_EXAMPLE
Group 2   Blue      = Obs ID 0207090201   2004
          Black     = Obs ID 0112170101   2000
#+END_EXAMPLE

*Lag-frequency*

Lets have a look at the lag frequency for this single observation:

Use script =lagfreq_comb_script_Grp2.sl=

Lag values:
#+BEGIN_EXAMPLE
7.272727e-05,4.129707e+02,1.604197e+02
1.388430e-04,-5.208627e+00,1.282005e+02
2.650639e-04,2.050840e+02,1.452755e+02
5.060310e-04,-1.876771e+01,7.484820e+01
9.660592e-04,-2.005562e+01,4.109254e+01
1.844295e-03,-1.287128e+02,1.071084e+02
3.520927e-03,5.871939e+01,5.452518e+01

#+END_EXAMPLE
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC7469_lagfreq_Grp2.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NCG7469-Grp2-time-lags.fits");
r=load_rmf("NCG7469-Grp2-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

PATH =/homeb/steff075/phd_ecm/NGC7469/NCG7469-time-lags-fits=

** *Re-process in (0.3-1) and (1-5) keV energy range* (see DeMarco2013)

PATH = =/data/scratch3/steff/NGC7469/obsID/PROC=

*Set environments*

First ensure that the cshrc file ponts to the current version of
SAS and then resource the cshrc file:

#+BEGIN_EXAMPLE
setenv SAS_DIR /usr/local/xmmsas_20190531_1155
source /usr/local/xmmsas_20190531_1155/sas-setup.csh
source ~/.cshrc
#+END_EXAMPLE

#+BEGIN_EXAMPLE
heainit
setsas
setenv SAS_CCFPATH /usr/local/XMM/ccf/
setenv SAS_ODF /data/scratch3/steff/NGC7469/ObsID/ODF
#+END_EXAMPLE

Run by =sas_postproc_script.sl= to produce:

Find and replace 'soft' with 03-15 and 'hard' with 15-50 and comment out
all the Spectrum production code.

*Lag-frequency between 0.3-1.5 and 1.5-5 keV*

Plot =lagfreq_script03-15and15-50keV.sl=

** Combined lag

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/NGC7469_lagfreq_03-15and15-50_combined.gif

Lags found:

|          Feq |           +- |           Lag |           +- |
| 1.018182e-04 | 3.181818e-05 |  2.818535e+01 | 1.650351e+02 |
| 1.943802e-04 | 6.074380e-05 |  7.762066e+01 | 1.120644e+02 |
| 3.710894e-04 | 1.159654e-04 | -8.214761e+01 | 5.105707e+01 |
| 7.084434e-04 | 2.213886e-04 |  2.444732e+01 | 2.416160e+01 |
| 1.352483e-03 | 4.226509e-04 | -3.657160e-01 | 1.090868e+01 |
| 2.582013e-03 | 8.068790e-04 | -9.103766e+00 | 4.521086e+00 |
| 4.929297e-03 | 1.540405e-03 | -2.372082e+00 | 1.712392e+00 |

** Hi-flux lag

Using "0207090101","0112170301"

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/NGC7469_lagfreq_03-15and15-50_hiflux.gif

Lags found:

|          Feq |           +- |           Lag |           +- |
| 1.018182e-04 | 3.181818e-05 | -1.538517e+02 | 2.405029e+02 |
| 1.943802e-04 | 6.074380e-05 |  2.342702e+02 | 1.432226e+02 |
| 3.710894e-04 | 1.159654e-04 | -2.922958e+02 | 8.025011e+01 |
| 7.084434e-04 | 2.213886e-04 |  2.037861e+01 | 4.095860e+01 |
| 1.352483e-03 | 4.226509e-04 |  2.630463e+01 | 1.912282e+01 |
| 2.582013e-03 | 8.068790e-04 | -1.005484e+01 | 6.927444e+00 |
| 4.929297e-03 | 1.540405e-03 | -1.534151e+00 | 2.457060e+00 |

** Lo-flux lag

Using "0112170101","0207090201"

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/NGC7469_lagfreq_03-15and15-50_loflux.gif

Lags found:

|          Feq |           +- |           Lag |           +- |
| 1.018182e-04 | 3.181818e-05 |  1.364940e+02 | 2.020088e+02 |
| 1.943802e-04 | 6.074380e-05 | -8.964239e+00 | 1.562771e+02 |
| 3.710894e-04 | 1.159654e-04 |  2.624276e+01 | 4.694615e+01 |
| 7.084434e-04 | 2.213886e-04 |  2.719711e+01 | 2.909375e+01 |
| 1.352483e-03 | 4.226509e-04 | -1.840160e+01 | 1.209408e+01 |
| 2.582013e-03 | 8.068790e-04 | -8.069644e+00 | 5.741265e+00 |
| 4.929297e-03 | 1.540405e-03 | -3.338328e+00 | 2.364965e+00 |

** Plot in  veusz

PATH =
=/home/steff075/phd_ecm/NGC7469/NGC7469-lag-results-lo-hi-03-5keV.vsz=

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/NGC7469-lag-results-lo-hi-03-5keV.png


pdf at:

http://www.star.bris.ac.uk/steff/ecm/NGC7469-lag-results-lo-hi-03-5keV.pdf

* *PG1211+143*

PATH to data = =/homeb/steff075/phd_ecm/PG1211+143=
** Combined

Lets just have a look at the combined flux state lag-frequencies >1e-4 Hz:

use =lagfreq_multi_script.sl=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/PG1211+143_lagfreq_comb.gif

Lags found in
=/homeb/steff075/phd_ecm/PG1211+143/time_lags_comb2.csv=

|         Freq |           +- |           Lag |           +- |
| 4.363636e-05 | 1.363636e-05 |  4.683990e+01 | 2.379002e+02 |
| 8.330579e-05 | 2.603306e-05 | -2.156319e+02 | 1.127175e+02 |
| 1.590383e-04 | 4.969947e-05 | -8.162669e+01 | 7.751739e+01 |
| 3.036186e-04 | 9.488081e-05 |  7.072757e+01 | 5.142309e+01 |
| 5.796355e-04 | 1.811361e-04 |  4.291398e+01 | 2.265250e+01 |
| 1.106577e-03 | 3.458053e-04 |  9.515670e+00 | 8.095733e+00 |
| 2.112556e-03 | 6.601737e-04 | -5.655556e+00 | 3.068784e+00 |


** Low - High Flux state results

Lets just have a look at the low and high flux state lag-frequencies:

use =lagfreq_multi_script.sl=

*Low flux*

Recall from the spectral fitting:
#+BEGIN_EXAMPLE
Group 1   Green    = Obs ID  0502050101  2007
          Black    = Obs ID  0745110501  2014
          Blue     = Obs ID  0502050201  2007
          Purple   = Obs ID  0745110601  2014

Group 2   Cyan     = Obs ID  0745110101  2014
          Orange   = Obs ID  0745110401  2014
          Grey     = Obs ID  0745110701  2014

Group 3   Yellow   = Obs ID  0745110301  2014
          Red      = Obs ID  0208020101  2004

Group 4   Indigo   = Obs ID  0745110201  2014
          Magenta  = Obs ID  0112610101  2001
#+END_EXAMPLE

Group 1 & 2 = Hi flux and Group 3 & 4 = Lo Flux

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/PG1211+143_lagfreq_loflux.gif

Lags found in =/homeb/steff075/phd_ecm/PG1211+143/lagvalues-lo-flux.csv=

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped

|         Freq |           +- |           Lag |           +- |
| 7.272727e-05 | 2.272727e-05 | -3.130820e+02 | 1.707070e+02 |
| 1.388430e-04 | 4.338843e-05 | -1.305987e+02 | 1.798698e+02 |
| 2.650639e-04 | 8.283246e-05 |  1.873160e+02 | 1.227200e+02 |
| 5.060310e-04 | 1.581347e-04 | -1.069609e+01 | 5.495195e+01 |
| 9.660592e-04 | 3.018935e-04 |  2.162793e+01 | 1.620963e+01 |
| 1.844295e-03 | 5.763421e-04 | -8.455881e+00 | 6.335203e+00 |
| 3.520927e-03 | 1.100290e-03 |  2.789755e+00 | 2.463061e+00 |



*High flux*

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/PG1211+143_lagfreq_hiflux.gif

Lags found:
file =/homeb/steff075/phd_ecm/PG1211+143/time_lags_hi-flux2.csv=


#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped

|         Freq |           +- |           Lag |           +- |
| 4.363636e-05 | 1.363636e-05 |  1.271382e+02 | 2.913592e+02 |
| 8.330579e-05 | 2.603306e-05 | -1.620947e+02 | 1.403653e+02 |
| 1.590383e-04 | 4.969947e-05 | -6.753157e+01 | 9.194440e+01 |
| 3.036186e-04 | 9.488081e-05 |  6.781795e+01 | 6.072797e+01 |
| 5.796355e-04 | 1.811361e-04 |  4.581538e+01 | 2.729677e+01 |
| 1.106577e-03 | 3.458053e-04 | -1.292392e+00 | 9.996709e+00 |
| 2.112556e-03 | 6.601737e-04 | -4.413910e+00 | 3.751177e+00 |



Lets combine these results in Veusz

Use =homeb/steff075/phd_ecm/PG1211+143/lag-results.ods= to obtain
the csv

Plot =homeb/steff075/phd_ecm/PG1211+143/PG1211+143-lag-results-lo-hi.vsz=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/PG1211+143-lag-results-lo-hi-flux.png

#+ATTR_HTML: :width 800

http://www.star.bris.ac.uk/steff/ecm/PG1211+143-lag-results-lo-hi-flux.pdf

*Genegenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28
accordingly. Run fits files to check:

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
%d=load_data("PG1211+143-time-lags-combined.fits");
%r=load_rmf("PG1211+143-time-lags-combined.rsp");
%d=load_data("PG1211+143-time-lags-lo-flux.fits");
%r=load_rmf("PG1211+143-time-lags-lo-flux.rsp");
d=load_data("PG1211+143-time-lags-hi-flux.fits");
r=load_rmf("PG1211+143-time-lags-hi-flux.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

Now copy these the BC4 for fitting to ECM model, e.g:

#+BEGIN_EXAMPLE
scp PG1211+143-time-lags-hi-flux.fits so14935@bc4login.acrc.bris.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/PG1211+143-time-lag-fits
#+END_EXAMPLE

** Investigate spectral groupings

Lets plot the unfolded spectra for all data sets to identify them

http://www.star.bris.ac.uk/steff/ecm/PG1211+143_Spectra_all_unfolded.gif

*Key:* (from top to bottom)
#+BEGIN_EXAMPLE
Green    = Obs ID  0502050101  2007
Black    = Obs ID  0745110501  2014
Blue     = Obs ID  0502050201  2007
Purple   = Obs ID  0745110601  2014
Cyan     = Obs ID  0745110101  2014
Orange   = Obs ID  0745110401  2014
Grey     = Obs ID  0745110701  2014
Yellow   = Obs ID  0745110301  2014
Red      = Obs ID  0208020101  2004
Indigo   = Obs ID  0745110201  2014
Magenta  = Obs ID  0112610101  2001
#+END_EXAMPLE

*Establish Groups*

Spectral groups emerging, so lets continue to plotting combined spectra
with the following groups:
#+BEGIN_EXAMPLE
Group 1   Green    = Obs ID  0502050101  2007
          Black    = Obs ID  0745110501  2014
          Blue     = Obs ID  0502050201  2007
          Purple   = Obs ID  0745110601  2014

Group 2   Cyan     = Obs ID  0745110101  2014
          Orange   = Obs ID  0745110401  2014
          Grey     = Obs ID  0745110701  2014

Group 3   Yellow   = Obs ID  0745110301  2014
          Red      = Obs ID  0208020101  2004

Group 4   Indigo   = Obs ID  0745110201  2014
          Magenta  = Obs ID  0112610101  2001
#+END_EXAMPLE

** OBS 0112610101 (2001)

Use script =/homeb/steff075/phd_ecm/PG1211+143/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.163636e-04,-7.063968e+02,2.389300e+02
2.221488e-04,-1.227847e+03,4.081031e+02
4.241022e-04,3.491338e+02,3.186378e+02
8.096496e-04,3.257583e+02,1.177275e+02
1.545695e-03,-2.754558e+02,3.914099e+01
2.950872e-03,9.332606e+01,3.448938e+01
5.633482e-03,9.119365e+01,4.007193e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/PG1211+143_0112610101_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0208020101 (2004)

Use script =/homeb/steff075/phd_ecm/PG1211+143/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.163636e-04,-3.384363e+02,2.372707e+02
2.221488e-04,4.905479e+02,2.092601e+02
4.241022e-04,-5.462233e+01,3.797623e+02
8.096496e-04,3.240062e+02,8.249680e+01
1.545695e-03,2.537233e+02,9.857883e+01
2.950872e-03,-1.304506e+02,2.873594e+01
5.633482e-03,4.193079e+00,2.217808e+01
#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/PG1211+143_0208020101_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0502050101 (2007)

Use script =/homeb/steff075/phd_ecm/PG1211+143/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.163636e-04,-2.887170e+02,4.655714e+02
2.221488e-04,-2.362550e+02,2.211665e+02
4.241022e-04,-9.214557e+02,1.039649e+03
8.096496e-04,5.457974e+01,1.100734e+02
1.545695e-03,-2.864622e+02,9.108305e+01
2.950872e-03,6.213591e+01,4.515486e+01
5.633482e-03,-6.581914e+01,2.125031e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/PG1211+143_0502050101_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0502050201 (2007)

Use script =/homeb/steff075/phd_ecm/PG1211+143/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.454545e-04,-1.786655e+02,3.158639e+02
2.776860e-04,3.235809e+02,7.613360e+02
5.301277e-04,1.097079e+02,1.610333e+02
1.012062e-03,-3.799488e+02,1.149545e+02
1.932118e-03,1.956704e+02,1.106793e+02
3.688590e-03,6.947932e+01,1.013047e+02
7.041853e-03,-5.455796e+00,2.405265e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/PG1211+143_0502050201_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0745110101 (2014)

Use script =/homeb/steff075/phd_ecm/PG1211+143/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,-2.492473e+02,5.668186e+02
1.388430e-04,-1.440827e+02,2.342008e+02
2.650639e-04,1.441914e+02,2.672046e+02
5.060310e-04,-5.969645e+02,3.456382e+02
9.660592e-04,-9.201914e+01,1.282941e+02
1.844295e-03,-1.359320e+01,1.346841e+02
3.520927e-03,-6.100500e+01,3.488934e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/PG1211+143_0745110101_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE
** OBS 0745110201 (2014)

Use script =/homeb/steff075/phd_ecm/PG1211+143/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,-8.266760e+02,3.705499e+02
1.388430e-04,2.050678e+02,5.239691e+02
2.650639e-04,3.421885e+02,1.620603e+02
5.060310e-04,-2.061648e+02,1.983100e+02
9.660592e-04,-1.754436e+01,1.057902e+02
1.844295e-03,-1.892414e+02,5.394709e+01
3.520927e-03,1.000723e+02,3.204427e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/PG1211+143_0745110201_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE
** OBS 0745110301 (2014)

Use script =/homeb/steff075/phd_ecm/PG1211+143/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.163636e-04,-6.715190e+01,9.862236e+02
2.221488e-04,9.513556e+02,4.904807e+02
4.241022e-04,-2.834616e+02,3.417190e+02
8.096496e-04,-2.539119e+02,3.119287e+02
1.545695e-03,9.803523e+00,1.071240e+02
2.950872e-03,5.846597e+01,9.076707e+01
5.633482e-03,-5.577303e+01,1.641557e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/PG1211+143_0745110301_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE
** OBS 0745110401 (2014)

Use script =/homeb/steff075/phd_ecm/PG1211+143/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,1.318851e+02,9.598740e+02
1.388430e-04,3.554958e+02,3.134365e+02
2.650639e-04,3.245026e+02,3.439844e+02
5.060310e-04,-7.868235e+01,2.370219e+02
9.660592e-04,1.706699e+02,1.152758e+02
1.844295e-03,1.550629e+02,3.704857e+01
3.520927e-03,-9.710089e+01,4.346451e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/PG1211+143_0745110401_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0745110501 (2014)

Use script =/homeb/steff075/phd_ecm/PG1211+143/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,8.582046e+00,2.627762e+02
1.388430e-04,1.634072e+02,1.961475e+02
2.650639e-04,1.308377e+02,1.392506e+02
5.060310e-04,3.400347e+02,1.891687e+02
9.660592e-04,5.005448e+02,1.934921e+02
1.844295e-03,2.178194e+02,5.226243e+01
3.520927e-03,1.118953e+02,3.445079e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/PG1211+143_0745110501_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0745110601 (2014)

Use script =/homeb/steff075/phd_ecm/PG1211+143/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,-3.699282e+02,3.214573e+02
1.388430e-04,-2.423205e+01,1.263409e+02
2.650639e-04,8.861233e+02,1.407385e+03
5.060310e-04,3.327639e+02,1.338812e+02
9.660592e-04,5.318205e+00,8.712315e+01
1.844295e-03,-1.386007e+02,2.868210e+01
3.520927e-03,4.985147e+01,4.776704e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/PG1211+143_0745110601_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0745110701 (2014)

Use script =/homeb/steff075/phd_ecm/PG1211+143/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,1.773082e+02,1.109200e+02
1.388430e-04,-2.626564e+02,3.368807e+02
2.650639e-04,5.691500e+02,1.362288e+03
5.060310e-04,6.487459e+02,4.515318e+02
9.660592e-04,7.006879e+01,1.671751e+02
1.844295e-03,-2.431589e+02,5.610329e+01
3.520927e-03,1.281652e+02,5.199901e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/PG1211+143_0745110701_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** Combined Observations

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0112610101, 0208020101, 0502050101, 0502050201, 0745110101
0745110201, 0745110301, 0745110401, 0745110501, 0745110601
0745110701

Total time  ks

script =lagfreq_comb_script.sl=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/PG1211+143_lagfreq_comb.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,-1.728796e+02,1.335817e+02
1.388430e-04,-1.300814e+01,9.290339e+01
2.650639e-04,5.031674e+01,1.084468e+02
5.060310e-04,1.190547e+02,1.318062e+02
9.660592e-04,7.012290e+01,8.985943e+01
1.844295e-03,-2.516278e+02,5.377964e+01
3.520927e-03,8.698954e+01,5.212810e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("time_lags_comb.fits");
r=load_rmf("time_lags_comb.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** 2001 Observation

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

 Total time 80 Ks
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/PG1211+143_lagfreq_2001.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,6.165834e+01,1.010039e+02
1.388430e-04,-8.251287e+02,3.854319e+02
2.650639e-04,-7.428399e+02,4.652814e+02
5.060310e-04,1.010505e+02,5.846299e+02
9.660592e-04,3.644611e+02,8.483184e+01
1.844295e-03,-2.151729e+02,5.773044e+01
3.520927e-03,7.829499e+01,7.172542e+01

#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("time_lags_2007.fits");
r=load_rmf("time_lags_2007.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** 2004 Observation

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

 Total time 80 Ks
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/PG1211+143_lagfreq_2004.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,-4.694597e+02,3.560458e+02
1.388430e-04,-1.618710e+02,3.714857e+02
2.650639e-04,-1.038756e+02,1.843132e+02
5.060310e-04,2.659084e+02,1.793536e+02
9.660592e-04,3.519314e+02,1.057555e+02
1.844295e-03,2.844955e+02,1.148726e+02
3.520927e-03,-1.124523e+02,7.322649e+01

#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("time_lags_2007.fits");
r=load_rmf("time_lags_2007.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** 2007 Observation

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0502050101, 0502050201 Total time 80 Ks
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/PG1211+143_lagfreq_2007.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,-9.941069e+02,6.367697e+02
1.388430e-04,-1.816813e+01,2.345871e+02
2.650639e-04,-3.006760e+02,1.512547e+02
5.060310e-04,3.555881e+01,4.524210e+02
9.660592e-04,-9.102197e+01,2.042158e+02
1.844295e-03,2.520439e+02,1.077563e+02
3.520927e-03,4.952907e+01,6.263764e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("time_lags_2007.fits");
r=load_rmf("time_lags_2007.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** 2014 Observation

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0745110101, 0745110201, 0745110301, 0745110401, 0745110501
0745110601, 0745110701

Total time 564 Ks
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/PG1211+143_lagfreq_2014.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,-8.089893e+01,1.307471e+02
1.388430e-04,1.793747e+01,1.080689e+02
2.650639e-04,2.863730e+02,1.306418e+02
5.060310e-04,1.002068e+02,1.658094e+02
9.660592e-04,2.379380e+01,7.879899e+01
1.844295e-03,-2.304480e+02,7.681710e+01
3.520927e-03,1.010913e+02,6.479426e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("time_lags_2014.fits");
r=load_rmf("time_lags_2014.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** Group 1 Observation Spectra

*Lag-frequency*

Lets have a look at the lag frequency for this single observation:

Use script =lagfreq_comb_script_Grp2.sl=

Lag values:
#+BEGIN_EXAMPLE
7.272727e-05,-3.046871e+02,2.675273e+02
1.388430e-04,1.226469e+01,1.150820e+02
2.650639e-04,-9.170516e+01,1.460826e+02
5.060310e-04,2.729494e+02,1.403927e+02
9.660592e-04,-2.142484e+01,1.493062e+02
1.844295e-03,-2.143565e+02,6.202949e+01
3.520927e-03,7.201297e+01,3.394158e+01

#+END_EXAMPLE
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/PG1211+143_lagfreq_Grp1.gif

** Group 2 Observation Spectra

*Lag-frequency*

Lets have a look at the lag frequency for this single observation:

Use script =lagfreq_comb_script_Grp2.sl=

Lag values:
#+BEGIN_EXAMPLE
7.272727e-05,9.394464e+01,2.033978e+02
1.388430e-04,-5.023430e-01,1.785338e+02
2.650639e-04,2.544488e+02,2.489704e+02
5.060310e-04,-1.507170e+02,5.202020e+02
9.660592e-04,5.457952e+01,9.674524e+01
1.844295e-03,1.885015e+02,7.247426e+01
3.520927e-03,-9.611958e+01,3.944143e+01

#+END_EXAMPLE
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/PG1211+143_lagfreq_Grp2.gif

** Group 3 Observation Spectra

*Lag-frequency*

Lets have a look at the lag frequency for this single observation:

Use script =lagfreq_comb_script_Grp3.sl=

Lag values:
#+BEGIN_EXAMPLE
7.272727e-05,-1.636399e+02,1.946107e+02
1.388430e-04,-2.528549e+02,2.746455e+02
2.650639e-04,4.385093e+02,2.535215e+02
5.060310e-04,8.509955e+01,1.769382e+02
9.660592e-04,3.958794e+02,1.800450e+02
1.844295e-03,2.034316e+02,2.989379e+02
3.520927e-03,-2.362087e+00,7.675637e+01

#+END_EXAMPLE
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/PG1211+143_lagfreq_Grp3.gif

** Group 4 Observation Spectra

*Lag-frequency*

Lets have a look at the lag frequency for thesee observations:

Use script =lagfreq_comb_script_Grp3.sl=

Lag values:
#+BEGIN_EXAMPLE
7.272727e-05,-4.110411e+02,2.623522e+02
1.388430e-04,-7.144956e+01,4.390727e+02
2.650639e-04,1.324680e+02,2.384138e+02
5.060310e-04,-1.555694e+02,2.061768e+02
9.660592e-04,1.527504e+02,1.537585e+02
1.844295e-03,-1.997130e+02,4.014570e+01
3.520927e-03,9.477603e+01,3.091554e+01
#+END_EXAMPLE
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/PG1211+143_lagfreq_Grp4.gif

* *PG1244+026*

PATH to data = =/homeb/steff075/phd_ecm/PG1244+026=
** Combined

Lets just have a look at the combined flux state lag-frequencies >1e-4 Hz:

use =lagfreq_multi_script.sl=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/PG1244+026_lagfreq_comb.gif

Lags found in
=/homeb/steff075/phd_ecm/PG1244+026/time_lags_comb2.csv=

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 7.272727e-05 | 2.272727e-05 |  7.322134e+02 | 1.236881e+02 |
+--------------+--------------+---------------+--------------+
| 1.388430e-04 | 4.338843e-05 |  1.610262e+02 | 8.967010e+01 |
+--------------+--------------+---------------+--------------+
| 2.650639e-04 | 8.283246e-05 |  1.107668e+02 | 4.727631e+01 |
+--------------+--------------+---------------+--------------+
| 5.060310e-04 | 1.581347e-04 | -5.449828e+01 | 2.034478e+01 |
+--------------+--------------+---------------+--------------+
| 9.660592e-04 | 3.018935e-04 | -3.018166e+01 | 8.664790e+00 |
+--------------+--------------+---------------+--------------+
| 1.844295e-03 | 5.763421e-04 | -1.425050e+01 | 7.570500e+00 |
+--------------+--------------+---------------+--------------+
| 3.520927e-03 | 1.100290e-03 | -1.031384e+01 | 1.153618e+01 |
+--------------+--------------+---------------+--------------+

** Low - High Flux state results

Lets just have a look at the low and high flux state lag-frequencies:

use =lagfreq_multi_script.sl=

*Low flux*

Recall from the spectral fitting:
#+BEGIN_EXAMPLE
Group 1   Black      = Obs ID  0675320101  2011

Group 2   Blue       = Obs ID  0744440301  2014
          Green      = Obs ID  0744440201  2014
          Cyan       = Obs ID  0744440401  2014

Group 3   Magenta    = Obs ID  0744440101  2014
          Red        = Obs ID  0744440501  2015
#+END_EXAMPLE

Group 1 = Hi flux and Group 2 & 3 = Lo Flux:

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/PG1244+026_lagfreq_lo_flux.png

Lags found in =/homeb/steff075/phd_ecm/PG1244+026/lagvalues-lo-flux.csv=

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 7.272727e-05 | 2.272727e-05 |  8.171511e+02 | 1.382821e+02 |
+--------------+--------------+---------------+--------------+
| 1.388430e-04 | 4.338843e-05 |  1.857966e+02 | 1.173699e+02 |
+--------------+--------------+---------------+--------------+
| 2.650639e-04 | 8.283246e-05 |  1.134906e+02 | 5.176919e+01 |
+--------------+--------------+---------------+--------------+
| 5.060310e-04 | 1.581347e-04 | -4.504618e+01 | 2.297023e+01 |
+--------------+--------------+---------------+--------------+
| 9.660592e-04 | 3.018935e-04 | -3.367535e+01 | 9.821133e+00 |
+--------------+--------------+---------------+--------------+
| 1.844295e-03 | 5.763421e-04 | -7.608191e+00 | 9.745621e+00 |
+--------------+--------------+---------------+--------------+
| 3.520927e-03 | 1.100290e-03 | -5.801831e+00 | 1.295922e+01 |
+--------------+--------------+---------------+--------------+

*High flux*

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/PG1244+026_lagfreq_hi_flux.png

Lags found:
file =/homeb/steff075/phd_ecm/PG1244+026/time_lags_hi-flux2.csv=


#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 7.272727e-05 | 2.272727e-05 |  5.088417e+02 | 2.544973e+02 |
+--------------+--------------+---------------+--------------+
| 1.388430e-04 | 4.338843e-05 |  1.288907e+02 | 1.481652e+02 |
+--------------+--------------+---------------+--------------+
| 2.650639e-04 | 8.283246e-05 |  9.933353e+01 | 1.153804e+02 |
+--------------+--------------+---------------+--------------+
| 5.060310e-04 | 1.581347e-04 | -7.276787e+01 | 4.518859e+01 |
+--------------+--------------+---------------+--------------+
| 9.660592e-04 | 3.018935e-04 | -2.148567e+01 | 1.892858e+01 |
+--------------+--------------+---------------+--------------+
| 1.844295e-03 | 5.763421e-04 | -2.636787e+01 | 1.206278e+01 |
+--------------+--------------+---------------+--------------+
| 3.520927e-03 | 1.100290e-03 | -2.362944e+01 | 2.431128e+01 |
+--------------+--------------+---------------+--------------+

Lets combine these results in Veusz

Use =homeb/steff075/phd_ecm/PG1244+026/lag-results.ods= to obtain
the csv

Plot =homeb/steff075/phd_ecm/PG1244+026/PG1244+026-lag-results-lo-hi.vsz=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/PG1244+026-lag-results-lo-hi-flux.png

pdf at:


http://www.star.bris.ac.uk/steff/ecm/PG1244+026-lag-results-lo-hi-flux.pdf


*Genegenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28
accordingly. Run fits files to check:

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
%d=load_data("PG1244+026-time-lags-combined.fits");
%r=load_rmf("PG1244+026-time-lags-combined.rsp");
%d=load_data("PG1244+026-time-lags-lo-flux.fits");
%r=load_rmf("PG1244+026-time-lags-lo-flux.rsp");
d=load_data("PG1244+026-time-lags-hi-flux.fits");
r=load_rmf("PG1244+026-time-lags-hi-flux.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

Now copy these the BC4 for fitting to ECM model, e.g:

#+BEGIN_EXAMPLE
scp PG1244+026-time-lags-hi-flux.fits so14935@bc4login.acrc.bris.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/PG1244+026-time-lag-fits
#+END_EXAMPLE

** Investigate spectral groupings

Lets plot the unfolded spectra for all data sets to identify them

http://www.star.bris.ac.uk/steff/ecm/PG1244+026_Spectra_all_unfolded.gif


*Key:* (from top to bottom)
#+BEGIN_EXAMPLE

Black      = Obs ID  0675320101  2011
Blue       = Obs ID  0744440301  2014
Green      = Obs ID  0744440201  2014
Cyan       = Obs ID  0744440401  2014
Magenta    = Obs ID  0744440101  2014
Red        = Obs ID  0744440501  2015

#+END_EXAMPLE

*Establish Groups*

Spectral groups emerging, so lets continue to plotting combined spectra
with the following 3 groups:
#+BEGIN_EXAMPLE

Group 1   Black      = Obs ID  0675320101  2011

Group 2   Blue       = Obs ID  0744440301  2014
          Green      = Obs ID  0744440201  2014
          Cyan       = Obs ID  0744440401  2014

Group 3   Magenta    = Obs ID  0744440101  2014
          Red        = Obs ID  0744440501  2015

#+END_EXAMPLE

** OBS 0675320101 (2011)

Use script =/homeb/steff075/phd_ecm/PG1244+026/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,5.088417e+02,2.544973e+02
1.388430e-04,1.288907e+02,1.481652e+02
2.650639e-04,9.933353e+01,1.153804e+02
5.060310e-04,-7.276787e+01,4.518859e+01
9.660592e-04,-2.148567e+01,1.892858e+01
1.844295e-03,-2.636787e+01,1.206278e+01
3.520927e-03,-2.362944e+01,2.431128e+01
#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/PG1244+026_0675320101_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0744440101 (2014)

Use script =/homeb/steff075/phd_ecm/PG1244+026/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,1.277353e+03,2.357344e+02
1.388430e-04,1.171889e+02,2.258475e+02
2.650639e-04,6.133466e+01,1.329758e+02
5.060310e-04,-1.364472e+01,6.310306e+01
9.660592e-04,-5.205139e+01,2.178951e+01
1.844295e-03,-1.693238e+01,4.126466e+01
3.520927e-03,-2.906963e+01,2.352323e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/PG1244+026_0744440101_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0744440201 (2014)

Use script =/homeb/steff075/phd_ecm/PG1244+026/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,6.836369e+02,2.347243e+02
1.388430e-04,5.351884e+01,2.774152e+02
2.650639e-04,1.459525e+02,9.557039e+01
5.060310e-04,2.442737e+01,5.353235e+01
9.660592e-04,-3.678074e+01,2.060118e+01
1.844295e-03,3.134187e+01,1.731064e+01
3.520927e-03,8.817150e+00,1.742891e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/PG1244+026_0744440201_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0744440301 (2014)

Use script =/homeb/steff075/phd_ecm/PG1244+026/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,1.007718e+03,3.946163e+02
1.388430e-04,3.200106e+02,2.527682e+02
2.650639e-04,7.778058e+01,9.019659e+01
5.060310e-04,-4.405456e+01,4.240424e+01
9.660592e-04,-2.830834e+01,2.118435e+01
1.844295e-03,-4.303303e+01,1.838100e+01
3.520927e-03,4.589115e+00,2.105077e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/PG1244+026_0744440301_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0744440401 (2014)

Use script =/homeb/steff075/phd_ecm/PG1244+026/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,6.196070e+02,2.067572e+02
1.388430e-04,2.056740e+02,1.675621e+02
2.650639e-04,8.477463e+01,1.692389e+02
5.060310e-04,-1.389062e+02,5.352318e+01
9.660592e-04,-9.470843e+00,1.910534e+01
1.844295e-03,1.035439e+01,2.098033e+01
3.520927e-03,-5.024990e+00,2.488297e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/PG1244+026_0744440401_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0744440501 (2015)

Use script =/homeb/steff075/phd_ecm/PG1244+026/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,4.492156e+02,2.638322e+02
1.388430e-04,2.376369e+02,7.010888e+02
2.650639e-04,2.603004e+02,1.030661e+02
5.060310e-04,-3.299456e+01,4.296978e+01
9.660592e-04,-5.773681e+01,2.886651e+01
1.844295e-03,-2.051547e+01,1.808510e+01
3.520927e-03,-1.162755e+02,5.208223e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/PG1244+026_0744440501_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** Combined Observations

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0675320101, 0744440101, 0744440201, 0744440301,
0744440401, 0744440501

Total time  689 ks

script =lagfreq_comb_script.sl=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/PG1244+026_lagfreq_comb.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,7.322134e+02,1.236881e+02
1.388430e-04,1.610262e+02,8.967010e+01
2.650639e-04,1.107668e+02,4.727631e+01
5.060310e-04,-5.449828e+01,2.034478e+01
9.660592e-04,-3.018166e+01,8.664790e+00
1.844295e-03,-1.425050e+01,7.570500e+00
3.520927e-03,-1.031384e+01,1.153618e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("time_lags_comb.fits");
r=load_rmf("time_lags_comb.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** 2011 Observation

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0675320101  Total time 123 Ks
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/PG1244+026_lagfreq_2011.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,5.088417e+02,2.544973e+02
1.388430e-04,1.288907e+02,1.481652e+02
2.650639e-04,9.933353e+01,1.153804e+02
5.060310e-04,-7.276787e+01,4.518859e+01
9.660592e-04,-2.148567e+01,1.892858e+01
1.844295e-03,-2.636787e+01,1.206278e+01
3.520927e-03,-2.362944e+01,2.431128e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("time_lags_2011.fits");
r=load_rmf("time_lags_2011.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** 2014 Observation

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0744440101, 0744440201, 0744440301, 0744440401 Total time 448 Ks
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/PG1244+026_lagfreq_2014.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,8.665576e+02,1.571321e+02
1.388430e-04,1.835082e+02,1.190536e+02
2.650639e-04,9.218286e+01,5.850667e+01
5.060310e-04,-4.789477e+01,2.655934e+01
9.660592e-04,-2.985133e+01,1.037540e+01
1.844295e-03,-4.028456e+00,1.136688e+01
3.520927e-03,-2.631995e+00,1.118003e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("time_lags_2014.fits");
r=load_rmf("time_lags_2014.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** 2015 Observation

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0744440501 Total time 118 Ks
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/PG1244+026_lagfreq_2015.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,4.492156e+02,2.638322e+02
1.388430e-04,2.376369e+02,7.010888e+02
2.650639e-04,2.603004e+02,1.030661e+02
5.060310e-04,-3.299456e+01,4.296978e+01
9.660592e-04,-5.773681e+01,2.886651e+01
1.844295e-03,-2.051547e+01,1.808510e+01
3.520927e-03,-1.162755e+02,5.208223e+01
#+END_EXAMPLE

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("time_lags_2015.fits");
r=load_rmf("time_lags_2015.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** Group 1 Observation Spectra

See 2011 Observation (below)

** Group 2 Observation Spectra

#+BEGIN_EXAMPLE
Group 2   Blue       = Obs ID  0744440301  2014
          Green      = Obs ID  0744440201  2014
          Cyan       = Obs ID  0744440401  2014
#+END_EXAMPLE

*Lag-frequency*

Lets have a look at the lag frequency for this single observation:

Use script =lagfreq_comb_Grp2.sl=

Lag values:
#+BEGIN_EXAMPLE
7.272727e-05,7.604844e+02,1.830191e+02
1.388430e-04,2.015088e+02,1.341770e+02
2.650639e-04,9.929342e+01,6.525125e+01
5.060310e-04,-5.590231e+01,2.916778e+01
9.660592e-04,-2.473081e+01,1.177637e+01
1.844295e-03,-2.410899e+00,1.171355e+01
3.520927e-03,3.356746e+00,1.216251e+01

#+END_EXAMPLE
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/PG1244+026_lagfreq_Grp2.gif

** Group 3 Observation Spectra

#+BEGIN_EXAMPLE
Group 3   Magenta    = Obs ID  0744440101  2014
          Red        = Obs ID  0744440501  2015
#+END_EXAMPLE

*Lag-frequency*

Lets have a look at the lag frequency for this single observation:

Use script =lagfreq_comb_script_Grp3.sl=

Lag values:
#+BEGIN_EXAMPLE
7.272727e-05,9.514835e+02,2.035598e+02
1.388430e-04,1.378008e+02,2.302036e+02
2.650639e-04,1.484975e+02,8.624066e+01
5.060310e-04,-2.437330e+01,3.698701e+01
9.660592e-04,-5.465897e+01,1.780833e+01
1.844295e-03,-1.948802e+01,1.756015e+01
3.520927e-03,-5.115083e+01,3.400309e+01

#+END_EXAMPLE

http://www.star.bris.ac.uk/steff/ecm/PG1244+026_lagfreq_Grp3.gif

* *PG1247+267*

PATH to data = =/homeb/steff075/phd_ecm/PG1247+267=

** Investigate spectra

Lets plot the unfolded spectra for this single observation

http://www.star.bris.ac.uk/steff/ecm/PG1247+267_Spectra_all_unfolded.gif

** 2003 Observations

First replot the fully combined lag-frequency for observations
(without running the absolute values for the real sum CPS):

0143150201 Total time 32 ks

script =lagfreq_comb_script.sl=

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/PG1247+267_lagfreq_comb.gif

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped

|         Freq |           +- |           Lag |           +- |
| 1.163636e-04 | 3.636364e-05 | -4.985564e+02 | 5.131989e+02 |
| 2.221488e-04 | 6.942149e-05 |  2.910498e+02 | 2.199942e+02 |
| 4.241022e-04 | 1.325319e-04 |  1.344287e+02 | 1.907308e+02 |
| 8.096496e-04 | 2.530155e-04 |  5.587049e+01 | 6.099757e+01 |
| 1.545695e-03 | 4.830296e-04 |  7.389891e+00 | 3.319726e+01 |
| 2.950872e-03 | 9.221474e-04 |  2.681682e+00 | 8.010840e+00 |
| 5.633482e-03 | 1.760463e-03 |  4.069876e+00 | 3.247819e+00 |


Make plot in Veusz

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/PG1247+267-lag-results-lo-hi-flux.png


pdf at

http://www.star.bris.ac.uk/steff/ecm/PG1247+267-lag-results-lo-hi-flux.pdf


*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("time_lags_2003.fits");
r=load_rmf("time_lags_2003.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

* *REJ1034+396*

PATH to data = =/homeb/steff075/phd_ecm/REJ1034+396=
** Combined

Lets just have a look at the combined flux state lag-frequencies >5e-5 Hz:

use =lagfreq_multi_script.sl=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/REJ1034+396_lagfreq_comb.PNG

Lags found in
=/homeb/steff075/phd_ecm/REJ1034+396/time_lags_comb2.csv=

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 7.272727e-05 | 2.272727e-05 |  4.649999e+02 | 2.794939e+02 |
+--------------+--------------+---------------+--------------+
| 1.388430e-04 | 4.338843e-05 |  5.030273e+02 | 2.035387e+02 |
+--------------+--------------+---------------+--------------+
| 2.650639e-04 | 8.283246e-05 | -5.548806e+01 | 6.851144e+01 |
+--------------+--------------+---------------+--------------+
| 5.060310e-04 | 1.581347e-04 |  3.026992e+01 | 4.817452e+01 |
+--------------+--------------+---------------+--------------+
| 9.660592e-04 | 3.018935e-04 |  1.098599e+01 | 1.615545e+01 |
+--------------+--------------+---------------+--------------+
| 1.844295e-03 | 5.763421e-04 |  1.993774e+00 | 7.106645e+00 |
+--------------+--------------+---------------+--------------+
| 3.520927e-03 | 1.100290e-03 | -2.505268e+00 | 2.556232e+00 |
+--------------+--------------+---------------+--------------+

** Low - High Flux state results

Lets just have a look at the low and high flux state lag-frequencies:

use =lagfreq_multi_script.sl=

*Low flux*

Recall from the spectral fitting:
#+BEGIN_EXAMPLE
Group 1  Red        = Obs ID  0561580201  2009

Group 2  Green      = Obs ID  0655310101  2010
         Black      = Obs ID  0506440101  2007
         Blue       = Obs ID  0655310201  2010
#+END_EXAMPLE

Group 1 = Hi flux and Group 2 & 3 = Lo Flux

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/REJ1034+396_lagfreq_lo_flux.PNG

Lags found in =/homeb/steff075/phd_ecm/REJ1034+396/time_lags_lo_flux2.csv=

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 7.272727e-05 | 2.272727e-05 |  3.950809e+02 | 3.252585e+02 |
+--------------+--------------+---------------+--------------+
| 1.388430e-04 | 4.338843e-05 |  4.320778e+02 | 2.304918e+02 |
+--------------+--------------+---------------+--------------+
| 2.650639e-04 | 8.283246e-05 | -7.285682e+01 | 7.201528e+01 |
+--------------+--------------+---------------+--------------+
| 5.060310e-04 | 1.581347e-04 |  2.735708e+01 | 5.317999e+01 |
+--------------+--------------+---------------+--------------+
| 9.660592e-04 | 3.018935e-04 |  1.205750e+01 | 1.714892e+01 |
+--------------+--------------+---------------+--------------+
| 1.844295e-03 | 5.763421e-04 | -2.407227e+00 | 8.198492e+00 |
+--------------+--------------+---------------+--------------+
| 3.520927e-03 | 1.100290e-03 | -2.344232e+00 | 2.897392e+00 |
+--------------+--------------+---------------+--------------+


*High flux*


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/REJ1034+396_lagfreq_hi_flux.PNG

Lags found:
file =/homeb/steff075/phd_ecm/REJ1034+396/time_lags_hi-flux2.csv=


#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 7.272727e-05 | 2.272727e-05 |  1.330922e+03 | 3.778051e+02 |
+--------------+--------------+---------------+--------------+
| 1.388430e-04 | 4.338843e-05 |  9.824848e+02 | 3.300633e+02 |
+--------------+--------------+---------------+--------------+
| 2.650639e-04 | 8.283246e-05 |  2.291498e+02 | 2.192435e+02 |
+--------------+--------------+---------------+--------------+
| 5.060310e-04 | 1.581347e-04 |  4.595019e+01 | 9.074549e+01 |
+--------------+--------------+---------------+--------------+
| 9.660592e-04 | 3.018935e-04 |  7.674153e+00 | 3.469433e+01 |
+--------------+--------------+---------------+--------------+
| 1.844295e-03 | 5.763421e-04 |  1.455244e+01 | 1.317777e+01 |
+--------------+--------------+---------------+--------------+
| 3.520927e-03 | 1.100290e-03 | -2.937061e+00 | 5.042754e+00 |
+--------------+--------------+---------------+--------------+

Lets combine these results in Veusz

Use =homeb/steff075/phd_ecm/REJ1034+396/lag-results.ods= to obtain
the csv

Plot =homeb/steff075/phd_ecm/REJ1034+396/REJ1034+396-lag-results-lo-hi.vsz=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/REJ1034+396-lag-results-lo-hi-flux.png

pdf at:
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/REJ1034+396-lag-results-lo-hi-flux.pdf


Genegenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28
accordingly. Run fits files to check:

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
%d=load_data("REJ1034+396-time-lags-combined.fits");
%r=load_rmf("REJ1034+396-time-lags-combined.rsp");
%d=load_data("REJ1034+396-time-lags-lo-flux.fits");
%r=load_rmf("REJ1034+396-time-lags-lo-flux.rsp");
d=load_data("REJ1034+396-time-lags-hi-flux.fits");
r=load_rmf("REJ1034+396-time-lags-hi-flux.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

Now copy these the BC4 for fitting to ECM model, e.g:

#+BEGIN_EXAMPLE
scp REJ1034+396-time-lags-hi-flux.fits so14935@bc4login.acrc.bris.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/REJ1034+396-time-lag-fits
#+END_EXAMPLE

** Investigate spectral groupings

Lets plot the unfolded spectra for all data sets to identify them

Nte that Obs ID 0506440101  had 21 arcsec of pileup core rmoved

http://www.star.bris.ac.uk/steff/ecm/REJ1034+396_Spectra_all_unfolded.gif

*Key:* (from top to bottom)
#+BEGIN_EXAMPLE

Red        = Obs ID  0561580201  2009
Green      = Obs ID  0655310101  2010
Black      = Obs ID  0506440101  2007
Blue       = Obs ID  0655310201  2010

#+END_EXAMPLE

*Establish Groups*

Spectral groups emerging, so lets continue to plotting combined spectra
with the following 3 groups:
#+BEGIN_EXAMPLE

Group 1  Red        = Obs ID  0561580201  2009

Group 2  Green      = Obs ID  0655310101  2010
         Black      = Obs ID  0506440101  2007
         Blue       = Obs ID  0655310201  2010

#+END_EXAMPLE

** OBS 0506440101 (2007)

Use script =/homeb/steff075/phd_ecm/REJ1034+396/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,5.467059e+02,4.048606e+02
1.388430e-04,4.856062e+02,5.877614e+02
2.650639e-04,-7.971449e+01,1.005855e+02
5.060310e-04,-5.500491e+01,1.375245e+02
9.660592e-04,-3.383356e+01,3.123782e+01
1.844295e-03,-3.165860e+01,3.389178e+01
3.520927e-03,-2.412704e+01,1.954607e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/REJ1034+396_0506440101_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0561580201 (2009)

Use script =/homeb/steff075/phd_ecm/REJ1034+396/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.163636e-04,2.810431e+03,8.414463e+02
2.221488e-04,4.775468e+02,5.364296e+02
4.241022e-04,1.262350e+02,1.051725e+02
8.096496e-04,1.101392e+01,8.223760e+01
1.545695e-03,-3.595325e+00,1.008090e+02
2.950872e-03,-4.253563e+00,5.460782e+01
5.633482e-03,2.486379e+01,3.584093e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/REJ1034+396_0561580201_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0655310101 (2010)

Use script =/homeb/steff075/phd_ecm/REJ1034+396/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.454545e-04,1.144901e+03,6.206094e+02
2.776860e-04,1.749319e+01,3.116722e+02
5.301277e-04,7.195589e+01,8.179992e+01
1.012062e-03,7.456478e+01,1.260534e+02
1.932118e-03,1.761826e+02,2.415795e+01
3.688590e-03,-4.271912e+00,1.635448e+01
7.041853e-03,4.321318e+01,1.871064e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/REJ1034+396_0655310101_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** OBS 0655310201 (2010)

Use script =/homeb/steff075/phd_ecm/REJ1034+396/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.163636e-04,-7.300146e+00,3.236087e+02
2.221488e-04,-3.632781e+01,2.712454e+02
4.241022e-04,5.628195e+01,1.993224e+02
8.096496e-04,-1.443948e+01,4.277238e+01
1.545695e-03,9.033693e+01,1.486808e+02
2.950872e-03,-2.740640e+01,1.929502e+01
5.633482e-03,1.780299e+01,1.567981e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/REJ1034+396_0655310201_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("_time_lags.fits");
r=load_rmf(" _time_lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** Combined Observations

First replot the fully combined lag-frequency  for observations
(without running the absolute values for the real sum CPS):

0506440101,0561580201,0655310101,0655310201

Total time   ks

script =lagfreq_comb_script.sl=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/REJ1034+396_lagfreq_comb.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,5.430714e+02,4.384086e+02
1.388430e-04,6.385397e+02,2.908303e+02
2.650639e-04,-6.244358e+01,8.565221e+01
5.060310e-04,3.864332e+01,6.511584e+01
9.660592e-04,1.753913e+01,2.878363e+01
1.844295e-03,1.169586e+01,4.733164e+01
3.520927e-03,-8.898901e+00,1.033952e+01

#+END_EXAMPLE

These were printed to =time_lags_comb.csv=

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("time_lags_comb.fits");
r=load_rmf("time_lags_comb.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** 2009 Observation

First replot the fully combined lag-frequency for observations
(without running the absolute values for the real sum CPS):

0561580201 Total time 54 ks

script =lagfreq_comb_script.sl=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/REJ1034+396_lagfreq_2009.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,3.760625e+03,1.595900e+03
1.388430e-04,1.738350e+03,5.991463e+02
2.650639e-04,2.568588e+02,2.551311e+02
5.060310e-04,7.257194e+01,1.583837e+02
9.660592e-04,1.496156e+01,7.642107e+01
1.844295e-03,7.206807e+01,6.876670e+01
3.520927e-03,-1.096800e+01,2.167550e+01
#+END_EXAMPLE

These were printed to =time_lags_2009.csv=

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("time_lags_2009.fits");
r=load_rmf("time_lags_2009.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** 2010 Observation

First replot the fully combined lag-frequency for observations
(without running the absolute values for the real sum CPS):

0655310101 and 0655310201 Total time 95 ks

script =lagfreq_comb_script.sl=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/REJ1034+396_lagfreq_2010.gif

Lag Values
#+BEGIN_EXAMPLE
7.272727e-05,3.146861e+02,7.779597e+02
1.388430e-04,5.187747e+02,3.741135e+02
2.650639e-04,-8.842485e+01,1.958298e+02
5.060310e-04,7.192074e+01,7.658465e+01
9.660592e-04,6.238470e+01,4.526470e+01
1.844295e-03,7.016971e+01,2.044255e+02
3.520927e-03,-1.233369e+00,1.411099e+01

#+END_EXAMPLE

These were printed to =time_lags_2010.csv=

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("time_lags_2010.fits");
r=load_rmf("time_lags_2010.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

** Group 1 Observation Spectra

See 2009 Observation (below)

** Group 2 Observation Spectra

#+BEGIN_EXAMPLE
Group 2  Green      = Obs ID  0655310101  2010
         Black      = Obs ID  0506440101  2007
         Blue       = Obs ID  0655310201  2010
#+END_EXAMPLE

*Lag-frequency*

Lets have a look at the lag frequency for this single observation:

Use script =lagfreq_comb_script_Grp2.sl=

Lag values:
#+BEGIN_EXAMPLE
7.272727e-05,4.311413e+02,4.339652e+02
1.388430e-04,5.132565e+02,3.020293e+02
2.650639e-04,-8.191330e+01,9.141594e+01
5.060310e-04,3.371156e+01,6.918346e+01
9.660592e-04,1.818418e+01,2.905726e+01
1.844295e-03,-1.379467e+01,5.313909e+01
3.520927e-03,-8.175737e+00,1.153062e+01
#+END_EXAMPLE

These were printed to =time_lags_Grp2.csv=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/REJ1034+396_lagfreq_Grp2.gif

* Final Reults

| *Source* | *Grp*    | *Flux03-10 keV* | *Lag* |  *+-* |   *Freq* |
| 1H0707   | Combined |        2.92e-12 |  26.6 |   2.9 |  1.61e-3 |
|          | hi       |        3.45e-14 |  26.6 |   3.1 |  1.61e-3 |
|          | hicts    |        2.80e-12 |  32.5 |   3.9 |  1.61e-3 |
|          | Med      |        3.28e-14 |  35.7 |   9.6 |  1.61e-3 |
|          | lo       |        4.07e-13 |  28.7 |  10.5 |  1.61e-3 |
|          | locts    |        2.84e-12 |  23.5 |  11.7 |  5.86e-4 |
| Ark564   | Combined |        4.23e-11 |  36.2 |  10.5 |  6.07e-4 |
|          | hi       |        1.47e-10 |  61.1 |  19.3 |  6.07e-4 |
|          | lo       |        2.53e-11 |  15.6 |   5.6 |  2.21e-3 |
| IRAS     | Combined |        1.81e-12 |  49.7 |  10.5 |  4.36e-4 |
|          | hi       |        3.46e-12 |  67.3 |  26.0 |  4.36e-4 |
|          | hicts    |        1.81e-12 |  50.8 |  15.9 |  4.36e-4 |
|          | med      |        1.41e-12 |  35.1 |  12.2 |  4.36e-4 |
|          | lo       |        5.18e-13 |  76.4 |  34.2 |  4.36e-4 |
|          | locts    |        1.44e-12 |  41.7 |  14.4 |  4.36e-4 |
| MCG63015 | Combined |        5.67e-11 |  15.9 |   5.9 |  9.66e-4 |
|          | hi       |        6.44e-11 |  15.2 |  16.1 |  9.66e-4 |
|          | lo       |        4.36e-11 |  16.1 |   7.1 |  9.66e-4 |
| Mrk335   | Combined |        1.61e-11 | 132.7 |  36.4 |  2.65e-4 |
|          | hi       |        3.03e-11 | 141.4 |  56.3 |  2.65e-4 |
|          | lo       |        6.50e-12 |  24.0 |  47.2 |  5.06e-4 |
| Mrk766   | Combined |        2.33e-11 |  23.9 |   6.7 |  9.66e-4 |
|          | hi       |        4.03e-11 |  35.2 |  13.8 |  9.66e-4 |
|          | med      |        2.16e-11 |  10.2 |   8.4 |  9.66e-4 |
|          | lo       |        9.32e-12 | 157.6 |  98.2 |  2.65e-4 |
| Mrk841   | Combined |        1.72e-11 | 127.7 |  86.5 |  4.24e-4 |
|          | hi       |        2.53e-11 | 123.8 |  95.1 |  5.30e-4 |
|          | lo       |        1.41e-11 | 139.8 | 110.8 |  4.24e-4 |
| NGC1365  | Combined |        9.57e-12 |  39.3 |  39.7 |  2.65e-4 |
|          | hi       |        2.48e-11 |  18.5 |  51.4 |  2.65e-4 |
|          | lo       |        6.54e-12 | 156.7 |  95.1 |  2.65e-4 |
| NGC3516  | Combined |        4.20e-10 |  10.1 |  12.7 |  9.66e-4 |
|          | hi       |        5.60e-11 |  36.4 |  21.6 |  9.66e-4 |
|          | lo       |        2.25e-11 | 143.7 |  79.6 |  2.65e-4 |
| NGC4051  | Combined |        2.30e-11 |  17.2 |   7.1 |  9.66e-4 |
|          | hi       |        3.19e-11 |  17.2 |  10.0 |  5.06e-4 |
|          | lo       |        1.51e-11 |  19.8 |   6.7 |  9.66e-4 |
| NGC4151  | Combined |        9.47e-11 |   8.6 |  17.7 |  9.66e-4 |
|          | hi       |        2.38e-10 |  24.1 |  32.2 |  9.66e-4 |
|          | lo       |        6.02e-12 |  41.9 | 142.2 |  2.65e-4 |
| NGC4395  | Combined |        5.88e-12 |  23.9 |  16.2 |  5.06e-4 |
|          | hi       |        6.16e-12 |  22.4 |  17.4 |  5.06e-4 |
|          | lo       |        6.27e-12 | 109.6 |  50.3 |  5.06e-4 |
| NGC5548  | Combined |        3.48e-11 | 156.7 |  55.9 |  2.65e-4 |
|          | hi       |        5.44e-11 |  18.4 |  67.2 |  5.06e-4 |
|          | lo       |        3.07e-11 |   1.7 |  12.1 |  9.66e-4 |
| NGC6860  | 2009     |        2.90e-11 |  13.1 |  35.0 |  9.11e-4 |
| NGC7314  | Combined |        2.74e-11 |  82.1 |  83.1 |  2.65e-4 |
|          | hi       |        4.90e-11 | 104.5 | 101.7 |  2.65e-4 |
|          | lo       |        4.90e-11 |  18.4 |  29.5 | .9.66e-4 |
| NGC7469  | Combined |        4.42e-11 |  40.3 |  46.5 |  4.24e-4 |
|          | hi       |        4.46e-11 | 404.0 | 170.9 |  2.65e-4 |
|          | lo       |        4.37e-11 |  55.1 |  26.8 |  8.09e-4 |
| PG1211   | Combined |        5.89e-12 |   5.7 |   4.8 |  1.55e-4 |
|          | hi       |        6.37e-12 |   6.6 |   6.0 |  4.24e-4 |
|          | lo       |        4.90e-12 |  67.5 |  4.24 |  4.24e-4 |
| PG1244   | Combined |        6.02e-12 |  54.5 |  20.3 |  5.06e-4 |
|          | hi       |        7.44e-12 |  72.8 |  45.2 |  5.06e-4 |
|          | lo       |        5.71e-12 |  45.0 |  23.0 |  5.06e-4 |
| PG1247   | 2003     |        7.55e-13 |  98.5 | 134.1 |  2.65e-4 |
| REJ1034  | Combined |        2.53e-12 |  55.5 |  68.5 |  2.65e-4 |
|          | hi       |        2.29e-12 |   3.0 |   5.0 |  3.52e-3 |
|          | lo       |        2.57e-12 |  72.9 |  72.0 |  2.65e-4 |

* Common commands (for speed)

#+BEGIN_EXAMPLE

anaconda-navigator &

ssh steff075@lyra -XY

ssh steff075@mensa -XY

ssh steff075@hercules -XY

source("confidence_.sl");

save_par("relxill_");

eval_counts;
list_par;

>>>>>>> cp phd_ecm_logbook.html /homeb/WWW/steff

cp linux_notes.html /home/WWW/steff

cp timing_analysis.html /home/WWW/steff

cp agn_spectral_modelling.html /home/WWW/steff

cp ecm_model.html /home/WWW/steff


cp linux_notes.html /home/WWW/steff

/homeb/WWW/steff/ecm/

cd /mnt/storage/scratch/so14935/2-blob-output


<<<  copy from windows to Lyra machine using PuTTY >>>>>>>

pscp.exe <filename> steff075@137.222.58.204:/homeb/steff075/phd_ecm/1h0707/extended-corona

#+END_EXAMPLE

* Scripts
** chsrc

#+BEGIN_EXAMPLE


#+END_EXAMPLE

** Plot spectra and unfold

PATH =/homeb/steff075/phd_ecm/1h0707/all_spectra.sl= and =multi_spectra_unfold.sl=

#+BEGIN_EXAMPLE
% Load the required spectra
load_data("/data/scratch3/steff/1H0707-495/0110890201/PROC/PN_time_0.3-10_pi_grp.fits");
load_data("/data/scratch3/steff/1H0707-495/0148010301/PROC/PN_time_0.3-10_pi_grp.fits");
load_data("/data/scratch3/steff/1H0707-495/0506200201/PROC/PN_time_0.3-10_pi_grp.fits");
load_data("/data/scratch3/steff/1H0707-495/0506200301/PROC/PN_time_0.3-10_pi_grp.fits");
load_data("/data/scratch3/steff/1H0707-495/0506200401/PROC/PN_time_0.3-10_pi_grp.fits");
load_data("/data/scratch3/steff/1H0707-495/0506200501/PROC/PN_time_0.3-10_pi_grp.fits");
load_data("/data/scratch3/steff/1H0707-495/0511580101/PROC/PN_time_0.3-10_pi_grp.fits");
load_data("/data/scratch3/steff/1H0707-495/0511580201/PROC/PN_time_0.3-10_pi_grp.fits");
load_data("/data/scratch3/steff/1H0707-495/0511580301/PROC/PN_time_0.3-10_pi_grp.fits");
load_data("/data/scratch3/steff/1H0707-495/0511580401/PROC/PN_time_0.3-10_pi_grp.fits");
load_data("/data/scratch3/steff/1H0707-495/0554710801/PROC/PN_time_0.3-10_pi_grp.fits");
load_data("/data/scratch3/steff/1H0707-495/0653510301/PROC/PN_time_0.3-10_pi_grp.fits");
load_data("/data/scratch3/steff/1H0707-495/0653510401/PROC/PN_time_0.3-10_pi_grp.fits");
load_data("/data/scratch3/steff/1H0707-495/0653510501/PROC/PN_time_0.3-10_pi_grp.fits");
load_data("/data/scratch3/steff/1H0707-495/0653510601/PROC/PN_time_0.3-10_pi_grp.fits");

% Rebin as required
rebin_data(1, 40);
rebin_data(2, 80);
rebin_data(3, 80);
rebin_data(4, 80);
rebin_data(5, 80);
rebin_data(6, 80);
rebin_data(7, 80);
rebin_data(8, 80);
rebin_data(9, 80);
rebin_data(10, 80);
rebin_data(11, 80);
rebin_data(12, 80);
rebin_data(13, 80);
rebin_data(14, 80);
rebin_data(15, 80);

%set required energy ranges
xnotice_en(all_data(),0.3, 10.0);
ignore_en(all_data(),0,0.3);
ignore_en(all_data(),10,20);

% Fit a model
%fancy_plot_unit=(“keV”);
%fit_fun("wabs*(powerlaw+laor(1)+laor(2)+diskbb)");

% Plot all spectra
open_plot("1H0707-495_Spectra_all.gif/gif");
title ("1H0707-495 Folded Spectra 2000-2011");
%set_par(1,0.000119498);
%set_par(2,0.004,0);
%set_par(3,2.2,0);
%set_par(4,2.5e-05);
%set_par(5,6.37);
%thaw(6,9);
%set_par(9,35,0);
%set_par(11,0.09,0);
%thaw(12);
%set_par(16,1077,1);
%set_par(17,0.13,1);
%tie(9,15);
% Set Plotting functions and styles
popt.xrange = [0.3, 10.0];
popt.yrange = [1.0e-5, 10, -10.0, 10.0];
%popt.res = 1;
xlog;
ylog;
%group(2; min_sn=2.0);
popt.dcol=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15];
popt.decol=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15];
popt.dsym=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1];

%()=eval_counts;
%()=fit_counts;
%plot_comps(1, popt,&plot_data);
plot_data({1,2,3,4,5,6,7,8,9,10,11,12,13,14,15}, popt);
%list_par;
close_plot;

% Plot all Unfolded spectra
open_plot("1H0707-495_Spectra_all_unfolded.gif/gif");
title ("1H0707-495 Unfolded Spectra 2000-2011");
plot_unfold({1,2,3,4,5,6,7,8,9,10,11,12,13,14,15};power=3, dsym=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],dcol=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,14],yrange = [1.0e-5, 5e-03]);
close_plot;

% Create ps image of plot
variable pid = open_plot("1H0707-495_Unfolded_Spectra_all.ps/cps");
plot_unfold({1,2,3,4,5,6,7,8,9,10,11,12,13,14,15};power=3, dsym=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],dcol=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,14],yrange = [1.0e-5, 5e-03]);
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
close_plot(pid);

#+END_EXAMPLE

** Confidence

#+BEGIN_EXAMPLE
% This should find the confidence intervals of a list of parameters.
% If a new best fit is found it will re-fit that parameter repeatedly until a confidence
% interval is measured. If any parameters need to be refit, the entire list is
% recomputed until all parameters are at their best-fit values.

% List of paramers to run on.
variable p = [1,2,3,4,5,6,7,8,11,15,16,17,19];

variable all_good, good, i, lo, hi;

do {
	vmessage("\n\n--Starting to determine confidence intervals--\n");
	all_good = 1;
	for (i=0; i<length(p); i++) {
		do {
			good = 1;
			(lo, hi) = conf(p[i]);
			vmessage("  ... parameter %i = %e (%e - %e)", p[i], get_par(p[i]), lo, hi);
			if (lo == hi) {
				% this means that a better fit was found
				vmessage("Found a better fit!");
				() = fit_counts;
				good = 0;
				all_good = 0;
			}
		} while (good == 0);
		vmessage("Parameter %i = %e (%e - %e)", p[i], get_par(p[i]), lo, hi);
	}
} while (all_good == 0);

eval_counts;
list_par;

#+END_EXAMPLE


To print outputs to csv file use:

#+BEGIN_EXAMPLE
% List of paramers to run on.
variable p = [1,2,3,4,5,6,7,8,11,15,16,17,19];

variable all_good, good, i, lo, hi;

do {
	vmessage("\n\n--Starting to determine confidence intervals--\n");
	all_good = 1;
	fp = fopen("Conf_2009.csv","w");% Create the file
	for (i=0; i<length(p); i++) {
		do {
			good = 1;
			(lo, hi) = conf(p[i]);
			vmessage("  ... parameter %i = %e (%e - %e)", p[i], get_par(p[i]), lo, hi);
			() = fprintf(fp, "%s,%e,+%e,-%e\n", get_par_info(p[i]).name, get_par(p[i]), hi-get_par(p[i]), get_par(p[i])-lo);
			if (lo == hi) {
				% this means that a better fit was found
				vmessage("Found a better fit!");
				() = fit_counts;
				good = 0;
				all_good = 0;
			}
		} while (good == 0);
		vmessage("Parameter %i = %e (%e - %e)", p[i], get_par(p[i]), lo, hi);
	}
	() = fclose(fp);
} while (all_good == 0);

#+END_EXAMPLE

** Pandas AGN Parameter files for clear results

#+BEGIN_EXAMPLE
import pandas as pd

df = pd.read_csv('/homeb/steff075/phd_ecm/NGC6860/Conf_2009.csv', names=['Parameter', 'Value','Plus','Minus'])

#suppress displaying long numbers in scientific notation
pd.set_option('display.float_format', lambda x: '%.2f' % x)
df

#+END_EXAMPLE

** Lag-frequency script

PATH =/data/scratch3/steff/phd_ecm/1h0707/lagfreq_comb_script.sl=
all_spectra.sl
#+BEGIN_EXAMPLE
%#include<stdio.h>

%declare observation ID's
variable obs_id = ["0110890201","0148010301","0506200201","0506200301","0506200401","0506200501","0511580101","0511580201","0511580301","0511580401","0554710801","0653510301","0653510401","0653510501","0653510601"];

variable i;
variable j;
variable k;



%declare frequency bins
variable n_bins = 7;
variable df_f = 1.0/1.1;
variable lo = Double_Type[n_bins];
variable hi = Double_Type[n_bins];
lo[0]=0.00008;
hi[0]=(lo[0] + lo[0]*df_f);

for(i=1;i<n_bins;i++){
    lo[i]=hi[i-1];
    hi[i]=lo[i]+lo[i]*df_f;
 }

%logarithmic frequency bin centre
variable rb_freq = 10^(0.5*(log10(lo)+log10(hi)));

%declare arrays
variable rb_n = Integer_Type[n_bins];
variable lag = Double_Type[n_bins];
variable g_a_real = Double_Type[n_bins];
variable g_a_imag = Double_Type[n_bins];
variable g_a = Double_Type[n_bins];
variable g_b = Double_Type[n_bins];
variable g_c = Double_Type[n_bins];
variable g = Double_Type[n_bins];
variable delta_phi = Double_Type[n_bins];
variable delta_lag = Double_Type[n_bins];

%loop through observarions
for(k=0; k<length(obs_id); k++){

() = chdir("/data/scratch3/steff/1H0707-495/" + obs_id[k] + "/PROC");

%Read data:
variable lc_soft = fits_read_table("PN_time_soft_lccorr.fits");
variable lc_hard = fits_read_table("PN_time_hard_lccorr.fits");

%exclude non-numbers:
variable ix_soft = where(not isnan(lc_soft.rate));
variable ix_hard = where(not isnan(lc_hard.rate));

%Pass to new variables:
variable time_soft = lc_soft.time[ix_soft];
variable time_hard = lc_hard.time[ix_hard];
variable rate_soft = lc_soft.rate[ix_soft];
variable rate_hard = lc_hard.rate[ix_hard];
variable error_soft = lc_soft.error[ix_soft];
variable error_hard = lc_hard.error[ix_hard];

% Compute soft dft:
variable dft_soft = fft(rate_soft,-1);
variable freq = [[0:length(dft_soft)-1]]/(double(length(dft_soft))*(time_soft[1]-time_soft[0]));
variable dft_real_soft = Real(dft_soft[[0:length(freq)-1]]);
variable dft_imag_soft = Imag(dft_soft[[0:length(freq)-1]]);

% Compute hard dft:
variable dft_hard = fft(rate_hard,-1);
variable dft_real_hard = Real(dft_hard[[0:length(freq)-1]]);
variable dft_imag_hard = Imag(dft_hard[[0:length(freq)-1]]);

%Calculate and sum CPS for each frequency bin in each observation.
for(i=0; i< n_bins; i++)
{
	for (j=0; j<length(freq); j++)
	{
		if(freq[j] > lo[i] && freq[j] <= hi[i])
		{
			g_a_real[i] += dft_real_soft[j]*dft_real_hard[j] + dft_imag_soft[j]*dft_imag_hard[j];
			g_a_imag[i] += dft_imag_soft[j]*dft_real_hard[j] - dft_real_soft[j]*dft_imag_hard[j];
			g_b[i] += dft_real_soft[j]*dft_real_soft[j] + dft_imag_soft[j]*dft_imag_soft[j];
			g_c[i] += dft_real_hard[j]*dft_real_hard[j] + dft_imag_hard[j]*dft_imag_hard[j];
			rb_n[i] ++;
		}
	}
}
}

%Plot variables including frequency error bars
variable x = (hi+lo)/2;
variable dxp = hi-x;
variable dxm = x-lo;
variable delta_freq = (dxp+dxm)/2;


%Average CPS in each frequency bin for all observations. Calculate coherence, g[i], for each frequency bin.
for(i=0;i<n_bins;i++)
{
	%Lag error
	g_a[i] = (g_a_real[i]*g_a_real[i] + g_a_imag[i]*g_a_imag[i])/(double(rb_n[i])*double(rb_n[i]));
	g_b[i] /= double(rb_n[i]);
        g_c[i] /= double(rb_n[i]);
	g[i] = g_a[i]/(g_b[i]*g_c[i]);
	delta_phi[i] = sqrt((1.0-g[i])/(2.0*g[i]))/sqrt(double(rb_n[i]));
	delta_lag[i] = delta_phi[i]/(2.0*PI*rb_freq[i]);

	%Lag
	g_a_real[i] /= rb_n[i];
	g_a_imag[i] /= rb_n[i];
	lag[i] = atan2(g_a_imag[i] , g_a_real[i])/(2.0*PI*rb_freq[i]);
}

% Plot results:
() = chdir("/homeb/steff075/phd_ecm/1h0707"); %change to combined directory
%open_plot("1H0707-495_fullycomb_lagfreq.gif/gif"); % create a gif image
xlog;
ylin;
popt.res = 1;
ylabel("Time Lag (s)");
xlabel("Frequency (Hz)");
title("1H0707-495 lag-frequency >8e-5 Hz");
%connect_points(1);
charsize(1.2); % good character size
nice_width; %good line ratios
plotxy(x, dxm, dxp, lag, delta_lag, delta_lag; dcol=1, decol=4, dsym=6, mcol=2,xrange=[6e-5,1e-2],yrange=[-200,300]);
_pgscf(2); % set character font 1=default, 2=roman, 3=italic, 4=script
_pgsfs(3); % set fill area style
_pgsls(2); % set line style to 1=full line, 2=dashed, 3=dot-dash-dot, 4=dotted
_pgslw(1); % set line width to 1
_pgmove(-10000,0); % move pen to point X,Y (no line is drawn)
_pgdraw(1,0); % draw a line from coordinates X,Y
%close_plot;

%Print lag values to screen
for (i=0; i<length(x); i++) {
  () = printf("%e,%e,%e,%e\n", x[i], delta_freq[i], lag[i], delta_lag[i]);
}
%close_plot;

% Print lag freq values to csv file
fp = fopen("time_lags_comb.csv","w");% Create the file
for (i=0; i<length(x); i++) {
  fprintf(fp,"%e,%e,%e,%e\n", x[i], delta_freq[i], lag[i], delta_lag[i]);
}
fclose(fp);

%Create ps image
%variable pid = open_plot("1H0707-495_lagfreq_fullycomb.ps/cps");
%charsize(1.3); %good font size
%nice_width; %good line ratios
%_pgscf(2); %make font roman
%plotxy(x,dxm,dxp,lag,delta_lag,delta_lag; dcol=1, decol=4, dsym=6, mcol=2, xrange=[6e-5,1e-2],yrange=[-50,200]);
%_pgmove(-10000,0);
%_pgsls(2);
%_pgslw(1);
%_pgdraw(1,0);
%close_plot(pid);
#+END_EXAMPLE

** Combined spectra script

#+BEGIN_EXAMPLE

%declare path
variable path_to_data = "/data/scratch3/steff/1H0707-495";

variable obsid = ["0506200201","0506200301","0506200401","0506200501"];
variable i;

% Read in all data sets
for (i=0; i<length(obsid); i++) {
  () = chdir(path_to_data + "/" + obsid[i] + "/PROC");
  () = load_data("PN_time_0.3-10_pi_grp.fits");
}

match_dataset_grids (all_data());
chdir(path_to_data);

% Now group and rebin the data
variable g;
g = combine_datasets(all_data());


% See which datasets have been combined
print(combination_members(g));

% Rebin to a minimum number of counts per bin
rebin_combined(g, 100);

% Then notice a specific energy range
%xnotice_en(all_data(),0.3,10.0);
%ignore_en(all_data(),0.1,0.3);
%ignore_en(all_data(),10.0,20.0);

% Fit a model and plot the result
%fit_fun("powerlaw+diskbb+laor");
fit_fun("(powerlaw+laor+diskbb)*edge");
popt.yrange = [1.0e-4, 10.0, -10.0, 10.0];
xlog;
ylog;
title ("1H0707-495 Combined 2007 Spectrum");
popt.dsym = 1;
popt.rsym = 1;
popt.res = 4;
xnotice_en(all_data(),0.3,10.0);
ignore_en(all_data(),0.1,0.3);
ignore_en(all_data(),10.0,20.0);
popt.ccol=14;
charsize(1.2);
set_par(1,0.000119498);
set_par(2,2.18896);
set_par(3,2.591446e-05);
set_par(4,6.377239);
set_par(5,3.998935,0);
set_par(8,33.56053,0);
set_par(9,30);
set_par(10,0.13);
set_par(11,7.2);
set_par(12,2);
set_fit_method("subplex");
()=fit_counts;
() = eval_counts;
plot_comps({{g}}, popt, &plot_data);
plot_comps(1-4,popt,&plot_data);

list_par;
data_flux(1,0.3,10);
list_data;

%model_flux(g,0.3,10 [unit=erg, pc=174,100,000,print]);
()=chdir("/data/scratch3/steff/1H0707-495/combined/");
variable pid = open_plot("1H0707-495_spec_comb2007.ps/cps");
plot_comps(1-4,popt,&plot_data);
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman

%close_plot(pid);


#+END_EXAMPLE
** Create spectra script
#+BEGIN_EXAMPLE
!  /opt/data.cluster/astrosoft/lib/python2.7/
#! alternative /usr/bin/python

# Script to create a "spectrum" corresponding to lag-frequency plots
# and a response matrix containing the frequency binning
# Spectra are usually plotted as energy on x-axis and counts / s / keV on y-axis
# Our x-axis will correspond to Frequency (Hz)
# Our y-axis will correspond to Time lag (sec)
# This means our y values need to be multiplied by the bin width
# The "exposure time" is set to one second
# Note steff's method: ##! /opt/local/bin/python3.5

from astropy.io import fits
import numpy as np
import sys, os

# Time lag values
time_lag = np.array([8.517445e+01 , 2.423430e+02 , 5.911962e+01 , -1.908393e+01 , -2.845252e+01 , -3.785675e+00 , -1.539097e+00])
time_lag_err = np.array([8.862303e+01 , 3.531911e+01 , 1.859498e+01 , 9.756367e+00 , 4.501351e+00 , 2.387277e+00 , 1.035855e+00])
# Frequency bins should be contiguous with no gaps between them
freq_low = np.array([0.00010472724 , 0.0001692562 , 0.0003231255 , 0.0006168759 , 0.0011776723 , 0.0022482835 , 0.004292177])
freq_high = np.array([0.0001692562 , 0.0003231255 , 0.0006168759 , 0.0011776723 , 0.0022482835 , 0.004292177 , 0.006196830200000001])

os.system("rm -f time_lags.fits")
os.system("rm -f time_lags.rsp")

# Name of output file stem (.fits and .rsp get added to this stem)
output_file = '2008_comb_time_lags'

# Multiply lags and associated errors by bin widths
time_lag = time_lag * (freq_high - freq_low)
time_lag_err = time_lag_err  * (freq_high - freq_low)

# Create the "spectrum"
# See http://heasarc.gsfc.nasa.gov/docs/heasarc/ofwg/docs/spectra/ogip_92_007/ogip_92_007.html
# And the example on that site too

channels = np.arange(1, len(time_lag)+1)
zeros = np.zeros(len(time_lag))
ones = np.ones(len(time_lag))

col1 = fits.Column(name='CHANNEL', format='I', array=channels)
col2 = fits.Column(name='COUNTS', format='E', array=time_lag)
col3 = fits.Column(name='STAT_ERR', format='E', array=time_lag_err)
col4 = fits.Column(name='GROUPING', format='I', array=zeros)

spechdr = fits.Header()
spechdr['SYS_ERR'] = 0
spechdr['QUALITY'] = 0
spechdr['POISSERR'] = False
spechdr['EXPOSURE'] = 1.0
spechdr['AREASCAL'] = 1.0
spechdr['BACKSCAL'] = 1.0
spechdr['EXTNAME'] = 'SPECTRUM'
spechdr['DETCHANS'] = len(time_lag)
spechdr['HDUCLASS'] = 'OGIP'
spechdr['HDUCLAS1'] = 'SPECTRUM'
spechdr['HDUVERS'] = '1.2.1'
spechdr['BACKFILE'] = 'none'
spechdr['CORRFILE'] = 'none'
spechdr['RESPFILE'] = output_file + '.rsp'
spechdr['ANCRFILE'] = 'none'
spechdr['CHANTYPE'] = 'PI'
spechdr['TELESCOP'] = 'XMM-NEWTON'
spechdr['INSTRUME'] = 'EPIC-PN'
spechdr['FILTER'] = 'none'

cols = fits.ColDefs([col1, col2, col3, col4])

tbhdu = fits.BinTableHDU.from_columns(cols, name='SPECTRUM', header=spechdr)

prihdr = fits.Header()
prihdr['HDUCLASS'] = 'OGIP'
prihdr['HDUCLAS1'] = 'SPECTRUM'
prihdr['HDUVERS'] = '1.2.1'
prihdu = fits.PrimaryHDU(header=prihdr)

thdulist = fits.HDUList([prihdu, tbhdu])
thdulist.writeto(output_file + '.fits')

print("Created spectrum")

# Create the "response"
# See http://heasarc.gsfc.nasa.gov/docs/heasarc/caldb/docs/memos/cal_gen_92_002/cal_gen_92_002.html
# Our response matrix will be diagonal

rsp_col1 = fits.Column(name='ENERG_LO', format='E', array=freq_low)
rsp_col2 = fits.Column(name='ENERG_HI', format='E', array=freq_high)
rsp_col3 = fits.Column(name='N_GRP', format='I', array=ones)
rsp_col4 = fits.Column(name='F_CHAN', format='I', array=channels)
rsp_col5 = fits.Column(name='N_CHAN', format='I', array=ones)
rsp_col6 = fits.Column(name='MATRIX', format='E', array=ones)

rspcols = fits.ColDefs([rsp_col1, rsp_col2, rsp_col3, rsp_col4, rsp_col5, rsp_col6])

rsphdr = fits.Header()
rsphdr['EXTNAME'] = 'MATRIX'
rsphdr['TELESCOP'] = 'XMM-NEWTON'
rsphdr['INSTRUME'] = 'EPIC-PN'
rsphdr['FILTER'] = 'none'
rsphdr['CHANTYPE'] = 'PI'
rsphdr['DETCHANS'] = len(time_lag)
rsphdr['HDUCLASS'] = 'OGIP'
rsphdr['HDUCLAS1'] = 'RESPONSE'
rsphdr['HDUCLAS2'] = 'RSP_MATRIX'
rsphdr['HDUCLAS3'] = 'FULL'
rsphdr['HDUVERS'] = '1.3.0'

rsphdu = fits.BinTableHDU.from_columns(rspcols, name='MATRIX', header=rsphdr)

ebin_col1 = fits.Column(name='CHANNEL', format='I', array=channels)
ebin_col2 = fits.Column(name='E_MIN', format='E', array=freq_low)
ebin_col3 = fits.Column(name='E_MAX', format='E', array=freq_high)

ebin_cols = fits.ColDefs([ebin_col1, ebin_col2, ebin_col3])

ebin_hdr = fits.Header()
ebin_hdr['EXTNAME'] = 'EBOUNDS'
ebin_hdr['TELESCOP'] = 'XMM-NEWTON'
ebin_hdr['INSTRUME'] = 'EPIC-PN'
ebin_hdr['FILTER'] = 'none'
ebin_hdr['CHANTYPE'] = 'PI'
ebin_hdr['DETCHANS'] = len(time_lag)
ebin_hdr['HDUCLASS'] = 'OGIP'
ebin_hdr['HDUCLAS1'] = 'RESPONSE'
ebin_hdr['HDUCLAS2'] = 'EBOUNDS'
ebin_hdr['HDUVERS'] = '1.2.0'

ebin_hdu = fits.BinTableHDU.from_columns(ebin_cols, name='EBOUNDS', header=ebin_hdr)

rsp_prihdr = fits.Header()
rsp_prihdr['HDUCLASS'] = 'OGIP'
rsp_prihdr['HDUCLAS1'] = 'SPECTRUM'
rsp_prihdr['HDUVERS'] = '1.2.1'
rsp_prihdu = fits.PrimaryHDU(header=rsp_prihdr)

rsp_thdulist = fits.HDUList([rsp_prihdu, rsphdu, ebin_hdu])
rsp_thdulist.writeto(output_file + '.rsp')

print("Created response")

#+END_EXAMPLE

** Create spectra template
#+BEGIN_EXAMPLE
#!  /opt/data.cluster/astrosoft/lib/python2.7/
#! alternative /usr/bin/python

# Script to create a "spectrum" corresponding to lag-frequency plots
# and a response matrix containing the frequency binning
# Spectra are usually plotted as energy on x-axis and counts / s / keV on y-axis
# Our x-axis will correspond to Frequency (Hz)
# Our y-axis will correspond to Time lag (sec)
# This means our y values need to be multiplied by the bin width
# The "exposure time" is set to one second
# Note steff's method: ##! /opt/local/bin/python3.5

from astropy.io import fits
import numpy as np
import sys, os

# Time lag values
TIMELAG
TIMELAGERROR
# Frequency bins should be contiguous with no gaps between them
LOWFREQUENCY
HIGHFREQUENCY

os.system("rm -f time_lags.fits")
os.system("rm -f time_lags.rsp")

# Name of output file stem (.fits and .rsp get added to this stem)
output_file = '2008_comb_time_lags'

# Multiply lags and associated errors by bin widths
time_lag = time_lag * (freq_high - freq_low)
time_lag_err = time_lag_err  * (freq_high - freq_low)

# Create the "spectrum"
# See http://heasarc.gsfc.nasa.gov/docs/heasarc/ofwg/docs/spectra/ogip_92_007/ogip_92_007.html
# And the example on that site too

channels = np.arange(1, len(time_lag)+1)
zeros = np.zeros(len(time_lag))
ones = np.ones(len(time_lag))

col1 = fits.Column(name='CHANNEL', format='I', array=channels)
col2 = fits.Column(name='COUNTS', format='E', array=time_lag)
col3 = fits.Column(name='STAT_ERR', format='E', array=time_lag_err)
col4 = fits.Column(name='GROUPING', format='I', array=zeros)

spechdr = fits.Header()
spechdr['SYS_ERR'] = 0
spechdr['QUALITY'] = 0
spechdr['POISSERR'] = False
spechdr['EXPOSURE'] = 1.0
spechdr['AREASCAL'] = 1.0
spechdr['BACKSCAL'] = 1.0
spechdr['EXTNAME'] = 'SPECTRUM'
spechdr['DETCHANS'] = len(time_lag)
spechdr['HDUCLASS'] = 'OGIP'
spechdr['HDUCLAS1'] = 'SPECTRUM'
spechdr['HDUVERS'] = '1.2.1'
spechdr['BACKFILE'] = 'none'
spechdr['CORRFILE'] = 'none'
spechdr['RESPFILE'] = output_file + '.rsp'
spechdr['ANCRFILE'] = 'none'
spechdr['CHANTYPE'] = 'PI'
spechdr['TELESCOP'] = 'XMM-NEWTON'
spechdr['INSTRUME'] = 'EPIC-PN'
spechdr['FILTER'] = 'none'

cols = fits.ColDefs([col1, col2, col3, col4])

tbhdu = fits.BinTableHDU.from_columns(cols, name='SPECTRUM', header=spechdr)

prihdr = fits.Header()
prihdr['HDUCLASS'] = 'OGIP'
prihdr['HDUCLAS1'] = 'SPECTRUM'
prihdr['HDUVERS'] = '1.2.1'
prihdu = fits.PrimaryHDU(header=prihdr)

thdulist = fits.HDUList([prihdu, tbhdu])
thdulist.writeto(output_file + '.fits')

print("Created spectrum")

# Create the "response"
# See http://heasarc.gsfc.nasa.gov/docs/heasarc/caldb/docs/memos/cal_gen_92_002/cal_gen_92_002.html
# Our response matrix will be diagonal

rsp_col1 = fits.Column(name='ENERG_LO', format='E', array=freq_low)
rsp_col2 = fits.Column(name='ENERG_HI', format='E', array=freq_high)
rsp_col3 = fits.Column(name='N_GRP', format='I', array=ones)
rsp_col4 = fits.Column(name='F_CHAN', format='I', array=channels)
rsp_col5 = fits.Column(name='N_CHAN', format='I', array=ones)
rsp_col6 = fits.Column(name='MATRIX', format='E', array=ones)

rspcols = fits.ColDefs([rsp_col1, rsp_col2, rsp_col3, rsp_col4, rsp_col5, rsp_col6])

rsphdr = fits.Header()
rsphdr['EXTNAME'] = 'MATRIX'
rsphdr['TELESCOP'] = 'XMM-NEWTON'
rsphdr['INSTRUME'] = 'EPIC-PN'
rsphdr['FILTER'] = 'none'
rsphdr['CHANTYPE'] = 'PI'
rsphdr['DETCHANS'] = len(time_lag)
rsphdr['HDUCLASS'] = 'OGIP'
rsphdr['HDUCLAS1'] = 'RESPONSE'
rsphdr['HDUCLAS2'] = 'RSP_MATRIX'
rsphdr['HDUCLAS3'] = 'FULL'
rsphdr['HDUVERS'] = '1.3.0'

rsphdu = fits.BinTableHDU.from_columns(rspcols, name='MATRIX', header=rsphdr)

ebin_col1 = fits.Column(name='CHANNEL', format='I', array=channels)
ebin_col2 = fits.Column(name='E_MIN', format='E', array=freq_low)
ebin_col3 = fits.Column(name='E_MAX', format='E', array=freq_high)

ebin_cols = fits.ColDefs([ebin_col1, ebin_col2, ebin_col3])

ebin_hdr = fits.Header()
ebin_hdr['EXTNAME'] = 'EBOUNDS'
ebin_hdr['TELESCOP'] = 'XMM-NEWTON'
ebin_hdr['INSTRUME'] = 'EPIC-PN'
ebin_hdr['FILTER'] = 'none'
ebin_hdr['CHANTYPE'] = 'PI'
ebin_hdr['DETCHANS'] = len(time_lag)
ebin_hdr['HDUCLASS'] = 'OGIP'
ebin_hdr['HDUCLAS1'] = 'RESPONSE'
ebin_hdr['HDUCLAS2'] = 'EBOUNDS'
ebin_hdr['HDUVERS'] = '1.2.0'

ebin_hdu = fits.BinTableHDU.from_columns(ebin_cols, name='EBOUNDS', header=ebin_hdr)

rsp_prihdr = fits.Header()
rsp_prihdr['HDUCLASS'] = 'OGIP'
rsp_prihdr['HDUCLAS1'] = 'SPECTRUM'
rsp_prihdr['HDUVERS'] = '1.2.1'
rsp_prihdu = fits.PrimaryHDU(header=rsp_prihdr)

rsp_thdulist = fits.HDUList([rsp_prihdu, rsphdu, ebin_hdu])
rsp_thdulist.writeto(output_file + '.rsp')

print("Created response")

#+END_EXAMPLE
** Generate time lag fits files script
#+BEGIN_EXAMPLE
# This python script takes a data table produced by isis in the form freq,lag,lagerror and produces a .fits and .rsp file of the data which can be used for example in model fitting

import csv, os

Frequencies=[]
Lags=[]
LagErrors=[]
LowFrequencies=[]
HighFrequencies=[]

# Read in data produced from isis into arrays
with open('lag_values_2008.txt','r') as f:
    reader=csv.reader(f,delimiter=',')
    for Frequency,Lag,LagError in reader:
        Frequencies.append(Frequency)
        Lags.append(Lag)
        LagErrors.append(LagError)

NumberOfFrequencies = len(Frequencies)

# Split the frequencies into bins
LowFrequencies.append(float(float(Frequencies[0])*0.9))
for i in range(0,NumberOfFrequencies-1):
    HighFrequencies.append((float(Frequencies[i]) + float(Frequencies[i+1]))/2)
    if(i!=0):
        LowFrequencies.append(float(HighFrequencies[i-1]))
LowFrequencies.append(float(HighFrequencies[NumberOfFrequencies-2]))

HighFrequencies.append(float(float(Frequencies[NumberOfFrequencies-1])*1.1))

#Store the data in a comma separated format
LowFrequenciesString = " , ".join(str(x) for x in LowFrequencies)
HighFrequenciesString = " , ".join(str(x) for x in HighFrequencies)
LagsString = " , ".join(str(x) for x in Lags)
LagErrorsString = " , ".join(str(x) for x in LagErrors)

# Add the relevant header/ finishing material to the strings
LowFreq = str("freq_low = np.array(["+LowFrequenciesString+"])")
HighFreq = str("freq_high = np.array(["+HighFrequenciesString+"])")
TLag = str("time_lag = np.array(["+LagsString+"])")
TLagErr = str("time_lag_err = np.array(["+LagErrorsString+"])")

# Open a template 'create_spectra.py' file and replace the placeholders (Caps words) with the actual strings you want
f1=open("create_spectra_template.py","r") # Opens a segment analysis template file.
f2=open("create_spectra.py","w") # Opens a local version which will be run.
for line in f1: # For each line in the template file...
    line=line.replace("LOWFREQUENCY",str(LowFreq))
    line=line.replace("HIGHFREQUENCY",str(HighFreq))
    line=line.replace("TIMELAGERROR",str(TLagErr))
    line=line.replace("TIMELAG",str(TLag))
    f2.write(line)
f1.close()
f2.close()

#Call and run create_spectra.py
print ("Running 'create_spectra.py'")
os.system("/homeb/steff075/anaconda3/bin/python create_spectra.py")

print ("Fits and Respnse files completed!")
#+BEGIN_EXAMPLE
#!  /opt/data.cluster/astrosoft/lib/python2.7/
#! alternative /usr/bin/python

# Script to create a "spectrum" corresponding to lag-frequency plots
# and a response matrix containing the frequency binning
# Spectra are usually plotted as energy on x-axis and counts / s / keV on y-axis
# Our x-axis will correspond to Frequency (Hz)
# Our y-axis will correspond to Time lag (sec)
# This means our y values need to be multiplied by the bin width
# The "exposure time" is set to one second
# Note steff's method: ##! /opt/local/bin/python3.5

from astropy.io import fits
import numpy as np
import sys, os

# Time lag values
TIMELAG
TIMELAGERROR
# Frequency bins should be contiguous with no gaps between them
LOWFREQUENCY
HIGHFREQUENCY

os.system("rm -f time_lags.fits")
os.system("rm -f time_lags.rsp")

# Name of output file stem (.fits and .rsp get added to this stem)
output_file = '2008_comb_time_lags'

# Multiply lags and associated errors by bin widths
time_lag = time_lag * (freq_high - freq_low)
time_lag_err = time_lag_err  * (freq_high - freq_low)

# Create the "spectrum"
# See http://heasarc.gsfc.nasa.gov/docs/heasarc/ofwg/docs/spectra/ogip_92_007/ogip_92_007.html
# And the example on that site too

channels = np.arange(1, len(time_lag)+1)
zeros = np.zeros(len(time_lag))
ones = np.ones(len(time_lag))

col1 = fits.Column(name='CHANNEL', format='I', array=channels)
col2 = fits.Column(name='COUNTS', format='E', array=time_lag)
col3 = fits.Column(name='STAT_ERR', format='E', array=time_lag_err)
col4 = fits.Column(name='GROUPING', format='I', array=zeros)

spechdr = fits.Header()
spechdr['SYS_ERR'] = 0
spechdr['QUALITY'] = 0
spechdr['POISSERR'] = False
spechdr['EXPOSURE'] = 1.0
spechdr['AREASCAL'] = 1.0
spechdr['BACKSCAL'] = 1.0
spechdr['EXTNAME'] = 'SPECTRUM'
spechdr['DETCHANS'] = len(time_lag)
spechdr['HDUCLASS'] = 'OGIP'
spechdr['HDUCLAS1'] = 'SPECTRUM'
spechdr['HDUVERS'] = '1.2.1'
spechdr['BACKFILE'] = 'none'
spechdr['CORRFILE'] = 'none'
spechdr['RESPFILE'] = output_file + '.rsp'
spechdr['ANCRFILE'] = 'none'
spechdr['CHANTYPE'] = 'PI'
spechdr['TELESCOP'] = 'XMM-NEWTON'
spechdr['INSTRUME'] = 'EPIC-PN'
spechdr['FILTER'] = 'none'

cols = fits.ColDefs([col1, col2, col3, col4])

tbhdu = fits.BinTableHDU.from_columns(cols, name='SPECTRUM', header=spechdr)

prihdr = fits.Header()
prihdr['HDUCLASS'] = 'OGIP'
prihdr['HDUCLAS1'] = 'SPECTRUM'
prihdr['HDUVERS'] = '1.2.1'
prihdu = fits.PrimaryHDU(header=prihdr)

thdulist = fits.HDUList([prihdu, tbhdu])
thdulist.writeto(output_file + '.fits')

print("Created spectrum")

# Create the "response"
# See http://heasarc.gsfc.nasa.gov/docs/heasarc/caldb/docs/memos/cal_gen_92_002/cal_gen_92_002.html
# Our response matrix will be diagonal

rsp_col1 = fits.Column(name='ENERG_LO', format='E', array=freq_low)
rsp_col2 = fits.Column(name='ENERG_HI', format='E', array=freq_high)
rsp_col3 = fits.Column(name='N_GRP', format='I', array=ones)
rsp_col4 = fits.Column(name='F_CHAN', format='I', array=channels)
rsp_col5 = fits.Column(name='N_CHAN', format='I', array=ones)
rsp_col6 = fits.Column(name='MATRIX', format='E', array=ones)

rspcols = fits.ColDefs([rsp_col1, rsp_col2, rsp_col3, rsp_col4, rsp_col5, rsp_col6])

rsphdr = fits.Header()
rsphdr['EXTNAME'] = 'MATRIX'
rsphdr['TELESCOP'] = 'XMM-NEWTON'
rsphdr['INSTRUME'] = 'EPIC-PN'
rsphdr['FILTER'] = 'none'
rsphdr['CHANTYPE'] = 'PI'
rsphdr['DETCHANS'] = len(time_lag)
rsphdr['HDUCLASS'] = 'OGIP'
rsphdr['HDUCLAS1'] = 'RESPONSE'
rsphdr['HDUCLAS2'] = 'RSP_MATRIX'
rsphdr['HDUCLAS3'] = 'FULL'
rsphdr['HDUVERS'] = '1.3.0'

rsphdu = fits.BinTableHDU.from_columns(rspcols, name='MATRIX', header=rsphdr)

ebin_col1 = fits.Column(name='CHANNEL', format='I', array=channels)
ebin_col2 = fits.Column(name='E_MIN', format='E', array=freq_low)
ebin_col3 = fits.Column(name='E_MAX', format='E', array=freq_high)

ebin_cols = fits.ColDefs([ebin_col1, ebin_col2, ebin_col3])

ebin_hdr = fits.Header()
ebin_hdr['EXTNAME'] = 'EBOUNDS'
ebin_hdr['TELESCOP'] = 'XMM-NEWTON'
ebin_hdr['INSTRUME'] = 'EPIC-PN'
ebin_hdr['FILTER'] = 'none'
ebin_hdr['CHANTYPE'] = 'PI'
ebin_hdr['DETCHANS'] = len(time_lag)
ebin_hdr['HDUCLASS'] = 'OGIP'
ebin_hdr['HDUCLAS1'] = 'RESPONSE'
ebin_hdr['HDUCLAS2'] = 'EBOUNDS'
ebin_hdr['HDUVERS'] = '1.2.0'

ebin_hdu = fits.BinTableHDU.from_columns(ebin_cols, name='EBOUNDS', header=ebin_hdr)

rsp_prihdr = fits.Header()
rsp_prihdr['HDUCLASS'] = 'OGIP'
rsp_prihdr['HDUCLAS1'] = 'SPECTRUM'
rsp_prihdr['HDUVERS'] = '1.2.1'
rsp_prihdu = fits.PrimaryHDU(header=rsp_prihdr)

rsp_thdulist = fits.HDUList([rsp_prihdu, rsphdu, ebin_hdu])
rsp_thdulist.writeto(output_file + '.rsp')

print("Created response")

#+END_EXAMPLE

* S-Language

https://www.jedsoft.org/slang/docs.html

To initiate in a termial

#+BEGIN_EXAMPLE
slsh
#+END_EXAMPLE

Or run an example in isis

use data in =/data/scratch3/steff/1H0707-495/0110890201/PROC=

#+BEGIN_EXAMPLE
require ("fits");
require ("histogram");
tbl = fits_read_table ("EPIC_clean.fits");
engrid = [min(tbl.energy):max(energy):#1024];
spectrum = hist1d (tbl.energy[where(tbl.status==0)], engrid);

#+END_EXAMPLE

* Veusz

Veusz has been downloaded and installed on anaconda by

#+BEGIN_EXAMPLE
conda install -c conda-forge veusz
#+END_EXAMPLE

And can now be run via a terminal
#+BEGIN_EXAMPLE
~/anaconda3/bin/veusz
#+END_EXAMPLE

All images and Veusz files are saved in the =/homeb/steff075/graphs= directory

Also see https://veusz.github.io/docs/manual/api.html#using-veusz-from-other-programs

* XSTAR

*Plot Spectra using relxill*warmabs* *(USE MENSA !!)*

Using Xstar model warmab, more information about the warm absorber model can be found on-line

 https://heasarc.gsfc.nasa.gov/xanadu/xspec/models/xstar.html

 https://heasarc.gsfc.nasa.gov/docs/software/lheasoft/xstar/xstar.html

#+BEGIN_EXAMPLE

First initiate heasoft:

heainit
isis
require("xspec");
load_xspec_local_models("/data/scratch4/ayoung/xspec-local-models/relxill", "relxill");
load_xspec_local_models("/homeb/steff075/xspec_models/warmabs", "xstarmod");
fit_fun("warmabs*relxill");

        For Xspec load model using command:
        initpackage xstarmod lmodel_warmabs.dat /homeb/steff075/xspec_models/warmabs
        lmod xstarmod /homeb/steff075/xspec_models/warmabs

Model parameters
warmabs*relxill
 idx  param                 tie-to  freeze         value         min         max
  1  warmabs(1).column          0     0                0          -3           2  cm^-2
  2  warmabs(1).rlogxi          0     0                0          -4           5
  3  warmabs(1).Cabund          0     1                1           0        1000
  4  warmabs(1).Nabund          0     1                1           0        1000
  5  warmabs(1).Oabund          0     1                1           0        1000
  6  warmabs(1).Fabund          0     1                1           0        1000
  7  warmabs(1).Neabund         0     1                1           0        1000
  8  warmabs(1).Naabund         0     1                1           0        1000
  9  warmabs(1).Mgabund         0     1                1           0        1000
 10  warmabs(1).Alabund         0     1                1           0        1000
 11  warmabs(1).Siabund         0     1                1           0        1000
 12  warmabs(1).Pabund          0     1                1           0        1000
 13  warmabs(1).Sabund          0     1                1           0        1000
 14  warmabs(1).Clabund         0     1                1           0        1000
 15  warmabs(1).Arabund         0     1                1           0        1000
 16  warmabs(1).Kabund          0     1                1           0        1000
 17  warmabs(1).Caabund         0     1                1           0        1000
 18  warmabs(1).Scabund         0     1                1           0        1000
 19  warmabs(1).Tiabund         0     1                1           0        1000
 20  warmabs(1).Vabund          0     1                1           0        1000
 21  warmabs(1).Crabund         0     1                1           0        1000
 22  warmabs(1).Mnabund         0     1                1           0        1000
 23  warmabs(1).Feabund         0     1                1           0        1000
 24  warmabs(1).Coabund         0     1                1           0        1000
 25  warmabs(1).Niabund         0     1                1           0        1000
 26  warmabs(1).Cuabund         0     1                1           0        1000
 27  warmabs(1).Znabund         0     1                1           0        1000
 28  warmabs(1).write_outfile   0     1                1           0           1
 29  warmabs(1).outfile_idx     0     1                0           0       10000
 30  warmabs(1).vturb           0     1                0           0       10000  km/s
 31  warmabs(1).Redshift        0     1                0           0          10
 32  relxill(1).norm            0     0                1           0       1e+10
 33  relxill(1).Index1          0     1                3         -10          10
 34  relxill(1).Index2          0     1                3         -10          10
 35  relxill(1).Rbr             0     1               15           1         400
 36  relxill(1).a               0     0            0.998      -0.998       0.998
 37  relxill(1).Incl            0     1               30           5          80  deg
 38  relxill(1).Rin             0     1               -1        -100          -1
 39  relxill(1).Rout            0     1              400           1         400
 40  relxill(1).z               0     1                0           0          10
 41  relxill(1).gamma           0     0                2           1         3.4
 42  relxill(1).logxi           0     0              3.1           0         4.7
 43  relxill(1).Afe             0     0                1         0.5          10
 44  relxill(1).Ecut            0     1              300           5        1000  keV
 45  relxill(1).refl_frac       0     0                3           0          10
#+END_EXAMPLE

* Literature

Bentz et al (2006) A REVERBERATION-BASED MASS FOR THE CENTRAL BLACK
HOLE IN NGC 4151, ApJ 651,775-781 http://adsabs.harvard.edu/abs/2006ApJ...651..775B

Buisson et al (2018) NuSTAR observations of Mrk 766: distinguishing
reflection from absorption https://arxiv.org/abs/1808.00014

Fabian et al (2012) 1H0707-495 in 2011: an X-ray source within a
gravitational radius of the event horizon MNRAS 419, 116-123
http://adsabs.harvard.edu/abs/2012MNRAS.419..116F


Mehdipour et al (2010) The warm absorber and X-ray variability of the
Seyfert 1 galaxy NGC 3516 as seen by the XMM-Newton RGS, A&A, 514,
A100 http://adsabs.harvard.edu/abs/2010A%26A...514A.100M
tools/git/2.18.0

Turner & Miller (2009) X-ray absorption and reflection in active galactic nuclei
http://adsabs.harvard.edu/abs/2009A%26ARv..17...47T
