#+TITLE: Extended Corona Model (ECM)
#+AUTHOR: Stephen Hancock, University of Bristol, HH Wills Physics Lab, Room 4.17. Email: steff.hancock@bristol.ac.uk
#+DESCRIPTION:
#+KEYWORDS:
#+LANGUAGE:  en
#+OPTIONS:   H:3 num:t toc:nil \n:nil @:t ::t |:t ^:t -:t f:t *:t <:t
#+OPTIONS:   TeX:t LaTeX:t skip:nil d:nil todo:t pri:nil tags:nil
#+INFOJS_OPT: view:nil toc:nil ltoc:t mouse:underline buttons:0 path:http://orgmode.org/org-info.js
#+EXPORT_SELECT_TAGS: export
#+EXPORT_EXCLUDE_TAGS: noexport
#+LINK_UP:
#+LINK_HOME:2
#+XSLT:
#+TOC: headlines 4

* Path to data

*PATH   = /mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation*

*Backup = /data/scratch5/steff*

Backup using e.g:
#+BEGIN_EXAMPLE
rsync -a so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/code-x /data/scratch5/steff

rsync -r so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/code-x-files /data/scratch5/steff

scp -r so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/img-files .
#+END_EXAMPLE

* Research outline (short summary)

X-ray observations of Active Galactic Nuclei (AGN) can be used to study the dynamic environment of AGN using reflected radiation from the innermost regions of the accretion disk. There is a large data archive containing multiple long observations of dozens of different AGN.

Our research explores the dynamics of over 20 AGN performing an energy-resolved Fourier analysis of their light curves and fitting sophisticated spectral and temporal models, including a newly developed model of the extended corona responsible for producing the X-rays.

We will calculate the time lags and spectra to estimate the size and location of the corona and to constrain the properties of any relativistic jet beaming away from the disk, and our results and methods will be used to build a spectral and temporal model of the extended corona which can be used by the wider scientific community.

This work is building on the model created by Chainakun & Young
(2017): Investigating the X-ray time lags in PG 1244+026 using an
extended corona model, available at: [[https://ui.adsabs.harvard.edu/abs/2017MNRAS.465.3965C/abstract]]

* Introduction & Overview
*Essential AGN information*

File PATH =/homeb/steff075/phd_ecm/results/AGN-Flux-data-bol-Edd.xlsx=

#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
| Source         |         z |  i | Log M_sun |    M_sun | tg=(GM/c^3) | rg=(GM/c^2) | Luminosity-Distance-pc-from NED | L_Edd / ergs s-1 | Log  L_Edd | Log L_bol / ergs s-1 | L_bol   / ergs s-1 | Edd Ratio L_bol / L_Edd |
| 1H0419-577     |     0.104 | 55 |      8.11 | 1.29E+08 |    6.36E+02 |    9.43E+07 |                        4.61E+08 |         1.62E+46 |   4.62E+01 |                      |                    |                0.00E+00 |
| 1H0707-495     |    0.0411 | 53 |      6.31 | 2.04E+06 |    1.01E+01 |    1.50E+06 |                        1.74E+08 |         2.57E+44 |   4.44E+01 |                44.43 |           2.69E+44 |                1.05E+00 |
| Ark564         |     0.024 | 58 |      6.27 | 1.86E+06 |    9.20E+00 |    1.36E+06 |                        9.85E+07 |         2.35E+44 |   4.44E+01 |                44.36 |           2.29E+44 |                9.76E-01 |
| IRAS13224-3809 |    0.0406 | 64 |      6.80 | 6.31E+06 |    3.12E+01 |    4.62E+06 |                        2.88E+08 |         7.95E+44 |   4.49E+01 |                45.74 |           5.50E+45 |                6.91E+00 |
| MCG-6-30-15    |  0.007749 | 35 |      6.30 | 2.00E+06 |    9.86E+00 |    1.46E+06 |                        3.58E+07 |         2.51E+44 |   4.44E+01 |                44.08 |           1.20E+44 |                4.78E-01 |
| Mrk335         |    0.0258 | 45 |      7.23 | 1.70E+07 |    8.39E+01 |    1.24E+07 |                        1.03E+08 |         2.14E+45 |   4.53E+01 |                 45.1 |           1.26E+45 |                5.88E-01 |
| Mrk766         |   0.01293 | 38 |      6.82 | 6.64E+06 |    3.28E+01 |    4.86E+06 |                        5.76E+04 |         8.36E+44 |   4.49E+01 |                43.98 |           9.55E+43 |                1.14E-01 |
| Mrk841         |    0.0365 | 30 |      8.52 | 3.31E+08 |    1.64E+03 |    2.42E+08 |                        1.57E+08 |         4.17E+46 |   4.66E+01 |                45.84 |           6.92E+45 |                1.66E-01 |
| NGC1365        |    0.0045 | 40 |      7.60 | 3.98E+07 |    1.97E+02 |    2.91E+07 |                        2.12E+07 |         5.01E+45 |   4.57E+01 |                43.99 |           9.77E+43 |                1.95E-02 |
| NGC3516        |   0.00886 | 39 |      7.40 | 2.48E+07 |    1.23E+02 |    1.82E+07 |                        3.75E+07 |         3.13E+45 |   4.55E+01 |                44.29 |           1.95E+44 |                6.23E-02 |
| NGC4051        |   0.00216 | 31 |      6.13 | 1.35E+06 |    6.66E+00 |    9.88E+05 |                        1.27E+07 |         1.70E+44 |   4.42E+01 |                43.26 |           1.82E+43 |                1.07E-01 |
| NGC4151        |    0.0033 | 30 |      7.65 | 4.47E+07 |    2.21E+02 |    3.27E+07 |                        1.71E+07 |         5.63E+45 |   4.58E+01 |                44.01 |           1.02E+44 |                1.82E-02 |
| NGC4395        |   0.00106 | 38 |      5.45 | 2.81E+05 |    1.39E+00 |    2.06E+05 |                        8.03E+06 |         3.54E+43 |   4.35E+01 |                41.18 |           1.51E+41 |                4.27E-03 |
| NGC5548        |   0.01718 | 47 |      7.72 | 5.22E+07 |    2.58E+02 |    3.83E+07 |                        7.45E+07 |         6.58E+45 |   4.58E+01 |                44.79 |           6.17E+44 |                9.37E-02 |
| NGC6860        |   0.01525 | 40 |      7.60 | 3.98E+07 |    1.97E+02 |    2.92E+07 |                        6.07E+07 |         5.02E+45 |   4.57E+01 |                43.71 |           5.13E+43 |                1.02E-02 |
| NGC7314        |    0.0048 | 10 |      6.70 | 5.01E+06 |    2.48E+01 |    3.67E+06 |                        1.54E+07 |         6.31E+44 |   4.48E+01 |                42.98 |           9.55E+42 |                1.51E-02 |
| NGC7469        |    0.0164 | 26 |      6.96 | 9.04E+06 |    4.46E+01 |    6.62E+06 |                        6.27E+07 |         1.14E+45 |   4.51E+01 |                 45.1 |           1.26E+45 |                1.11E+00 |
| PG1211+143     |    0.0809 | 30 |      7.61 | 4.07E+07 |    2.01E+02 |    2.98E+07 |                        3.58E+08 |         5.13E+45 |   4.57E+01 |                46.17 |           1.48E+46 |                2.88E+00 |
| PG1244+026     |    0.0482 | 38 |      7.26 | 1.82E+07 |    8.99E+01 |    1.33E+07 |                        2.10E+08 |         2.29E+45 |   4.54E+01 |                44.62 |           4.17E+44 |                1.82E-01 |
| PG1247+267     | 2 \pm 0.2 | 30 |      8.92 | 8.30E+08 |    4.10E+03 |    6.08E+08 |                        1.57E+10 |         1.05E+47 |   4.70E+01 |                47.34 |           2.19E+47 |                2.09E+00 |
| REJ1034+396    |      0.04 | 30 |      6.18 | 1.51E+06 |    7.48E+00 |    1.11E+06 |                        1.84E+08 |         1.91E+44 |   4.43E+01 |                44.52 |           3.31E+44 |                1.74E+00 |

-----------------------------------------------------------------------------------------------------------

*Previous work*

With attention to AGN previosly researched at http://www.star.bris.ac.uk/steff/xmmreverblags.html
This logbook outlines further research on the following AGN where the
Extended Corona Model was re-applied and investigated for better and
more robust fits. All data used is from the XMM-Newton archives.

See =AGN_ECM_Results.csv= at =/homeb/steff075/phd_ecm/initial_ecm_fits=

Also see =data/scratch4/gpres/final_data/=

The following csv file was complied with the initial fixed mass
results form MSc work at outline the following parameters starting
with  :

#+BEGIN_EXAMPLE
idx  param         tie-to  freeze         value         min         max  Description
 1  tlag(1).norm       0     1                1           0       1e+10  Normalisation - always set to 1
 2  tlag(1).o          0     0         2.361868           2          10  1st source height
 3  tlag(1).d          0     0         3.053948           3          20  2nd source height
 4  tlag(1).g          0     0         1.400001         1.4         3.2  Photon Index
 5  tlag(1).e          0     0        0.7675185         0.2           2  RRF1
 6  tlag(1).w          0     0        0.9068604         0.5         1.5  q2
 7  tlag(1).v          0     0         799.9999         200        2000  time max
 8  tlag(1).s          0     0         88.86738           0         100  time shift
 9  tlag(1).redshift   0     1                0         -10          10  Redshift - fixed
10  scale_lf(1).norm   0     1                1           0           0  scaling normalisation
11  scale_lf(1).mass   0     0         6.271238           6           8  Log10 of the mass
#+END_EXAMPLE

Data file produced from the fixed Mass ECM Fitting:
#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
| AGN         | $\chi^2$ | $h_1$ | $h_2$ | $\Gamma$ |  RRF | $q_2$ | $t_{\text{max}}$ | $t_{\text{shift}}$ | Log $M_\odot$ | Eddington ratio |
| 1H0707-495  |     6.88 |  2.00 |  6.00 |     1.40 | 0.25 |  0.50 |            325.4 |               73.3 |          6.31 |            1.05 |
| Ark564      |    11.36 |  2.50 |  3.99 |     1.40 | 0.50 |  1.00 |            729.7 |              100.0 |          6.27 |           0.976 |
| MCG-6-30-15 |     1.66 |  9.78 | 20.00 |     1.56 | 0.20 |  0.61 |            200.0 |               67.3 |          6.30 |           0.478 |
| Mrk335      |     7.97 |  2.85 |  3.77 |     1.57 | 0.20 |  0.90 |            800.0 |               38.0 |          7.23 |           0.588 |
| Mrk766      |     3.19 |  2.00 | 15.00 |     1.40 | 0.55 |  0.63 |            200.0 |               10.0 |          6.00 |           0.115 |
| Mrk841      |     4.33 |  4.73 |  13.3 |     2.80 | 1.63 |  1.23 |            379.0 |               4.84 |          8.52 |           0.166 |
| NGC4051     |    10.24 | 10.00 | 11.00 |     1.09 | 0.16 |  0.50 |           2000.0 |              21.87 |          6.13 |          0.0107 |
| NGC4151     |     4.20 |  2.00 | 17.00 |     1.90 | 0.93 |  0.90 |            200.0 |               5.45 |          7.65 |          0.0182 |
| NGC4395     |     2.50 |  1.00 |  2.17 |     1.40 | 1.50 |  1.10 |            200.0 |               10.0 |         5.449 |         0.00423 |
| NGC5548     |     6.51 |  9.56 | 17.00 |     2.22 | 2.00 |  1.10 |            200.0 |                5.0 |         7.718 |          0.0937 |
| NGC6860     |     1.54 |  7.65 | 20.00 |     1.54 | 2.00 |  0.90 |            200.0 |                5.0 |          7.60 |          0.0102 |
| NGC7314     |    47.56 |  4.52 |  8.94 |     2.58 | 1.45 |  1.16 |            217.8 |               34.7 |          6.70 |          0.0151 |
| PG1211+143  |     2.34 |  6.40 | 15.00 |     2.68 | 2.00 |  1.30 |           1400.0 |               22.2 |          7.61 |            2.88 |
| PG1244+026  |    10.60 |  2.23 | 20.00 |     1.40 | 0.20 |  0.56 |            200.0 |               10.0 |          7.26 |           0.182 |
| REJ1034+396 |    21.48 |  2.00 |  3.00 |     1.40 | 0.20 |  0.50 |            200.0 |               10.0 |          6.60 |           0.660 |


*Visualisations of data:*

Below are 2 visualisations of this data. Note that the Reduced Chi^2
fit is in blue and that the maximum time =t_max= and =t_shift= have
been ommitted for clarity as these values were typically very large.

http://www.star.bris.ac.uk/steff/ecm_vis3.png

http://www.star.bris.ac.uk/steff/ecm_vis4.png

Original fitting procedure and results at http://www.star.bris.ac.uk/steff/1H0707-495_2bm.html

---------------------------------------------------------------------------------------------------------------
*Some initial possible correlations*

#+ATTR_ORG: :width 500
#+ATTR_HTML: :width 500
http://www.star.bris.ac.uk/steff/ecm/ecm_q2VRRF.png

#+ATTR_ORG: :width 500
#+ATTR_HTML: :width 500
http://www.star.bris.ac.uk/steff/ecm/ecm_gammaVq2.png


#+ATTR_ORG: |:width 500
#+ATTR_HTML: :width 500
http://www.star.bris.ac.uk/steff/ecm/ecm_eddRVtshift.png

---------------------------------------------------------------------------------------------------------------

* Downloadable resources

Before we begin, we refer to the Timing analysis for the lag-frequency
conducted at the following link: http://www.star.bris.ac.uk/steff/timing_analysis.html

All time lags have been calculated and we have created the FITS and
RESPONSE files necessary for fitting the Extended Corona Model. These
files may be downloaded for each AGN at the following list of links:

[[http://www.star.bris.ac.uk/steff/ecm/1H0707-495-time-lag-fits.zip][*1H0707-495*]]

[[http://www.star.bris.ac.uk/steff/ecm/Ark564-time-lag-fits.zip][*Ark564*]]

[[http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809-time-lag-fits.zip][*IRAS13224-3809*]]

[[http://www.star.bris.ac.uk/steff/ecm/MCG-6-30-15-time-lag-fits.zip][*MCG6-30-15*]]

[[http://www.star.bris.ac.uk/steff/ecm/Mrk335-time-lag-fits.zip][*Mrk335*]]

[[http://www.star.bris.ac.uk/steff/ecm/Mrk766-time-lag-fits.zip][*Mrk766*]]

[[http://www.star.bris.ac.uk/steff/ecm/Mrk841-time-lag-fits.zip][*Mrk841*]]

[[http://www.star.bris.ac.uk/steff/ecm/NGC1365-time-lag-fits.zip][*NGC1365*]]

[[http://www.star.bris.ac.uk/steff/ecm/NGC3516-time-lag-fits.zip][*NGC3516*]]

[[http://www.star.bris.ac.uk/steff/ecm/NGC4051-time-lag-fits.zip][*NGC4051*]]

[[http://www.star.bris.ac.uk/steff/ecm/NGC4151-time-lag-fits.zip][*NGC4151*]]

[[http://www.star.bris.ac.uk/steff/ecm/NGC4395-time-lag-fits.zip][*NGC4395*]]

[[http://www.star.bris.ac.uk/steff/ecm/NGC5548-time-lag-fits.zip][*NGC5548*]]

[[http://www.star.bris.ac.uk/steff/ecm/NGC6860-time-lag-fits.zip][*NGC6860*]]

[[http://www.star.bris.ac.uk/steff/ecm/NCG7314-time-lag-fits.zip][*NGC7314*]]

[[http://www.star.bris.ac.uk/steff/ecm/NCG7469-time-lag-fits.zip][*NGC7469*]]

* Mathematical Functions describing the observerd data

http://localhost:8905/notebooks/1H0707-495-pydata1.ipynb

http://localhost:8905/notebooks/Mathematical-functions.ipynb

** Dampened oscillating sine wave

The lag frequency we see is similar to a dampened oscillating sine
wave.

$y(t) = A e^{-jt} (cos(\omega t + \phi) + (sin(\omega t + \phi))$

where $y(t)$ = Amplitude at time $t$

$A$ = initial amplitude of envelope

$j$ = the decay constant

$\phi$ = phase angle at some point

$\omega$ = angular frequency

and can be simplified to

$y(t) = A e^{-jt} (cos(\omega t + \phi)$

Lets plot a dampened oscillating sine wave using python:


#+BEGIN_EXAMPLE
import numpy as np
import matplotlib.pyplot as plt

x = np.linspace(0,10,1001)
L = 0.2
a = 2
w = 2
y = np.exp(-L*x) * a * np.cos(w * x)
plt.plot(x,y)
plt.show()
#+END_EXAMPLE

#+ATTR_HTML: :width 500
http://www.star.bris.ac.uk/steff/ecm/dampened-osc-wave.png

Okay! - Now lets put this into a lag frequency style

PATH =/home/steff075/phd_ecm/create-dampened-sine-wave.py=

#+BEGIN_EXAMPLE
import numpy as np
import pandas as pd
import ma|tplotlib.pyplot as plt
plt.style.use('classic')
from astropy.io import fits as pyfits

fig, ax = plt.subplots()
# Create array x with length 1001 and equally spaced values between 0 to 10
x = np.linspace(1e-5,1e-1, 100000)
j = 400
a = 200
w = 4000
y = np.exp(-x*j) * a * np.cos(w * x)
#figsize=(8,6)
plt.xlim(1e-5,1e-1)
plt.xscale('log')
plt.ylim(-250.0,250.0)
line = ([1e-5, 1e-1], [0,0])
plt.plot(x,y)
plt.plot(line, linestyle='--', linewidth='0.3', color = 'black')
plt.xlabel(r'Frequency $(1/t_g)$', fontsize=14)
plt.ylabel(r'Time Lag $(t_g)$', fontsize=14)
plt.show()
#fig.savefig('dampened-osc-wave.png')
plt.close()
#+END_EXAMPLE

#+ATTR_HTML: :width 500
http://www.star.bris.ac.uk/steff/ecm/dampened-osc-wave2.png

** Sine integrals

See Press W.H et al. Numerical recipes: The Art of Scientific Computing, 3rd Edition , Cambridge PressChp 6.8.2 pp.300

Sine integral:

$f(x) = \int_{a}^{b} (|x| < 1e-10)$ or else $( x~\text{sin}~k/x )$

where k = 0.5 - x...

*k = 0.5*
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/sine-integral-k0.5.png
----------------------------------------------------------

*k = 1.5*
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/sine-integral-k1.5.png
----------------------------------------------------------

*k = 2.5*
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/sine-integral-k2.5.png
----------------------------------------------------------

*k = 3.5*
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/sine-integral-k3.5.png
----------------------------------------------------------

*k = 4.5*
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/sine-integral-k4.5.png
----------------------------------------------------------
#+BEGIN_EXAMPLE
import numpy as np
from scipy import integrate
import matplotlib.pyplot as plt

def f(x):
    if (np.abs(x)<1e-10):
        res = x
    else:
        res = x*np.sin(2.5/x)
    return res

X = np.arange(-0.3,0.0,0.0005)
#X = np.arange(1e-5,0.1,0.09)
def F(x):
    try:
        return [integrate.quad(f, 0, y) for y in x]
    except TypeError:
        return integrate.quad(f, 0, x)

    plt.xscale('log')
    plt.xlim(1e-4,0.1)
    plt.ylim(-20,50)
    plt.xlabel(r'Frequency $(1/t_g)$', fontsize=14)
    plt.ylabel(r'Time Lag $(t_g)$', fontsize=14)
    #plt.line = ([-1e-5, 1.0], [0,0])
    plt.plot(line, linestyle='--', linewidth='0.3', color = 'black')
plt.figure(figsize=(14,6))
plt.subplot(121)
plt.plot(X, [F(x)[0] for x in X])
plt.subplot(122) # Plot Errors
plt.plot(X, [F(x)[1] for x in X]) # Errors
    #plt.plot(X, [F(x)[1] for x in X])
#plt.xscale('log')
plt.show
plt.savefig("sine-integral-k2.5.png")


print (F(x)) #Print Vals , errors

#+END_EXAMPLE

** Load 1H0707-495 combine lag data into Pandas

See =anaconda/1H0707-495-pydata.ipynb=

script ran in Jupyter notebooks is =/home/steff075/phd_ecm/ecm-for-python/1H0707-comb-lags.py=

#+BEGIN_EXAMPLE
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
plt.style.use('classic')
plt.rcParams['font.family'] = 'serif'

# Import csv and name cloumn headers
df1cols=['Freq','Freq_err', 'Lag','Lag_err']
df1 = pd.read_csv('/home/steff075/phd_ecm/ecm-for-python/1H0707-495-combined-data-lag.csv', names=df1cols, header=0)
df1

# gca stands for 'get current axis'
ax = plt.gca()
df1.plot(kind='line',x='Freq',y='Lag', xerr='Freq_err',  yerr='Lag_err', fmt='o', c='steelblue', ecolor='grey', linestyle='-', capsize=3, ax=ax)
plt.xlim(5e-5,2e-2)
plt.xscale('log')
figsize=(8,6)
plt.xlabel(r'Frequency $(Hz)$', fontsize=14)
plt.ylabel(r'Time Lag $(s)$', fontsize=14)
line = ([-1e-5, 1.0], [0,0])
plt.plot(line, linestyle='--', linewidth='0.3', color = 'black')
plt.show()
#plt.savefig('1H0707-comb-data.png')
plt.close()
#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707-comb-data.png

+---+----------+----------+------------+-----------+
|   |     Freq | Freq_err |        Lag |   Lag_err |
+---+----------+----------+------------+-----------+
| 0 | 0.000116 | 0.000036 | 118.021500 | 58.997980 |
+---+----------+----------+------------+-----------+
| 1 | 0.000222 | 0.000069 | 163.299200 | 21.828660 |
+---+----------+----------+------------+-----------+
| 2 | 0.000424 | 0.000133 |  44.376240 | 11.712300 |
+---+----------+----------+------------+-----------+
| 3 | 0.000810 | 0.000253 | -15.504550 |  6.565147 |
+---+----------+----------+------------+-----------+
| 4 | 0.001546 | 0.000483 | -29.159780 |  3.632464 |
+---+----------+----------+------------+-----------+
| 5 | 0.002951 | 0.000922 | -16.995170 |  3.925964 |
+---+----------+----------+------------+-----------+
| 6 | 0.005633 | 0.001760 |  -9.626157 |  7.423369 |
+---+----------+----------+------------+-----------+

** Cubic spline on 1H0707-495 combined lag data

script ran in Jupyter notebooks is =/home/steff075/phd_ecm/ecm-for-python/1H0707-comb-lags.py=

Interpolate the data

#+BEGIN_EXAMPLE
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
plt.style.use('classic')
plt.rcParams['font.family'] = 'serif'
from scipy.interpolate import interp1d

df1
x = df1.iloc[:,0]
y = df1.iloc[:,2]
f = interp1d(x, y,fill_value='extrapolate')
f2 = interp1d(x, y, kind='cubic', bounds_error=False, fill_value='extrapolate')

x_new = np.linspace(0.00006,0.006, num=1000, endpoint=True)
plt.plot(x, y, 'o', x_new, f(x_new), '--', x_new, f2(x_new), '-', linewidth='1.5')
plt.xlabel(r'Frequency $(Hz)$', fontsize=14)
plt.ylabel(r'Time Lag $(s)$', fontsize=14)
plt.legend(['data', 'linear', 'cubic'], loc='best')
plt.xscale('log')
plt.xlim(5e-5,1e-2)
line = ([1e-5, 1e-2], [0,0])
plt.plot(line, linestyle='--', linewidth='0.3', color = 'black')
#plt.show()
plt.savefig('1H0707-comb-data-cubicspline.png')
plt.close()
#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707-comb-data-cubicspline.png

** Create a basic lag model

See =1H0707-495-pydata=

some examples are below (only the first plot is shown)

#+BEGIN_EXAMPLE
import numpy as np
import matplotlib.pyplot as plt

data = np.arange(-5, 15, 1)# Note np.arange = (start, stop, step)
rev = 6.5
tmax = 4

def f(lag):
    return s + (np.sin(lag/rev) * np.exp(lag/10)) + (6 * np.exp(-lag/tmax))

plt.plot(data, f(x).astype(np.int))
plt.show()
#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/ecm-basic-model.png

* Bluecrystal commands
BlueCrystal Phase 4 uses Slurm as the job scheduler

Check your quota
#+BEGIN_EXAMPLE
mmlsquota --block-size auto
#+END_EXAMPLE

View pending and running jobs
#+BEGIN_EXAMPLE
squeue --state=PENDING

sacct -j 433000  <-----for a specific job ID

sacct -u so14935

squeue | grep so14935
#+END_EXAMPLE

To cancel a job in the queue
#+BEGIN_EXAMPLE
scancel 4433000
#+END_EXAMPLE

To cancel all jobs in the queue
#+BEGIN_EXAMPLE
scancel -u <username>
#+END_EXAMPLE

*Max jobs = 80 at one time*

* Extended Corona Model - General Information

** Login into Bluecrystal phase 4

#+BEGIN_EXAMPLE
ssh -X username@bc4login.acrc.bris.ac.uk
#+END_EXAMPLE

If you want to login in to the GPU login node, use

#+BEGIN_EXAMPLE
ssh -X username@bc4gpulogin.acrc.bris.ac.uk
#+END_EXAMPLE

Move to directory =x-ray-reverberation=

** Directories and updating new scripts from Git Hub

All code is on GitHub: https://github.com/phajy/x-ray-reverberation
which has been cloned to my home directory.

>>>>>>>>> *Use GitHub method* <<<<<<<<<<<<

Alternatively try this to update to the latest version of the code on
GitHub.

#+BEGIN_EXAMPLE
git pull origin master
#+END_EXAMPLE

>>>>>>>>> *Use GitHub method* <<<<<<<<<<<<

Alternatively try this to update to the latest version of the code on
GitHub.

#+BEGIN_EXAMPLE
git pull origin master
#+END_EXAMPLE

If it works ok you should see something like this:

#+BEGIN_EXAMPLE
lyra:/homeb/steff075/Documents/x-ray-reverberation> git pull origin master
Username for 'https://github.com': steff075
Password for 'https://steff075@github.com':
remote: Enumerating objects: 18, done.
remote: Counting objects: 100% (18/18), done.
remote: Compressing objects: 100% (5/5), done.
remote: Total 12 (delta 7), reused 12 (delta 7), pack-reused 0
Unpacking objects: 100% (12/12), done.
From https://github.com/phajy/x-ray-reverberation
 * branch            master     -> FETCH_HEAD
   90de71e..a0b4fa7  master     -> origin/master
Updating 90de71e..a0b4fa7
Fast-forward
 README.md                 |     4 +-
 fully_comb_time_lags.fits |   Bin 0 -> 8640 bytes
 fully_comb_time_lags.rsp  |   Bin 0 -> 14400 bytes
 model-log.md              |    49 +
 reverb.mod                | 25651 ++++++++++++++++++++++++++++++++++++++++++++
 setup_table.sl            |    20 +-
 submit-blob.pl            |     4 +-
 submit-code-x.pl          |     9 +-
 submit-code-x.sh          |    21 -
 table-models.py           |    60 +-
 tlag.par                  |    20 +
 11 files changed, 25787 insertions(+), 51 deletions(-)
 create mode 100644 fully_comb_time_lags.fits
 create mode 100644 fully_comb_time_lags.rsp
 create mode 100644 model-log.md
 create mode 100644 reverb.mod
 delete mode 100755 submit-code-x.sh
 create mode 100644 tlag.par
lyra:/homeb/steff075/Documents/x-ray-reverberation>
#+END_EXAMPLE

/however.../ sometimes When I tried this I got:

#+BEGIN_EXAMPLE
git pull origin master
Username for 'https://github.com': steff075
Password for 'https://steff075@github.com':
From https://github.com/phajy/x-ray-reverberation
 * branch            master     -> FETCH_HEAD
Updating cf35f72..bd0ea86
error: Your local changes to the following files would be overwritten by merge:
	cl-setup.h
	code-s.c
	submit-code-s.sh
Please commit your changes or stash them before you merge.
Aborting

#+END_EXAMPLE

/How do I commit or stash changes????/

You can't merge with local modifications. Git protects you from losing potentially important changes.
You have three options:

*Commit the change using*

#+BEGIN_EXAMPLE
git commit cl-setup.h
#+END_EXAMPLE

*Stash it*

Stashing acts as a stack, where you can push changes, and you pop them
in reverse order. To stash, type

#+BEGIN_EXAMPLE
git stash
#+END_EXAMPLE

Do the merge, and then pull the stash:

#+BEGIN_EXAMPLE
git stash pop
#+END_EXAMPLE

*Discard the local changes*

#+BEGIN_EXAMPLE
git reset --hard
#+END_EXAMPLE

or

#+BEGIN_EXAMPLE
git checkout -t -f remote/branch
#+END_EXAMPLE

Or: Discard local changes for a specific file

#+BEGIN_EXAMPLE
git checkout filename
#+END_EXAMPLE

/however.../ When I tried this I got:

#+BEGIN_EXAMPLE
git pull origin master
Username for 'https://github.com': steff075
Password for 'https://steff075@github.com':
From https://github.com/phajy/x-ray-reverberation
 * branch            master     -> FETCH_HEAD
Updating cf35f72..bd0ea86
error: Your local changes to the following files would be overwritten by merge:
	cl-setup.h
	code-s.c
	submit-code-s.sh
Please commit your changes or stash them before you merge.
Aborting

#+END_EXAMPLE

/How do I commit or stash changes????/

You can't merge with local modifications. Git protects you from losing potentially important changes.
You have three options:

*Commit the change using*

#+BEGIN_EXAMPLE
git commit cl-setup.h
#+END_EXAMPLE

*Stash it*

Stashing acts as a stack, where you can push changes, and you pop them
in reverse order. To stash, type

#+BEGIN_EXAMPLE
git stash
#+END_EXAMPLE

Do the merge, and then pull the stash:

#+BEGIN_EXAMPLE
git stash pop
#+END_EXAMPLE

*Discard the local changes*

#+BEGIN_EXAMPLE
git reset --hard
#+END_EXAMPLE

or

#+BEGIN_EXAMPLE
git checkout -t -f remote/branch
#+END_EXAMPLE

Or: Discard local changes for a specific file

#+BEGIN_EXAMPLE
git checkout filename
#+END_EXAMPLE


>>>>>>>>>>>>>>>>Manually update each script
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<

To update to new versions of scriprts once they have been committed
follow this procedure:

*Move to home directory*
#+BEGIN_EXAMPLE
cd /homeb/steff075
#+END_EXAMPLE

*Delete the old  directory then clone the current directory*
#+BEGIN_EXAMPLE
\rm -r x-ray-reverberation

git clone https://github.com/phajy/x-ray-reverberation.git
#+END_EXAMPLE

*Copy desired files to BlueCrystal*

For example
#+BEGIN_EXAMPLE
scp cl-setup.h so14935@bc4login.acrc.bris.ac.uk:~
#+END_EXAMPLE


*Then move the file into the desired location*
#+BEGIN_EXAMPLE
mv cl-setup.h /mnt/storage/home/so14935/x-ray-reverberation
#+END_EXAMPLE

** Transferring files to and from  BlueCrystal

*Copy to BlueCrystal*

#+BEGIN_EXAMPLE
scp file.txt username@bc4login.acrc.bris.ac.uk:~
#+END_EXAMPLE

Or for a full directory

#+BEGIN_EXAMPLE
scp -r file.txt username@bc4login.acrc.bris.ac.uk:~
#+END_EXAMPLE

*Pulling files from BlueCrystal*

#+BEGIN_EXAMPLE
scp username@bc4login.acrc.bristol.ac.uk:/mnt/storage/home/so14935/x-ray-reverberation/file.txt .
#+END_EXAMPLE

#+BEGIN_EXAMPLE
scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/best_fit_05.txt .
#+END_EXAMPLE

*Syncing files from BlueCrystal when in Lyra*

#+BEGIN_EXAMPLE
rsync -a so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/code-x /data/scratch5/steff
#+END_EXAMPLE

*Syncing new files in a directory from BlueCrystal when in Lyra*

This will sync only new files put into BC4 into the directory =Ark564-time-lag-fits=
#+BEGIN_EXAMPLE
rsync -uav so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/Ark564-time-lag-fits /data/scratch5/steff/
#+END_EXAMPLE


And to sync new lag files generated in BC4 use:

#+BEGIN_EXAMPLE
rsync -uav so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/lag-files /data/scratch5/steff/
#+END_EXAMPLE



** General info on the 2 blobs codes

See =README.md=

#+BEGIN_EXAMPLE
https://github.com/phajy/x-ray-reverberation

# x-ray-reverberation

## X-ray reverberation mapping codes

Software to perform ray tracing and reverberation calculations.

| Code              | Description                                   |
|-------------------|-----------------------------------------------|
| `blob.c`          | two blobs model code                          |
| `submit_blob.pl`  | submit two blob runs to the supercomputer     |
| `code-img.c`      | ray tracing (C)                               |
| `code-img.cl`     | ray tracing (OpenCL)                          |
| `code-s.c`        | ray tracing (C)                               |
| `code-s.cl`       | ray tracing (OpenCL)                          |
| `code-x.c`        | calculates the spectrum                       |
| `code-tl.c`       | calculates the lag-frequency                  |
| `code-tle.c`      | calculates the lag-energy spectra             |
| `code-ext-sph.c`  | spherical corona (C) [in development]         |
| `code-ext-sph.cl` | spherical corona (OpenCL) [in development]    |
| `code-x-xillv.c`  | uses the XILLVER model [in development]       |
| `reflionx.mod`    | table model containing reflection spectra     |
| `Makefile`        | Makefile used to compile the codes            |

## Notes on different codes / how to run specific tasts

### Makefile

This is the Makefile for compiling various codes on Bluecrystal phase 4 at the University of Bristol.
Note that this assumes that CFITSIO has been installed in your home directory.

Before compiling you'll need to have loaded CUDA and cURL
`module load CUDA`
`module load cURL`

### `code-img.c` and `code-img.cl`

Integrates from observer to disk.

Example ./code-img -i55 -a0.998 -r400 -s8192
Where i = inclination angle (default 30 degrees) [integer]
a = spin (default 0.998) [double]
r = outer radius (default 400) [integer]
s = image size (default 1024) [integer]

### `code-s.c` and `code-s.cl`

Integrates from single X-ray source to disk.

Example ./code-img -i55 -a0.998 -r400 -s8192
Where i = inclination angle (default 30 degrees) [integer]
a = spin (default 0.998) [double]
r = outer radius (default 400) [integer]
s = image size (default 1024) [integer]

### `blob.c`

This code calculates the reverberation signatures looking up the already computed blob to disk and observer to disk ray tracing runs.

To compile the code on Bluecrystal use `make blob`.

This model is described in [Chainakun & Young (2017)](https://ui.adsabs.harvard.edu/#abs/2017MNRAS.465.3965C).
The relevant parameters are as follows:

| Parameter | Description       | Reasonable ranges |
|-----------|-------------------|-------------------|
| o         | 1st source height | 2 - 10           |
| d         | 2nd source height | 3 - 20           |
| g         | Photon index      | 1.4 - 3.2        |
| e         | RRF1              | 0.2 - 2          |
| w         | q2                | 0.5 - 1.5        |
| v         | time max          | 200 - 2000       |
| s         | time shift        | 0 - 100          |

### `submit_blob.pl`

This Perl script instructs the supercomputer to run a grid of two blobs models. Note that it includes appropriate `module load` commands
in the PBS scripts it generates.

I think it makes most sense to run this script in the output directory because it will generate a *lot* of files!

The output will be placed in your scratch space on Bluecrystal in a sub-directory called `2-blobs-model` that you will have to create
(that'll be /mnt/storage/scratch/your_user_name/2-blobs-model`).

The script assumes the code is in your home directory in a sub-directory called `x-ray-reverberation`.

The script loops through all possible parameter combinations for the `blob` code over certain ranges and making sure that only relevant
parameter combinations are computed (e.g., requiring height of upper source > height of lower source). The explanation of the parameters
is described in the `blob.c` code.

### Running the two blobs model


1    Need to have the observer to disk integration done (run cosde-img).
2    Need to have the source to disk integration done for all of the sources we are interested in (run code-s for a range of source heights).
3    Need to calculate the spectra (run code-x for each source height).
4    Use submit-blob.pl script to run blob code for all appropriate combinations)

We need to set up the submit_blob.pl script so that it will run the two blobs model for an appropriate range of parameters.

`table-models.py``

This script takes the output of the two blobs model and make a table model that can be used to fit the data in ISIS, XSPEC, etc.

To run this Python script you need to have astropy installed and heasp which is part of the standard HEASOFT installation.
More information can be found on this web page https://heasarc.gsfc.nasa.gov/docs/software/lheasoft/headas/heasp/node3.html with a specific
example on how to generate a table model here https://heasarc.gsfc.nasa.gov/docs/software/lheasoft/headas/heasp/node9.html

#+END_EXAMPLE

** Compiling and running code


Load CUDA and cURL

#+BEGIN_EXAMPLE
module load CUDA

module load cURL

..........................................................
Note: You can see loaded modules

module list

Currently Loaded Modules:
  1) CUDA/8.0.44
  2) GCCcore/5.4.0
  3) binutils/2.26-GCCcore-5.4.0
  4) GCC/5.4.0-2.26
  5) numactl/2.0.11-GCC-5.4.0-2.26
  6) hwloc/1.11.3-GCC-5.4.0-2.26
  7) OpenMPI/1.10.3-GCC-5.4.0-2.26
  8) OpenBLAS/0.2.18-GCC-5.4.0-2.26-LAPACK-3.6.1
  9) gompi/2016b
 10) FFTW/3.3.4-gompi-2016b
 11) ScaLAPACK/2.0.2-gompi-2016b-OpenBLAS-0.2.18-LAPACK-3.6.1
 12) foss/2016b
 13) cURL/7.49.1-foss-2016b
#+END_EXAMPLE


*code-img.c*

Compile code-img.c

#+BEGIN_EXAMPLE
make code-img
#+END_EXAMPLE

Run code img.c

#+BEGIN_EXAMPLE
./code-img -i55 -a0.998 -r400 -s8192


Output file = img-i55-a0p998-r400-8192.fits
3 platforms
Platform 0 has 1 devices
Platform: 0 Device: 0 --- [Tesla P100-PCIE-16GB] [*]
Platform 1 has 1 devices
Platform: 1 Device: 0 --- [Tesla P100-PCIE-16GB]
Platform 2 has 1 devices
Platform: 2 Device: 0 --- [Intel(R) Xeon(R) CPU E5-2680 v4 @ 2.40GHz]
Using platform 0 device 0
Tesla P100-PCIE-16GB
About to build...
Reached Kernel execution
Program Failed: CL_MEM_OBJECT_ALLOCATION_FAILURE
#+END_EXAMPLE

First run failed!

obtain =submit-code-img.sh= from GitHub and then run this on normal BC
phase 4 login node:

#+BEGIN_EXAMPLE
sbatch submit-code-img.sh
#+END_EXAMPLE

/Submitted batch job 1369658/

Now to keep track of the job use  the =sacct= command

#+BEGIN_EXAMPLE
sacct -j 1369658

       JobID    JobName  Partition    Account  AllocCPUS      State ExitCode
------------ ---------- ---------- ---------- ---------- ---------- --------
1369658        code-img        gpu    default          1    PENDING      0:0


Later....

sacct -j 1369658
       JobID    JobName  Partition    Account  AllocCPUS      State ExitCode
------------ ---------- ---------- ---------- ---------- ---------- --------
1369658        code-img        gpu    default          1  COMPLETED      0:0
1369658.bat+      batch               default          1  COMPLETED      0:0

#+END_EXAMPLE

View output file =slurm-1369658.out=

#+BEGIN_EXAMPLE
Wed Oct 31 14:21:22 GMT 2018
Output file = img-i55-a0p998-r400-8192.fits
2 platforms
Platform 0 has 1 devices
Platform: 0 Device: 0 --- [Intel(R) Xeon(R) CPU E5-2680 v4 @ 2.40GHz]
Platform 1 has 2 devices
Platform: 1 Device: 0 --- [Tesla P100-PCIE-16GB] [*]
Platform: 1 Device: 1 --- [Tesla P100-PCIE-16GB]
Using platform 1 device 0
Tesla P100-PCIE-16GB
About to build...
Reached Kernel execution
Waiting for all kernels to finish
Finished command Queue
Wed Oct 31 14:45:21 GMT 2018
#+END_EXAMPLE

Copy file =img-i55-a0p998-r400-8192.fits= to my home directory to open
in ds9.

Note connection failure from BC p4 so I ciopied in the opposite way as
done below:

#+BEGIN_EXAMPLE
lyra:/homeb/steff075> scp username@bc4login.acrc.bristol.ac.uk:/mnt/storage/home/username/x-ray-reverberation/img-i55-a0p998-r400-8192.fits .
#+END_EXAMPLE

Move to a suitable location

#+BEGIN_EXAMPLE
cp img-i55-a0p998-r400-8192.fits /homeb/steff075/phd_ecm/2blobs/
#+END_EXAMPLE

Open in ds9

#+BEGIN_EXAMPLE
ds9 "img-i55-a0p998-r400-8192.fits[1]"
ds9 "img-i55-a0p998-r400-8192.fits[2]"
ds9 "img-i55-a0p998-r400-8192.fits[3]"
#+END_EXAMPLE

These correspond to the different components of the disk
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/disc_img_1.png
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/disc_img_2.png
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/disc_img_3.png

*code-s.c Ray Tracing (c)*

Integrates from single X-ray source to disk. This does require reflionx.mod to be in the directory that the code is being run from.

Example ./code-img -i55 -a0.998 -r400 -s8192 Where i = inclination
angle (default 30 degrees) [integer] a = spin (default 0.998)
[double] r = outer radius (default 400) [integer] s = image size (default 1024) [integer]

compile =code-s.c=

#+BEGIN_EXAMPLE
make code-s
#+END_EXAMPLE

Submit the job

#+BEGIN_EXAMPLE
sbatch submit-code-s.sh
#+END_EXAMPLE

/Submitted batch job 1370160/

#+BEGIN_EXAMPLE
sacct -j 1370160
       JobID    JobName  Partition    Account  AllocCPUS      State ExitCode
------------ ---------- ---------- ---------- ---------- ---------- --------
1370160          code-s        gpu    default          1    PENDING      0:0

Later...

      JobID    JobName  Partition    Account  AllocCPUS      State ExitCode
------------ ---------- ---------- ---------- ---------- ---------- --------
1370160          code-s        gpu    default          1    TIMEOUT      1:0
1370160.bat+      batch               default          1  CANCELLED     0:15

#+END_EXAMPLE

Note that this still created the following

#+BEGIN_EXAMPLE
-rw-r--r-- 1 so14935 phys 1135408320 Nov  1 08:58 s-x0-h2-a0p998-i53.fits
-rw-r--r-- 1 so14935 phys 1160798400 Nov  1 09:23 s-x0-h3-a0p998-i53.fits
-rw-r--r-- 1 so14935 phys 1127626560 Nov  1 09:51 s-x0-h4-a0p998-i53.fits
-rw-r--r-- 1 so14935 phys 1091407680 Nov  1 10:23 s-x0-h5-a0p998-i53.fits
-rw-r--r-- 1 so14935 phys 1059937920 Nov  1 10:57 s-x0-h6-a0p998-i53.fits
-rw-r--r-- 1 so14935 phys 1033657920 Nov  1 11:33 s-x0-h7-a0p998-i53.fits
-rw-r--r-- 1 so14935 phys       2912 Nov  1 11:36 slurm-1370160.out
#+END_EXAMPLE

Need to allow more time, edit =submit-code-s.sh=

#+BEGIN_EXAMPLE
#SBATCH --time=6:00:00
#+END_EXAMPLE

Resubmit
#+BEGIN_EXAMPLE
sbatch submit-code-s.sh
#+END_EXAMPLE
/Submitted batch job 1370442/

Successfully created the following fits files:

#+BEGIN_EXAMPLE
-rw-r--r-- 1 so14935 phys 1135408320 Nov  1 08:58 s-x0-h2-a0p998-i53.fits
-rw-r--r-- 1 so14935 phys 1160798400 Nov  1 09:23 s-x0-h3-a0p998-i53.fits
-rw-r--r-- 1 so14935 phys 1127626560 Nov  1 09:51 s-x0-h4-a0p998-i53.fits
-rw-r--r-- 1 so14935 phys 1091407680 Nov  1 10:23 s-x0-h5-a0p998-i53.fits
-rw-r--r-- 1 so14935 phys 1059937920 Nov  1 10:57 s-x0-h6-a0p998-i53.fits
-rw-r--r-- 1 so14935 phys 1033657920 Nov  1 11:33 s-x0-h7-a0p998-i53.fits
-rw-r--r-- 1 so14935 phys 1011651840 Nov  1 14:55 s-x0-h8-a0p998-i53.fits
#+END_EXAMPLE

*blob-c*

compile blob.c

#+BEGIN_EXAMPLE
make blob
#+END_EXAMPLE
emacs
* Run code for different inclinations for other AGN

** Generate disc image for all AGN

Moving on from 1H0707-495 with an assumed inclination angle of
53^\circ

*AGN inclination angles*
#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
| =AGN=          | =Angle/Deg= | =Reference=                                                                                                                                                  |
|----------------+-------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 1H0417-599     |          55 | Pal & Dewangan (2013) Variable X-ray reflection from 1H 0419577.MNRAS 435, 2                                                                                 |
| Ark564         |          58 | Emmanoulopoulos et al (2014), General relativistic modelling of the negative reverberation X-ray time delays in AGN. MNRAS 439,3931                          |
| IRAS13224-3809 |          64 | Fabian et al (2014), Long XMM observation of the narrow-line Seyfert 1 galaxy IRAS 13224-3809: Rapid variability, high spin and a soft lag. MNRAS 429, 2917F |
| MCG-6-30-15    |          35 | Emmanoulopoulos et al (2014), General relativistic modelling of the negative reverberation X-ray time delays in AGN. MNRAS 439, 3931-3950                    |
| Mrk335         |          45 | Chainakun and Young (2015), Simultaneous spectral and reverberation modelling of relativistic reflection in Mrk 335 MNRAS 452,333-342                        |
| Mrk766         |          38 | Emmanoulopoulos et al (2014), General relativistic modelling of the negative reverberation X-ray time delays in AGN. MNRAS 439,3931                          |
| Mrk841         |          30 | Cerruti et al. (2011), Suzaku broad band observations of the Seyfert 1 galaxies Mrk 509 and Mrk 841. A&A 535, A113                                           |
| NGC1365        |          40 | Silbermann et al. (1999), The Hubble Space Telescope Key Project on the Extragalactic Distance Scale. XIV. The Cepheids in NGC 1365. ApJ 515, 1              |
| NGC3516        |          39 | Emmanoulopoulos et al (2014), General relativistic modelling of the negative reverberation X-ray time delays in AGN. MNRAS 439,3931                          |
| NGC4051        |          31 | Emmanoulopoulos et al (2014), General relativistic modelling of the negative reverberation X-ray time delays in AGN. MNRAS 439,3931                          |
| NGC4151        |         <30 | Cacket, E.M., et al (2014), Modelling the broad Fe Kα reverberation in the AGN NGC 4151. MNRAS 438, 2980-2994                                                |
| NGC4395        |          38 | Akyuz et al. (2013), XMM-Newton observations of luminous sources in nearby galaxies NGC 4395, NGC 4736 and NGC 4258. MNRAS 431, 2441-2452                    |
| NGC5548        |          47 | Emmanoulopoulos et al (2014), General relativistic modelling of the negative reverberation X-ray time delays in AGN. MNRAS 439,3931                          |
| NGC6860        |          40 | This research - see NGC6860 Spectral fitting                                                                                                                 |
| NGC7314        |          10 | Zoghbi et al (2013), Discovery of Fe Kα X-Ray reverberation around the blackk holes in MCG-5-23-16 AND NGC7314. ApJ 767:121                                  |
| NGC7469        |          26 | Emmanoulopoulos et al (2014), General relativistic modelling of the negative reverberation X-ray time delays in AGN. MNRAS 439,3931                          |
| PG1211+143     |          30 | Janiuk et al. (2001), Spectral properties of the Narrow-Line Seyfert 1 Quasar PG1211+1432001astro.ph.12387J                                                  |
| PG1244+026     |          38 | Kara et al (2014), The curious time lags of PG 1244+026: discovery of the iron K reverberation lag MNRAS 439, L26-30                                         |
| PG1247+267     |          30 | Page et al. (2004), XMM-Newton observations of high-luminosity radio-quiet quasi-stellar objects. MNRAS 353, 133                                             |

Based on the above information I ran the disc image for angles

10, 30, 35, 40, 45 and 60

To do this, first edit =submit-code-img.sh=, e.g:

#+BEGIN_EXAMPLE
#!/bin/bash -login
#SBATCH --nodes=1
#SBATCH --gres=gpu:2
#SBATCH --partition gpu
#SBATCH --mem=64GB
#SBATCH --time=1:00:00
#SBATCH --job-name=code-img

module load CUDA
module load cURL

cd $SLURM_SUBMIT_DIR

# Integrations from observer to disk
date
./code-img -i10 -a0.998 -r400 -s8192
date
#+END_EXAMPLE

Run for all angles and obtain the folowing files:

#+BEGIN_EXAMPLE
img-i10-a0p998-r400-8192.fits
img-i30-a0p998-r400-8192.fits
img-i35-a0p998-r400-8192.fits
img-i40-a0p998-r400-8192.fits
img-i45-a0p998-r400-8192.fits
img-i53-a0p998-r400-8192.fits
img-i60-a0p998-r400-8192.fits
                                                                                                                                                                                                                                                                                                                |

Now check these files have run by opening in ds9 e.g:

ds9 "img-i30-a0p998-r400-8192.fits[1]"
ds9 "img-i30-a0p998-r400-8192.fits[2]"
#+END_EXAMPLE


The above img files were also copied to =/homeb/steff075/phd_ecm/ecm-files=

This image =PATH=/homeb/steff075/phd_ecm/ecm-files/= shows the 3
extensions for 30 deg (top row) and 60 deg (bottom row). The top right
img (ext[3]) seems to be showing z = 1.03872 when mouse hovered to the
left of the black hole.
#+ATTR_ORG: :width 1200
#+ATTR_HTML: :width 1200
http://www.star.bris.ac.uk/steff/ecm/img-30-60-2.png

Also - this image =PATH=/homeb/steff075/phd_ecm/ecm-files/= shows the
3 extensions for 30 deg (top row) and 60 deg (bottom row). The bottom
right img (ext[3]) seems to be showing z = 1.20207 when mouse hovered
to the left of the black hole (mouse pointer not seen in screenshot).
#+ATTR_ORG: :width 1200
#+ATTR_HTML: :width 1200
http://www.star.bris.ac.uk/steff/ecm/img-30-60.png

** Rerun code-s for new values of /i/

Now edit and run =code-s.c=

#+BEGIN_EXAMPLE
./code-s -a0.998 -h2.0 -i45 -p1

Output file=code-s-files/s-x0-h2-a0p998-i45.fits
Program Failed: CL_INVALID_VALUE

>>> This error occurs no matter what the value of i

Errors >
clEnqueueWriteBuffer returns CL_SUCCESS if the function is executed successfully. Otherwise, it returns one of the following errors:

    CL_INVALID_COMMAND_QUEUE if command_queue is not a valid command-queue.
    CL_INVALID_CONTEXT if the context associated with command_queue and buffer are not the same or if the context associated with command_queue and events in event_wait_list are not the same.
    CL_INVALID_MEM_OBJECT if buffer is not a valid buffer object.
    CL_INVALID_VALUE if the region being written specified by (offset, size) is out of bounds or if ptr is a NULL value or if size is 0.
    CL_INVALID_EVENT_WAIT_LIST if event_wait_list is NULL and num_events_in_wait_list greater than 0, or event_wait_list is not NULL and num_events_in_wait_list is 0, or if event objects in event_wait_list are not valid events.
    CL_MISALIGNED_SUB_BUFFER_OFFSET if buffer is a sub-buffer object and offset specified when the sub-buffer object is created is not aligned to CL_DEVICE_MEM_BASE_ADDR_ALIGN value for device associated with queue.
    CL_EXEC_STATUS_ERROR_FOR_EVENTS_IN_WAIT_LIST if the read and write operations are blocking and the execution status of any of the events in event_wait_list is a negative integer value.
    CL_MEM_OBJECT_ALLOCATION_FAILURE if there is a failure to allocate memory for data store associated with buffer.
    CL_INVALID_OPERATION if clEnqueueWriteBuffer is called on buffer which has been created with CL_MEM_HOST_READ_ONLY or CL_MEM_HOST_NO_ACCESS.
    CL_OUT_OF_RESOURCES if there is a failure to allocate resources required by the OpenCL implementation on the device.
    CL_OUT_OF_HOST_MEMORY if there is a failure to allocate resources required by the OpenCL implementation on the host.

Ref: https://www.khronos.org/registry/OpenCL/sdk/1.2/docs/man/xhtml/clEnqueueWriteBuffer.html
#+END_EXAMPLE

Try again in GPU queue

#+BEGIN_EXAMPLE
#! /bin/tcsh
#SBATCH --nodes=1
#SBATCH --gres=gpu:2
#SBATCH --partition gpu
#SBATCH --mem=64GB
#SBATCH --time=1:00:00
#SBATCH --job-name=code-img

module load CUDA
module load cURL

cd $SLURM_SUBMIT_DIR

# Integrations from observer to disk
date
./code-img -i10 -a0.998 -r400 -s8192
date
#+END_EXAMPLE

Now in BC4 PATH
=/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/img-files=

These have also been copied to Lyra =/homeb/steff075/phd_ecm/ecm-files=

#+BEGIN_EXAMPLE
ls -l -h
total 15G
-rw-r--r-- 1 so14935 phys 2.1G Aug 12 11:06 img-i10-a0p998-r400-8192.fits
-rw-r--r-- 1 so14935 phys 2.1G Aug 12 11:05 img-i30-a0p998-r400-8192.fits
-rw-r--r-- 1 so14935 phys 2.1G Aug 12 11:04 img-i35-a0p998-r400-8192.fits
-rw-r--r-- 1 so14935 phys 2.1G Aug 12 11:02 img-i40-a0p998-r400-8192.fits
-rw-r--r-- 1 so14935 phys 2.1G Aug 12 11:01 img-i45-a0p998-r400-8192.fits
-rw-r--r-- 1 so14935 phys 2.1G Apr 30 10:54 img-i53-a0p998-r400-8192.fits
-rw-r--r-- 1 so14935 phys 2.1G Aug 12 11:00 img-i60-a0p998-r400-8192.fits
#+END_EXAMPLE
emacs
* ECM Working Log
The HPC project code is PHYS009521 which is for “X-ray emission from accreting black holes”

My working directory login via =ssh -X
username@bc4gpulogin.acrc.bris.ac.uk=

Working space is =/mnt/storage/scratch/so14935/x-ray-reverberation=

*Opened 3 Dec 2018*
Makefile: This is the Makefile for compiling various codes on Bluecrystal phase 4 at the University of Bristol. Note that this assumes that CFITSIO has been installed in your home directory.

Before compiling you'll need to have loaded CUDA and cURL module load CUDA module load cURL

Cloned updated Github file in BC4 gpu login:

#+BEGIN_EXAMPLE
ssh -X user@bc4gpulogin.acrc.bris.ac.uk -X

\rm -r x-ray-reverberation

git clone https://github.com/phajy/x-ray-reverberation

module load CUDA
module load cURL
#+END_EXAMPLE

** Updating Scripts from other directories
To copy everything from my machine over to Bluecrystal I use rsync
rather than GitHub because that can be quite confusing. I edit
everything on my desktop computer then copy to BC.
I don’t bother with GitHub on BC (but I _do_ commit thing to GitHub
from my desktop).
On BC you can try this code. “-arv” says to create an archive (so time
stamps aren’t changed), r is recursive and v is verbose.
This assumes the code on your desktop machine in your home directory
is up to date with GitHub.

*First* - ensure that my home directory is up to dtae with GitHub, so
on my machine (Lyra)...

#+BEGIN_EXAMPLE
cd /homeb/steff075

git clone https://github.com/phajy/x-ray-reverberation
#+END_EXAMPLE

And then in my BC4 directory:

#+BEGIN_EXAMPLE
rsync -arv so14935@lyra.star.bris.ac.uk:/homeb/so14935/x-ray-reverberation
#+END_EXAMPLE

This caused an error :

#+BEGIN_EXAMPLE
ssh_exchange_identification: read: Connection reset by peer
rsync: connection unexpectedly closed (0 bytes received so far) [Receiver]
rsync error: unexplained error (code 255) at io.c(605) [Receiver=3.0.9]

#+END_EXAMPLE

*Update a specific script*

I want to update the script =submit-code-x.pl=, so I can just copy that file to my BC4 directory

In /homeb/so14935/x-ray-reverberation

#+BEGIN_EXAMPLE
scp submit-code-x.pl so14935@bc4login.acrc.bris.ac.uk:~
#+END_EXAMPLE

Then move script into desired directory

#+BEGIN_EXAMPLE
cp submit-code-x.pl /mnt/storage/scratch/so14935/x-ray-reverberation
#+END_EXAMPLE

The new script will appear in the x-ray-reverberation /working/ directory

Done!!

** Compile and run code
*** Compile code-img.c
Integrates from observer to disk.

Example ./code-img -i53 -a0.998 -r400 -s8192
Where i = inclination angle (default 30 degrees) [integer] a = spin
(default 0.998) [double]
r = outer radius (default 400) [integer] s = image size (default 1024) [integer]
#+BEGIN_EXAMPLE
make code-img

sbatch submit-code-img.sh

#+END_EXAMPLE

Run image with the agreed parameters

#+BEGIN_EXAMPLE
./code-img -i53 -a0.998 -r400 -s8192

Output file = img-i53-a0p998-r400-8192.fits
3 platforms
Platform 0 has 1 devices
Platform: 0 Device: 0 --- [Tesla P100-PCIE-16GB] [*]
Platform 1 has 1 devices
Platform: 1 Device: 0 --- [Tesla P100-PCIE-16GB]
Platform 2 has 1 devices
Platform: 2 Device: 0 --- [Intel(R) Xeon(R) CPU E5-2680 v4 @ 2.40GHz]
Using platform 0 device 0
Tesla P100-PCIE-16GB
About to build...
Reached Kernel execution
Waiting for all kernels to finish
Finished command Queue
#+END_EXAMPLE

Run the code

#+BEGIN_EXAMPLE
sbatch submit-code-img.sh

Submitted batch job 1685233

sacct -j 1685233

       JobID    JobName  Partition    Account  AllocCPUS      State ExitCode
------------ ---------- ---------- ---------- ---------- ---------- --------
1685233        code-img        gpu    default          1  COMPLETED      0:0
1685233.bat+      batch               default          1  COMPLETED      0:0
#+END_EXAMPLE

Note output file was

#+BEGIN_EXAMPLE
img-i53-a0p998-r400-8192.fits
#+END_EXAMPLE

This can be opened (in your home directory) in ds9 by: (note ds9 not
on BC4), so copy img file into your working-home directory at /homeb/steff075/phd_ecm/2blobs

#+BEGIN_EXAMPLE
cd /homeb/steff075/phd_ecm/2blobs

scp username@bc4login.acrc.bristol.ac.uk:/mnt/storage/home/so14935/x-ray-reverberation/img-i53-a0p998-r400-8192.fits .
#+END_EXAMPLE

#+BEGIN_EXAMPLE
ds9 "img-i53-a0p998-r400-8192.fits[1]"
ds9 "img-i53-a0p998-r400-8192.fits[2]"
ds9 "img-i53-a0p998-r400-8192.fits[3]"
#+END_EXAMPLE

I now have the disc component images !

*** Compile code-s.c

Integrates from single X-ray source to disk. This does require reflionx.mod to be in the directory that the code is being run from.

Where i = inclination angle (default 30 degrees) [integer] a = spin
(default 0.998) [double]
r = outer radius (default 400) [integer] s = image size (default 1024) [integer]
#+BEGIN_EXAMPLE
make code-s
#+END_EXAMPLE

Run the code
#+BEGIN_EXAMPLE
./code-s -a0.998 -h2.0 -i53 -p1

Output file=s-x0-h2-a0p998-i53.fits
3 platforms
Platform 0 has 1 devices
Platform: 0 Device: 0 --- [Tesla P100-PCIE-16GB] [*]
Platform 1 has 1 devices
Platform: 1 Device: 0 --- [Tesla P100-PCIE-16GB]
Platform 2 has 1 devices
Platform: 2 Device: 0 --- [Intel(R) Xeon(R) CPU E5-2680 v4 @ 2.40GHz]
Using platform 0 device 0
Tesla P100-PCIE-16GB
About to build...
Reached Kernel execution
Waiting for all kernels to finish
Finished command Queue
#+END_EXAMPLE

Note that the output file was:

#+BEGIN_EXAMPLE
s-x0-h2-a0p998-i53.fits
#+END_EXAMPLE

Now you can run script =submit-code-s.sh= to run for heights 4 - 9 inclusive

#+BEGIN_EXAMPLE
sbatch submit-code-s.sh
#+END_EXAMPLE
/Submitted batch job 1685251/

At this stage I now have the following files in my BC4 directory:

#+BEGIN_EXAMPLE
[so14935@bc4gpulogin1 x-ray-reverberation]$ ls
Makefile         code-s          create_general_table.pl        submit-blob.pl
README.md        code-s-pp.c     img-i53-a0p998-r400-8192.fits  submit-code-img.sh
blob.c           code-s-pp.cl    reflionx.mod                   submit-code-s.sh
cl-setup.c       code-s.c        s-x0-h2-a0p998-i53.fits        submit-code-x.pl
cl-setup.h       code-s.cl       s-x0-h3-a0p998-i53.fits        submit-code-x.sh
cl-setup.o       code-s.o        s-x0-h4-a0p998-i53.fits        submit-python.sh
code-ext-sph.c   code-tl.c       s-x0-h5-a0p998-i53.fits        submit-scripts
code-ext-sph.cl  code-tle.c      s-x0-h6-a0p998-i53.fits        submit.sh
code-img         code-x          s-x0-h7-a0p998-i53.fits        table-models.py
code-img.c       code-x-xillv.c  s-x0-h8-a0p998-i53.fits        x-h4-a0p998-i53-g2-A1-x0-p0.fits
code-img.cl      code-x.c        s-x0-h9-a0p998-i53.fits
code-img.o       code-x.o        setup_table.sl

#+END_EXAMPLE

*** Run code-x.c

This calculates the spectra for a given source height and disk inclination that have already been computed.

Example ./code-x -i53.0 -h4.0 -g2.0 -A1.0 -x0.0 -p0.0

Where i = inclination angle [double] g = photon index [double] A =
iron abundance [double]
x = log_10 (ionization parameter) [double] p = index of disk density profile [double]

The ionization parameter is specified at the innermost stable circular
orbit.
The density drops off as $r^{-p}$, and this goes into the calculation of the ionization parameter at an arbitrary radius.

N.B. spin=0.998 is currently hard-wired in $r_{out} = 400$ is currently hard-wired in [?] img_size=400 is currently hard-wired in [?] not sure if this is used?
Note we need to calculate the spectra (run code-x for each source
height)

Gamma=2.5, 2.7, 2.9, 3.1, 3.3, h=2,3,4,5,6,7,8,9 and log_10 (xi) = 2, 2.5, 3.

log_10 (xi)=0,0.5,1,1.5,2,2.5,3

fixing p = 0 should be fine (meaning that the disc density is constant)

Example for one set of parameters:
#+BEGIN_EXAMPLE
./code-x -i53.0 -h4.0 -g2.0 -A1.0 -x0.0 -p0.0

----> spectral file
x-x0-h4-a0p998-i53-g2-A1-x0-p0.fits
#+END_EXAMPLE

*** Run submit-code-x.pl

This Perl script instructs the supercomputer to run a grid of code-x runs for different source heights, photon indices and ionization parameters.
Run by typing
#+BEGIN_EXAMPLE
./submit-code-x.pl
#+END_EXAMPLE

Note that this code assumes the GitHub repository (and compiled code)
is in your home directory on BlueCrystal and that the output directory
is in /mnt/storage/scratch/${LOGNAME}/2-blob-output where ${LOGNAME}
is your login id.
The output directory should itself contain a directory called submit-scripts where the auto-generated scripts are stored.
So Output Directory is:


Just for testing I didn’t want to produce too many files, so I’ve
restricted

Gamma=2.5, 2.7, 2.9, 3.1, 3.3, h=2,3,4,5,6,7,8,9 and log_10 (xi) = 2, 2.5, 3.

Note on BC4 my pwd =/mnt/storage/scratch/so14935/x-ray-reverberation=

#+BEGIN_EXAMPLE
./submit-code-x.pl
#+END_EXAMPLE

*** Compile blob.c
This code calculates the reverberation signatures looking up the already computed blob to disk and observer to disk ray tracing runs.

To compile the code on Bluecrystal use make blob.
#+BEGIN_EXAMPLE
make blob
#+END_EXAMPLE
/make: `blob' is up to date./

*** Run submit-blob.pl

This Perl script instructs the supercomputer to run a grid of two blobs models. Note that it includes appropriate module load commands in the PBS scripts it generates.

I think it makes most sense to run this script in the output directory because it will generate a lot of files!

The output will be placed in your scratch space on Bluecrystal in a sub-directory called 2-blobs-model that you will have to create (that'll be /mnt/storage/scratch/your-user-name/2-blobs-model`).

The script assumes the code is in your home directory in a sub-directory called x-ray-reverberation.

The script loops through all possible parameter combinations for the blob code over certain ranges and making sure that only relevant parameter combinations are computed (e.g., requiring height of upper source > height of lower source). The explanation of the parameters is described in the blob.c code.

#+BEGIN_EXAMPLE
./submit-blob.pl
#+END_EXAMPLE

This will submit all the blob code scripts, for example:

#+BEGIN_EXAMPLE
sbatch submit-scripts/blob-0000.csh
sbatch submit-scripts/blob-0001.csh
sbatch submit-scripts/blob-0002.csh
...........etc------->blob-0062.csh
#+END_EXAMPLE

Note this will create all the fits files as follows:

#+BEGIN_EXAMPLE
lag2b-h2+3-a0p998-i53-g2p5+2p5-A1-x2-p0-rs1+1-b1-q0p5-tmax1000-tshift0.fits
lag2b-h2+3-a0p998-i53-g2p5+2p5-A1-x2-p0-rs1+1-b2-q0p5-tmax1000-tshift0.fits
lag2b-h2+3-a0p998-i53-g2p5+2p5-A1-x2-p0-rs1+1-b3-q0p5-tmax1000-tshift0.fits
........................etc ----------------->
expect a great deal of these to be stored in the 2-blobs-model sub-directory
#+END_EXAMPLE

After running all code I have =4033= lag2b* files in my
=2-blobs-model= directory

** Astropy, Anaconda & HEASOFT on BC4
/REF: email dated 9 Jan 2019 for job I1812-9103 Installation of software on BC P4/

First ensure that these are not pointed to another directory in you
bashrc file i.e. emacs .bashrc

*Anaconda, Astropy and HEASOFT are installed on BC 4 in a module called:*

#+BEGIN_EXAMPLE
apps/heasoft/6.25
#+END_EXAMPLE

#+BEGIN_EXAMPLE
module add apps/heasoft/6.25
module list


Currently Loaded Modules:
1) languages/java/sdk-1.8.0.141 2) languages/anaconda3/2018.12 3) apps/heasoft/6.25
#+END_EXAMPLE

#+BEGIN_EXAMPLE
which heasim

/mnt/storage/software/apps/Heasoft-6.25/x86_64-pc-linux-gnu-libc2.17/bin/heasim

which skyback

/mnt/storage/software/apps/Heasoft-6.25/x86_64-pc-linux-gnu-libc2.17/bin/skyback
#+END_EXAMPLE

Note that my bashrc file currently reads:

Access via BC4 home directory =emacs .bashrc=

#+BEGIN_EXAMPLE
# .bashrc

# Source global definitions
if [ -f /etc/bashrc ]; then
	. /etc/bashrc
fi

# Uncomment the following line if you don't like systemctl's auto-paging feature:
# export SYSTEMD_PAGER=

# User specific aliases and functions

# Add locally built modules
# -callum

module use /mnt/storage/easybuild/modules/local

module load tools/git/2.18.0
# added by Anaconda3 5.3.1 installer
# >>> conda init >>>
# !! Contents within this block are managed by 'conda init' !!
__conda_setup="$(CONDA_REPORT_ERRORS=false '/mnt/storage/home/so14935/anaconda3/bin/conda' shell.bash hook 2> /dev/null)"
if [ $? -eq 0 ]; then
    \eval "$__conda_setup"
else
    if [ -f "/mnt/storage/home/so14935/anaconda3/etc/profile.d/conda.sh" ]; then
        . "/mnt/storage/home/so14935/anaconda3/etc/profile.d/conda.sh"
        CONDA_CHANGEPS1=false conda activate base
    else
        \export PATH="/mnt/storage/home/so14935/anaconda3/bin:$PATH"
    fi
fi
unset __conda_setup
# <<< conda init <<<

# added by Anaconda3 installer
export PATH="/mnt/storage/home/so14935/anaconda3/bin:$PATH"

#+END_EXAMPLE

*** Local installation procedures
**** Install Anaconda on BC4

Go to https://www.anaconda.com/download

Download Anaconda 5.3.1 For Linux Installer - Python 3.7 version

Copy the Installer file to your home directory in BC4

#+BEGIN_EXAMPLE
scp -r  Anaconda3-5.3.1-Linux-x86_64.sh so14935@bc4gpulogin.acrc.bris.ac.uk:~
#+END_EXAMPLE
/This will take a few moments/

For installation see: http://docs.anaconda.com/anaconda/install/linux/
Or follow procedure below:

Verify full version is downloaded, i.e.

#+BEGIN_EXAMPLE
md5sum Anaconda3-5.3.1-Linux-x86_64.sh
334b43d5e8468507f123dbfe7437078f  Anaconda3-5.3.1-Linux-x86_64.sh
#+END_EXAMPLE
/This matched the Hashes for Anaconda3-5.3.1-Linux-x86_64.sh/

Enter the following to install Anaconda for Python 3.7:

#+BEGIN_EXAMPLE
bash ~/Anaconda3-5.3.1-Linux-x86_64.sh
#+END_EXAMPLE

After typing yes to the license aggreement you will see:
#+BEGIN_EXAMPLE
Anaconda3 will now be installed into this location:
/mnt/storage/home/so14935/anaconda3

  - Press ENTER to confirm the location
  - Press CTRL-C to abort the installation
  - Or specify a different location below

[/mnt/storage/home/so14935/anaconda3] >>>
PREFIX=/mnt/storage/home/so14935/anaconda3
installing: python-3.7.0-hc3d631a_0 ...
Python 3.7.0 (default, Jun 28 2018, 13:15:42)
#+END_EXAMPLE

Enter `Yes' and let the installation complete

I was unable to install the Microsoft VS Code at this time.

Once above is complete restart your terminal or:

#+BEGIN_EXAMPLE
source ~/.bashrc
#+END_EXAMPLE

Finally enter

#+BEGIN_EXAMPLE
anaconda-navigator
#+END_EXAMPLE

Note this will require -X

Furthermore, note that this will use up a lot of disk space so check
your quota

#+BEGIN_EXAMPLE
mmlsquota --block-size auto

                        Block Limits                                               |     File Limits
Filesystem Fileset    type         blocks      quota      limit   in_doubt    grace |    files   quota    limit in_doubt    grace  Remarks
gpfs       root       USR         no limits
gpfs       home       USR          8.809G        19G        20G     208.5M     none |    72119       0        0       83     none
gpfs       scratch    USR          11.87G       510G       512G          0     none |     4389       0        0        0     none
gpfs       private-mrcieu USR         no limits
gpfs       private-crab USR         no limits
gpfs       private-mulholland_group USR         no limits
gpfs       private-fluids USR         no limits
gpfs       private-bridge USR         no limits
gpfs       private-epxlp USR         no limits
gpfs       private-acrg USR         no limits
gpfs       NJT_grp_space USR         no limits
#+END_EXAMPLE

**** Install Astropy on BC4

*Astropy* see: http://docs.astropy.org/en/stable/install.html

If you already have Anaconda installed try the following:

#+BEGIN_EXAMPLE
conda update astropy
#+END_EXAMPLE

#+BEGIN_EXAMPLE
pip install astropy
#+END_EXAMPLE

Otherwise:

#+BEGIN_EXAMPLE
git clone --recursive git://github.com/astropy/astropy.git
#+END_EXAMPLE

Then move to =Astropy= directory

#+BEGIN_EXAMPLE
python setup.py install
#+END_EXAMPLE

Testing Astropy

#+BEGIN_EXAMPLE
[so14935@bc4gpulogin1 ~]$ python
Python 3.7.0 (default, Jun 28 2018, 13:15:42)
[GCC 7.2.0] :: Anaconda, Inc. on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> import astropy
>>>
#+END_EXAMPLE

Updating Astropy

#+BEGIN_EXAMPLE
conda update astropy
#+END_EXAMPLE

Re-check quota

#+BEGIN_EXAMPLE
mmlsquota --block-size auto
                         Block Limits                                               |     File Limits
Filesystem Fileset    type         blocks      quota      limit   in_doubt    grace |    files   quota    limit in_doubt    grace  Remarks
gpfs       root       USR         no limits
gpfs       home       USR          11.87G        19G        20G          0     none |    92084       0        0        0     none
gpfs       scratch    USR          11.87G       510G       512G          0     none |     4389       0        0        0     none

#+END_EXAMPLE

**** Install HEASOFT on BC4

*HEASP* see: https://heasarc.gsfc.nasa.gov/docs/software/lheasoft/headas/heasp/node3.html

This is part of the HEASOFT package - the complete source code (2.4
GB) can be downloaded from
https://heasarc.gsfc.nasa.gov/FTP/software/lheasoft/release/heasoft-6.25src.tar.gz

#+BEGIN_EXAMPLE
wget https://heasarc.gsfc.nasa.gov/FTP/software/lheasoft/release/heasoft-6.25src.tar.gz
#+END_EXAMPLE
/This may take up to 20 hours/

Recommend using detachable screen in case of connection issues:
#+BEGIN_EXAMPLE
screen

wget https://heasarc.gsfc.nasa.gov/FTP/software/lheasoft/release/heasoft-6.25src.tar.gz

=Ctrl-AD=

[so14935@bc4gpulogin1 ~]$ screen -ls
There is a screen on:
        25765.pts-33.bc4gpulogin1       (Detached)
1 Socket in /var/run/screen/S-so14935

To reattach later:

screen -r 25765.pts-33.bc4gpulogin1

........still running...........
#+END_EXAMPLE

** Building Table Models

Log into BC4 =/mnt/storage/scratch/so14935/x-ray-reverberation/= and load the heasoft and anaconda modules (if not already loaded)

#+BEGIN_EXAMPLE
ssh -X user@bc4gpulogin.acrc.bris.ac.uk -X

cd /mnt/storage/scratch/so14935/x-ray-reverberation

module load apps/heasoft/6.25
module load languages/anaconda3/2018.12
module load languages/java/sdk-1.8.0.141

module list

Currently Loaded Modules:
  1) tools/git/2.18.0   2) apps/heasoft/6.25   3) languages/anaconda3/2018.12   4) languages/java/sdk-1.8.0.141
#+END_EXAMPLE

See:  https://heasarc.gsfc.nasa.gov/docs/software/lheasoft/headas/heasp/node9.html


The script =table-models.py= will read over all the lag.fits files
created by the =submit.blob.pl= script

Note these are located on BC4 at
=/mnt/storage/scratch/so14935/x-ray-reverberation/2-blobs-model=

To check how many files you have here:
#+BEGIN_EXAMPLE
[so14935@bc4gpulogin1 x-ray-reverberation]$ find 2-blobs-model -type f | wc -l
4032
[so14935@bc4gpulogin1 x-ray-reverberation]$
#+END_EXAMPLE

*The first table model build*

See below chapter Scripts/2 blobs scripts/Table models for the script
text =table-models.py= which was run for 1H 0707-495. The script was run for
pre-determined values obtained by the spectral fitting procedure and
the output was the =reverb.mod= table model. Note this was run on Andys machine as he had the good versions of
HEASOFT etc. The Table model was then copied back to the Linux home
directory.

This is fitted to a spectrum (lag-frequency fits and response files e.g
=fully_comb_time_lags.fits= and =fully_comb_time_lags.rsp=) by the script =setup_table.sl=
 which was edit for this model and this also used  =tlag.par= as the
parameter file. You can see examples of these below in the scripts
section at scripts/Extended Corona fitting scripts.

*/Lets have a look at the table model/*

Opening in topcat reveals 3 tables:
#+attr_html: :border 4 :rules None :frame border :width 62%
| Table        | Name       | Rows | Columns | Contents                             |
|--------------+------------+------+---------+--------------------------------------|
| reverb.mod   | PARAMETERS |   14 |   10    | Model parameters and vaules          |
|              |            |      |         |                                      |
| reverb.mod-2 | ENERGIES   |  490 |    2    | The hi and lo energy values          |
|              |            |      |         | Lo energy = *1e-05 - 0.776247*       |
|              |            |      |         | Hi energy = *1.02329e-05 - 0.794328* |
|              |            |      |         |                                      |
| reverb.mod-3 | SPECTRA    | 8064 |    2    | PARAMVAL and INTPSPEC values         |


http://www.star.bris.ac.uk/steff/ecm/table_mod_all.png

This table model can be used in ISIS via the XSPEC-format additive
table model function and defines the fit-function based on the table,
for example:

#+BEGIN_EXAMPLE
add_atable_model ("table.mod", "tlag");
fit_fun ("tlag");
#+END_EXAMPLE

This model was loaded into ISIS via the =setup_table.sl= script and
the script hit a fault when attempting to evaluate the counts;

#+BEGIN_EXAMPLE
load_par("tlag.par");
() = eval_counts;

 XSPEC is buggy:  Segmentation Fault while in an XSPEC function.
#+END_EXAMPLE

/What does segmentation fault mean?/

A segmentation fault (aka segfault) is a common condition that causes
programs to crash; they are often associated with a file named
core.Segfaults are cused by a program trying to read or write an
illegal memory location. In other words, a segmentation fault is a memory error in which a program tries to
access a memory address that does not exist or the program does not
have the rights to access.


There is a problem with the table model scaling function in XSPEC.

** Testing the lag frequency model

The lag- frequency fits files for 1H0707-495 (with agreed parameter
ranges) is located at

=/mnt/storage/scratch/so14935/x-ray-reverberation/2-blobs-model=

To list how many files are in the directory:

#+BEGIN_EXAMPLE
ls -1 | wc -l
4032
#+END_EXAMPLE

Copy this directory to my Linux mnachine "Lyra"
Note this command is executed on my Lyra machine and will PULL the
directory from BC4.
#+BEGIN_EXAMPLE
scp -r username@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-reverberation/2-blobs-model /homeb/steff075/Documents/x-ray-reverberation
#+END_EXAMPLE

/The above is currently required as ISIS not available on BC4/

Now, in my home directory I have:

#+BEGIN_EXAMPLE
lyra:/homeb/steff075/Documents/x-ray-reverberation> ls
2-blobs-model    code-s.c        create_general_table.pl    setup_table_1.sl       submit-scripts
blob.c           code-s.cl       fully_comb_time_lags.fits  setup_table_noMASS.sl  submit.sh
cl-setup.c       code-s-pp.c     fully_comb_time_lags.rsp   setup_table.sl         table_mod_all.png
cl-setup.h       code-s-pp.cl    Makefile                   submit-blob.pl         table-models.py
code-ext-sph.c   code-tl.c       model-log.md               submit-code-img.sh     table_model_test.py
code-ext-sph.cl  code-tle.c      README.md                  submit-code-s.sh       tlag_noMASS.par
code-img.c       code-x.c        reflionx.mod               submit-code-x.pl       tlag.par
code-img.cl      code-x-xillv.c  reverb.mod                 submit-python.sh
#+END_EXAMPLE

Note the Directiry =2-blobs-model= contains all 4032 lag-frequency
fits files

Lets have a look at the model by examinimg 2 random fits files:

Run in =/homeb/steff075/Documents/x-ray-reverberation/2-blobs-model=

#+BEGIN_EXAMPLE
tm2 = fits_read_table ("lag2b-h2+6-a0p998-i53-g2p7+2p5-A1-x2-p0-rs1+1-b1-q0p5-tmax1000-tshift0.fits");
tm3 = fits_read_table ("lag2b-h2+5-a0p998-i53-g3p1+2p5-A1-x2p5-p0-rs1+1-b2-q0p5-tmax1000-tshift0.fits");

xlog;
ylin;
popt.res = 1;
charsize(1.2);
ylabel("Time Lag (t_g)");
xlabel("Frequency (Hz)");
title("1H0707-495 Extended Corona Model");
connect_points(1);
plotxy(tm3.fq,tm3.lag;dcol=2,dsym=1);
plotxy(tm2.fq,tm2.lag;dcol=1,dsym=1,oplt=1);

_pgqcf (2); %make font roman
_pgsfs(3);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

Now lets create csv files for useage in Veusz:

#+BEGIN_EXAMPLE
fp = fopen("plot_ecm_model_lf_tm2.csv", "w");
() = fprintf(fp,"tm2.fq,tm2.lag\n");
variable i;
for (i=0; i<length(tm2.fq); i++) {
    () = fprintf(fp,"%e,%e\n", tm2.fq[i],tm2.lag[i]);
}
fclose(fp);


fp = fopen("plot_ecm_model_lf_tm3.csv", "w");
() = fprintf(fp,"tm3.fq,tm3.lag\n");
variable i;
for (i=0; i<length(tm2.fq); i++) {
    () = fprintf(fp,"%e,%e\n", tm3.fq[i],tm3.lag[i]);
}
fclose(fp);
#+END_EXAMPLE
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/ECM_fits_test.jpg

*Photon Index*

The model can produce both high frequency positive lags and the low
frequency negative lags if \Gamma_1 \neq \Gamma_2

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_ECM_Gamma.jpg

** Run NEW  blob.c code

=cd /mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/=

Update from =blob.c= from Github and then provide the best parameter
ranges in the submit -blob.pl code.

#+BEGIN_EXAMPLE
emacs submit-blob.pl

#! /usr/bin/perl -w

use strict;

# Parameters for 1H 0707-405
my $epsilon = 0.001;
# First source height ("o")
my $first_source_height_low = 2.0;              # low value
my $first_source_height_high = 9.0;             # high value
my $source_height_delta = 1.0;                  # step size (same for both sources)
# First source height ("d")
my $second_source_height_low = $first_source_height_low + $source_height_delta;
my $second_source_height_high = $first_source_height_high;
# Inclination angle of disk ("i")
my $inclination_low = 53.0;
my $inclination_high = 53.0;
my $inclination_delta = 1.0;
# Photon index of first source ("g")
my $first_source_photon_index_low = 1.5;
my $first_source_photon_index_high = 3.1;
my $first_source_photon_index_delta = 0.1;
# Photon index of second source ("e")
my $second_source_photon_index_low = 1.5;
my $second_source_photon_index_high = 3.1;
my $second_source_photon_index_delta = 0.1;
# Iron abundance ("A")
my $iron_abund_low = 1.0;
my $iron_abund_high = 3.0;
my $iron_abund_delta = 0.2;
# Ionization parameter ("x")
my $xi_low = 0.0;
my $xi_high = 3.0;
my $xi_delta = 0.5;
# Density profile index ("p") - density goes as r^-p
my $density_low = 0.0;
my $density_high = 0.0;
my $density_delta = 0.1;
# We're setting "y" and "l" to 1.0 which are the RRF for sources 1 and 2, respectively
# Brightness parameter is ratio of brightness of 2nd source compared to 1st
my $brightness_low = 1.0;
my $brightness_high = 3.0;
my $brightness_delta = 1.0;
# "q2" (q1 is fixed at 1)
my $q2_low = 0.5;
my $q2_high = 1.5;
my $q2_delta = 0.1;
# "v" is tmax;
my $tmax_low = 100.0;
my $tmax_high = 1000.0;
my $tmax_delta = 25.0;
# "q" is the time shift between first and second source
my $tshift_low = 20.0;
my $tshift_high = 200.0;
my $tshift_delta = 10.0;

# For testing this code set do_not_submit to 1. This will produce the submit scripts but not actually sub\
mit them. Set this to 0 to actually submit the jobs.
my $do_not_submit = 1;

my $n = 0;
my $batch_size = 1000; # how many jobs to run in one script
my $cur_batch_size = 0;

etc --------->

./submit-blob.pl

This created a HUGE amount of files in my submit-scripts directory


#+END_EXAMPLE

This code will place in a better directory format for useage. The
output directory is =lag= which contains
all the following sub-directories:


#+BEGIN_EXAMPLE


#+END_EXAMPLE

** ISIS in BC4

Note my PATH where programs are installed =/mnt/storage/home/so14935=

#+BEGIN_EXAMPLE
ISIS (and slang)

module add apps/heasoft/6.25
module load languages/intel/2017.01
module load tools/git/2.18.0

wget https://www.jedsoft.org/releases/slang/slang-2.3.2.tar.bz2
./configure --prefix=/mnt/storage/home/so14935
make
make install

git clone https://github.com/houckj/isis
./configure --prefix=/mnt/storage/home/so14935 --with-slang=/mnt/storage/home/so14935 --with-headas=$HEADAS
make
make install
#+END_EXAMPLE

isis is installed at:

#+BEGIN_EXAMPLE
/mnt/storage/home/so14935/isis
#+END_EXAMPLE

Add the following to your .bashrc file
#+BEGIN_EXAMPLE
export PATH=/mnt/storage/home/so14935:$PATH
#+END_EXAMPLE

isis now works in all areas!  Yay!

** Rerun all scripts for wider parameter ranges

New Directory is
=/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation=

where I have:
#+BEGIN_EXAMPLE
git clone https://github.com/phajy/x-ray-reverberation
#+END_EXAMPLE

*Compile code-img.c*
#+BEGIN_EXAMPLE
module load CUDA
module load cURL
make code-img

sbatch submit-code-img.sh

Submitted batch job 1888646

sacct -j 1888646
       JobID    JobName  Partition    Account  AllocCPUS      State ExitCode
------------ ---------- ---------- ---------- ---------- ---------- --------
1888646        code-img        gpu    default          1    RUNNING      0:0
#+END_EXAMPLE

Output file:
#+BEGIN_EXAMPLE
img-i53-a0p998-r400-8192.fits
#+END_EXAMPLE

*Compile code-s.c*

#+BEGIN_EXAMPLE
make code-s

./code-s -a0.998 -h2.0 -i53 -p1

Output file=s-x0-h2-a0p998-i53.fits
3 platforms
Platform 0 has 1 devices
Platform: 0 Device: 0 --- [Tesla P100-PCIE-16GB] [*]
Platform 1 has 1 devices
Platform: 1 Device: 0 --- [Tesla P100-PCIE-16GB]
Platform 2 has 1 devices
Platform: 2 Device: 0 --- [Intel(R) Xeon(R) CPU E5-2680 v4 @ 2.40GHz]
Using platform 0 device 0
Tesla P100-PCIE-16GB
About to build...
Reached Kernel execution
Waiting for all kernels to finish
Finished command Queue
#+END_EXAMPLE

Output file was:
#+BEGIN_EXAMPLE
s-x0-h2-a0p998-i53.fits
#+END_EXAMPLE

*Run submit-code-s.sh*

This code was edited to include source heights from 2-21$r_g$

#+BEGIN_EXAMPLE
sbatch submit-code-s.sh

Submitted batch job 1888765

sacct -j 1888765
       JobID    JobName  Partition    Account  AllocCPUS      State ExitCode
------------ ---------- ---------- ---------- ---------- ---------- --------
1888765          code-s        gpu    default          1    RUNNING      0:0
#+END_EXAMPLE

Outupt files:
#+BEGIN_EXAMPLE
s-x0-h2-a0p998-i53.fits
s-x0-h3-a0p998-i53.fits
s-x0-h4-a0p998-i53.fits
-----> up to 20
#+END_EXAMPLE

*Run code-x.c*

To create the spectrum

This script was not edited
#+BEGIN_EXAMPLE
module load CUDA
module load cURL
./code-x -i53.0 -h4.0 -g2.0 -A1.0 -x0.0 -p0.0

Output ----> x-h4-a0p998-i53-g2-A1-x0-p0.fits
#+END_EXAMPLE

*Run submit-code-x.pl* (5 Mar 2019)

Run a small amount initailly for:

$h = 2.0-4.0$  |  $\Gamma = 1.2-3.4$  |  $\xi = 1.0-3.0$

#+BEGIN_EXAMPLE
./submit-code-x.pl

sbatch submit-scripts/code-x-0000.csh (code-x -i53.0 -a0.998 -h2.0 -g1.2 -A1.0 -x1.0 -p0.0)
sbatch submit-scripts/code-x-0001.csh (code-x -i53.0 -a0.998 -h2.0 -g1.2 -A1.0 -x1.5 -p0.0)
sbatch submit-scripts/code-x-0002.csh (code-x -i53.0 -a0.998 -h2.0 -g1.2 -A1.0 -x2.0 -p0.0)

---------->

sbatch submit-scripts/code-x-0177.csh (code-x -i53.0 -a0.998 -h4.0 -g3.4 -A1.0 -x2.0 -p0.0)
sbatch submit-scripts/code-x-0178.csh (code-x -i53.0 -a0.998 -h4.0 -g3.4 -A1.0 -x2.5 -p0.0)
sbatch submit-scripts/code-x-0179.csh (code-x -i53.0 -a0.998 -h4.0 -g3.4 -A1.0 -x3.0 -p0.0)
[so14935@bc4gpulogin1 x-ray-reverberation]$


---> So I note from above that each height has (0000 - 0059) = 60 different variations with these parameters

This will repeat for each height therefore I expect to have (18 x 60) = 1080 files for source heights 2 - 20r_g
#+END_EXAMPLE

How does this work?

For each parameter range, the script will read the code-img and code-s
files and also the reflionx model, e.g:

#+BEGIN_EXAMPLE
emacs slurm-1891391.out

h=2 i=53 g=1p2 A=1 x=1 p = 0
Reading img file
Reading s file
  ... read keys
  ... read in a bunch of disk info
Reading reflionx
k = 89400
j=0/89400 r=1.246702 io_min=10.000000 io=inf newio=inf Aio=0.000000
j=1/89400 r=1.246702 io_min=10.000000 io=inf newio=inf Aio=0.000000
j=2/89400 r=1.246702 io_min=10.000000 io=inf newio=inf Aio=0.000000
j=3/89400 r=1.246702 io_min=10.000000 io=inf newio=inf Aio=0.000000
j=4/89400 r=1.246702 io_min=10.000000 io=inf newio=inf Aio=0.000000
j=5/89400 r=1.246702 io_min=10.000000 io=inf newio=inf Aio=0.000000
j=6/89400 r=1.246702 io_min=10.000000 io=inf newio=inf Aio=0.000000

----------->

#+END_EXAMPLE

and ultimately produce the spectrum for that range of parameters.

Next ---> rerun the submit-code-x.pl script for the next load of source
heights, working in batches to not to submit too many scripts at the
same time, try 3 batch submits, i.e;

h = 5.0 - 10.0, h = 11.0 = 15.0 and finally h = 16.0 - 20.0.

To check the queue:
#+BEGIN_EXAMPLE
squeue --state=PENDING
#+END_EXAMPLE

Although the script seems to have run and created all the files from
x-h2-a0p998-i53-g1p2-A1-x1-p0.fits to x-h10-a0p998-i53-g3p4-A1-x3-p0.fits

These may not be created correctly. Possibly due to the fact that the
REFLIONX model parameters are:

*Reflionx Model Parameters*
#+attr_html: :border 2 :rules None :frame border :width 25%
| Parameter | min |     max |
|-----------+-----+---------|
|           |     |         |
| $n_H$     |   0 | 100,000 |
| norm      |   0 |   1e+10 |
| Fe/solar  | 0.1 |      20 |
| $\Gamma$  | 1.4 |     3.3 |
| $\xi$     |  10 |   10000 |
| z         | -10 |      10 |

For Reflionx description see: /Ross & Fabian (2005) MNRAS 358,211 and Ross, Fabian & Young (1999)
MNRAS 306,461/

$\xi \propto \frac{F}{n}$ where F is the flux and n is the gas density
and $\xi = \frac{4 \pi F}{n_H}$

Note that code-x.c (line 400) converts the value of the ionisation
parameters to the values available in Reflionx which are (10, 20, 50,
100, 200, 500, 1000, 5000, 10000)

*Run code-x*


Make the 2 blobs directory then run the code:

PATH =/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation=


*submit-blob.pl*

#+BEGIN_EXAMPLE
./submit-blob.pl -----> 1430hrs 12 Mar 19

sbatch submit-scripts/blob-0000.csh ------------> submit-scripts/blob-1259.csh

COMPLETE - output files located in the Lag directory
#+END_EXAMPLE

*Run blob.c again* -  with source heights 10.0 - 20.0 and batch size = 1000

#+BEGIN_EXAMPLE
./submit-blob.pl -----> 1000hrs 18 Mar 19

sbatch submit-scripts/blob-0000.csh ------------> submit-scripts/blob-0247.csh
#+END_EXAMPLE

Next: *Provide good ranges for $t_\text{max}$ and $t_\text{shift}$*

Rerun Blob.c for $t_\text{max} = 200 - 900, \text{where} \Delta =
100$ and $t_\text{shift} = 50 -
200,  \text{where} \Delta = 50$. This will unlitametely lead to the
following range of parameters:



First from H 2-5 (to cut number of scripts down):

#+BEGIN_EXAMPLE
./submit-blob.pl -----> 1700hrs 28 Mar 19

sbatch submit-scripts/blob-0000.csh ------------> submit-scripts/blob-0863.csh


SCRIPTS FAILED - Suspended by Admin - Too much MEM = 64Gb
See emails from Simon Burbideg titled BC4 jobs dated 8 April 2019
#+END_EXAMPLE

Memory reduced to 1 Gb on line 141
Time increased to 5hrs

submitted job again for source H = 2-3 at 2200hrs 8 April

#+BEGIN_EXAMPLE
./submit-blob.pl

sbatch submit-scripts/blob-0000.csh ------->submit-scripts/blob-0143.csh

Also note:

1991113    serial   reverb  so14935 PD       0:00      1 (QOSMaxJobsPerUserLimit)
           1991114    serial   reverb  so14935 PD       0:00      1 (QOSMaxJobsPerUserLimit)
           1991115    serial   reverb  so14935 PD       0:00      1 (QOSMaxJobsPerUserLimit)

#+END_EXAMPLE

Upon reaching the per user running job limit for a partition, any further jobs submitted to that same partition by the
same user will be shown as state Pending (PD) with the Reason set as QOSMaxJobsPerUserLimit.

REf: https://buildmedia.readthedocs.org/media/pdf/jade-hpc/latest/jade-hpc.pdf

Conclusion
----------------------> Jobs in queue--- complete 1600 9 April

Note: Best run for just one source height increase at once which will
produce ~143 scripts

Next Run from 4 - 20 in steps of one!

#+BEGIN_EXAMPLE
submit blob.c for H = 3 - 6 ---> RUNNING 9 April (x863 scripts)
submit blob.c for H = 7 - 10 ---> RUNNING 11 April (x863 scripts)
submit blob.c for H = 11 - 13 ---> RUNNNING 17 April (x432 scripts)
submit blob.c for H = 14 - 16---> RUNNNING 18 April (x432 scripts)
submit blob.c for H = 17 - 20 ---> RUNNNING 22 April (x432 scripts)
#+END_EXAMPLE

Check progress
#+BEGIN_EXAMPLE
squeue --state=PENDING
#+END_EXAMPLE


*Finally*

Check you have all the correct files to begin with.
Once these have run I will have lag.fits files for the following
ranges:

*Parameters for 1H0707-495*

PATH to data =/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/lag-files=

#+attr_html: :border 2 :rules None :frame border :width 25%
| Parameter        | Range          | step |
|------------------+----------------+------|
| $h_1$            | 2.0 - 20.0     |  1.0 |
| $i$              | 53.0 - 53.0    |  1.0 |
| $\Gamma_1$       | 1.4 - 3.3      |  0.2 |
| $\Gamma_2$       | 1.4 - 3.3      |  0.2 |
| $A$              | 1.0 - 1.0      |  0.1 |
| $\xi$            | 1.0 - 3.0      |  0.5 |
| $p$              | 0.0 - 0.0      |  0.1 |
| $b$              | 1.0 - 3.0      |  1.0 |
| $q_2$            | 0.5 - 1.5      |  0.5 |
| $t_\text{max}$   | 200.0 - 1000.0 |  100 |
| $t_\text{shift}$ | 0.0 - 200.0    |   50 |


*Caution !*

Creating these lag files has taken up a huge amount of memory, note:

#+BEGIN_EXAMPLE
mmlsquota --block-size auto
                         Block Limits                                               |     File Limits
Filesystem Fileset    type         blocks      quota      limit   in_doubt    grace |    files   quota    limit in_doubt    grace  Remarks
gpfs       root       USR         no limits
gpfs       home       USR          11.88G        19G        20G          0     none |   107798       0        0        4     none
gpfs       scratch    USR          509.8G       510G       512G     23.75M     none |  5270678       0        0        0     none
#+END_EXAMPLE

** Testing the lag-freq-fits.sl script

PWD BC4 =/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation=

#+BEGIN_EXAMPLE
module load CUDA
module load cURL
#+END_EXAMPLE

To test the script works lets choose a random model. I have chosen:

#+BEGIN_EXAMPLE
emacs test_fit.par

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.122336e-05           0           1
  2  lag_freq(1).log_mass   0     0              6.1           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.4           0           0
  8  lag_freq(1).Gamma2     0     1              1.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1               80           0           0
 15  lag_freq(1).t_shift    0     1               25           0           0
#+END_EXAMPLE

Edit =lag-freq-fits-TEST1.sl= to run this par file on the fully
combined dtata set fpr 1H0707-495.

*/Note that this will need to create the fits file where $t_{\text{max}} = 80$./*

#+BEGIN_EXAMPLE
emacs lag-freq-fits-TEST1.sl
#+END_EXAMPLE

The script is:
#+BEGIN_EXAMPLE
Two blobs model fitting routines
%
% Author: Andy Young
% Date: 2019-01 -- 2019-04
%
% 2019-03 2019-04: updated so ISIS can ask for files to be generated when needed
% This is expected to be run as an isis-script
% isis-script lag-freq-fits.sl fit plot
% where fit = fit data
%       plot = make a nice plot of the current best fit
%       fit n m = fit data but only run if index mod m = n (so fit 2 5 would fit every 3 of 5); this allows simple parallelisation

% Some global variables and paths (update to your own path)
% variable path_to_lags = "/mnt/storage/scratch/phajy/x-ray-reverberation";
% Assumes the lags are in a subdirectory of the current directory
variable path_to_lags = getcwd;

variable list_of_files = {};
variable list_of_lags = {};
variable array_of_files = String_Type[0];

variable debug = 0; % non-zero to output more debugging information

% The new filename format is, e.g.,
% lag/i53/a0.998/h02.0+03.0/g2.5+2.5/A01.0/x2.0/p00.0/b02.0/q0.5/tmax1000/tshift0000/lag.fits

% Routine to look up the model
define lag_freq_fit(lo, hi, par)
{
	variable norm = par[0];
	variable mass = 10.0^par[1];

	variable i = par[2];
	variable a = par[3];
	variable h1 = par[4];
	variable h2 = par[5];
	variable g1 = par[6];
	variable g2 = par[7];
	variable abund = par[8];
	variable xi = par[9];
	variable p = par[10];
	variable b = par[11];
	variable q = par[12];
	variable tmax = par[13];
	variable tshift = par[14];

	% Now we need to generate the appropriate filename and see if it exists
	variable fp;
	variable filename = sprintf("lag-files/i%02.0f/a%05.3f/h%04.1f+%04.1f/g%03.1f+%03.1f/A%04.1f/x%03.1f/p%04.1f/b%04.1f/q%03.1f/tmax%04.0f/tshift%04.0f/lag.fits", i, a, h1, h2, g1, g2, abund, xi, p, b, q, tmax, tshift);
	if (debug>0) vmessage("Using filename %s", filename);

	variable t_g = 492.703806 * (mass / 1.0E8);

	% Read in the lag as a function of frequency
	% Note that units are tg^-1 (freq) and tg (lag)

	variable spec;
	variable ft;
	variable zero = 0;

	% see if we've already loaded in this file
	variable ix = where(array_of_files==filename);
	if (length(ix>0)) {
		% we have already seen this file
		% retrieve the saved values from memory
		if (debug>0) vmessage("Reading cached file %s (index %i)", filename, ix[0]);
		ft = list_of_lags[ix[0]];
		if (ft==NULL) {
			% null file means it didn't exist
			if (debug>0) vmessage("  ... but it doesn't exist");
			zero = 1;
		}
	} else {
		% we need to read in the file
		% check if file exists
		% vmessage("checking " + path_to_lags + "/" + filename);
		fp = fopen(path_to_lags + "/" + filename, "r");
	    if (fp == NULL)
	    {
	    	% file does not exist
	    	vmessage("File %s does not exist", filename);

	    	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	    	% note that in some instances the parameter values should produce zero in which case we don't need to create any files
	    	% second source height has to be higher than first
	    	if (h2>h1) {
		    	% decide if we can create the necessary files
				variable cmd;
				% do we have the first code-x file we need?
				variable code_x_a = sprintf("code-x-files/i%02.0f/a%05.3f/h%04.1f/g%3.1f/A%03.1f/x%03.1f/p%04.1f/rev.fits", i, a, h1, g1, abund, xi, p);
				if (debug>0) vmessage("Looking for %s", code_x_a);
				fp = fopen(code_x_a, "r");
				if (fp==NULL) {
					% file doesn't exist
					% try to create file
					cmd = sprintf("./code-x -i%0.1f -a%5.3f -h%0.1f -g%0.1f -A%0.1f -x%0.1f -p%0.1f", i, a, h1, g1, abund, xi, p);
					vmessage("   ...command to execute is %s", cmd);
					% plot_pause;
					() = system(cmd);
					% vmessage("   ...done!");
				} else {
					% file does exist
					() = fclose(fp);
					% vmessage("   ...found");
				}
				% do we have the second code-x file we need?
				variable code_x_b = sprintf("code-x-files/i%02.0f/a%05.3f/h%04.1f/g%3.1f/A%03.1f/x%03.1f/p%04.1f/rev.fits", i, a, h2, g2, abund, xi, p);
				if (debug>0) vmessage("Looking for %s", code_x_b);
				fp = fopen(code_x_b, "r");
				if (fp==NULL) {
					% file doesn't exist
					% try to create file
					cmd = sprintf("./code-x -i%0.1f -a%5.3f -h%0.1f -g%0.1f -A%0.1f -x%0.1f -p%0.1f", i, a, h2, g2, abund, xi, p);
					vmessage("   ...command to execute is %s", cmd);
					% plot_pause;
					() = system(cmd);
					% vmessage("   ...done!");
				} else {
					% file does exist
					() = fclose(fp);
					% vmessage("   ...found");
				}

				% run two blobs script
				cmd = sprintf("./blob -o%0.1f -d%0.1f -i%0.1f -g%0.1f -e%0.1f -A%0.1f -x%0.1f -p%0.1f -y1.0 -l1.0 -b%0.1f -w%0.1f -v%0.0f -q%0.0f", h1, h2, i, g1, g2, abund, xi, p, b, q, tmax, tshift);
				if (debug>0) vmessage("Run two blobs model %s", cmd);
				% plot_pause;
				() = system(cmd);
				% message("   ...done!");

				ft = fits_read_table(path_to_lags + "/" + filename);
				list_append(list_of_files, filename, -1);
				list_append(list_of_lags, ft, -1);
				array_of_files = list_to_array(list_of_files);
			} else {
		    	% output should be zeros; model is invalid (h2<=h1)
		    	vmessage("   ... should be null");
		    	zero = 1;
		    	% save file with NULL structure so we can skip quickly next time
		    	list_append(list_of_files, filename, -1);
				list_append(list_of_lags, NULL, -1);
				array_of_files = list_to_array(list_of_files);
			}
			%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	    } else {
	    	() = fclose(fp);

    		% vmessage("Reading file %s", filename);
			ft = fits_read_table(path_to_lags + "/" + filename);
			list_append(list_of_files, filename, -1);
			list_append(list_of_lags, ft, -1);
			array_of_files = list_to_array(list_of_files);
		}
	}

	if (zero==0) {
		% Shift all of the frequency bins
		variable fq = ft.fq / t_g;

		% Scale all time lags
		variable lag = ft.lag * t_g;

		% Overall normalizaton (which accounts for dilution, etc.)
		lag = lag * norm;

		% Frequency should now be in units of Hz
		% Lag should now be in units of seconds

		spec = rebin(lo, hi, _A(fq), _A(make_hi_grid(fq)), reverse(lag));
	} else {
		spec = Double_Type[length(lo)];
	}

	return(spec);
}

% New version will be:
add_slang_function("lag_freq", ["norm", "log_mass", "i", "a", "h1", "h2", "Gamma1", "Gamma2", "Fe", "xi", "p", "b", "q2", "t_max", "t_shift"]);

%rev_par_values = [
%	[2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0], 		# h1
%	[3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0],			# h2
%	[53.0],											# i
%	[2.5, 2.7, 2.9, 3.1],							# gamma1
%	[2.5, 2.7, 2.9, 3.1],							# gamma2
%	[1.0],											# A
%	[2.0, 2.5, 3.0],								# xi
%	[0.0],											# p
%	[1.0],											# r1
%	[1.0],											# r2
%	[1.0, 2.0, 3.0],								# b
%	[0.5],											# q2
%	[1000.0],										# tmax
%	[0.0]											# tshift
%	]
% initial values (gamma2 < gamma1), delta

% Load the data.

Ignore_PHA_Response_Keywords = 1;
variable d = load_data("1H0707-495-time-lag-fits/1H0707-495-combined-time-lags.fits");
variable r = load_rmf("1H0707-495-time-lag-fits/1H0707-495-combined-time-lags.rsp");
assign_rmf(r, d);

Label_By_Default = 0;
popt.xlabel="Frequency (Hz)";
popt.ylabel="Time lag (s)";
xlog;
popt.yrange=[-800, 200];
popt.xrange=[1e-4, 7e-3];

% load_par("new_tlag.par");
% load_par("v2_tlag.par");
load_par("test_fit.par");
() = eval_counts;

if (length(where(__argv=="plot"))==1) {
	load_par("test_fit.par");
	() = eval_counts;
	plot_data(1, popt);
	_pgsci(1);
	_pgsls(2);
	_pgmove(-4, 0);
	_pgdraw(-1, 0);
	list_par;
	plot_pause;
}

% Some routine to step through all possible combinations of parameters that we are interested in
variable n_pars = 8;
variable pars_to_fit = String_Type[n_pars];
variable vals_to_fit = Array_Type[n_pars];
variable index = Integer_Type[n_pars];
% Note I've changed the order before so that the code can run code-x for different source heights
% This makes the parallelisation more efficient
pars_to_fit[0] = "t_shift";
vals_to_fit[0] = [25.0];
pars_to_fit[1] = "t_max";
vals_to_fit[1] = [80.0];
pars_to_fit[2] = "Gamma1";
vals_to_fit[2] = [1.4];
pars_to_fit[3] = "Gamma2";
vals_to_fit[3] = [1.5];
pars_to_fit[4] = "x";
vals_to_fit[4] = [0.0];
pars_to_fit[5] = "b";
vals_to_fit[5] = [1.0];
pars_to_fit[6] = "h1";
vals_to_fit[6] = [2.0];
pars_to_fit[7] = "h2";
vals_to_fit[7] = [3.0];

% see if we should be fitting to the data
if (length(where(__argv=="fit"))==1) {
	variable m = 0; % which one to run
	variable n = 1; % out of (n-1)
	if (debug>0) {
		vmessage("__argc=%i", __argc);
		print(__argv);
		if (debug>1) plot_pause;
	}
	if (__argc==4)
	{
		() = sscanf(__argv[2], "%i", &m);
		() = sscanf(__argv[3], "%i", &n);
	}
	vmessage("Fitting %i of %i", m, n);
	if (debug>1) plot_pause;
	variable ix = 0;
	variable total = 0;
	variable i, s;
	variable best_s = 1.0E10;
	variable done = 0;
	do {
		if (ix==m) {
			if (debug>0) vmessage("New fit %i of %i (total %i)", ix, n, total);
			if (debug>1) plot_pause;
			% set parameter values
			for (i=0; i<length(pars_to_fit); i++) {
				set_par(sprintf("lag_freq(1).%s", pars_to_fit[i]), vals_to_fit[i][index[i]]);
			 	% () = printf("Setting parameter lag_freq(1).%s to %e\n", pars_to_fit[i], vals_to_fit[i][index[i]]);
			}
			% do fit
			() = fit_counts(&s);
			% see if we have a new best fit and if so plot it
			if (s.statistic < best_s) {
				% plot_data(1, popt);
				best_s = s.statistic;
				save_par(sprintf("1H0707_test_fit_%02i.par", m));
				list_par;
				vmessage("Best fit with statistic = %e", best_s);
				variable fp = fopen(sprintf("1H0707_test_fit_%02i.txt",m),"w");
				() = fprintf(fp, "%e", s.statistic);
				() = fclose(fp);
				variable pid = open_plot(sprintf("1H0707_test_fit_%02i.ps/cps",m));
				title(sprintf("Statistic = %e", s.statistic));
				plot_data(1, popt);
				_pgsci(1);
                                _pgscf(2);
				_pgsls(2);
				_pgmove(-10000, 0);
				_pgdraw(1, 0);
				close_plot(pid);
				% plot_pause;
			}
		}
		ix = ix + 1;
		if (ix >= n) {
			ix = 0;
		}
		total = total + 1;

		% move on to next parameter combination
		done = 1;
		for (i=0; i<length(pars_to_fit); i++) {
			% vmessage("i = %i", i);
			if (done == 1)
			{
				% vmessage("i = %i index = %i len = %i", i, index[i], length(vals_to_fit[i]));
				index[i] = index[i] + 1;
				% vmessage("i = %i index = %i len = %i", i, index[i], length(vals_to_fit[i]));
				if (index[i] == length(vals_to_fit[i]))
				{
					index[i] = 0;
				} else {
					done = 0;
				}
			}
		}
		% vmessage("Done");
	} while (done==0);
}
#+END_EXAMPLE

Submit script
#+BEGIN_EXAMPLE
isis lag-freq-fits-TEST1.sl fit plot
#+END_EXAMPLE

/This will be a bad fit and is expected for a simple test/.

The appropriate lag file should be at *lag-files* directory and not
the previously named *lag* directory.

#+BEGIN_EXAMPLE
lag-files/i53/a0.998/h02.0+03.0/g1.4+1.5/A01.0/x0.0/p00.0/b01.0/q0.5/tmax0080/tshift0025/lag.fits
#+END_EXAMPLE

#+BEGIN_EXAMPLE
[so14935@bc4gpulogin1 x-ray-reverberation]$ cd lag-files/i53/a0.998/h02.0+03.0/g1.4+1.5/A01.0/x0.0/p00.0/b01.0/q0.5/tmax0080/tshift0025/
[so14935@bc4gpulogin1 tshift0025]$ ls
lag.fits
#+END_EXAMPLE

*Create a nice plot of the test fit*

Now replot this fit to see what the test looks like:

USE =replot-best-lag-freq-fits.sl= This script is setup to replot known par files where we know the files
exist:

#+BEGIN_EXAMPLE
emacs replot-best-lag-freq-fits.sl
#+END_EXAMPLE

The script is:
#+BEGIN_EXAMPLE
% Two blobs model fitting routines
%
% Author: Andy Young
% Date: 2019-01 -- 2019-04
%
% 2019-03 2019-04: updated so ISIS can ask for files to be generated when needed
% This is expected to be run as an isis-script
% isis-script lag-freq-fits.sl fit plot
% where fit = fit data
%       plot = make a nice plot of the current best fit
%       fit n m = fit data but only run if index mod m = n (so fit 2 5 would fit every 3 of 5); this allows simple parallelisation

% Some global variables and paths (update to your own path)
% variable path_to_lags = "/mnt/storage/scratch/phajy/x-ray-reverberation";
% Assumes the lags are in a subdirectory of the current directory
variable path_to_lags = getcwd;

variable list_of_files = {};
variable list_of_lags = {};
variable array_of_files = String_Type[0];

variable debug = 0; % non-zero to output more debugging information

% The new filename format is, e.g.,
% lag/i53/a0.998/h02.0+03.0/g2.5+2.5/A01.0/x2.0/p00.0/b02.0/q0.5/tmax1000/tshift0000/lag.fits

% Routine to look up the model
define lag_freq_fit(lo, hi, par)
{
	variable norm = par[0];
	variable mass = 10.0^par[1];

	variable i = par[2];
	variable a = par[3];
	variable h1 = par[4];
	variable h2 = par[5];
	variable g1 = par[6];
	variable g2 = par[7];
	variable abund = par[8];
	variable xi = par[9];
	variable p = par[10];
	variable b = par[11];
	variable q = par[12];
	variable tmax = par[13];
	variable tshift = par[14];

	% Now we need to generate the appropriate filename and see if it exists
	variable fp;
	variable filename = sprintf("lag-files/i%02.0f/a%05.3f/h%04.1f+%04.1f/g%03.1f+%03.1f/A%04.1f/x%03.1f/p%04.1f/b%04.1f/q%03.1f/tmax%04.0f/tshift%04.0f/lag.fits", i, a, h1, h2, g1, g2, abund, xi, p, b, q, tmax, tshift);
	if (debug>0) vmessage("Using filename %s", filename);

	variable t_g = 492.703806 * (mass / 1.0E8);

	% Read in the lag as a function of frequency
	% Note that units are tg^-1 (freq) and tg (lag)

	variable spec;
	variable ft;
	variable zero = 0;

	% see if we've already loaded in this file
	variable ix = where(array_of_files==filename);
	if (length(ix>0)) {
		% we have already seen this file
		% retrieve the saved values from memory
		if (debug>0) vmessage("Reading cached file %s (index %i)", filename, ix[0]);
		ft = list_of_lags[ix[0]];
		if (ft==NULL) {
			% null file means it didn't exist
			if (debug>0) vmessage("  ... but it doesn't exist");
			zero = 1;
		}
	} else {
		% we need to read in the file
		% check if file exists
		% vmessage("checking " + path_to_lags + "/" + filename);
		fp = fopen(path_to_lags + "/" + filename, "r");
	    if (fp == NULL)
	    {
	    	% file does not exist
	    	vmessage("File %s does not exist", filename);

	    	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	    	% note that in some instances the parameter values should produce zero in which case we don't need to create any files
	    	% second source height has to be higher than first
	    	if (h2>h1) {
		    	% decide if we can create the necessary files
				variable cmd;
				% do we have the first code-x file we need?
				variable code_x_a = sprintf("code-x-files/i%02.0f/a%05.3f/h%04.1f/g%3.1f/A%03.1f/x%03.1f/p%04.1f/rev.fits", i, a, h1, g1, abund, xi, p);
				if (debug>0) vmessage("Looking for %s", code_x_a);
				fp = fopen(code_x_a, "r");
				if (fp==NULL) {
					% file doesn't exist
					% try to create file
					cmd = sprintf("./code-x -i%0.1f -a%5.3f -h%0.1f -g%0.1f -A%0.1f -x%0.1f -p%0.1f", i, a, h1, g1, abund, xi, p);
					vmessage("   ...command to execute is %s", cmd);
					% plot_pause;
					() = system(cmd);
					% vmessage("   ...done!");
				} else {
					% file does exist
					() = fclose(fp);
					% vmessage("   ...found");
				}
				% do we have the second code-x file we need?
				variable code_x_b = sprintf("code-x-files/i%02.0f/a%05.3f/h%04.1f/g%3.1f/A%03.1f/x%03.1f/p%04.1f/rev.fits", i, a, h2, g2, abund, xi, p);
				if (debug>0) vmessage("Looking for %s", code_x_b);
				fp = fopen(code_x_b, "r");
				if (fp==NULL) {
					% file doesn't exist
					% try to create file
					cmd = sprintf("./code-x -i%0.1f -a%5.3f -h%0.1f -g%0.1f -A%0.1f -x%0.1f -p%0.1f", i, a, h2, g2, abund, xi, p);
					vmessage("   ...command to execute is %s", cmd);
					% plot_pause;
					() = system(cmd);
					% vmessage("   ...done!");
				} else {
					% file does exist
					() = fclose(fp);
					% vmessage("   ...found");
				}

				% run two blobs script
				cmd = sprintf("./blob -o%0.1f -d%0.1f -i%0.1f -g%0.1f -e%0.1f -A%0.1f -x%0.1f -p%0.1f -y1.0 -l1.0 -b%0.1f -w%0.1f -v%0.0f -q%0.0f", h1, h2, i, g1, g2, abund, xi, p, b, q, tmax, tshift);
				if (debug>0) vmessage("Run two blobs model %s", cmd);
				% plot_pause;
				() = system(cmd);
				% message("   ...done!");

				ft = fits_read_table(path_to_lags + "/" + filename);
				list_append(list_of_files, filename, -1);
				list_append(list_of_lags, ft, -1);
				array_of_files = list_to_array(list_of_files);
			} else {
		    	% output should be zeros; model is invalid (h2<=h1)
		    	vmessage("   ... should be null");
		    	zero = 1;
		    	% save file with NULL structure so we can skip quickly next time
		    	list_append(list_of_files, filename, -1);
				list_append(list_of_lags, NULL, -1);
				array_of_files = list_to_array(list_of_files);
			}
			%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	    } else {
	    	() = fclose(fp);

    		% vmessage("Reading file %s", filename);
			ft = fits_read_table(path_to_lags + "/" + filename);
			list_append(list_of_files, filename, -1);
			list_append(list_of_lags, ft, -1);
			array_of_files = list_to_array(list_of_files);
		}
	}

	if (zero==0) {
		% Shift all of the frequency bins
		variable fq = ft.fq / t_g;

		% Scale all time lags
		variable lag = ft.lag * t_g;

		% Overall normalizaton (which accounts for dilution, etc.)
		lag = lag * norm;

		% Frequency should now be in units of Hz
		% Lag should now be in units of seconds

		spec = rebin(lo, hi, _A(fq), _A(make_hi_grid(fq)), reverse(lag));
	} else {
		spec = Double_Type[length(lo)];
	}

	return(spec);
}

% New version will be:
add_slang_function("lag_freq", ["norm", "log_mass", "i", "a", "h1", "h2", "Gamma1", "Gamma2", "Fe", "xi", "p", "b", "q2", "t_max", "t_shift"]);

% Load the data.
%Ignore_PHA_Response_Keywords = 1;
variable d = load_data("1H0707-495-time-lag-fits/1H0707-495-combined-time-lags.fits");
variable r = load_rmf("1H0707-495-time-lag-fits/1H0707-495-combined-time-lags.rsp");
assign_rmf(r, d);

Label_By_Default = 0;
popt.xlabel="Frequency (Hz)";
popt.ylabel="Time lag (s)";
xlog;
popt.yrange=[-750, 200];
popt.xrange=[1e-4, 7e-3];

load_par("test_fit.par");
() = eval_counts;

variable pid = open_plot("1H0707-495_ecm_test_fit.ps/cps");
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
plot_comps(1,popt,&plot_data);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgsci(1); % make line colour black
_pgdraw(1,0);
close_plot(pid);
#+END_EXAMPLE

Now run this script

#+BEGIN_EXAMPLE
isis replot-best-lag-freq-fits.sl fit plot

RMF includes the effective area
RMF includes the effective area
 Parameters[Variable] = 15[2]
            Data bins = 7
           Chi-square = 1355.952
   Reduced chi-square = 271.1904

list_par;
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.122336e-05           0           1
  2  lag_freq(1).log_mass   0     0              6.1           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.4           0           0
  8  lag_freq(1).Gamma2     0     1              1.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1               80           0           0
 15  lag_freq(1).t_shift    0     1               25           0           0
#+END_EXAMPLE

The test fit plot is of course */not fitted to the data/* but its shows the correct
*lag* files are being created in the *lag-files* directory and can be recalled via the par file for later use
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_ecm_test_fit.png

** Testing the lag-freq-files.sl script

This script only creates lag files for a given par or range of par
values

PWD BC4 =/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation=

#+BEGIN_EXAMPLE
module load CUDA
module load cURL
#+END_EXAMPLE

To test the script works lets choose a random model. I have chosen:

#+BEGIN_EXAMPLE
emacs

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.122336e-05           0           1
  2  lag_freq(1).log_mass   0     0              6.1           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              120           0           0
 15  lag_freq(1).t_shift    0     1               55           0           0
#+END_EXAMPLE

Edit =lag-freq-files-TEST1.sl= to run this par file on the fully
combined dtata set fpr 1H0707-495.

*/Note that this will need to create the fits file where
$t_{\text{max}} = 120$ and $t_{\text{shift}} = 55$./*

#+BEGIN_EXAMPLE
emacs lag-freq-files-TEST1.sl
#+END_EXAMPLE

The script is:
#+BEGIN_EXAMPLE
% Two blobs model fitting routines
% The purpose of this code is to make sure all of the necessary files are present
% This only does the code-x runs because each "blob" run is unique and can be done by the fitting code
% Note that the parameter grid that is stepped through should be the same as used in the fitting code
%
% Author: Andy Young
% Date: 2019-08
%
% This is expected to be run as an isis-script
% isis-script lag-freq-fits.sl n m
% where n m = calculate file if index mod m = n (so 2 5 would calculate every 3 of 5); this allows simple parallelisation

% Some global variables and paths (update to your own path)
% variable path_to_lags = "/mnt/storage/scratch/phajy/x-ray-reverberation";
% Assumes the lags are in a subdirectory of the current directory
variable path_to_lags = getcwd;

variable debug = 0;

variable list_of_files = {};
variable array_of_files = String_Type[0];

variable m = 0; % which one to run
variable n = 1;
() = sscanf(__argv[1], "%i", &m);
() = sscanf(__argv[2], "%i", &n);
vmessage("m=%i n=%i", m, n);
variable count = 0;

% The new filename format is, e.g.,
% lag/i53/a0.998/h02.0+03.0/g2.5+2.5/A01.0/x2.0/p00.0/b02.0/q0.5/tmax1000/tshift0000/lag.fits

% Routine to look up the model
define lag_freq_fit(lo, hi, par)
{
	variable norm = par[0];
	variable mass = 10.0^par[1];

	variable i = par[2];
	variable a = par[3];
	variable h1 = par[4];
	variable h2 = par[5];
	variable g1 = par[6];
	variable g2 = par[7];
	variable abund = par[8];
	variable xi = par[9];
	variable p = par[10];
	variable b = par[11];
	variable q = par[12];
	variable tmax = par[13];
	variable tshift = par[14];

	% Now we need to generate the appropriate filename and see if it exists
	variable fp, ix;
	variable filename = sprintf("lag-files/i%02.0f/a%05.3f/h%04.1f+%04.1f/g%03.1f+%03.1f/A%04.1f/x%03.1f/p%04.1f/b%04.1f/q%03.1f/tmax%04.0f/tshift%04.0f/lag.fits", i, a, h1, h2, g1, g2, abund, xi, p, b, q, tmax, tshift);

	% check if file exists
	if (debug>0) vmessage("checking " + path_to_lags + "/" + filename);
	fp = fopen(path_to_lags + "/" + filename, "r");
    if (fp == NULL)
    {
    	% file does not exist
    	if (debug>0) vmessage("File %s does not exist", filename);

    	% note that in some instances the parameter values should produce zero in which case we don't need to create any files
    	% second source height has to be higher than first
    	if (h2>h1) {
	    	% decide if we can create the necessary files
			variable cmd;
			% do we have the first code-x file we need?
			variable code_x_a = sprintf("code-x-files/i%02.0f/a%05.3f/h%04.1f/g%3.1f/A%03.1f/x%03.1f/p%04.1f/rev.fits", i, a, h1, g1, abund, xi, p);
			if (debug>0) vmessage("Looking for %s", code_x_a);
			fp = fopen(code_x_a, "r");
			if (fp==NULL) {
				% file doesn't exist
				cmd = sprintf("./code-x -i%0.1f -a%5.3f -h%0.1f -g%0.1f -A%0.1f -x%0.1f -p%0.1f", i, a, h1, g1, abund, xi, p);
				% try to create file if we haven't already
				ix = where(array_of_files==cmd);
				if (length(ix>0)) {
					% we have already tried to create this file
				} else {
					if (count==m) {
						vmessage("   ...command to execute is %s", cmd);
						() = system(cmd); % <-- comment out for testing
					} else {
						if (debug>0) vmessage("   skipping");
					}
					% plot_pause;
					count = count + 1;
					if (count >= n) {
						count = 0;
					}
					list_append(list_of_files, cmd, -1);
					array_of_files = list_to_array(list_of_files);
				}
			}
			% do we have the second code-x file we need?
			variable code_x_b = sprintf("code-x-files/i%02.0f/a%05.3f/h%04.1f/g%3.1f/A%03.1f/x%03.1f/p%04.1f/rev.fits", i, a, h2, g2, abund, xi, p);
			if (debug>0) vmessage("Looking for %s", code_x_b);
			fp = fopen(code_x_b, "r");
			if (fp==NULL) {
				% file doesn't exist
				cmd = sprintf("./code-x -i%0.1f -a%5.3f -h%0.1f -g%0.1f -A%0.1f -x%0.1f -p%0.1f", i, a, h2, g2, abund, xi, p);
				% try to create file if we haven't already
				ix = where(array_of_files==cmd);
				if (length(ix>0)) {
					% we have already tried to create this file
				} else {
					if (count==m) {
						vmessage("   ...command to execute is %s", cmd);
						() = system(cmd); % <-- comment out for testing
					} else {
						if (debug>0) vmessage("   skipping");
					}
					% plot_pause;
					count = count + 1;
					if (count >= n) {
						count = 0;
					}
					list_append(list_of_files, cmd, -1);
					array_of_files = list_to_array(list_of_files);
				}
			}
		}
	}
	return 0;
}

add_slang_function("lag_freq", ["norm", "log_mass", "i", "a", "h1", "h2", "Gamma1", "Gamma2", "Fe", "xi", "p", "b", "q2", "t_max", "t_shift"]);

% Some routine to step through all possible combinations of parameters that we are interested in
variable n_pars = 8;
variable pars_to_fit = String_Type[n_pars];
variable vals_to_fit = Array_Type[n_pars];
variable index = Integer_Type[n_pars];
% Note I've changed the order before so that the code can run code-x for different source heights
% This makes the parallelisation more efficient
pars_to_fit[0] = "t_shift";
vals_to_fit[0] = [55.0];
pars_to_fit[1] = "t_max";
vals_to_fit[1] = [120.0];
pars_to_fit[2] = "Gamma1";
vals_to_fit[2] = [1.8];
pars_to_fit[3] = "Gamma2";
vals_to_fit[3] = [2.1];
pars_to_fit[4] = "x";
vals_to_fit[4] = [0.0];
pars_to_fit[5] = "b";
vals_to_fit[5] = [1.0];
pars_to_fit[6] = "h1";
vals_to_fit[6] = [2.0];
pars_to_fit[7] = "h2";
vals_to_fit[7] = [3.0];

variable lo, hi;
(lo, hi) = linear_grid(1,10,10); % dummy grid

load_par("best_fit.par");

variable i;
variable done = 0;
do {
	% set parameter values
	for (i=0; i<length(pars_to_fit); i++) {
		set_par(sprintf("lag_freq(1).%s", pars_to_fit[i]), vals_to_fit[i][index[i]]);
	 	% () = printf("Setting parameter lag_freq(1).%s to %e\n", pars_to_fit[i], vals_to_fit[i][index[i]]);
	}

	%list_par;
	%plot_pause;

	% do fit
	() = eval_fun(lo, hi);

	% move on to next parameter combination
	done = 1;
	for (i=0; i<length(pars_to_fit); i++) {
		% vmessage("i = %i", i);
		if (done == 1)
		{
			% vmessage("i = %i index = %i len = %i", i, index[i], length(vals_to_fit[i]));
			index[i] = index[i] + 1;
			% vmessage("i = %i index = %i len = %i", i, index[i], length(vals_to_fit[i]));
			if (index[i] == length(vals_to_fit[i]))
			{
				index[i] = 0;
			} else {
				done = 0;
			}
		}
	}
} while (done==0);
#+END_EXAMPLE

Submit script using the submit-lag-files.sh script

#+BEGIN_EXAMPLE
#! /bin/tcsh
#
#SBATCH --partition=serial
#SBATCH --nodes=1
#SBATCH --ntasks-per-node=1
#SBATCH --mem=4GB
#SBATCH --time=0-12:00:00
#SBATCH --job-name=lag-files
#SBATCH --array=0-0

## Note that array should be from 0 to (n-1) and isis-script should be run with n at the end

module load CUDA
module load cURL

cd /mnt/storage/scratch/${LOGNAME}/x-ray-rev2/x-ray-reverberation


isis-script lag-freq-files-TEST1.sl $SLURM_ARRAY_TASK_ID 1
#+END_EXAMPLE

Submit the script

#+BEGIN_EXAMPLE
sbatch submit-lag-files.sh

Submitted batch job 2292960

sacct -j 2292960
       JobID    JobName  Partition    Account  AllocCPUS      State ExitCode
------------ ---------- ---------- ---------- ---------- ---------- --------
2292960_0     lag-files     serial    default          1  COMPLETED      0:0
2292960_0.b+      batch               default          1  COMPLETED      0:0
#+END_EXAMPLE

View output file
#+BEGIN_EXAMPLE
emacs slurm-2292960_0.out

m=0 n=1
#+END_EXAMPLE

The appropriate lag file should be at *lag-files* directory and not
the previously named *lag* directory.

#+BEGIN_EXAMPLE
cd lag-files/i53/a0.998/h02.0+03.0/g1.8+2.1/A01.0/x0.0/p00.0/b01.0/q0.5/
[so14935@bc4gpulogin1 q0.5]$ ls
tmax0025  tmax0125  tmax0225  tmax0315  tmax0375  tmax0500  tmax0650  tmax0850  tmax1050
tmax0050  tmax0150  tmax0250  tmax0325  tmax0400  tmax0550  tmax0700  tmax0900  tmax1100
tmax0075  tmax0175  tmax0275  tmax0340  tmax0425  tmax0600  tmax0750  tmax0950  tmax1200
tmax0100  tmax0200  tmax0300  tmax0350  tmax0450  tmax0625  tmax0800  tmax1000  tmax1300
#+END_EXAMPLE

Result: $t_{\text{max}} = 55$ has */not/* been created !

Attempted again for $t_{\text{max}} = 65$ - after running scripts,
file still does not exist

------------------------------------------------------------------------------------------------------------------------
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Ok - so let us try these pars for the *lag-freq-fits.sl* code for the
par file above

#+BEGIN_EXAMPLE
isis lag-freq-fits-TEST1.sl
RMF includes the effective area
 Parameters[Variable] = 15[2]
            Data bins = 7
           Chi-square = 2226.175
   Reduced chi-square = 445.235

isis> list_par;
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.122336e-05           0           1
  2  lag_freq(1).log_mass   0     0              6.1           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              120           0           0
 15  lag_freq(1).t_shift    0     1               55           0           0
#+END_EXAMPLE

Now check if files exist:

#+BEGIN_EXAMPLE
cd lag-files/i53/a0.998/h02.0+03.0/g1.8+2.1/A01.0/x0.0/p00.0/b01.0/q0.5/tmax0120/tshift0055/
[so14935@bc4gpulogin1 tshift0055]$ ls
lag.fits
#+END_EXAMPLE

File exists OK

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
--------------------------------------------------------------------------------------------------------------------------
*>>>>>>>* investigate why *lag-freq-files.sh* is */not/* creating the desired files *<<<<<<<<*

i.e. Is the dir path to lag-files correct?



The test fit plot is of course */not fitted to the data/* but its shows the correct
*lag* files are being created in the *lag-files* directory and can be recalled via the par file for later use
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_ecm

** Run Lag-freq-fits script

To fit the lag-freq files note the pathway to the data is: =/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/lag-files=

The =lag-freq-fits.sl= script is located in Github =https://github.com/phajy/x-ray-reverberation/blob/master/lag-freq-fits.sl=

Copy =lag-freq-fits.sl= from Github and initiate:

Running new lag-frequency code
#+BEGIN_EXAMPLE
isis-script lag-freq-fits.sl plot

isis-script lag-freq-fits.sl fit

sbatch submit-lag-freq.sh
#+END_EXAMPLE

To run these enter the following parallelized submit script
#+BEGIN_EXAMPLE
sbatch submit-lag-freq.sh
#+END_EXAMPLE

This will return the fits in a range of useful outputs that are e.g:

#+BEGIN_EXAMPLE
best_fit_00.par
best_fit_00.ps
best_fit_00.txt

etc....
#+END_EXAMPLE

To find the best fit

#+BEGIN_EXAMPLE
python find-best-fit.py

Best fit is 7.604898 in file best_fit_05.txt
#+END_EXAMPLE

Best fit was:

#+BEGIN_EXAMPLE
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.429248e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.236674           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0
#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_ecm_initial.png

** Fitting the best fit lag file (1H0707-495 fully combined timelags)

The lag-frequency used for this first fit is for the 1H0707-495 fully
combined observations

PATH
=/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/fully_comb_time_lags.fits=
(and the associated response file in the same directory

The best fit lag file in the =lag-files= directory is:

#+BEGIN_EXAMPLE
i53/a0.998/h02.0+03.0/g2.2+2.5/A01.0/x0.0/p00.0/b01.0/q0.5/tmax0250/tshift0050/lag.fits
#+END_EXAMPLE

Note the full PWD to this file is:

#+BEGIN_EXAMPLE
/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/lag-files/i53/a0.998/h02.0+03.0/g2.2+2.5/A01.0/x0.0/p00.0/b01.0/q0.5/tmax0250/tshift0050
#+END_EXAMPLE

Increase the parameter ranges on =lag-freq-fits.sl=

#+BEGIN_EXAMPLE
pars_to_fit[0] = "t_shift";
vals_to_fit[0] = [0.0, 50.0, 100.0];
pars_to_fit[1] = "t_max";
vals_to_fit[1] = [250.0, 500.0, 750.0, 1000.0];
pars_to_fit[2] = "Gamma1";
vals_to_fit[2] = [2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.7, 2.9, 3.1];
pars_to_fit[3] = "Gamma2";
vals_to_fit[3] = [2.0, 2.1, 2.2, 2.3, 2.34, 2.5, 2.7, 2.9, 3.1];
pars_to_fit[4] = "x";
vals_to_fit[4] = [0.0, 1.0, 2.0, 3.0];
pars_to_fit[5] = "b";
vals_to_fit[5] = [1.0, 2.0, 3.0];
pars_to_fit[6] = "h1";
vals_to_fit[6] = [2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0];
pars_to_fit[7] = "h2";
vals_to_fit[7] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0];
#+END_EXAMPLE

edit $\Gamma_1$ and $\Gamma_2$ to 1.8-3.1 and $h_2$ to run 3.0-18.0

Now submit a batch of code:

#+BEGIN_EXAMPLE
sbatch submit-lag-freq.sh

Submitted batch job 2118712
#+END_EXAMPLE

#+BEGIN_EXAMPLE
squeue --state=PENDING
#+END_EXAMPLE

#+BEGIN_EXAMPLE
sacct -j 2118712
       JobID    JobName  Partition    Account  AllocCPUS      State ExitCode
------------ ---------- ---------- ---------- ---------- ---------- --------
2118712_15     lag-freq     serial    default          1    TIMEOUT      1:0
2118712_15.+      batch               default          1  CANCELLED     0:15
#+END_EXAMPLE

Once complete run:

#+BEGIN_EXAMPLE
find-best-fit.py
#+END_EXAMPLE

Pull best fit files into my Lyra directory

PWD to Lyra: =/homeb/steff075/phd_ecm/1h0707/extended-corona=

#+BEGIN_EXAMPLE
scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/best_fit_00.txt .

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/best_fit_00.par .

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/best_fit_00.ps .
#+END_EXAMPLE

Best fit still needs improving!!

Increase the wall time on submit-lag-freq.sh to 1.5 days

Now submit a batch of code:

#+BEGIN_EXAMPLE
sbatch submit-lag-freq.sh

Submitted batch job 2120695
#+END_EXAMPLE

#+BEGIN_EXAMPLE
squeue --state=PENDING

or

sacct -j 2120695  At 1130hrs 25 May 2019

[so14935@bc4gpulogin1 x-ray-reverberation]$ sacct -j 2120695
       JobID    JobName  Partition    Account  AllocCPUS      State ExitCode
------------ ---------- ---------- ---------- ---------- ---------- --------
2120695_15     lag-freq     serial    default          1    TIMEOUT      1:0
2120695_15.+      batch               default          1  CANCELLED     0:15
#+END_EXAMPLE


Now try only adjusting the values of $\Gamma_1$ and $\Gamma_2$ from
1.8-3.1

Outcome - No improvement!

Increase the values of $\Gamma_1$ and $\Gamma_2$ from 1.7-3.1 and using

Best fit was

#+BEGIN_EXAMPLE
best_fit_00.par

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.506557e-05           0           1
  2  lag_freq(1).log_mass   0     0                6           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              1.9           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              750           0           0
 15  lag_freq(1).t_shift    0     1              100           0           0
#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495-best_fit_00-2June.png

Now increase the parameters  again change and submit-lag-freq.sh for:

#+BEGIN_EXAMPLE
#! /bin/tcsh
#
#SBATCH --partition=serial
#SBATCH --nodes=1
#SBATCH --ntasks-per-node=4
#SBATCH --mem=6GB
#SBATCH --time=2-12:00:00
#SBATCH --job-name=lag-freq
#SBATCH --array=0-15

## Note that array should be from 0 to (n-1) and isis-script should be run with n at the end

module load CUDA
module load cURL

cd /mnt/storage/scratch/${LOGNAME}/x-ray-rev2/x-ray-reverberation

isis-script lag-freq-fits.sl fit $SLURM_ARRAY_TASK_ID 16
#+END_EXAMPLE

#+BEGIN_EXAMPLE
sacct -j 2132640  SUBMITTED 1830 2 June 2019
       JobID    JobName  Partition    Account  AllocCPUS      State ExitCode
------------ ---------- ---------- ---------- ---------- ---------- --------
2132640_15     lag-freq     serial    default          4    RUNNING      0:0
etc......
#+END_EXAMPLE

Later...

#+BEGIN_EXAMPLE
 sacct -j 2132640
       JobID    JobName  Partition    Account  AllocCPUS      State ExitCode
------------ ---------- ---------- ---------- ---------- ---------- --------
2132640_15     lag-freq     serial    default          4    TIMEOUT      1:0
2132640_15.+      batch               default          4  CANCELLED     0:15
etc....
#+END_EXAMPLE

#+BEGIN_EXAMPLE
python find-best-fit.py
Best fit is 8.322542 in file best_fit_10.txt
#+END_EXAMPLE

This was for parameter ranges:
#+BEGIN_EXAMPLE
pars_to_fit[0] = "t_shift";
vals_to_fit[0] = [0.0, 50.0, 100.0, 150.0];
pars_to_fit[1] = "t_max";
vals_to_fit[1] = [250.0, 500.0, 750.0, 1000.0];
pars_to_fit[2] = "Gamma1";
vals_to_fit[2] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.7, 2.9, 3.1];
pars_to_fit[3] = "Gamma2";
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.7, 2.9, 3.1];
pars_to_fit[4] = "x";
vals_to_fit[4] = [0.0, 1.0, 2.0, 3.0, 4.0];
pars_to_fit[5] = "b";
vals_to_fit[5] = [1.0, 2.0, 3.0, 4.0];
pars_to_fit[6] = "h1";
vals_to_fit[6] = [2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0];
pars_to_fit[7] = "h2";
vals_to_fit[7] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 16.0, 17.0, 18.0, 19.0, 20.0];
#+END_EXAMPLE

Now - REDUCE tshift to [0.0, 50.0, 100.0];

Now check which nodes are avail:

#+BEGIN_EXAMPLE
sinfo -s
PARTITION       AVAIL  TIMELIMIT   NODES(A/I/O/T)  NODELIST
veryshort          up    6:00:00        4/12/0/16  compute[084-095],highmem[10-13]
test               up    1:00:00     424/0/10/434  compute[096-525],highmem[10-13]
cpu_test           up    1:00:00          0/4/0/4  compute[080-083]
cpu*               up 14-00:00:0     420/0/10/430  compute[096-525]
hmem               up 14-00:00:0          8/0/0/8  highmem[10-17]
gpu                up 7-00:00:00        30/0/1/31  gpu[01-31]
gpu_veryshort      up    1:00:00          0/1/0/1  gpu32
serial             up 3-00:00:00         8/4/0/12  compute[068-079]
dcv                up 14-00:00:0          1/0/0/1  bc4vis1
serial_verylong    up 14-00:00:0          7/1/0/8  compute[068-075]
#+END_EXAMPLE

Then:

#+BEGIN_EXAMPLE
#! /bin/tcsh
#
#SBATCH --partition=serial
#SBATCH --nodes=1
#SBATCH --ntasks-per-node=1
#SBATCH --mem=4GB
#SBATCH --time=3-00:00:00
#SBATCH --job-name=lag-freq
#SBATCH --array=0-15

## Note that array should be from 0 to (n-1) and isis-script should be run with n at the end

module load CUDA
module load cURL

cd /mnt/storage/scratch/${LOGNAME}/x-ray-rev2/x-ray-reverberation

isis-script lag-freq-fits.sl fit $SLURM_ARRAY_TASK_ID 16
#+END_EXAMPLE

Submit
#+BEGIN_EXAMPLE
sbatch submit-lag-freq.sh
Submitted batch job 2139817

sacct -j 2139817 ----- SUBMITTED 2125 5 June 2019

       JobID    JobName  Partition    Account  AllocCPUS      State ExitCode
------------ ---------- ---------- ---------- ---------- ---------- --------
2139817_15     lag-freq     serial    default          1    RUNNING      0:0
etc...
#+END_EXAMPLE

3 days later....

#+BEGIN_EXAMPLE
sacct -j 2139817
       JobID    JobName  Partition    Account  AllocCPUS      State ExitCode
------------ ---------- ---------- ---------- ---------- ---------- --------
2139817_15     lag-freq     serial    default          1    TIMEOUT      1:0
2139817_15.+      batch               default          1  CANCELLED     0:15
etc...

#+END_EXAMPLE

Best fit there was:

#+BEGIN_EXAMPLE
python find-best-fit.py
Best fit is 7.48805 in file best_fit_01.txt

This did not improve the fit..
#+END_EXAMPLE

edit $\Gamma_1$ and $\Gamma_2$ to 1.3-3.1 and ionisation max=3.0  and run again using

#+BEGIN_EXAMPLE
#! /bin/tcsh
#
#SBATCH --partition=serial
#SBATCH --nodes=1
#SBATCH --ntasks-per-node=2
#SBATCH --mem=4GB
#SBATCH --time=2-00:00:00
#SBATCH --job-name=lag-freq
#SBATCH --array=0-4

## Note that array should be from 0 to (n-1) and isis-script should be run with n at the end

module load CUDA
module load cURL

cd /mnt/storage/scratch/${LOGNAME}/x-ray-rev2/x-ray-reverberation

isis-script lag-freq-fits.sl fit $SLURM_ARRAY_TASK_ID 5
#+END_EXAMPLE

how long does one run take? Submit this:

#+BEGIN_EXAMPLE
#! /bin/tcsh
#
#SBATCH --partition=serial
#SBATCH --nodes=1
#SBATCH --ntasks-per-node=1
#SBATCH --mem=4GB
#SBATCH --time=2-00:00:00
#SBATCH --job-name=lag-freq
#SBATCH --array=0

## Note that array should be from 0 to (n-1) and isis-script should be run with n at the end

module load CUDA
module load cURL

cd /mnt/storage/scratch/${LOGNAME}/x-ray-rev2/x-ray-reverberation

isis-script lag-freq-fits.sl fit $SLURM_ARRAY_TASK_ID 1
#+END_EXAMPLE

#+BEGIN_EXAMPLE
sbatch submit-lag-freq.sh   0920 13 June 2019
Submitted batch job 2153806

sacct -j 2153806

       JobID    JobName  Partition    Account  AllocCPUS      State ExitCode
------------ ---------- ---------- ---------- ---------- ---------- --------
2153806_0      lag-freq     serial    default          1    RUNNING      0:0
#+END_EXAMPLE

Re-run with 5 jobs:
#+BEGIN_EXAMPLE
#! /bin/tcsh
#
#SBATCH --partition=serial
#SBATCH --nodes=1
#SBATCH --ntasks-per-node=1
#SBATCH --mem=2GB
#SBATCH --time=2-00:00:00
#SBATCH --job-name=lag-freq
#SBATCH --array=0-4

## Note that array should be from 0 to (n-1) and isis-script should be run with n at the end

module load CUDA
module load cURL

cd /mnt/storage/scratch/${LOGNAME}/x-ray-rev2/x-ray-reverberation

isis-script lag-freq-fits.sl fit $SLURM_ARRAY_TASK_ID 5


sbatch submit-lag-freq.sh   submitted 1348 12 July 2019
Submitted batch job 2226722

sacct -j 2226722
       JobID    JobName  Partition    Account  AllocCPUS      State ExitCode
------------ ---------- ---------- ---------- ---------- ---------- --------
2226722_4      lag-freq     serial    default          1    RUNNING      0:0
2226722_0      lag-freq     serial    default          1    RUNNING      0:0
2226722_1      lag-freq     serial    default          1    RUNNING      0:0
2226722_2      lag-freq     serial    default          1    RUNNING      0:0
2226722_3      lag-freq     serial    default          1    RUNNING      0:0
#+END_EXAMPLE

Later...

#+BEGIN_EXAMPLE
sacct -j 2226722
       JobID    JobName  Partition    Account  AllocCPUS      State ExitCode
------------ ---------- ---------- ---------- ---------- ---------- --------
2226722_4      lag-freq     serial    default          1    TIMEOUT      1:0
2226722_4.b+      batch               default          1  CANCELLED     0:15
etc....
#+END_EXAMPLE

*Conclusion*

The =lag-freq-fits.sl= script is timimng out as too many parameters
selected. Best fit was 5.9 so lets plot that again using the
parameters obtained from best above and constrain parameters tighter:

#+BEGIN_EXAMPLE
emacs best_fit_00.par

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.362676e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.210641           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              1.9           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              750           0           0
 15  lag_freq(1).t_shift    0     1              100           0           0
#+END_EXAMPLE

Use parameters in =replot-best-lag-freq-fits.sl=

#+BEGIN_EXAMPLE
pars_to_fit[0] = "t_shift";
vals_to_fit[0] = [50.0, 100.0];
pars_to_fit[1] = "t_max";
vals_to_fit[1] = [500.0, 750.0];
pars_to_fit[2] = "Gamma1";
vals_to_fit[2] = [1.8, 1.9, 2.0];
pars_to_fit[3] = "Gamma2";
vals_to_fit[3] = [1.7,1.8,1.9];
pars_to_fit[4] = "x";
vals_to_fit[4] = [0.0, 1.0, 2.0];
pars_to_fit[5] = "b";
vals_to_fit[5] = [1.0, 2.0];
pars_to_fit[6] = "h1";
vals_to_fit[6] = [2.0, 3.0, 4.0];
pars_to_fit[7] = "h2";
vals_to_fit[7] = [3.0, 4.0, 5.0, 6.0];
#+END_EXAMPLE

And

#+BEGIN_EXAMPLE
#! /bin/tcsh
#
#SBATCH --partition=serial
#SBATCH --nodes=1
#SBATCH --ntasks-per-node=1
#SBATCH --mem=2GB
#SBATCH --time=2-00:00:00
#SBATCH --job-name=lag-freq
#SBATCH --array=0-4

## Note that array should be from 0 to (n-1) and isis-script should be run with n at the end

module load CUDA
module load cURL

cd /mnt/storage/scratch/${LOGNAME}/x-ray-rev2/x-ray-reverberation

isis-script replot-best-lag-freq-fits.sl fit $SLURM_ARRAY_TASK_ID 5

sbatch submit-lag-freq.sh ////Submitted 1120 15 July 2019 //////
Submitted batch job 2230310

This script finished by 3.30 pm the same day - taking under 4 hrs !!!!
#+END_EXAMPLE

Output :

#+BEGIN_EXAMPLE
python find-best-fit.py
Best fit is 5.797827 in file best_fit_04.txt

emacs best_fit_04.par

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.787699e-05           0           1
  2  lag_freq(1).log_mass   0     0                6           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1                2           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                1           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1              100           0           0
#+END_EXAMPLE

In directory =/homeb/steff075/phd_ecm/1h0707/extended-corona= Pull in
these best fit files from BC4:

#+BEGIN_EXAMPLE
scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/best_fit_04.txt .
scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/best_fit_04.ps .
#+END_EXAMPLE
Then
#+BEGIN_EXAMPLE
ps2pdf best_fit_04.ps
mv best_fit_04.pdf best_fit_04_stat-5.797.pdf
#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495-best_fit_04-stat-5.797.png

Now run again with slightly wider Gamma and H

#+BEGIN_EXAMPLE
sacct -j 2232859
       JobID    JobName  Partition    Account  AllocCPUS      State ExitCode
------------ ---------- ---------- ---------- ---------- ---------- --------
2232859_1      lag-freq     serial    default          1    RUNNING      0:0
2232859_0      lag-freq     serial    default          1    RUNNING      0:0
#+END_EXAMPLE

#+BEGIN_EXAMPLE
python find-best-fit.py
Best fit is 5.606013 in file best_fit_01.txt

emacs best_fit_01.par

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      2.68093e-05           0           1
  2  lag_freq(1).log_mass   0     0                6           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                8           0           0
  7  lag_freq(1).Gamma1     0     1              2.1           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                1           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1              100           0           0
#+END_EXAMPLE

PATH to pars and plots =/homeb/steff075/phd_ecm/1h0707/extended-corona=

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495-best_fit_01_18June-stat5.606.png

Can I improve in smaller step sizes (t-shift and t-max?)

#+BEGIN_EXAMPLE
#! /bin/tcsh
#
#SBATCH --partition=serial
#SBATCH --nodes=1
#SBATCH --ntasks-per-node=1
#SBATCH --mem=6GB
#SBATCH --time=2-12:00:00
#SBATCH --job-name=lag-freq
#SBATCH --array=0-3

## Note that array should be from 0 to (n-1) and isis-script should be run with n at the end

module load CUDA
module load cURL

cd /mnt/storage/scratch/${LOGNAME}/x-ray-rev2/x-ray-reverberation

isis-script replot-best-lag-freq-fits.sl fit $SLURM_ARRAY_TASK_ID 4

sbatch submit-lag-freq.sh
Submitted batch job 2235783 //// 1400 19 July////

 sacct -j 2235783
       JobID    JobName  Partition    Account  AllocCPUS      State ExitCode
------------ ---------- ---------- ---------- ---------- ---------- --------
2235783_3      lag-freq     serial    default          1    RUNNING      0:0
2235783_0      lag-freq     serial    default          1    RUNNING      0:0
2235783_1      lag-freq     serial    default          1    RUNNING      0:0
2235783_2      lag-freq     serial    default          1    RUNNING      0:0
#+END_EXAMPLE

The above job basically timed out but  a better fit was achieved:

see =/homeb/steff075/phd_ecm/1h0707/extended-corona/best_fit_02.par=

#+BEGIN_EXAMPLE
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.167942e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.111761           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.1           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               75           0           0

stat=3.064
#+END_EXAMPLE

display =/homeb/steff075/phd_ecm/1h0707/extended-corona/best_fit_02.ps=

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495-best_fit_02_23June-STAT-3.06.png

Can I improve this furter?

USE =1H0707-combined-lag-freq-fits.sl= and
=1H0707-combined-submit-lag-freq.sh=

** Running Lag-freq-files code

The =lag-freq-files.sl= script will just create all the code-s and
code-x files for later fitting

Lets test by running just one file with the following pars on lines 138-153:
#+BEGIN_EXAMPLE
emacs lag-freq-files.sl

pars_to_fit[0] = "t_shift";
vals_to_fit[0] = [25.0];
pars_to_fit[1] = "t_max";
vals_to_fit[1] = [80.0];
pars_to_fit[2] = "Gamma1";
vals_to_fit[2] = [1.4];
pars_to_fit[3] = "Gamma2";
vals_to_fit[3] = [1.5];
pars_to_fit[4] = "x";
vals_to_fit[4] = [0.0];
pars_to_fit[5] = "b";
vals_to_fit[5] = [1.0];

pars_to_fit[6] = "h1";
vals_to_fit[6] = [2.0];
pars_to_fit[7] = "h2";
vals_to_fit[7] = [3.0];
#+END_EXAMPLE

edit submit script and run:

#+BEGIN_EXAMPLE
emacs submit-lag-files.sh

#! /bin/tcsh
#
#SBATCH --partition=serial
#SBATCH --nodes=1
#SBATCH --ntasks-per-node=1
#SBATCH --mem=4GB
#SBATCH --time=0-12:00:00
#SBATCH --job-name=lag-files
#SBATCH --array=0-0

## Note that array should be from 0 to (n-1) and isis-script should be run with n at the end

module load CUDA
module load cURL

cd /mnt/storage/scratch/${LOGNAME}/x-ray-rev2/x-ray-reverberation


isis-script lag-freq-files.sl $SLURM_ARRAY_TASK_ID 1

sbatch submit-lag-files.sh
Submitted batch job 2287121

sacct -j 2287121
       JobID    JobName  Partition    Account  AllocCPUS      State ExitCode
------------ ---------- ---------- ---------- ---------- ---------- --------
2287121_0     lag-files     serial    default          1  COMPLETED      0:0
2287121_0.b+      batch               default          1  COMPLETED      0:0
#+END_EXAMPLE

The will have created the file:
#+BEGIN_EXAMPLE
lag/i53/a0.998/h02.0+03.0/g1.4+1.5/A01.0/x0.0/p00.0/b01.0/q0.5/tmax0080/tshift0025/lag.fits
#+END_EXAMPLE

However I can get down to:

#+BEGIN_EXAMPLE
[so14935@bc4gpulogin1 x-ray-reverberation]$ cd lag-files/i53/a0.998/h02.0+03.0/g1.4+1.5/A01.0/x0.0/p00.0/b01.0/q0.5/
[so14935@bc4gpulogin1 q0.5]$ ls -l
drwxr-xr-x  7 so14935 phys 4096 Aug 14 21:09 tmax0050
drwxr-xr-x 13 so14935 phys 4096 Aug 14 23:03 tmax0100
drwxr-xr-x 14 so14935 phys 4096 Aug 16 10:45 tmax0150
drwxr-xr-x 14 so14935 phys 4096 Aug 16 10:45 tmax0200
drwxr-xr-x 16 so14935 phys 4096 Aug 16 10:46 tmax0250
drwxr-xr-x  9 so14935 phys 4096 Aug  4 09:59 tmax0300
drwxr-xr-x 10 so14935 phys 4096 Aug  4 10:01 tmax0350
drwxr-xr-x 17 so14935 phys 4096 Aug 16 10:43 tmax0400
drwxr-xr-x  8 so14935 phys 4096 Aug  4 10:00 tmax0450
drwxr-xr-x 19 so14935 phys 4096 Aug 16 10:46 tmax0500
drwxr-xr-x 17 so14935 phys 4096 Aug 16 10:44 tmax0550
drwxr-xr-x 18 so14935 phys 4096 Aug 16 10:44 tmax0600
drwxr-xr-x 14 so14935 phys 4096 Aug 16 10:47 tmax0650
drwxr-xr-x 14 so14935 phys 4096 Aug 16 10:47 tmax0700
drwxr-xr-x 13 so14935 phys 4096 Aug  4 10:02 tmax0750
drwxr-xr-x 19 so14935 phys 4096 Aug 16 10:45 tmax0800
drwxr-xr-x 14 so14935 phys 4096 Aug 16 10:48 tmax0850
drwxr-xr-x 18 so14935 phys 4096 Aug 14 23:05 tmax0900
drwxr-xr-x 14 so14935 phys 4096 Aug 16 10:48 tmax0950
drwxr-xr-x 18 so14935 phys 4096 Aug 14 23:06 tmax1000
drwxr-xr-x 14 so14935 phys 4096 Aug 16 10:49 tmax1050
drwxr-xr-x 16 so14935 phys 4096 Aug 14 23:06 tmax1100
drwxr-xr-x 14 so14935 phys 4096 Aug 16 10:49 tmax1200
drwxr-xr-x 13 so14935 phys 4096 Aug 14 23:07 tmax1300
[so14935@bc4gpulogin1 q0.5]$ cd tmax0050
[so14935@bc4gpulogin1 tmax0050]$ ls
tshift0025  tshift0030  tshift0035  tshift0040  tshift0045
cd tmax0100
tshift0025  tshift0035  tshift0045  tshift0060  tshift0075  tshift0090
tshift0030  tshift0040  tshift0055  tshift0070  tshift0080
#+END_EXAMPLE

So the tmax directory is in steps of 50 from 0050 to 1300 !!!!

/Conclusion/
lag-freq-files.sl did not create the appropriate file!  Need smaller
step sizes - go back ....?

** Updated Model Parameters (30 Aug 2019)

/On 30 Aug 2019, Andy and I had a Skype group discussion with Poemwai and we decided
to update the model parameters for the following:/

1. Fixing the BH mass - this should help to minimise degeneracies in
   the height fits

2. Free up Afe from its current value (fixed at solar) to 1.0 and 5.0 (allow to vary)

3. Free up $q_2$ and set for values 0.5 and 1.5 (allow to vary)

4. Fix $t_{\text{max}}$ at 400.0 to reflect the extent of the disc
   (fixed model parameter)

Now create some new files for fitting to 1H0707-495 combined lags:

Edit =lag-freq-files.sl= and submit for a range of files.

Next Try model fits on some data (first without freezing $t_{\text{max}}$ at 400$r_g$):

These fits were for the following typical par range:

#+BEGIN_EXAMPLE
pars_to_fit[0] = "t_shift";
vals_to_fit[0] = [0.0, 25.0, 30.0, 45.0, 50.0, 60.0, 65.0, 75.0, 80.0, 90.0, 100.0, 150.0];
pars_to_fit[1] = "t_max";
vals_to_fit[1] = [200.0, 250.0, 300.0, 400.0, 450.0, 500.0, 550.0, 600.0, 700.0, 750.0, 800.0];
pars_to_fit[2] = "Gamma1";
vals_to_fit[2] = [1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7];
pars_to_fit[3] = "Gamma2";
vals_to_fit[3] = [1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7];
pars_to_fit[4] = "x";
vals_to_fit[4] = [0.0, 1.0, 2.0, 3.0];
pars_to_fit[5] = "b";
vals_to_fit[5] = [1.0, 2.0, 3.0];
pars_to_fit[6] = "h1";
vals_to_fit[6] = [2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0];
pars_to_fit[7] = "h2";
vals_to_fit[7] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0];
pars_to_fit[8] = "q2";
vals_to_fit[8] = [0.5, 1.5];
pars_to_fit[9] = "Fe";
vals_to_fit[9] = [1.0, 5.0];
pars_to_fit[10] = "log_mass";
vals_to_fit[10] = [6.31];
#+END_EXAMPLE

After a couple of days:

*Combined Lags*
#+BEGIN_EXAMPLE
python find-best-fit.py
Best fit is 7.692423 in file best_fit_01.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.019928e-05           0           1
  2  lag_freq(1).log_mass   0     1             6.31           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.1           0           0
  8  lag_freq(1).Gamma2     0     1              1.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                1           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               25           0           0
#+END_EXAMPLE

*2007 Lags*
#+BEGIN_EXAMPLE
python find-best-fit-1H0707-2007.py
Best fit is 2.161866 in file 1H0707_2007_best_fit_00.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.517017e-06           0           1
  2  lag_freq(1).log_mass   0     1             6.31           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              3.1           0           0
  8  lag_freq(1).Gamma2     0     1              1.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1              100           0           0
#+END_EXAMPLE

*2008 Lags*
#+BEGIN_EXAMPLE
python find-best-fit-1H0707-2008.py
Best fit is 17.13407 in file 1H0707_2008_best_fit_08.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.611503e-05           0           1
  2  lag_freq(1).log_mass   0     1             6.31           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.1           0           0
  8  lag_freq(1).Gamma2     0     1              1.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               45           0           0
#+END_EXAMPLE

Running too many jobs - note that many scripts in queue went
*QOSMaxJobsPerUserLimit* and will not run !! Submit one large (x64
truns) script at a time!

>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>


The above fits are fairly poor try extending $\Gamma$ and freezing
$t_{\text{max}}$ at 400 and submit 64 runs using pars and *allow to complete*:

#+BEGIN_EXAMPLE
pars_to_fit[0] = "t_shift";
vals_to_fit[0] = [0.0, 10.0, 15.0, 20.0, 25.0, 30.0, 35.0, 40.0, 45.0, 50.0, 55.0, 60.0, 65.0, 75.0, 80.0, 90.0, 100.0, 150.0];
pars_to_fit[1] = "t_max";
vals_to_fit[1] = [400.0];
pars_to_fit[2] = "Gamma1";
vals_to_fit[2] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9, 3.0];
pars_to_fit[3] = "Gamma2";
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9, 3.0];
pars_to_fit[4] = "x";
vals_to_fit[4] = [0.0, 1.0, 2.0, 3.0];
pars_to_fit[5] = "b";
vals_to_fit[5] = [1.0, 2.0, 3.0];
pars_to_fit[6] = "h1";
vals_to_fit[6] = [2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0];
pars_to_fit[7] = "h2";
vals_to_fit[7] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0];
pars_to_fit[8] = "q2";
vals_to_fit[8] = [0.5, 1.5];
pars_to_fit[9] = "Fe";
vals_to_fit[9] = [1.0, 3.0, 5.0];
pars_to_fit[10] = "log_mass";
vals_to_fit[10] = [6.31];
#+END_EXAMPLE

*Combined Lags*
#+BEGIN_EXAMPLE
sbatch 1H0707-submit-lag-freq.sh
Submitted batch job 2336427     <<<< 1330 3 Sep >>>>

sacct -j 2336427

python find-best-fit.py   <<<< at 1335 3 Sep >>>>
Best fit is 51.24929 in file best_fit_40.txt

python find-best-fit.py   <<<< at 1345 3 Sep >>>>
Best fit is 24.9065 in file best_fit_44.txt

.....leave to run ......

Upon completion (after 3 days) the best fit was:

Best fit is 20.24866 in file best_fit_45.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.935778e-05           0           1
  2  lag_freq(1).log_mass   0     1             6.31           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                1           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0
#+END_EXAMPLE

Now try to narrow down the range of parameters based on the best
previous fit, ie:

#+BEGIN_EXAMPLE
emacs 1H0707-combined-lag-freq-fits.sl

pars_to_fit[0] = "t_shift";
vals_to_fit[0] = [45.0, 50.0, 55.0, 60.0, 65.0, 75.0, 80.0, 85.0, 90.0];
pars_to_fit[1] = "t_max";
vals_to_fit[1] = [400.0];
pars_to_fit[2] = "Gamma1";
vals_to_fit[2] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6];
pars_to_fit[3] = "Gamma2";
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7];
pars_to_fit[4] = "x";
vals_to_fit[4] = [0.0, 1.0, 2.0, 3.0];
pars_to_fit[5] = "b";
vals_to_fit[5] = [1.0, 2.0, 3.0];
pars_to_fit[6] = "h1";
vals_to_fit[6] = [2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0];
pars_to_fit[7] = "h2";
vals_to_fit[7] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0];
pars_to_fit[8] = "q2";
vals_to_fit[8] = [0.5, 1.5];
pars_to_fit[9] = "Fe";
vals_to_fit[9] = [1.0, 5.0];
pars_to_fit[10] = "log_mass";
vals_to_fit[10] = [6.31];

Submit for 32 runs:


sbatch 1H0707-submit-lag-freq.sh
Submitted batch job 2342533      <<<<<<< 1410 6 Sep 2019 >>>>>>>>

sacct -j 2342533   Running ........

python find-best-fit.py
Best fit is 20.24866 in file best_fit_10.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.935778e-05           0           1
  2  lag_freq(1).log_mass   0     1             6.31           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0

 Free up tmax and try again

pars_to_fit[0] = "t_shift";
vals_to_fit[0] = [45.0, 50.0, 55.0, 60.0, 65.0, 75.0, 80.0, 85.0, 90.0];
pars_to_fit[1] = "t_max";
vals_to_fit[1] = [350.0, 375.0, 400.0, 425.0, 450.0, 475.0, 500.0];
pars_to_fit[2] = "Gamma1";
vals_to_fit[2] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6];
pars_to_fit[3] = "Gamma2";
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7];
pars_to_fit[4] = "x";
vals_to_fit[4] = [0.0, 1.0, 2.0, 3.0];
pars_to_fit[5] = "b";
vals_to_fit[5] = [1.0, 2.0, 3.0];
pars_to_fit[6] = "h1";
vals_to_fit[6] = [2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0];
pars_to_fit[7] = "h2";
vals_to_fit[7] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0];
pars_to_fit[8] = "q2";
vals_to_fit[8] = [0.5, 1.5];
pars_to_fit[9] = "Fe";
vals_to_fit[9] = [1.0, 5.0];
pars_to_fit[10] = "log_mass";
vals_to_fit[10] = [6.31];


sbatch 1H0707-submit-lag-freq.sh  <<<<<<<<  0900 10 Sep 19  >>>>>>>>>>>>>
Submitted batch job 2350289

 sacct -j 2350289


Timed out at  13.84016
#+END_EXAMPLE

** Alternative fitting procedure

Lets try a slightly different apporach

Edit =best_fit.par=
#+BEGIN_EXAMPLE
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.944666e-05           0           1
  2  lag_freq(1).log_mass   0     0             6.31           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                1           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0              350         200         600
 15  lag_freq(1).t_shift    0     0               50          10         150
#+END_EXAMPLE

Edit =1H0707-combined-lag-freq-fits.sl=

#+BEGIN_EXAMPLE
% Some routine to step through all possible combinations of parameters that we are interested in
variable n_pars = 8;
variable pars_to_fit = String_Type[n_pars];
variable vals_to_fit = Array_Type[n_pars];
variable index = Integer_Type[n_pars];
% Note I've changed the order before so that the code can run code-x for different source heights
% This makes the parallelisation more efficient
%pars_to_fit[0] = "t_shift";
%vals_to_fit[0] = [45.0, 50.0, 55.0, 60.0, 65.0, 75.0, 80.0, 85.0, 90.0];
%pars_to_fit[1] = "t_max";
%vals_to_fit[1] = [350.0, 375.0, 400.0, 425.0, 450.0, 475.0, 500.0];
pars_to_fit[0] = "Gamma1";
vals_to_fit[0] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6];
pars_to_fit[1] = "Gamma2";
vals_to_fit[1] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7];
pars_to_fit[2] = "x";
vals_to_fit[2] = [0.0, 1.0, 2.0, 3.0];
pars_to_fit[3] = "b";
vals_to_fit[3] = [1.0, 2.0, 3.0];
pars_to_fit[4] = "h1";
vals_to_fit[4] = [2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0];
pars_to_fit[5] = "h2";
vals_to_fit[5] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0];
pars_to_fit[6] = "q2";
vals_to_fit[6] = [0.5, 1.5];
pars_to_fit[7] = "Fe";
vals_to_fit[7] = [1.0, 5.0];
%pars_to_fit[10] = "log_mass";
%vals_to_fit[10] = [6.31];
#+END_EXAMPLE

Now submit 2 test runs first to see if all good (these ran fine!) then:

#+BEGIN_EXAMPLE
sbatch 1H0707-submit-lag-freq.sh
Submitted batch job 2366646     <<<<< 1610  12 Sep  >>>>

sacct -j 2366646

And immediately upon running....
python find-best-fit.py
Best fit is 3.976236 in file best_fit_07.txt

emacs best_fit_07.par
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.710026e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.056774           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.1           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0              350         200         600
 15  lag_freq(1).t_shift    0     0               50          10         150

<<<<<<<<< 1425 14 Sep 2019 >>>>>>>>>>>

sacct -j 2392322


python find-best-fit.py
Best fit is 3.868602 in file best_fit_49.txt


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.737951e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.046948           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                5           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              1.9           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0              350         100         800
 15  lag_freq(1).t_shift    0     0               50          10         200

#+END_EXAMPLE

Try again by homing into t-max and t-shift values and allow to fit

#+BEGIN_EXAMPLE
<<<<<<<<< 1345 16 Sep 2019 >>>>>>>>>>>

sacct -j 2400080


python find-best-fit.py
Best fit is 3.103658 in file best_fit_34.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.950732e-05           0           1
  2  lag_freq(1).log_mass   0     0                6           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.7           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              395           0           0
 15  lag_freq(1).t_shift    0     1             52.5           0           0

#+END_EXAMPLE

Now try to set t-max and t-shift to snaller ranges

#+BEGIN_EXAMPLE
emacs 1H0707-combined-lag-freq-fits.sl

USE THESE PARS:

variable n_pars = 10;
variable pars_to_fit = String_Type[n_pars];
variable vals_to_fit = Array_Type[n_pars];
variable index = Integer_Type[n_pars];
% Note I've changed the order before so that the code can run code-x for different source heights
% This makes the parallelisation more efficient
pars_to_fit[0] = "t_shift";
vals_to_fit[0] = [35.0, 40.0, 42.5, 45.0, 47.5, 50.0, 52.5, 55.0, 57.5, 60.0, 65.0, 75.0, 80.0, 85.0, 90.0];
pars_to_fit[1] = "t_max";
vals_to_fit[1] = [350.0, 360.0, 375.0, 395, 400.0, 410.0, 425.0, 435.0, 450.0, 475.0, 500.0];
pars_to_fit[2] = "Gamma1";
vals_to_fit[2] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6];
pars_to_fit[3] = "Gamma2";
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7];
pars_to_fit[4] = "x";
vals_to_fit[4] = [0.0, 1.0, 2.0, 3.0];
pars_to_fit[5] = "b";
vals_to_fit[5] = [1.0, 2.0, 3.0];
pars_to_fit[6] = "h1";
vals_to_fit[6] = [2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0];
pars_to_fit[7] = "h2";
vals_to_fit[7] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0];
pars_to_fit[8] = "q2";
vals_to_fit[8] = [0.5, 1.5];
pars_to_fit[9] = "Fe";
vals_to_fit[9] = [1.0, 5.0];



python find-best-fit.py
Best fit is 2.633207 in file best_fit_20.txt


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.182837e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.090303           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.7           0           0
  8  lag_freq(1).Gamma2     0     1              1.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0
#+END_EXAMPLE

*This fit is the same as the best fit currently known !!!*

* Code-x files

** Old code-x files (not working)

PATH =/home/steff075/phd_ecm/ecm-files/code-x-files=

In BC4 my code-x files look like this:

#+BEGIN_EXAMPLE
[so14935@bc4gpulogin1 code-x-files]$ ls -l
total 11585024
drwxr-xr-x 3 so14935 phys17r    4096 Dec 14 15:24 i30
drwxr-xr-x 3 so14935 phys       4096 Sep 20 20:08 i35
drwxr-xr-x 3 so14935 phys17r    4096 Oct  5 09:55 i38
drwxr-xr-x 3 so14935 phys17r    4096 Nov 24 14:45 i45
drwxr-xr-x 3 so14935 phys       4096 Apr 30  2019 i53
drwxr-xr-x 3 so14935 phys       4096 Aug 21 11:51 i58
drwxr-xr-x 3 so14935 phys       4096 Sep 17 19:57 i64
-rw-r--r-- 1 so14935 phys    8804160 Mar  7  2019 x-h10-a0p998-i53-g1p4-A1-x1-p0.fits
-rw-r--r-- 1 so14935 phys    8804160 Mar  7  2019 x-h10-a0p998-i53-g1p4-A1-x1p5-p0.fits
-rw-r--r-- 1 so14935 phys    8804160 Mar  7  2019 x-h10-a0p998-i53-g1p4-A1-x2-p0.fits
-rw-r--r-- 1 so14935 phys    8804160 Mar  7  2019 x-h10-a0p998-i53-g1p4-A1-x2p5-p0.fits
-rw-r--r-- 1 so14935 phys    8804160 Mar  7  2019 x-h10-a0p998-i53-g1p4-A1-x3-p0.fits
-rw-r--r-- 1 so14935 phys    8804160 Mar  7  2019 x-h10-a0p998-i53-g1p4-A1-x3p5-p0.fits
-rw-r--r-- 1 so14935 phys    8804160 Mar  7  2019 x-h10-a0p998-i53-g1p4-A1-x4-p0.fits
-rw-r--r-- 1 so14935 phys    8804160 Mar  7  2019 x-h10-a0p998-i53-g1p6-A1-x1-p0.fits
-rw-r--r-- 1 so14935 phys    8804160 Mar  7  2019 x-h10-a0p998-i53-g1p6-A1-x1p5-p0.fits
-rw-r--r-- 1 so14935 phys    8804160 Mar  7  2019 x-h10-a0p998-i53-g1p6-A1-x2-p0.fits
-rw-r--r-- 1 so14935 phys    8804160 Mar  7  2019 x-h10-a0p998-i53-g1p6-A1-x2p5-p0.fits
-rw-r--r-- 1 so14935 phys    8804160 Mar  7  2019 x-h10-a0p998-i53-g1p6-A1-x3-p0.fits
-rw-r--r-- 1 so14935 phys    8804160 Mar  7  2019 x-h10-a0p998-i53-g1p6-A1-x3p5-p0.fits
-rw-r--r-- 1 so14935 phys    8804160 Mar  7  2019 x-h10-a0p998-i53-g1p6-A1-x4-p0.fits
-rw-r--r-- 1 so14935 phys    8804160 Mar  7  2019 x-h10-a0p998-i53-g1p8-A1-x1-p0.fits
-rw-r--r-- 1 so14935 phys    8804160 Mar  7  2019 x-h10-a0p998-i53-g1p8-A1-x1p5-p0.fits
-rw-r--r-- 1 so14935 phys    8804160 Mar  7  2019 x-h10-a0p998-i53-g1p8-A1-x2-p0.fits
#+END_EXAMPLE

So I have 2 different types of code-x files ! Lets have a look:


*First lets look at the explicitly named files e.g =x-h10-a0p998-i53-g1p4-A1-x1-p0.fits=*

Copy some code-x files of type =x-h10-a0p998-i53-g1p4-A1-x1-p0.fits=
from BC4 to Lyra, e.g:

#+BEGIN_EXAMPLE
scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/code-x-files/x-h9-a0p998-i53-g2p2-A1-x1-p0.fits .
#+END_EXAMPLE

Lets create a cvs file and look at the dataframe in PANDAS

#+BEGIN_EXAMPLE
import csv
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from astropy.io import fits as pyfits

# Prepare to write the data to a CSV file by reading the fits header line using pyfits
data = pyfits.getdata('x-h9-a0p998-i53-g1p8-A1-x1-p0.fits')
#print (data)

# Create the csv file
with open('x-h9-a0p998-i53-g1p8-A1-x1-p0.csv', 'w') as csvfile:
    writer = csv.writer(csvfile)
    writer.writerows(data)

# Import csv with pandas and name cloumn headers
cols=['Freq', 'Lag']
df = pd.read_csv('x-h9-a0p998-i53-g1p8-A1-x1-p0.csv', names=cols, header=None)
print (df)

# Plot the data
df.plot(x="Freq", y="Lag", logx=True, xlim=(3e-9,7e-7),figsize=(6,4))
#df.plot(x="Freq", y="Lag", logx=True, xlim=(1e-4,1.0), figsize=(6,4))
#plt.show()
plt.savefig('code-x-h9-a0p998-i53-g1p8-A1-x1-p0.png')
plt.close
#+END_EXAMPLE

This file looks like this:

#+BEGIN_EXAMPLE
 python fits2csv_script.py
                    Freq        Lag
0.099615    3.006793e-08  10.018208
0.101595    3.307226e-08   1.838620
0.103645    3.700573e-08   2.588500
0.105745    4.138265e-08  36.610532
0.107845    4.659628e-08   1.795331
...                  ...        ...
782.767029  1.269822e-08   1.792535
821.905457  1.073226e-08   1.514128
862.993286  8.783888e-09   1.217775
906.130554  6.867160e-09   0.888900
951.417175  5.014166e-09   0.502041

[365 rows x 2 columns]
#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/code-x-h9-a0p998-i53-g1p8-A1-x1-p0.png

And lets look at another file =x-h9-a0p998-i53-g2p6-A1-x1-p0.fits=

#+BEGIN_EXAMPLE
 python fits2csv_script.py
                    Freq         Lag
0.099615    3.766650e-07  179.803594
0.101595    4.134156e-07  152.125972
0.103645    4.626497e-07  195.521201
0.105745    5.156888e-07  433.646005
0.107845    5.780691e-07  153.081370
...                  ...         ...
782.767029  2.208424e-10    0.053049
821.905457  1.841485e-10    0.044190
862.993286  1.488824e-10    0.035074
906.130554  1.151450e-10    0.025291
951.417175  8.327434e-11    0.014128

[365 rows x 2 columns]

#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/code-x-h9-a0p998-i53-g2p6-A1-x1-p0.png

*Now lets look at the directory dominated code-x files*

Copy some code-x files of type e.g =i53/a0.998/h02.0/g2.8/A1.0/x0.0/p00.0/rev.fits=
from BC4 to Lyra, e.g:

#+BEGIN_EXAMPLE
scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/code-x-files/i53/a0.998/h02.0/g2.8/A1.0/x0.0/p00.0/rev.fits .
#+END_EXAMPLE

Now rename this file to something sensible but dirfferently from the
previous files, e.g:

#+BEGIN_EXAMPLE
mv rev.fits code-x-h2-g1pt2-A1-x0-p0.fits
#+END_EXAMPLE

Now plot using dataframe:

#+BEGIN_EXAMPLE
import csv
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from astropy.io import fits as pyfits

# Prepare to write the data to a CSV file by reading the fits header line using pyfits
data = pyfits.getdata('code-x-h2-g1pt2-A1-x0-p0.fits')
#print (data)

# Create the csv file
with open('code-x-h2-g1pt2-A1-x0-p0.csv', 'w') as csvfile:
    writer = csv.writer(csvfile)
    writer.writerows(data)

# Import csv with pandas and name cloumn headers
cols=['Freq', 'Lag']
df = pd.read_csv('code-x-h2-g1pt2-A1-x0-p0.csv', names=cols, header=None)
print (df)

# Plot the data
df.plot(x="Freq", y="Lag", logx=True, xlim=(3e-9,1e-6),figsize=(6,4))
#df.plot(x="Freq", y="Lag", logx=True, xlim=(1e-4,1.0), figsize=(6,4))
plt.title('code-x-h2-g1pt2-A1-x0-p0.fits')
plt.show()
#+END_EXAMPLE

#+BEGIN_EXAMPLE
python fits2csv_script.py
            Freq  Lag
0.099615     0.0  0.0
0.101595     0.0  0.0
0.103645     0.0  0.0
0.105745     0.0  0.0
0.107845     0.0  0.0
...          ...  ...
782.767029   0.0  0.0
821.905457   0.0  0.0
862.993286   0.0  0.0
906.130554   0.0  0.0
951.417175   0.0  0.0

[365 rows x 2 columns]
#+END_EXAMPLE

This is 1d data therfore unable to plot !!

** New code-x files as from 10 Jan 2020

Testing PATH =/home/steff075/phd_ecm/ecm-files/code-x-files=

BC4 New PATH
=/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation=

Rerun code-x in BC4

#+BEGIN_EXAMPLE
./submit-code-x.pl
 squeue | grep so14935
           2991338    serial   code-x  so14935  R       6:54      1 compute069
           2991339    serial   code-x  so14935  R       6:54      1 compute069
           2991340    serial   code-x  so14935  R       6:54      1 compute069
           2991341    serial   code-x  so14935  R       6:54      1 compute069
           2991332    serial   code-x  so14935  R       7:33      1 compute068
           2991333    serial   code-x  so14935  R       7:33      1 compute068
           2991334    serial   code-x  so14935  R       7:33      1 compute068
           2991335    serial   code-x  so14935  R       7:33      1 compute068
           2991336    serial   code-x  so14935  R       7:33      1 compute068
#+END_EXAMPLE

OK now copy 4 random code-x files into Lyra:
#+BEGIN_EXAMPLE
scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/code-x-files/i53/a0.998/h05.0/g2.0/A1.0/x0.0/p00.0/rev.fits .
#+END_EXAMPLE

Now change their names for identify explicitly:

#+BEGIN_EXAMPLE
mv rev.fits x-h2p0-g1pt4-A1-x0-p0.fits
mv rev.fits x-h2p0-g1pt8-A1-x0-p0.fits
mv rev.fits x-h5p0-g1pt4-A1-x0-p0.fits
mv rev.fits x-h5p0-g2pt0-A1-x0-p0.fits
#+END_EXAMPLE

Now create csv files and plot these to check them

Use =/home/steff075/phd_ecm/ecm-files/code-x-files/fits2csv_script.py=
or =fits2csv_script2.py= depending on what you are plotting, e.g:

Output is:

#+BEGIN_EXAMPLE
                    Freq        Lag
0.099615    1.290545e-09   1.118323
0.101595    1.315169e-09   0.662666
0.103645    1.446238e-09   1.064860
0.105745    1.519573e-09  13.873654
0.107845    1.621097e-09   0.468374
...                  ...        ...
782.767029  1.555842e-08  27.675004
821.905457  1.284616e-08  23.542093
862.993286  1.022959e-08  19.051366
906.130554  7.749736e-09  13.989740
951.417175  5.444683e-09   7.938720

[365 rows x 2 columns]
#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/x-h2p0-g1pt4-A1-x0-p0.png

This looks good! Now lets check the others:

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/x-h2p0-g1pt8-A1-x0-p0.png

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/x-h5p0-g1pt4-A1-x0-p0.png

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/x-h5p0-g2pt0-A1-x0-p0.png

** *Code-x behaviour*

*** Code-x $h_1 - h_2$

Use script =/home/steff075/phd_ecm/ecm-files/code-x-files/plot_height_script.py=

#+BEGIN_EXAMPLE
import csv
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
plt.style.use('classic')
from astropy.io import fits as pyfits

plt.rcParams['font.family'] = 'serif'
plt.rcParams['font.serif'] = ['Times New Roman'] + plt.rcParams['font.serif']

# Import csv with pandas and name cloumn headers
cols=['energy', 'rflux_oframe', 'rflux_dframe']
df1 = pd.read_csv('x-h2p0-g1pt4-A1-x0-p0.csv', names=cols, header=None)
df2 = pd.read_csv('x-h3p0-g1pt4-A1-x0-p0.csv', names=cols, header=None)
df3 = pd.read_csv('x-h4p0-g1pt4-A1-x0-p0.csv', names=cols, header=None)
df4 = pd.read_csv('x-h6p0-g1pt4-A1-x0-p0.csv', names=cols, header=None)
df6 = pd.read_csv('x-h10p0-g1pt4-A1-x0-p0.csv', names=cols, header=None)
df11 = pd.read_csv('x-h20p0-g1pt4-A1-x0-p0.csv', names=cols, header=None)

fig, ax = plt.subplots()
ax = plt.gca()
ax.get_yaxis().set_tick_params(direction='in')
ax.get_xaxis().set_tick_params(direction='in')
#ax = plt.axes(xscale='log')

# Plot the data
for frame in [df1, df2, df3, df4, df6, df11]:
   plt.plot(frame['energy'], frame['rflux_oframe'],)

plt.xlim(1e-1,1e3)
plt.ylim(2e-10,1e-5)
figsize=(10,8)
#plt.title('Code-x-g1.4-A1.0-x0.0')
plt.xlabel(r'Energy (keV)', fontsize=14)
plt.ylabel(r'Flux (erg cm$^{-2}$ s$^{-1}$)', fontsize=14)
plt.xscale('log')
plt.yscale('log')
#plt.legend(loc='best', fontsize=12)
labels = [r'$ 2~r_g$', '$3~r_g$', '$4~r_g$', '$6~r_g$', '$10~r_g$', '$20~r_g$']
plt.legend(labels, loc='upper left', frameon=False, fontsize='13',)
#line = ([-1e-5, 1.0], [0,0])
#plt.plot(line, linestyle='--', linewidth='0.3', color = 'black')
#plt.show()
#fig.savefig('code-x-height.png')
plt.savefig('code-x-height.pdf')
plt.close()
#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/code-x-height.png

*** Code-x $\Gamma_1 - \Gamma_2$

Use script =/home/steff075/phd_ecm/ecm-files/code-x-files/plot_gamma_script.py=

#+BEGIN_EXAMPLE
import csv
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
plt.style.use('classic')
from astropy.io import fits as pyfits

plt.rcParams['font.family'] = 'serif'
plt.rcParams['font.serif'] = ['Times New Roman'] + plt.rcParams['font.serif']

# Import csv with pandas and name cloumn headers
cols=['energy', 'rflux_oframe', 'rflux_dframe']
df1 = pd.read_csv('x-h2p0-g1pt4-A1-x0-p0.csv', names=cols, header=None)
#df2 = pd.read_csv('x-2p0-g1pt6-A1-x0-p0.csv', names=cols, header=None)
df3 = pd.read_csv('x-2p0-g1pt8-A1-x0-p0.csv', names=cols, header=None)
#df4 = pd.read_csv('x-2p0-g2pt0-A1-x0-p0.csv', names=cols, header=None)
df5 = pd.read_csv('x-2p0-g2pt2-A1-x0-p0.csv', names=cols, header=None)
#df6 = pd.read_csv('x-2p0-g2pt4-A1-x0-p0.csv', names=cols, header=None)
df7 = pd.read_csv('x-2p0-g2pt6-A1-x0-p0.csv', names=cols, header=None)
#df8 = pd.read_csv('x-2p0-g2pt8-A1-x0-p0.csv', names=cols, header=None)

fig, ax = plt.subplots()
ax = plt.gca()
ax.get_yaxis().set_tick_params(direction='in')
ax.get_xaxis().set_tick_params(direction='in')

# Plot the data
for frame in [df1, df3, df5, df7]:o
   plt.plot(frame['energy'], frame['rflux_oframe'],)

plt.xlim(1e-1,1e3)
plt.ylim(4e-12,1e-6)
figsize=(10,8)
plt.title('Code-x-h2-A1.0-x0.0')
plt.xlabel(r'Energy (keV)', fontsize=14)
plt.ylabel(r'Flux (erg cm$^{-2}$ s$^{-1}$)', fontsize=14)
plt.xscale('log')
plt.yscale('log')
labels = [r'$\Gamma = 1.4$', '$\Gamma = 1.8$', '$\Gamma = 2.2$', '$\Gamma = 2.6$']
plt.legend(labels, loc='best', frameon=False, fontsize='13',)
#line = ([-1e-5, 1.0], [0,0])
#plt.plot(line, linestyle='--', linewidth='0.3', color = 'black')
#plt.show()
fig.savefig('code-x-gamma.png')
plt.savefig('code-x-gamma.pdf')
plt.close()
#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/code-x-gamma.png

*** Code-x $\xi$

Use script
=/home/steff075/phd_ecm/ecm-files/code-x-files/plot_xi_script.py=

#+BEGIN_EXAMPLE
import csv
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
plt.style.use('classic')
from astropy.io import fits as pyfits


plt.rcParams['font.family'] = 'serif'
plt.rcParams['font.serif'] = ['Times New Roman'] + plt.rcParams['font.serif']

# Import csv with pandas and name cloumn headers
cols=['energy', 'rflux_oframe', 'rflux_dframe']
df1 = pd.read_csv('x-2p0-g1pt6-A1-x0-p0.csv', names=cols, header=None)
#df2 = pd.read_csv('x-2p0-g1pt6-A1-x1-p0.csv', names=cols, header=None)
df3 = pd.read_csv('x-2p0-g1pt6-A1-x2-p0.csv', names=cols, header=None)
df4 = pd.read_csv('x-2p0-g1pt6-A1-x3-p0.csv', names=cols, header=None)


fig, ax = plt.subplots()
ax = plt.gca()
ax.get_yaxis().set_tick_params(direction='in')
ax.get_xaxis().set_tick_params(direction='in')
#ax = plt.axes(xscale='log')

# Plot the data
for frame in [df1, df3, df4]:
   plt.plot(frame['energy'], frame['rflux_oframe'],)

plt.xlim(1e-1,1e3)
#plt.ylim(4e-10,3e-7)
figsize=(10,8)
#plt.title('Code-x-h2-A1.0-x0.0')
plt.xlabel(r'Energy (keV)', fontsize=14)
plt.ylabel(r'Flux (erg cm$^{-2}$ s$^{-1}$)', fontsize=14)
plt.xscale('log')
plt.yscale('log')
labels = [r'$xi = 0$', '$xi = 2$', '$xi = 3$']
plt.legend(labels, loc='best', frameon=False, fontsize='13',)
#line = ([-1e-5, 1.0], [0,0])
#plt.plot(line, linestyle='--', linewidth='0.3', color = 'black')
#plt.show()
fig.savefig('code-x-xi.png')
plt.savefig('code-x-xi.pdf')
plt.close()
#+END_EXAMPLE

Note that when plotted, $\xi = 0 \equiv \xi = 1$ so $\xi = 1$ omiitted
for clarity

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/code-x-xi.png

*** Code-x $i$ (10 - 64)

Obtain sdifferent values of i from BC4 -  Note all files are called
'rev.fits' so rename as appropriate
#+BEGIN_EXAMPLE
scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/code-x-files/i10/a0.998/h02.0/g1.4/A1.0/x0.0/p00.0/rev.fits .
mv rev.fits i10-h2-g1.4-A1-x0.fits

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/code-x-files/i30/a0.998/h02.0/g1.4/A1.0/x0.0/p00.0/rev.fits .
mv rev.fits i30-h2-g1.4-A1-x0.fits

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/code-x-files/i40/a0.998/h02.0/g1.4/A1.0/x0.0/p00.0/rev.fits .
mv rev.fits i40-h2-g1.4-A1-x0.fits

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/code-x-files/i53/a0.998/h02.0/g1.4/A1.0/x0.0/p00.0/rev.fits .
mv rev.fits i53-h2-g1.4-A1-x0.fits

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/code-x-files/i64/a0.998/h02.0/g1.4/A1.0/x0.0/p00.0/rev.fits .
mv rev.fits i64-h2-g1.4-A1-x0.fits

#+END_EXAMPLE

If Needed move all to PATH
=/home/steff075/phd_ecm/ecm-files/code-x-files=

Use script
=/home/steff075/phd_ecm/ecm-files/code-x-files/fits2csv_script2.py= to
convert files to csv', e.g:

#+BEGIN_EXAMPLE
import csv
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from astropy.io import fits as pyfits

# Prepare to write the data to a CSV file by reading the fits header line using pyfits
data = pyfits.getdata('i10-h2-g1.4-A1-x0.fits')
#print (data)

# Create the csv file
with open('i10-h2-g1.4-A1-x0.csv', 'w') as csvfile:
    writer = csv.writer(csvfile)
    writer.writerows(data)

# Import csv with pandas and name cloumn headers
cols=['1', '2', '3']
df = pd.read_csv('i10-h2-g1.4-A1-x0.csv', names=cols, header=None)
print (df)

# Plot the data
df.plot(x="1", y="2", logx=True)
#df.plot(x="Freq", y="Lag", logx=True, xlim=(1e-4,1.0), figsize=(6,4))
plt.title('x-i10-h2-g1.4-A1-x0-p0')
plt.show()
#plt.savefig('x-h2p0-g1pt4-A1-x0-p0.png')
#plt.close
#+END_EXAMPLE

Now use
=/home/steff075/phd_ecm/ecm-files/code-x-files/plot_i_script.py=

#+BEGIN_EXAMPLE
import csv
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
plt.style.use('classic')
from astropy.io import fits as pyfits

plt.rcParams['font.family'] = 'serif'
plt.rcParams['font.serif'] = ['Times New Roman'] + plt.rcParams['font.serif']

# Import csv with pandas and name cloumn headers
cols=['energy', 'rflux_oframe', 'rflux_dframe']
df1 = pd.read_csv('i10-h2-g1.4-A1-x0.csv', names=cols, header=None)
df2 = pd.read_csv('i30-h2-g1.4-A1-x0.csv', names=cols, header=None)
df3 = pd.read_csv('i40-h2-g1.4-A1-x0.csv', names=cols, header=None)
df4 = pd.read_csv('i53-h2-g1.4-A1-x0.csv', names=cols, header=None)
df5 = pd.read_csv('i64-h2-g1.4-A1-x0.csv', names=cols, header=None)

fig, ax = plt.subplots()
ax = plt.gca()
ax.get_yaxis().set_tick_params(direction='in')
ax.get_xaxis().set_tick_params(direction='in')
#ax = plt.axes(xscale='log')

# Plot the data
for frame in [df1, df2, df3, df4, df5]:
   plt.plot(frame['energy'], frame['rflux_oframe'],)

plt.xlim(1e-1,1e3)
plt.ylim(1e-10,1e-6)
figsize=(10,8)
plt.title('Code-x-g1.4-A1.0-x0.0')
plt.xlabel(r'Energy (keV)', fontsize=14)
plt.ylabel(r'Flux (erg cm$^{-2}$ s$^{-1}$)', fontsize=14)
plt.xscale('log')
plt.yscale('log')
plt.legend(loc='best', fontsize=12)
labels = [r'$ i = 10$', '$ i = 30$', '$ i = 40$', '$ i = 53$', '$ i = 64$']
plt.legend(labels, loc='upper left', frameon=False, fontsize='13',)
#line = ([-1e-5, 1.0], [0,0])
#plt.plot(line, linestyle='--', linewidth='0.3', color = 'black')
plt.show()
fig.savefig('code-x-incl.png')
plt.savefig('code-x-incl.pdf')
plt.close()
#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/code-x-incl.png

* Blob-c files

** The basics


To run the blob code for a single set of parameters (i.e. to obtain a
single lag-files) use, e.g.:

#+BEGIN_EXAMPLE
/data/typhon1/reverb/blob -o2 -d3 -i53 -g1.8 -e1.5 -A1 -x0 -p0 -y1 -l1 -b1 -w0.5 -v50 -q10
#+END_EXAMPLE


 Lag files are e.g:
 =lag/i53/a0.998/h02.0+03.0/g2.5+2.5/A01.0/x2.0/p00.0/b02.0/q0.5/tmax1000/tshift0000/lag.fits=

PATH =/homeb/steff075/phd_ecm/results/fitted-lag-files=

Pull in some of the fitted lag files, e.g:

#+BEGIN_EXAMPLE
scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/lag-files/i53/a0.998/h02.0+03.0/g2.7+2.3/A01.0/x2.0/p00.0/b02.0/q0.5/tmax0200/tshift0010/lag.fits .
#+END_EXAMPLE

rename

#+BEGIN_EXAMPLE
mv lag.fits 1H0707-495-lo-flux-lag.fits
#+END_EXAMPLE

Plot file

#+BEGIN_EXAMPLE
isis
tm1 = fits_read_table ("1H0707-495-lo-flux-lag.fits");
%tm3 = fits_read_table ("lag2b-h2+5-a0p998-i53-g3p1+2p5-A1-x2p5-p0-rs1+1-b2-q0p5-tmax1000-tshift0.fits");
xlog;
ylin;
popt.res = 1;
charsize(1.2);
ylabel("Time Lag (t_g)");
xlabel("Frequency (Hz)");
title("1H0707-495 lo-flux ECM");
connect_points(1);
plotxy(tm1.fq,tm1.lag;dcol=2,dsym=1, xrange=[1e-5,1.0]);
%plotxy(tm2.fq,tm2.lag;dcol=1,dsym=1,oplt=1);
_pgqcf (2); %make font roman
_pgsfs(3);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495-lo-flux-lag-fits-file-plot.png

Download this file here:

http://www.star.bris.ac.uk/steff/ecm/1H0707-495-lo-flux-lag.fits

Create csv file in Python using the fits file:

#+BEGIN_EXAMPLE
import csv
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from astropy.io import fits as pyfits

# Prepare to write the data to a CSV file by reading the fits header line using pyfits
data = pyfits.getdata(r'C:\Users\steff\Documents\PhD_Astro\Data\1H0707-495-lo-flux-lag.fits')
#print (data)

# Create the csv file
with open(r'C:\Users\steff\Documents\PhD_Astro\Data\1H0707-495-lo-flux-lag.csv', 'w') as csvfile:
    writer = csv.writer(csvfile)
    writer.writerows(data)

# Import csv with pandas and name cloumn headers
cols=['Freq', 'Lag']
df = pd.read_csv(r'C:\Users\steff\Documents\PhD_Astro\Data\1H0707-495-lo-flux-lag.csv', names=cols, header=None)
print (df)

# Plot the data
df.plot(x="Freq", y="Lag", logx=True, xlim=(1e-4,1.0), figsize=(6,4))
plt.show()
plt.savefig(r'C:\Users\steff\Documents\PhD_Astro\Data\1H0707-495-lo-flux-lag.pdf')
plt.savefig(r'C:\Users\steff\Documents\PhD_Astro\Data\1H0707-495-lo-flux-lag.png')
#+END_EXAMPLE
** Changing t-shift

In BC4, lets plot a range of files with varying t-shift values:

PATH =/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation=

isis script =plot-fits-files-tshift.sl=

Files originally pulled in from BC4 were, e.g:
#+BEGIN_EXAMPLE
/lag-files/i53/a0.998/h02.0+03.0/g2.7+2.3/A01.0/x2.0/p00.0/b02.0/q0.5/tmax0200/tshift0060/lag.fits
#+END_EXAMPLE

#+BEGIN_EXAMPLE
% Load required data
tm1 = fits_read_table ("lag-files/i53/a0.998/h02.0+03.0/g2.7+2.3/A01.0/x2.0/p00.0/b02.0/q0.5/tmax1000/tshift0000/lag.fits");
tm2 = fits_read_table ("lag-files/i53/a0.998/h02.0+03.0/g2.7+2.3/A01.0/x2.0/p00.0/b02.0/q0.5/tmax1000/tshift0020/lag.fits");
tm3 = fits_read_table ("lag-files/i53/a0.998/h02.0+03.0/g2.7+2.3/A01.0/x2.0/p00.0/b02.0/q0.5/tmax1000/tshift0040/lag.fits");
tm4 = fits_read_table ("lag-files/i53/a0.998/h02.0+03.0/g2.7+2.3/A01.0/x2.0/p00.0/b02.0/q0.5/tmax1000/tshift0050/lag.fits");
tm5 = fits_read_table ("lag-files/i53/a0.998/h02.0+03.0/g2.7+2.3/A01.0/x2.0/p00.0/b02.0/q0.5/tmax1000/tshift0080/lag.fits");
tm6 = fits_read_table ("lag-files/i53/a0.998/h02.0+03.0/g2.7+2.3/A01.0/x2.0/p00.0/b02.0/q0.5/tmax1000/tshift0100/lag.fits");
tm7 = fits_read_table ("lag-files/i53/a0.998/h02.0+03.0/g2.7+2.3/A01.0/x2.0/p00.0/b02.0/q0.5/tmax1000/tshift0125/lag.fits");
tm8 = fits_read_table ("lag-files/i53/a0.998/h02.0+03.0/g2.7+2.3/A01.0/x2.0/p00.0/b02.0/q0.5/tmax1000/tshift0150/lag.fits");


% Plot results
%open_plot("lag-files-delta-tshift2.png/png");
%variable pid = open_plot("lag-files-delta-tshift2.ps/cps");
charsize(1.2); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
xlog;
ylin;
popt.res = 1;
charsize(1.2);
ylabel("Time Lag (t\dg)");
xlabel("Frequency (1/t\dg)");
%title("Frequency dependent Lags (t_max = 1000, t_shift = 0 - 40)");
connect_points(1);
plotxy(tm1.fq,tm1.lag;dcol=2,dsym=1, xrange=[1e-5,1.0], yrange=[-50, 50]);
plotxy(tm2.fq,tm2.lag;dcol=3,dsym=1,oplt=1);
plotxy(tm3.fq,tm3.lag;dcol=4,dsym=1,oplt=1);
plotxy(tm4.fq,tm4.lag;dcol=5,dsym=1,oplt=1);
plotxy(tm5.fq,tm5.lag;dcol=6,dsym=1,oplt=1);
plotxy(tm6.fq,tm6.lag;dcol=7,dsym=1,oplt=1);
plotxy(tm7.fq,tm7.lag;dcol=8,dsym=1,oplt=1);
plotxy(tm8.fq,tm8.lag;dcol=1,dsym=1,oplt=1);
nice_width;
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
%close_plot;


#+END_EXAMPLE

Copy fits files to =/home/steff075/phd_ecm/ecm-files=

rename to specific lag files e.g:

#+BEGIN_EXAMPLE
mv lag.fits tshift0000-lag.fits
#+END_EXAMPLE

Generate csv files from the fits files using
=/home/steff075/phd_ecm/ecm-files/fits2csv_script.py=

Plot gamma using =/home/steff075/phd_ecm/ecm-files/plot_tshift_script.py=

*t-shift = 0, 20, 50, 100, 125 and 150*
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/ecm_tshift.png

** Changing t-max

In BC4, lets plot a range of files with varying t-max values:

PATH =/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation=

isis script =plot-fits-files.sl=

#+BEGIN_EXAMPLE

% First create the lag files below using:

sbatch submit-lag-files.sh
Submitted batch job 2700338

sacct -j 2700338

% Load required data
tm1 = fits_read_table ("lag-files/i53/a0.998/h02.0+03.0/g1.5+1.5/A01.0/x1.0/p00.0/b01.0/q0.5/tmax0500/tshift0000/lag.fits"); %Magenta
tm2 = fits_read_table ("lag-files/i53/a0.998/h02.0+03.0/g1.5+1.5/A01.0/x1.0/p00.0/b01.0/q0.5/tmax1000/tshift0000/lag.fits"); %red
tm3 = fits_read_table ("lag-files/i53/a0.998/h02.0+03.0/g1.5+1.5/A01.0/x1.0/p00.0/b01.0/q0.5/tmax2000/tshift0000/lag.fits"); %green
tm4 = fits_read_table ("lag-files/i53/a0.998/h02.0+03.0/g1.5+1.5/A01.0/x1.0/p00.0/b01.0/q0.5/tmax3000/tshift0000/lag.fits"); %blue
tm5 = fits_read_table ("lag-files/i53/a0.998/h02.0+03.0/g1.5+1.5/A01.0/x1.0/p00.0/b01.0/q0.5/tmax4000/tshift0000/lag.fits"); %cyan
tm6 = fits_read_table ("lag-files/i53/a0.998/h02.0+03.0/g1.5+1.5/A01.0/x1.0/p00.0/b01.0/q0.5/tmax5000/tshift0000/lag.fits"); %black


%Plot results
open_plot("lag-files-delta-tmax.png/png");
xlog;
ylin;
popt.res = 1;
charsize(1.2);
ylabel("Time Lag (t_g)");
xlabel("Frequency (1/t_g)");
%title("Frequency dependent Lags (t_max = 1000, t_shift = 0 - 40)");
connect_points(1);
plotxy(tm1.fq,tm1.lag;dcol=6,dsym=1, xrange=[1e-5,1.0], yrange=[-25, 3]);
plotxy(tm2.fq,tm2.lag;dcol=2,dsym=1,oplt=1);
plotxy(tm3.fq,tm3.lag;dcol=3,dsym=1,oplt=1);
plotxy(tm4.fq,tm4.lag;dcol=4,dsym=1,oplt=1);
plotxy(tm5.fq,tm5.lag;dcol=5,dsym=1,oplt=1);
plotxy(tm6.fq,tm6.lag;dcol=1,dsym=1,oplt=1);

nice_width;
_pgqcf (2); %make font roman
_pgsfs(3);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
close_plot;
#+END_EXAMPLE

Also plot via =/home/steff075/phd_ecm/ecm-files/ecm_tmax.png=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/ecm_tmax.png


*Now try with different values of $\Gamma$*

#+BEGIN_EXAMPLE
% Load required data
tm1 = fits_read_table ("lag-files/i53/a0.998/h02.0+03.0/g2.0+1.5/A01.0/x1.0/p00.0/b01.0/q0.5/tmax0100/tshift0010/lag.fits"); %Magenta
tm2 = fits_read_table ("lag-files/i53/a0.998/h02.0+03.0/g2.0+1.5/A01.0/x1.0/p00.0/b01.0/q0.5/tmax0300/tshift0010/lag.fits"); %red
tm3 = fits_read_table ("lag-files/i53/a0.998/h02.0+03.0/g2.0+1.5/A01.0/x1.0/p00.0/b01.0/q0.5/tmax0500/tshift0010/lag.fits"); %green
tm4 = fits_read_table ("lag-files/i53/a0.998/h02.0+03.0/g2.0+1.5/A01.0/x1.0/p00.0/b01.0/q0.5/tmax0700/tshift0010/lag.fits"); %blue
%tm5 = fits_read_table ("lag-files/i53/a0.998/h02.0+03.0/g2.0+1.5/A01.0/x1.0/p00.0/b01.0/q0.5/tmax0900/tshift0010/lag.fits"); %cyan
%tm6 = fits_read_table ("lag-files/i53/a0.998/h02.0+03.0/g2.0+1.5/A01.0/x1.0/p00.0/b01.0/q0.5/tmax1100/tshift0010/lag.fits"); %black

%Plot results
open_plot("lag-files-delta-tmax2.png/png");
xlog;
ylin;
popt.res = 1;
charsize(1.2);
ylabel("Time Lag (t_g)");
xlabel("Frequency (1/t_g)");
%title("Frequency dependent Lags (t_max = 1000, t_shift = 0 - 40)");
connect_points(1);
plotxy(tm1.fq,tm1.lag;dcol=6,dsym=1, xrange=[1e-5,1.0], yrange=[-10,15]);
plotxy(tm2.fq,tm2.lag;dcol=2,dsym=1,oplt=1);
plotxy(tm3.fq,tm3.lag;dcol=3,dsym=1,oplt=1);
plotxy(tm4.fq,tm4.lag;dcol=4,dsym=1,oplt=1);
%plotxy(tm5.fq,tm5.lag;dcol=5,dsym=1,oplt=1);
%plotxy(tm6.fq,tm6.lag;dcol=1,dsym=1,oplt=1);

nice_width;
_pgqcf (2); %make font roman
_pgsfs(3);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
close_plot;

#+END_EXAMPLE

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/ecm_tmax2.png

** Changing gamma

In BC4, lets plot a range of files with varying t-max values:

PATH =/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation=

isis script =plot-fits-files.sl=

#+BEGIN_EXAMPLE
% Load required data
tm1 = fits_read_table ("lag-files/i53/a0.998/h02.0+03.0/g2.0+1.7/A01.0/x2.0/p00.0/b02.0/q0.5/tmax1000/tshift0000/lag.fits");
tm2 = fits_read_table ("lag-files/i53/a0.998/h02.0+03.0/g2.1+1.9/A01.0/x2.0/p00.0/b02.0/q0.5/tmax1000/tshift0000/lag.fits");
tm3 = fits_read_table ("lag-files/i53/a0.998/h02.0+03.0/g2.1+2.0/A01.0/x2.0/p00.0/b02.0/q0.5/tmax1000/tshift0000/lag.fits");
tm4 = fits_read_table ("lag-files/i53/a0.998/h02.0+03.0/g2.1+2.1/A01.0/x2.0/p00.0/b02.0/q0.5/tmax1000/tshift0000/lag.fits");
tm5 = fits_read_table ("lag-files/i53/a0.998/h02.0+03.0/g2.1+2.3/A01.0/x2.0/p00.0/b02.0/q0.5/tmax1000/tshift0000/lag.fits");
tm6 = fits_read_table ("lag-files/i53/a0.998/h02.0+03.0/g2.1+2.5/A01.0/x2.0/p00.0/b02.0/q0.5/tmax1000/tshift0000/lag.fits");
tm7 = fits_read_table ("lag-files/i53/a0.998/h02.0+03.0/g2.1+2.6/A01.0/x2.0/p00.0/b02.0/q0.5/tmax1000/tshift0000/lag.fits");

% Plot results
open_plot("lag-files-delta-gamma.png/png");
xlog;
ylin;
popt.res = 1;
charsize(1.2);
ylabel("Time Lag (t_g)");
xlabel("Frequency (Hz)");
%title("Frequency dependent Lags (t_max = 1000, t_shift = 0 - 40)");
connect_points(1);
plotxy(tm1.fq,tm1.lag;dcol=6,dsym=1, xrange=[1e-5,1.0], yrange=[-40, 15]);
plotxy(tm2.fq,tm2.lag;dcol=2,dsym=1,oplt=1);
plotxy(tm3.fq,tm3.lag;dcol=3,dsym=1,oplt=1);
plotxy(tm4.fq,tm4.lag;dcol=4,dsym=1,oplt=1);
plotxy(tm5.fq,tm5.lag;dcol=5,dsym=1,oplt=1);
plotxy(tm6.fq,tm6.lag;dcol=8,dsym=1,oplt=1);
plotxy(tm7.fq,tm7.lag;dcol=1,dsym=1,oplt=1);

nice_width;
_pgqcf (2); %make font roman
_pgsfs(3);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
close_plot;
#+END_EXAMPLE

Copy fits files to =/home/steff075/phd_ecm/ecm-files=

rename to specific lag files e.g:

#+BEGIN_EXAMPLE
mv lag.fits gamma020+017-lag.fits
#+END_EXAMPLE

Generate csv files from the fits files using
=/home/steff075/phd_ecm/ecm-files/fits2csv_script.py=

Plot gamma using =/home/steff075/phd_ecm/ecm-files/plot_gamma_script.py=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/ecm_gamma.png


For new files created after 10 Jan 20 on PWD
=/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation=

File =/home/steff075/phd_ecm/ecm-files/new-lag-files/plot_gamma_script.py=

Parameters =h2-h3-A1-x1-tmax0100-tshift0050.csv=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/new-lag-gamma.png

** Changing Height

In BC4, lets plot a range of files with varying t-max values:

PATH =/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation=

isis script =plot-fits-files.sl=

#+BEGIN_EXAMPLE
% Load required data
tm1 = fits_read_table ("lag-files/i53/a0.998/h02.0+04.0/g2.0+2.0/A01.0/x2.0/p00.0/b02.0/q0.5/tmax0100/tshift0000/lag.fits"); %Magenta
tm2 = fits_read_table ("lag-files/i53/a0.998/h02.0+05.0/g2.0+2.0/A01.0/x2.0/p00.0/b02.0/q0.5/tmax0100/tshift0000/lag.fits"); %red
tm3 = fits_read_table ("lag-files/i53/a0.998/h02.0+06.0/g2.0+2.0/A01.0/x2.0/p00.0/b02.0/q0.5/tmax0100/tshift0000/lag.fits"); %green
%tm4 = fits_read_table ("lag-files/i53/a0.998/h02.0+10.0/g2.0+2.0/A01.0/x2.0/p00.0/b02.0/q0.5/tmax0100/tshift0000/lag.fits"); %blue
%tm5 = fits_read_table ("lag-files/i53/a0.998/h02.0+12.0/g2.0+2.0/A01.0/x2.0/p00.0/b02.0/q0.5/tmax0400/tshift0000/lag.fits"); %cyan
%tm6 = fits_read_table ("lag-files/i53/a0.998/h02.0+16.0/g2.0+2.0/A01.0/x2.0/p00.0/b02.0/q0.5/tmax0400/tshift0000/lag.fits"); %orange
%tm7 = fits_read_table ("lag-files/i53/a0.998/h02.0+20.0/g2.0+2.0/A01.0/x2.0/p00.0/b02.0/q0.5/tmax0400/tshift0000/lag.fits"); %black


% Plot results
open_plot("lag-files-delta-gamma.png/png");
xlog;
ylin;
popt.res = 1;
charsize(1.2);
ylabel("Time Lag (t_g)");
xlabel("Frequency (Hz)");
%title("Frequency dependent Lags (t_max = 1000, t_shift = 0 - 40)");
connect_points(1);
plotxy(tm1.fq,tm1.lag;dcol=6,dsym=1, xrange=[1e-5,1.0], yrange=[-40, 15]);
plotxy(tm2.fq,tm2.lag;dcol=2,dsym=1,oplt=1);
plotxy(tm3.fq,tm3.lag;dcol=3,dsym=1,oplt=1);
%plotxy(tm4.fq,tm4.lag;dcol=4,dsym=1,oplt=1);
%plotxy(tm5.fq,tm5.lag;dcol=5,dsym=1,oplt=1);
%plotxy(tm6.fq,tm6.lag;dcol=8,dsym=1,oplt=1);
%plotxy(tm7.fq,tm7.lag;dcol=1,dsym=1,oplt=1);

nice_width;
_pgqcf (2); %make font roman
_pgsfs(3);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
close_plot;
#+END_EXAMPLE

Copy fits files to =/home/steff075/phd_ecm/ecm-files=

rename to specific lag files e.g:

#+BEGIN_EXAMPLE
mv lag.fits
h2-h3-gamma2-tmax400.csv#+END_EXAMPLE
#+END_EXAMPLE
Generate csv files from the fits files using
=/home/steff075/phd_ecm/ecm-files/fits2csv_script.py=

Plot gamma using =/home/steff075/phd_ecm/ecm-files/plot_height_script.py=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/ecm_height.png

This model shape is similar to *Fano Resonance* seen at:

https://en.wikipedia.org/wiki/Fano_resonance

This is modelled in python by the *BreitWignerModel*. see e.g. https://lmfit.github.io/lmfit-py/builtin_models.html#lmfit.models.BreitWignerModel

>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

Lets look at more of these files taht exist!

*You will need to copy these into Lyra to procede with plotting -
ensure you name accordingly!!!!*

script =/home/steff075/phd_ecm/ecm-files/plot_height_script.py=

#+BEGIN_EXAMPLE
import csv
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
plt.style.use('classic')
from astropy.io import fits as pyfits

plt.rcParams['font.family'] = 'serif'
plt.rcParams['font.serif'] = ['Times New Roman'] + plt.rcParams['font.serif']

# Import csv with pandas and name cloumn headers
cols=['Freq', 'Lag']

df1 = pd.read_csv('h2-h3-g2-g2-A1-x1-b1-tmax150-tshift10.csv', names=cols, header=None)
df2 = pd.read_csv('h2-h4-g2-g2p1-A1-x1-b1-tmax150-tshift10.csv', names=cols, header=None)
df3 = pd.read_csv('h2-h6-g2-g2p1-A1-x1-b1-tmax350-tshift50.csv', names=cols, header=None)
#df4 = pd.read_csv('h2-h7-g2-g2p1-A1-x1-b1-tmax350-tshift50.csv', names=cols, header=None)
df5 = pd.read_csv('h2-h8-g2-g2p1-A1-x1-b1-tmax350-tshift50.csv', names=cols, header=None)
df6 = pd.read_csv('h2-h10-g2-g2p1-A1-x1-b1-tmax350-tshift50.csv', names=cols, header=None)
df7 = pd.read_csv('h2-h12-g2-g2p0-A1-x1-b1-tmax250-tshift00.csv', names=cols, header=None)

fig, ax = plt.subplots()
ax = plt.gca()
ax.get_yaxis().set_tick_params(direction='in')
ax.get_xaxis().set_tick_params(direction='in')
ax = plt.axes(xscale='log')

# Plot the data
for frame in [df1, df2, df3, df5, df6, df7]:
#for frame in [df1, df2, df3, df4, df5, df6, df7]:
    plt.plot(frame['Freq'], frame['Lag'])

plt.xlim(1e-5,1.0)
plt.ylim(-15,12.0)
figsize=(10,8)
plt.xlabel(r'Frequency $(1/t_g)$', fontsize=14)
plt.ylabel(r'Time Lag $(t_g)$', fontsize=14)
plt.xscale('log')
labels = [r'$h_1 = 2, h_2 = 3, t_{\mathrm{max}} = 150, t_{\mathrm{shift}} = 10$', '$h_1 = 2, h_2 = 4, t_{\mathrm{max}} = 150, t_{\mathrm{shift}} = 10$', '$h_1 = 2, h_2 = 6, t_{\mathrm{max}} = 350, t_{\mathrm{shift}} = 50$', '$h_1 = 2, h_2 = 8, t_{\mathrm{max}} = 350, t_{\mathrm{shift}} = 50$','$h_1 = 2 , h_2 = 10, t_{\mathrm{max}} = 350, t_{\mathrm{shift}} = 50$','$h_1 = 2, h_2 = 12, t_{\mathrm{max}} = 250, t_{\mathrm{shift}} = 0$']
plt.legend(labels, loc='best', frameon=False, fontsize='14',)
line = ([-1e-5, 1.0], [0,0])
plt.plot(line, linestyle='--', linewidth='0.3', color = 'black')
#plt.show()
fig.savefig('ecm_height2.png')
plt.savefig('ecm_height2.pdf')
plt.close()
#+END_EXAMPLE

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/ecm_height2.png

** 1H0707-495 fits files

The combined lag file for 1H0707-495 was:

#+BEGIN_EXAMPLE
Best fit is 2.633207 in file best_fit_04.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.182837e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.090303           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.7           0           0
  8  lag_freq(1).Gamma2     0     1              1.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0
#+END_EXAMPLE

#+BEGIN_EXAMPLE
/home/steff075/phd_ecm/1h0707/1H0707-495-time-lag-fits/1H0707-495-combined-time-lags.fits
#+END_EXAMPLE

Copied and renamed to

#+BEGIN_EXAMPLE
/home/steff075/phd_ecm/results/fitted-lag-files/1H0707-495-combined-Data.fits
#+END_EXAMPLE


The best fit for the combined lags of 1H0707-495 was:

#+BEGIN_EXAMPLE
lag-files/i53/a0.998/h02.0+03.0/g1.7+1.5/A01.0/x3.0/p00.0/b02.0/q0.5/tmax0500/tshift0080/lag.fits
#+END_EXAMPLE

File copied and renamed to:

#+BEGIN_EXAMPLE
/home/steff075/phd_ecm/results/fitted-lag-files/1H0707-495-combined-ecm-Model.fits
#+END_EXAMPLE

For the two fits files above, generate associated csv files using

=/home/steff075/phd_ecm/results/fitted-lag-files/fits2csv_script.py=

*Run on the Data:* We already know from the timing analysis waht the data lags are:

+---+----------+----------+------------+-----------+
|   |     Freq | Freq_err |        Lag |   Lag-err |
+---+----------+----------+------------+-----------+
| 0 | 0.000116 | 0.000036 | 118.021500 | 58.997980 |
+---+----------+----------+------------+-----------+
| 1 | 0.000222 | 0.000069 | 163.299200 | 21.828660 |
+---+----------+----------+------------+-----------+
| 2 | 0.000424 | 0.000133 |  44.376240 | 11.712300 |
+---+----------+----------+------------+-----------+
| 3 | 0.000810 | 0.000253 | -15.504550 |  6.565147 |
+---+----------+----------+------------+-----------+
| 4 | 0.001546 | 0.000483 | -29.159780 |  3.632464 |
+---+----------+----------+------------+-----------+
| 5 | 0.002951 | 0.000922 | -16.995170 |  3.925964 |
+---+----------+----------+------------+-----------+
| 6 | 0.005633 | 0.001760 |  -9.626157 |  7.423369 |
+---+----------+----------+------------+-----------+


Plot this using thae same script as above:

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495-combined-Data.png

*Run on the ECM Model:* remeber that the ECM Model uses units of time in
 $t_g = GM/c^3$ and the Frequency = $1/t_g$

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495-combined-ecm-model.png


This file is also located at: =/homeb/steff075/phd_ecm/1h0707/extended-corona/1H0707-combined-ecm.fits=

This file can be downloaded here: http://www.star.bris.ac.uk/steff/ecm/1H0707-combined-ecm.fits

The Model csv file can be downloaded here: http://www.star.bris.ac.uk/steff/ecm/1H0707-495-combined-lag.csv

*Important*

ECM Model uses  *gravitational units* as stated above so we need to *scale the Data plot to the Model Plot*

The Data csv file can be downloaded here: http://www.star.bris.ac.uk/steff/ecm/1H0707-495-combined-Data.csv

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495-comb-Data-scaled-tg.png

+---+----------+----------+------------+-----------+-----------+-------------+----------+--------------+
|   |     Freq | Freq_err |        Lag |   Lag_err |   Lag_t_g | Lag_err_t_g | Freq_t_g | Freq_err_t_g |
+---+----------+----------+------------+-----------+-----------+-------------+----------+--------------+
| 0 | 0.000116 | 0.000036 | 118.021500 | 58.997980 | 11.575861 |    5.786678 | 0.001186 |     0.000371 |
+---+----------+----------+------------+-----------+-----------+-------------+----------+--------------+
| 1 | 0.000222 | 0.000069 | 163.299200 | 21.828660 | 16.016817 |    2.141013 | 0.002265 |     0.000708 |
+---+----------+----------+------------+-----------+-----------+-------------+----------+--------------+
| 2 | 0.000424 | 0.000133 |  44.376240 | 11.712300 |  4.352539 |    1.148773 | 0.004324 |     0.001351 |
+---+----------+----------+------------+-----------+-----------+-------------+----------+--------------+
| 3 | 0.000810 | 0.000253 | -15.504550 |  6.565147 | -1.520727 |    0.643927 | 0.008255 |     0.002580 |
+---+----------+----------+------------+-----------+-----------+-------------+----------+--------------+
| 4 | 0.001546 | 0.000483 | -29.159780 |  3.632464 | -2.860068 |    0.356282 | 0.015759 |     0.004925 |
+---+----------+----------+------------+-----------+-----------+-------------+----------+--------------+
| 5 | 0.002951 | 0.000922 | -16.995170 |  3.925964 | -1.666931 |    0.385069 | 0.030086 |     0.009402 |
+---+----------+----------+------------+-----------+-----------+-------------+----------+--------------+
| 6 | 0.005633 | 0.001760 |  -9.626157 |  7.423369 | -0.944159 |    0.728104 | 0.057436 |     0.017949 |
+---+----------+----------+------------+-----------+-----------+-------------+----------+--------------+

Now lets see the model and the data plotted to gether in units of $t_g$:

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495-data-vs-ecm-model.png

Script for above data plots =/home/steff075/phd_ecm/results/fitted-lag-files/fits2csv_script.py=

The above plot was done using
=/home/steff075/phd_ecm/results/fitted-lag-files/data-model-functions.py=

#+BEGIN_EXAMPLE
import csv
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from astropy.io import fits as pyfits
plt.style.use('classic')

plt.rcParams['font.family'] = 'serif'
#plt.rcParams['font.serif'] = ['Times New Roman'] + plt.rcParams['font.serif']

import csv
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

# Import Data csv with pandas and name cloumn headers
df1cols=['Data_Freq','Data_Freq_err','Data_Lag','Data_Lag_err']
df1 = pd.read_csv('http://www.star.bris.ac.uk/steff/ecm/1H0707-495-combined-Data.csv', names=df1cols,  header=None)

# Define units of tg = GM/c^3
# tg = LogM * M_sun * G / c^3 =((2041737.945*2E33*6.67408E-8)/(2.99E10)**3) in cgs units
# Define M = mass of AGN in M_sun
M = 2.041737945E6
M_sun = 2E33
tg = 4.94E-6*M
print (r'The Gravitational time is 1t_g =',tg,'s')


#Create columns of t_g values for Freq and Lag
df1['Data_Lag_tg'] = df1['Data_Lag']/tg
df1['Data_Lag_err_tg'] = df1['Data_Lag_err']/tg
df1['Data_Freq_tg'] = df1['Data_Freq']/(1/tg)
df1['Data_Freq_err_tg'] = df1['Data_Freq_err']/(1/tg)
df1_data = df1[['Data_Freq_tg','Data_Lag_tg']]
print (df1_data)


# Import Model csv with pandas and name cloumn headers
# The model already uses units of t_g
df2cols=['Model_Freq_tg','Model_Lag_tg']
df2 = pd.read_csv('http://www.star.bris.ac.uk/steff/ecm/1H0707-495-combined-lag.csv', names=df2cols, header=None)
print (df2)

# Plot both data and model together
fig = plt.figure()

for frame in [df1, df2]:
    plt.plot(frame['Freq_tg'], frame['Lag_tg'])
    plt.xscale('log')
    plt.xlim(1e-3,0.1)
    plt.ylim(-20,20)
    plt.xlabel(r'Frequency $(1/t_g)$', fontsize=14)
    plt.ylabel(r'Time Lag $(t_g)$', fontsize=14)
    labels = [r'Data','Model']
    plt.legend(labels, loc='upper right', frameon=False, prop={"family":"serif"}, fontsize=15)
    line = ([-1e-5, 1.0], [0,0])
    plt.plot(line, linestyle='--', linewidth='0.3', color = 'black')
plt.show()
#plt.savefig('1H0707-495-data-vs-ecm-model')
#plt.close()

#+END_EXAMPLE

** 1H0707-495 move to MLE

See my PC data =1H0707-model-data-function-for-MLE.ipynb=

#+BEGIN_EXAMPLE
#Set up Bayesain properties
# See e.g. https://towardsdatascience.com/a-gentle-introduction-to-maximum-likelihood-estimation-9fbff27ea12f

# Plot just the model fit using df2:

plt.plot(df2['Freq_tg'], df2['Lag_tg'])
plt.xscale('log')
plt.xlim(1e-3,0.1)
plt.ylim(-20,15)
plt.xlabel(r'Frequency $(1/t_g)$', fontsize=14)
plt.ylabel(r'Time Lag $(t_g)$', fontsize=14)
labels = [r'1H0707(combined)ECM Model Fit']
plt.legend(labels, loc='upper right', frameon=False, prop={"family":"serif"}, fontsize=15)
line = ([-1e-5, 1.0], [0,0])
plt.plot(line, linestyle='--', linewidth='0.4', color = 'black')
plt.show()
#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_combined_ECM_Model_Fit.png

#+BEGIN_EXAMPLE
import numpy as np
import scipy.stats as st
import statsmodels.datasets
import matplotlib.pyplot as plt

# The likelihood of the model
m_mean_likelihood = np.mean(df2)
m_std_likelihood = np.std(df2)
m_var_likelihood = np.var(df2)

print(m_mean_likelihood, m_std_likelihood, m_var_likelihood)

Freq_tg    0.071070
Lag_tg     0.259392
dtype: float64 Freq_tg    0.153300
Lag_tg     3.399797
dtype: float64 Freq_tg     0.023501
Lag_tg     11.558618
dtype: float64
#+END_EXAMPLE

#+BEGIN_EXAMPLE
# Create new dataframe for just the lag & Freq for df1 (in tg)

df3 = df1.iloc[:,[6,4]]
df3

        Freq_tg 	Lag_tg
0 	0.001174 	11.701302
1 	0.002241 	16.190382
2 	0.004278 	4.399705
3 	0.008166 	-1.537207
4 	0.015590 	-2.891061
5 	0.029763 	-1.684995
6 	0.056820 	-0.954390
#+END_EXAMPLE

#+BEGIN_EXAMPLE
# likelihood of the observation - Note that this will become the Prior i.e. Prior = obs
obs_mean_likelihood = np.std(df3)
obs_std_likelihood = np.std(df3)
obs_var_likelihood = np.var(df3)
#+END_EXAMPLE

#+BEGIN_EXAMPLE
# The posterior - used function from DA Lecture 4
n = len(df2)
mean_posterior = (obs_var_likelihood * m_mean_likelihood)/(obs_var_likelihood + m_var_likelihood/n) + (m_var_likelihood * obs_mean_likelihood/n)/(obs_var_likelihood + m_var_likelihood/n)
var_posterior = (m_var_likelihood * obs_var_likelihood/n)/(obs_var_likelihood + m_var_likelihood/n)
std_posterior = np.sqrt(var_posterior)

mean_posterior = mean_posterior.astype('float64', copy=False)
#mean_posterior = rep_points['Freq_tg','Lag_tg'].tolist()
#mean_posterior = mean_posterior.astype('int')


pd.to_numeric(mean_posterior, downcast='float')
mean_posterior

#print ('The analytical mean lag-frequency is' )
#print ('The analytical mean lag-frequency is' %mean_posterior )
#print(mean_posterior)
#std_posterior


Freq_tg    0.064794
Lag_tg     0.262633
dtype: float64
#+END_EXAMPLE


#+BEGIN_EXAMPLE
# Plot the Posterior
plt.figure(figsize =[10,6])
x = np.linspace(1e-04, 1e02, 100)
x
posterior-analytical = stats.norm(mean_posterior, std_posterior).pdf(x)
#plt.plot(x, posterior-analytical, 'b')
#plt.xlabel('Mean Freq (1/tg)').plt.ylabel('mean lag (tg)')
#plt.title('1H0707-495 Analytical pstetrior')
#+END_EXAMPLE


#+BEGIN_EXAMPLE

#+END_EXAMPLE

* Strongest Model features

*Univariate Selection*

Statistical tests can be used to select those features that have the strongest relationship with the output variable.
The scikit-learn library provides the SelectKBest class that can be
used with a suite of different statistical tests to select a specific number of features.

The example below uses the $\chi^2$ statistical test for non-negative
features to select 4 of the best features.

*The 4 strongest features*

The two source Heights
$H_1$ and $H_2$, and also $t_{max}$ and $t_{shift}$ were identified as
the 4 strongest features.

#+BEGIN_EXAMPLE
import pandas as pd
from matplotlib import pyplot as plt
import numpy as np
import math
from sklearn.feature_selection import SelectKBest
from sklearn.feature_selection import chi2

df = pd.read_csv(
    filepath_or_buffer='http://www.star.bris.ac.uk/steff/ecm/ecm-model-pars-2sources.csv', header=1, sep=',')

df.columns=['H1', 'H2', 'Gamma1', 'Gamma2','Fe','xi','b','q2','tmax','tshift','Class']
df.dropna(how="all", inplace=True) # drops the empty line at file-end
#del df['Class']
#df
df.tail()

|     | H1 | H2 | Gamma1 | Gamma2 | Fe | xi | b |  q2 | tmax | tshift | Class |
| 194 |  5 |  6 |    1.9 |    2.3 |  1 |  1 | 2 | 0.5 |  175 |     40 | lo    |
| 195 |  6 |  7 |    2.0 |    2.4 |  1 |  1 | 3 | 0.5 |  200 |     50 | lo    |
| 196 |  7 |  8 |    2.1 |    2.5 |  1 |  2 | 1 | 0.5 |  225 |     60 | lo    |
| 197 |  8 | 10 |    2.2 |    2.6 |  1 |  0 | 1 | 0.5 |  250 |     70 | lo    |
| 198 |  3 |  6 |    1.9 |    2.3 |  1 |  1 | 2 | 0.5 |  175 |     40 | lo    |

X = df.iloc[:,0:10].values
Y = df.iloc[:,10].values

# feature extraction
test = SelectKBest(score_func=chi2, k=4) #select 4 of the best features from the ecm data
fit = test.fit(X, Y)
# summarize scores
np.set_printoptions(precision=3)
print(fit.scores_)
features = fit.transform(X)
# summarize selected features
print(features[0:5,:])

[5.301e+02 4.158e+02 1.830e+00 8.015e-01 6.136e+00 1.753e-01 2.926e-01 6.718e-01 7.223e+02 2.985e+02]
[[  3.   4. 125.  20.]
 [  4.   5. 150.  30.]
 [  5.   6. 175.  40.]
 [  6.   7. 200.  50.]
 [  7.   8. 225.  60.]]
#+END_EXAMPLE

*The 6 strongest features*

The two source Heights
$H_1$ and $H_2$, $\xi$, $\Gamma_1$ and also $t_{max}$ and $t_{shift}$ were identified as
the 6 strongest features.

#+BEGIN_EXAMPLE
import pandas as pd
from matplotlib import pyplot as plt
import numpy as np
import math
from sklearn.feature_selection import SelectKBest
from sklearn.feature_selection import chi2

df = pd.read_csv(
    filepath_or_buffer='http://www.star.bris.ac.uk/steff/ecm/ecm-model-pars-2sources.csv', header=1, sep=',')

df.columns=['H1', 'H2', 'Gamma1', 'Gamma2','Fe','xi','b','q2','tmax','tshift','Class']
df.dropna(how="all", inplace=True) # drops the empty line at file-end
del df['Gamma2']
df
#df.tail()

H1 	H2 	Gamma1 	Fe 	xi 	b 	q2 	tmax 	tshift 	Class
0 	3 	4 	1.5 	2 	1 	2 	0.6 	125 	20 	lo
1 	4 	5 	1.6 	3 	2 	3 	0.7 	150 	30 	lo
2 	5 	6 	1.7 	4 	3 	1 	0.8 	175 	40 	lo
3 	6 	7 	1.8 	5 	0 	2 	0.9 	200 	50 	lo
4 	7 	8 	1.9 	1 	1 	3 	1.0 	225 	60 	lo
... 	... 	... 	... 	... 	... 	... 	... 	... 	... 	...
194 	5 	6 	1.9 	1 	1 	2 	0.5 	175 	40 	lo
195 	6 	7 	2.0 	1 	1 	3 	0.5 	200 	50 	lo
196 	7 	8 	2.1 	1 	2 	1 	0.5 	225 	60 	lo
197 	8 	10 	2.2 	1 	0 	1 	0.5 	250 	70 	lo
198 	3 	6 	1.9 	1 	1 	2 	0.5 	175 	40 	lo

199 rows × 10 columns

#ref: https://machinelearningmastery.com/feature-selection-machine-learning-python/

X = df.iloc[:,0:9].values
Y = df.iloc[:,9].values


# feature extraction
test = SelectKBest(score_func=chi2, k=6) #select 4 of the best features from the ecm data
fit = test.fit(X, Y)
# summarize scores
np.set_printoptions(precision=3)
print(fit.scores_)
features = fit.transform(X)
# summarize selected features
print(features[0:5,:])

[5.301e+02 4.158e+02 1.830e+00 6.136e+00 1.753e-01 2.926e-01 6.718e-01 7.223e+02 2.985e+02]
[[  3.    4.    1.5   2.  125.   20. ]
 [  4.    5.    1.6   3.  150.   30. ]
 [  5.    6.    1.7   4.  175.   40. ]
 [  6.    7.    1.8   5.  200.   50. ]
 [  7.    8.    1.9   1.  225.   60. ]]
#+END_EXAMPLE

* Apply PCA to the ECM

** Data files

*Dataset of 700 ecm models with 1 source height and 1 Gamma*

http://www.star.bris.ac.uk/steff/ecm/ecm-model-pars-700.csv

*Dataset 200 models with 2 source hights*

These source heights have 3 classes: H2 - H10, H10 - H16 = Med, H17 -
H18 = Hi.

http://www.star.bris.ac.uk/steff/ecm/ecm-model-pars-2sources.csv

** PCA in PANDAS

Lest look at how the model behaves if we split the source heights into
3 categories defined as: low (H = 2-10), Medium (H = 11-15) and High (H=16-20)

Using data file with 200 ECM models file at:

http://www.star.bris.ac.uk/steff/ecm/ecm-model-pars-2sources.csv

Load data into PANDAS:

#+BEGIN_EXAMPLE
import pandas as pd
from matplotlib import pyplot as plt
import numpy as np
import math

df = pd.read_csv(
    filepath_or_buffer='http://www.star.bris.ac.uk/steff/ecm/ecm-model-pars-2sources.csv',
    header=None,
    sep=',')

df.columns=['H1', 'H2', 'Gamma1', 'Gamma2','Fe','xi','b','q2','tmax','tshift','Class']
df.dropna(how="all", inplace=True) # drops the empty line at file-end
#df
df.tail()

#split data table into data X and class labels y

X = df.iloc[:,0:10].values
y = df.iloc[:,10].values

label_dict = {1: 'lo',
              2: 'med',
              3: 'hi'}

feature_dict = {0: 'H1',
                1: 'H2',
                2: 'Gamma1',
                3: 'Gamma2',
                4: 'Fe',
                5: 'xi',
                6: 'b',
                7: 'q2',
                8: 'tmax',
                9: 'tshift'}

with plt.style.context('seaborn-whitegrid'):
    plt.figure(figsize=(10, 20))
    for cnt in range(10):
        plt.subplot(10, 1, cnt+1)
        for lab in ('lo', 'med', 'hi'):
            plt.hist(X[y==lab, cnt],
                     label=lab,
                     bins=10,
                     alpha=0.3,)
        plt.xlabel(feature_dict[cnt])
    plt.legend(loc='upper right', fancybox=True, fontsize=8)

    plt.tight_layout()
    plt.show()
#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/ecm-3H-classes.png


*Lets make some assumptions based on the above data*

We could set the following parameters as fixed values:

$Fe = 1, \xi = 1, b = 1$ and  $q_2 = 0.5$


*Standardising*

The following is done with ref to:http://sebastianraschka.com/Articles/2015_pca_in_3_steps.html

#+BEGIN_EXAMPLE
# Standardising
from sklearn.preprocessing import StandardScaler
X_std = StandardScaler().fit_transform(X)
#+END_EXAMPLE

*Covariance Matrix*

#+BEGIN_EXAMPLE
import numpy as np
mean_vec = np.mean(X_std, axis=0)
cov_mat = (X_std - mean_vec).T.dot((X_std - mean_vec)) / (X_std.shape[0]-1)
print('Covariance matrix \n%s' %cov_mat)

Covariance matrix
[[ 1.00505051  0.96086911  0.26458855  0.13903437 -0.12263304 -0.02341396 -0.05693448 -0.11059923  0.02400243  0.04574417]
 [ 0.96086911  1.00505051  0.25179499  0.12491348 -0.17091159 -0.02795362 -0.07532876 -0.15586272  0.02431887  0.05225967]
 [ 0.26458855  0.25179499  1.00505051  0.18819651  0.11640037 -0.01504974  0.03386655  0.17980576  0.03782524  0.05669028]
 [ 0.13903437  0.12491348  0.18819651  1.00505051  0.04419814 -0.0133237   0.13456957 -0.06620621  0.02288525  0.04652874]
 [-0.12263304 -0.17091159  0.11640037  0.04419814  1.00505051  0.02440603  0.18817849  0.54191579  0.24183546  0.21586664]
 [-0.02341396 -0.02795362 -0.01504974 -0.0133237   0.02440603  1.00505051 -0.14271469  0.03897453  0.03536901  0.02837496]
 [-0.05693448 -0.07532876  0.03386655  0.13456957  0.18817849 -0.14271469  1.00505051  0.20072346  0.07551951  0.08834399]
 [-0.11059923 -0.15586272  0.17980576 -0.06620621  0.54191579  0.03897453  0.20072346  1.00505051  0.26125305  0.23086962]
 [ 0.02400243  0.02431887  0.03782524  0.02288525  0.24183546  0.03536901  0.07551951  0.26125305  1.00505051  0.9934403 ]
 [ 0.04574417  0.05225967  0.05669028  0.04652874  0.21586664  0.02837496  0.08834399  0.23086962  0.9934403   1.00505051]]
#+END_EXAMPLE

*1 - Eigendecomposition - Computing Eigenvectors and Eigenvalues*

Next, we perform an eigendecomposition on the covariance matrix:

#+BEGIN_EXAMPLE
cov_mat = np.cov(X_std.T)

eig_vals, eig_vecs = np.linalg.eig(cov_mat)

print('Eigenvectors \n%s' %eig_vecs)
print('\nEigenvalues \n%s' %eig_vals)

Eigenvectors
[[-0.16111889 -0.61848861 -0.70133693  0.0484777   0.04418311  0.07826189  0.17527216  0.20502715  0.12752993 -0.01384024]
 [-0.17815935 -0.61841871  0.70778333 -0.05822892  0.00485902  0.06023571  0.17402545  0.19244861  0.10205498 -0.00901086]
 [ 0.06810577 -0.30707254 -0.00238998 -0.01313383  0.40099613  0.2093967  -0.12623223 -0.56994347 -0.57001541  0.17480637]
 [ 0.01512712 -0.19812469  0.00926254 -0.0110016   0.27376339 -0.3055349  -0.7713293  -0.08625832  0.38212823 -0.20880998]
 [ 0.40864336  0.0545292   0.02652273  0.01035614  0.37850491  0.23829059  0.09696745  0.06178522  0.48006323  0.62088428]
 [ 0.02863835  0.02129228  0.00331498  0.00133094 -0.18082847  0.66427138 -0.50807934  0.46169295 -0.22708934  0.04340231]
 [ 0.1954805   0.0206869   0.00342189 -0.01375057  0.40298381 -0.47068768  0.01108522  0.60250932 -0.45317955  0.09329379]
 [ 0.41855932  0.04220297  0.02504187  0.01752087  0.36236409  0.31185316  0.23722538  0.03612324  0.08458434 -0.72718465]
 [ 0.53319323 -0.2086234  -0.0608208  -0.70679223 -0.38276331 -0.12215902 -0.03545271 -0.05990052 -0.05002812  0.01218502]
 [ 0.52146296 -0.22874362  0.04500375  0.70271291 -0.38223504 -0.14590137 -0.05392942 -0.06134414 -0.07295238  0.02318611]]

Eigenvalues
'H1'        'H2'       'Gamma1'    'Gamma2'  'Fe'       'xi'       'b'        'q2'        'tmax'      'tshift'
[2.38675336 2.18779767 0.04253626 0.01014317 1.38877083 1.11658139 0.98447419 0.81578245 0.6814007  0.43626504]
#+END_EXAMPLE

Correlation Matrix

Eigendecomposition of the standardized data based on the correlation
matrix:

#+BEGIN_EXAMPLE
cor_mat1 = np.corrcoef(X_std.T)

eig_vals, eig_vecs = np.linalg.eig(cor_mat1)

print('Eigenvectors \n%s' %eig_vecs)
print('\nEigenvalues \n%s' %eig_vals)

Eigenvectors
[[-0.16111889 -0.61848861 -0.70133693  0.0484777   0.04418311  0.07826189  0.17527216  0.20502715  0.12752993 -0.01384024]
 [-0.17815935 -0.61841871  0.70778333 -0.05822892  0.00485902  0.06023571  0.17402545  0.19244861  0.10205498 -0.00901086]
 [ 0.06810577 -0.30707254 -0.00238998 -0.01313383  0.40099613  0.2093967  -0.12623223 -0.56994347 -0.57001541  0.17480637]
 [ 0.01512712 -0.19812469  0.00926254 -0.0110016   0.27376339 -0.3055349  -0.7713293  -0.08625832  0.38212823 -0.20880998]
 [ 0.40864336  0.0545292   0.02652273  0.01035614  0.37850491  0.23829059  0.09696745  0.06178522  0.48006323  0.62088428]
 [ 0.02863835  0.02129228  0.00331498  0.00133094 -0.18082847  0.66427138 -0.50807934  0.46169295 -0.22708934  0.04340231]
 [ 0.1954805   0.0206869   0.00342189 -0.01375057  0.40298381 -0.47068768  0.01108522  0.60250932 -0.45317955  0.09329379]
 [ 0.41855932  0.04220297  0.02504187  0.01752087  0.36236409  0.31185316  0.23722538  0.03612324  0.08458434 -0.72718465]
 [ 0.53319323 -0.2086234  -0.0608208  -0.70679223 -0.38276331 -0.12215902 -0.03545271 -0.05990052 -0.05002812  0.01218502]
 [ 0.52146296 -0.22874362  0.04500375  0.70271291 -0.38223504 -0.14590137 -0.05392942 -0.06134414 -0.07295238  0.02318611]]

Eigenvalues
'H1'        'H2'       'Gamma1'    'Gamma2'  'Fe'       'xi'       'b'        'q2'        'tmax'      'tshift'
[2.37475962 2.17680371 0.04232251 0.0100922  1.38179209 1.11097043 0.97952708 0.81168304 0.67797657 0.43407275]
#+END_EXAMPLE

Eigendecomposition of the raw data based on the correlation matrix:

#+BEGIN_EXAMPLE
cor_mat2 = np.corrcoef(X.T)

eig_vals, eig_vecs = np.linalg.eig(cor_mat2)

print('Eigenvectors \n%s' %eig_vecs)
print('\nEigenvalues \n%s' %eig_vals)

Eigenvectors
[[-0.16111889 -0.61848861 -0.70133693  0.0484777   0.04418311  0.07826189  0.17527216  0.20502715  0.12752993 -0.01384024]
 [-0.17815935 -0.61841871  0.70778333 -0.05822892  0.00485902  0.06023571  0.17402545  0.19244861  0.10205498 -0.00901086]
 [ 0.06810577 -0.30707254 -0.00238998 -0.01313383  0.40099613  0.2093967  -0.12623223 -0.56994347 -0.57001541  0.17480637]
 [ 0.01512712 -0.19812469  0.00926254 -0.0110016   0.27376339 -0.3055349  -0.7713293  -0.08625832  0.38212823 -0.20880998]
 [ 0.40864336  0.0545292   0.02652273  0.01035614  0.37850491  0.23829059  0.09696745  0.06178522  0.48006323  0.62088428]
 [ 0.02863835  0.02129228  0.00331498  0.00133094 -0.18082847  0.66427138 -0.50807934  0.46169295 -0.22708934  0.04340231]
 [ 0.1954805   0.0206869   0.00342189 -0.01375057  0.40298381 -0.47068768  0.01108522  0.60250932 -0.45317955  0.09329379]
 [ 0.41855932  0.04220297  0.02504187  0.01752087  0.36236409  0.31185316  0.23722538  0.03612324  0.08458434 -0.72718465]
 [ 0.53319323 -0.2086234  -0.0608208  -0.70679223 -0.38276331 -0.12215902 -0.03545271 -0.05990052 -0.05002812  0.01218502]
 [ 0.52146296 -0.22874362  0.04500375  0.70271291 -0.38223504 -0.14590137 -0.05392942 -0.06134414 -0.07295238  0.02318611]]

Eigenvalues
'H1'        'H2'       'Gamma1'    'Gamma2'  'Fe'       'xi'       'b'        'q2'        'tmax'      'tshift'
[2.37475962 2.17680371 0.04232251 0.0100922  1.38179209 1.11097043 0.97952708 0.81168304 0.67797657 0.43407275]

#+END_EXAMPLE

We can clearly see that all three approaches yield the same eigenvectors and eigenvalue pairs:

    Eigendecomposition of the covariance matrix after standardizing the data.
    Eigendecomposition of the correlation matrix.
    Eigendecomposition of the correlation matrix after standardizing
    the data.

Singular Value Decomposition

#+BEGIN_EXAMPLE
u,s,v = np.linalg.svd(X_std.T)
u

array([[-0.16111889,  0.61848861,  0.04418311, -0.07826189, -0.17527216, 0.20502715, -0.12752993, -0.01384024,  0.70133693,  0.0484777 ],
       [-0.17815935,  0.61841871,  0.00485902, -0.06023571, -0.17402545, 0.19244861, -0.10205498, -0.00901086, -0.70778333, -0.05822892],
       [ 0.06810577,  0.30707254,  0.40099613, -0.2093967 ,  0.12623223,-0.56994347,  0.57001541,  0.17480637,  0.00238998, -0.01313383],
       [ 0.01512712,  0.19812469,  0.27376339,  0.3055349 ,  0.7713293 ,-0.08625832, -0.38212823, -0.20880998, -0.00926254, -0.0110016 ],
       [ 0.40864336, -0.0545292 ,  0.37850491, -0.23829059, -0.09696745, 0.06178522, -0.48006323,  0.62088428, -0.02652273,  0.01035614],
       [ 0.02863835, -0.02129228, -0.18082847, -0.66427138,  0.50807934, 0.46169295,  0.22708934,  0.04340231, -0.00331498,  0.00133094],
       [ 0.1954805 , -0.0206869 ,  0.40298381,  0.47068768, -0.01108522, 0.60250932,  0.45317955,  0.09329379, -0.00342189, -0.01375057],
       [ 0.41855932, -0.04220297,  0.36236409, -0.31185316, -0.23722538, 0.03612324, -0.08458434, -0.72718465, -0.02504187,  0.01752087],
       [ 0.53319323,  0.2086234 , -0.38276331,  0.12215902,  0.03545271,-0.05990052,  0.05002812,  0.01218502,  0.0608208 , -0.70679223],
       [ 0.52146296,  0.22874362, -0.38223504,  0.14590137,  0.05392942,-0.06134414,  0.07295238,  0.02318611, -0.04500375,  0.70271291]])
#+END_EXAMPLE


*2 - Selecting Principal Components*

Sorting Eigenpairs

#+BEGIN_EXAMPLE
for ev in eig_vecs.T:
    np.testing.assert_array_almost_equal(1.0, np.linalg.norm(ev))
print('Everything ok!')

Everything ok!


# Make a list of (eigenvalue, eigenvector) tuples
eig_pairs = [(np.abs(eig_vals[i]), eig_vecs[:,i]) for i in range(len(eig_vals))]

# Sort the (eigenvalue, eigenvector) tuples from high to low
eig_pairs.sort(key=lambda x: x[0], reverse=True)

# Visually confirm that the list is correctly sorted by decreasing eigenvalues
print('Eigenvalues in descending order:')
for i in eig_pairs:
    print(i[0])


Eigenvalues in descending order:
2.374759622621859
2.176803709373185
1.3817920855056454
1.1109704291368607
0.9795270790590122
0.8116830391168967
0.6779765746534635
0.4340727527657605
0.04232251095943872
0.01009219680788172
#+END_EXAMPLE


Explained Variance

#+BEGIN_EXAMPLE
tot = sum(eig_vals)
var_exp = [(i / tot)*100 for i in sorted(eig_vals, reverse=True)]
cum_var_exp = np.cumsum(var_exp)

with plt.style.context('seaborn-whitegrid'):
    plt.figure(figsize=(6, 4))

    plt.bar(range(4), var_exp, alpha=0.5, align='center',
            label='individual explained variance')
    plt.step(range(4), cum_var_exp, where='mid',
             label='cumulative explained variance')
    plt.ylabel('Explained variance ratio')
    plt.xlabel('Principal components')
    plt.legend(loc='best')
    plt.tight_layout()

#+END_EXAMPLE

The 1st PCA can explain about 25% of the data
4 CFomponements can explain 80%

#+ATTR_HTML: :width 500
http://www.star.bris.ac.uk/steff/ecm/ecm-pandas-pca-variance2.png

#+BEGIN_EXAMPLE
matrix_w = np.hstack((eig_pairs[0][1].reshape(10,1),
                      eig_pairs[1][1].reshape(10,1)))

print('Matrix W:\n', matrix_w)

Matrix W:
 [[-0.16111889 -0.61848861]
 [-0.17815935 -0.61841871]
 [ 0.06810577 -0.30707254]
 [ 0.01512712 -0.19812469]
 [ 0.40864336  0.0545292 ]
 [ 0.02863835  0.02129228]
 [ 0.1954805   0.0206869 ]
 [ 0.41855932  0.04220297]
 [ 0.53319323 -0.2086234 ]
 [ 0.52146296 -0.22874362]]

#+END_EXAMPLE

#+BEGIN_EXAMPLE
Y = X_std.dot(matrix_w)

with plt.style.context('seaborn-whitegrid'):
    plt.figure(figsize=(8, 6))
    for lab, col in zip(('lo', 'med', 'hi'),
                        ('blue', 'red', 'green')):
        plt.scatter(Y[y==lab, 0],
                    Y[y==lab, 1],
                    label=lab,
                    c=col)
    plt.xlabel('Principal Component 1', fontsize=14)
    plt.ylabel('Principal Component 2', fontsize=14)

    plt.legend(loc='lower right')
    plt.tight_layout()
    plt.show()
    plt.savefig('ecm-pandas-pca-plot.png')
#+END_EXAMPLE

#+ATTR_HTML: :width 500
http://www.star.bris.ac.uk/steff/ecm/ecm-pandas-pca-plot.png

** Quick PCA in Orange

For a PCA example see: https://towardsdatascience.com/pca-using-python-scikit-learn-e653f8989e60

In order to reduce the model dimensions, I wil first need to
collect a range of ECM fits, for example the first fit for 1H0707-495 was:

#+BEGIN_EXAMPLE
python find-best-fit-1H0707-lo-flux.py
Best fit is 2.846357 in file 1H0707_lo_flux_best_fit_06.txt

 Best fit:

 Parameters[Variable] = 15[2]
            Data bins = 7
           Chi-square = 2.846356
   Reduced chi-square = 0.5692711

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001217607           0           1
  2  lag_freq(1).log_mass   0     0         6.244645           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0
#+END_EXAMPLE

That is, to explore PCA on the following good range of parameters:

+-----+----------------------+--------+--------+--------------+-----+------+
| idx | param                | tie-to | freeze |        value | min |  max |
+-----+----------------------+--------+--------+--------------+-----+------+
|   1 | lag_freq(1).norm     |      0 |      0 | 0.0001217607 |   0 |    1 |
+-----+----------------------+--------+--------+--------------+-----+------+
|   2 | lag_freq(1).log_mass |      0 |      0 |     6.244645 |   6 |    8 |
+-----+----------------------+--------+--------+--------------+-----+------+
|   3 | lag_freq(1).i        |      0 |      1 |           53 |   0 |    0 |
+-----+----------------------+--------+--------+--------------+-----+------+
|   4 | lag_freq(1).a        |      0 |      1 |        0.998 |   0 |    0 |
+-----+----------------------+--------+--------+--------------+-----+------+
|   5 | lag_freq(1).h1       |      0 |      1 |            2 |   2 |   10 |
+-----+----------------------+--------+--------+--------------+-----+------+
|   6 | lag_freq(1).h2       |      0 |      1 |            3 |   3 |   20 |
+-----+----------------------+--------+--------+--------------+-----+------+
|   7 | lag_freq(1).Gamma1   |      0 |      1 |          2.7 | 1.4 |  3.1 |
+-----+----------------------+--------+--------+--------------+-----+------+
|   8 | lag_freq(1).Gamma2   |      0 |      1 |          2.3 | 1.4 |  3.1 |
+-----+----------------------+--------+--------+--------------+-----+------+
|   9 | lag_freq(1).Fe       |      0 |      1 |            1 | 1.0 |  5.0 |
+-----+----------------------+--------+--------+--------------+-----+------+
|  10 | lag_freq(1).xi       |      0 |      1 |            0 |   0 |  3.0 |
+-----+----------------------+--------+--------+--------------+-----+------+
|  11 | lag_freq(1).p        |      0 |      1 |            0 |   0 |    0 |
+-----+----------------------+--------+--------+--------------+-----+------+
|  12 | lag_freq(1).b        |      0 |      1 |            1 | 1.0 |  3.0 |
+-----+----------------------+--------+--------+--------------+-----+------+
|  13 | lag_freq(1).q2       |      0 |      1 |          0.5 | 0.5 |  1.5 |
+-----+----------------------+--------+--------+--------------+-----+------+
|  14 | lag_freq(1).t_max    |      0 |      1 |          200 |  50 | 1000 |
+-----+----------------------+--------+--------+--------------+-----+------+
|  15 | lag_freq(1).t_shift  |      0 |      1 |           10 |  10 |  200 |
+-----+----------------------+--------+--------+--------------+-----+------+

From the above model comprising of 15 dimensions, I only want to
explore the variable parameters fitted by the model, thus we can
exclude the inclination and black hole spin as these are provided as
fixed values for each AGN. Density parameter p is also excluded as
this is fixed at 0.

Lets create 100 possible models with unique values:

+-----------+----+-------+----+----+---+-----+------+--------+
|           |  h | gamma | Fe | xi | b |  q2 | tmax | tshift |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_0   |  2 |   1.4 |  1 |  0 | 1 | 0.5 |  100 |     10 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_1   |  3 |   1.5 |  2 |  1 | 2 | 0.6 |  125 |     20 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_2   |  4 |   1.6 |  3 |  2 | 3 | 0.7 |  150 |     30 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_3   |  5 |   1.7 |  4 |  3 | 1 | 0.8 |  175 |     40 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_4   |  6 |   1.8 |  5 |  0 | 2 | 0.9 |  200 |     50 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_5   |  7 |   1.9 |  1 |  1 | 3 |   1 |  225 |     60 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_6   |  8 |     2 |  2 |  2 | 1 | 1.2 |  250 |     70 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_7   |  9 |   2.1 |  3 |  3 | 2 | 1.3 |  275 |     80 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_8   | 10 |   2.2 |  4 |  0 | 3 | 1.4 |  300 |     90 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_9   | 11 |   2.3 |  5 |  1 | 1 | 1.5 |  325 |    100 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_10  | 12 |   2.4 |  1 |  2 | 2 | 0.5 |  350 |    110 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_11  | 13 |   2.5 |  2 |  3 | 3 | 0.6 |  375 |    120 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_12  | 14 |   2.6 |  3 |  0 | 1 | 0.7 |  400 |    130 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_13  | 15 |   2.7 |  4 |  1 | 2 | 0.8 |  425 |    140 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_14  | 16 |   2.8 |  5 |  2 | 3 | 0.9 |  450 |    150 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_15  | 17 |   2.9 |  1 |  3 | 1 |   1 |  475 |    160 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_16  | 18 |     3 |  2 |  0 | 2 | 1.2 |  500 |    170 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_17  | 19 |   3.1 |  3 |  1 | 3 | 1.3 |  525 |    180 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_18  | 20 |   1.4 |  4 |  2 | 1 | 1.4 |  550 |    190 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_19  |  2 |   1.5 |  5 |  3 | 2 | 1.5 |  575 |    200 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_20  |  3 |   1.6 |  1 |  0 | 3 | 0.5 |  600 |    210 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_21  |  4 |   1.7 |  2 |  1 | 1 | 0.6 |  625 |    220 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_22  |  5 |   1.8 |  3 |  2 | 2 | 0.7 |  650 |    230 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_23  |  6 |   1.9 |  4 |  3 | 3 | 0.8 |  675 |    240 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_24  |  7 |     2 |  5 |  0 | 1 | 0.9 |  700 |    250 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_25  |  8 |   2.1 |  1 |  1 | 2 |   1 |  725 |    260 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_26  |  9 |   2.2 |  2 |  2 | 3 | 1.2 |  750 |    270 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_27  | 10 |   2.3 |  3 |  3 | 1 | 1.3 |  775 |    280 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_28  | 11 |   2.4 |  4 |  0 | 2 | 1.4 |  800 |    290 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_29  | 12 |   2.5 |  5 |  1 | 3 | 1.5 |  825 |    300 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_30  | 13 |   2.6 |  1 |  2 | 1 | 0.5 |  850 |    325 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_31  | 14 |   2.7 |  2 |  3 | 2 | 0.6 |  875 |    350 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_32  | 15 |   2.8 |  3 |  0 | 3 | 0.7 |  900 |    375 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_33  | 16 |   2.9 |  1 |  1 | 3 | 0.5 |  600 |    400 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_34  | 17 |     3 |  2 |  2 | 1 | 0.6 |  100 |     10 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_35  | 18 |   3.1 |  3 |  3 | 2 | 0.7 |  125 |     20 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_36  |  2 |   1.4 |  4 |  0 | 3 | 0.8 |  150 |     30 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_37  |  3 |   1.5 |  5 |  1 | 1 | 0.9 |  175 |     40 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_38  |  2 |   1.6 |  1 |  2 | 2 |   1 |  200 |     50 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_39  |  3 |   1.7 |  2 |  3 | 3 | 1.2 |  225 |     60 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_40  |  4 |   1.8 |  3 |  0 | 1 | 1.3 |  250 |     70 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_41  |  5 |   1.9 |  4 |  1 | 2 | 1.4 |  275 |     80 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_42  |  6 |     2 |  5 |  2 | 3 | 1.5 |  300 |     90 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_43  |  7 |   2.1 |  1 |  3 | 1 | 0.5 |  325 |    100 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_44  |  8 |   2.2 |  2 |  0 | 2 | 0.6 |  350 |    110 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_45  |  9 |   2.3 |  3 |  1 | 3 | 0.7 |  375 |    120 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_46  | 10 |   2.4 |  4 |  2 | 1 | 0.8 |  400 |    130 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_47  | 11 |   2.5 |  5 |  3 | 2 | 0.9 |  425 |    140 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_48  | 12 |   2.6 |  1 |  0 | 3 |   1 |  450 |    150 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_49  | 13 |   2.7 |  2 |  1 | 1 | 1.2 |  475 |    160 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_50  | 14 |   2.8 |  3 |  2 | 2 | 1.3 |  500 |    170 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_51  | 15 |   2.9 |  4 |  3 | 3 | 1.4 |  525 |    180 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_52  | 16 |     3 |  5 |  0 | 1 | 1.5 |  550 |    190 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_53  | 17 |   3.1 |  1 |  1 | 2 | 0.5 |  575 |    200 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_54  |  2 |   1.4 |  2 |  2 | 3 | 0.6 |  600 |    210 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_55  |  3 |   1.5 |  3 |  3 | 1 | 0.7 |  625 |    220 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_56  |  4 |   1.6 |  4 |  0 | 2 | 0.8 |  650 |    230 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_57  |  5 |   1.7 |  5 |  1 | 3 | 0.9 |  675 |    240 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_58  |  6 |   1.8 |  1 |  2 | 1 |   1 |  700 |    250 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_59  |  7 |   1.9 |  2 |  3 | 2 | 1.2 |  725 |    260 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_60  |  8 |     2 |  3 |  0 | 3 | 1.3 |  750 |    270 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_61  |  9 |   2.1 |  4 |  1 | 1 | 1.4 |  775 |    280 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_62  | 10 |   2.2 |  5 |  2 | 2 | 1.5 |  800 |    290 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_63  | 11 |   2.3 |  1 |  3 | 3 | 0.5 |  825 |    300 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_64  | 12 |   2.4 |  2 |  0 | 1 | 0.6 |  850 |    325 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_65  | 13 |   2.5 |  3 |  1 | 3 | 0.5 |  100 |     10 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_66  | 14 |   2.6 |  4 |  2 | 3 | 0.6 |  125 |     20 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_67  | 15 |   2.7 |  5 |  3 | 1 | 0.7 |  150 |     30 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_68  | 16 |   2.8 |  1 |  0 | 2 | 0.8 |  175 |     40 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_69  | 17 |   2.9 |  2 |  1 | 3 | 0.9 |  200 |     50 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_70  |  2 |     3 |  3 |  2 | 1 |   1 |  225 |     60 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_71  |  3 |   3.1 |  4 |  3 | 2 | 1.2 |  250 |     70 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_72  |  4 |     3 |  5 |  0 | 3 | 1.3 |  275 |     80 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_73  |  5 |   3.1 |  1 |  1 | 1 | 1.4 |  300 |     90 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_74  |  6 |   1.4 |  2 |  2 | 2 | 1.5 |  325 |    100 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_75  |  7 |   1.5 |  3 |  3 | 3 | 0.5 |  350 |    110 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_76  |  8 |   1.6 |  4 |  0 | 1 | 0.6 |  375 |    120 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_77  |  9 |   1.7 |  5 |  1 | 2 | 0.7 |  400 |    130 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_78  | 10 |   1.8 |  1 |  2 | 3 | 0.8 |  425 |    140 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_79  | 11 |   1.9 |  2 |  3 | 1 | 0.9 |  450 |    150 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_80  | 12 |     2 |  3 |  0 | 2 |   1 |  475 |    160 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_81  | 13 |   2.1 |  4 |  1 | 3 | 1.2 |  500 |    170 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_82  | 14 |   2.2 |  5 |  2 | 1 | 1.3 |  525 |    180 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_83  |  2 |   2.3 |  1 |  3 | 2 | 1.4 |  550 |    190 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_84  |  3 |   2.4 |  2 |  0 | 3 | 1.5 |  575 |    200 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_85  |  4 |   2.5 |  3 |  1 | 1 | 0.5 |  600 |    210 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_86  |  5 |   2.6 |  4 |  2 | 2 | 0.6 |  625 |    220 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_87  |  6 |   2.7 |  5 |  3 | 3 | 0.7 |  650 |    230 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_88  |  7 |   2.8 |  1 |  0 | 1 | 0.8 |  675 |    240 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_89  |  2 |   2.9 |  2 |  1 | 2 | 0.9 |  700 |    250 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_90  |  3 |     3 |  3 |  2 | 3 |   1 |  725 |    260 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_91  |  4 |   3.1 |  4 |  3 | 1 | 1.2 |  750 |    270 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_92  |  5 |   2.5 |  5 |  0 | 2 | 1.3 |  775 |    280 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_93  |  6 |   1.4 |  1 |  1 | 2 | 1.4 |  550 |    190 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_94  |  7 |   1.5 |  2 |  2 | 3 | 1.5 |  575 |    200 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_95  |  2 |   1.6 |  3 |  3 | 1 | 0.5 |  600 |    210 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_96  |  3 |   1.7 |  4 |  0 | 2 | 0.6 |  625 |    220 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_97  |  4 |   1.8 |  5 |  1 | 3 | 0.7 |  650 |    230 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_98  |  5 |   1.9 |  1 |  2 | 1 | 0.8 |  675 |    240 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_99  |  2 |   1.6 |  3 |  3 | 1 | 0.9 |  700 |    250 |
+-----------+----+-------+----+----+---+-----+------+--------+
| Model_100 |  3 |   1.7 |  4 |  0 | 2 |   1 |  725 |    260 |
+-----------+----+-------+----+----+---+-----+------+--------+



*Examine this csv file in Orange via Anaconda*

A quick demo here: https://www.youtube.com/watch?v=OmaAC8a52YI

The Orange workflow file is at
=/homeb/steff075/phd_ecm/data-pca/Orange-ECM-PCA.ows=

5 Principle components cover 84 % of the variance

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/ecm-pca-variance1.PNG


#+ATTR_HTML: :width 1000
http://www.star.bris.ac.uk/steff/ecm/pca-data-table1.PNG


PC1 and PC2

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/pca1-pca2.PNG



#+ATTR_HTML: :width 500
http://www.star.bris.ac.uk/steff/ecm/pca-flow.PNG

** Detailed PCA in with height classes in Pandas

Here, I have 3 height classes:

2-9 = Lo-source, 10-15 = Med-source and 16-20 = Hi-source

PATH to file =/home/steff075/phd_ecm/data-pca/ecm-model-pars-lo-hi-source1.csv=

+--------+-------+----+----+---+-----+------+--------+------------+
| Height | Gamma | Fe | xi | b |  q2 | tmax | tshift | class      |
+--------+-------+----+----+---+-----+------+--------+------------+
|      2 |   1.4 |  1 |  0 | 1 | 0.5 |  100 |     10 | Lo-source  |
+--------+-------+----+----+---+-----+------+--------+------------+
|      3 |   1.5 |  2 |  1 | 2 | 0.6 |  125 |     20 | Lo-source  |
+--------+-------+----+----+---+-----+------+--------+------------+
|      4 |   1.6 |  3 |  2 | 3 | 0.7 |  150 |     30 | Lo-source  |
+--------+-------+----+----+---+-----+------+--------+------------+
|      5 |   1.7 |  4 |  3 | 1 | 0.8 |  175 |     40 | Lo-source  |
+--------+-------+----+----+---+-----+------+--------+------------+
|      6 |   1.8 |  5 |  0 | 2 | 0.9 |  200 |     50 | Lo-source  |
+--------+-------+----+----+---+-----+------+--------+------------+
|      7 |   1.9 |  1 |  1 | 3 |   1 |  225 |     60 | Lo-source  |
+--------+-------+----+----+---+-----+------+--------+------------+
|      8 |     2 |  2 |  2 | 1 | 1.2 |  250 |     70 | Lo-source  |
+--------+-------+----+----+---+-----+------+--------+------------+
|      9 |   2.1 |  3 |  3 | 2 | 1.3 |  275 |     80 | Lo-source  |
+--------+-------+----+----+---+-----+------+--------+------------+
|     10 |   2.2 |  4 |  0 | 3 | 1.4 |  300 |     90 | Med-source |
+--------+-------+----+----+---+-----+------+--------+------------+
|     11 |   2.3 |  5 |  1 | 1 | 1.5 |  325 |    100 | Med-source |
+--------+-------+----+----+---+-----+------+--------+------------+
|     12 |   2.4 |  1 |  2 | 2 | 0.5 |  350 |    110 | Med-source |
+--------+-------+----+----+---+-----+------+--------+------------+
|     13 |   2.5 |  2 |  3 | 3 | 0.6 |  375 |    120 | Med-source |
+--------+-------+----+----+---+-----+------+--------+------------+
|     14 |   2.6 |  3 |  0 | 1 | 0.7 |  400 |    130 | Med-source |
+--------+-------+----+----+---+-----+------+--------+------------+
|     15 |   2.7 |  4 |  1 | 2 | 0.8 |  425 |    140 | Med-source |
+--------+-------+----+----+---+-----+------+--------+------------+
|     16 |   2.8 |  5 |  2 | 3 | 0.9 |  450 |    150 | Hi-source  |
+--------+-------+----+----+---+-----+------+--------+------------+
|     17 |   2.9 |  1 |  3 | 1 |   1 |  475 |    160 | Hi-source  |
+--------+-------+----+----+---+-----+------+--------+------------+
|     18 |     3 |  2 |  0 | 2 | 1.2 |  500 |    170 | Hi-source  |
+--------+-------+----+----+---+-----+------+--------+------------+
|     19 |   3.1 |  3 |  1 | 3 | 1.3 |  525 |    180 | Hi-source  |
+--------+-------+----+----+---+-----+------+--------+------------+
|     20 |   1.4 |  4 |  2 | 1 | 1.4 |  550 |    190 | Hi-source  |
+--------+-------+----+----+---+-----+------+--------+------------+
|      2 |   1.5 |  5 |  3 | 2 | 1.5 |  575 |    200 | Lo-source  |
+--------+-------+----+----+---+-----+------+--------+------------+
|      3 |   1.6 |  1 |  0 | 3 | 0.5 |  600 |    210 | Lo-source  |
+--------+-------+----+----+---+-----+------+--------+------------+
|      4 |   1.7 |  2 |  1 | 1 | 0.6 |  625 |    220 | Lo-source  |
+--------+-------+----+----+---+-----+------+--------+------------+
|      5 |   1.8 |  3 |  2 | 2 | 0.7 |  650 |    230 | Lo-source  |
+--------+-------+----+----+---+-----+------+--------+------------+
|      6 |   1.9 |  4 |  3 | 3 | 0.8 |  675 |    240 | Lo-source  |
+--------+-------+----+----+---+-----+------+--------+------------+
|      7 |     2 |  5 |  0 | 1 | 0.9 |  700 |    250 | Lo-source  |
+--------+-------+----+----+---+-----+------+--------+------------+
|      8 |   2.1 |  1 |  1 | 2 |   1 |  725 |    260 | Lo-source  |
+--------+-------+----+----+---+-----+------+--------+------------+
|      9 |   2.2 |  2 |  2 | 3 | 1.2 |  750 |    270 | Lo-source  |
+--------+-------+----+----+---+-----+------+--------+------------+
|     10 |   2.3 |  3 |  3 | 1 | 1.3 |  775 |    280 | Med-source |
+--------+-------+----+----+---+-----+------+--------+------------+
|     11 |   2.4 |  4 |  0 | 2 | 1.4 |  800 |    290 | Med-source |
+--------+-------+----+----+---+-----+------+--------+------------+
|     12 |   2.5 |  5 |  1 | 3 | 1.5 |  825 |    300 | Med-source |
+--------+-------+----+----+---+-----+------+--------+------------+
|     13 |   2.6 |  1 |  2 | 1 | 0.5 |  850 |    325 | Med-source |
+--------+-------+----+----+---+-----+------+--------+------------+
|     14 |   2.7 |  2 |  3 | 2 | 0.6 |  875 |    350 | Med-source |
+--------+-------+----+----+---+-----+------+--------+------------+
|     15 |   2.8 |  3 |  0 | 3 | 0.7 |  900 |    375 | Med-source |
+--------+-------+----+----+---+-----+------+--------+------------+
|     16 |   2.9 |  1 |  1 | 3 | 0.5 |  600 |    400 | Hi-source  |
+--------+-------+----+----+---+-----+------+--------+------------+
|     17 |     3 |  2 |  2 | 1 | 0.6 |  100 |     10 | Hi-source  |
+--------+-------+----+----+---+-----+------+--------+------------+
|     18 |   3.1 |  3 |  3 | 2 | 0.7 |  125 |     20 | Hi-source  |
+--------+-------+----+----+---+-----+------+--------+------------+
|      2 |   1.4 |  4 |  0 | 3 | 0.8 |  150 |     30 | Lo-source  |
+--------+-------+----+----+---+-----+------+--------+------------+
|      3 |   1.5 |  5 |  1 | 1 | 0.9 |  175 |     40 | Lo-source  |
+--------+-------+----+----+---+-----+------+--------+------------+
|      2 |   1.6 |  1 |  2 | 2 |   1 |  200 |     50 | Lo-source  |
+--------+-------+----+----+---+-----+------+--------+------------+
............ etc

You can download this file here: http://www.star.bris.ac.uk/steff/ecm/ecm-model-pars-lo-hi-source1.csv


Using the script =/home/steff075/phd_ecm/data-pca/pca-code-emc1.py=

Also see Jupyter notebook =ecm-pca-pandas.ipynb=

The 3 classes of H and the model parameters provided gave:


#+ATTR_HTML: :width 500
http://www.star.bris.ac.uk/steff/ecm/pca-pandas-components-selection.png


#+ATTR_HTML: :width 1000
http://www.star.bris.ac.uk/steff/ecm/pca-detailed-ecm-1.png

Covariance matrix
#+BEGIN_EXAMPLE
Covariance matrix

 Height	       Gamma 	   Fe  	       xi  	    b  	        q2  	   tmax  	 tshift
[[ 1.00507614  0.21821227 -0.12989833 -0.02666924 -0.05014807 -0.10405004  0.00203181  0.02277085]
 [ 0.21821227  1.00507614  0.11496409 -0.01581805  0.0344003   0.17855511  0.03590382  0.0548712 ]
 [-0.12989833  0.11496409  1.00507614  0.02286544  0.18962926  0.54036083  0.23860621  0.21260822]
 [-0.02666924 -0.01581805  0.02286544  1.00507614 -0.14230845  0.03752848  0.03355756  0.0265896 ]
 [-0.05014807  0.0344003   0.18962926 -0.14230845  1.00507614  0.20212179  0.07702789  0.08984164]
 [-0.10405004  0.17855511  0.54036083  0.03752848  0.20212179  1.00507614  0.25825483  0.22782067]
 [ 0.00203181  0.03590382  0.23860621  0.03355756  0.07702789  0.25825483  1.00507614  0.99340947]
 [ 0.02277085  0.0548712   0.21260822  0.0265896   0.08984164  0.22782067  0.99340947  1.00507614]]
#+END_EXAMPLE

Next, we perform an eigendecomposition on the covariance matrix:

Eigenvectors and Eigenvalues
#+BEGIN_EXAMPLE
Eigenvectors

 Height	       Gamma 	   Fe  	       xi  	    b  	        q2  	   tmax  	 tshift
[[ 0.04566219  0.00803326  0.0131823   0.61972626  0.26097247  0.26495163  0.68941894  0.00339894]
 [-0.12040699  0.01616156 -0.09785876 -0.6365118  -0.16106486 -0.13956582  0.6974016  -0.19679395]
 [-0.38806042 -0.01159322 -0.67668443  0.34238229 -0.15866964 -0.46454617 -0.02951575 -0.17971335]
 [-0.02268102 -0.00143765 -0.03114349 -0.09682092  0.5661154   0.11662114 -0.16606282 -0.79213339]
 [-0.18550603  0.0148905  -0.03184436 -0.17821602  0.73903304 -0.37603923  0.03525096  0.49373355]
 [-0.40321128 -0.02180542  0.72803622  0.20730441 -0.11736818 -0.45469068  0.04686332 -0.20302279]
 [-0.56759433  0.70964972 -0.003586   -0.05591103 -0.01848767  0.39945432 -0.06726704  0.08163731]
 [-0.55960402 -0.7037314  -0.01773411 -0.07956168  0.00136853  0.41617967 -0.04382738  0.09915985]]

Eigenvalues
[2.36506394 0.01050705 0.45967737 0.68986349 0.79628556 1.39471408 1.22651746 1.09798019]
#+END_EXAMPLE

Eigendecomposition of the standardized data based on the correlation matrix:

#+BEGIN_EXAMPLE
Eigenvectors

 Height	       Gamma 	   Fe  	       xi  	    b  	        q2  	   tmax  	 tshift
[[ 0.04566219  0.00803326  0.0131823   0.61972626  0.26097247  0.26495163  0.68941894  0.00339894]
 [-0.12040699  0.01616156 -0.09785876 -0.6365118  -0.16106486 -0.13956582  0.6974016  -0.19679395]
 [-0.38806042 -0.01159322 -0.67668443  0.34238229 -0.15866964 -0.46454617 -0.02951575 -0.17971335]
 [-0.02268102 -0.00143765 -0.03114349 -0.09682092  0.5661154   0.11662114 -0.16606282 -0.79213339]
 [-0.18550603  0.0148905  -0.03184436 -0.17821602  0.73903304 -0.37603923  0.03525096  0.49373355]
 [-0.40321128 -0.02180542  0.72803622  0.20730441 -0.11736818 -0.45469068  0.04686332 -0.20302279]
 [-0.56759433  0.70964972 -0.003586   -0.05591103 -0.01848767  0.39945432 -0.06726704  0.08163731]
 [-0.55960402 -0.7037314  -0.01773411 -0.07956168  0.00136853  0.41617967 -0.04382738  0.09915985]]

Eigenvalues
[2.35311917 0.01045398 0.45735576 0.68637933 0.79226392 1.38767007 1.22032293 1.09243484]
#+END_EXAMPLE


Eigendecomposition of the raw data based on the correlation matrix:

#+BEGIN_EXAMPLE
Eigenvectors

  Height         Gamma 	   Fe  	       xi  	    b  	        q2  	   tmax  	 tshift
[[ 0.04566219  0.00803326  0.0131823   0.61972626  0.26097247  0.26495163  0.68941894  0.00339894]
 [-0.12040699  0.01616156 -0.09785876 -0.6365118  -0.16106486 -0.13956582  0.6974016  -0.19679395]
 [-0.38806042 -0.01159322 -0.67668443  0.34238229 -0.15866964 -0.46454617 -0.02951575 -0.17971335]
 [-0.02268102 -0.00143765 -0.03114349 -0.09682092  0.5661154   0.11662114 -0.16606282 -0.79213339]
 [-0.18550603  0.0148905  -0.03184436 -0.17821602  0.73903304 -0.37603923  0.03525096  0.49373355]
 [-0.40321128 -0.02180542  0.72803622  0.20730441 -0.11736818 -0.45469068  0.04686332 -0.20302279]
 [-0.56759433  0.70964972 -0.003586   -0.05591103 -0.01848767  0.39945432 -0.06726704  0.08163731]
 [-0.55960402 -0.7037314  -0.01773411 -0.07956168  0.00136853  0.41617967 -0.04382738  0.09915985]]

Eigenvalues
[2.35311917 0.01045398 0.45735576 0.68637933 0.79226392 1.38767007 1.22032293 1.09243484]
#+END_EXAMPLE

Singular Value Decomposition
#+BEGIN_EXAMPLE
         Height	       Gamma 	   Fe  	        xi  	     b  	   q2    	   tmax  	 tshift
array([[-0.04566219,  0.26495163,  0.68941894,  0.00339894, -0.26097247,  0.61972626, -0.0131823 , -0.00803326],
       [ 0.12040699, -0.13956582,  0.6974016 , -0.19679395,  0.16106486, -0.6365118 ,  0.09785876, -0.01616156],
       [ 0.38806042, -0.46454617, -0.02951575, -0.17971335,  0.15866964,  0.34238229,  0.67668443,  0.01159322],
       [ 0.02268102,  0.11662114, -0.16606282, -0.79213339, -0.5661154 , -0.09682092,  0.03114349,  0.00143765],
       [ 0.18550603, -0.37603923,  0.03525096,  0.49373355, -0.73903304, -0.17821602,  0.03184436, -0.0148905 ],
       [ 0.40321128, -0.45469068,  0.04686332, -0.20302279,  0.11736818,  0.20730441, -0.72803622,  0.02180542],
       [ 0.56759433,  0.39945432, -0.06726704,  0.08163731,  0.01848767, -0.05591103,  0.003586  , -0.70964972],
       [ 0.55960402,  0.41617967, -0.04382738,  0.09915985, -0.00136853, -0.07956168,  0.01773411,  0.7037314 ]])
#+END_EXAMPLE

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/pca-detailed-ecm-1-pca1-pca2.png


Now lets apply this using orange for comparison


** Detailed PCA in with height classes in Orange

Use same data as above Pandas PCA:

PATH to file
=/home/steff075/phd_ecm/data-pca/ecm-model-pars-lo-hi-source1.csv=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/pca-detailed-components-selection.png

#+ATTR_HTML: :width 1200
http://www.star.bris.ac.uk/steff/ecm/pca-detailed-data-table-orange.png

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/pca-detailed-data-table-allpcs-orange1.png


#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/pca-detailed-plot-orange.png


Now lets have a look at the other components:

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/pca-detailed-ecm-1-pca1-pca3.png

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/pca-detailed-ecm-1-pca1-pca4.png

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/pca-detailed-ecm-1-pca1-pca5.png

#+ATTR_HTML: :width 400
http://www.star.bris.ac.uk/steff/ecm/pca-detailed-orangeworkflow.png

** Detailed PCA in with two-source heights in Orange


Use same data as above Pandas PCA:

PATH to file
=/home/steff075/phd_ecm/data-pca/ecm-model-pars-2source2.csv=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/pca-detailed-components-selection-2.png

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/pca-detailed-data-table-orange-2.png

#+ATTR_HTML: :width 1200
http://www.star.bris.ac.uk/steff/ecm/pca-detailed-data-table-allpcs-orange-2.png

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/pca-detailed-plot-orange-2.png


Now lets have a look at the other components:

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/pca-detailed-ecm-1-pca1-pca3-2.png

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/pca-detailed-ecm-1-pca1-pca4-2.png

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/pca-detailed-ecm-1-pca1-pca5-2.png

#+ATTR_HTML: :width 400
http://www.star.bris.ac.uk/steff/ecm/pca-detailed-orangeworkflow-2.png

* Notes on tg

#+BEGIN_EXAMPLE
The unit of time is t_g=GM/c^3 which will be different for each black hole mass.

t_g = M * 6.67E-8 * 2E33 / (3.0E10^3) where M is in solar masses (constants are in cgs units)

t_g = 4.94 * (M / 10^6 M_sun) seconds

So the light crossing time for one gravitational radius is about 5 seconds for a 10^6 solar mass black hole (500 sec for a 10^8 M_sun BH).

Once you’ve got t_g you can go from lag(s) -> lag(s)/t_g to get lag in units of t_g.

e.g., Ark 564 has a time lag of 50 sec and mass of 2 x 10^6 M_sun. In this case t_g = 9.88 seconds and the time lag is 5.06 t_g

#+END_EXAMPLE

* *All Initial Results*

=/home/steff075/phd_ecm/results/All-AGN-ECM-fits-1.ods=
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
|  Observations        | Lit-logM | incl. |  chi^2  |   h1  |   h2  |  Gamma1  |  Gamma2  | Delta-Gamma |   Fe  |   xi  |    p  |    b  |   q2  |   tmax  |  tshift  |  logM |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
| 1H-lo-flux           |     6.31 |    53 |    2.85 |     2 |     3 |      2.7 |      2.3 |         0.4 |     1 |     0 |     0 |     1 |   0.5 |     200 |       10 |  6.24 |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
| 1H lo-flux (FM)      |     6.31 |    53 |    5.89 |     2 |     3 |      3.1 |      2.7 |         0.4 |     1 |     1 |     0 |     1 |   0.5 |     175 |       10 |  6.31 |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
| 1H-hi-flux           |     6.31 |    53 |    2.79 |     2 |     3 |      2.7 |      2.6 |         0.1 |     1 |     3 |     0 |     2 |   0.5 |     550 |       85 |  6.05 |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
| 1H-hi-flux (FM)      |     6.31 |    53 |    9.67 |     2 |     3 |      2.2 |      1.9 |         0.3 |     1 |     1 |     0 |     2 |   0.5 |     300 |       50 |  6.31 |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
| 1H-combined          |     6.31 |    53 |    2.63 |     2 |     3 |      1.7 |      1.5 |         0.2 |     1 |     3 |     0 |     2 |   0.5 |     500 |       80 |  6.09 |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
| 1H-2007              |     6.31 |    53 |    1.92 |     2 |     3 |      2.4 |      1.5 |         0.9 |     1 |     1 |     0 |     1 |   0.5 |     800 |      150 |  6.14 |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
| 1H-2008              |     6.31 |    53 |    7.45 |     2 |     3 |      1.8 |      2.5 |         0.7 |     1 |     3 |     0 |     3 |   0.5 |     150 |       60 |  7.83 |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
| 1H-2010              |     6.31 |    53 |    2.59 |     2 |     3 |      2.6 |      2.3 |         0.3 |     1 |     3 |     0 |     3 |   0.5 |     250 |       25 |  6.13 |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
| 1H-Grp1              |     6.31 |    53 |    3.48 |     2 |     3 |      2.4 |      2.2 |         0.2 |     1 |     0 |     0 |     1 |   0.5 |     400 |       75 |  6.06 |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
| 1H-Grp2              |     6.31 |    53 |    0.65 |     3 |     4 |        2 |      1.7 |         0.3 |     1 |     0 |     0 |     3 |   0.5 |     750 |       50 |  6.17 |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
| 1H-Grp3              |     6.31 |    53 |    2.85 |     2 |     3 |      2.7 |      2.3 |         0.4 |     1 |     0 |     0 |     1 |   0.5 |     200 |       10 |  6.24 |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
| Ark-hi-flux          |     6.27 |    58 |    1.33 |     2 |     3 |      1.9 |      1.4 |         0.5 |     1 |     2 |     0 |     1 |   0.5 |     450 |        5 | 6.031 |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
| Ark-hi-flux(FM)      |     6.27 |    58 |    5.38 |     2 |     3 |      2.2 |      1.7 |         0.5 |     1 |     0 |     0 |     2 |   0.5 |     300 |       15 |  6.27 |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
| Ark-Combined         |     6.27 |    58 |    1.79 |     2 |     3 |      2.1 |      1.7 |         0.4 |     1 |     0 |     0 |     2 |   0.5 |     370 |       15 |  6.04 |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
| IRAS-lo-flux         |      6.8 |    64 |    2.35 |     2 |     3 |      1.6 |      1.4 |         0.2 |     1 |     0 |     0 |     1 |   0.5 |     450 |      110 | 6.609 |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
| IRAS-hi-flux         |      6.8 |    64 |    0.33 |     2 |     3 |      1.7 |      1.4 |         0.3 |     1 |     0 |     0 |     1 |   0.5 |     600 |       50 | 6.021 |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
| IRAS-hi-flux(FM)     |      6.8 |    64 |    4.61 |     2 |     3 |      2.5 |      1.4 |         1.1 |     1 |     0 |     0 |     1 |   0.5 |     100 |       50 |   6.8 |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
| IRAS-combined        |      6.8 |    64 |    0.52 |     2 |     3 |      2.2 |      1.8 |         0.4 |     1 |     1 |     0 |     1 |   0.5 |     450 |       15 | 6.326 |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
| MCG-6-30-15-combined |      6.3 |    35 |    2.52 |     2 |     3 |      2.1 |      1.4 |         0.7 |     1 |     0 |     0 |     2 |   0.5 |     125 |       20 | 6.635 |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
| Mrk335-combined      |     7.23 |    45 |    3.68 |     2 |     3 |      2.7 |      2.2 |         0.5 |     1 |     0 |     0 |     3 |   0.5 |     150 |       87 | 6.796 |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
| Mrk335-lo-flux       |     7.23 |    45 |    2.83 |     2 |     3 |      1.4 |      1.4 |           0 |     1 |     0 |     0 |     1 |   0.5 |      50 |       15 | 7.845 |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
| Mrk766-0304030101    |     6.82 |    38 |    0.31 |     2 |     3 |      2.2 |        2 |         0.2 |     1 |     2 |     0 |     2 |   0.5 |     550 |       35 | 6.277 |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
| Mrk766-combined      |     6.82 |    38 |         |       |       |          |          |           0 |       |       |       |       |       |         |          |       |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
| Mrk766-combined(FM)  |     6.82 |    38 |    3.39 |     2 |     3 |      2.1 |      1.4 |         0.7 |     1 |     0 |     0 |     2 |   0.5 |     125 |       15 | 6.822 |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
| Mrk766-2005          |     6.82 |    38 |    1.51 |     2 |     3 |      2.9 |      2.6 |         0.3 |     1 |     2 |     0 |     3 |   0.5 |     600 |       35 | 6.329 |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
| Mrk841-combined      |     8.52 |    30 |         |       |       |          |          |           0 |       |       |       |       |       |         |          |       |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
| NGC1365-combined     |      7.6 |    40 |         |       |       |          |          |           0 |       |       |       |       |       |         |          |       |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
| NGC3516-combined     |      7.4 |    39 |         |       |       |          |          |           0 |       |       |       |       |       |         |          |       |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
| NGC4051-combined     |     6.13 |    30 |    3.39 |     2 |     3 |      2.3 |      1.4 |         0.9 |     1 |     0 |     0 |     1 |   0.5 |     124 |       48 | 6.592 |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
| NGC4151-combined     |     7.65 |    30 |         |       |       |          |          |           0 |       |       |       |       |       |         |          |       |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
| NGC4395-combined     |     5.45 |    38 |    2.55 |     2 |     3 |      2.8 |      2.7 |         0.1 |     1 |     0 |     0 |     2 |   0.5 |     240 |       80 | 5.304 |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
| NGC5548-combined     |     7.72 |    47 |         |       |       |          |          |           0 |       |       |       |       |       |         |          |       |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
| NGC6860-combined     |      7.6 |    40 |         |       |       |          |          |           0 |       |       |       |       |       |         |          |       |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
| NGC7314-combined     |      6.7 |    10 |         |       |       |          |          |           0 |       |       |       |       |       |         |          |       |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
| NGC7469-combined     |     6.96 |    26 |         |       |       |          |          |           0 |       |       |       |       |       |         |          |       |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
| PG1211+143-combined  |     7.61 |    30 |         |       |       |          |          |           0 |       |       |       |       |       |         |          |       |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
| PG1244+026-combined  |     7.26 |    38 |         |       |       |          |          |           0 |       |       |       |       |       |         |          |       |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
| PG1247+267-combined  |     8.92 |    30 |         |       |       |          |          |           0 |       |       |       |       |       |         |          |       |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+
| REJ1034+396-combined |     6.18 |    30 |         |       |       |          |          |           0 |       |       |       |       |       |         |          |       |
+----------------------+----------+-------+---------+-------+-------+----------+----------+-------------+-------+-------+-------+-------+-------+---------+----------+-------+

Multi-plot via Veusz file =ecm-fits1.vsz=

Plot =gamma1-gamma2=
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/ecm-fits1-gamma-gamma.png

Plot =tmax-chi2=
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/ecm-fits1-chi2-tmax.png

Plot =delta-Gamma-tshift-and-tmax=
Plot via single Veusz file =ecm-fits1-deltaGamma-tshft-and-tmax.vsz=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/ecm-fits1-tmax-tshift-De-Gamm.png

* *Results - New Model (since June 2020)*

PATH =/home/steff075/phd_ecm/results-for-all/results-complete.csv=

* EMCEE for ISIS

Most importantly for this research, see:

https://www.sternwarte.uni-erlangen.de/wiki/index.php/Emcee

And:

https://github.com/mcfit/isis_emcee

PATH to EMCEE for ISIS =
=/home/steff075/phd_ecm/results-for-all/emcee/isis_emcee=

To obtain this in your environment (assuming ISIS is already installed), simply clone the github
repository:

#+BEGIN_EXAMPLE
git clone https://github.com/mcfit/isis_emcee.git
#+END_EXAMPLE

Calling EMCEE in ISIS:

#+BEGIN_EXAMPLE
require("isis_emcee");
require("isisscripts");
#+END_EXAMPLE

** Walk-through example using fake data

Following :
https://www.sternwarte.uni-erlangen.de/wiki/index.php/Emcee

 First, let's fake the spectrum:

#+BEGIN_EXAMPLE
% power-law parameters
variable Gamma = 2.;
% energy grid
variable Emin = 1.; % keV
variable Emax = 10.;
variable nbins = 100;
variable lo, hi;
% fake
(lo,hi) = log_grid(Emin, Emax, nbins);
fit_fun("powerlaw");
set_par("powerlaw(1).norm", 1000);
set_par("powerlaw(1).PhoIndex", Gamma);
variable flux = eval_fun_keV(lo, hi);
variable err = sqrt(flux);
()=define_counts(
  _A(hi), _A(lo), reverse(flux + grand(nbins)*err), reverse(err)
);
#+END_EXAMPLE

Instead of perform a fit using =fit_counts= we use the emcee method:


#+BEGIN_EXAMPLE
emcee(
  100, % number of walkers, nw, per free parameter
  1000; % number of iterations, nsim, i.e., the number of "walker"-steps
  output = "emcee-chain.fits", % output FITS-filename for the chain
  serial % perform a calculation on a single core (see below)
);
#+END_EXAMPLE

In order to read the chain-file, a function called =read_chain= can be
used:

#+BEGIN_EXAMPLE

(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("emcee-chain.fits");

#+END_EXAMPLE

*Paths of the walkers*

#+BEGIN_EXAMPLE
%close_plot; % start with a fresh plot window
%open_plot("emcee_example_walkers.gif/gif");
_for i (0, nw-1, 1) { % loop over all walkers
                      % and plot their path
  chain_plot(
    1, % number of the free parameter (here: Gamma)
    i, % number of the walker to plot
    nw, % totalnumber of walkers
    chain; % the chain
    oplot  % overplot the window
  );
};
%close_plot;
#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/emcee_example_walkers.gif

*Acceptance rate*

#+BEGIN_EXAMPLE
frac_update = read_chain("emcee-chain.fits"; frac_update);


%open_plot("emcee_example_accept_rates.gif/gif");
 xlabel("Iteration Step");
 ylabel("Acceptance Rate");
 plot([0:length(frac_update)-1], frac_update);
%close_plot;
#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/emcee_example_accept_rates.gif


*Parameter probability distribution*

#+BEGIN_EXAMPLE
%open_plot("emcee_example_probability.gif/gif");
chain_hist(
  1,          % number of the free parameter (here: power-law norm)
  chain;      % the chain
  fcut = .3,  % ignore the first fcut fraction of the data (see below)
  pmin = 0, pmax = 2000 % parameter range for the histogram (see below)
);
chain_hist(1, chain; fcut = .3, % parameter plotted here: photon index
  nbin = 100  % number of bins of the histogram
);
%close_plot;

#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/emcee_example_probability.gif

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/emcee_example_probability_2.gif


*Contours: paths in 2D*

#+BEGIN_EXAMPLE
open_plot("emcee_example_2dcontours.gif/gif");
chain_hist2d(
  0,     % the x-parameter (here: egauss(1).center)
  1,     % the y-parameter (here: egauss(2).center)
  chain; % the chain
  nbinx = 400, nbiny = 400 % number of bins of the 2D-histogram - just sjhown as an example
);
close_plot;
#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/emcee_example_2dcontours.gif


*Chain statistics*

#+BEGIN_EXAMPLE
(frac_update, min_statistic, med_statistic, max_statistic) = read_chain("emcee-chain.fits"; chain_stats);
#+END_EXAMPLE

#+BEGIN_EXAMPLE
s=300; % start at this iteration step
min(min_statistic[[s:]]);
%open_plot("emcee_example_statistics.gif/gif");
n=length(max_statistic)-1;
yrange(min(min_statistic[[s:]])*.9, max(max_statistic[[s:]])*1.1);
plot([s:n], min_statistic[[300:]]);
oplot([s:n], max_statistic[[300:]]);
oplot([s:n], med_statistic[[300:]]);

%close_plot;
#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/emcee_example_statistics.gif


*Uncertainty estimation*

Calculate the probability distribution for a parameter range and
find its maximum, then calculated a given confidence interval

#+BEGIN_EXAMPLE
variable p = 1; % index of the parameter of interest (here: Photon Index)
variable lvl = .68; % confidence interval to find
variable fcut = .2; % throw away the first fcut-fraction of the chain
variable nbins = 300; % number of histogram bins

% plot the full probability distribution and let the use select
% the parameter range comfortably using the mouse

%open_plot("1H0707_example_.gif/gif");

chain_hist(p, chain; fcut = fcut, nbin = nbins);

%close_plot;

variable pmin, pmax;
(pmin,pmax,,) = cursor_box();

% Select the regions (square) with the mouse anbd double click

pmin;
pmax;

% For this example: pmin(1) = 1.9435601234436035, pmax(1) = 2.260568141937256


% histogram to get the parameter's probability distribution

variable lo, hi;
(lo, hi) = linear_grid(pmin, pmax, nbins);
variable hist = 1.*histogram(chain[p], lo, hi);

% find maximum
variable nmax = where_max(hist)[0];

% do a linear regression of the first and last n bins
variable n = 10;
variable ind = [[0:n-1], [nbins-n:nbins-1]];

% linear regression
variable lin = linear_regression(0.5*(lo+hi)[ind], hist[ind]);

% subtract the linear continuum from the probability distribution
variable newhist = hist - (lin.a + lin.b*.5*(lo+hi));

% finally, normalize!
newhist /= sum(newhist);


% Determine confidence interval
variable li = [:nmax], ri = [nmax+1:];
variable conf_min = lo[li][wherefirst(cumsum(newhist[li]) > .5 - .5*lvl)];
variable conf_max = hi[ri][wherefirst(cumsum(newhist[ri]) > .5*lvl)];
conf_min;
conf_max;
conf68 = conf_min + ((conf_max - conf_min) / 2);

fprintf (fp, "   conf68    conf_min      conf_max \n");
fprintf (fp, "%10.7f  (%10.7f - %10.7f ) \n",
   conf68, conf_min, conf_max);

% For this example: conf_min = 2.049229462941488, conf_max = 2.1422184816996257

% Plot the norm

% Plot the parameter with conf regions
%open_plot("emcee_example_results.gif/gif");
chain_hist(0, chain; fcut = fcut, nbin = nbins, pmin=pmin, pmax=pmax);
_pgmove(conf_min, 0.1);
_pgsls(2); % line style
_pgsci(1); % line color
_pgslw(1); % line width
_pgdraw(conf_min,-10.);

_pgmove(conf_max, 0.1);
_pgsls(2);
_pgsci(1);
_pgslw(1);
_pgdraw(conf_max,-10.);

_pgmove(conf68, 0.1);
_pgsls(1);
_pgsci(4);
_pgslw(2);
_pgdraw(conf68,-10);
%close_plot;

% Plot the photon index

open_plot("emcee_example_results_gamma.gif/gif");
chain_hist(1, chain; fcut = fcut, nbin = nbins, pmin=pmin, pmax=pmax);
_pgmove(conf_min, 10);
_pgsls(2); % line style
_pgsci(1); % line color
_pgslw(1); % line width
_pgdraw(conf_min,-10.);

_pgmove(conf_max, 10);
_pgsls(2);
_pgsci(1);
_pgslw(1);
_pgdraw(conf_max,-1);

_pgmove(conf68, 10);
_pgsls(1);
_pgsci(4);
_pgslw(2);
_pgdraw(conf68,-1);
close_plot;

#+END_EXAMPLE

*Results*

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/emcee_example_results.gif

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/emcee_example_results_gamma.gif


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/emcee_example_2dcontours.gif

** Testing isis-EMCEE on 1H0707-495 Obs 0110890201

This chapter follows the =isis_emcee= example at REF:
https://www.sternwarte.uni-erlangen.de/wiki/index.php/Emcee

PATH TO DATA = =/data/typhon1/reverb/1H0707-495/isis_emcee/=

Fit script = =1H0707-0110890201-fit-emcee.sl=

Fitting Parameter file =1H0707_0110890201_A_best_fit.par=

Fit obs 0110890201 to the best fit using the scripts outlined (above)

Make good image of the ECM Model fit

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0110890201_best fit.ps/cps");
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
plot_comps(1,popt,&plot_data);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgsci(1); % make line colour black
_pgdraw(1,0);
close_plot(pid);
#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_best_fit-1.png

This model fit with χ²=0.08 and the parameters for this particular fit are:

+----------+----------------------+--------+--------+--------------+-----+-------+
| lag_freq |                      |        |        |              |     |       |
+----------+----------------------+--------+--------+--------------+-----+-------+
|      idx | param                | tie-to | freeze |        value | min |   max |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        1 | lag_freq(1).norm     |      0 |      0 | 4.514207e-05 |   0 | 0.001 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        2 | lag_freq(1).log_mass |      0 |      0 |     6.034376 |   5 |     7 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        3 | lag_freq(1).i        |      0 |      1 |           53 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        4 | lag_freq(1).a        |      0 |      1 |        0.998 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        5 | lag_freq(1).h1       |      0 |      1 |            2 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        6 | lag_freq(1).h2       |      0 |      1 |            7 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        7 | lag_freq(1).Gamma1   |      0 |      1 |          3.1 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        8 | lag_freq(1).Gamma2   |      0 |      1 |          2.9 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        9 | lag_freq(1).Fe       |      0 |      1 |            1 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       10 | lag_freq(1).xi       |      0 |      1 |            3 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       11 | lag_freq(1).p        |      0 |      1 |            0 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       12 | lag_freq(1).b        |      0 |      1 |            3 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       13 | lag_freq(1).q2       |      0 |      1 |          0.5 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       14 | lag_freq(1).t_max    |      0 |      1 |          560 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       15 | lag_freq(1).t_shift  |      0 |      1 |           20 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+

*Lets Apply EMCEE to this model and use 500 Walkers with 5000 iterations in the chain*

#+BEGIN_EXAMPLE
isis

.source("1H0707-0110890201-fit-emcee.sl");

where

% Perform MCMC
emcee(500, 5000; output="1H0707_0110890201_chain_500_5000.fits", serial);

% Read the chain-file
(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("1H0707_0110890201_chain_500_5000.fits");
#+END_EXAMPLE


*Paths of the walkers*

This is done by:

#+BEGIN_EXAMPLE
% Read the chain-file
(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("1H0707_0110890201_chain_500_5000.fits");

close_plot; % start with a fresh plot window
_for i (0, nw-1, 1) { % loop over all walkers
                      % and plot their path
  chain_plot(
    1, % number of the free parameter (here: Gamma)
    i, % number of the walker to plot
    nw, % totalnumber of walkers
    chain; % the chain
    oplot % overplot the window
  );
};

%Make good image of the paths of the walkers
variable pid = open_plot("1H0707_0110890201_walkers.ps/cps");
charsize(1.3); %good font size
_pgscf(2); %make font roman
chain_plot(1,i,nw,chain);
close_plot(pid);

Then

ps2pdf 1H0707_0110890201_walkers.ps
pdftocairo -png 1H0707_0110890201_walkers.pdf
cp 1H0707_0110890201_walkers-1.png /home/WWW/steff/ecm
#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_walkers-1.png



*The Acceptance rate*

The preferred way to check the MCMC result on convergence is to
investigate the so-called acceptance rate. "This is fraction of
proposed steps [of the walkers] that are accepted."
(Foreman-Mackey, 2013).

These steps are where the walkers did
NOT move back to its previous position, the acceptance rate should be
0.2--0.5 once the algorithm converged,
although "There appears to be no agreement on the optimal acceptance
rate".

In order to investigate the acceptance rate of a previous emcee run,
a different extension of the resulting FITS file has to be read, w
hich can be achieved by using the =frac_update-qualifier= on =read_chain=:


Make good image of the Acceptance rate

#+BEGIN_EXAMPLE
% Acceptance rate
frac_update = read_chain("1H0707_0110890201_chain.fits"; frac_update);
xlabel("Iteration Step");
ylabel("Acceptance Rate");
plot([0:length(frac_update)-1], frac_update);

variable pid = open_plot("1H0707_0110890201_mass_accept_rate.ps/cps");
charsize(1.3); %good font size
_pgscf(2); %make font roman
xlabel("Iteration Step");
ylabel("Acceptance Rate");
plot([0:length(frac_update)-1], frac_update);
close_plot(pid);


Then:

ps2pdf 1H0707_0110890201_mass_accept_rate.ps
pdftocairo -png 1H0707_0110890201_mass_accept_rate.pdf
cp 1H0707_0110890201_mass_accept_rate-1.png  /home/WWW/steff/ecm
#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_mass_accept_rate-1.png


The 2 free parameters of this model were Norm(0) and =log_mass(1)= so lets
obtain the probability distributions of these:

Obtain the Norm pobability

#+BEGIN_EXAMPLE
chain_hist(
  0,          % number of the free parameter (here: power-law norm)
  chain;      % the chain
  fcut = .3,  % ignore the first fcut fraction of the data (see below)
  pmin = 0, pmax = 0.001 % parameter range for the histogram (see below)
);

chain_hist(0, chain; fcut = .3, % parameter plotted here: photon index
  nbin = 200  % number of bins of the histogram
);

% Make good image of the Norm probability
variable pid = open_plot("1H0707_0110890201_norm_probability.ps/cps");
charsize(1.3); %good font size
_pgscf(2); %make font roman
chain_hist(0, chain; fcut = .3,min = 0, pmax = 0.001, nbin = 200);
close_plot(pid);
#+END_EXAMPLE


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_norm_probability-1.png


Obtain the Mass probability

#+BEGIN_EXAMPLE
chain_hist(
  0,          % number of the free parameter (here: power-law norm)
  chain;      % the chain
  fcut = .3,  % ignore the first fcut fraction of the data (see below)
  pmin = 6.0, pmax = 6.5 % parameter range for the histogram (see below)
);

chain_hist(1, chain; fcut = .3, % parameter plotted here: photon index
  nbin = 200  % number of bins of the histogram
);

%Make good image of the Mass probability

variable pid = open_plot("1H0707_0110890201_mass_probability.ps/cps");
charsize(1.3); %good font size
%nice_width; %good line ratios
_pgscf(2); %make font roman
chain_hist(1, chain; fcut = .3, % parameter plotted here: photon index
        nbin = 200  % number of bins of the histogram
      );
close_plot(pid);


Then:

ps2pdf 1H0707_0110890201_mass_probability.ps
pdftocairo -png 1H0707_0110890201_mass_probability.pdf
cp 1H0707_0110890201_mass_probability-1.png /home/WWW/steff/ecm
#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_mass_probability-1.png

*Contours: paths in 2D*

#+BEGIN_EXAMPLE
chain_hist2d(
  1,     % the x-parameter (here: log_mass(1))
  0,     % the y-parameter (here: norm(0))
  chain; % the chain
  nbinx = 200, nbiny = 200 % number of bins of the 2D-histogram
);
#+END_EXAMPLE

Make good image of the Contours

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0110890201_chain_hist2d.ps/cps");
charsize(1.3); %good font size
_pgscf(2); %make font roman
chain_hist2d(1,0,chain; nbinx = 200, nbiny = 200);
close_plot(pid);

Then:

ps2pdf 1H0707_0110890201_chain_hist2d.ps
pdftocairo -png 1H0707_0110890201_chain_hist2d.pdf
cp  1H0707_0110890201_chain_hist2d-1.png /home/WWW/steff/ecm

#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_chain_hist2d-1.png

*Chain statistics*

It is also possible to investigate the actual χ² along the paths of the walkers. This data is loaded by =read_chain= using the =chain_stats-qualifier=,

#+BEGIN_EXAMPLE
(frac_update, min_statistic, med_statistic, max_statistic) = read_chain("1H0707_0110890201_chain_500_5000.fits"; chain_stats);
#+END_EXAMPLE

which returns the minimum, median, and maximum statistics,
=min_statistic=, =med_statistic= and =max_statistic=, respectively, and the
acceptance rate, =frac_update=, as described above. The three statistic
arrays contain information about the χ²-distribution at each iteration
step. Contrary to one might think at the first place, there are
multiple evaluations of the model at each step. In detail, there is
one evaluation for each walker, i.e., nw x nfreepar evaluations in
total (since there are nw walkers for each free parameter, see the
introduction in the reference for more detail). Consequently, =min_statistic= contains the minimum
value of the χ² distribution, =max_statistic= its maximum value, and
=med_statistic= its median.

For example, looking for the minimum within
=min_statistic= after the MCMC converged (after iteration step 600 in
the iterations of the walker paths) should represent the best statistics found:


#+BEGIN_EXAMPLE
s=600; % start at this iteration step
min(min_statistic[[s:]]);


min(min_statistic[[s:]]);
0.08284946618179345
#+END_EXAMPLE

Here, this results in χ²=0.08, which is identical after previously
fitting the data where χ²=0.08 as outlined above.

Plotting the statistic array is another diagnostic tool:

#+BEGIN_EXAMPLE

n=length(max_statistic)-1;
yrange(min(min_statistic[[s:]])*.9, max(max_statistic[[s:]])*1.1);
plot([s:n], min_statistic[[600:]]);
oplot([s:n], max_statistic[[600:]]);
oplot([s:n], med_statistic[[600:]]);

#+END_EXAMPLE

Make good image of the statistics

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0110890201_statistics.ps/cps");
charsize(1.3); %good font size
_pgscf(2); %make font roman
plot([s:n], min_statistic[[600:]]);
oplot([s:n], max_statistic[[600:]]);
oplot([s:n], med_statistic[[600:]]);
close_plot(pid);

Then:

ps2pdf 1H0707_0110890201_statistics.ps
pdftocairo -png 1H0707_0110890201_statistics.pdf
cp  1H0707_0110890201_statistics-1.png /home/WWW/steff/ecm

#+END_EXAMPLE


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_statistics-1.png


Error analysis

#+BEGIN_EXAMPLE
variable p = 1; % index of the parameter of interest (here: norm(0))
variable lvl = .90; % confidence interval to find
variable fcut = .2; % throw away the first fcut-fraction of the chain
variable nbins = 200; % number of histogram bins
chain_hist(p, chain; fcut = fcut, nbin = nbins);
%close_plot;

variable pmin, pmax;
(pmin,pmax,,) = cursor_box();

pmin;
pmax;

% histogram to get the parameter's probability distribution

variable lo, hi;
(lo, hi) = linear_grid(pmin, pmax, nbins);
variable hist = 1.*histogram(chain[p], lo, hi);

% find maximum
variable nmax = where_max(hist)[0];

% do a linear regression of the first and last n bins
variable n = 10;
variable ind = [[0:n-1], [nbins-n:nbins-1]];

% linear regression
variable lin = linear_regression(0.5*(lo+hi)[ind], hist[ind]);

% subtract the linear continuum from the probability distribution
variable newhist = hist - (lin.a + lin.b*.5*(lo+hi));

% finally, normalize!
newhist /= sum(newhist);

% Determine confidence interval
variable li = [:nmax], ri = [nmax+1:];
variable conf_min = lo[li][wherefirst(cumsum(newhist[li]) > .5 - .5*lvl)];
variable conf_max = hi[ri][wherefirst(cumsum(newhist[ri]) > .5*lvl)];
variable conf_mean = conf_min + ((conf_max - conf_min) / 2);
conf_min;
conf_max;
conf_mean;

% Plot the parameter with conf regions
%open_plot("1H0707_0110890201_logmass_conf68.gif/gif");
%open_plot("1H0707_0110890201_logmass_conf90.gif/gif");
chain_hist(1, chain; fcut = fcut, nbin = nbins, pmin=pmin, pmax=pmax);
_pgmove(conf_min, 0);
_pgsls(2); % line style
_pgsci(1); % line color
_pgslw(1); % line width
_pgdraw(conf_min, 100);

_pgmove(conf_max, 0);
_pgsls(2);
_pgsci(1);
_pgslw(1);
_pgdraw(conf_max, 100);

_pgmove(conf_mean, 0);
_pgsls(1);
_pgsci(4);
_pgslw(2);
_pgdraw(conf_mean, 100);

%close_plot;
#+END_EXAMPLE


#+CAPTION: The 68% confidence probability for 1H0707-495 Mass value where $\mu = 6.05\pm0.03$ (solid blue line. Error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_logmass_conf68.gif



#+CAPTION: The 90% confidence probability for 1H0707-495 Mass value where $\mu = 6.06\pm0.05$ (solid blue line) with the error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_logmass_conf90.gif



#######################################################################################

#######################################################################################

This is not good, there are 2 possible solutions here !!!



#######################################################################################

#######################################################################################

#+BEGIN_EXAMPLE


#+END_EXAMPLE



#+BEGIN_EXAMPLE

#+END_EXAMPLE

#+BEGIN_EXAMPLE


#+END_EXAMPLE
#+BEGIN_EXAMPLE


#+END_EXAMPLE



#+BEGIN_EXAMPLE


#+END_EXAMPLE




#+BEGIN_EXAMPLE


#+END_EXAMPLE







*Chain statistics*

It is also possible to investigate the actual χ² along the paths of the walkers. This data is loaded by =read_chain= using the =chain_stats-qualifier=,

#+BEGIN_EXAMPLE
(frac_update, min_statistic, med_statistic, max_statistic) = read_chain("1H0707_0110890201_chain_500_5000.fits"; chain_stats);
#+END_EXAMPLE

which returns the minimum, median, and maximum statistics,
=min_statistic=, =med_statistic= and =max_statistic=, respectively, and the
acceptance rate, =frac_update=, as described above. The three statistic
arrays contain information about the χ²-distribution at each iteration
step. Contrary to one might think at the first place, there are
multiple evaluations of the model at each step. In detail, there is
one evaluation for each walker, i.e., nw x nfreepar evaluations in
total (since there are nw walkers for each free parameter, see the
introduction in the reference for more detail). Consequently, =min_statistic= contains the minimum
value of the χ² distribution, =max_statistic= its maximum value, and
=med_statistic= its median.

For example, looking for the minimum within
=min_statistic= after the MCMC converged (after iteration step 600 in
the iterations of the walker paths) should represent the best statistics found:


#+BEGIN_EXAMPLE
s=600; % start at this iteration step
min(min_statistic[[s:]]);


min(min_statistic[[s:]]);
0.08284946618179345
#+END_EXAMPLE

Here, this results in χ²=0.08, which is identical after previously
fitting the data where χ²=0.08 as outlined above.

Plotting the statistic array is another diagnostic tool:

#+BEGIN_EXAMPLE

n=length(max_statistic)-1;
yrange(min(min_statistic[[s:]])*.9, max(max_statistic[[s:]])*1.1);
plot([s:n], min_statistic[[600:]]);
oplot([s:n], max_statistic[[600:]]);
oplot([s:n], med_statistic[[600:]]);

#+END_EXAMPLE

Make good image of the statistics

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0110890201_statistics_2k.ps/cps");
charsize(1.3); %good font size
_pgscf(2); %make font roman
plot([s:n], min_statistic[[600:]]);
oplot([s:n], max_statistic[[600:]]);
oplot([s:n], med_statistic[[600:]]);
close_plot(pid);

Then:

ps2pdf 1H0707_0110890201_statistics_2k.ps
pdftocairo -png 1H0707_0110890201_statistics_2k.pdf
cp  1H0707_0110890201_statistics_2k-1.png /home/WWW/steff/ecm

#+END_EXAMPLE


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_statistics_2k-1.png


*Uncertainty estimation*

In a perfect or simple case, where all probability distributions are
single-peaked,  the uncertainty of the most probable parameter value
can be estimated by finding the parameter interval containing a
certain amount of walkers, e.g., 68%. Once the distribution is
multi-peaked deriving reliable uncertainties is no longer that
trivial.  In principle, however, finding the 68% interval for every
peak while neglecting  all other peaks is still okay.  In this case it
should be precisely  described in, e.g., a paper what has been done derive the uncertainties.

In the following a code snippet for finding a certain probability
interval is given in the case of a multi-peaked distribution. The idea
is to first select the parameter range such that one peak is isolated:


#+BEGIN_EXAMPLE
variable p = 0; % index of the parameter of interest (here: norm(0))
variable lvl = .68; % confidence interval to find
variable fcut = .2; % throw away the first fcut-fraction of the chain
variable nbins = 200; % number of histogram bins

% plot the full probability distribution and let the use select
% the parameter range comfortably using the mouse
chain_hist(p, chain; fcut = fcut, nbin = nbins);
variable pmin, pmax;
(pmin,pmax,,) = cursor_box();

#+END_EXAMPLE

Then calculate the probability distribution in this parameter range
and find its maximum (very simple here, you might consider fitting,
e.g., a Gaussian to the peak or other functions):

#+BEGIN_EXAMPLE

% histogram to get the parameter's probability distribution
variable starti = int(ceil(fcut*length(chain[1,*]))); % start bin of the chain to use
variable lo, hi;
(lo, hi) = linear_grid(pmin, pmax, nbins);
variable hist = 1.*histogram(chain[p,[starti:]], lo, hi);
% note: no normalization here, we do that below

% find maximum (very simple here)
variable nmax = where_max(hist)[0];

#+END_EXAMPLE

######  Above code does not work ! #######

######################

   UP TO HERE !!!

######################

So I will try:

#+BEGIN_EXAMPLE
variable p = 1; % index of the parameter of interest (here: norm(0))
variable lvl = .68; % confidence interval to find
variable fcut = .2; % throw away the first fcut-fraction of the chain
variable nbins = 200; % number of histogram bins

% plot the full probability distribution and let the use select
% the parameter range comfortably using the mouse
chain_hist(p, chain; fcut = fcut, nbin = nbins);
variable pmin, pmax;
(pmin,pmax,,) = cursor_box();

% Select a box around the first peak and double click, then you can see that:
% pmin;
% 5.97137451171875
% pmax;
% 6.079108238220215


chain_hist(1, chain; fcut = .3, pmin = 5.98, pmax = 6.075);

fit_fun("gauss(1)");
set_par(2, 6.03, 0);
renorm_counts;
fit_counts();
list_par;
eval_counts();

###########################
###########################


Unable to fit a Gauss to the peak !!!!


////////////////////

.source("1H0707-0110890201-fit-emcee.sl");

#+END_EXAMPLE





/Continue on example from website:/

In order to get rid of the continuum, which might be present in case
of the paths between different solutions, we try to model it by a
linear function (again, very simple):


#+BEGIN_EXAMPLE
% do a linear regression of the first and last n bins
variable n = 10;
variable ind = [[0:n-1], [nbins-n:nbins-1]];
% linear regression
variable lin = linear_regression(
  .5*(lo+hi)[ind], hist[ind]
);

% subtract the linear continuum from the probability distribution
variable newhist = hist - (lin.a + lin.b*.5*(lo+hi));
% finally, normalize!
newhist /= sum(newhist);
#+END_EXAMPLE


Finally, we determine the confidence interval by analyzing the
cumulative sum:

#+BEGIN_EXAMPLE
% indices of left and right wing (undetermined index arrays; a nice SLang feature)
variable li = [:nmax], ri = [nmax+1:];
% find confidence intervals
variable conf_min = lo[li][wherefirst(cumsum(newhist[li]) > .5 - .5*lvl)];
variable conf_max = hi[ri][wherefirst(cumsum(newhist[ri]) > .5*lvl)];
#+END_EXAMPLE

The following table compares the emcee results for the power-law
example above with the classical χ² approach (conf_loop([1,2], 0):


|       | Gamma       | Norm        |
| emcee | 1.97 ± 0.06 | 1000 -70+90 |
| χ²    | 1.97 ± 0.10 | 990 ± 90    |

As one can see, the most probable or best-fit values nicely agree
within the uncertainties. The uncertainties of the emcee result seem
to be slightly smaller than compared to the χ² method. This is not
astonishing as the actual reduced χ² = 0.90, i.e., the fit is slightly
over determined. Finding a certain Δχ² and interpreting the
corresponding parameter range as an uncertainty assumes that the
reduced χ² is exactly 1.

** Testing isis-EMCEE on 1H0707-495 Obs 0506200201

This chapter follows the above example at REF:
https://www.sternwarte.uni-erlangen.de/wiki/index.php/Emcee

PATH TO DATA = =/data/typhon1/reverb/1H0707-495/isis_emcee/=

Fit script = =1H0707-0506200201-fit-emcee.sl=

Fitting Parameter file =1H0707_0506200201_best_fit.par=

Fit obs 0506200201 to the best fit using the scripts outlined (above)

Make good image of the ECM Model fit

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0506200201_best_fit.ps/cps");
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
plot_comps(1,popt,&plot_data);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgsci(1); % make line colour black
_pgdraw(1,0);
close_plot(pid);
#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_best_fit-1.png

This model fit with χ²=0.08 and the parameters for this particular fit are:


*Lets Apply EMCEE to this model and use 500 Walkers with 5000 iterations in the chain*

#+BEGIN_EXAMPLE
isis

.source("1H0707-0506200201-fit-emcee.sl");

where

% Perform MCMC
emcee(500, 5000; output="1H0707_0110890201_chain_500_5000.fits", serial);

% Read the chain-file
(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("1H0707_0110890201_chain_500_5000.fits");
#+END_EXAMPLE


*Paths of the walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_walkers-1.png



*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_mass_accept_rate-1.png


Norm probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_norm_probability-1.png


Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_mass_probability-1.png

*Contours: paths in 2D*


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_chain_hist2d-1.png

*Chain statistics*


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_statistics-1.png



*Uncertainty estimation*

#+BEGIN_EXAMPLE
 min(min_statistic[[s:]]);
1.1657597134124094

isis> pmin;
6.000844955444336

isis> pmax;
6.3415846824646

..............................

At 68% conf:

isis> conf_min;
6.126918654441834
isis> conf_max;
6.188251805305481
isis> conf_mean;
6.157585229873657

...................................

At 90% conf

isis> conf_min;
6.106474270820618

isis> conf_max;
6.2052887916564945

isis> conf_mean;
6.155881531238556

#+END_EXAMPLE

#+CAPTION: The 68 % confidence mass for 1H0707-495 OBS ID 0506200201 at $6.16\pm 0.03~logM_{\odot}$.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_logmass_conf68.gif

#+CAPTION: The 90 % confidence mass for 1H0707-495 OBS ID 0506200201 at $6.16\pm 0.05~logM_{\odot}$
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_logmass_conf90.gif


** Test a free par fit chain

PATH = =/data/typhon1/reverb/1H0707-495/isis_emcee=

Using fitting script =1H0707-0110890201-fit-emcee.sl=

Instead of fitting each par by defining lag-fits file ranges,
use parameter file =1H0707_0110890201_emcee_fit.par=

#+BEGIN_EXAMPLE
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.514207e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.034376           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0                7           3          20
  7  lag_freq(1).Gamma1     0     0              3.1         1.4         3.3
  8  lag_freq(1).Gamma2     0     0              2.9         1.4         3.3
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0                3           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0                3           0           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0              560         100         700
 15  lag_freq(1).t_shift    0     0               20           0         120
#+END_EXAMPLE


Output chain will be =1H0707_0110890201_chain_500_1000_free.fits=

This chain did work but it did dont converge !!
isis
Running chain =1H0707_0110890201_chain_500_10000_free.fits=

[detached from 80164.pts-6.hm00]
hm00:/data/typhon1/reverb/1H0707-495/isis_emcee>

** Test a joint fit

PATH =
=/data/typhon1/reverb/1H0707-495/isis_emcee/1H0707-joint-fit-emcee.sl=

Loading par file for OBS 0110890201 & 0148010301
=1H0707-joint-fit.par=

#+BEGIN_EXAMPLE
lag_freq(1) + lag_freq(2)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.514207e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.034376           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                7           0           0
  7  lag_freq(1).Gamma1     0     1              3.1           0           0
  8  lag_freq(1).Gamma2     0     1              2.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              560           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0
 16  lag_freq(2).norm       0     0     2.782242e-05           0       0.001
 17  lag_freq(2).log_mass   0     0         6.208855           5           7
 18  lag_freq(2).i          0     1               53           0           0
 19  lag_freq(2).a          0     1            0.998           0           0
 20  lag_freq(2).h1         0     1                2           0           0
 21  lag_freq(2).h2         0     1                5           0           0
 22  lag_freq(2).Gamma1     0     1              2.4           0           0
 23  lag_freq(2).Gamma2     0     1              2.2           0           0
 24  lag_freq(2).Fe         0     1                1           0           0
 25  lag_freq(2).xi         0     1                2           0           0
 26  lag_freq(2).p          0     1                0           0           0
 27  lag_freq(2).b          0     1                3           0           0
 28  lag_freq(2).q2         0     1              0.5           0           0
 29  lag_freq(2).t_max      0     1              700           0           0
 30  lag_freq(2).t_shift    0     1               60           0           0
#+END_EXAMPLE

Run 1H0707-joint-fit-emcee.sl

#+BEGIN_EXAMPLE
isis
.source("1H0707-joint-fit-emcee.sl");

///////

Notes:

This pulls in lag-files:


Ignore_PHA_Response_Keywords = 1;
variable d_1 = load_data("/data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-OBS-0110890201-time-lags-A.fits");
variable r_1 = load_rmf("/data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-OBS-0110890201-time-lags-A.rsp");
assign_rmf(r_1, d_1);

Ignore_PHA_Response_Keywords = 1;
variable d_2 = load_data("/data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-OBS-0148010301_time_lags.fits");
variable r_2 = load_rmf("/data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-OBS-0148010301_time_lags.rsp");
assign_rmf(r_2, d_2);

load_par("1H0707-joint-fit.par");
Label_By_Default = 0;
popt.xlabel="Frequency (Hz)";
popt.ylabel="Time lag (s)";
popt.yrange=[-350, 700];
popt.xrange=[6e-5, 0.01];
xlog;
popt.dsym=[16,16];
popt.dcol=[2,4];
popt.mcol=[2,4];

This runs emcee:

emcee(500, 1000; output="1H0707_joint1_chain.fits", serial);

#+END_EXAMPLE

When run,  first plot the two fits:

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_joint_fit1.ps/cps");
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
Label_By_Default = 0;
popt.xlabel="Frequency (Hz)";
popt.ylabel="Time lag (s)";
xlog;
popt.yrange=[-300, 800];
popt.xrange=[1e-4, 0.01];
load_par("1H0707-joint-fit.par");
popt.dsym=[16,16];
popt.dcol=[2,4];
popt.mcol=[2,4];
() = fit_counts;
plot_data({1,2}, popt);
_pgsci(1); % make line colour black
_pgslw(1);
_pgsls(2);
_pgmove(-4, 0);
_pgdraw(-1, 0);
close_plot(pid);

#+END_EXAMPLE


The joint fit model

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_joint_fit1-1.png

Paths of the walkers

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_joint_walkers-1.png


The Norm pobability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_joint_norm_probability-1.png


The Mass pobability
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_joint_mass_probability-1.png

Mass acceptance rate

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_joint_mass_accept_rate-1.png


Contours: paths in 2D

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_joint_chain_hist2d-1.png


Chain statistics

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_joint_statistics-1.png

* HEASP

Initiate HEASP on typhon

#+BEGIN_EXAMPLE
setenv HEADAS /usr/local/heasoft-6.28/x86_64-pc-linux-gnu-libc2.17
source $HEADAS/headas-init.csh
python3

import heasp
#+END_EXAMPLE

* EMCEE for Python

Most importantly for this research, see:

https://www.sternwarte.uni-erlangen.de/wiki/index.php/Emcee

EMCEE is installed on Thyphon and Lyra. The working directory is
=/home/steff075/phd_ecm/results-for-all/emcee= and once good code is
generated it will be copided to typhon for replication by others.


EMCEE REF =  =https://emcee.readthedocs.io/en/stable=

PATH = =/home/steff075/phd_ecm/results-for-all/emcee=

and copied to Typhon once working:

ssh to typhon1
#+BEGIN_EXAMPLE

ssh steff075@typhon.star.bris.ac.uk -XY

cd /data/typhon1/reverb
#+END_EXAMPLE

** Posterior Density of parameters
*** Examaple of how to sample a multi-dimensional Gaussian

      What follows is based on the examples provided at:
  https://emcee.readthedocs.io/en/stable/tutorials/quickstart/

*Multivariate Gaussian Distribution*

We can draw samples from the multivariate Gaussian density given by:

$p(x⃗ )∝exp[−12(x⃗ −μ⃗ )TΣ−1(x⃗ −μ⃗ )]$

where μ⃗ is an N-dimensional vector position of the mean of the density and Σ is the square N-by-N covariance matrix.

Script = =/home/steff075/phd_ecm/results-for-all/emcee/1H0707-mass-emcee.py=

#+BEGIN_EXAMPLE
import numpy as np

def log_prob(x, mu, cov):
    diff = x - mu
    return -0.5 * np.dot(diff, np.linalg.solve(cov, diff))

data = np.loadtxt('1H0707-495_Variable_Mass_Mean.csv', delimiter=',', skiprows=1)
data_chi = data[:,0]
data_mass = data[:,1]

# Create a 2-d array from my data
chi_mass = np.stack((data_chi, data_mass))
ndim = 2
means = chi_mass.mean(axis=1) #Take the mean of each row in array

#+END_EXAMPLE

The arrays defined is a 2-d array containing the $\chi^2$ values of
the best fits of the mass for 1H0707-495, these are:

#+BEGIN_EXAMPLE
>>> data_chi
array([2.04, 3.34, 2.43, 0.27, 1.68, 0.95, 1.7 , 0.96, 1.16, 1.35, 1.1 ,
       1.27, 0.24, 1.25, 3.43, 0.66, 0.65, 0.09, 5.79, 2.34, 1.78])

and


>>> data_mass
array([6.027921, 5.943525, 5.938911, 5.918436, 6.171217, 6.258479,
       6.074621, 6.20887 , 6.154736, 6.      , 6.126042, 6.471828,
       6.249992, 6.397703, 6.182876, 6.399108, 6.256892, 6.011134,
       6.08472 , 6.001751, 6.190454])

Resultant array

>>> chi_mass
array([[2.04    , 3.34    , 2.43    , 0.27    , 1.68    , 0.95    ,
        1.7     , 0.96    , 1.16    , 1.35    , 1.1     , 1.27    ,
        0.24    , 1.25    , 3.43    , 0.66    , 0.65    , 0.09    ,
        5.79    , 2.34    , 1.78    ],
       [6.027921, 5.943525, 5.938911, 5.918436, 6.171217, 6.258479,
        6.074621, 6.20887 , 6.154736, 6.      , 6.126042, 6.471828,
        6.249992, 6.397703, 6.182876, 6.399108, 6.256892, 6.011134,
        6.08472 , 6.001751, 6.190454]])

with means

array([1.64190476, 6.14615314])

#+END_EXAMPLE

Next we will use 50 walkers
We need to guess a starting point for each of the 50 walkers.
This position will be a 5-dimensional vector so the initial guess
should be a 50-by-2 array.
It’s not a very good guess but we’ll just guess a random number between 0 and 1 for each component:

#+BEGIN_EXAMPLE
nwalkers = 50
p0 = np.random.rand(nwalkers, ndim)
#+END_EXAMPLE

Now inport emcee module and initiate the Ensemble Sampler

#+BEGIN_EXAMPLE
import emcee

sampler = emcee.EnsembleSampler(nwalkers, ndim, log_prob, args=[means, cov])
#+END_EXAMPLE

Remember how our function log_prob required two extra arguments when
it was called? By setting up our sampler with the args argument,
we’re saying that the probability function should be called as:

#+BEGIN_EXAMPLE
log_prob(p0[0], means, cov)
#+END_EXAMPLE

Value returned is:

#+BEGIN_EXAMPLE
-0.008379411098914982
#+END_EXAMPLE

It’s generally a good idea to run a few “burn-in” steps in your MCMC
chain to let the walkers explore the parameter space a bit and get
settled into the maximum of the density. We’ll run a burn-in of 100
steps (yep, I just made that number up… it’s hard to really know how
many steps of burn-in you’ll need before you start) starting from our
initial guess p0:

#+BEGIN_EXAMPLE
state = sampler.run_mcmc(p0, 100)
sampler.reset()
#+END_EXAMPLE

You’ll notice that I saved the final position of the walkers (after
the 100 steps) to a variable called state. You can check out what will
be contained in the other output variables by looking at the
documentation for the EnsembleSampler.run_mcmc() function. The call to
the EnsembleSampler.reset() method clears all of the important
bookkeeping parameters in the sampler so that we get a fresh start.
It also clears the current positions of the walkers so it’s a good thing that we saved them first

Now, we can do our production run of 10000 steps:

#+BEGIN_EXAMPLE
sampler.run_mcmc(state, 10000);
#+END_EXAMPLE


This returns

#+BEGIN_EXAMPLE
State([[ -35.90392858  -82.25682716]
 [ -40.7406553   -45.69677477]
 [ -28.38033994  -48.1779884 ]
 [  32.44129628   37.7768807 ]
 [ -13.08350028   -0.92154495]
 [   4.39748754   12.16174963]
 [  14.28102515   19.73104905]
 [  22.08066365   54.78203077]
 [  29.7786179    -3.33954523]
 [  -5.7680351    39.50174889]
 [ -16.6510576   -20.68748899]
 [   9.78017894   14.04170406]
 [   6.40165639    2.90744155]
 [  32.33296826   13.20953545]
 [  52.07487462   27.04429822]
 [   8.0116522     1.06630499]
 [  60.95763393   35.80472062]
 [ -81.04645289 -102.99600398]
 [  47.53481404   35.96969184]
 [  23.89282716  -52.37766562]
 [   9.43004553   54.06257631]
 [ -30.8805676   -81.71599899]
 [   3.53925488  -55.53371761]
 [ -19.4330932   -61.95638887]
 [  15.86878601   -3.46729714]
 [   8.0760494    19.74195584]
 [  60.27559163   12.3010944 ]
 [  30.81000254   20.64900749]
 [  56.64072575   53.39460682]
 [ -18.39804516  -21.85504905]
 [ -54.39623317   15.37057723]
 [  11.66582441  -53.49133691]],

log_prob=[-1.47583193 -0.66483207 -0.53227967 -0.34048961 -0.10702011 -0.00666099
 -0.0573124  -0.44853988 -0.9096984  -0.71094323 -0.1431223  -0.02394689
 -0.03595242 -0.59925568 -1.33806113 -0.0713369  -1.70397426 -2.64725717
 -0.89642629 -2.91938989 -0.66430474 -1.54820327 -1.65479596 -1.01691067
 -0.31985431 -0.03373365 -2.49867432 -0.41311968 -1.1322164  -0.16317326
 -3.03141219 -2.04620784],

 blobs=None, random_state=('MT19937', array([2720974480,
       4251008247,509842700, 2171091319, 2955895858,
       1788405147, 3749800586,  720415652, 3905730882, 1855784210,
       2962045085, 1245016345, 2514458250, 2405678754, 3884229046,
       3740516887, 1940894474, 1954076160, 2444259605,  857602640,
       2467163849, 3236231982, 1776196279, 4206544050,  908319995,
          8265124, 2816553389, 2104067192,    9312979, 3775564087,
        850320650,  539484266, 2519039859, 1810460233, 3605221127,
        907315309, 3373422575, 3726569057, 1925094777, 2641629975,
       4086405321, 1489977182, 1721947441, 2496135387,  591576247,
       2160222859, 2618294273, 2657735112, 2673506486, 2414890021,
        427998723, 2659586011, 2140560359, 1725755687,  841282718,
       2586124175, 3910317757, 2069135947,  198983236, 4245967194,
       2892349014, 2185114063, 1951812217, 1871543255, 3300836595,
       3536533693, 2262187436, 1537647903, 1812935080, 2713510552,
       4005321614, 2210582935,  996282591, 2789476975,  405642984,
       4211824817, 3464922340, 3052203045, 1613390079, 1278390712,
       3938044485, 3034502586, 2057448613, 3755767695,  166323026,
       4081263295,  211674878,  227338533, 2031432450, 3527913999,
       2877441665, 2376587312, 1341528229, 3124908987, 3334728879,
       3995301989, 3775153501, 1411819693, 2793126263, 2946918784,
       3011475614, 1617557816,  223891332,  260919264, 1332270463,
        668304034,  421529125, 2799776411, 1413108063, 1522004731,
       4079784489, 1869015721, 1862814873, 3165267602,  785489394,
       1830049679, 2493747314,  708480332, 3285440456, 3934941962,
       3774855951, 3918958934, 2564705430,  717496328,  421000153,
        755499871, 1395095055, 2072971623, 3910682585, 1833514185,
       2241548635, 4284300303, 2304173589, 1469091826,  966209877,
        258133760, 1639560853, 3397636786, 1791684712, 3421932659,
         72681797,  700772793, 3340141224, 3762953206, 2205322303,
       4059925141, 2974987181, 1312261948, 1225477735,  494441333,
        696870988,  284368762, 3082712851, 2993373769,  633182631,
       1809257676, 4069298926, 3852679699, 3763201725, 2565569225,
       3526583247,  296683743, 1249242324,   85739574, 1934059616,
       3316900226, 2005384899, 2504158811, 2312572491,  640958613,
       2345104434, 2496510808,  481912069,  404106467, 4227590844,
        689530097, 2832910968,  915144652,  593609559, 3986605123,
       1989352728,  312224370, 2867473248, 2678119027, 3246164530,
       1710427937, 1763918927, 3673689752,  857140371,  963306238,
       4274670068, 1127106688,  575295983,  466153587, 1634341898,
       2698688988,  866056144, 3608301083,  985596233, 3795844093,
       1307742565, 3901396223, 2535345197, 2759189037,  352532506,
        437817422, 2796846568, 3444702727, 1675317143, 3603696801,
       1578770366, 1556243754,   72297590,  957576596,  283702049,
       3934145093,  980095365,  225279456, 2089633646, 1772184158,
        121552948, 3155480568, 2056555032,  735016250, 4102584765,
       1300610749, 2294918642, 2413870848, 3717328803, 3513937642,
       2801254756, 1907063077, 1499588209, 3223016600,  741049885,
       3641625815,  102797201, 3229695697, 3039766736,  705639578,
       1853029455, 4190709944, 1468377129, 4095498403, 2255779289,
       1485317361,  111592938, 3001588110, 3479073425, 1597525508,
       2197285563, 1537961654, 1197053220, 2228389801, 1227055567,
       1536003745, 3957708417, 2980707434, 3956642370, 2999918646,
        739923216, 3621193265, 1407890624, 3339817202, 3902078820,
       3765604046,  656053335, 2973656240,  348381046, 1591987867,
       2136310868, 3118451664, 3446084768, 1272580609, 4232629322,
       4149319845, 1923926481,  273589609,  479547115, 3222698675,
       2334036699, 3610163719, 1771239059, 3144619313,   74590940,
       1134740729, 2536694475, 4008148195, 4098700025,  103036193,
       3022152817, 3733328486,  188023662,  406022798, 3998036656,
       2018443657, 4149552600, 2849767336, 2696302656,  131784563,
       4248364229, 4069625222,  144353964, 3821921136, 4169729151,
       1748914167, 3533083317, 1421147317, 1486062776,  325636484,
        892973074, 2554661048, 3041605873, 3234383801, 1145108420,
       3754920940, 2806031515, 3813170692, 1249315536, 3460785197,
       2363377116,  180242891,  960188746, 2337783159,  741744257,
        318356425, 2313797795, 1177429582, 2041246249,  746216837,
       3002663646,  576421820,  670637756,  274460324,  547420653,
       1361993669, 2796366573, 2457234687, 4254856123, 1029566525,
       3494891613,  393887698, 1630151638, 1057812785,  736768688,
       1414155892, 3207328425, 2040383441,  667208071, 2747491442,
        591956951, 1683234401, 3239430767, 3854843295, 2183531464,
       3293944038,  290373111, 3761990618,  110373148, 3834506030,
       3123331393, 1466293623,  977398162,  403509864,   42089346,
       3503473967,  619312721,  996457965, 4178300053, 3949073220,
       3641715299, 1329265298, 1545159664, 2852838576, 1241135051,
       1878850425, 2692452718, 3705082624,  171038247, 1571580676,
        191284080, 2658851873, 2605742487, 3377686366, 2930788555,
         58897413,  991933079, 2486111341, 2568297687, 1981438997,
       1545218846,  519431253, 2001058523,  764145288, 2686721012,
       4284636506, 3664869653,  173861232, 2816553015,  840681333,
       3755610997, 2842340866, 1374878961,   24169120, 1406860117,
       3167533273,   27383216, 3094724446, 1436210082,  881844747,
       2753327055, 3131148913,  862708878, 2231306127, 1413626143,
       4139361618, 4086095665, 2798362083,  108375930, 1533227596,
       2075790588, 3978394536,  792247437, 3094797686, 2298963869,
        600592304, 3508173784, 1171572676, 2064552195, 3452760154,
       2636567932,  602832972, 3081147164, 3191359730,  138268232,
       1071014707, 1665442246, 4208309458, 1215284043, 3689236487,
       3695927430,  584061785, 1620664925,  323871346,  759781388,
       3107848658, 1462020763,  834521682, 1521061160, 2232444707,
       1052267727, 4276695697, 3609736206,   26110235, 1194271036,
        830502465, 4055452663,   74709606, 1066261653, 1047211419,
       3182559572, 4108885525, 2007234655, 2380075990,  641336473,
       2010585306,   96909515, 3738486010, 1415822202,  808190074,
       3095498541, 2340697412, 3114361011,  490389395,  411118670,
        933599833, 4164492928, 3018875858, 3459391262,  745575387,
       3759398533,  165439819, 1615815076, 3908998348, 1378702049,
        927880261, 1984224473,  960556950, 3650328935, 3672689912,
       3220005921, 2137134837,  277202640, 2240436281,  708792147,
         60232877, 2088528870,  816054519, 1315298855, 2278129882,
        895163321,  279367659, 2582617778, 2705928976, 2339057231,
       3384232069, 1160225878,  949610408, 1956463840, 3803516980,
       3750014304, 2950864039, 1974286934, 1527564572, 2899653181,
       3283129290, 3059536573, 2704920271, 2602652152, 4053667777,
       1350564285, 3214825439, 1096250819, 1430406382, 3298240783,
       2368952454, 3318937682, 2905063723, 1454504198, 3909696181,
        449577224, 1679129839, 1459280639, 3107193344, 1034407861,
       2360265054, 1389052401, 2094880719, 1455732358, 2160635778,
       3508718258, 2295316986,  475127719, 1402819396, 2201344052,
       3040305678, 3157718118, 2477292798, 1741691468, 2915708444,
         31311490, 2605055561, 4051987679, 1634579133, 3571987412,
        643610567, 2704535028, 2252963416, 2497078347, 1093364183,
          6388642, 1744393497,  380246936, 2605312697, 4228860901,
       2733125184,  217020077, 3518475804, 1691423502, 1901604806,
       1491800741, 2777641193, 3604248986, 3136122717, 1367383236,
       2755318167, 3184466724, 3337929976,  576245389, 1168610900,
        521967287, 1017410277, 2783571383, 3958982793, 1919944416,
       1353080893, 1411874854, 3771041199, 2426223683, 3369755398,
       3080244734, 3052095506, 1528009939, 3908511178, 1496123442,
       2789191352, 1036139542,  579003689, 4105453282,  279276505,
       2367890557, 1878679724, 1146823497, 1188018747,  891084208,
       1930756143, 2234016045,  128229426, 2715133263, 1960635556,
       3773594758, 2106356715, 2795733498, 1409323102, 4124498824,
       2394875307,  684976393,  215356783, 1680318379, 2699262883,
        389921710, 1069052562,  546562585, 2338724445],

dtype=uint32), 365, 0, 0.0))

#+END_EXAMPLE

The samples can be accessed using the EnsembleSampler.get_chain()
method. This will return an array with the shape (10000, 32, 5) giving
the parameter values for each walker at each step in the chain. Take
note of that shape and make sure that you know where each of those
numbers come from.
You can make histograms of these samples to get an estimate of the density that you were sampling:

#+BEGIN_EXAMPLE
import matplotlib.pyplot as plt

samples = sampler.get_chain(flat=True)
plt.hist(samples[:, 0], 100, color="k", histtype="step")
plt.xlabel(r"$\theta_1$")
plt.ylabel(r"$p(\theta_1)$")
plt.gca().set_yticks([]);
plt.show()
#+END_EXAMPLE

Another good test of whether or not the sampling went well is to check
the mean acceptance fraction of the ensemble using the
EnsembleSampler.acceptance_fraction() property:

#+BEGIN_EXAMPLE
print("Mean acceptance fraction: {0:.3f}".format(np.mean(sampler.acceptance_fraction)))


print(
    "Mean autocorrelation time: {0:.3f} steps".format(
        np.mean(sampler.get_autocorr_time())
    )
)
#+END_EXAMPLE

#+BEGIN_EXAMPLE
Mean acceptance fraction: 0.714
Mean autocorrelation time: 29.976 steps
#+END_EXAMPLE

*** 1H0707-495 Posterior density for BH Mass for COMBINED and SINGLE Obsevarions

PATH = =/home/steff075/phd_ecm/results-for-all/emcee/testing-1h0707-mass.py=

Importing
=/home/steff075/phd_ecm/results-for-all/emcee/1H0707-495_Variable_Mass_Mean.csv=

#+BEGIN_EXAMPLE
import numpy as np
import matplotlib.pyplot as plt

#plt.style.use('classic')
#plt.rcParams['font.family] = 'serif'

#Import data
data = np.loadtxt('1H0707-495_Variable_Mass_Mean.csv', delimiter=',', skiprows=1)

chi = data[:,0] # Define the chi^2 array
mass = data[:,1] # Define the mass array
#chi_mass = np.stack((data_chi, data_mass)) # Define the 2-d array

ndim = 21 # define number of dimensions of the data

cov = 0.5 - np.random.rand(ndim ** 2).reshape((ndim, ndim))
cov = np.triu(cov)
cov += cov.T - np.diag(cov.diagonal())
cov = np.dot(cov, cov)

nwalkers = 100

# Guess sarting point for each of the 100 walkers.
p0 = np.random.rand(nwalkers, ndim)

# Define function that returns the density p(x⃗ ) for specific values of x⃗ , μ⃗  and Σ−1. In fact, emcee actually requires the logarithm of p.

def log_prob(x, mu, cov):
    diff = x - mu
    return -0.5 * np.dot(diff, np.linalg.solve(cov, diff))

# Import EMCEE and define the Ensembler
import emcee
sampler = emcee.EnsembleSampler(nwalkers, ndim, log_prob, args=[mass, cov])

# Define the probability function (log_prob) for this data
log_prob(p0[0], mass, cov)

def log_prob(x, mu, cov):
    diff = x - mu
    return -0.5 * np.dot(diff, np.linalg.solve(cov, diff))

# Import EMCEE and define the Ensembler
import emcee
sampler = emcee.EnsembleSampler(nwalkers, ndim, log_prob, args=[mass, cov])

# Define the probability function (log_prob) for this data
log_prob(p0[0], mass, cov)


# Setup some initial 'burn- in' steps for the MCMC chain to allow walkers to explore parameter space to settle into the maximum of the density
state = sampler.run_mcmc(p0, 100) # Save the final position of the walkers after N steps as 'state'

sampler.reset() # Reset the sampler before running MCMC

sampler.run_mcmc(state, 50000); # Run MCMC for N steps starting at the final 'burn-in' locations

samples = sampler.get_chain(flat=True)
plt.hist(samples[:, 0], 100, color="k", histtype="step")
plt.xlabel(r"$M_{BH}~logM_{\odot}$")
plt.ylabel(r"Posterior Density")
plt.gca().set_yticks([]);
#plt.show()
#plt.savefig('1H0707-chi-mass-density-histogram.png')

print("Mean acceptance fraction: {0:.3f}".format(np.mean(sampler.acceptance_fraction)))

print("Mean autocorrelation time: {0:.3f} steps".format(np.mean(sampler.get_autocorr_time())))
#+END_EXAMPLE

Results

#+BEGIN_EXAMPLE
Mean acceptance fraction: 0.292

Mean autocorrelation time: 332.169 steps
#+END_EXAMPLE


#+ATTR_HTML: :width 600
#+CAPTION: 1H0707-495 Mass posterior density
http://www.star.bris.ac.uk/steff/ecm/1H0707-chi-mass-density-histogram.png

*** 1H0707-495 Posterior density for BH Mass for COMBINED obsevarions only

PATH =
=/home/steff075/phd_ecm/results-for-all/emcee/testing-1h0707-mass.py=

Importing =/home/steff075/phd_ecm/results-for-all/emcee/1H0707-495_Mass_combined.csv=

Results where, ndim = 6, nwalkers = 100, burn-in = 100 and run = 50000

#+BEGIN_EXAMPLE
import numpy as np
import matplotlib.pyplot as plt

data = np.loadtxt('1H0707-495_Mass_combined.csv', delimiter=',', skiprows=1)
mass = data[:,1]

ndim = 6 # define number of dimensions of the data

cov = 0.5 - np.random.rand(ndim ** 2).reshape((ndim, ndim))
cov = np.triu(cov)
cov += cov.T - np.diag(cov.diagonal())
cov = np.dot(cov, cov)

nwalkers = 100

p0 = np.random.rand(nwalkers, ndim)

def log_prob(x, mu, cov):
    diff = x - mu
    return -0.5 * np.dot(diff, np.linalg.solve(cov, diff))

import emcee
sampler = emcee.EnsembleSampler(nwalkers, ndim, log_prob, args=[mass, cov])

log_prob(p0[0], mass, cov)
print("log_prob: {0:.3f}".format(log_prob(p0[0], mass, cov)))

print("Running burn-in...")
state = sampler.run_mcmc(p0, 100)
sampler.reset()

print("Running MCMC chain...")
sampler.run_mcmc(state, 50000);

print("Mean acceptance fraction: {0:.3f}".format(np.mean(sampler.acceptance_fraction)))
print("Mean autocorrelation time: {0:.3f} steps".format(np.mean(sampler.get_autocorr_time())))

samples = sampler.get_chain(flat=True)
plt.hist(samples[:, 0], 100, color="k", histtype="step")
plt.xlabel(r"$M_{BH}~logM_{\odot}$")
plt.ylabel(r"Posterior Density")
plt.gca().set_yticks([]);
plt.show(block=False)
plt.savefig('1H0707-combined-obs-mass-density-histogram.png')

......................................................................
Results:

log_prob: -3296.827

Mean acceptance fraction: 0.516

Mean autocorrelation time: 67.346 steps

#+END_EXAMPLE

#+ATTR_HTML: :width 600
#+CAPTION: 1H0707-495 Mass posterior density (combined observations only)
http://www.star.bris.ac.uk/steff/ecm/1H0707-combined-obs-mass-density-histogram.png

*** 1H0707-495 Posterior density for BH Mass for SINGLE obsevarions only

PATH =
=/home/steff075/phd_ecm/results-for-all/emcee/testing-1h0707-mass.py=

Importing =/home/steff075/phd_ecm/results-for-all/emcee/1H0707-495_Mass_single_obs.csv=

Results where, ndim = 15, nwalkers = 100, burn-in = 100 and run = 50000

#+BEGIN_EXAMPLE

Mean acceptance fraction: 0.345

Mean autocorrelation time: 192.934steps

Mass mean: 6.181

Mass sigma: 0.154

#+END_EXAMPLE


#+ATTR_HTML: :width 600
#+CAPTION: 1H0707-495 Mass posterior density (single observations only)
http://www.star.bris.ac.uk/steff/ecm/1H0707-single-obs-mass-density-histogram.png

** Fitting a model to data (an example)

Reference:  https://emcee.readthedocs.io/en/stable/tutorials/line/

*The generative probabilistic model*

When you approach a new problem, the first step is generally to write
down the likelihood function (the probability of a dataset given the
model parameters). This is equivalent to describing the generative
procedure for the data.
In this case, we’re going to consider a linear model where the quoted
uncertainties are underestimated by a constant fractional amount.
You can generate a synthetic dataset from this model:

#+BEGIN_EXAMPLE
import numpy as np
import matplotlib.pyplot as plt

np.random.seed(123)

# Choose the "true" parameters.
m_true = -0.9594
b_true = 4.294
f_true = 0.534

# Generate some synthetic data from the model.
N = 50
x = np.sort(10 * np.random.rand(N))
yerr = 0.1 + 0.5 * np.random.rand(N)
y = m_true * x + b_true
y += np.abs(f_true * y) * np.random.randn(N)
y += yerr * np.random.randn(N)

plt.errorbar(x, y, yerr=yerr, fmt=".k", capsize=0)
x0 = np.linspace(0, 10, 500)
plt.plot(x0, m_true * x0 + b_true, "k", alpha=0.3, lw=3)
plt.xlim(0, 10)
plt.xlabel("x")
plt.ylabel("y");
#+END_EXAMPLE

Where:

#+BEGIN_EXAMPLE
>>> m_true
-0.9594

>>> b_true
4.294

>>> f_true
0.534

>>> x
array([0.59677897, 0.9210494 , 1.15618395, 1.75451756, 1.8249173 ,
       2.26851454, 2.28263231, 2.50455365, 2.86139335, 2.93714046,
       3.12261223, 3.17285482, 3.22958914, 3.43178016, 3.61788656,
       3.92117518, 3.98044255, 4.14826212, 4.2310646 , 4.2583029 ,
       4.26351307, 4.30862763, 4.33701173, 4.38572245, 4.80931901,
       4.83034264, 4.93685098, 5.01836676, 5.19485119, 5.31551374,
       5.31827587, 5.51314769, 6.11023511, 6.12894526, 6.23952952,
       6.30976124, 6.34400959, 6.84829739, 6.96469186, 7.1946897 ,
       7.22443383, 7.24455325, 7.29049707, 7.37995406, 8.49431794,
       8.66309158, 8.93389163, 9.44160018, 9.80764198, 9.85559786])
>>> yerr
array([0.16031433, 0.5131704 , 0.40153006, 0.372534  , 0.27138192,
       0.25206039, 0.30851111, 0.44065038, 0.53772842, 0.35521117,
       0.43465689, 0.39296828, 0.41245175, 0.43734453, 0.52117122,
       0.14159749, 0.48184142, 0.22183319, 0.19711148, 0.38622848,
       0.14785626, 0.54266341, 0.41362449, 0.46170818, 0.1080646 ,
       0.39721594, 0.3783926 , 0.17947982, 0.17653526, 0.44776476,
       0.25938321, 0.44598515, 0.37719162, 0.29447529, 0.56256624,
       0.520835  , 0.27869878, 0.12179573, 0.25238404, 0.29909284,
       0.45247942, 0.59767924, 0.27795743, 0.48127391, 0.39658846,
       0.4458509 , 0.17556373, 0.29943815, 0.22042795, 0.27172801])
>>> y
array([ 8.11257148,  3.52815075,  4.81023356,  0.89238164,  3.13295195,
        3.53338034,  1.89933975,  2.83896349,  0.89713921,  0.9500022 ,
        1.45700044,  1.05318568,  1.71011605,  0.06780647,  0.40019114,
        1.00444563, -0.02239716,  0.35714018,  0.36639252, -0.20377166,
        0.4535501 , -0.05481938,  0.11108328,  0.05408497, -0.4312348 ,
        0.03066613,  0.04872262, -0.60437665, -0.92605578, -1.43906426,
        0.05799768, -2.19399769, -2.19477287, -2.07585727, -1.99984962,
       -1.01857516, -0.14032142, -2.42545494, -1.27448771, -2.09526812,
       -2.14633492, -3.37270574, -4.11273068, -3.72061886, -4.85942793,
       -3.4872956 , -2.6354799 , -4.70700707, -6.73600298, -0.44957541])

#+END_EXAMPLE

#+ATTR_HTML: :width 600
https://emcee.readthedocs.io/en/stable/_images/line_4_0.png

The true model is shown as the thick grey line and the effect of the
underestimated uncertainties is obvious when you look at this figure.
The standard way to fit a line to these data (assuming independent
Gaussian error bars) is linear least squares.
Linear least squares is appealing because solving for the
parametersand their associated uncertaintiesis simply a linear algebraic operation.
Following the notation in Hogg, Bovy & Lang (2010), the linear least
squares solution to these data is:

#+BEGIN_EXAMPLE
A = np.vander(x, 2)
C = np.diag(yerr * yerr)
ATA = np.dot(A.T, A / (yerr ** 2)[:, None])
cov = np.linalg.inv(ATA)
w = np.linalg.solve(ATA, np.dot(A.T, y / yerr ** 2))
print("Least-squares estimates:")
print("m = {0:.3f} ± {1:.3f}".format(w[0], np.sqrt(cov[0, 0])))
print("b = {0:.3f} ± {1:.3f}".format(w[1], np.sqrt(cov[1, 1])))

plt.errorbar(x, y, yerr=yerr, fmt=".k", capsize=0)
plt.plot(x0, m_true * x0 + b_true, "k", alpha=0.3, lw=3, label="truth")
plt.plot(x0, np.dot(np.vander(x0, 2), w), "--k", label="LS")
plt.legend(fontsize=14)
plt.xlim(0, 10)
plt.xlabel("x")
plt.ylabel("y");
#+END_EXAMPLE

#+BEGIN_EXAMPLE
Least-squares estimates:
m = -1.104 ± 0.016
b = 5.441 ± 0.091
#+END_EXAMPLE

#+ATTR_HTML: :width 600
https://emcee.readthedocs.io/en/stable/_images/line_6_1.png

This figure shows the least-squares estimate of the line parameters as
a dashed line. This isn’t an unreasonable result but the uncertainties
on the slope and intercept seem a little small (because of the small
error bars on most of the data points).

Where:

#+BEGIN_EXAMPLE
>>> A = np.vander(x, 2)
>>> A
array([[0.59677897, 1.        ],
       [0.9210494 , 1.        ],
       [1.15618395, 1.        ],
       [1.75451756, 1.        ],
       [1.8249173 , 1.        ],
       [2.26851454, 1.        ],
       [2.28263231, 1.        ],
       [2.50455365, 1.        ],
       [2.86139335, 1.        ],
       [2.93714046, 1.        ],
       [3.12261223, 1.        ],
       [3.17285482, 1.        ],
       [3.22958914, 1.        ],
       [3.43178016, 1.        ],
       [3.61788656, 1.        ],
       [3.92117518, 1.        ],
       [3.98044255, 1.        ],
       [4.14826212, 1.        ],
       [4.2310646 , 1.        ],
       [4.2583029 , 1.        ],
       [4.26351307, 1.        ],
       [4.30862763, 1.        ],
       [4.33701173, 1.        ],
       [4.38572245, 1.        ],
       [4.80931901, 1.        ],
       [4.83034264, 1.        ],
       [4.93685098, 1.        ],
       [5.01836676, 1.        ],
       [5.19485119, 1.        ],
       [5.31551374, 1.        ],
       [5.31827587, 1.        ],
       [5.51314769, 1.        ],
       [6.11023511, 1.        ],
       [6.12894526, 1.        ],
       [6.23952952, 1.        ],
       [6.30976124, 1.        ],
       [6.34400959, 1.        ],
       [6.84829739, 1.        ],
       [6.96469186, 1.        ],
       [7.1946897 , 1.        ],
       [7.22443383, 1.        ],
       [7.24455325, 1.        ],
       [7.29049707, 1.        ],
       [7.37995406, 1.        ],
       [8.49431794, 1.        ],
       [8.66309158, 1.        ],
       [8.93389163, 1.        ],
       [9.44160018, 1.        ],
       [9.80764198, 1.        ],
       [9.85559786, 1.        ]])


>>> C = np.diag(yerr * yerr)
>>> C
array([[0.02570069, 0.        , 0.        , ..., 0.        , 0.        ,
        0.        ],
       [0.        , 0.26334386, 0.        , ..., 0.        , 0.        ,
        0.        ],
       [0.        , 0.        , 0.16122639, ..., 0.        , 0.        ,
        0.        ],
       ...,
       [0.        , 0.        , 0.        , ..., 0.0896632 , 0.        ,
        0.        ],
       [0.        , 0.        , 0.        , ..., 0.        , 0.04858848,
        0.        ],
       [0.        , 0.        , 0.        , ..., 0.        , 0.        ,
        0.07383611]])

>>> ATA = np.dot(A.T, A / (yerr ** 2)[:, None])


Where


>>> A.T, A =

(array([[0.59677897, 0.9210494 , 1.15618395, 1.75451756, 1.8249173 ,
        2.26851454, 2.28263231, 2.50455365, 2.86139335, 2.93714046,
        3.12261223, 3.17285482, 3.22958914, 3.43178016, 3.61788656,
        3.92117518, 3.98044255, 4.14826212, 4.2310646 , 4.2583029 ,
        4.26351307, 4.30862763, 4.33701173, 4.38572245, 4.80931901,
        4.83034264, 4.93685098, 5.01836676, 5.19485119, 5.31551374,
        5.31827587, 5.51314769, 6.11023511, 6.12894526, 6.23952952,
        6.30976124, 6.34400959, 6.84829739, 6.96469186, 7.1946897 ,
        7.22443383, 7.24455325, 7.29049707, 7.37995406, 8.49431794,
        8.66309158, 8.93389163, 9.44160018, 9.80764198, 9.85559786],
       [1.        , 1.        , 1.        , 1.        , 1.        ,
        1.        , 1.        , 1.        , 1.        , 1.        ,
        1.        , 1.        , 1.        , 1.        , 1.        ,
        1.        , 1.        , 1.        , 1.        , 1.        ,
        1.        , 1.        , 1.        , 1.        , 1.        ,
        1.        , 1.        , 1.        , 1.        , 1.        ,
        1.        , 1.        , 1.        , 1.        , 1.        ,
        1.        , 1.        , 1.        , 1.        , 1.        ,
        1.        , 1.        , 1.        , 1.        , 1.        ,
        1.        , 1.        , 1.        , 1.        , 1.        ]]), array([[0.59677897, 1.        ],
       [0.9210494 , 1.        ],
       [1.15618395, 1.        ],
       [1.75451756, 1.        ],
       [1.8249173 , 1.        ],
       [2.26851454, 1.        ],
       [2.28263231, 1.        ],
       [2.50455365, 1.        ],
       [2.86139335, 1.        ],
       [2.93714046, 1.        ],
       [3.12261223, 1.        ],
       [3.17285482, 1.        ],
       [3.22958914, 1.        ],
       [3.43178016, 1.        ],
       [3.61788656, 1.        ],
       [3.92117518, 1.        ],
       [3.98044255, 1.        ],
       [4.14826212, 1.        ],
       [4.2310646 , 1.        ],
       [4.2583029 , 1.        ],
       [4.26351307, 1.        ],
       [4.30862763, 1.        ],
       [4.33701173, 1.        ],
       [4.38572245, 1.        ],
       [4.80931901, 1.        ],
       [4.83034264, 1.        ],
       [4.93685098, 1.        ],
       [5.01836676, 1.        ],
       [5.19485119, 1.        ],
       [5.31551374, 1.        ],
       [5.31827587, 1.        ],
       [5.51314769, 1.        ],
       [6.11023511, 1.        ],
       [6.12894526, 1.        ],
       [6.23952952, 1.        ],
       [6.30976124, 1.        ],
       [6.34400959, 1.        ],
       [6.84829739, 1.        ],
       [6.96469186, 1.        ],
       [7.1946897 , 1.        ],
       [7.22443383, 1.        ],
       [7.24455325, 1.        ],
       [7.29049707, 1.        ],
       [7.37995406, 1.        ],
       [8.49431794, 1.        ],
       [8.66309158, 1.        ],
       [8.93389163, 1.        ],
       [9.44160018, 1.        ],
       [9.80764198, 1.        ],
       [9.85559786, 1.        ]]))

And where

>>> yerr ** 2
array([0.02570069, 0.26334386, 0.16122639, 0.13878158, 0.07364814,
       0.06353444, 0.0951791 , 0.19417276, 0.28915185, 0.12617497,
       0.18892661, 0.15442407, 0.17011645, 0.19127023, 0.27161944,
       0.02004985, 0.23217115, 0.04920996, 0.03885294, 0.14917244,
       0.02186147, 0.29448358, 0.17108522, 0.21317444, 0.01167796,
       0.1577805 , 0.14318096, 0.03221301, 0.0311647 , 0.20049328,
       0.06727965, 0.19890275, 0.14227352, 0.08671569, 0.31648078,
       0.2712691 , 0.07767301, 0.0148342 , 0.0636977 , 0.08945653,
       0.20473762, 0.35722048, 0.07726033, 0.23162457, 0.15728241,
       0.19878302, 0.03082262, 0.0896632 , 0.04858848, 0.07383611])


>>> ATA
array([[23193.14441228,  3786.66394009],
       [ 3786.66394009,   739.23759899]])

>>> cov = np.linalg.inv(ATA)
>>> cov
array([[ 0.00026341, -0.00134929],
       [-0.00134929,  0.00826432]])


>>> w = np.linalg.solve(ATA, np.dot(A.T, y / yerr ** 2))
>>> w
array([-1.1040757 ,  5.44055525])

#+END_EXAMPLE

*Maximum likelihood estimation*

The least squares solution found in the previous section is the
maximum likelihood result for a model where the error bars are assumed
correct, Gaussian and independent. We know, of course, that this isn’t
the right model. Unfortunately, there isn’t a generalization of least
squares that supports a model like the one that we know to be
true. Instead, we need to write down the likelihood function and
numerically optimize it.
In mathematical notation, the correct likelihood function is:

$ln~p(y|x,σ,m,b,f)=~ − 0.5∑_n[(y_n − mx_n − b)^2 + ln(2π s^{2}_{n})]$


where $s^{2}_{n} = σ^{2}_{n} + f^2(mx_n + b)^2$


This likelihood function is simply a Gaussian where the variance is
underestimated by some fractional amount: f.
In Python, you would code this up as:


#+BEGIN_EXAMPLE
def log_likelihood(theta, x, y, yerr):
    m, b, log_f = theta
    model = m * x + b
    sigma2 = yerr ** 2 + model ** 2 * np.exp(2 * log_f)
    return -0.5 * np.sum((y - model) ** 2 / sigma2 + np.log(sigma2))
#+END_EXAMPLE

In this code snippet, you’ll notice that we’re using the logarithm of
f instead of f itself  or reasons that will become clear in the next
section.
For now, it should at least be clear that this isn’t a bad idea
because it will force f to be always positive. A good way of finding
this numerical optimum of this likelihood function is to use the
scipy.optimize module:

#+BEGIN_EXAMPLE
from scipy.optimize import minimize

np.random.seed(42)
nll = lambda *args: -log_likelihood(*args)
initial = np.array([m_true, b_true, np.log(f_true)]) + 0.1 * np.random.randn(3)
soln = minimize(nll, initial, args=(x, y, yerr))
m_ml, b_ml, log_f_ml = soln.x

print("Maximum likelihood estimates:")
print("m = {0:.3f}".format(m_ml))
print("b = {0:.3f}".format(b_ml))
print("f = {0:.3f}".format(np.exp(log_f_ml)))

plt.errorbar(x, y, yerr=yerr, fmt=".k", capsize=0)
plt.plot(x0, m_true * x0 + b_true, "k", alpha=0.3, lw=3, label="truth")
plt.plot(x0, np.dot(np.vander(x0, 2), w), "--k", label="LS")
plt.plot(x0, np.dot(np.vander(x0, 2), [m_ml, b_ml]), ":k", label="ML")
plt.legend(fontsize=14)
plt.xlim(0, 10)
plt.xlabel("x")
plt.ylabel("y");
#+END_EXAMPLE

#+BEGIN_EXAMPLE
Maximum likelihood estimates:
m = -1.003
b = 4.528
f = 0.454
#+END_EXAMPLE

where:

#+BEGIN_EXAMPLE
>>> nll
<function <lambda> at 0x7f8267416dd0>

>>> initial
array([-0.90972858,  4.28017357, -0.56259059])

>>> soln
      fun: 12.182413948015416
 hess_inv: array([[ 0.00636184, -0.02884087,  0.00553107],
       [-0.02884087,  0.13384937, -0.02526752],
       [ 0.00553107, -0.02526752,  0.02125439]])
      jac: array([-3.38554382e-05, -1.38282776e-05,  3.57627869e-06])
  message: 'Desired error not necessarily achieved due to precision loss.'
     nfev: 81
      nit: 8
     njev: 16
   status: 2
  success: False
        x: array([-1.00300852,  4.52831431, -0.79044034])

>>> soln.x
array([-1.00300852,  4.52831431, -0.79044034])

#+END_EXAMPLE

#+ATTR_HTML: :width 600
https://emcee.readthedocs.io/en/stable/_images/line_11_1.png

It’s worth noting that the optimize module minimizes functions whereas
we would like to maximize the likelihood. This goal is equivalent to
minimizing the negative likelihood (or in this case, the negative log
likelihood).

In this figure, the maximum likelihood (ML) result is plotted as a
dotted black line compared to the true model (grey line) and linear
least-squares (LS; dashed line). That looks better!

The problem now: how do we estimate the uncertainties on m and b?
What’s more, we probably don’t really care too much about the value of f but it seems worthwhile to propagate any uncertainties about its
value to our final estimates of m and b. This is where MCMC comes in.

** Real data EMCEE example

Ref: http://mattpitkin.github.io/samplers-demo/pages/emcee/

PATH = =/home/steff075/phd_ecm/results-for-all/emcee/real-data-example.py=

#+BEGIN_EXAMPLE
from __future__ import print_function, division
import matplotlib.pyplot as plt
import os
import sys
import numpy as np
import emcee

# import model and data

# set the true values of the model parameters for creating the data
m = 3.5 # gradient of the line
c = 1.2 # y-intercept of the line

# set the "predictor variable"/abscissa
M = 100
xmin = 0.
xmax = 10.
stepsize = (xmax-xmin)/M
x = np.arange(xmin, xmax, stepsize)

# define the model function
def straight_line(x, m, c):
    """
    A straight line model: y = m*x + c

    Args:
        x (list): a set of abscissa points at which the model is defined
        m (float): the gradient of the line
        c (float): the y-intercept of the line
    """

    return m*x + c

# create the data - the model plus Gaussian noise
sigma = 0.5 # standard deviation of the noise
data = straight_line(x, m, c) + sigma*np.random.randn(M)
plt.plot(data, "k", alpha=0.3, lw=3)
plt.show(block=False)
#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/emcee-real-example-1.png

#+BEGIN_EXAMPLE
def logposterior(theta, data, sigma, x):
    """
    The natural logarithm of the joint posterior.

    Args:
        theta (tuple): a sample containing individual parameter values
        data (list): the set of data/observations
        sigma (float): the standard deviation of the data points
        x (list): the abscissa values at which the data/model is defined
    """

    lp = logprior(theta) # get the prior

    # if the prior is not finite return a probability of zero (log probability of -inf)
    if not np.isfinite(lp):
        return -np.inf

    # return the likeihood times the prior (log likelihood plus the log prior)
    return lp + loglikelihood(theta, data, sigma, x)


def loglikelihood(theta, data, sigma, x):
    """
    The natural logarithm of the joint likelihood.

    Args:
        theta (tuple): a sample containing individual parameter values
        data (list): the set of data/observations
        sigma (float): the standard deviation of the data points
        x (list): the abscissa values at which the data/model is defined

    Note:
        We do not include the normalisation constants (as discussed above).
    """

    # unpack the model parameters from the tuple
    m, c = theta

    # evaluate the model (assumes that the straight_line model is defined as above)
    md = straight_line(x, m, c)

    # return the log likelihood
    return -0.5*np.sum(((md - data)/sigma)**2)


def logprior(theta):
    """
    The natural logarithm of the prior probability.

    Args:
        theta (tuple): a sample containing individual parameter values

    Note:
        We can ignore the normalisations of the prior here.
    """

    lp = 0.

    # unpack the model parameters from the tuple
    m, c = theta

    # uniform prior on c
    cmin = -10. # lower range of prior
    cmax = 10.  # upper range of prior

    # set prior to 1 (log prior to 0) if in the range and zero (-inf) outside the range
    lp = 0. if cmin < c < cmax else -np.inf

    # Gaussian prior on m
    mmu = 0.     # mean of the Gaussian prior
    msigma = 10. # standard deviation of the Gaussian prior
    lp -= 0.5*((m - mmu)/msigma)**2

    return lp


Nens = 100   # number of ensemble points

mmu = 0.     # mean of the Gaussian prior
msigma = 10. # standard deviation of the Gaussian prior

mini = np.random.normal(mmu, msigma, Nens) # initial m points

cmin = -10.  # lower range of prior
cmax = 10.   # upper range of prior

cini = np.random.uniform(cmin, cmax, Nens) # initial c points

inisamples = np.array([mini, cini]).T # initial samples

ndims = inisamples.shape[1] # number of parameters/dimensions

Nburnin = 500   # number of burn-in samples
Nsamples = 500  # number of final posterior samples

# set additional args for the posterior (the data, the noise std. dev., and the abscissa)
argslist = (data, sigma, x)

# set up the sampler
sampler = emcee.EnsembleSampler(Nens, ndims, logposterior, args=argslist)

# pass the initial samples and total number of samples required
sampler.run_mcmc(inisamples, Nsamples+Nburnin);

# extract the samples (removing the burn-in)
postsamples = sampler.chain[:, Nburnin:, :].reshape((-1, ndims))

# plot posterior samples (if corner.py is installed)
try:
    import matplotlib as mpl
    mpl.use("Agg") # force Matplotlib backend to Agg
    import corner # import corner.py
except ImportError:
    sys.exit(1)

print('Number of posterior samples is {}'.format(postsamples.shape[0]))

fig = corner.corner(postsamples, labels=[r"$m$", r"$c$"], truths=[m, c])
fig.savefig('emcee-real-example-2.png')
#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/emcee-real-example-2.

* Typhon for local analysis

** General

All data produced on BlueCrystal can now be backed up on
=/data/typhon1= for local analysis

My PATH = =/data/typhon1/reverb/=

Access typhon
#+BEGIN_EXAMPLE
ssh steff075@typhon.star.bris.ac.uk -XY
#+END_EXAMPLE

For copying over files, e.g:
#+BEGIN_EXAMPLE
scp -r 1H0707-495_results_single_obs.csv steff075@typhon.star.bris.ac.uk:/data/typhon1/reverb/emcee
#+END_EXAMPLE

*Sync lag-files directory*

Sync the lag-files directory from BlueCrystal to Typhon. This will need to be done once any new lag-files have been generated
on BlueCrystal.

/Initiate the following command using "screen"/

#+BEGIN_EXAMPLE
rsync -uav so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/lag-files /data/typhon1/reverb/
#+END_EXAMPLE

*Copy in new directories*

For example, copy  1H0707-495 directory from BC4 --> typhon
#+BEGIN_EXAMPLE
scp -r so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495 .
#+END_EXAMPLE

** Blob code on typhon

Installing cfitsio

#+BEGIN_EXAMPLE
cd /data/typhon1/phajy
scl enable devtoolset-9 bash
wget http://heasarc.gsfc.nasa.gov/FTP/software/fitsio/c/cfitsio-3.49.tar.gz
gunzip cfitsio-3.49.tar.gz
tar xvf cfitsio-3.49.tar
cd cfitsio-3.49
./configure --prefix=/data/typhon1/phajy/local
make
make install
#+END_EXAMPLE


Compliling the blob code

#+BEGIN_EXAMPLE
CC      = gcc
LIBS    = -lOpenCL -lm -lcfitsio
LIBPATH = -L/data/typhon1/phajy/local/lib
INCPATH = -I/data/typhon1/phajy/local/include

Then I use "make blob" to create the blob code.
To run it I had to change my library path (syntax will be different if using tcsh instead of bash):

export LD_LIBRARY_PATH="/data/typhon1/phajy/local/lib/"
#+END_EXAMPLE

Running the code

Use *submit-blob.pl* to run specific values

This places all sunbmit codes into *submit-scripts* directory

each code may be initiated by typing:

#+BEGIN_EXAMPLE
sh submit-scripts/blob-ooo.sh
#+END_EXAMPLE



* New Table Model (Feb 2021)

PATH = =/data/typhon1/reverb/1H0707-495=

** Creating the table model

=table-models.py= = Table model creation script for a given range of parameters

=tab_rev_comb.mod= = First Table model for the 1H0707-495 fmax best fit

Opening in Topcat reveals 3 table components:

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/tab_rev_comb_model_img.PNG


#+ATTR_HTML::width 1100
http://www.star.bris.ac.uk/steff/ecm/tab_rev_table_model_components.PNG

** Testing the table model

Test this model roughly on the 1H0707-495 fmax best fit using:

#+BEGIN_EXAMPLE
gedit ajy.par
#+END_EXAMPLE

#+BEGIN_EXAMPLE
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         2.434824           0         100
  2  lag_freq(1).log_mass   0     0          6.62634           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         19.17844           3          20
  7  lag_freq(1).Gamma1     0     0              2.8         2.4         2.8
  8  lag_freq(1).Gamma2     0     0         2.000011         1.9         2.6
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0                3           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         137.7351         100         400
 15  lag_freq(1).t_shift    0     0         23.80361          10          80
#+END_EXAMPLE

#+BEGIN_EXAMPLE
isis
.source("fit-table-model-comb.sl");

RMF includes the effective area
t_g = 2.084135e+01
 Parameters[Variable] = 15[8]
            Data bins = 7
           Chi-square = 1.765559
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         2.434824           0         100
  2  lag_freq(1).log_mass   0     0          6.62634           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         19.17844           3          20
  7  lag_freq(1).Gamma1     0     0              2.8         2.4         2.8
  8  lag_freq(1).Gamma2     0     0         2.000011         1.9         2.6
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0                3           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         137.7351         100         400
 15  lag_freq(1).t_shift    0     0         23.80361          10          80

calc_flux(1,5e-5,1e-2);
7.732502714800857e-15
0.0009604475829630126


#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_comb_fmax_tm_test1.gif

** Test on 1H0707 combined best fit

Use lager TM =tab_rev_1H0707_all_pars.mod= *This model takes 5 mins
to fit*

Use par file =tm_comb.par=

#+BEGIN_EXAMPLE
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         2.434824           0         100
  2  lag_freq(1).log_mass   0     0          	6.22           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0               20           3          20
  7  lag_freq(1).Gamma1     0     0              2.6         2.2         3.0
  8  lag_freq(1).Gamma2     0     0         	 2.1         1.9         2.6
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0                3           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0                2           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0              250         100         600
 15  lag_freq(1).t_shift    0     0               20          10         100
#+END_EXAMPLE


Results:

#+BEGIN_EXAMPLE
t_g = 8.176848e+00
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 1131.019

isis> list_par;
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         2.434824           0         100
  2  lag_freq(1).log_mass   0     0             6.22           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0               20           3          20
  7  lag_freq(1).Gamma1     0     0              2.6         2.2           3
  8  lag_freq(1).Gamma2     0     0              2.1         1.9         2.6
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0                3           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0                2           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0              250         100         600
 15  lag_freq(1).t_shift    0     0               20          10         100
isis> calc_flux(1,5e-5,1e-2);
t_g = 8.176848e+00
-1.3191675624682851e-12
-0.1638526805132203

#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_comb_fmax_tm_test2.gif

** Plot the best fit lag file

Lets see what this lag file looks like, the best fit lag-file was:

#+BEGIN_EXAMPLE
/data/typhon1/reverb/lag-files/i53/a0.998/h02.0+20.0/g2.6+2.1/A01.0/x3.0/p00.0/b02.0/q0.5/tmax0250/tshift0020/lag.fits
#+END_EXAMPLE

Run the following by copying it into an ISIS initiated terminal

#+BEGIN_EXAMPLE
% Load required data
tm1 = fits_read_table ("/data/typhon1/reverb/lag-files/i53/a0.998/h02.0+20.0/g2.6+2.1/A01.0/x3.0/p00.0/b02.0/q0.5/tmax0250/tshift0020/lag.fits");

% Plot results
open_plot("1H-comb-best-fit-lag-file.gif/gif");
%variable pid = open_plot("lag-files-delta-tshift2.ps/cps");
_pgscf(2); %make font roman
xlog;
ylin;
popt.res = 1;
charsize(1.15);
ylabel("Time Lag (tg)");
xlabel("Frequency (1/tg)");
title("1H0707 Comb best fit (i53, h02.0+20.0, g2.6+2.1, x3, b2, tmax250, tshift20)");
connect_points(1);
plotxy(tm1.fq,tm1.lag;dcol=2,dsym=1, xrange=[5e-5,1.0], yrange=[-40, 40]);
%plotxy(tm2.fq,tm2.lag;dcol=3,dsym=1,oplt=1);

nice_width;
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgsci(1); %line color black
_pgdraw(1,0);
close_plot;
#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H-comb-best-fit-lag-file.gif

/Note: This is exactly identical to the same lag file on BC4/

* *1H0707-495*

** Replot known lag-freq fits

To replot and tweak any good fits use script =ecm-lag-freq-fits.sl=

For example, the best fit found for the 1H0707-495 fully combined observations was 3.06 and the parameter file was =best_fit_02.par=
 that is:

#+BEGIN_EXAMPLE
emacs best_fit_02.par

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.167942e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.111761           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.1           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               75           0           0
#+END_EXAMPLE

So to refit this, I set the parameters in
=replot-best-lag-freq-fits.sl= to the above (lines 236-251) and :

#+BEGIN_EXAMPLE
isis-script replot-best-lag-freq-fits.sl fit plot

% Make a nice ps image of the plot and save as pdf %
pid = open_plot("1H0707-495_comb_ecm.ps/cps");
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
plot_comps({{g}},popt,&plot_data);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgsci(1); % make line colour black
_pgdraw(1,0);
close_plot(pid);
#+END_EXAMPLE

Copy ps to Lyra directory

#+BEGIN_EXAMPLE
scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/1H0707-495_comb_ecm.ps .
ps2pdf 1H0707-495_comb_ecm.ps
#+END_EXAMPLE
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_combined_ecm.png

** *1H0707-495 Initial fits*

Mass is logM 6.31

 c *** Run codes for $i = 53^\circ$

These files have been copied to =/homeb/steff075/phd_ecm/ecm-files=

#+BEGIN_EXAMPLE
For a whole directory:

scp -r so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/code-s-files .

For a single new file:

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/code-s-files/s-x0-h11-a0p998-i58.fits .
#+END_EXAMPLE

Note this was conducted in the *GPU partition of BC4*

Load modules

#+BEGIN_EXAMPLE
module load CUDA
module load cURL
#+END_EXAMPLE

*Run code-img*

#+BEGIN_EXAMPLE
./code-img -i53 -a0.998 -r400 -s8192

Output file = img-files/img-i58-a0p998-r400-8192.fits
2 platforms
Platform 0 has 1 devices
Platform: 0 Device: 0 --- [Tesla P100-PCIE-16GB] [*]
Platform 1 has 1 devices
Platform: 1 Device: 0 --- [Intel(R) Xeon(R) CPU E5-2680 v4 @ 2.40GHz]
Using platform 0 device 0
Tesla P100-PCIE-16GB
About to build...
Reached Kernel execution
Waiting for all kernels to finish
Finished command Queue
#+END_EXAMPLE

All img codes copied to =lyra:/homeb/steff075/phd_ecm/ecm-files/code-img-files=

-----------------------------------------------------------------------------------------------

*Run code-s*

#+BEGIN_EXAMPLE
./code-s -a0.998 -h2.0 -i53 -p1

Output file=code-s-files/s-x0-h2-a0p998-i58.fits
2 platforms
Platform 0 has 1 devices
Platform: 0 Device: 0 --- [Tesla P100-PCIE-16GB] [*]
Platform 1 has 1 devices
Platform: 1 Device: 0 --- [Intel(R) Xeon(R) CPU E5-2680 v4 @ 2.40GHz]
Using platform 0 device 0
Tesla P100-PCIE-16GB
About to build...
Reached Kernel execution
Waiting for all kernels to finish
Finished command Queue
#+END_EXAMPLE

Now set up to run for all other source heights

*Run code-x*

#+BEGIN_EXAMPLE
./submit-code-x.pl
#+END_EXAMPLE

Now you need to note that the code-x files have the following parameters
in the code-x-files directory:

#+BEGIN_EXAMPLE
[so14935@bc4gpulogin1 code-x-files]$ cd i53
[so14935@bc4gpulogin1 i53]$ ls
a0.998
[so14935@bc4gpulogin1 i53]$ cd a0.998
[so14935@bc4gpulogin1 a0.998]$ ls
h01.8  h02.2  h02.6  h03.0  h03.4  h03.8  h04.2  h04.6  h05.0  h07.0  h09.0  h11.0  h13.0  h15.0
h02.0  h02.4  h02.8  h03.2  h03.6  h04.0  h04.4  h04.8  h06.0  h08.0  h10.0  h12.0  h14.0
[so14935@bc4gpulogin1 a0.998]$ cd h02.0
[so14935@bc4gpulogin1 h02.0]$ ls
g1.2  g1.4  g1.6  g1.8  g2.0  g2.2  g2.4  g2.6  g2.8  g3.0  g3.7
g1.3  g1.5  g1.7  g1.9  g2.1  g2.3  g2.5  g2.7  g2.9  g3.1
[so14935@bc4gpulogin1 h02.0]$ cd g1.2
[so14935@bc4gpulogin1 g1.2]$ ls
A1.0
[so14935@bc4gpulogin1 g1.2]$ cd A1.0/
[so14935@bc4gpulogin1 A1.0]$ ls
x0.0  x1.0  x1.5  x2.0  x2.5  x3.0
[so14935@bc4gpulogin1 A1.0]$ cd x0.0/
[so14935@bc4gpulogin1 x0.0]$ ls
p00.0
[so14935@bc4gpulogin1 x0.0]$ cd p00.0/
[so14935@bc4gpulogin1 p00.0]$ ls
rev.fits
[so14935@bc4gpulogin1 p00.0]$
#+END_EXAMPLE


*Run blob.c*

*Important:*
I suspect that the previous blob.c code did not run fully on the 5 hr
allocation time. This was increased to 8 Hrs and then the full BC 4
directory
=/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation= was
copied to:

NEW PATH = =/mnt/storage/scratch/so14935/x-ray-rev3/x-ray-reverberation=

The lag-files directory was deleted and recreated on 21/12/19 and the
blob.c code was then run from fresh with the new allocation time.

Note that one source height change (step) created 2492 submit scripts
at which point I had reached maximium limits.

This process can then be repeated for remaining source heights.

*Also important to note:*
the blob code needs to run for the parameters of the
code-x-files else it will fail to find the appropriate file. I set up
as follows:

#+BEGIN_EXAMPLE
# Parameters for 1H 0707-405
my $epsilon = 0.001;
# First source height ("o")
my $first_source_height_low = 2.0;              # low value
my $first_source_height_high = 5.0;             # high value
my $source_height_delta = 1.0;                  # step size (same for both sources)
# First source height ("d")
my $second_source_height_low = $first_source_height_low + $source_height_delta;
my $second_source_height_high = $first_source_height_high;
# Inclination angle of disk ("i")
my $inclination_low = 53.0;
my $inclination_high = 53.0;
my $inclination_delta = 1.0;
# Photon index of first source ("g")
my $first_source_photon_index_low = 1.2;
my $first_source_photon_index_high = 3.1;
my $first_source_photon_index_delta = 0.1;
# Photon index of second source ("e")
my $second_source_photon_index_low = 1.2;
my $second_source_photon_index_high = 3.1;
my $second_source_photon_index_delta = 0.1;
# Iron abundance ("A")
my $iron_abund_low = 1.0;
my $iron_abund_high = 1.0;
my $iron_abund_delta = 1.0;
# Ionization parameter ("x")
my $xi_low = 0.0;
my $xi_high = 3.0;
my $xi_delta = 1.0;
# Density profile index ("p") - density goes as r^-p
my $density_low = 0.0;
my $density_high = 0.0;
my $density_delta = 0.1;
# We're setting "y" and "l" to 1.0 which are the RRF for sources 1 and 2, respectively
# Brightness parameter is ratio of brightness of 2nd source compared to 1st
my $brightness_low = 1.0;
my $brightness_high = 3.0;
my $brightness_delta = 1.0;
# "q2" (q1 is fixed at 1)
my $q2_low = 0.5;
my $q2_high = 0.5;
my $q2_delta = 0.1;
# "v" is tmax;
my $tmax_low = 100.0;
my $tmax_high = 500.0;
my $tmax_delta = 50.0;
# "q" is the time shift between first and second source
my $tshift_low = 0.0;
my $tshift_high = 100.0;
my $tshift_delta = 5.0;
#+END_EXAMPLE

I set MEM = 3GB and TIME = 8 hrs

This is compuationally intensive!!! Run with:

#+BEGIN_EXAMPLE
./submit-blob.pl
#+END_EXAMPLE

The first  to run was
#+BEGIN_EXAMPLE
 sacct -j 2939483
       JobID    JobName  Partition    Account  AllocCPUS      State ExitCode
------------ ---------- ---------- ---------- ---------- ---------- --------
2939483          reverb     serial    default          1    RUNNING      0:0

This began at 1302 hrs 22 Dec
#+END_EXAMPLE

How does this look when we know its running ok?

#+BEGIN_EXAMPLE
emacs slurm-2939483.out
..
h1=2 h2=3 i=53 g1=1p2 g2=1p6 A=1 x=3 p=0 rs1=1 rs2=1 b=2 w=0p5 v=200 q=60
r1s= 1.000000 r1h=-nan r2s= 1.000000 r2h= 0.191118avg_s= 0.000000 avg_h=0.000000 tg=1.000000
h1=2 h2=3 i=53 g1=1p2 g2=1p6 A=1 x=3 p=0 rs1=1 rs2=1 b=2 w=0p5 v=200 q=65
r1s= 1.000000 r1h=-nan r2s= 1.000000 r2h= 0.191118avg_s= 0.000000 avg_h=0.000000 tg=1.000000
h1=2 h2=3 i=53 g1=1p2 g2=1p6 A=1 x=3 p=0 rs1=1 rs2=1 b=2 w=0p5 v=200 q=70
r1s= 1.000000 r1h=-nan r2s= 1.000000 r2h= 0.191118avg_s= 0.000000 avg_h=0.000000 tg=1.000000
h1=2 h2=3 i=53 g1=1p2 g2=1p6 A=1 x=3 p=0 rs1=1 rs2=1 b=2 w=0p5 v=200 q=75
r1s= 1.000000 r1h=-nan r2s= 1.000000 r2h= 0.191118avg_s= 0.000000 avg_h=0.000000 tg=1.000000
h1=2 h2=3 i=53 g1=1p2 g2=1p6 A=1 x=3 p=0 rs1=1 rs2=1 b=2 w=0p5 v=200 q=80
...up to
h1=2 h2=3 i=53 g1=1p2 g2=1p7 A=1 x=0 p=0 rs1=1 rs2=1 b=2 w=0p5 v=400 q=30
r1s= 1.000000 r1h=-nan r2s= 1.000000 r2h= 0.107190avg_s= 0.000000 avg_h=0.000000 tg=1.000000
h1=2 h2=3 i=53 g1=1p2 g2=1p7 A=1 x=0 p=0 rs1=1 rs2=1 b=2 w=0p5 v=400 q=35
r1s= 1.000000 r1h=-nan r2s= 1.000000 r2h= 0.107190avg_s= 0.000000 avg_h=0.000000 tg=1.000000
slurmstepd: error: *** JOB 2939483 ON compute068 CANCELLED AT 2019-12-22T21:01:06 DUE TO TIME LIMIT ***

Total 1326 lines
#+END_EXAMPLE

Code still timed out - This is the longest running code that could be
parralleized perhaps????

Not there are no errors or statements such as FILE NOT FOUND so all
looks good despite the Timeout on the 8.00 hr limit.
......
Upon checking the other output files that ran here, the total number
of lines was approx 1326 for each run creating around 660 lag files.
I estimate the code will need 11-12 hrs to runn 1000 files and
COMPLETE without TIMEOUT.
......

Next run for H6-8 etc - this will take a few days to complete!!

Now we were ready to fit code =1H0707-lag-freq-fits.sl=

*** Lo-flux

USE

=1H0707-lo-flux-lag-freq-fits.sl=

=1H0707_lo_flux_best_fit.par=

=find-best-fit-1H0707-lo-flux.py=


#+BEGIN_EXAMPLE
sbatch 1H0707-submit-lag-freq.sh
Submitted batch job 2571488

 python find-best-fit-1H0707-lo-flux.py
Best fit is 2.846357 in file 1H0707_lo_flux_best_fit_06.txt

 Best fit:

 Parameters[Variable] = 15[2]
            Data bins = 7
           Chi-square = 2.846356
   Reduced chi-square = 0.5692711
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001217607           0           1
  2  lag_freq(1).log_mass   0     0         6.244645           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0

#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495-lo-flux-ecm.PNG


To replot just this use:

ssh -XY so14935@bc4gpulogin.acrc.bris.ac.uk  --->Ensuring plot dveices will work

=replot_1H0707_best_fit_lo_flux.sl=

=1H0707_best_fit_lo_flux.par=

#+BEGIN_EXAMPLE
isis replot_1H0707_best_fit_lo_flux.sl

 Parameters[Variable] = 15[2]
            Data bins = 7
           Chi-square = 2.846356
   Reduced chi-square = 0.5692711
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001217607           0           1
  2  lag_freq(1).log_mass   0     0         6.244645           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -1.1666e-01     0.001
file:  1H0707-495-time-lag-fits/1H0707-495-time-lags-lo-flux.fits

#+END_EXAMPLE

*Now run with the dummy function:*

Use

=1H0707-lag-freq-fits.sl=

=best_lag_freq_fit.par=

=find-best-1H0707-fit.py=


#+BEGIN_EXAMPLE
Note par file was: ( The mass is fixed !!!!  - may need to tweak this!!!!)

lag_freq(1) + dummy(1)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.869608e-05           0           1
  2  lag_freq(1).log_mass   0     1              6.3           5           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0
#=>  (lag_freq(1).h2-lag_freq(1).h1)*492.6*(10^(lag_freq(1).log_mass-8.0))/dummy(1).a
 16  dummy(1).a             0     1             0.75           0           0


sbatch 1H0707-submit-lag-freq.sh
Submitted batch job 2822456

sacct -j 2822456

python find-best-1H0707-fit.py


Failed: computing derived parameter:   (lag_freq(1).h2-lag_freq(1).h1)*492.6*(10^(lag_freq(1).log_mass-8.0))/dummy(1).a
Failed: computing derived parameter:   (lag_freq(1).h2-lag_freq(1).h1)*492.6*(10^(lag_freq(1).log_mass-8.0))/dummy(1).a
ffopen could not interpret primary array header of file:
/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation//lag-files/i53/a0.99
8/h02.0+03.0/g2.5+2.4/A01.0/x0.0/p00.0/b01.0/q0.5/tmax0190/tshift0098/lag.fits
tried to move past end of file: /mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation//lag-files/i53/a0.998/h02.0+03.0/g2.5+2.4/A01.0/x0.0/p00.0/b01.0/q0.5/tmax0190/tshift0098/lag.fits
/mnt/storage/scratch/so14935/isis/1.6.2/share/fits.sl:123:fits_check_error:Fits Error
Error: function evaluation failed
Traceback: _mode_switch
Traceback: _fit
#+END_EXAMPLE


*Now try the new lag files created 20 Dec*

#+BEGIN_EXAMPLE
sbatch 1H0707-submit-lag-freq.sh
Submitted batch job 2935409

sacct -j 2935409

find-best-1H0707-lo-flux-fit.py




#+END_EXAMPLE







>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

Now fix the Mass to 6.31 in the par file:


#+BEGIN_EXAMPLE
sbatch 1H0707-submit-lag-freq.sh
Submitted batch job 2585168

sacct -j 2585168

python find-best-fit-1H0707-lo-flux.py
Best fit is 5.120575 in file 1H0707_lo_flux_best_fit_01.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001036714           0           1
  2  lag_freq(1).log_mass   0     1             6.31           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              3.1           0           0
  8  lag_freq(1).Gamma2     0     1              2.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              175           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0

python find-best-fit-1H0707-lo-flux.py

>>>>>  make smaller values of t-max and t-shift  > then try again! <<<<<<<<<

sbatch 1H0707-submit-lag-freq.sh
Submitted batch job 2587174

No Improvement found !!


 Parameters[Variable] = 15[1]
            Data bins = 7
           Chi-square = 5.894458
   Reduced chi-square = 0.9824097
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     8.724033e-05           0           1
  2  lag_freq(1).log_mass   0     1             6.31           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              3.1           0           0
  8  lag_freq(1).Gamma2     0     1              2.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              175           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0
#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495-lo-flux-FM-ecm.PNG


Tray again with a fixed Mass where tshift = 0

#+BEGIN_EXAMPLE
sbatch 1H0707-submit-lag-freq.sh
Submitted batch job 2775934

sacct -j 2775934

Script is running but faailing to create the best fit files - this is common now accross 1H0707 for all scripts !!!



Tried to reset back to original scripts but the problem remains !!!!



Try fitting Ark 564 in the meantime/....




>>>>>>>>>>>>>




>>>>>>>>>



>>>>





#+END_EXAMPLE

*** Hi-flux

USE =1H0707-hi-flux-lag-freq-fits.sl=

#+BEGIN_EXAMPLE
sbatch 1H0707-submit-lag-freq.sh
Submitted batch job 2563609

python find-best-fit-1H0707-hi-flux.py
Best fit is 2.787492 in file 1H0707_hi_flux_best_fit_20.txt

 emacs replot-best-lag-freq-fits.sl

RMF includes the effective area
 Parameters[Variable] = 15[2]
            Data bins = 7
           Chi-square = 2.787492
   Reduced chi-square = 0.5574983
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.397242e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.052904           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              550           0           0
 15  lag_freq(1).t_shift    0     1               85           0           0

#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495-hi-flux-ecm.PNG

Now fix the Mass to 6.31 in the par file:

#+BEGIN_EXAMPLE
sbatch 1H0707-submit-lag-freq.sh
Submitted batch job 2563678

 python find-best-fit-1H0707-hi-flux-fixed-M.py
Best fit is 9.671198 in file 1H0707_hi_flux_fixedM_best_fit_19.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      2.08526e-05           0           1
  2  lag_freq(1).log_mass   0     1             6.31           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0


And again

sbatch 1H0707-submit-lag-freq.sh
Submitted batch job 2601615

sacct -j 2601615

python find-best-fit-1H0707-hi-flux.py
Best fit is 20.71776 in file 1H0707_hi_flux_best_fit_62.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.516557e-05           0           1
  2  lag_freq(1).log_mass   0     1             6.31           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.9           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              275           0           0
 15  lag_freq(1).t_shift    0     1               45           0           0

Bad fit after 1 day ! Stuck at 20.71776

#+END_EXAMPLE

The best fit was:

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-best-fit-hi-flux-fixedM-ecm.PNG

*** Testing a joint fit

First run script =1H0707-495-joint-fit2.sl= to obtain an initial fit
and plot data using =best_fit.par=

Now plot data =replot-1H0707-495-joint-fit.sl=

#+BEGIN_EXAMPLE
isis replot-1H0707-495-joint-fit.sl fit plot

RMF includes the effective area
RMF includes the effective area
 Parameters[Variable] = 32[2]
            Data bins = 14
           Chi-square = 60.10266
   Reduced chi-square = 5.008555
sds(1)*lag_freq(1) + sds(2)*lag_freq(2)
 idx  param             tie-to  freeze         value         min         max
  1  sds(1).dataset         0     1                1           0           0
  2  lag_freq(1).norm       0     0     1.641298e-05           0           1
  3  lag_freq(1).log_mass   0     1                6           5           8
  4  lag_freq(1).i          0     1               53           0           0
  5  lag_freq(1).a          0     1            0.998           0           0
  6  lag_freq(1).h1         0     1                2           0           0
  7  lag_freq(1).h2         0     1                4           0           0
  8  lag_freq(1).Gamma1     0     1              2.5           0           0
  9  lag_freq(1).Gamma2     0     1              1.6           0           0
 10  lag_freq(1).Fe         0     1                1           0           0
 11  lag_freq(1).xi         0     1                0           0           0
 12  lag_freq(1).p          0     1                0           0           0
 13  lag_freq(1).b          0     1                1           0           0
 14  lag_freq(1).q2         0     1              0.5           0           0
 15  lag_freq(1).t_max      0     1              400           0           0
 16  lag_freq(1).t_shift    0     1                0           0           0
 17  sds(2).dataset         0     1                2           0           0
 18  lag_freq(2).norm       0     0     3.500302e-05           0           1
 19  lag_freq(2).log_mass   3     0                6           5           8
 20  lag_freq(2).i          4     0               53           0           0
 21  lag_freq(2).a          5     0            0.998           0           0
 22  lag_freq(2).h1         0     1                2           0           0
 23  lag_freq(2).h2         0     1                4           0           0
 24  lag_freq(2).Gamma1     0     1              2.2           0           0
 25  lag_freq(2).Gamma2     0     1              1.6           0           0
 26  lag_freq(2).Fe        10     0                1           0           0
 27  lag_freq(2).xi         0     1                0           0           0
 28  lag_freq(2).p         12     0                0           0           0
 29  lag_freq(2).b         13     0                1           0           0
 30  lag_freq(2).q2        14     0              0.5           0           0
 31  lag_freq(2).t_max      0     1              400           0           0
 32  lag_freq(2).t_shift    0     1                0           0           0

#+END_EXAMPLE

RED  = sds(1) = lo-flux obs

BLUE = sds(2) = hi-flux obs


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_joint_fit_ecm.png

Now change the =best_fit2.par= file to mimic the best lo and hi flux
fits found - this should fit both data sets well:

#+BEGIN_EXAMPLE
RMF includes the effective area
 Parameters[Variable] = 32[2]
            Data bins = 14
           Chi-square = 287.6138
   Reduced chi-square = 23.96781
sds(1)*lag_freq(1) + sds(2)*lag_freq(2)
 idx  param             tie-to  freeze         value         min         max
  1  sds(1).dataset         0     1                1           0           0
  2  lag_freq(1).norm       0     0     0.0001217607           0           1
  3  lag_freq(1).log_mass   0     1         6.244645           5           8
  4  lag_freq(1).i          0     1               53           0           0
  5  lag_freq(1).a          0     1            0.998           0           0
  6  lag_freq(1).h1         0     1                2           0           0
  7  lag_freq(1).h2         0     1                3           0           0
  8  lag_freq(1).Gamma1     0     1              2.7           0           0
  9  lag_freq(1).Gamma2     0     1              2.3           0           0
 10  lag_freq(1).Fe         0     1                1           0           0
 11  lag_freq(1).xi         0     1                0           0           0
 12  lag_freq(1).p          0     1                0           0           0
 13  lag_freq(1).b          0     1                1           0           0
 14  lag_freq(1).q2         0     1              0.5           0           0
 15  lag_freq(1).t_max      0     1              200           0           0
 16  lag_freq(1).t_shift    0     1               10           0           0
 17  sds(2).dataset         0     1                2           0           0
 18  lag_freq(2).norm       0     0     4.379242e-05           0           1
 19  lag_freq(2).log_mass   3     0         6.244645           5           8
 20  lag_freq(2).i          4     0               53           0           0
 21  lag_freq(2).a          5     0            0.998           0           0
 22  lag_freq(2).h1         0     1                2           0           0
 23  lag_freq(2).h2         0     1                3           0           0
 24  lag_freq(2).Gamma1     0     1              2.7           0           0
 25  lag_freq(2).Gamma2     0     1              2.6           0           0
 26  lag_freq(2).Fe        10     0                1           0           0
 27  lag_freq(2).xi         0     1                3           0           0
 28  lag_freq(2).p         12     0                0           0           0
 29  lag_freq(2).b         13     0                1           0           0
 30  lag_freq(2).q2        14     0              0.5           0           0
 31  lag_freq(2).t_max      0     1              550           0           0
 32  lag_freq(2).t_shift    0     1               85           0           0
#+END_EXAMPLE

Note that setting tshift = 0 was a much poorer fit !!

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_joint_fit2_ecm.png

This is not great there is a problem with the model parameter files?

*** Joint lo-hi flux fit

Use scripts:

=replot_1H0707_best_joint_flux.sl=

=1H0707_best_joint_fit.par=


#+BEGIN_EXAMPLE
 Parameters[Variable] = 32[2]
            Data bins = 14
           Chi-square = 5.781869
   Reduced chi-square = 0.4818224
sds(1)*lag_freq(1) + sds(2)*lag_freq(2)
 idx  param             tie-to  freeze         value         min         max
  1  sds(1).dataset         0     1                1           0           0
  2  lag_freq(1).norm       0     0     0.0001237919           0           1
  3  lag_freq(1).log_mass   0     1             6.24           5           8
  4  lag_freq(1).i          0     1               53           0           0
  5  lag_freq(1).a          0     1            0.998           0           0
  6  lag_freq(1).h1         0     1                2           0           0
  7  lag_freq(1).h2         0     1                3           0           0
  8  lag_freq(1).Gamma1     0     1              2.7           0           0
  9  lag_freq(1).Gamma2     0     1              2.3           0           0
 10  lag_freq(1).Fe         0     1                1           0           0
 11  lag_freq(1).xi         0     1                0           0           0
 12  lag_freq(1).p          0     1                0           0           0
 13  lag_freq(1).b          0     1                1           0           0
 14  lag_freq(1).q2         0     1              0.5           0           0
 15  lag_freq(1).t_max      0     1              200           0           0
 16  lag_freq(1).t_shift    0     1               10           0           0
 17  sds(2).dataset         0     1                2           0           0
 18  lag_freq(2).norm       0     0     4.435209e-05           0           1
 19  lag_freq(2).log_mass   0     1             6.05           5           8
 20  lag_freq(2).i          4     0               53           0           0
 21  lag_freq(2).a          5     0            0.998           0           0
 22  lag_freq(2).h1         0     1                2           0           0
 23  lag_freq(2).h2         0     1                3           0           0
 24  lag_freq(2).Gamma1     0     1              2.7           0           0
 25  lag_freq(2).Gamma2     0     1              2.6           0           0
 26  lag_freq(2).Fe        10     0                1           0           0
 27  lag_freq(2).xi         0     1                3           0           0
 28  lag_freq(2).p         12     0                0           0           0
 29  lag_freq(2).b          0     1                2           0           0
 30  lag_freq(2).q2        14     0              0.5           0           0
 31  lag_freq(2).t_max      0     1              550           0           0
 32  lag_freq(2).t_shift    0     1               85           0           0
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -1.1666e-01     0.001
file:  1H0707-495-time-lag-fits/1H0707-495-time-lags-lo-flux.fits
  2       EPIC-PN          0       7/    7   -   2  -4.8699e-02     0.001
file:  1H0707-495-time-lag-fits/1H0707-495-time-lags-hi-flux.fits
#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495-best-joint-fit-ecm.PNG

*** OBS 0110890201 (2000)25.6s at 1.55E-3 Hz

Use
=/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/1H0707-495-time-lag-fits/1H0707-495-OBS-0110890201_time_lags.fits=
and the .rsp

use =1H0707-single-obs-lag-freq-fits.sl=


#+BEGIN_EXAMPLE
sbatch 1H0707-submit-lag-freq.sh
Submitted batch job 2425292

sacct -j 2425292

python find-best-fit.py
Best fit is 2.421449 in file best_fit_14.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     8.909133e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.271087           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                1           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              350           0           0
 15  lag_freq(1).t_shift    0     1               25           0           0

Try again using 1H0707-combined-lag-freq-fits.sl

 sbatch 1H0707-submit-lag-freq.sh
Submitted batch job 2472934
sbatch -j 2472934

python find-best-fit.py
Best fit is 4.349068 in file best_fit_62.txt

No improvement found !!!
#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495-0110890201-ecm-fit.png

*Soft lags in individual observations - lo and hi*
Now - obtain lag-freq- fits files with a high and low amplitude soft
lag and plot below. I have identified the following 2 observations for
this purpose:

0506200201 (2007) and 0110890201 (2000) - which was also investigated
above

*** OBS 0506200201 (2007)
Soft negative lag of 84.9s at 1.55E-3 Hz

Use
=/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/1H0707-495-time-lag-fits/1H0707-495-OBS-0506200201_time_lags.rsp=
and the .rsp

Edit and use =1H0707-combined-lag-freq-fits.sl=

#+BEGIN_EXAMPLE
sbatch 1H0707-submit-lag-freq.sh
Submitted batch job 2430264

sacct -j 2430264

python find-best-fit.py
Best fit is 1.721527 in file best_fit_23.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001045528           0           1
  2  lag_freq(1).log_mass   0     0         6.215218           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              435           0           0
 15  lag_freq(1).t_shift    0     1               75           0           0


#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495-OBS-0506200201-ecm-fit.png

*** OBS 0511580401 (2008)
Soft negative lag of 43.9s at 1.55E-3 Hz

Use
=/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/1H0707-495-time-lag-fits/1H0707-495-OBS-0511580401_time_lags.rsp=
and the .rsp

Edit and use =1H0707-combined-lag-freq-fits.sl=

#+BEGIN_EXAMPLE
sbatch 1H0707-submit-lag-freq.sh
Submitted batch job

sacct -j 2430139

python find-best-fit.py
Best fit is 0.685894 in file best_fit_29.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.620443e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.070307           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.1           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              375           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495-OBS-0511580401-ecm-fit.png

*** OBS 0653510501 (2010)
Soft negative lag of 445s at 1.16E-04 Hz

Use
=/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/1H0707-495-time-lag-fits/1H0707-495-0653510501_time_lags.fits=
and the .rsp

Edit and use =1H0707-combined-lag-freq-fits.sl=

#+BEGIN_EXAMPLE
sbatch 1H0707-submit-lag-freq.sh
Submitted batch job 2431366

sacct -j 2431366

find-best-fit-0653510501.py
Best fit is 10.63723 in file best_fit_0653510501_00.txt


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     9.443323e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.215262           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               85           0           0

python find-best-fit-0653510501.py
Best fit is 10.63723 in file best_fit_0653510501_00.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.656945e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.183619           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              2.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              475           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0

#+END_EXAMPLE


#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495-0653510501_ecm.png


#+BEGIN_EXAMPLE

TRy again homing in on t-shift and t-max values on 1H0707-0653510501-lag-freq-fits.sl


sbatch 1H0707-submit-lag-freq.sh
Submitted batch job 2485976

sacct -j 2485976

python find-best-fit-0653510501.py
Best fit is 13.79346 in file best_fit_0653510501_07.txt

There is no improvement after many runs - this lag is very difficult to fit !!

#+END_EXAMPLE

*** Combined
*This was the test set for this model* so in general, see above chapter in ECM Working Log called "Fitting the best fit lag file
(1H0707-495 fully combined timelag)". The best fit obtained was $\chi^2 = 3.06$, but lets try and get a better fit:

Try running x 64 for 3 days

#+BEGIN_EXAMPLE

sbatch 1H0707-submit-lag-freq.sh
Submitted batch job 2302657    <<<<<<<  2035 27 Aug  >>>>>>>>
[so14935@bc4gpulogin1 x-ray-reverberation]$ sacct -j 2302657

#+END_EXAMPLE

Best fits:

#+BEGIN_EXAMPLE
python find-best-fit.py
Best fit is 2.732153 in file best_fit_23.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.441687e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.063742           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1                2           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              550           0           0
 15  lag_freq(1).t_shift    0     1               85           0           0

python find-best-fit.py
Best fit is 2.633207 in file best_fit_04.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.182837e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.090303           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.7           0           0
  8  lag_freq(1).Gamma2     0     1              1.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0

variable pid = open_plot("1H0707-495_ecm_fit_2.63.ps/cps");


#+END_EXAMPLE

<<<<<<<<<<<<<<<<<<<<<<  Below is best fit found at 2.63  >>>>>>>>>>>>>>>>>>>>

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_comb_ecm_fit_2pt63.png

>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

Now try by fixing  Fe = 1, q2 = 0.5 and homing tight in on t-max and t-shift

 =1H0707-495-lag-freq-fits.sl=

=best_lag_freq_fit.par=


#+BEGIN_EXAMPLE
sbatch 1H0707-submit-lag-freq.sh
Submitted batch job 2831131

sacct -j 2831131

python find-best-fit.py
Best fit is 2.935429 in file best_fit_19.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.359971e-05           0           1
  2  lag_freq(1).log_mass   0     0          6.00978           5           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               85           0           0

#+END_EXAMPLE

*Now submit for varied source heights (in smaller steps = 0.2)*
 Code-s, code-x and the blob coded have all been run for:

$h_1 = 1.8 - 5.0$ step size 0.2

$h_2 = 2.0 - 5.0$ step size 0.2

$\Gamma_{1, 2} = 1.2 - 3.1$ step size 0.1

This created many new lag-fits files that can now be fitted
This was done for  i - 53 deg on 21 Dec 2019.

Lets fix Fe = 1, q = 0.5 and p = 0.0 and use a wide range of parameter
values to begin with :

#+BEGIN_EXAMPLE
pars_to_fit[0] = "lag_freq(1).t_shift";
vals_to_fit[0] = [10.0, 20.0, 30.0, 40.0, 50.0, 70.0, 75.0, 80.0, 85.0, 90.0, 95.0, 100.0];
pars_to_fit[1] = "lag_freq(1).t_max";
vals_to_fit[1] = [100.0, 200.0, 300.0, 350.0, 450.0, 460.0, 480.0, 490.0, 495.0, 500.0, 510.0, 520.0, 600.0];
pars_to_fit[2] = "lag_freq(1).Gamma1";
vals_to_fit[2] = [1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9, 3.0, 3.1];
pars_to_fit[3] = "lag_freq(1).Gamma2";
vals_to_fit[3] = [1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9, 3.0, 3.1];
pars_to_fit[4] = "lag_freq(1).xi";
vals_to_fit[4] = [0.0, 3.0];
pars_to_fit[5] = "lag_freq(1).b";
vals_to_fit[5] = [1.0, 2.0, 3.0];
pars_to_fit[6] = "lag_freq(1).h1";
vals_to_fit[6] = [1.8, 2.0, 2.2, 2.4, 2.6, 2.8, 3.0, 3.2, 4.0, 5.0, 6.0, 7.0, 8.0];
pars_to_fit[7] = "lag_freq(1).h2";
vals_to_fit[7] = [2.0, 2.2, 2.4, 2.6, 2.8, 3.0, 3.2, 3.4, 3.6, 3.8, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0];
%pars_to_fit[9] = "lag_freq(1).log_mass";
%vals_to_fit[9] = [6.1, 6.2, 6.3];
#+END_EXAMPLE

*Other fits*

#+BEGIN_EXAMPLE
emacs 1H0707-combined-lag-freq-fits2.sl

pars_to_fit[0] = "lag_freq(1).t_max";
vals_to_fit[0] = [100.0, 150.0, 180.0, 190.0, 200.0, 220.0, 300.0, 350.0];
pars_to_fit[1] = "lag_freq(1).t_shift";
vals_to_fit[1] = [5.0,  10.0, 20.0, 40.0, 50.0, 75.0, 100.0];
pars_to_fit[2] = "lag_freq(1).Gamma1";
vals_to_fit[2] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8];
pars_to_fit[3] = "lag_freq(1).Gamma2";
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9];
pars_to_fit[4] = "lag_freq(1).xi";
vals_to_fit[4] = [0.0, 3.0];
pars_to_fit[5] = "lag_freq(1).b";
vals_to_fit[5] = [1.0, 2.0, 3.0];
pars_to_fit[6] = "lag_freq(1).h1";
vals_to_fit[6] = [1.8, 2.0, 3.0, 4.0, 5.0, 6.0];
pars_to_fit[7] = "lag_freq(1).h2";
vals_to_fit[7] = [3.0, 4.0, 5.0, 6.0, 7,0, 8.0];
pars_to_fit[8] = "lag_freq(1).q2";
vals_to_fit[8] = [0.5];
pars_to_fit[9] = "lag_freq(1).Fe";
vals_to_fit[9] = [1.0];
%pars_to_fit[9] = "lag_freq(1).log_mass";
%vals_to_fit[9] = [6.1, 6.2, 6.3];
%pars_to_fit[10] = "dummy(1).a"; % <-- "beta" for propagation speed
%vals_to_fit[10] = [0.1, 0.25, 0.75, 1.0];

python find-best-1H0707-comb-fit2.py
Best fit is 3.797556 in file best_fit2_10.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.291617e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.000498           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1              1.8           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.7           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0

#+END_EXAMPLE

Try H1 = 2 and 3. H2 = 5, 6, 7

#+BEGIN_EXAMPLE
emacs 1H0707-combined-lag-freq-fits3.sl

pars_to_fit[0] = "lag_freq(1).t_max";
vals_to_fit[0] = [100.0, 150.0, 175.0, 200.0, 220.0, 300.0, 350.0, 400.0, 450.0];
pars_to_fit[1] = "lag_freq(1).t_shift";
vals_to_fit[1] = [5.0,  10.0, 20.0, 40.0, 50.0, 75.0, 100.0, 150.0];
pars_to_fit[2] = "lag_freq(1).Gamma1";
vals_to_fit[2] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9];
pars_to_fit[3] = "lag_freq(1).Gamma2";
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9];
pars_to_fit[4] = "lag_freq(1).xi";
vals_to_fit[4] = [0.0, 3.0];
pars_to_fit[5] = "lag_freq(1).b";
vals_to_fit[5] = [1.0, 2.0, 3.0];
pars_to_fit[6] = "lag_freq(1).h1";
vals_to_fit[6] = [2.0, 3.0];
pars_to_fit[7] = "lag_freq(1).h2";
vals_to_fit[7] = [5.0, 6.0, 7,0];
pars_to_fit[8] = "lag_freq(1).q2";
vals_to_fit[8] = [0.5];
pars_to_fit[9] = "lag_freq(1).Fe";
vals_to_fit[9] = [1.0];
%pars_to_fit[9] = "lag_freq(1).log_mass";
%vals_to_fit[9] = [6.1, 6.2, 6.3];
%pars_to_fit[10] = "dummy(1).a"; % <-- "beta" for propagation speed
%vals_to_fit[10] = [0.1, 0.25, 0.75, 1.0];

python find-best-1H0707-comb-fit3.py
Best fit is 3.785614 in file best_fit3_12.txt


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.968264e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.054183           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               75           0           0

#+END_EXAMPLE


>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>


*Now try fixing h_1 and h_2*

Try fixing h_1 = 2 and h_2 = 6

Use 1H0707-combined-lag-freq-fits.sl

out file is best_fit2_%02i.txt

So use find-best-1H0707-comb-fit2.py

#+BEGIN_EXAMPLE
sbatch 1H0707-submit-lag-freq.sh
Submitted batch job 2961035 (x26)

sacct -j 2961035

python find-best-1H0707-comb-fit2.py
Best fit is 8.232351 in file best_fit2_03.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.774157e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.079757           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              1.9           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              350           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0
#+END_EXAMPLE

>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

And now try fixing h_1 = 2 and h_2 = 7

Use 1H0707-combined-lag-freq-fits2.sl

out file is best_fit_%02i.txt

So use find-best-1H0707-comb-fit.py

#+BEGIN_EXAMPLE
sbatch 1H0707-submit-lag-freq.sh
Submitted batch job 2961063 (x26)
sacct -j 296106


python find-best-1H0707-comb-fit.py
Best fit is 6.089034 in file best_fit_09.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.969546e-05           0           1
  2  lag_freq(1).log_mass   0     0          6.27348           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                7           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              220           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0
#+END_EXAMPLE

>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

And now try fixing h_1 = 2 and h_2 = 8

Use 1H0707-combined-lag-freq-fits3.sl

out file is "best_fit3_%02i.txt

 find-best-1H0707-comb-fit3.py

#+BEGIN_EXAMPLE
sbatch 1H0707-submit-lag-freq.sh
Submitted batch job 2961089 (x26)

sacct -j 2961116

python find-best-1H0707-comb-fit3.py
Best fit is 7.92639 in file best_fit3_03.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.697207e-05           0           1
  2  lag_freq(1).log_mass   0     0                6           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                8           0           0
  7  lag_freq(1).Gamma1     0     1              1.8           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               75           0           0
#+END_EXAMPLE

*Manual fitting*

Replot the best fit using =isis replot-best-1H0707-lag-freq-fits.sl=

Also use =1H0707_combined_best_fit.par=

#+BEGIN_EXAMPLE
 Parameters[Variable] = 15[2]
            Data bins = 7
           Chi-square = 2.633207
   Reduced chi-square = 0.5266415
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.182837e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.090303           5           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.7           0           0
  8  lag_freq(1).Gamma2     0     1              1.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0

Now try to force value sof tmax

%set_par(2,6.31,1);


set_par(6,5,1);
set_par(14,200,1);
set_par(15,200,1);
() = fit_counts;
() = eval_counts;
plot_data(1, popt);
_pgsci(1);
_pgsls(2);
_pgmove(-10000, 0);
_pgdraw(1, 0);
list_par;






#+END_EXAMPLE

*** Combined New Method - Fix h2 = 2

Copy dir to
=/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/=

Begin a fresh lag-files directory as at Jan 2020

New fits:

#+BEGIN_EXAMPLE

python find-best-1H0707-comb-fit.py
Best fit is 5.818053 in file best_fit_17.txt

lag_freq(1)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.887997e-05           0           1
  2  lag_freq(1).log_mass   0     1              6.3           5           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_combined_fixedM_h1.PNG

Run again - widen Gamma, tshift and tmax:

#+BEGIN_EXAMPLE
sbatch 1H0707-submit-lag-freq.sh
Submitted batch job 3319369

sacct -j 3319369

python find-best-1H0707-comb-fit.py
#+END_EXAMPLE

Replot the best fit and fit manually

#+BEGIN_EXAMPLE
isis replot_1H0707_combined_best_fit.sl

lag_freq(1)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.887997e-05           0           1
  2  lag_freq(1).log_mass   0     1              6.3           5           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


 Parameters[Variable] = 15[1]
            Data bins = 7
           Chi-square = 4.389192
   Reduced chi-square = 0.731532
isis> list_par;
lag_freq(1)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.789378e-05           0           1
  2  lag_freq(1).log_mass   0     1              6.3           5           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              205           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0
isis>

 Parameters[Variable] = 15[1]
            Data bins = 7
           Chi-square = 4.348853
   Reduced chi-square = 0.7248089
isis> list_par;
lag_freq(1)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.664852e-05           0           1
  2  lag_freq(1).log_mass   0     1              6.3           5           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              210           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


1H0707-495_comb_best_fitFM.par

 Parameters[Variable] = 15[2]
            Data bins = 7
           Chi-square = 5.598965
   Reduced chi-square = 1.119793
lag_freq(1)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      4.44268e-05           0           1
  2  lag_freq(1).log_mass   0     1             6.31           5           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0              210         180         250
 15  lag_freq(1).t_shift    0     1               20           0           0

set_par(14,210,1);
set_par(15,25,1);
() = fit_counts;
() = eval_counts;
list_par;

plot_data(1, popt);
_pgsci(1);
_pgsls(2);
_pgmove(-10000, 0);
_pgdraw(1, 0);
() = eval_counts;
list_par;
#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495-combined-FM-ecm.png


Also - for a variable M:

#+BEGIN_EXAMPLE

python find-best-1H0707-comb-fit.py
Best fit is 3.655352 in file best_fit_17.txt


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.359297e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.053556           5           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0


#+END_EXAMPLE


use par file =1H0707_fit_tmax400.par=

#+BEGIN_EXAMPLE
sbatch 1H0707-submit-lag-freq.sh
Submitted batch job 3334787

 python find-best-1H0707-comb-fit.py
Best fit is 4.363218 in file best_fit_09.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      2.96803e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.047121           5           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0

#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/best_fit_09-1.png


Now fix the Mass

"1H0707_fit_tmax400.par"

#+BEGIN_EXAMPLE
sbatch 1H0707-submit-lag-freq.sh
Submitted batch job 3354033

python find-best-1H0707-comb-fit.py
Best fit is 3.276898 in file best_fit_16.txt


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.094239e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.058228           5           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1                2           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0

#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/best_fit_16-1.png

Small tmax range: 200.0 - 450.0 delta 25.0

#+BEGIN_EXAMPLE
sbatch 1H0707-submit-lag-freq.sh
Submitted batch job 3354079

python find-best-1H0707-comb-fit.py
Best fit is 3.063909 in file best_fit_28.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.683768e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.031967           5           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              2.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              425           0           0
 15  lag_freq(1).t_shift    0     1               82           0           0


#+END_EXAMPLE

*** Lo-flux lags

Use:

#+BEGIN_EXAMPLE
1H0707-lag-freq-lo-flux-fits.sl
1H0707-495-time-lags-lo-flux.fits
1H0707-495-time-lags-lo-flux.rsp
1H0707_lo_flux_best_fit.par
#+END_EXAMPLE

Variable MAss:

#+BEGIN_EXAMPLE
sbatch 1H0707-submit-lag-freq.sh
Submitted batch job 3386111

python find-best-1H0707-lo-flux-fit.py
Best fit is 2.146248 in file best_fit_lo10.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001063363           0           1
  2  lag_freq(1).log_mass   0     0         6.164539           6           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0


#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/best_fit_lo10-1.png

And again:

#+BEGIN_EXAMPLE
sbatch 1H0707-submit-lag-freq.sh
Submitted batch job 3402312

python find-best-1H0707-lo-flux-fit.py
Best fit is 1.629752 in file best_fit_lo06.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      0.000107121           0           1
  2  lag_freq(1).log_mass   0     0         6.264603           6           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1                8           0           0

#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/best_fit_lo06-1.png

*** Hi flux lags

Use:

#+BEGIN_EXAMPLE
1H0707-lag-freq-hi-flux-fits.sl
1H0707-495-time-lags-hi-flux.fits
1H0707-495-time-lags-hi-flux.rsp
1H0707_hi_flux_best_fit.par
#+END_EXAMPLE

Variable MAss:
#+BEGIN_EXAMPLE
sbatch 1H0707-submit-lag-freq.sh
Submitted batch job 3418757

python find-best-1H0707-hi-flux-fit.py
Best fit is 2.557451 in file best_fit_hi_27.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      3.27516e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.094132           6           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.1           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0

#+END_EXAMPLE

Wait to see if this improves

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/best_fit_hi_flux2p56-1.png

And again - fix tmax at 400 (same as best fit for combined)

#+BEGIN_EXAMPLE
python find-best-1H0707-hi-flux-fit.py
Best fit is 2.126507 in file best_fit_hi_09.txt


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.669813e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.015939           6           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              575           0           0
 15  lag_freq(1).t_shift    0     1               95           0           0

#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/best_fit_hi_flux2p13-1.png

And again:

#+BEGIN_EXAMPLE
sbatch 1H0707-submit-lag-freq.sh
Submitted batch job 3424799

python find-best-1H0707-hi-flux-fit.py
Best fit is 1.916447 in file best_fit_hi_10.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      4.27116e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.030415           6           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              570           0           0
 15  lag_freq(1).t_shift    0     1               90           0           0

#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/best_fit_hi_flux1p92-1.png

*Fixed Mass*

#+BEGIN_EXAMPLE
1H0707_hi_flux_best_fit.par

sbatch 1H0707-submit-lag-freq.sh
Submitted batch job 3440718


python find-best-1H0707-hi-flux-fit.py
Best fit is 10.2627 in file best_fit_hi_28.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.658132e-05           0           1
  2  lag_freq(1).log_mass   0     1             6.31           6           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0


python find-best-1H0707-hi-flux-fit.py
Best fit is 5.60613 in file best_fit_hi_20.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.653006e-05           0           1
  2  lag_freq(1).log_mass   0     1             6.31           6           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1              2.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


#+END_EXAMPLE


Next - attempt to fit best p[ar file for the combined fits!:

#+BEGIN_EXAMPLE

#+END_EXAMPLE

*** Combined 14 bins

USE: =1H0707-495-comb-time-lags14.fits= & rsp files that will have 14
data points:

also use: =1H0707_best_fit_comb14bins.par=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_fullycomb_lagfreq14.gif

Fit

#+BEGIN_EXAMPLE
sbatch 1H0707-submit-lag-freq.sh
Submitted batch job 2786312

sacct -j 2786312



#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/


#+BEGIN_EXAMPLE


#+END_EXAMPLE

*** 2007 lags

PATH =/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/1H0707-495-time-lag-fits/1H0707-495-2007-time-lags.fits/=

USE =1H0707-495-2007-lag-fits.sl=

Loading the data - you must ignore PHA response keywords around line
199  otherwise data will not load i.e:

#+BEGIN_EXAMPLE
% Load the data.
Ignore_PHA_Response_Keywords = 1;
variable d = load_data("1H0707-495-time-lag-fits/1H0707-495-2007-time-lags.fits");
variable r = load_rmf("1H0707-495-time-lag-fits/1H0707-495-2007-time-lags.rsp");
assign_rmf(r, d);
#+END_EXAMPLE


Parameters to fit
#+BEGIN_EXAMPLE
pars_to_fit[0] = "t_shift";
vals_to_fit[0] = [0.0, 50.0, 100.0, 150.0];
pars_to_fit[1] = "t_max";
vals_to_fit[1] = [250.0, 500.0, 750.0, 1000.0];
pars_to_fit[2] = "Gamma1";
vals_to_fit[2] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.7, 2.9, 3.1];
pars_to_fit[3] = "Gamma2";
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.7, 2.9, 3.1];
pars_to_fit[4] = "x";
vals_to_fit[4] = [0.0, 1.0, 2.0];
pars_to_fit[5] = "b";
vals_to_fit[5] = [1.0, 2.0, 3.0];
pars_to_fit[6] = "h1";
vals_to_fit[6] = [2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0];
pars_to_fit[7] = "h2";
vals_to_fit[7] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 16.0, 17.0, 18.0, 19.0, 20.0];
#+END_EXAMPLE


USE =submit-1H0707-2007-lag-freq.sh=

#+BEGIN_EXAMPLE
#! /bin/tcsh
#
#SBATCH --partition=serial
#SBATCH --nodes=1
#SBATCH --ntasks-per-node=1
#SBATCH --mem=6GB
#SBATCH --time=3-00:00:00
#SBATCH --job-name=lag-freq
#SBATCH --array=0-9

## Note that array should be from 0 to (n-1) and isis-script should be run with n at the end

module load CUDA
module load cURL

cd /mnt/storage/scratch/${LOGNAME}/x-ray-rev2/x-ray-reverberation

isis-script 1H0707-495-2007-lag-fits.sl fit $SLURM_ARRAY_TASK_ID 10

#+END_EXAMPLE

To find best fit use =find-best-fit-1H0707-495_2007.py=

#+BEGIN_EXAMPLE
#! /usr/bin/python3

# Look at all the best fits and pick the one with the smallest statistic

import glob
import os
import string

files = glob.glob('1H0707-495_2007_best_fit_??.txt')
best_stat = 1.0E10;
best_file = "";
for file in files:
        with open(file) as f:
                cur_stat = float(next(f))
                if (cur_stat < best_stat):
                        best_stat = cur_stat
                        best_file = file

print("Best fit is", best_stat, "in file", best_file)
os.system("cp " + best_file + " 1H0707-495_2007_best_fit.txt")
best_file = best_file.replace('.txt', '.par')
os.system("cp " + best_file + " 1H0707-495_2007_best_fit.par")
best_file = best_file.replace('.par', '.ps')
os.system("cp " + best_file + " 1H0707-495_2007_best_fit.ps")
#+END_EXAMPLE


#+BEGIN_EXAMPLE
python find-best-fit-1H0707-495_2007.py
Best fit is 1.927129 in file 1H0707-495_2007_best_fit_05.txt

emacs 1H0707-495_2007_best_fit_05.par

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.069163e-06           0           1
  2  lag_freq(1).log_mass   0     0         6.148602           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              1.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              750           0           0
 15  lag_freq(1).t_shift    0     1              150           0           0
#+END_EXAMPLE

Copy files to Lrya
#+BEGIN_EXAMPLE
scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/1H0707-495_2007_best_fit_05.par .
scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/1H0707-495_2007_best_fit_05.ps .

Explicitly Rename files:
mv 1H0707-495_2007_best_fit_05.par 1H0707-495_2007_best_fit_05-stat-1.927129.par
ps2pdf 1H0707-495_2007_best_fit_05.ps 1H0707-495_2007_best_fit_05-stat-1.927129.pdf
#+END_EXAMPLE


#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_2007_best_fit_05-stat-1.972.png

Rerun with tighter ranges on $\Gamma_1$, $\Gamma_2$, $t_{\text{shift}}$ and $t_{\text{max}}$

Submit
#+BEGIN_EXAMPLE
sbatch submit-1H0707-2007-lag-freq.sh
Submitted batch job 2246694   <<<<<<<< submitted 1545 26 July 2019 >>>>>>>>>>

sacct -j 2246694
       JobID    JobName  Partition    Account  AllocCPUS      State ExitCode
------------ ---------- ---------- ---------- ---------- ---------- --------
2246694_5      lag-freq     serial    default          1    RUNNING      0:0
etc....

Later - Code failed TIMEOUT
#+END_EXAMPLE

Best fit was:

#+BEGIN_EXAMPLE
python find-best-fit-1H0707-495_2007.py
Best fit is 1.919509 in file 1H0707-495_2007_best_fit_04.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.158919e-06           0           1
  2  lag_freq(1).log_mass   0     0         6.135274           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              1.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                1           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              800           0           0
 15  lag_freq(1).t_shift    0     1              150           0           0
#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_2007_best_fit_04-stat-1.919.png

Now tighten these further as:
#+BEGIN_EXAMPLE
pars_to_fit[0] = "t_shift";
vals_to_fit[0] = [100.0, 125.0, 150.0, 175.0, 200.0];
pars_to_fit[1] = "t_max";
vals_to_fit[1] = [500.0, 600.0, 650.0, 700.0, 750.0, 800];
pars_to_fit[2] = "Gamma1";
vals_to_fit[2] = [2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.7, 2.9, 3.1];
pars_to_fit[3] = "Gamma2";
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2];
pars_to_fit[4] = "x";
vals_to_fit[4] = [0.0, 1.0, 2.0];
pars_to_fit[5] = "b";
vals_to_fit[5] = [1.0, 2.0, 3.0];
pars_to_fit[6] = "h1";
vals_to_fit[6] = [2.0, 3.0, 4.0, 5.0, 6.0];
pars_to_fit[7] = "h2";
vals_to_fit[7] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0];
#+END_EXAMPLE

Submit

#+BEGIN_EXAMPLE
sbatch submit-1H0707-2007-lag-freq.sh
Submitted batch job 2252211  >>>>>>>>> 1140 30 July 19  <<<<<<<<<<<<<<

Later...
sacct -j 2252211

TIMEOUT after 3 days
#+END_EXAMPLE

No immediate improvement found !!!

Copy files to Lyra:

#+BEGIN_EXAMPLE
scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/1H0707-495_2007_best_fit_03.par .
scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/1H0707-495_2007_best_fit_03.ps .

Explicitly Rename files:
mv 1H0707-495_2007_best_fit_03.par 1H0707-495_2007_best_fit.par
ps2pdf 1H0707-495_2007_best_fit_05.ps 1H0707-495_2007_best_fit.pdf
#+END_EXAMPLE

Create good pdf of plot (in BC4):

So to refit this, I set the parameters in
=replot-best-lag-freq-fits-2007.sl= to the above (lines 236-251) and :

Remember to set dat on line 199 and beyond to:
#+BEGIN_EXAMPLE
Ignore_PHA_Response_Keywords = 1;
variable d = load_data("1H0707-495-time-lag-fits/1H0707-495-2007-time-lags.fits");
variable r = load_rmf("1H0707-495-time-lag-fits/1H0707-495-2007-time-lags.rsp");

isis-script replot-best-lag-freq-fits.sl fit plot
#+END_EXAMPLE

Copy ps to Lyra directory

#+BEGIN_EXAMPLE
scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/1H0707-495_2007_ecm.ps .
ps2pdf 1H0707-495_2007_ecm.ps

gvfs-open 1H0707-495_2007_ecm.pdf
#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_2007_ecm.png

RUN again

#+BEGIN_EXAMPLE
Best fit is 1.931654 in file 1H0707_2007_best_fit_06.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.766661e-06           0           1
  2  lag_freq(1).log_mass   0     0         6.118869           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              800           0           0
 15  lag_freq(1).t_shift    0     1              160           0           0

No improvement found!
#+END_EXAMPLE

*** 2008 lags

PATH =/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/1H0707-495-time-lag-fits/1H0707-495-2008-time-lags.fits/=

USE =1H0707-495-2008-lag-fits.sl=

Loading the data - you must ignore PHA response keywords around line
199  otherwise data will not load i.e:

#+BEGIN_EXAMPLE
% Load the data.
Ignore_PHA_Response_Keywords = 1;
variable d = load_data("1H0707-495-time-lag-fits/1H0707-495-2008-time-lags.fits");
variable r = load_rmf("1H0707-495-time-lag-fits/1H0707-495-2008-time-lags.rsp");
assign_rmf(r, d);
#+END_EXAMPLE


Parameters to fit
#+BEGIN_EXAMPLE
pars_to_fit[0] = "t_shift";
vals_to_fit[0] = [0.0, 50.0, 100.0, 150.0];
pars_to_fit[1] = "t_max";
vals_to_fit[1] = [250.0, 500.0, 750.0, 1000.0];
pars_to_fit[2] = "Gamma1";
vals_to_fit[2] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.7, 2.9, 3.1];
pars_to_fit[3] = "Gamma2";
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.7, 2.9, 3.1];
pars_to_fit[4] = "x";
vals_to_fit[4] = [0.0, 1.0, 2.0];
pars_to_fit[5] = "b";
vals_to_fit[5] = [1.0, 2.0, 3.0];
pars_to_fit[6] = "h1";
vals_to_fit[6] = [2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0];
pars_to_fit[7] = "h2";
vals_to_fit[7] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 16.0, 17.0, 18.0, 19.0, 20.0];
#+END_EXAMPLE


USE =submit-1H0707-2008-lag-freq.sh=

#+BEGIN_EXAMPLE
#! /bin/tcsh
#
#SBATCH --partition=serial
#SBATCH --nodes=1
#SBATCH --ntasks-per-node=1
#SBATCH --mem=6GB
#SBATCH --time=3-00:00:00
#SBATCH --job-name=lag-freq
#SBATCH --array=0-9

## Note that array should be from 0 to (n-1) and isis-script should be run with n at the end

module load CUDA
module load cURL

cd /mnt/storage/scratch/${LOGNAME}/x-ray-rev2/x-ray-reverberation

isis-script 1H0707-495-2008-lag-fits.sl fit $SLURM_ARRAY_TASK_ID 10
#+END_EXAMPLE

Submit batch

#+BEGIN_EXAMPLE
sbatch submit-1H0707-2008-lag-freq.sh
Submitted batch job 2246624  >>>>>>> submitted 1500 26 July 2019 <<<<<<<<<<
#+END_EXAMPLE

To find best fit use =find-best-fit-1H0707-2008.py=

#+BEGIN_EXAMPLE
python find-best-fit-1H0707-2008.py


Note this reads:
-------------------------------------------------------------------------
#! /usr/bin/python3

# Look at all the best fits and pick the one with the smallest statistic

import glob
import os
import string

files = glob.glob('1H0707-495_2008_best_fit_??.txt')
best_stat = 1.0E10;
best_file = "";
for file in files:
        with open(file) as f:
                cur_stat = float(next(f))
                if (cur_stat < best_stat):
                        best_stat = cur_stat
                        best_file = file

print("Best fit is", best_stat, "in file", best_file)
os.system("cp " + best_file + " 1H0707-495_2008_best_fit.txt")
best_file = best_file.replace('.txt', '.par')
os.system("cp " + best_file + " 1H0707-495_2008_best_fit.par")
best_file = best_file.replace('.par', '.ps')
os.system("cp " + best_file + " 1H0707-495_2008_best_fit.ps")
---------------------------------------------------------------------------
#+END_EXAMPLE

Copy files to Lrya
#+BEGIN_EXAMPLE
scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/1H0707-495_2008_best_fit_05.par .
scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/1H0707-495_2008_best_fit_05.ps .

Explicitly Rename files:
mv 1H0707-495_2008_best_fit_05.par 1H0707-495_2008_best_fit_05-stat-9.365.par
ps2pdf 1H0707-495_2008_best_fit_05.ps 1H0707-495_2008_best_fit_05-stat-9.365.pdf
#+END_EXAMPLE


First best fit
#+BEGIN_EXAMPLE
 python find-best-fit-1H0707-2008.py
Best fit is 9.365394 in file 1H0707-495_2008_best_fit_05.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      4.63304e-05           0           1
  2  lag_freq(1).log_mass   0     0         7.705398           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                3           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              1.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1000           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0
#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_2008_best_fit_05-stat-9.365.png

See the combined fit for improvement guidance and rerun:

#+BEGIN_EXAMPLE
sbatch submit-1H0707-2008-lag-freq.sh
Submitted batch job 2252232   <<<<<<<<<<<1200 30 July 19 >>>>>>>>>>

sacct -j 2252232

python find-best-fit-1H0707-2008.py
Best fit is 12.89938 in file 1H0707-495_2008_best_fit_09.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.756594e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.298913           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                4           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0
#+END_EXAMPLE

Have a look at this fits

In Lyra:

#+BEGIN_EXAMPLE
scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/1H0707-495_2008_best_fit_09.pdf .
#+END_EXAMPLE

Not a great fit - run again!!!

#+BEGIN_EXAMPLE
Best fit is 14.62289 in file 1H0707_2008_best_fit_05.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.817455e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.115752           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.8           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               75           0           0

Script failed - example reason:

FITSIO status = 105: couldn't create the named file
failed to create new file (already exists?):
lag.fits
h1=2 h2=3 i=53 g1=1p9 g2=2p4 A=1 x=0 p=0 rs1=1 rs2=1 b=1 w=0p5 v=600 q=35
r1s= 1.000000 r1h=0.165436 r2s= 1.000000 r2h= 0.249836avg_s= 0.000000 avg_h=0.000000 tg=1.000000
File lag-files/i53/a0.998/h02.0+03.0/g1.9+2.4/A01.0/x0.0/p00.0/b01.0/q0.5/tmax0800/tshift0035/lag.fits does not e\
xist
#+END_EXAMPLE

Now try this:
#+BEGIN_EXAMPLE
pars_to_fit[0] = "t_shift";
vals_to_fit[0] = [0.0, 25.0, 30.0, 35.0, 40.0, 45.0, 50.0, 65.0, 75.0, 85.0, 100.0];
pars_to_fit[1] = "t_max";
vals_to_fit[1] = [250.0, 275.0, 300.0, 325.0, 350.0, 375.0, 400.0, 425.0, 450.0, 500.0, 600.0, 750.0];
pars_to_fit[2] = "Gamma1";
vals_to_fit[2] = [1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9, 3.1];
pars_to_fit[3] = "Gamma2";
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9, 3.1];
pars_to_fit[4] = "x";
vals_to_fit[4] = [0.0, 1.0, 2.0, 3.0];
pars_to_fit[5] = "b";
vals_to_fit[5] = [1.0, 2.0, 3.0];
pars_to_fit[6] = "h1";
vals_to_fit[6] = [2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0];
pars_to_fit[7] = "h2";
vals_to_fit[7] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0];
#+END_EXAMPLE

#+BEGIN_EXAMPLE
sbatch 1H0707-submit-lag-freq.sh
Submitted batch job 2261372

sacct -j 2261372

python find-best-fit-1H0707-2008.py
Best fit is 12.47314 in file 1H0707_2008_best_fit_00.txt <<<<< at 0900 5 Aug >>>>>>>

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.870201e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.132492           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.8           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              350           0           0
 15  lag_freq(1).t_shift    0     1               75           0           0
#+END_EXAMPLE

Next fit:

#+BEGIN_EXAMPLE
sbatch 1H0707-submit-lag-freq.sh <<<1100 5 Aug >>>>>
Submitted batch job 2261866

sacct -j 2261866

python find-best-fit-1H0707-2008.py
Best fit is 11.85669 in file 1H0707_2008_best_fit_10.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.952148e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.139088           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.8           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              350           0           0
 15  lag_freq(1).t_shift    0     1               70           0           0
#+END_EXAMPLE

Run again:

#+BEGIN_EXAMPLE
sbatch 1H0707-submit-lag-freq.sh
Submitted batch job 2262434
sacct -j 2262434

python find-best-fit-1H0707-2008.py

Best fit is 13.80335 in file 1H0707_2008_best_fit_11.txt >>>> This fit has got worse - try again <<<<<<<

 sbatch 1H0707-submit-lag-freq.sh  <<<<<< 1330 6 Aug 2019 >>>>>>>>>
Submitted batch job 2264289

sacct -j 2264289
 Parameters[Variable] = 15[2]
            Data bins = 7
           Chi-square = 11.72066
   Reduced chi-square = 2.344132
0
isis> list_par;
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.959909e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.142651           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.8           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              340           0           0
 15  lag_freq(1).t_shift    0     1               70           0           0
#+END_EXAMPLE

Not good enough!  Try again and use =1H0707-495_2008_ecm1.par=

#+BEGIN_EXAMPLE
isis replot-best-lag-freq-fits_1H0707_2008.sl fit plot

 Parameters[Variable] = 15[2]
            Data bins = 7
           Chi-square = 9.365242
   Reduced chi-square = 1.873048
0
isis> list_par;
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      4.63304e-05           0           1
  2  lag_freq(1).log_mass   0     0         7.705398           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                3           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              1.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1000           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0
#+END_EXAMPLE

Obtain ps image for pdf

#+BEGIN_EXAMPLE
scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/1H0707-495_2008_ecm1.ps .
ps2pdf 1H0707-495_2008_ecm1.ps
gvfs-open 1H0707-495_2008_ecm1.pdf
#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_2008_ecm1.png

Run again to see if we can improve the fit!

#+BEGIN_EXAMPLE
python find-best-fit-1H0707-2008.py
Best fit is 11.72066 in file 1H0707_2008_best_fit_22.txt

No improvement found!!!
#+END_EXAMPLE

And again to see if we can improve the fit with the following pars:

#+BEGIN_EXAMPLE
pars_to_fit[0] = "t_shift";
vals_to_fit[0] = [25.0, 30.0, 35.0, 40.0, 45.0, 50.0, 55.0, 60.0, 70.0, 75.0, 80.0, 90.0, 100.0, 125.0, 150.0];
pars_to_fit[1] = "t_max";
vals_to_fit[1] = [50.0, 100.0, 150.0, 200.0,250.0, 500.0, 600.0, 700.0, 800.0, 900.0, 950.0, 1000.0, 1050.0, 1100.0, 1200.0, 1300.0];
pars_to_fit[2] = "Gamma1";
vals_to_fit[2] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9, 3.1];
pars_to_fit[3] = "Gamma2";
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9, 3.1];
pars_to_fit[4] = "x";
vals_to_fit[4] = [0.0, 1.0, 2.0, 3.0];
pars_to_fit[5] = "b";
vals_to_fit[5] = [1.0, 2.0, 3.0];
pars_to_fit[6] = "h1";
vals_to_fit[6] = [2.0, 3.0, 4.0, 5.0];
pars_to_fit[7] = "h2";
vals_to_fit[7] = [3.0, 4.0, 5.0, 6.0];
#+END_EXAMPLE

Submit

#+BEGIN_EXAMPLE
sbatch 1H0707-submit-lag-freq.sh  <<<<<<<<<<<<<<<<<<  1550 14 Aug  >>>>>>>>>>>>>>>>>>>>>>>>>>
Submitted batch job 2273214

sacct -j 2273214

FITSIO status = 104: could not open the named file
failed to find or open the following file: (ffopen)
/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/code-x-files/i53/a0.
998/h03.0/g2.8/A1.0/x0.0/p00.0/rev.fits
h1=2 h2=3 i=53 g1=1p4 g2=2p8 A=1 x=0 p=0 rs1=1 rs2=1 b=1 w=0p5 v=100 q=25
failed to find or open the following file: (ffopen)
/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation//lag-files/i53/a0.99
8/h02.0+03.0/g1.4+2.8/A01.0/x0.0/p00.0/b01.0/q0.5/tmax0100/tshift0025/lag.fits
could not open the named file: /mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation//lag-files/i53/a0.998/h02.0+03.0/g1.4+2.8/A01.0/x0.0/p00.0/b01.0/q0.5/tmax0100/tshift0025/lag.fits
/mnt/storage/scratch/so14935/isis/1.6.2/share/fits.sl:123:fits_check_error:Fits Error
Error: function evaluation failed
Traceback: _mode_switch
Traceback: _fit

FAILED !!!

python find-best-fit-1H0707-2008.py
Best fit is 14.1114 in file 1H0707_2008_best_fit_18.txt

Still no improvement !
#+END_EXAMPLE

Now try this
#+BEGIN_EXAMPLE
pars_to_fit[0] = "t_shift";
vals_to_fit[0] = [25.0, 30.0, 35.0, 40.0, 45.0, 50.0, 55.0, 60.0, 70.0, 75.0, 80.0, 90.0, 100.0, 125.0, 150.0, 175.0];
pars_to_fit[1] = "t_max";
vals_to_fit[1] = [150.0, 200.0, 250.0, 400.0, 500.0, 550.0, 600.0, 650.0, 700.0, 800.0, 850.0, 900.0, 950.0, 1000.0, 1050.0, 1100.0, 1200.0];
pars_to_fit[2] = "Gamma1";
vals_to_fit[2] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9, 3.1];
pars_to_fit[3] = "Gamma2";
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9, 3.1];
pars_to_fit[4] = "x";
vals_to_fit[4] = [0.0, 1.0, 2.0, 3.0];
pars_to_fit[5] = "b";
vals_to_fit[5] = [1.0, 2.0, 3.0];
pars_to_fit[6] = "h1";
vals_to_fit[6] = [2.0];
pars_to_fit[7] = "h2";
vals_to_fit[7] = [3.0];
#+END_EXAMPLE

Submit scripts
#+BEGIN_EXAMPLE
sbatch 1H0707-submit-lag-freq.sh h <<<<<<<<<<<<< 0930 16 Aug  >>>>>>>>>>>>>>>>
Submitted batch job 2275598
sacct -j 2275598

python find-best-fit-1H0707-2008.py
Best fit is 14.50785 in file 1H0707_2008_best_fit_03.txt

So once again it appears to be getting stuck around 14.50785 with pars:

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      1.31381e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.388266           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.1           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               40           0           0

python find-best-fit-1H0707-2008.py

SCRIPT FAILED AGAIN - Reason:

Lets have a look at one of the output file:

emacs slurm-2275598_8.out

>>>>>>>>>>>>>> Lots of lag files do not exist!!i.e:
File lag-files/i53/a0.998/h02.0+03.0/g1.4+2.8/A01.0/x0.0/p00.0/b01.0/q0.5/tmax0150/tshift0070/lag.fits does not exist

>>>>>>>>>>>>>> Finally:

   ...command to execute is ./code-x -i53.0 -a0.998 -h3.0 -g2.8 -A1.0 -x0.0 -p0.0
sh: ./code-x: No such file or directory

FITSIO status = 104: could not open the named file
failed to find or open the following file: (ffopen)
/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/code-x-files/i53/a0.
998/h03.0/g2.8/A1.0/x0.0/p00.0/rev.fits
h1=2 h2=3 i=53 g1=1p4 g2=2p8 A=1 x=0 p=0 rs1=1 rs2=1 b=1 w=0p5 v=150 q=70
failed to find or open the following file: (ffopen)
/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation//lag-files/i53/a0.99
8/h02.0+03.0/g1.4+2.8/A01.0/x0.0/p00.0/b01.0/q0.5/tmax0150/tshift0070/lag.fits
could not open the named file: /mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation//lag-files/i53/a0.998/h02.0+03.0/g1.4+2.8/A01.0/x0.0/\
p00.0/b01.0/q0.5/tmax0150/tshift0070/lag.fits^M
/mnt/storage/scratch/so14935/isis/1.6.2/share/fits.sl:123:fits_check_error:Fits Error
Error: function evaluation failed^M
Traceback: _mode_switch
Traceback: _fit

python find-best-fit-1H0707-2008.py
Best fit is 14.1114 in file 1H0707_2008_best_fit_03.txt

The code has not got any better fits to use

CONCLUSION - The lag files are not being created
#+END_EXAMPLE

>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

Okay - lets test using 100 submission:

#+BEGIN_EXAMPLE
#! /bin/tcsh
#
#SBATCH --partition=serial
#SBATCH --nodes=1
#SBATCH --ntasks-per-node=1
#SBATCH --mem=4GB
#SBATCH --time=3-0:00:00
#SBATCH --job-name=lag-freq
#SBATCH --array=0-99

## Note that array should be from 0 to (n-1) and isis-script should be run with n at the end

module load CUDA
module load cURL

cd /mnt/storage/scratch/${LOGNAME}/x-ray-rev2/x-ray-reverberation

isis-script 1H0707-2008-lag-freq-fits.sl fit $SLURM_ARRAY_TASK_ID 100

sbatch 1H0707-submit-lag-freq.sh    <<< 3pm 24 Aug  >>>>

Submitted batch job 2297772
[so14935@bc4gpulogin1 x-ray-reverberation]$ sacct -j 2297772
       JobID    JobName  Partition    Account  AllocCPUS      State ExitCode
------------ ---------- ---------- ---------- ---------- ---------- --------
2297772_[0-+   lag-freq     serial    default          1    PENDING      0:0


python find-best-fit-1H0707-2008.py
Best fit is 9.590521 in file 1H0707_2008_best_fit_16.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.051151e-05           0           1
  2  lag_freq(1).log_mass   0     0          6.15366           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               65           0           0

------------------------------------------------------------------------------

python find-best-fit-1H0707-2008.py
Best fit is 9.161214 in file 1H0707_2008_best_fit_25.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.846014e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.113123           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               70           0           0

------------------------------------------------------------------------------

python find-best-fit-1H0707-2008.py
Best fit is 7.446232 in file 1H0707_2008_best_fit_19.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.084044e-05           0           1
  2  lag_freq(1).log_mass   0     0         7.827615           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              150           0           0
 15  lag_freq(1).t_shift    0     1               60           0           0

1H0707-495_2008_ecm.pdf

#+END_EXAMPLE


#+BEGIN_EXAMPLE

#+END_EXAMPLE

#+BEGIN_EXAMPLE

#+END_EXAMPLE

#+BEGIN_EXAMPLE


#+END_EXAMPLE

*** 2010 lags

ATH =/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/1H0707-495-time-lag-fits/1H0707-495-2010-time-lags.fits/=

USE =1H0707-2010-lag-fits.sl=

To find best fit use =find-best-fit-1H0707-2010.py=

#+BEGIN_EXAMPLE
python find-best-fit-1H0707-2010.py
Best fit is 4.78952 1H0707-495_2010_best_fit_03.par

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.175941e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.009422           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              650           0           0
 15  lag_freq(1).t_shift    0     1              100           0           0

#+END_EXAMPLE

Copy files acros to Lyra e.g:

#+BEGIN_EXAMPLE
scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/1H0707-495_2010_best_fit_09.par .
scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/1H0707-495_2010_best_fit_09.ps .

Explicitly Rename files:
mv 1H0707-495_2010_best_fit_09.par 1H0707-495_2010_best_fit_09-stat-5.926.par
ps2pdf 1H0707-495_2010_best_fit_09.ps 1H0707-495_2010_best_fit_09-stat-5.926.pdf
#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_2010_best_fit.png


RUN AGAIN

#+BEGIN_EXAMPLE
Submitted batch job 2261435

sacct -j 2261435

Best fit is 2.962783 in file 1H0707_2010_best_fit_01.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     6.980445e-05           0           1
  2  lag_freq(1).log_mass   0     0                6           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              2.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0

#+END_EXAMPLE

And again:

#+BEGIN_EXAMPLE
python find-best-fit-1H0707-2010.py
Best fit is 2.592449 in file 1H0707_2010_best_fit_07.txt

 Parameters[Variable] = 15[2]
            Data bins = 7
           Chi-square = 2.592449
   Reduced chi-square = 0.5184897

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     6.128698e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.131576           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               25           0           0
#+END_EXAMPLE

Make a nice plot of this fit:

USE =replot-best-lag-freq-fits_1H0707_2010.sl=

MAke sure to edit for the correct par file and provide graph ranges
and output ps filename

#+BEGIN_EXAMPLE
isis replot-best-lag-freq-fits_1H0707_2010.sl fit plot

 Parameters[Variable] = 15[2]
            Data bins = 7
           Chi-square = 2.592449
   Reduced chi-square = 0.5184897

list_par;
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     6.128698e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.131576           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               25           0           0

This is correct as the best fit found above!!
#+END_EXAMPLE

In Lyra - copy the par and ps files, e.g:

#+BEGIN_EXAMPLE
scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/1H0707_2010_ecm.ps .
#+END_EXAMPLE

Create pdf and load up to WWW directory! Done! :)

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_2010_ecm.png

*** Grp1 lags

Note this is very similar to the 2008 lag-freq above

USE =1H0707-Grp1-lag-fits.sl=

#+BEGIN_EXAMPLE
sacct -j 2261563
#+END_EXAMPLE

#+BEGIN_EXAMPLE
python find-best-fit-1H0707-Grp1.py
Best fit is 3.724334 in file 1H0707_Grp1_best_fit_00.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.172635e-05           0           1
  2  lag_freq(1).log_mass   0     0                6           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.7           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0
#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_Grp1_ecm.png

Run again

#+BEGIN_EXAMPLE
python find-best-fit-1H0707-Grp1.py
Best fit is 3.478815 in file 1H0707_Grp1_best_fit_14.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.600447e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.060322           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               75           0           0
#+END_EXAMPLE

Replot by editing  =replot-best-lag-freq-fits_1H0707_Grp1.sl=

#+BEGIN_EXAMPLE
isis replot-best-lag-freq-fits_1H0707_Grp1.sl fit plot

 Parameters[Variable] = 15[2]
            Data bins = 7
           Chi-square = 3.478815
   Reduced chi-square = 0.6957631

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.600447e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.060322           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               75           0           0
#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_Grp1_ecm.png

*** Grp2 lags

USE =1H0707-495-Grp2-lag-fits.sl=

#+BEGIN_EXAMPLE
sbatch submit-1H0707-Grp2-lag-freq.sh
Submitted batch job 2257293  <<<<<<<<<<<<<<<<< 3.05 pm 2 Aug 19 >>>>>>>>>>>>>>>>

sacct -j 2257293
#+END_EXAMPLE


#+BEGIN_EXAMPLE
python find-best-fit-1H0707-Grp2.py
Best fit is 0.6473571 in file 1H0707-495_Grp2_best_fit_01.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.434545e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.174673           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                3           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1                2           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              750           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0
#+END_EXAMPLE

Files saved in =/homeb/steff075/phd_ecm/1h0707/extended-corona=

#+BEGIN_EXAMPLE
1H0707-495_Grp2_best_fit_01.par
1H0707-495_Grp2_ecm.pdf
1H0707-495_Grp2_ecm.ps
#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_Grp2_ecm.png


Try again:

#+BEGIN_EXAMPLE
sbatch 1H0707-submit-lag-freq.sh
Submitted batch job 2264353   <<<<<<<   1400 6 Aug  >>>>>>>>>

sacct -j 2264353

 python find-best-fit-1H0707-Grp2.py
Best fit is 4.070063 in file 1H0707_Grp2_best_fit_14.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.392516e-05           0           1
  2  lag_freq(1).log_mass   0     0                6           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.7           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               75           0           0


Can I improve this?
#+END_EXAMPLE

#+BEGIN_EXAMPLE
sbatch 1H0707-submit-lag-freq.sh
Submitted batch job

sacct -j 2264838

python find-best-fit-1H0707-Grp2.py
Best fit is 4.640629 in file 1H0707_Grp2_best_fit_28.txt

No improvement found!!!
#+END_EXAMPLE


And again
#+BEGIN_EXAMPLE
sbatch 1H0707-submit-lag-freq.sh   <<<<<<<<<<< 1045 12 Aug >>>>>>>>>>>>>>>>>>
Submitted batch job 2270606

sacct -j 2270606

python find-best-fit-1H0707-Grp2.py
Best fit is 7.745358 in file 1H0707_Grp2_best_fit_10.txt
#+END_EXAMPLE

*** Grp3 lags

USE =1H0707-495-Grp3-lag-fits.sl=

#+BEGIN_EXAMPLE
sbatch submit-1H0707-Grp3-lag-freq.sh

python find-best-fit-1H0707-Grp3.py
Best fit is 5.323314 in file 1H0707_Grp3_best_fit_05.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     9.979776e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.255144           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               25           0           0
#+END_EXAMPLE

Replot and save pdf - USE =replot-best-lag-freq-fits_1H0707_Grp3.sl=

#+BEGIN_EXAMPLE
isis replot-best-lag-freq-fits_1H0707_Grp3.sl fit plot

 Parameters[Variable] = 15[2]
            Data bins = 7
           Chi-square = 5.323314
   Reduced chi-square = 1.064663

isis> list_par;
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     9.979776e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.255144           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               25           0           0
#+END_EXAMPLE

Copy pdf to Lyra:

#+BEGIN_EXAMPLE
scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/1H0707-495_Grp3_ecm.ps .
#+END_EXAMPLE

Run again - extend $t_{\text{max}} < 250$ and $t_{\text{shift}} < 25$

#+BEGIN_EXAMPLE
batch 1H0707-submit-lag-freq.sh
Submitted batch job 2272809 <<<<<<<<<<<<<< 1100 14 Aug >>>>>>>>>>>>>>>>>>>

sacct -j 2272809

python find-best-fit-1H0707-Grp3.py
Best fit is 4.234678 in file 1H0707_Grp3_best_fit_17.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001201121           0           1
  2  lag_freq(1).log_mass   0     0         6.244905           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0


python find-best-fit-1H0707-Grp3.py
Best fit is 2.850826 in file 1H0707_Grp3_best_fit_02.txt
emacs 1H0707_Grp3_best_fit_02.par
 Parameters[Variable] = 15[2]
            Data bins = 7
           Chi-square = 2.850834
   Reduced chi-square = 0.5701669

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001202876           0           1
  2  lag_freq(1).log_mass   0     0         6.244736           6           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0
#+END_EXAMPLE

Replot the best fit

#+BEGIN_EXAMPLE
isis replot-best-lag-freq-fits_1H0707_Grp3.sl fit plot
#+END_EXAMPLE

Copy pdf to Lyra:

#+BEGIN_EXAMPLE
scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/1H0707-495_Grp3_ecm.ps .
#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_Grp3_ecm.png

*** Results

PATH =/homeb/steff075/phd_ecm/1h0707/extended-corona/1h0707-ecm1.xlsx=

#+CAPTION: 1H0707-495 ECM results
#+ATTR_HTML: border="2" rules="all" frame="border"
+--------------+-------+-----+-----+--------+--------+-----+-----+-----+-----+-----+-------+--------+-------+
| Observations | chi^2 |  h1 |  h2 | Gamma1 | Gamma2 |  Fe |  xi |   p |   b |  q2 |  tmax | tshift | log M |
+--------------+-------+-----+-----+--------+--------+-----+-----+-----+-----+-----+-------+--------+-------+
| lo-flux      |  2.85 | 2.0 | 3.0 |    2.7 |    2.3 | 1.0 | 0.0 | 0.0 | 1.0 | 0.5 | 200.0 |   10.0 |  6.24 |
+--------------+-------+-----+-----+--------+--------+-----+-----+-----+-----+-----+-------+--------+-------+
| lo-flux (FM) |  5.89 | 2.0 | 3.0 |    3.1 |    2.7 | 1.0 | 1.0 | 0.0 | 1.0 | 0.5 | 175.0 |   10.0 |  6.31 |
+--------------+-------+-----+-----+--------+--------+-----+-----+-----+-----+-----+-------+--------+-------+
| hi-flux      |  2.79 | 2.0 | 3.0 |    2.7 |    2.6 | 1.0 | 3.0 | 0.0 | 2.0 | 0.5 | 550.0 |   85.0 |  6.05 |
+--------------+-------+-----+-----+--------+--------+-----+-----+-----+-----+-----+-------+--------+-------+
| hi-flux (FM) |  9.67 | 2.0 | 3.0 |    2.2 |    1.9 | 1.0 | 1.0 | 0.0 | 2.0 | 0.5 | 300.0 |   50.0 |  6.31 |
+--------------+-------+-----+-----+--------+--------+-----+-----+-----+-----+-----+-------+--------+-------+
| Combined     |  2.63 | 2.0 | 3.0 |    1.7 |    1.5 | 1.0 | 3.0 | 0.0 | 2.0 | 0.5 | 500.0 |   80.0 |  6.09 |
+--------------+-------+-----+-----+--------+--------+-----+-----+-----+-----+-----+-------+--------+-------+
| 2007         |  1.92 | 2.0 | 3.0 |    2.4 |    1.5 | 1.0 | 1.0 | 0.0 | 1.0 | 0.5 | 800.0 |  150.0 |  6.14 |
+--------------+-------+-----+-----+--------+--------+-----+-----+-----+-----+-----+-------+--------+-------+
| 2008         |  7.45 | 2.0 | 3.0 |    1.8 |    2.5 | 1.0 | 3.0 | 0.0 | 3.0 | 0.5 | 150.0 |   60.0 |  7.83 |
+--------------+-------+-----+-----+--------+--------+-----+-----+-----+-----+-----+-------+--------+-------+
| 2010         |  2.59 | 2.0 | 3.0 |    2.6 |    2.3 | 1.0 | 3.0 | 0.0 | 3.0 | 0.5 | 250.0 |   25.0 |  6.13 |
+--------------+-------+-----+-----+--------+--------+-----+-----+-----+-----+-----+-------+--------+-------+
| Grp1         |  3.48 | 2.0 | 3.0 |    2.4 |    2.2 | 1.0 | 0.0 | 0.0 | 1.0 | 0.5 | 400.0 |   75.0 |  6.06 |
+--------------+-------+-----+-----+--------+--------+-----+-----+-----+-----+-----+-------+--------+-------+
| Grp2         |  0.65 | 3.0 | 4.0 |    2.0 |    1.7 | 1.0 | 0.0 | 0.0 | 3.0 | 0.5 | 750.0 |   50.0 |  6.17 |
+--------------+-------+-----+-----+--------+--------+-----+-----+-----+-----+-----+-------+--------+-------+
| Grp3         |  2.85 | 2.0 | 3.0 |    2.7 |    2.3 | 1.0 | 0.0 | 0.0 | 1.0 | 0.5 | 200.0 |   10.0 |  6.24 |
+--------------+-------+-----+-----+--------+--------+-----+-----+-----+-----+-----+-------+--------+-------+

----------------------------------------------------------------------------------------------------------------------------------------------------------------

Plot file
=/homeb/steff075/phd_ecm/1h0707/extended-corona/1H0707-ecm-Gamma-V-tmax.vsz=

( reload the csv if changed! )
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495-ECM-results-1-Gamma1-tmax.png


Plot file =/homeb/steff075/phd_ecm/1h0707/extended-corona/1H0707-ecm-Gamma-V-tshift.vsz=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495-ECM-results-1-Gamma2-tmax.png

Plot file =/homeb/steff075/phd_ecm/1h0707/extended-corona/1H0707-ecm-tmax-V-tshift.vsz=
#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495-ECM-results-1-tshift-tmax.png

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495-ECM-results-1-tlags-tshift.png

** *1H0707-495 New model (since June 2020)*
*** Testing the code

The following scripts have been updated for fixed source height 1 =
2r_g and using delta-gamma where gamma1 = 2.0 (fixed)

=submit-blob-delta.pl=, =submit-blob.pl=

And then once lag files have been obtained fit the model using the new fitting script =fit-and-error.sl=

PATH
=/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/fit-and-error.sl=

*Testing the updated code*

#+BEGIN_EXAMPLE
First note that the original par range is:

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.2]; % Gamma1
vals_to_fit[3] = [1.7, 1.8, 1.9, 2.0, 2.1]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.0, 100.0, 150.0, 200.0, 250.0, 300.0, 350.0, 400.0, 450.0, 500.0, 550.0, 600.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [10.0, 20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0]; % t_shift

isis-script fit-and-error.sl fit plot

where variable obs_id = steff_test


Time taken = 5 mins

Obsid steff_test
chi^2 = 3.796077e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+3.482624e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+8.661712e-03 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+6.948219e+01 -2.395005e+02)
Parameter t_shift = 9.000000e+01 (+6.405703e+00 -6.790010e+01)

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.930417e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.001907           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               90           0           0

##### Convert ps to png and rotate #######

convert -rotate "90" steff_test_best_fit.ps steff_test_best_fit.png

display steff_test_best_fit.png

##### Pull into Lyra WWW (from Lyra) #####

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/steff_test_best_fit.png /home/WWW/steff/ecm


#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/steff_test_best_fit.png

########################################################################################################

This method is good, lets try some fitting by exploring different
par ranges::

*A good parameter start range*

We dont know what the pars will be so lets make them wide to begin
with:

#+BEGIN_EXAMPLE
vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.8]; % Gamma1
vals_to_fit[3] = [1.4, 1.6, 1.8, 2.0, 2.2, 2.4, 2.6]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 200.0, 250.0, 300.0, 350.0, 400.0, 450.0, 500.0, 600.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [10.0, 20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0, 120.0]; % t_shift
#+END_EXAMPLE

*** *Combined variable mass fits*

My Edited code for 1H0707-495  combined fitting is
=1H0707-495-fit-error.sl=

#+BEGIN_EXAMPLE
isis 1H0707-495-fit-error.sl

pars to fit are:

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.8]; % Gamma1
vals_to_fit[3] = [1.2, 1.4, 1.5, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.0, 100.0, 150.0, 200.0, 250.0, 275.0, 300.0, 325.0, 350.0, 375.0, 400.0, 425.0, 450.0, 500.0, 550.0, 600.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [10.0, 20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0]; % t_shift

Time started 1654 - 1708 = 14 mins - too long!!!!

Obsid 1H0707_combined
chi^2 = 4.041014e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+4.137092e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+2.347539e-02 -1.349442e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+9.771418e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.750000e+02 (+1.281240e+02 -8.810525e+01)
Parameter t_shift = 7.000000e+01 (+1.508536e+01 -3.010211e+01)

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.967537e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.088944           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              375           0           0
 15  lag_freq(1).t_shift    0     1               70           0           0

............................................................................

Fit:

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.2]; % Gamma1
vals_to_fit[3] = [1.7, 1.8, 1.9, 2.0, 2.1]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.0, 100.0, 150.0, 200.0, 250.0, 275.0, 300.0, 325.0, 350.0, 375.0, 400.0, 425.0, 450.0, 500.0, 550.0, 600.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [10.0, 20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0]; % t_shift
variable fit_stats;

Time taken = 10 mins

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.070505e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.146918           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               70           0           0

Obsid 1H0707_combined
chi^2 = 3.212142e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+4.321938e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+1.257256e-02 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+7.920276e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+8.561380e+01 -1.500102e+02)
Parameter t_shift = 7.000000e+01 (+2.502340e+01 -4.952120e+01)

......................................................................

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.2]; % Gamma1
vals_to_fit[3] = [1.7, 1.8, 1.9, 2.0, 2.1]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.0, 100.0, 150.0, 175.0, 200.0, 225.0, 250.0, 275.0, 300.0, 325.0, 350.0, 375.0, 400.0, 425.0, 450.0, 475.0, 500.0, 550.0, 600.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [10.0, 20.0, 25.0, 30.0, 40.0, 45.0, 50.0, 60.0, 70.0, 75.0, 80.0, 90.0, 100.0]; % t_shift


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.070505e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.146918           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               70           0           0


Obsid 1H0707_combined
chi^2 = 3.212142e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+4.321938e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+1.257256e-02 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+4.187567e-01 -1.500102e+02)
Parameter t_shift = 7.000000e+01 (+2.502340e+01 -4.418590e+01)

...........................................................................

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.8]; % Gamma1
vals_to_fit[3] = [1.7, 1.8, 1.9, 2.0, 2.2, 2.4, 2.6, 2.7]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.0, 100.0, 150.0, 175.0, 200.0, 225.0, 250.0, 275.0, 300.0, 325.0, 350.0, 375.0, 400.0, 425.0, 450.0, 475.0, 500.0, 550.0, 600.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [10.0, 20.0, 25.0, 30.0, 40.0, 45.0, 50.0, 60.0, 70.0, 75.0, 80.0, 90.0, 100.0]; % t_shift

Note the very close MASS FITTING with this range (during fitting procedure) :

Improved fit...
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.238972e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.304013           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0
Improved fit...
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.144607e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.303457           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


>>>>>>>>>>>.    Note that better fits were at:

Improved fit...
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.967537e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.088944           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              375           0           0
 15  lag_freq(1).t_shift    0     1               70           0           0
Improved fit...
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.888982e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.055018           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               75           0           0


Is leaving t_max and t_shift at large values making the fitting poorer?????????

Final best fit was


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.888982e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.055018           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               75           0           0


Obsid 1H0707_combined
chi^2 = 3.940847e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+3.067192e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+0.000000e+00 -3.971832e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+9.430320e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+5.039767e+01 -1.190327e+02)
Parameter t_shift = 7.500000e+01 (+9.893566e+00 -3.556046e+01)
#+END_EXAMPLE

Try to leave T-shift and t-max at 10 - 50 and 50 - 500
respectively????

#+BEGIN_EXAMPLE
vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.6]; % Gamma1
vals_to_fit[3] = [1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.0, 100.0, 150.0, 175.0, 200.0, 225.0, 250.0, 275.0, 300.0, 325.0, 350.0, 375.0, 400.0, 425.0, 450.0, 475.0, 500.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [10.0, 15.0, 20.0, 25.0, 30.0, 40.0, 45.0, 50.0, 60.0, 70.0, 75.0, 80.0, 90.0, 100.0]; % t_shift

isis-script 1H0707-495-fit-error.sl fit plot

Running time  2113 - 2155 = 42 mins


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.161279e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.087037           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              375           0           0
 15  lag_freq(1).t_shift    0     1               70           0           0


Obsid 1H0707_combined
chi^2 = 3.461266e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+3.817334e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+1.975066e-02 -2.123946e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.750000e+02 (+7.537253e+01 -9.190547e+01)
Parameter t_shift = 7.000000e+01 (+1.700826e+01 -3.421262e+01)

................................................................


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.8]; % Gamma1
vals_to_fit[3] = [1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.0, 100.0, 150.0, 175.0, 200.0, 225.0, 250.0, 275.0, 300.0, 325.0, 350.0, 375.0, 400.0, 425.0, 450.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [10.0, 15.0, 20.0, 25.0, 30.0, 40.0, 45.0, 50.0, 60.0, 70.0, 75.0, 80.0, 90.0, 100.0]; % t_shift

run time 22.04 - 2335 = 91

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.888982e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.055018           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               75           0           0

Obsid 1H0707_combined
chi^2 = 3.940847e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+3.067192e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+2.220082e-02 -1.617850e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+9.430320e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+0.000000e+00 -1.140898e+02)
Parameter t_shift = 7.500000e+01 (+9.893566e+00 -3.556046e+01)

...................................................................

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.2]; % Gamma1
vals_to_fit[3] = [1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [200.0, 250.0, 280.0, 300.0, 310.0, 320.0, 330.0, 350.0, 360.0, 390.0, 375.0, 400.0, 420.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [10.0, 15.0, 20.0, 25.0, 30.0, 40.0, 45.0, 50.0, 60.0, 65.0, 70.0, 75.0, 80.0, 90.0, 100.0]; % t_shift

run time 2340 - 0023 = 45 mins


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.348337e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.069896           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              390           0           0
 15  lag_freq(1).t_shift    0     1               75           0           0

Obsid 1H0707_combined
chi^2 = 3.533971e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+3.187478e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+6.306611e-03 -4.672782e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.745136e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.900000e+02 (+1.033031e+01 -2.949649e+01)
Parameter t_shift = 7.500000e+01 (+8.899434e+00 -4.529401e+01)

...................................................................

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [3.0]; % Gamma1
vals_to_fit[3] = [2.0, 2.2, 2.4, 2.6, 2.8]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [200.0, 250.0, 280.0, 300.0, 310.0, 320.0, 330.0, 350.0, 360.0, 390.0, 375.0, 400.0, 420.0]; % t_max (zero doesn'\
t seem to work)
vals_to_fit[10] = [10.0, 15.0, 20.0, 25.0, 30.0, 40.0, 45.0, 50.0, 60.0, 65.0, 70.0, 75.0, 80.0, 90.0, 100.0]; % t_shift

run time  0039 - 0057 = 18 mins

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.174909e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.106428           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              350           0           0
 15  lag_freq(1).t_shift    0     1               65           0           0

Obsid 1H0707_combined
chi^2 = 3.767044e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+4.771583e+00 -0.000000e+00)
Parameter Gamma1 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.800000e+00 (+0.000000e+00 -3.832505e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+4.068965e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.500000e+02 (+1.680800e-01 -1.966384e+01)
Parameter t_shift = 6.500000e+01 (+1.708065e+01 -3.119264e+01)

.................................................................

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.0]; % Gamma1
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [200.0, 250.0, 280.0, 300.0, 310.0, 320.0, 330.0, 350.0, 360.0, 390.0, 375.0, 400.0, 420.0]; % t_max (zero doesn'\
t seem to work)
vals_to_fit[10] = [10.0, 15.0, 20.0, 25.0, 30.0, 40.0, 45.0, 50.0, 60.0, 65.0, 70.0, 75.0, 80.0, 90.0, 100.0]; % t_shift


start 0117 - 0152 = 35

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      3.09718e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.057861           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1                2           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0



Obsid 1H0707_combined
chi^2 = 3.276891e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+3.598067e+00 -0.000000e+00)
Parameter Gamma1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.700000e+00 (+1.029176e-01 -1.110713e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.367947e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+3.351397e-01 -3.957340e+01)
Parameter t_shift = 8.000000e+01 (+4.855638e+00 -4.110713e+01)


Can I lower Gamma1 any further????

.......................................................................

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [1.9]; % Gamma1
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [200.0, 250.0, 280.0, 300.0, 310.0, 320.0, 330.0, 350.0, 360.0, 390.0, 375.0, 400.0, 420.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [10.0, 15.0, 20.0, 25.0, 30.0, 40.0, 45.0, 50.0, 60.0, 65.0, 70.0, 75.0, 80.0, 90.0, 100.0]; % t_shift


run time 1307 - 1332 = 25

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.158629e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.064464           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.9           0           0
  8  lag_freq(1).Gamma2     0     1              1.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              390           0           0
 15  lag_freq(1).t_shift    0     1               75           0           0

Obsid 1H0707_combined
chi^2 = 3.490262e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+2.395205e+00 -0.000000e+00)
Parameter Gamma1 = 1.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.600000e+00 (+1.022173e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.316749e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.900000e+02 (+1.031058e+01 -2.949663e+01)
Parameter t_shift = 7.500000e+01 (+1.011893e+01 -3.762676e+01)

.........................................................................

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.4]; % Gamma1
vals_to_fit[3] = [1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 200.0, 250.0, 280.0, 300.0, 310.0, 320.0, 330.0, 350.0, 360.0, 390.0, 375.0, 400.0, 450.0, 500.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [10.0, 15.0, 20.0, 25.0, 30.0, 40.0, 45.0, 50.0, 60.0, 65.0, 70.0, 75.0, 80.0, 90.0, 100.0, 200.0, 300.0]; % t_shift


run time = 1343 - 1457 = 74 mins

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.493759e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.059554           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               75           0           0

Obsid 1H0707_combined
chi^2 = 3.115662e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+4.733362e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+1.473957e-02 -2.940316e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+0.000000e+00 -3.953318e+01)
Parameter t_shift = 7.500000e+01 (+2.057462e+01 -4.915221e+01)

...................................................................................

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.6]; % Gamma1
vals_to_fit[3] = [1.5, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 200.0, 250.0, 280.0, 300.0, 310.0, 320.0, 330.0, 350.0, 360.0, 390.0, 375.0, 400.0, 450.0, 500.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [10.0, 15.0, 20.0, 25.0, 30.0, 40.0, 45.0, 50.0, 60.0, 65.0, 70.0, 75.0, 80.0, 90.0, 100.0, 200.0, 300.0]; % t_shift

run time = 1503 - 1556 = 53

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.161279e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.087037           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              375           0           0
 15  lag_freq(1).t_shift    0     1               70           0           0


chi^2 = 3.461266e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+3.817334e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+1.975066e-02 -1.689554e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.750000e+02 (+0.000000e+00 -1.456546e+01)
Parameter t_shift = 7.000000e+01 (+1.699203e+01 -3.501687e+01)

....................................................................

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.3]; % Gamma1
vals_to_fit[3] = [1.5, 1.7 ,1.8, 1.9, 2.0, 2.1, 2.2]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [300.0, 310.0, 320.0, 330.0, 350.0, 360.0, 390.0, 400.0, 410.0, 420.0, 430.0,450.0, 500.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [10.0, 15.0, 20.0, 25.0, 30.0, 40.0, 45.0, 50.0, 60.0, 65.0, 70.0, 75.0, 80.0, 90.0, 100.0, 200.0, 300.0]; % t_shift

run time  1613 - 1630 = 17 mins

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.781929e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.039933           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              2.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              410           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0

Obsid 1H0707_combined
chi^2 = 3.409300e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+2.417302e+00 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.100000e+00 (+1.170610e-02 -1.284959e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.100000e+02 (+1.677074e-01 -4.958280e+01)
Parameter t_shift = 8.000000e+01 (+1.503962e+01 -4.724646e+01)

...........................................................................


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.2]; % Gamma1
vals_to_fit[3] = [1.3, 1.4, 1.5, 1.6, 1.7 ,1.8, 1.9, 2.0, 2.1]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [300.0, 320.0, 340.0, 350.0, 360.0, 370.0, 380.0, 390.0, 400.0, 410.0, 420.0, 430.0,450.0, 470.0, 500.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [10.0, 15.0, 20.0, 25.0, 30.0, 40.0, 45.0, 50.0, 60.0, 65.0, 70.0, 75.0, 80.0, 85.0, 90.0, 95.0, 100.0, 200.0]; % t_shift


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.070505e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.146918           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               70           0           0


Obsid 1H0707_combined
chi^2 = 3.212142e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+4.321938e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+8.502784e-03 -2.904810e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+3.350054e-01 -1.966499e+01)
Parameter t_shift = 7.000000e+01 (+2.627954e+01 -3.931698e+01)


run time  1638 - 1700 = 22 mins

...........................................................................

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.2]; % Gamma1
vals_to_fit[3] = [1.3, 1.4, 1.5, 1.6, 1.7 ,1.8, 1.9, 2.0, 2.1]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [300.0, 400.0, 500.0, 600.0, 700.0, 800.0, 900.0, 1000.0]; % t_max
vals_to_fit[10] = [10.0, 50.0, 100.0, 150.0, 200.0, 250.0, 300.0, 350.00, 400.0, 450.0, 0.0]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     6.162845e-05           0       0.001
  2  lag_freq(1).log_mass   0     0                6           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0

Obsid 1H0707_combined
chi^2 = 4.337589e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+2.184574e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+8.814498e-03 -1.088036e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -7.297943e-02)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+5.144000e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+7.347574e+01 -7.297943e+00)
Parameter t_shift = 5.000000e+01 (+3.673787e+01 -2.570500e+01)

run time 2 mins

......................................................................

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [1.7]; % Gamma1
vals_to_fit[3] = [1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 2.0, 2.2]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [300.0, 320.0, 340.0, 350.0, 360.0, 370.0, 380.0, 390.0, 400.0, 410.0, 420.0, 430.0, 450.0, 470.0, 500.0, 550.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [10.0, 15.0, 20.0, 25.0, 30.0, 35.0, 40.0, 45.0, 50.0, 55.0, 60.0, 65.0, 70.0, 75.0, 80.0, 85.0, 90.0, 95.0, 100.0, 150.0]; % t_shift

run time 1714 - 1739 = 26

Obsid 1H0707_combined
chi^2 = 3.738822e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+2.054116e+00 -0.000000e+00)
Parameter Gamma1 = 1.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.400000e+00 (+1.042502e-01 -9.831949e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+2.228864e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.768707e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+4.748843e+00 -7.741153e+00)
Parameter t_shift = 5.000000e+01 (+3.408501e-01 -1.241897e+00)

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.123294e-05           0       0.001
  2  lag_freq(1).log_mass   0     0                6           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.7           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0

.........................................................................................


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.2]; % Gamma1
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [300.0, 320.0, 340.0, 350.0, 360.0, 370.0, 380.0, 390.0, 400.0, 410.0, 420.0, 430.0, 440.0, 450.0, 460.0, 470.0, 480.0, 500.0, 550.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [30.0, 35.0, 40.0, 45.0, 50.0, 52.0, 55.0, 57.0, 60.0, 62.0, 65.0, 68.0, 70.0, 72.0, 75.0, 77.0, 80.0, 82.0, 85.0, 90.0, 95.0, 100.0, 150.0]; % t_shift


run time 1747 - 1754 = 7 min


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.086119e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.138121           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               72           0           0

Obsid 1H0707_combined
chi^2 = 2.977512e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+4.257373e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+1.114098e-02 -1.042599e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+1.672598e-01 -9.832740e+00)
Parameter t_shift = 7.200000e+01 (+3.029106e+00 -3.969404e+00)

################################################################
################################################################

Above fit could not be improved - try to adjust gamma2

################################################################
################################################################

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.1]; % Gamma1
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [300.0, 350.0, 370.0, 390.0, 400.0, 420.0, 430.0, 435.0, 440.0, 445.0, 448.0, 450.0, 452.0, 455.0, 460.0, 465.0, 470.0, 480.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [30.0,40.0, 45.0, 50.0, 55.0, 60.0, 64.0, 68.0, 69.0, 70.0, 72.0, 75.0, 77.0, 80.0, 82.0, 85.0, 90.0, 95.0]; % t_shift

run time 1835 -20 mins

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.418435e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.008885           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.1           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               85           0           0


Obsid 1H0707_combined
chi^2 = 3.124253e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+5.540919e-01 -0.000000e+00)
Parameter Gamma1 = 2.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.900000e+00 (+6.744192e-03 -2.719556e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.644725e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+3.348232e-02 -1.966518e+00)
Parameter t_shift = 8.500000e+01 (+8.800407e+00 -7.961268e+00)

.............................................................................

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.0]; % Gamma1
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [300.0, 350.0, 370.0, 390.0, 400.0, 420.0, 430.0, 435.0, 440.0, 445.0, 448.0, 449.0, 450.0, 451.0, 452.0, 455.0, 460.0, 465.0, 470.0, 480.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [30.0,40.0, 45.0, 50.0, 55.0, 60.0, 64.0, 68.0, 69.0, 70.0, 72.0, 75.0, 77.0, 80.0, 82.0, 84.0, 85.0, 86.0, 88.0, 90.0, 95.0]; % t_shift

run time 1905 - 1920 = 12

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.761554e-05           0       0.001
  2  lag_freq(1).log_mass   0     0          6.01264           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1                2           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               85           0           0



Obsid 1H0707_combined
chi^2 = 3.056220e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+3.466164e+00 -0.000000e+00)
Parameter Gamma1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+5.359195e-03 -2.242023e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.880509e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+1.673412e-02 -9.832659e-01)
Parameter t_shift = 8.500000e+01 (+1.673412e-02 -7.953829e+00)

.............................................................................

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.4]; % Gamma1
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [300.0, 350.0, 370.0, 390.0, 400.0, 420.0, 430.0, 435.0, 440.0, 445.0, 448.0, 449.0, 450.0, 451.0, 452.0, 455.0, 460.0, 465.0, 470.0, 480.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [30.0,40.0, 45.0, 50.0, 55.0, 60.0, 64.0, 68.0, 69.0, 70.0, 72.0, 75.0, 77.0, 80.0, 82.0, 84.0, 85.0, 86.0, 88.0, 90.0, 95.0]; % t_shift

run time start 1925 - 19 mins

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.359971e-05           0       0.001
  2  lag_freq(1).log_mass   0     0          6.00978           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               85           0           0

Obsid 1H0707_combined
chi^2 = 2.935429e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+2.389553e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+1.260819e-02 -1.717992e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.558419e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+1.672163e-02 -9.832784e-01)
Parameter t_shift = 8.500000e+01 (+1.672163e-02 -7.963017e+00)
#+END_EXAMPLE


Try to expand on Gamma values (that is - bigger step size between
gamma1 and gamma2

#+BEGIN_EXAMPLE
emacs 1H0707-495-fit-error.sl -nw

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.2]; % Gamma1
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [150.0, 200.0, 250.0, 300.0, 350.0, 400.0, 450.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [10.0, 20.0, 30.0,40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0]; % t_shift

sbatch 1H0707-submit-fit-error.sh
Submitted batch job 3895880

ag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.593593e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.181245           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                7           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0

Obsid 1H0707_combined
chi^2 = 5.745675e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 7.000000e+00 (+1.036243e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.700000e+00 (+0.000000e+00 -2.514608e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+7.171253e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.500000e+02 (+1.643714e+02 -1.243845e+01)
Parameter t_shift = 3.000000e+01 (+4.610188e+01 -2.487690e+00)

.....................................................................

1H0707-495-fit-error2.sl

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.6]; % Gamma1
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8, 2.0]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 150.0, 200.0, 250.0, 300.0, 350.0, 400.0, 450.0, 500.0]; % t_max (zero doesn't seem to \
work)
vals_to_fit[10] = [10.0, 20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0]; % t_shift

 sbatch 1H0707-submit-fit-error.sh
Submitted batch job 3899297

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.065859e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.339985           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Obsid 1H0707_comb2
chi^2 = 5.619268e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+3.332933e+00 -2.275522e-01)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+0.000000e+00 -4.440864e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+5.009943e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.000000e+02 (+8.093877e+01 -2.902689e+01)
Parameter t_shift = 2.000000e+01 (+1.618775e+01 -4.916095e+00)

........................................................
1H0707-495-fit-error.sl

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.2]; % Gamma1
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [150.0, 200.0, 250.0, 300.0, 350.0, 400.0, 450.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [10.0, 20.0, 30.0,40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.070505e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.146918           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               70           0           0


Obsid 1H0707_combined
chi^2 = 3.212142e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+4.321938e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+0.000000e+00 -3.489442e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+7.920276e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+0.000000e+00 -2.476060e+02)
Parameter t_shift = 7.000000e+01 (+2.447209e+01 -4.952120e+01)
..............................................................................

1H0707-495-fit-error.sl

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.289037e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.180705           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0

Obsid 1H0707_combined
chi^2 = 6.617924e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+2.112324e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+0.000000e+00 -1.613027e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.801628e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.500000e+02 (+4.018523e+01 -7.768547e+01)
Parameter t_shift = 3.000000e+01 (+5.599206e+00 -1.198372e+01)
..............................................................................

1H0707-495-fit-error2.sl

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.819136e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.018709           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                7           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0

Obsid 1H0707_comb2
chi^2 = 4.091109e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 7.000000e+00 (+1.172049e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+0.000000e+00 -1.208655e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+9.951433e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+1.509730e+02 -2.972787e+02)
Parameter t_shift = 8.000000e+01 (+5.181277e+00 -6.935185e+01)

---------------------------------------------------------------------------------

1H0707-495-fit-error.sl

FREEZE b = 2

Submitted batch job 3914478


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.070505e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.146918           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               70           0           0

Obsid 1H0707_combined
chi^2 = 3.212142e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.320162e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+8.406260e-03 -5.550614e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+4.237431e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+0.000000e+00 -9.832497e+00)
Parameter t_shift = 7.000000e+01 (+5.843983e+00 -1.915324e+01)

..........................................................................

1H0707-495-fit-error4.sl

Submitted batch job 3914496


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.375497e-05           0       0.001
  2  lag_freq(1).log_mass   0     0          6.03667           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              550           0           0
 15  lag_freq(1).t_shift    0     1               90           0           0


Obsid 1H0707_comb4
chi^2 = 2.153226e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+4.312348e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.700000e+00 (+0.000000e+00 -1.715521e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -3.867485e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+3.672567e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.500000e+02 (+5.029929e+01 -1.924572e+02)
Parameter t_shift = 9.000000e+01 (+1.292999e+01 -2.663180e+01)

.........................................................................

1H0707-495-fit-error3.sl

Submitted batch job 3914597

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.845314e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.054842           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.9           0           0
  8  lag_freq(1).Gamma2     0     1              2.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               75           0           0

Obsid 1H0707_comb3
chi^2 = 4.034271e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+3.039736e+00 -0.000000e+00)
Parameter Gamma1 = 2.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.700000e+00 (+0.000000e+00 -1.773260e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+7.731139e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.245797e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+5.572733e+01 -1.163315e+02)
Parameter t_shift = 7.500000e+01 (+8.766538e+00 -4.389424e+01)

...........................................................................

1H0707-495-fit-error2.sl

Submitted batch job 3914599


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.387889e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.029857           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              580           0           0
 15  lag_freq(1).t_shift    0     1               90           0           0

Obsid 1H0707_comb2
chi^2 = 2.137845e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+2.991740e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+0.000000e+00 -1.669156e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -3.959928e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+3.821845e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.800000e+02 (+2.030541e+01 -1.167759e+02)
Parameter t_shift = 9.000000e+01 (+1.283003e+01 -2.718241e+01)
...........................................................................

1H0707-495-fit-error.sl

Submitted batch job 3914914

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.131153e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.052443           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               70           0           0

Obsid 1H0707_combined
chi^2 = 4.561009e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+3.300084e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.500000e+00 (+0.000000e+00 -3.632096e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+3.517876e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.264191e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+7.250145e+01 -6.862177e+01)
Parameter t_shift = 7.000000e+01 (+1.501772e+01 -0.000000e+00)



...........................................................................

1H0707-495-fit-error2.sl


Submitted batch job 3914917

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      2.81801e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.018827           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                7           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0

Obsid 1H0707_comb2
chi^2 = 4.090978e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 7.000000e+00 (+1.079751e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+0.000000e+00 -4.838460e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+3.339311e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.244802e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+5.234439e+01 -1.235324e+02)
Parameter t_shift = 8.000000e+01 (+4.615490e+00 -0.000000e+00)


..........................................................................

1H0707-495-fit-error3.sl

Submitted batch job 3915023

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0       3.0107e-05           0       0.001
  2  lag_freq(1).log_mass   0     0                6           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                7           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0

Obsid 1H0707_comb3
chi^2 = 5.872305e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 7.000000e+00 (+7.304352e-01 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+0.000000e+00 -7.169190e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+1.703071e-02 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.175330e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.000000e+02 (+2.077853e+01 -0.000000e+00)
Parameter t_shift = 8.000000e+01 (+5.005026e+00 -3.230866e+00)


............................................................................

1H0707-495-fit-error4.sl

Submitted batch job 3915019

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.325912e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.060357           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              590           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0


Obsid 1H0707_comb4
chi^2 = 5.476740e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.594971e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+0.000000e+00 -3.306014e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -9.830116e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+1.190242e-01 -3.306014e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.900000e+02 (+8.494206e-02 -1.966023e+00)
Parameter t_shift = 8.000000e+01 (+3.264351e+00 -2.058468e+00)

........................................................................

1H0707-495-fit-error2.sl


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.9]; % Gamma1
vals_to_fit[3] = [2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [2.0,3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [450.0, 500.0, 575.0, 585.0, 590.0, 595.0, 600.0, 610.0, 620.0, 650.0, 680.0, 700.0, 750.0,\
 ]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [70.0, 80.0, 85.0, 88.0, 90.0, 91.0, 92.0, 95.0, 98.0, 100.0, 120.0, 140.0]; % t_shift

Submitted batch job 3915105

ag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.207653e-05           0       0.001
  2  lag_freq(1).log_mass   0     0          6.05941           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.9           0           0
  8  lag_freq(1).Gamma2     0     1              2.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              590           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0

Obsid 1H0707_comb2
chi^2 = 5.131197e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.038211e+00 -0.000000e+00)
Parameter Gamma1 = 2.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.800000e+00 (+0.000000e+00 -6.734214e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -9.830484e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+2.300379e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.900000e+02 (+8.475819e-02 -4.915242e+00)
Parameter t_shift = 8.000000e+01 (+3.328675e-01 -6.734214e+00)

....................................................................................


1H0707-495-fit-error.sl

Submitted batch job 3917888

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.704315e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         5.910162         5.9         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              550           0           0
 15  lag_freq(1).t_shift    0     1              100           0           0


Obsid 1H0707_combined
chi^2 = 4.256870e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.823449e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.700000e+00 (+0.000000e+00 -1.937579e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -9.831407e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+2.817653e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.500000e+02 (+2.515076e+01 -9.831407e+00)
Parameter t_shift = 1.000000e+02 (+3.371859e-01 -1.966281e+00)


.....................................................................................

1H0707-495-fit-error2.sl

Submitted batch job 3917896

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.325912e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.060357         5.9         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              590           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0


Obsid 1H0707_comb2
chi^2 = 5.476740e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.347906e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+1.819197e-03 -7.125856e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -9.830116e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+1.190242e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.900000e+02 (+8.494206e-02 -1.966023e+00)
Parameter t_shift = 8.000000e+01 (+3.375273e-01 -7.125856e+00)

......................................................................................

1H0707-495-fit-error.sl
Submitted batch job 3918023

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.7]; % Gamma1
vals_to_fit[3] = [1.9, 2.0, 2.2, 2.4, 2.5, 2.6]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0,3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [500.0, 540.0, 550.0, 560.0, 570.0, 580.0, 590.0, 600.0, 610.0, 620.0, 630.0]; % t_max (zero doesn't \
seem to work)
vals_to_fit[10] = [70.0, 80.0, 85.0, 88.0, 89.0, 90.0, 91.0, 92.0, 95.0, 98.0, 100.0, 105.0, 110.0, 120.0, 140.0]; % t\
_shift


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.325912e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.060357           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              590           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0

Obsid 1H0707_combined
chi^2 = 5.476740e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.594971e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+0.000000e+00 -3.306014e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -9.830116e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+1.377479e-01 -3.306014e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.900000e+02 (+2.014250e+01 -5.762375e+00)
Parameter t_shift = 8.000000e+01 (+3.264351e+00 -5.480164e+00)

.....................................................................................

1H0707-495-fit-error.sl

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.7]; % Gamma1
vals_to_fit[3] = [2.6]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [2.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [500.0, 540.0, 550.0, 560.0, 570.0, 580.0, 590.0, 600.0, 610.0, 620.0, 630.0]; % t_max (\
zero doesn't seem to work)
vals_to_fit[10] = [70.0, 80.0, 85.0, 88.0, 89.0, 90.0, 91.0, 92.0, 95.0, 98.0, 100.0, 105.0, 110.0, 120.0\
, 140.0]; % t_shift

Submitted batch job 3918031

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.325912e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.060357           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              590           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0


Obsid 1H0707_combined
chi^2 = 5.476740e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.347906e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.900000e+02 (+2.014250e+01 -5.762375e+00)
Parameter t_shift = 8.000000e+01 (+2.020572e-01 -7.746955e+00)

.....................................................................................

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      2.81801e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.018827         5.9         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                7           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0


Obsid 1H0707_comb2
chi^2 = 4.090978e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 7.000000e+00 (+2.076636e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+0.000000e+00 -7.781786e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+1.684189e-02 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.202191e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+1.400588e+02 -0.000000e+00)
Parameter t_shift = 8.000000e+01 (+4.615490e+00 -0.000000e+00)


#################################################################################
#################################################################################


#+END_EXAMPLE

###################
##################

Drop the mass value

##################

#+BEGIN_EXAMPLE

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.914458e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         5.888498         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              600           0           0
 15  lag_freq(1).t_shift    0     1              110           0           0

Obsid 1H0707_combined
chi^2 = 3.563578e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+2.675219e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+0.000000e+00 -1.597930e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -9.832132e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.068692e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.000000e+02 (+8.393393e-01 -5.975768e+01)
Parameter t_shift = 1.100000e+02 (+1.082016e+00 -0.000000e+00)

...........................................................................


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.876335e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         5.887749         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              600           0           0
 15  lag_freq(1).t_shift    0     1              110           0           0

Obsid 1H0707_combined
chi^2 = 3.590331e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+2.935182e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.700000e+00 (+0.000000e+00 -1.579353e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -9.832104e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.147989e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.000000e+02 (+8.394787e-01 -0.000000e+00)
Parameter t_shift = 1.100000e+02 (+1.085257e+00 -0.000000e+00)

...........................................................................................

1H0707-496-fit-error.sl

job 3919219

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.316555e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         5.891192         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              600           0           0
 15  lag_freq(1).t_shift    0     1              110           0           0


Obsid 1H0707_combined
chi^2 = 3.474193e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+3.822601e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.500000e+00 (+0.000000e+00 -1.351769e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -9.832225e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+9.101035e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.000000e+02 (+3.355497e-01 -0.000000e+00)
Parameter t_shift = 1.100000e+02 (+1.074766e+00 -7.554321e+01)

...................................................................

1H0707-submit-fit-error.sh
Submitted batch job 3919248

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.439191e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         5.889852         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              600           0           0
 15  lag_freq(1).t_shift    0     1              110           0           0


Obsid 1H0707_combined
chi^2 = 3.462316e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+1.015318e+00 -0.000000e+00)
Parameter Gamma1 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+0.000000e+00 -1.731370e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -9.832238e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+5.755324e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.000000e+02 (+3.355250e-01 -6.584128e+01)
Parameter t_shift = 1.100000e+02 (+1.067380e+00 -7.551210e+01)

..................................................................

1H0707-submit-fit-error.sh
Submitted batch job 3919305

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.429314e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         5.893227         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              590           0           0
 15  lag_freq(1).t_shift    0     1              110           0           0

Obsid 1H0707_combined
chi^2 = 3.425529e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+1.015090e+00 -0.000000e+00)
Parameter Gamma1 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+0.000000e+00 -1.735376e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -9.832276e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+5.815750e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.900000e+02 (+1.008274e+01 -5.588153e+01)
Parameter t_shift = 1.100000e+02 (+8.386211e-02 -7.561191e+01)




................................................................

1H0707-495-fit-error2.sl
Submitted batch job 3919249

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.359971e-05           0       0.001
  2  lag_freq(1).log_mass   0     0          6.00978         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               85           0           0

Obsid 1H0707_comb2
chi^2 = 2.935429e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+2.347701e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+0.000000e+00 -7.757102e-03)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+1.672163e-02 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+8.614468e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+1.502295e+02 -0.000000e+00)
Parameter t_shift = 8.500000e+01 (+2.571979e+01 -5.192162e+01)

...............................................................

1H0707-495-fit-error2.sl

Submitted batch job 3919311


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.359971e-05           0       0.001
  2  lag_freq(1).log_mass   0     0          6.00978         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               85           0           0


Obsid 1H0707_comb2
chi^2 = 2.935429e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+2.347701e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+0.000000e+00 -7.757102e-03)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+1.672163e-02 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+8.614468e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+1.672163e-01 -9.832784e+00)
Parameter t_shift = 8.500000e+01 (+3.344325e-02 -5.192162e+01)

....................................................................

1H0707-495-fit-error3.sl
Submitted batch job 3919298

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.550068e-05           0       0.001
  2  lag_freq(1).log_mass   0     0          5.96957         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              2.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               95           0           0

Obsid 1H0707_comb3
chi^2 = 2.955612e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+1.672371e-02 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.100000e+00 (+0.000000e+00 -1.986793e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+1.672371e-02 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.857673e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.000000e+02 (+1.000783e+02 -0.000000e+00)
Parameter t_shift = 9.500000e+01 (+1.524976e+01 -6.196462e+01)


.................................................................

1H0707-495-fit-error3.sl
Submitted batch job 3919315

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.550068e-05           0       0.001
  2  lag_freq(1).log_mass   0     0          5.96957         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              2.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               95           0           0

Obsid 1H0707_comb3
chi^2 = 2.955612e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+1.672371e-02 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.100000e+00 (+0.000000e+00 -1.986793e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+1.672371e-02 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.857673e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.000000e+02 (+1.672371e-01 -9.832763e+00)
Parameter t_shift = 9.500000e+01 (+1.524976e+01 -6.196462e+01)

................................................................

############################################
#########################################

Forcing Gamma 1 and Gamma 2 closer

########################################
######################################


1H0707-495-fit-error.sl
Submitted batch job 3919367

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      5.92942e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         5.877014         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              610           0           0
 15  lag_freq(1).t_shift    0     1              110           0           0


Obsid 1H0707_combined
chi^2 = 4.930621e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+1.008962e+00 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -9.830696e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+2.420317e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.100000e+02 (+1.693036e-01 -4.915348e+00)
Parameter t_shift = 1.100000e+02 (+8.465182e-02 -1.162107e+01)


................................................................................

1H0707-495-fit-error2.sl
Submitted batch job 3919369

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.640008e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         5.886933         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              600           0           0
 15  lag_freq(1).t_shift    0     1              110           0           0

Obsid 1H0707_comb2
chi^2 = 3.794724e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+1.177703e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -9.831891e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+3.652035e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.000000e+02 (+3.362178e-01 -9.277740e+01)
Parameter t_shift = 1.100000e+02 (+1.054717e+00 -1.338314e+01)

No improvement found


###############################

Gamma 2 > Gamma 1 ??? e.g:

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.2]; % Gamma1
vals_to_fit[3] = [1.5, 1.7, 1.8, 2.0, 2.1, 2.3, 2.4, 2.5, 2.6]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [400.0, 450.0, 500.0, 520.0, 550.0, 580.0, 590.0, 600.0, 610.0, 620.0, 650.0, 660.0, 700.0, 7\
50.0, 800.0, 850.0, 900.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [30.0, 50.0, 70.0, 80.0, 85.0, 90.0, 95.0, 100.0, 105.0, 110.0, 115.0, 120.0, 130.0, 140.0];\
 % t_shift

1H0707-495-fit-error.sl
Submitted batch job 3919377

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.851241e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         5.929175         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              550           0           0
 15  lag_freq(1).t_shift    0     1              105           0           0

Obsid 1H0707_combined
chi^2 = 2.957953e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+2.511137e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+5.349626e-02 -6.926241e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+1.672395e-02 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.596475e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.500000e+02 (+6.002576e+01 -2.949828e+01)
Parameter t_shift = 1.050000e+02 (+5.057193e+00 -7.166664e+01)

..............................................................................................

1H0707-495-fit-error2.sl
Submitted batch job 3919379

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.550068e-05           0       0.001
  2  lag_freq(1).log_mass   0     0          5.96957         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              2.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               95           0           0


Obsid 1H0707_comb2CEhh
chi^2 = 2.955612e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+8.661501e-02 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.100000e+00 (+3.601531e-03 -2.985982e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+1.672371e-02 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.857673e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.000000e+02 (+3.344742e-01 -0.000000e+00)
Parameter t_shift = 9.500000e+01 (+9.353977e+00 -6.196462e+01)

#+END_EXAMPLE

########################
######################

Run blob code to increase Gamma

##########################
####################

#+BEGIN_EXAMPLE

1H0707-495-fit-error2.sl
Submitted batch job 3927481

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.247566e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.028417         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              580           0           0
 15  lag_freq(1).t_shift    0     1               90           0           0
Obsid 1H0707_comb2
chi^2 = 2.101793e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+2.945103e+00 -0.000000e+00)
Parameter Gamma1 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.900000e+00 (+0.000000e+00 -1.855298e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -9.833641e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.800000e+02 (+3.015986e+01 -5.951040e+01)
Parameter t_shift = 9.000000e+01 (+2.004077e+01 -5.991867e+01)


.......................................................
1H0707-495-fit-error2.sl







#+END_EXAMPLE

*** Test adjusted Normalisation

##########################

CHANGE NORMALISATION

Defaults setting is:

set_par("lag_freq(1).norm", 4.0E-5, 0, 0.0, 1.0E-3);

###########################


#+BEGIN_EXAMPLE
1H0707-495-fit-error.sl

set_par("lag_freq(1).norm", 4.0E-5, 0, 0.0, 1.0E-2);


Submitted batch job 3913459

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.070505e-05           0        0.01
  2  lag_freq(1).log_mass   0     0         6.146918           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               70           0           0


Obsid 1H0707_combined
chi^2 = 3.212142e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+4.321938e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+1.257256e-02 -3.489442e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+7.920276e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+1.501446e+02 -2.476060e+02)
Parameter t_shift = 7.000000e+01 (+2.502340e+01 -4.952120e+01)


..............................................................

1H0707-495-fit-error2.sl

set_par("lag_freq(1).norm", 4.0E-4, 0, 0.0, 1.0E-3);

Submitted batch job 3913781

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.818873e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.018747           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                7           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0


Obsid 1H0707_comb2
chi^2 = 4.091059e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 7.000000e+00 (+1.172015e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+0.000000e+00 -1.208796e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+9.951252e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+1.509730e+02 -2.972793e+02)
Parameter t_shift = 8.000000e+01 (+5.181228e+00 -6.935203e+01)


.............................................................

1H0707-495-fit-error3.sl

set_par("lag_freq(1).norm", 5.0E-5, 0, 0.0, 1.0E-3);

vals_to_fit[2] = [2.8]; % Gamma1

Submitted batch job 3914213

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      2.81801e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.018827           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                7           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0

Obsid 1H0707_comb3
chi^2 = 4.090978e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 7.000000e+00 (+1.171958e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+0.000000e+00 -1.209029e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+9.950953e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+1.509729e+02 -2.972802e+02)
Parameter t_shift = 8.000000e+01 (+5.181147e+00 -6.935224e+01)

..............................................................

1H0707-495-fit-error4.sl

set_par("lag_freq(1).norm", 5.0E-6, 0, 0.0, 1.0E-3);

Submitted batch job 3914216


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.257285e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.025755           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              600           0           0
 15  lag_freq(1).t_shift    0     1               90           0           0


Obsid 1H0707_comb4
chi^2 = 2.429980e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+4.424869e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.700000e+00 (+0.000000e+00 -1.660511e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -3.457116e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+3.815896e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.000000e+02 (+1.666956e+00 -2.708017e+02)
Parameter t_shift = 9.000000e+01 (+1.330599e+01 -4.622195e+01)


..............................................................

1H0707-495-fit-error5.sl

set_par("lag_freq(1).norm", 5.0E-3, 0, 0.0, 1.0E-2);

Submitted batch job 3914221

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.818624e-05           0        0.01
  2  lag_freq(1).log_mass   0     0         6.018784           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                7           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0

Obsid 1H0707_comb5
chi^2 = 4.091018e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 7.000000e+00 (+1.171986e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+0.000000e+00 -1.208915e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+9.951100e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+1.509729e+02 -2.972798e+02)
Parameter t_shift = 8.000000e+01 (+5.181186e+00 -6.935219e+01)



#+END_EXAMPLE

*** Test adjusted Inclination

**** Test at i = 45



#+BEGIN_EXAMPLE
1H0707-495-fit-error-i45.sl

Submitted batch job 3914451

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.962281e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.013401           6         6.5
  3  lag_freq(1).i          0     1               45           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               90           0           0

Obsid 1H0707_combined_i45
chi^2 = 3.312856e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+1.006409e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.900000e+00 (+1.046216e-01 -1.783547e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+1.676072e-02 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+9.453255e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+3.656974e+01 -1.373924e+02)
Parameter t_shift = 9.000000e+01 (+5.852776e+00 -9.832393e+00)




#+END_EXAMPLE

**** Test at i = 58

PATH =1H0707-495-fit-error-i58.sl=

#+BEGIN_EXAMPLE

1H0707-495-fit-error-i58.sl

Submitted batch job 3914233

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.928012e-05           0        0.01
  2  lag_freq(1).log_mass   0     0          6.14608           6         6.5
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               70           0           0

Obsid 1H0707_combined_i58
chi^2 = 3.589898e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.014354e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+1.939099e-02 -2.716497e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+3.608323e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+5.093394e+01 -1.800742e+02)
Parameter t_shift = 7.000000e+01 (+1.059582e+01 -2.320662e+01)
 ..............................................................................

1H0707-495-fit-error-i58.sl

Submitted batch job 3914266

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.928534e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.146023           6         6.5
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               70           0           0


Obsid 1H0707_combined_i58
chi^2 = 3.589871e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.014354e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+1.939095e-02 -2.716505e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+3.608309e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+5.093392e+01 -1.800744e+02)
Parameter t_shift = 7.000000e+01 (+1.059581e+01 -2.320674e+01)

...............................................................................

1H0707-495-fit-error-i58.sl

Submitted batch job 3914463

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.928534e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.146023           6         6.5
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               70           0           0

Obsid 1H0707_combined_i58
chi^2 = 3.589871e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.014354e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+1.939095e-02 -2.716505e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+3.608309e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+3.357905e-01 -2.949631e+01)
Parameter t_shift = 7.000000e+01 (+8.394763e-02 -4.916052e+00)


#+END_EXAMPLE

**** Test at i = 64

PATH =1H0707-495-fit-error-i64.sl=

#+BEGIN_EXAMPLE

1H0707-495-fit-error-i64.sl

Submitted batch job 3914236

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0            4e-05           0        0.01
  2  lag_freq(1).log_mass   0     0              6.3           6         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              100           0           0
 15  lag_freq(1).t_shift    0     1                5           0           0

Obsid 1H0707_combined_i64
chi^2 = 1.647618e+02 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.000000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 7.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 1.400000e+02 (+0.000000e+00 -0.000000e+00)

..............................................................................

1H0707-495-fit-error-i64.sl

Submitted batch job 3914239

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.139395e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.093737           6         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               40           0           0


Obsid 1H0707_combined_i64
chi^2 = 6.104869e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.705567e-02 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+0.000000e+00 -2.281582e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.705567e-02 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+1.007665e+02 -6.388573e+01)
Parameter t_shift = 4.000000e+01 (+4.541329e+01 -1.089450e+01)

.....................................................................

1H0707-495-fit-error-i64.sl

Submitted batch job 3914457

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0            5e-05           0       0.001
  2  lag_freq(1).log_mass   0     0              6.3           6         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              100           0           0
 15  lag_freq(1).t_shift    0     1                5           0           0

Obsid 1H0707_combined_i64
chi^2 = 1.647618e+02 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.000000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 7.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 1.400000e+02 (+0.000000e+00 -0.000000e+00)

...........................................................................

Submitted batch job 3914462

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.139395e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.093737           6         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               40           0           0

Obsid 1H0707_combined_i64
chi^2 = 6.104869e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.705567e-02 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+0.000000e+00 -2.281582e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.705567e-02 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+3.411134e-01 -6.388681e+01)
Parameter t_shift = 4.000000e+01 (+8.527835e-02 -4.914722e+00)


............................................................................



#+END_EXAMPLE

*** Re-run blob code for higher gammma and finer t-shift & t-max

*Reflionx Model Parameters*
#+attr_html: :border 2 :rules None :frame border :width 25%
| Parameter | min |     max |
| $n_H$     |   0 | 100,000 |
| norm      |   0 |   1e+10 |
| Fe/solar  | 0.1 |      20 |
| $\Gamma$  | 1.4 |     3.3 |
| $\xi$     |  10 |   10000 |
| z         | -10 |      10 |

For Reflionx description see: /Ross & Fabian (2005) MNRAS 358,211 and Ross, Fabian & Young (1999)
MNRAS 306,461/

$\xi \propto \frac{F}{n}$ where F is the flux and n is the gas density
and $\xi = \frac{4 \pi F}{n_H}$

Note that code-x.c (line 400) converts the value of the ionisation
parameters to the values available in Reflionx which are (10, 20, 50,
100, 200, 500, 1000, 5000, 10000)

*Step 1*

BC4 script =submit-blob-delta.pl=

#+BEGIN_EXAMPLE
# Parameters for 1H 0707-405
my $epsilon = 0.001;
# First source height ("o")
my $first_source_height_low = 2.0;      # low value
my $first_source_height_high = 2.0;     # high value
my $source_height_delta = 1.0;                  # step size (same for both sources)
# First source height ("d")
my $second_source_height_low = 3.0;     # $first_source_height_low + $source_height_delta;
my $second_source_height_high = 10.0; # $first_source_height_high;
# Inclination angle of disk ("i")
my $inclination_low = 53.0;
my $inclination_high = 53.0;
my $inclination_delta = 1.0;
# Photon index of first source ("g")
my $first_source_photon_index_low = 1.6;
my $first_source_photon_index_high = 2.0;
my $first_source_photon_index_delta = 0.1;
# Photon index of second source ("e")
my $second_source_photon_index_low = 1.4;
my $second_source_photon_index_high = 2.0;
my $second_source_photon_index_delta = 0.1;
# Iron abundance ("A")
my $iron_abund_low = 1.0;
my $iron_abund_high = 1.0;
my $iron_abund_delta = 0.1;
# Ionization parameter ("x")
my $xi_low = 0.0;
my $xi_high = 3.0;
my $xi_delta = 1.0;
# Density profile index ("p") - density goes as r^-p
my $density_low = 0.0;
my $density_high = 0.0;
my $density_delta = 0.1;
# We're setting "y" and "l" to 1.0 which are the RRF for sources 1 and 2, respectively
# Brightness parameter is ratio of brightness of 2nd source compared to 1st
my $brightness_low = 1.0;
my $brightness_high = 3.0;
my $brightness_delta = 1.0;
# "q2" (q1 is fixed at 1)
my $q2_low = 0.5;
my $q2_high = 0.5;
my $q2_delta = 0.1;
# "v" is tmax;
my $tmax_low = 0.0;
my $tmax_high = 300.0;
my $tmax_delta = 2.0;
# "q" is the time shift between first and second source
my $tshift_low = 5.0;
my $tshift_high = 100.0;
my $tshift_delta = 1.0;

# For testing this code set do_not_submit to 1. This will produce the submit scripts but not actually submit them.\
 Set this to 0 to actually submit the jobs.
my $do_not_submit = 0;

my $n = 0;
my $batch_size = 100000; # how many jobs to run in one script
my $cur_batch_size = 0;

############

This will generate around 800 scripts

##################################
##############################
#+END_EXAMPLE

Leave above to run for over a day then...

*Step 2*
#+BEGIN_EXAMPLE

#+END_EXAMPLE

*** Combined - Homing in on the best fits (with known Mass discrepancy)

#+BEGIN_EXAMPLE
Best fits found between

|  Chi2 |   logM | gamma1 | gamma2 | tmax | tshift |
|  2.36 |  6.025 |    2.8 |    2.7 |  580 |     90 |
|  2.41 |  6.015 |    2.6 |    2.5 |  580 |     95 |
|  2.15 | 6.0366 |    2.8 |    2.7 |  550 |     90 |
| 2.137 | 6.0298 |    2.7 |    2.6 |  580 |     90 |


USE RANGE:


1H0707-495-comb-FM-fit-error.sl
Submitted batch job 3922324

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.6, 2.7, 2.8]; % Gamma1
vals_to_fit[3] = [2.2, 2.3, 2.4, 2.5, 2.6, 2.7]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.00, 150.0, 200.0, 250.0, 300.0, 350.0, 400.0, 450.0, 470.0, 500.0, 520.0, 540.0, 550.0, 5\
60.0, 580.0, 590.0, 600.0, 620.0, 630.0, 650.0, 660.0, 700.0, 800.0, 850.0, 900.0]; % t_max (zero doesn't seem\
 to work)
emacs vals_to_fit[10] = [5.0, 10.0, 12.0, 15.0, 18.0, 20.0, 25.0, 30.0, 35.0, 40.0, 50.0, 55.0, 60.0, 70.0, 80.0, 85\
.0, 90.0, 95.0, 100.0, 105.0, 120.0, 140.0, 160.0, 200.0]; % t_shift

And:
set_par("lag_freq(1).norm", 4.0E-5, 0, 0.0, 1.0E-3); % <-- will need to be some sensible number
set_par("lag_freq(1).log_mass", 6.02, 0, 5.9, 6.1); % <-- may need to update

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.356282e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.033718         5.9         6.1
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              560           0           0
 15  lag_freq(1).t_shift    0     1               90           0           0

Obsid 1H0707_comb_FM
chi^2 = 2.094829e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+4.300993e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.700000e+00 (+0.000000e+00 -3.707067e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -4.794463e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.600000e+02 (+4.030257e+01 -1.983718e+01)
Parameter t_shift = 9.000000e+01 (+1.775522e+01 -3.179309e+01)


.............................................................

1H0707-495-fit-error.sl
Submitted batch job 3922326


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.7]; % Gamma1
vals_to_fit[3] = [2.0, 2.1, 2.3, 2.4, 2.5, 2.6]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [400.0, 450.0, 500.0, 520.0, 550.0, 560.0, 570.0, 580.0, 585.0, 590.0, 595.0, 600.0, 610.0, 620.0, 6\
50.0, 660.0, 700.0, 750.0, 800.0, 850.0, 900.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [30.0, 50.0, 70.0, 80.0, 85.0, 90.0, 95.0, 100.0, 105.0, 110.0, 120.0]; % t_shift

set_par("lag_freq(1).norm", 4.0E-5, 0, 0.0, 1.0E-3); % <-- will need to be some sensible number
set_par("lag_freq(1).log_mass", 6.02, 0, 5.8, 6.5); % <-- may need to update


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.412271e-05           0       0.001
  2  lag_freq(1).log_mass   0     0          6.03204         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              570           0           0
 15  lag_freq(1).t_shift    0     1               90           0           0

Obsid 1H0707_combined
chi^2 = 2.098903e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+2.962542e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+0.000000e+00 -1.928872e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -9.833644e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.700000e+02 (+1.008200e+01 -4.952030e+01)
Parameter t_shift = 9.000000e+01 (+2.053275e+01 -2.624781e+01)



.............................................................


1H0707-495-fit-error2.sl
Submitted batch job 3922327


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.8]; % Gamma1
vals_to_fit[3] = [2.0, 2.1, 2.3, 2.4, 2.5, 2.6, 2.7]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [400.0, 450.0, 500.0, 520.0, 550.0, 580.0, 590.0, 600.0, 610.0, 620.0, 650.0, 660.0, 700.0, 750.0, 8\
00.0, 850.0, 900.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [30.0, 50.0, 70.0, 80.0, 85.0, 90.0, 95.0, 100.0, 105.0, 110.0, 115.0, 120.0, 130.0, 140.0]; % t_sh\
ift

set_par("lag_freq(1).norm", 4.0E-5, 0, 0.0, 1.0E-3); % <-- will need to be some sensible number
set_par("lag_freq(1).log_mass", 6.02, 0, 5.8, 6.5); % <-- may need to update


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.375504e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.036669         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              550           0           0
 15  lag_freq(1).t_shift    0     1               90           0           0


Obsid 1H0707_comb2
chi^2 = 2.153226e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+4.325757e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.700000e+00 (+0.000000e+00 -1.808607e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -9.833588e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.500000e+02 (+6.016482e+01 -2.950076e+01)
Parameter t_shift = 9.000000e+01 (+2.004195e+01 -5.991072e+01)



...............................................................


1H0707-495-fit-error3.sl
Submitted batch job 3922328


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.7]; % Gamma1
vals_to_fit[3] = [2.1, 2.2, 2.4, 2.5, 2.6]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [400.0, 450.0, 480.0, 490.0, 500.0, 510.0, 520.0, 530.0, 540.0, 550.0, 560.0, 570.0, 580.0, 590.0, 6\
00.0, 620.0, 650.0, 700.0, 800.0, 900.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [30.0, 50.0, 70.0, 75.0, 80.0, 85.0, 90.0, 95.0, 100.0, 110.0, 120.0, 130.0, 140.0]; % t_shift

set_par("lag_freq(1).norm", 4.0E-5, 0, 0.0, 1.0E-3); % <-- will need to be some sensible number
set_par("lag_freq(1).log_mass", 6.02, 0, 5.8, 6.4); % <-- may need to update

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.412271e-05           0       0.001
  2  lag_freq(1).log_mass   0     0          6.03204         5.8         6.4
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              570           0           0
 15  lag_freq(1).t_shift    0     1               90           0           0


Obsid 1H0707_comb3
chi^2 = 2.098903e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+2.962542e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+0.000000e+00 -1.757564e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -9.833644e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.700000e+02 (+3.030062e+01 -2.984010e+01)
Parameter t_shift = 9.000000e+01 (+2.053275e+01 -2.624781e+01)


------------------------------------------------------------------

1H0707-495-fit-error3.sl
Submitted batch job 3922330


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.7]; % Gamma1
vals_to_fit[3] = [2.1, 2.2, 2.3, 2.4, 2.5, 2.6]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [400.0, 450.0, 500.0, 520.0, 530.0, 540.0, 550.0, 560.0, 565.0, 570.0, 575.0, 580.0, 590.0, 600.0, 620.0, 65\
0.0, 700.0, 800.0, 900.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [30.0, 50.0, 70.0, 75.0, 80.0, 85.0, 88.0, 89.0, 90.0, 91.0, 92.0, 95.0, 100.0, 110.0, 120.0, 130.0, 140.0]\
; % t_shift

set_par("lag_freq(1).norm", 4.0E-5, 0, 0.0, 1.0E-3); % <-- will need to be some sensible number
set_par("lag_freq(1).log_mass", 6.02, 0, 5.9, 6.3); % <-- may need to update

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.412271e-05           0       0.001
  2  lag_freq(1).log_mass   0     0          6.03204         5.9         6.3
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              570           0           0
 15  lag_freq(1).t_shift    0     1               90           0           0

Obsid 1H0707_comb3
chi^2 = 2.098903e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+2.957312e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+0.000000e+00 -1.757564e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -9.833644e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.700000e+02 (+3.030062e+01 -4.916822e+00)
Parameter t_shift = 9.000000e+01 (+1.663563e-02 -9.833644e-01)

.................................................................

1H0707-495-comb-FM-fit-error2.sl
Submitted batch job 3923789



vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.6, 2.7, 2.8, 2.9, 3.0]; % Gamma1
vals_to_fit[3] = [2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [300.0, 350.0, 400.0, 450.0, 470.0, 500.0, 520.0, 540.0, 550.0, 560.0, 565.0, 570.0, 575.0, 580\
.0, 590.0, 600.0, 620.0, 650.0, 700.0, 800.0, 850.0, 900.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10.0, 15.0, 20.0, 25.0, 30.0, 35.0, 40.0, 50.0, 55.0, 60.0, 70.0, 80.0, 85.0, 90.0, 95.0\
, 100.0, 105.0, 120.0, 140.0, 160.0, 200.0]; % t_shift

 set_par("lag_freq(1).norm", 4.0E-5, 0, 0.0, 1.0E-3); % <-- will need to be some sensible number
 set_par("lag_freq(1).log_mass", 6.03, 0, 5.9, 6.1); % <-- may need to update


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      4.36123e-05           0       0.001
  2  lag_freq(1).log_mass   0     1            6.025           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              580           0           0
 15  lag_freq(1).t_shift    0     1               90           0           0

Obsid 1H0707_comb_FM2
chi^2 = 2.369402e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.940624e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.700000e+00 (+0.000000e+00 -1.791846e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -6.923748e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+5.859180e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.800000e+02 (+2.032522e+01 -5.980427e+01)
Parameter t_shift = 9.000000e+01 (+5.002098e+00 -1.438482e+01)
....................................................................

1H0707-495-comb-FM-fit-error2.sl
Submitted batch job 3923893


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [3.0]; % Gamma1
vals_to_fit[3] = [2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [300.0, 350.0, 400.0, 450.0, 470.0, 500.0, 520.0, 540.0, 550.0, 560.0, 565.0, 570.0, 575.0, 580.0,\
 590.0, 600.0, 620.0, 650.0, 700.0, 800.0, 850.0, 900.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10.0, 15.0, 20.0, 25.0, 30.0, 35.0, 40.0, 50.0, 55.0, 60.0, 70.0, 80.0, 85.0, 90.0, 95.0, 1\
00.0, 105.0, 120.0, 140.0, 160.0, 200.0]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.272854e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.030535         5.9         6.1
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              570           0           0
 15  lag_freq(1).t_shift    0     1               90           0           0


Obsid 1H0707_comb_FM2
chi^2 = 2.053929e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+2.844560e+00 -0.000000e+00)
Parameter Gamma1 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.900000e+00 (+0.000000e+00 -1.866792e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -9.833690e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.700000e+02 (+3.029720e+01 -4.916845e+00)
Parameter t_shift = 9.000000e+01 (+1.592912e+01 -3.213961e+01)

..........................................................................

1H0707-495-comb-FM-fit-error2.sl
Submitted batch job 3924050

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [3.1]; % Gamma1
vals_to_fit[3] = [2.5, 2.6, 2.7, 2.8, 2.9, 3.0]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [300.0, 350.0, 400.0, 450.0, 470.0, 500.0, 520.0, 540.0, 550.0, 560.0, 565.0, 570.0, 575.0, 580.0,\
 590.0, 600.0, 620.0, 650.0, 700.0, 800.0, 850.0, 900.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10.0, 15.0, 20.0, 25.0, 30.0, 35.0, 40.0, 50.0, 55.0, 60.0, 70.0, 80.0, 85.0, 90.0, 95.0, 1\
00.0, 105.0, 120.0, 140.0, 160.0, 200.0]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0            4e-05           0       0.001
  2  lag_freq(1).log_mass   0     0             6.03         5.9         6.1
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              3.1           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1                5           0           0

Obsid 1H0707_comb_FM2
chi^2 = 1.647618e+02 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.000000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 3.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 9.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 2.000000e+02 (+0.000000e+00 -0.000000e+00)

............................................................

1H0707-495-comb-FM-fit-error2.sl
Submitted batch job 3924127

Failed as no gamma1 = 3.1 - will I need to run this blob code or is this an unrealistic value?
#+END_EXAMPLE


####################
###################

Now run blob code again for finer par ranges that are in this case:


Gamma 1 up to 3.3 and Gamma 2 up to 3.2

much finer tmax and tshift between the value of the best fit


##################
################
##########

Refit code

#+BEGIN_EXAMPLE
1H0707-495-fit-error2.sl
Submitted batch job 3931403

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0]; % h2
vals_to_fit[2] = [3.0]; % Gamma1
vals_to_fit[3] = [2.9]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [2.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [500.0, 520.0, 550.0, 560.0, 565.0, 566.0, 567.0, 568.0, 569.0, 570.0, 571.0, 572.0, 573.0, 574.0, 575.\
0, 580.0, 590.0, 600.0, 610.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [70.0, 85.0, 87.0, 88.0, 89.0, 90.0, 91.0, 92.0, 93.0, 94.0, 95.0, 100.0, 105.0, 110.0]; % t_shif\
t


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      4.28189e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.027921         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              569           0           0
 15  lag_freq(1).t_shift    0     1               91           0           0

Obsid 1H0707_comb2
chi^2 = 2.041793e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.690000e+02 (+0.000000e+00 -4.852147e+01)
Parameter t_shift = 9.100000e+01 (+1.006478e+01 -0.000000e+00)


##### Convert ps to png and rotate #######

convert -rotate "90" 1H0707_comb2_best_fit.ps 1H0707_combined_best_fit2pt04.png
display 1H0707_combined_best_fit2pt04.png

##### Pull into Lyra WWW (from Lyra) #####

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/??    /home/WWW/steff/ecm


Try again with GAmma 1 = 3.1
Submitted batch job 3931410

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      4.29736e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.027211         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              3.1           0           0
  8  lag_freq(1).Gamma2     0     1                3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              571           0           0
 15  lag_freq(1).t_shift    0     1               91           0           0

Obsid 1H0707_comb2
chi^2 = 2.051110e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 3.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.710000e+02 (+4.069503e+00 -5.054595e+01)
Parameter t_shift = 9.100000e+01 (+9.020302e+00 -1.966769e+01)


##### Convert ps to png and rotate #######

convert -rotate "90" 1H0707_comb2_best_fit.ps 1H0707_combined_best_fit2pt05.png
display 1H0707_combined_best_fit2pt05.png

##### Pull into Lyra WWW (from Lyra) #####

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/??    /home/WWW/steff/ecm

.........................................................

1H0707-495-fit-error3.sl
Submitted batch job 3931415


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0]; % h2
vals_to_fit[2] = [3.1]; % Gamma1
vals_to_fit[3] = [2.8, 2.9, 3.0]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [200.0, 300.0, 400.0, 450.0, 500.0, 520.0, 550.0, 580.0, 590.0, 600.0, 610.0, 620.0, 650.0]; % t_max (zero doe\
sn't seem to work)
vals_to_fit[10] = [20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 95.0, 100.0, 105.0, 110.0, 120.0]; % t_shift


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.341636e-05           0       0.001
  2  lag_freq(1).log_mass   0     0          6.03456         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              3.1           0           0
  8  lag_freq(1).Gamma2     0     1                3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              550           0           0
 15  lag_freq(1).t_shift    0     1               90           0           0

Obsid 1H0707_comb3
chi^2 = 2.319596e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.665823e-02 -0.000000e+00)
Parameter Gamma1 = 3.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 3.000000e+00 (+0.000000e+00 -9.833418e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -9.833418e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+1.665823e-02 -9.833418e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.500000e+02 (+4.997470e-01 -2.950025e+01)
Parameter t_shift = 9.000000e+01 (+8.944298e+00 -3.370312e+00)

......................................................
1H0707-495-fit-error3.sl
Submitted batch job 3931430


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0]; % h2
vals_to_fit[2] = [3.1]; % Gamma1
vals_to_fit[3] = [2.8, 2.9, 3.0]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [200.0, 300.0, 400.0, 450.0, 500.0, 520.0, 550.0, 555.0, 560.0, 565.0, 570.0, 580.0, 590.0, 600.0, 610.0, 620.0, 650\
.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 86.0, 88.0, 90.0, 92.0, 95.0, 100.0, 105.0, 110.0, 120.0]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.311518e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.023864         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              3.1           0           0
  8  lag_freq(1).Gamma2     0     1                3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              570           0           0
 15  lag_freq(1).t_shift    0     1               92           0           0


Obsid 1H0707_comb3
chi^2 = 2.063063e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.663197e-02 -0.000000e+00)
Parameter Gamma1 = 3.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 3.000000e+00 (+0.000000e+00 -9.833680e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -9.833680e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+1.663197e-02 -9.833680e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.700000e+02 (+1.663197e-01 -4.954763e+01)
Parameter t_shift = 9.200000e+01 (+8.015400e+00 -8.700236e+00)

.........................................



1H0707-495-fit-error2.sl
Submitted batch job 3931442


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0]; % h2
vals_to_fit[2] = [3.2]; % Gamma1
vals_to_fit[3] = [2.8, 2.9, 3.0, 3.1]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 200.0, 300.0, 400.0, 450.0, 500.0, 550.0, 600.0, 610.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [10.0, 20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 85.0, 90.0, 95.0, 100.0, 105.0, 110.0]; % t_shift


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      4.35713e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.033652         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              3.2           0           0
  8  lag_freq(1).Gamma2     0     1              3.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              550           0           0
 15  lag_freq(1).t_shift    0     1               90           0           0

Obsid 1H0707_comb2
chi^2 = 2.662726e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.669350e-02 -0.000000e+00)
Parameter Gamma1 = 3.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 3.100000e+00 (+0.000000e+00 -9.833065e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -9.833065e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+1.669350e-02 -9.833065e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.500000e+02 (+8.346748e-01 -4.916533e+01)
Parameter t_shift = 9.000000e+01 (+1.000554e+01 -1.902530e+01)



.............................................

1H0707-495-fit-error3.sl
Submitted batch job 3931444


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0]; % h2
vals_to_fit[2] = [3.3]; % Gamma1
vals_to_fit[3] = [2.8, 2.9, 3.0, 3.1, 3.2]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 200.0, 300.0, 400.0, 450.0, 500.0, 520.0, 550.0, 555.0, 560.0, 565.0, 570.0, 580.0, 590.0, 600.0, 610.0, 620\
.0, 650.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [10.0, 20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 86.0, 88.0, 90.0, 92.0, 95.0, 100.0, 105.0, 110.0, 120.0]; % t_shi\
ft

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.424079e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.026659         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              3.3           0           0
  8  lag_freq(1).Gamma2     0     1              3.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              550           0           0
 15  lag_freq(1).t_shift    0     1               92           0           0


Obsid 1H0707_comb3
chi^2 = 3.053259e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.673381e-02 -0.000000e+00)
Parameter Gamma1 = 3.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 3.200000e+00 (+0.000000e+00 -9.832662e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -9.832662e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+1.673381e-02 -9.832662e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.500000e+02 (+8.366905e-02 -2.949799e+01)
Parameter t_shift = 9.200000e+01 (+8.027072e+00 -1.103933e+01)
.....................................................................

1H0707-495-fit-error2.sl
Submitted batch job 3931547


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.302274e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.027291         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              3.1           0           0
  8  lag_freq(1).Gamma2     0     1                3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              570           0           0
 15  lag_freq(1).t_shift    0     1               91           0           0

Obsid 1H0707_comb2
chi^2 = 2.053033e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.928101e+00 -0.000000e+00)
Parameter Gamma1 = 3.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 3.000000e+00 (+0.000000e+00 -9.833691e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -9.833691e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+1.663094e-02 -9.833691e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.700000e+02 (+4.989283e-01 -6.924265e+01)
Parameter t_shift = 9.100000e+01 (+9.015088e+00 -1.969789e+01)



#+END_EXAMPLE

##############
###################

Now explore where Gamma1 = 2.7 - 2.8 and gamma2 = 2.6 and 2.7 - these
were good fits !

#####################
############

#+BEGIN_EXAMPLE

1H0707-495-fit-error5.sl
Submitted batch job 3932028

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0       2.9992e-05           0        0.01
  2  lag_freq(1).log_mass   0     0         6.102959           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              350           0           0
 15  lag_freq(1).t_shift    0     1               70           0           0

Obsid 1H0707_comb5
chi^2 = 4.440480e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+4.341508e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.500000e+00 (+1.011439e-01 -2.742285e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.500000e+02 (+1.210296e+02 -1.944788e+02)
Parameter t_shift = 7.000000e+01 (+1.403176e+01 -5.851934e+01)

.........................................

1H0707-495-fit-error5.sl
Submitted batch job 3932063

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.325912e-05           0        0.01
  2  lag_freq(1).log_mass   0     0         6.060357           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              590           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0


Obsid 1H0707_comb5
chi^2 = 5.476740e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.360858e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -9.509918e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+1.279478e-01 -7.411637e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.900000e+02 (+3.397682e-02 -5.762375e+00)
Parameter t_shift = 8.000000e+01 (+7.297388e-01 -7.786887e+00)

.............................................................

1H0707-495-fit-error2.sl
Submitted batch job 3932040


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0]; % h2
vals_to_fit[2] = [2.9, 3.0, 3.1, 3.2, 3.3]; % Gamma1
vals_to_fit[3] = [2.5, 2.6, 2.7, 2.8, 2.9, 3.0, 3.1, 3.2]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 200.0, 300.0, 400.0, 450.0, 500.0, 550.0, 560.0, 567.0, 569.0, 570.0, 572.0, 600.0]; % t_max (\
zero doesn't seem to work)
vals_to_fit[10] = [10.0, 20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 85.0, 89.0, 90.0, 91.0,  92.0, 93.0, 95.0, 100.0, 105.0, 1\
10.0]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      4.28189e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.027921         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              569           0           0
 15  lag_freq(1).t_shift    0     1               91           0           0

Obsid 1H0707_comb2
chi^2 = 2.041793e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+2.820039e+00 -0.000000e+00)
Parameter Gamma1 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.900000e+00 (+0.000000e+00 -2.802881e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -8.932222e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.690000e+02 (+0.000000e+00 -1.068705e+02)
Parameter t_shift = 9.100000e+01 (+0.000000e+00 -2.871659e+01)
#+END_EXAMPLE

*** Investigated a finer range of the second source height

The code-x files behaviour changes more significantly between 2 - 4rg.

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/code-x-height.png

Investigate a finer range of the second source height between 2 - 4 rg
with step sizes of 0.2.

Code-s has already been run for these heights, now run code-x for:

#+BEGIN_EXAMPLE
# Parameters for 1H 0707-405
my $epsilon = 0.001;
# Inclination angle of disk ("i")
my $inclination_low = 53.0;
my $inclination_high = 53.0;
my $inclination_delta = 1.0;
# Source height ("h")
my $source_height_low = 2.2;
my $source_height_high = 3.8;
my $source_height_delta = 0.2;
# Photon index ("g")
my $photon_index_low = 2.7;
my $photon_index_high = 3.0;
my $photon_index_delta = 0.1;
# Ionization parameter ("x");
my $ionization_low = 0.0;
my $ionization_high = 3.0;
my $ionization_delta = 1.0;
#+END_EXAMPLE

Submit code

#+BEGIN_EXAMPLE
./submit-code-x.pl   ---submitted 1015 on 15/7/2020---
squeue | grep so14935
           3932801    serial   code-x  so14935 PD       0:00      1 (Priority)
           3932800    serial   code-x  so14935 PD       0:00      1 (Resources)
           3932803    serial   code-x  so14935 PD       0:00      1 (Priority)
           3932804    serial   code-x  so14935 PD       0:00      1 (Priority)
           3932806    serial   code-x  so14935 PD       0:00      1 (Priority)
           3932808    serial   code-x  so14935 PD       0:00      1 (Priority)
           3932798    serial   code-x  so14935  R       0:40      1 compute079
           3932797    serial   code-x  so14935  R       0:44      1 compute079
           3932795    serial   code-x  so14935  R       0:47      1 compute079
#+END_EXAMPLE

Check files in code-x-files directory:

Now run blob code for the lag files

#+BEGIN_EXAMPLE
setup new sumbit script dir - mkdir submit-scriptsH
setup new blob script - submit-blob-delta-H.pl

./submit-blob-delta-H.pl

 squeue | grep so14935
           3933032    serial   reverb  so14935  R       0:21      1 compute076
           3933031    serial   reverb  so14935  R       0:27      1 compute076
           3933030    serial   reverb  so14935  R       0:33      1 compute076
           3933029    serial   reverb  so14935  R       0:40      1 compute076
           3933028    serial   reverb  so14935  R       0:46      1 compute068
#+END_EXAMPLE

Run code

#+BEGIN_EXAMPLE

1H0707-495-fit-error2.sl
Submitted batch job 3935927


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [2.2, 2.4, 2.6, 2.8, 3.0, 3.2, 3.4, 3.6, 3.8]; % h2
vals_to_fit[2] = [3.0, 3.1]; % Gamma1
vals_to_fit[3] = [2.7, 2.8, 2.9, 3.0]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [150.0, 200.0, 250.0, 300.0, 350.0, 400.0, 450.0, 500.0, 550.0, 560.0, 567.0, 569.0, 570.0, 571.0, 572.0, 580.0, 600.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [10.0, 20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 85.0, 89.0, 90.0, 91.0, 92.0, 93.0, 95.0, 100.0, 105.0, 110.0]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.282137e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.027904         5.6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              569           0           0
 15  lag_freq(1).t_shift    0     1               91           0           0

Obsid 1H0707_comb2
chi^2 = 2.041820e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+2.780596e-02 -1.966740e-01)
Parameter Gamma1 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.900000e+00 (+0.000000e+00 -1.987239e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.690000e+02 (+0.000000e+00 -1.173830e+02)
Parameter t_shift = 9.100000e+01 (+0.000000e+00 -3.782707e+01)


############

At first - Finer height range made no improvements but see below.........

############

...............................................


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     6.278396e-05           0       0.001
  2  lag_freq(1).log_mass   0     0          5.93082         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1              2.6           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              550           0           0
 15  lag_freq(1).t_shift    0     1              100           0           0


Obsid 1H0707_comb1
chi^2 = 3.817206e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 2.600000e+00 (+3.362648e-03 -1.966374e-01)
Parameter Gamma1 = 3.000000e+00 (+2.986537e-02 -0.000000e+00)
Parameter Gamma2 = 2.900000e+00 (+1.760344e-02 -1.366524e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.500000e+02 (+0.000000e+00 -3.285975e+00)
Parameter t_shift = 1.000000e+02 (+0.000000e+00 -6.588275e+01)

......................................................................

1H0707-comb-fit-error1.sl
Submitted batch job 3939041

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [2.2, 2.4, 2.6, 2.8, 3.0, 3.2, 3.4, 3.6, 3.8, 4.0, 5.0]; % h2
vals_to_fit[2] = [3.0, 3.1, 3.2]; % Gamma1
vals_to_fit[3] = [2.5, 2.6, 2.7, 2.8, 2.9, 3.0, 3.1, 3.2]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 150.0, 200.0, 220.0, 250.0, 280.0, 300.0, 350.0, 400.0, 420.0,  450.0, 480.0, 500\
.0, 530.0, 540.0, 550.0, 560.0, 569.0, 570.0, 571.0, 580.0, 600.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [10.0, 20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 85.0, 89.0, 90.0, 91.0, 92.0, 93.0, 95.0, 100\
.0, 105.0, 110.0]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.074755e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         5.896177         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              580           0           0
 15  lag_freq(1).t_shift    0     1              110           0           0



Obsid 1H0707_comb1
chi^2 = 3.520427e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+0.000000e+00 -1.966435e-01)
Parameter Gamma1 = 3.000000e+00 (+3.252233e-02 -0.000000e+00)
Parameter Gamma2 = 2.900000e+00 (+1.727002e-02 -1.392716e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.800000e+02 (+0.000000e+00 -3.602445e+01)
Parameter t_shift = 1.100000e+02 (+0.000000e+00 -2.035699e+01)


.....................................................................

1H0707-comb-fit-error2.sl
Submitted batch job 3939046

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.161615e-05           0       0.001
  2  lag_freq(1).log_mass   0     0              5.9         5.9         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              580           0           0
 15  lag_freq(1).t_shift    0     1              110           0           0

Obsid 1H0707_comb2
chi^2 = 3.469969e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+0.000000e+00 -1.966446e-01)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+2.021692e-01 -1.164445e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.800000e+02 (+0.000000e+00 -3.575902e+01)
Parameter t_shift = 1.100000e+02 (+3.287648e+00 -1.911288e+01)

############

remeber to set the variable mass to 6.02

###########
.....................................................................
1H0707-comb-fit-error2.sl
Submitted batch job 3939103



.....................................................................
1H0707-comb-fit-error1.sl
Submitted batch job 3939105



.......................................................................







#+END_EXAMPLE

*** Results and Image creation

PATH =/home/steff075/phd_ecm/ecm_model/1H0707-test-fit-Vari-M.vsz=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-test-fit-Vari-M.png


Best fit was

#+BEGIN_EXAMPLE
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      4.28189e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.027921         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              569           0           0
 15  lag_freq(1).t_shift    0     1               91           0           0

Obsid 1H0707_comb2
chi^2 = 2.041793e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.690000e+02 (+0.000000e+00 -4.852147e+01)
Parameter t_shift = 9.100000e+01 (+1.006478e+01 -0.000000e+00)


lag_freq(1).log_mass,6.027904e+00,+1.692255e-02,-1.809465e-02
  Parameter 2 = 6.027904e+00 (6.009809e+00 - 6.044827e+00)

############################################

Make good image and save the fitting file

############################################

save parameter ranges in the following file but recall that in order to achieve this the norm and logM were set at:

                set_par("lag_freq(1).norm", 4.0E-5, 0, 0.0, 1.0E-3);
                set_par("lag_freq(1).log_mass", 6.02, 0, 5.8, 6.5);

/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707-comb-fit-error.sl


For good roman font  and Charsize use, e.g.:

 lines 245-254:
                                save_par(path_to_fits + "/" + obsid + "_best_fit.par");
                                variable pid = open_plot(path_to_fits +  "/" + obsid + "_best_fit.ps/cps");
                                charsize(1.35);
                                nice_width;
                                _pgscf(2);
                                plot_data(1, popt);
                                _pgsci(1);
                                _pgsls(2);
                                _pgmove(-10000, 0);
                                _pgdraw(1, 0);
                                close_plot(pid);

LInes 352 ->

        % re-make a postscript plot of the best fit
        variable pid = open_plot(path_to_fits + "/" + obsid + "_best_fit.ps/cps");
        charsize(1.35);
        nice_width;
        _pgsci(1);
        _pgsls(2);
        _pgscf(2);
        _pgmove(-10000, 0);
        _pgdraw(1, 0);
        plot_data(1,popt);
        close_plot(pid);
}

.......................
convert -rotate "90" 1H0707_comb_best_fit.ps 1H0707_comb_best_fit_ecm.png

##### Pull into Lyra WWW (from Lyra) #####

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_comb_best_fit.ps .

Then cp to   /home/WWW/steff/ecm

#+END_EXAMPLE

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707_comb_best_fit_ecm.png

*** Obtain errors on LogM

Place the folowing command in the fitting script around line 343

#+BEGIN_EXAMPLE
% Obtain errors on the mass
 	source("conf_mass.sl");


e.g:

        () = fclose(fp);


% Obtain errors on the mass
        source("conf_mass.sl");

} else {
        % Run in interactive mode, e.g., to explore best fit
        load_par(path_to_fits + "/" + obsid + "_best_fit.par");
        () = eval_counts;

        % re-make a postscript plot of the best fit
        variable pid = open_plot(path_to_fits + "/" + obsid + "_best_fit.ps/cps");
..etc
#+END_EXAMPLE

where =conf_mass.sl= reads:

#+BEGIN_EXAMPLE
variable p = [1];

variable all_good, good, i, lo, hi;

do {
	vmessage("\n\n--Starting to determine confidence intervals--\n");
	all_good = 1;
	%fp = fopen("conf_mass.csv","w");% Create the file
        for (i=0; i<length(p); i++) {
		do {
			good = 1;
			(lo, hi) = conf(p[i]);
			vmessage("  Parameter %i = %e (%e - %e)", p[i], get_par(p[i]), lo, hi);
			() = fprintf(fp, "%s,%e,+%e,-%e\n", get_par_info(p[i]).name, get_par(p[i]), hi-get_par(p[i]), get_par(p[i])-lo);
                        if (lo == hi) {
				% this means that a better fit was found
				vmessage("Found a better fit!");
				() = fit_counts;
				good = 0;
				all_good = 0;
			}
		} while (good == 0);
		%vmessage("Parameter %i = %e (%e - %e)", p[i], get_par(p[i]), lo, hi);
	}
        %() = fclose(fp);
} while (all_good == 0);
#+END_EXAMPLE

*** Variable Mass behaviour

PATH =/home/steff075/phd_ecm/ecm_model/1H0707-model-pars-V-logM.vsz=

Imports =/home/steff075/phd_ecm/ecm_model/1H0707-test-fit-Vari-M.csv=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-model-pars-V-logM.png


PATH =/home/steff075/phd_ecm/ecm_model/1H0707-model-pars-V-logM.vsz=

Imports =/home/steff075/phd_ecm/ecm_model/1H0707-test-fit-Vari-M.csv=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-model-pars-V-chi-sq.png

*** Combined - continued fitting (seek inproved fits !!)

Try running again for improvement

#+BEGIN_EXAMPLE
##################
################

Skipping H2 = 3rg

###############

1H0707-comb-fit-error.sl
Submitted batch job 3972855


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [4.0, 5.0, 6.0, 7.0, 8.0, 9.0]; % h2
vals_to_fit[2] = [2.7, 2.8, 2.9, 3.0, 3.1]; % Gamma1
vals_to_fit[3] = [2.6, 2.7, 2.8, 2.9, 3.0, 3.1]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [0.0, 1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [200.0, 250.0, 300.0, 350.0, 400.0, 450.0, 500.0, 550.0, 570.0, 569.0, 600.0]; % t_max (zero doe\
sn't seem to work)
vals_to_fit[10] = [50.0, 60.0, 70.0, 80.0, 85.0, 91.0, 95.0, 100.0, 110.0]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.980753e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.025633         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.9           0           0
  8  lag_freq(1).Gamma2     0     1              2.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              600           0           0
 15  lag_freq(1).t_shift    0     1               91           0           0


Obsid 1H0707_comb
chi^2 = 2.452018e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+3.452465e+00 -0.000000e+00)
Parameter Gamma1 = 2.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.800000e+00 (+2.015025e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+7.791015e-01 -1.990109e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.000000e+02 (+0.000000e+00 -6.280424e+01)
Parameter t_shift = 9.100000e+01 (+0.000000e+00 -2.120596e+01)


cd lag-files/i53/a0.998/h02.0+04.0/g2.9+2.8/A01.0/x3.0/p00.0/b02.0/q0.5/
[so14935@bc4gpulogin1 q0.5]$ ls
tmax0140  tmax0210  tmax0250  tmax0350  tmax0425  tmax0546  tmax0556  tmax0566  tmax0575  tmax0584  tmax0594
tmax0180  tmax0215  tmax0260  tmax0375  tmax0450  tmax0548  tmax0558  tmax0568  tmax0576  tmax0586  tmax0596
tmax0190  tmax0225  tmax0275  tmax0390  tmax0500  tmax0550  tmax0560  tmax0570  tmax0578  tmax0588  tmax0598
tmax0200  tmax0230  tmax0300  tmax0400  tmax0542  tmax0552  tmax0562  tmax0572  tmax0580  tmax0590  tmax0600
tmax0205  tmax0235  tmax0325  tmax0410  tmax0544  tmax0554  tmax0564  tmax0574  tmax0582  tmax0592  tmax0610

.................................................

1H0707-comb-fit-error.sl
Submitted batch job 3972928

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.004633e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.029061         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.9           0           0
  8  lag_freq(1).Gamma2     0     1              2.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              586           0           0
 15  lag_freq(1).t_shift    0     1               91           0           0

Obsid 1H0707_comb
chi^2 = 2.418516e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+1.591398e+00 -0.000000e+00)
Parameter Gamma1 = 2.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+9.434005e-01 -1.989964e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.860000e+02 (+0.000000e+00 -4.927947e+01)
Parameter t_shift = 9.100000e+01 (+0.000000e+00 -1.576637e+01)

.................................................

1H0707-comb-fit-error.sl
Submitted batch job 4041598

lag_freq(1).log_mass,6.027904e+00,+1.692255e-02,-1.809465e-02
  Parameter 2 = 6.027904e+00 (6.009809e+00 - 6.044827e+00)

#+END_EXAMPLE

*** *Combined fixed mass fits*

use =1H0707-495-comb-FM-fit-error.sl=

#+BEGIN_EXAMPLE
vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.8]; % Gamma1
vals_to_fit[3] = [1.4, 1.6, 1.8, 2.0, 2.2, 2.4, 2.6]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [200.0, 250.0, 300.0, 350.0, 370.0, 390.0, 400.0, 420.0, 440.0, 450.0, 470.0, 480.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0]; % t_shift

run time = 22

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.223754e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0

Obsid 1H0707_comb_FM
chi^2 = 1.177896e+01 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+8.122959e-01 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+0.000000e+00 -3.610556e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+4.006710e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+2.128133e+01 -3.355788e+01)
Parameter t_shift = 5.000000e+01 (+1.102682e+00 -3.188762e+00)

............................................................................

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.2]; % Gamma1
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 200.0, 250.0, 280.0, 300.0, 320.0, 350.0, 370.0, 390.0, 400.0, 420.0, 440.0, 450.0, 470.0, 480.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [10.0, 20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0]; % t_shift

Time = 44 mins


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     6.465905e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Obsid 1H0707_comb_FM
chi^2 = 1.005413e+01 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+1.732440e-01 -5.527690e-01)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.700000e+00 (+6.398423e-02 -1.700068e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+2.485732e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.000000e+02 (+1.814940e+01 -8.937632e+01)
Parameter t_shift = 2.000000e+01 (+1.304369e+01 -8.916620e+00)

-------------------------------------------------------------------------------

1H0707-495-comb-FM-fit-error2.sl

sbatch 1H0707-submit-fit-error.sh
Submitted batch job 3895234

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.9]; % Gamma1
vals_to_fit[3] = [1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [150.0, 160.0, 170.0, 180.0, 190.0, 200.0, 220.0, 250.0, 300.0, 350.0, 375.0, 400.0, 425.0, 450.0, 500.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [10.0, 15.0, 20.0, 25.0, 30.0, 35.0, 40.0, 45.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0]; % t_shift

36 mins

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.834649e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.9           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Obsid 1H0707_comb_FM2
chi^2 = 6.237110e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+1.020911e-01 -0.000000e+00)
Parameter Gamma1 = 2.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.500000e+00 (+4.881005e-02 -1.976028e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+4.944446e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+2.375555e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.000000e+02 (+9.762009e+00 -2.986899e+01)
Parameter t_shift = 2.000000e+01 (+4.351400e+00 -2.527777e+00)
..................................................................



lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.666388e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              1.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              180           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Obsid 1H0707_comb_FM
chi^2 = 6.664822e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+5.176626e-01 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.600000e+00 (+2.727393e-01 -1.522735e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+7.983937e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.800000e+02 (+2.571967e+01 -2.282078e+01)
Parameter t_shift = 2.000000e+01 (+7.637607e+00 -3.279930e+00)
..............................................................................

1H0707-495-comb-FM-fit-error.sl

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.4]; % Gamma1
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 150.0, 180.0, 200.0, 220.0, 250.0, 280.0, 300.0, 350.0, 400.0, 430.0, 450.0, 480.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [10.0, 15.0, 20.0, 25.0, 30.0, 35.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0]; % t_shift

sbatch 1H0707-submit-fit-error.sh
Submitted batch job 3895822

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     6.070348e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid 1H0707_comb_FM
chi^2 = 5.934916e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+2.824208e-01 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+3.435618e-02 -2.210249e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+2.000309e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.000000e+02 (+1.696550e+01 -4.505138e+01)
Parameter t_shift = 2.000000e+01 (+5.578614e+00 -3.427897e+00)

..................................................................................

1H0707-495-comb-FM-fit-error2.sl

vals_to_fit[0] = [2.0]; % h11H0707-495-comb-FM-fit-error2.sl
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.2]; % Gamma1
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 150.0, 170.0, 190.0, 200.0, 220.0, 250.0, 300.0, 350.0, 375.0, 400.0, 425.0, 450.0, 500.0]; % t_m\
ax (zero doesn't seem to work)
vals_to_fit[10] = [5, 10.0, 15.0, 20.0, 25.0, 30.0, 35.0, 40.0, 45.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0]; % t_shift

sbatch 1H0707-submit-fit-error.sh
Submitted batch job 3895818

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.104519e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              190           0           0
 15  lag_freq(1).t_shift    0     1               25           0           0

Obsid 1H0707_comb_FM2
chi^2 = 6.514584e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.085940e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.600000e+00 (+1.152924e-01 -1.914060e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+1.563544e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+7.645054e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.900000e+02 (+1.500901e+01 -3.986761e+01)
Parameter t_shift = 2.500000e+01 (+2.397723e+00 -9.755843e+00)

.......................................................................
1H0707-495-comb-FM-fit-error.sl

Gamma 1 = 2.1

sbatch 1H0707-submit-fit-error.sh
Submitted batch job 3896745

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.696477e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.1           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              180           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Obsid 1H0707_comb_FM
chi^2 = 6.871022e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+9.558428e-01 -0.000000e+00)
Parameter Gamma1 = 2.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.400000e+00 (+2.210147e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+9.558428e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.800000e+02 (+2.814347e+01 -2.180722e+01)
Parameter t_shift = 2.000000e+01 (+7.739493e+00 -3.399063e+00)


.....................................................................
1H0707-495-comb-FM-fit-error2.sl

Gamma 1 = 2.0

sbatch 1H0707-submit-fit-error.sh
Submitted batch job 3896749

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.979117e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1                2           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              190           0           0
 15  lag_freq(1).t_shift    0     1               25           0           0


Obsid 1H0707_comb_FM2
chi^2 = 6.433184e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+9.631144e-01 -0.000000e+00)
Parameter Gamma1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.400000e+00 (+9.665799e-02 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+5.347670e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+4.595973e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.900000e+02 (+7.428799e+00 -3.986924e+01)
Parameter t_shift = 2.500000e+01 (+2.924429e+00 -9.964522e+00)

.......................................................................

1H0707-495-comb-FM-fit-error.sl

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.7]; % Gamma1
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.0, 100.0, 150.0, 180.0, 200.0, 220.0, 250.0, 280.0, 300.0, 350.0, 400.0, 450.0, 500.0]; % \
t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10.0, 15.0, 20.0, 25.0, 30.0, 35.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0]; % t_shi

sbatch 1H0707-submit-fit-error.sh
Submitted batch job 3899137

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.874073e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              180           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid 1H0707_comb_FM
chi^2 = 7.455999e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.820687e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+5.800757e-02 -1.633131e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.029334e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.800000e+02 (+2.884562e+01 -1.856968e+01)
Parameter t_shift = 2.000000e+01 (+5.654039e+00 -2.148073e+00)


...........................................................................................
1H0707-495-comb-FM-fit-error2.sl

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.5]; % Gamma1
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.2, 2.3, 2.4]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.0, 100.0, 150.0, 170.0, 190.0, 200.0, 220.0, 250.0, 300.0, 350.0, 375.0, 400.0, 425.0, 450\
.0, 500.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5, 10.0, 15.0, 20.0, 25.0, 30.0, 35.0, 40.0, 45.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0]; % t

sbatch 1H0707-submit-fit-error.sh
Submitted batch job 3899140

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.649275e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              170           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid 1H0707_comb_FM2
chi^2 = 7.948688e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+1.466884e+00 -0.000000e+00)
Parameter Gamma1 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.900000e+00 (+1.893752e-01 -4.942962e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.349194e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.700000e+02 (+3.933769e+01 -1.393200e+01)
Parameter t_shift = 2.000000e+01 (+7.256304e+00 -3.221654e+00)
 .......................................................................

1H0707-495-comb-FM-fit-error.sl

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.3]; % Gamma1
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [200.0, 250.0, 280.0, 300.0, 350.0, 400.0, 450.0, 500.0, 600.0, 700.0, 800.0]; % t_max (\
zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10.0, 15.0, 20.0, 25.0, 30.0, 35.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0];

 sbatch 1H0707-submit-fit-error.sh
Submitted batch job 3900020

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.039015e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               25           0           0


Obsid 1H0707_comb_FM
chi^2 = 8.788764e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+3.523822e-01 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.700000e+00 (+1.438779e-01 -4.782848e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.038624e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.000000e+02 (+1.545404e+01 -0.000000e+00)
Parameter t_shift = 2.500000e+01 (+6.106053e+00 -1.751153e+00)



......................................................................

1H0707-495-comb-FM-fit-error2.sl

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.2]; % Gamma1
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.0, 100.0, 150.0, 170.0, 190.0, 200.0, 220.0, 250.0, 300.0, 350.0, 400.0, 450.0, 500.\
0, 600.0, 650.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5, 10.0, 15.0, 20.0, 25.0, 30.0, 35.0, 40.0, 45.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0\
, 120.0, 150.0]; % t_shift

sbatch 1H0707-submit-fit-error.sh
Submitted batch job 3900063


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.104519e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              190           0           0
 15  lag_freq(1).t_shift    0     1               25           0           0

Obsid 1H0707_comb_FM2
chi^2 = 6.514584e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.085940e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.600000e+00 (+1.152924e-01 -1.914060e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+1.563544e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+7.645054e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.900000e+02 (+1.500901e+01 -3.986761e+01)
Parameter t_shift = 2.500000e+01 (+2.397723e+00 -9.755843e+00)
.......................................................


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.104519e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              190           0           0
 15  lag_freq(1).t_shift    0     1               25           0           0


Obsid 1H0707_comb_FM2
chi^2 = 6.514584e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.085940e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.600000e+00 (+1.152924e-01 -1.914060e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+1.563544e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+7.645054e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.900000e+02 (+1.500901e+01 -3.986761e+01)
Parameter t_shift = 2.500000e+01 (+2.397723e+00 -9.755843e+00)

-------------------------------------------------------------
1H0707-495-comb-FM-fit-error.sl
Submitted batch job 3919892

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.2]; % Gamma1
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.0, 75.0, 100.0, 150.0, 200.0, 250.0, 280.0, 300.0, 350.0, 380.0, 400.0, 450.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 8.0, 10.0, 12.0, 15.0, 18.0, 20.0, 25.0, 30.0, 35.0, 40.0, 50.0, 60.0]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.984492e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               25           0           0

Obsid 1H0707_comb_FM
chi^2 = 8.161658e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.098674e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.600000e+00 (+1.192362e-01 -2.314816e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.074731e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.000000e+02 (+1.447483e+01 -3.620909e+01)
Parameter t_shift = 2.500000e+01 (+3.386071e+00 -6.831434e+00)

...............................................................

1H0707-495-comb-FM-fit-error2.sl
Submitted batch job 3919893

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.3]; % Gamma1
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.0, 80.0, 100.0, 120.0, 150.0, 170.0, 190.0, 200.0, 220.0, 250.0, 280.0, 300.0, 350.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5, 10.0, 15.0, 20.0, 25.0, 30.0, 35.0, 40.0, 45.0, 50.0, 60.0, 70.0, 80.0]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.024731e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              170           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid 1H0707_comb_FM2
chi^2 = 7.804796e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.444495e+00 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+5.953496e-02 -2.555505e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+8.120585e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.700000e+02 (+3.741720e+01 -1.470625e+01)
Parameter t_shift = 2.000000e+01 (+9.396714e+00 -3.660759e+00)

...........................................................
1H0707-495-comb-FM-fit-error3.sl
Submitted batch job 3919895

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.0]; % Gamma1
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.1, 2.2]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.0, 80.0, 100.0, 120.0, 150.0, 170.0, 190.0, 200.0, 220.0, 250.0, 280.0, 300.0, 350.0, 400.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5, 10.0, 12.0, 15.0, 18.0, 20.0, 22.0, 25.0, 30.0, 35.0, 40.0, 45.0, 50.0]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.979117e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1                2           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              190           0           0
 15  lag_freq(1).t_shift    0     1               25           0           0


Obsid 1H0707_comb_FM3
chi^2 = 6.433184e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+9.631144e-01 -0.000000e+00)
Parameter Gamma1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.400000e+00 (+9.665799e-02 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+5.347670e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+4.595973e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.900000e+02 (+7.428799e+00 -3.986924e+01)
Parameter t_shift = 2.500000e+01 (+2.924429e+00 -2.948727e+00)

...........................................................

1H0707-495-comb-FM-fit-error.sl
Submitted batch job 3919900

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.1]; % Gamma1
vals_to_fit[3] = [1.6, 1.7, 1.8, 1.9, 2.0]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.0, 75.0, 100.0, 150.0, 200.0, 220.0, 250.0, 280.0, 300.0, 350.0, 380.0, 400.0, 450.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 8.0, 10.0, 12.0, 15.0, 18.0, 20.0, 25.0, 30.0, 35.0, 40.0, 50.0, 60.0, 70.0]; % t_shift


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.055104e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.1           0           0
  8  lag_freq(1).Gamma2     0     1              1.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               25           0           0

Obsid 1H0707_comb_FM
chi^2 = 9.044455e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+2.334472e+00 -0.000000e+00)
Parameter Gamma1 = 2.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.600000e+00 (+6.621950e-02 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -2.068321e-01)
Parameter p =Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.187457e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.000000e+02 (+1.651782e+01 -4.415490e+01)
Parameter t_shift = 2.500000e+01 (+3.335055e+00 -6.714718e+00) 0.000000e+00 (+0.000000e+00 -0.000000e+00)


...........................................................

1H0707-495-comb-FM-fit-error2.sl
Submitted batch job 3919901

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.0]; % Gamma1
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.0, 80.0, 100.0, 120.0, 150.0, 170.0, 190.0, 200.0, 220.0, 250.0, 280.0, 300.0, 350.0, 400.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5, 10.0, 12.0, 15.0, 18.0, 20.0, 22.0, 25.0, 30.0, 35.0, 40.0, 45.0, 50.0]; % t_shift


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.979117e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1                2           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              190           0           0
 15  lag_freq(1).t_shift    0     1               25           0           0


Obsid 1H0707_comb_FM2
chi^2 = 6.433184e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+9.631144e-01 -0.000000e+00)
Parameter Gamma1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.400000e+00 (+9.665799e-02 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+5.347670e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+4.595973e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.900000e+02 (+7.428799e+00 -3.986924e+01)
Parameter t_shift = 2.500000e+01 (+2.924429e+00 -2.948727e+00)

...........................................................
1H0707-495-comb-FM-fit-error.sl
Submitted batch job 3919902

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.9]; % Gamma1
vals_to_fit[3] = [1.8, 1.9, 2.0, 2.1, 2.2, 2.4, 2.5, 2.6, 2.7, 2.8]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.0, 75.0, 100.0, 150.0, 200.0, 220.0, 250.0, 280.0, 300.0, 350.0, 380.0, 400.0, 450.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 8.0, 10.0, 12.0, 15.0, 18.0, 20.0, 25.0, 30.0, 35.0, 40.0, 50.0, 60.0, 70.0]; % t_shift


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.834649e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.9           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid 1H0707_comb_FM
chi^2 = 6.237110e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+9.789471e-02 -4.538536e-01)
Parameter Gamma1 = 2.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.500000e+00 (+4.881005e-02 -6.933853e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+4.583541e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+1.552315e-01 -2.627210e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.000000e+02 (+9.762009e+00 -4.914651e+01)
Parameter t_shift = 2.000000e+01 (+3.686395e+00 -1.410253e+00)



...........................................................
1H0707-495-comb-FM-fit-error2.sl
Submitted batch job 3919903


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.8]; % Gamma1
vals_to_fit[3] = [1.4, 1.6, 1.8, 2.0, 2.2, 2.4, 2.6, 2.7]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.0, 80.0, 100.0, 120.0, 150.0, 170.0, 190.0, 200.0, 220.0, 250.0, 280.0, 300.0, 350.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5, 10.0, 12.0, 15.0, 18.0, 20.0, 22.0, 25.0, 30.0, 35.0, 40.0, 45.0, 50.0]; % t_shift


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.984409e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0




...........................................................
1H0707-495-comb-FM-fit-error3.sl
Submitted batch job 3919904

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.7]; % Gamma1
vals_to_fit[3] = [1.4, 1.6, 1.8, 2.0, 2.2, 2.4, 2.6]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.0, 80.0, 100.0, 120.0, 150.0, 170.0, 190.0, 200.0, 220.0, 250.0, 280.0, 300.0, 350.0, 400.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5, 10.0, 12.0, 15.0, 18.0, 20.0, 22.0, 25.0, 30.0, 35.0, 40.0, 45.0, 50.0]; % t_shift


Obsid 1H0707_comb_FM2
chi^2 = 7.047105e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+9.087061e-01 -2.242376e-01)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+1.173011e-01 -1.316217e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+1.694158e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.000000e+02 (+2.092810e+01 -4.715108e+01)
Parameter t_shift = 2.000000e+01 (+3.431513e-02 -8.502292e-01)


...........................................................
1H0707-495-comb-FM-fit-error2.sl

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.393646e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              170           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid 1H0707_comb_FM3
chi^2 = 8.315989e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.343848e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+1.422369e-01 -1.292250e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+1.707711e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+4.359235e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.700000e+02 (+2.451461e+01 -1.132994e+01)
Parameter t_shift = 2.000000e+01 (+3.459345e-02 -4.005636e-01)

.....................................................................


1H0707-495-comb-FM-fit-error.sl
Submitted batch job 3920022


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.9]; % Gamma1
vals_to_fit[3] = [2.8]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.0, 75.0, 100.0, 150.0, 200.0, 220.0, 250.0, 280.0, 300.0, 350.0, 380.0, 400.0, 450.0]; % t_ma\
x (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 8.0, 10.0, 12.0, 15.0, 18.0, 20.0, 25.0, 30.0, 35.0, 40.0, 50.0, 60.0, 70.0]; % t_shift


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.098027e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.9           0           0
  8  lag_freq(1).Gamma2     0     1              2.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              350           0           0
 15  lag_freq(1).t_shift    0     1               60           0           0

Obsid 1H0707_comb_FM
chi^2 = 6.077862e+01 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.937984e-01 -0.000000e+00)
Parameter Gamma1 = 2.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -9.739766e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -8.074495e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.500000e+02 (+7.807033e-01 -4.037247e+01)
Parameter t_shift = 6.000000e+01 (+1.031608e+00 -9.238092e+00)

-----------------------------------------------------------------------

1H0707-495-comb-FM-fit-error2.sl
Submitted batch job 3920021

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.874712e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              350           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0

Obsid 1H0707_comb_FM2
chi^2 = 9.599870e+01 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+7.606667e-01 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -8.748010e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+4.286663e-01 -9.084824e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.500000e+02 (+3.976939e+01 -1.877310e+01)
Parameter t_shift = 5.000000e+01 (+0.000000e+00 -3.629136e+00)



-----------------------------------------------------------------------

1H0707-495-comb-FM-fit-error3.sl
Submitted batch job 3920020

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.873866e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              350           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0


Obsid 1H0707_comb_FM3
chi^2 = 9.768582e+01 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.003915e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -8.702846e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+1.563692e-01 -9.066864e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.500000e+02 (+4.017559e+01 -2.025842e+01)
Parameter t_shift = 5.000000e+01 (+0.000000e+00 -3.644468e+00)



-----------------------------------------------------------------------

1H0707-495-comb-FM-fit-error4.sl
Submitted batch job 3920023

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.711263e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              350           0           0
 15  lag_freq(1).t_shift    0     1               85           0           0

Obsid 1H0707_comb_FM4
chi^2 = 6.613355e+01 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+3.882595e-01 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -9.108768e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -9.265330e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.500000e+02 (+5.894994e+00 -1.528223e+01)
Parameter t_shift = 8.500000e+01 (+0.000000e+00 -1.323150e+01)

.....................................................................


1H0707-495-comb-FM-fit-error.sl
Submitted batch job 3920106

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.9]; % Gamma1
vals_to_fit[3] = [1.4, 1.8, 2.0, 2.4, 2.6, 2.8]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.0, 100.0, 150.0, 200.0, 250.0, 300.0, 350.0, 400.0, 450.0, 500.0, 550.0, 600.0, 650.0, 700.0,\
 800.0, 850.0, 900.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10.0, 12.0, 15.0, 18.0, 20.0, 25.0, 30.0, 35.0, 40.0, 50.0, 55.0, 60.0, 70.0, 90.0, 100.0,\
 120.0, 140.0, 160.0, 200.0]; % t_shift


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.204172e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.9           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               40           0           0


Obsid 1H0707_comb_FM
chi^2 = 1.402995e+01 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.384492e+00 -0.000000e+00)
Parameter Gamma1 = 2.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+2.432789e-02 -5.755513e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -9.820476e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+3.680203e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.000000e+02 (+5.715132e+01 -4.910238e+01)
Parameter t_shift = 4.000000e+01 (+3.675757e+00 -7.553149e+00)

..................................................................................

#+END_EXAMPLE

######################
#####################

Decreasing Gamma

######################

#+BEGIN_EXAMPLE

1H0707-495-comb-FM-fit-error4.sl
Submitted batch job 3920657


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.2]; % Gamma1
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
 vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.0, 80.0, 100.0, 120.0, 150.0, 170.0, 190.0, 200.0, 220.0, 250.0, 280.0, 300.0, 350.0, 400.0, \
450.0, 500.0, 550.0, 600.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5, 10.0, 12.0, 15.0, 18.0, 20.0, 22.0, 25.0, 28.0, 30.0, 35.0, 40.0, 45.0, 50.0, 60.0, 70.0, 85\
.0]; % t_shift


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.104519e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              190           0           0
 15  lag_freq(1).t_shift    0     1               25           0           0


Obsid 1H0707_comb_FM4
chi^2 = 6.514584e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.085940e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.600000e+00 (+1.152924e-01 -1.914060e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+1.563544e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+7.645054e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.900000e+02 (+1.500901e+01 -3.986761e+01)
Parameter t_shift = 2.500000e+01 (+5.129948e-02 -2.948701e+00)

................................................

1H0707-495-comb-FM-fit-error5.sl
Submitted batch job 3920659


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.1]; % Gamma1
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.0, 80.0, 100.0, 120.0, 150.0, 170.0, 190.0, 200.0, 220.0, 250.0, 280.0, 300.0, 350.0, 400.0, \
450.0, 500.0, 550.0, 600.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5, 10.0, 12.0, 15.0, 18.0, 20.0, 22.0, 25.0, 28.0, 30.0, 35.0, 40.0, 45.0, 50.0, 60.0, 70.0, 85\
.0]; % t_shift


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      3.13657e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.1           0           0
  8  lag_freq(1).Gamma2     0     1              1.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              190           0           0
 15  lag_freq(1).t_shift    0     1               25           0           0


Obsid 1H0707_comb_FM5
chi^2 = 6.351264e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.300169e+00 -0.000000e+00)
Parameter Gamma1 = 2.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.500000e+00 (+1.266934e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+1.276621e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+8.075761e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.900000e+02 (+1.589756e+01 -3.930854e+01)
Parameter t_shift = 2.500000e+01 (+5.124659e-02 -2.948753e+00)


......................................................

1H0707-495-comb-FM-fit-error6.sl
Submitted batch job 3920752


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.0]; % Gamma1
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.0, 80.0, 100.0, 120.0, 150.0, 170.0, 190.0, 200.0, 220.0, 250.0, 280.0, 300.0, 350.0, 400.0, \
450.0, 500.0, 550.0, 600.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5, 10.0, 12.0, 15.0, 18.0, 20.0, 22.0, 25.0, 28.0, 30.0, 35.0, 40.0, 45.0, 50.0, 60.0, 70.0, 85\
.0]; % t_shift


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.979117e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1                2           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              190           0           0
 15  lag_freq(1).t_shift    0     1               25           0           0


Obsid 1H0707_comb_FM6
chi^2 = 6.433184e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+9.631144e-01 -0.000000e+00)
Parameter Gamma1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.400000e+00 (+9.665799e-02 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+5.347670e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+4.595973e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.900000e+02 (+7.428799e+00 -3.986924e+01)
Parameter t_shift = 2.500000e+01 (+5.127311e-02 -2.948727e+00)

....................................................................

1H0707-495-comb-FM-fit-error4.sl
Submitted batch job 3921048

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [1.9]; % Gamma1
vals_to_fit[3] = [1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.0, 80.0, 100.0, 120.0, 150.0, 170.0, 190.0, 200.0, 220.0, 250.0, 280.0, 300.0,\
 350.0, 400.0, 450.0, 500.0, 550.0, 600.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5, 10.0, 12.0, 15.0, 18.0, 20.0, 22.0, 25.0, 28.0, 30.0, 35.0, 40.0, 45.0, 50.0,\
 60.0, 70.0, 85.0]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.927259e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.9           0           0
  8  lag_freq(1).Gamma2     0     1              1.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0


Obsid 1H0707_comb_FM4
chi^2 = 1.212043e+01 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.083323e+00 -0.000000e+00)
Parameter Gamma1 = 1.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.600000e+00 (+1.160960e-02 -2.982960e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+3.439004e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+3.562378e+01 -3.227363e+01)
Parameter t_shift = 5.000000e+01 (+1.160960e+00 -1.443538e+00)


...................................................................

1H0707-495-comb-FM-fit-error5.sl
Submitted batch job 3921049

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [1.8]; % Gamma1
vals_to_fit[3] = [1.2, 1.3, 1.4, 1.5, 1.6, 1.7]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.0, 80.0, 100.0, 120.0, 150.0, 170.0, 190.0, 200.0, 220.0, 250.0, 280.0, 300.0,\
 350.0, 400.0, 450.0, 500.0, 550.0, 600.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5, 10.0, 12.0, 15.0, 18.0, 20.0, 22.0, 25.0, 28.0, 30.0, 35.0, 40.0, 45.0, 50.0,\
 60.0, 70.0, 85.0]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.063871e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.8           0           0
  8  lag_freq(1).Gamma2     0     1              1.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0

Obsid 1H0707_comb_FM5
chi^2 = 1.296356e+01 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.186924e+00 -0.000000e+00)
Parameter Gamma1 = 1.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.500000e+00 (+1.131469e-02 -1.990410e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+3.384920e-01 -6.706068e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+3.597226e+01 -4.482661e+01)
Parameter t_shift = 5.000000e+01 (+1.174393e+00 -1.318895e+00)



.....................................................................

1H0707-495-comb-FM-fit-error6.sl
Submitted batch job 3921097

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [1.7]; % Gamma1
vals_to_fit[3] = [1.2, 1.3, 1.4, 1.5, 1.6]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.0, 80.0, 100.0, 120.0, 150.0, 170.0, 190.0, 200.0, 220.0, 250.0, 280.0, 300.0,\
 350.0, 400.0, 450.0, 500.0, 550.0, 600.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5, 10.0, 12.0, 15.0, 18.0, 20.0, 22.0, 25.0, 28.0, 30.0, 35.0, 40.0, 45.0, 50.0,\
 60.0, 70.0, 85.0]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      2.12142e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.7           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0

Obsid 1H0707_comb_FM6
chi^2 = 1.849533e+01 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+2.990365e-01 -0.000000e+00)
Parameter Gamma1 = 1.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.400000e+00 (+9.747688e-03 -9.814995e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -3.652424e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+2.355088e-01 -9.307764e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+5.235673e+01 -4.959975e+01)
Parameter t_shift = 5.000000e+01 (+1.131434e+00 -3.325546e+00)

#+END_EXAMPLE

#################################
#################################

Fix the mass at 6.1

##############################


#+BEGIN_EXAMPLE

1H0707-495-comb-FM-fit-error.sl
Submitted batch job 3920588

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.880146e-05           0       0.001
  2  lag_freq(1).log_mass   0     1              6.1           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.9           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               35           0           0


Obsid 1H0707_comb_FM
chi^2 = 8.499059e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+3.573695e-01 -1.478438e-01)
Parameter Gamma1 = 2.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+1.435596e-01 -1.102849e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+4.260448e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.354899e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+2.880999e+01 -1.326414e+01)
Parameter t_shift = 3.500000e+01 (+1.070642e+01 -1.514163e+00)

...................................................................

1H0707-495-comb-FM-fit-error2.sl
Submitted batch job 3920590

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.950238e-05           0       0.001
  2  lag_freq(1).log_mass   0     1              6.1           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              350           0           0
 15  lag_freq(1).t_shift    0     1               70           0           0

Obsid 1H0707_comb_FM2
chi^2 = 4.597380e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+1.972406e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+5.684792e-02 -1.973807e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+7.325180e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+5.684792e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.500000e+02 (+5.876143e+01 -6.866147e+01)
Parameter t_shift = 7.000000e+01 (+5.684792e+00 -3.944628e+01)



..................................................................

1H0707-495-comb-FM-fit-error3.sl
Submitted batch job 3920595

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.051101e-05           0       0.001
  2  lag_freq(1).log_mass   0     1              6.1           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0

Obsid 1H0707_comb_FM3
chi^2 = 9.903334e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.057507e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -9.595303e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+1.106133e-01 -9.260838e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.000000e+02 (+6.931082e+01 -9.826660e+01)
Parameter t_shift = 8.000000e+01 (+7.305095e+00 -7.467258e+00)


.................................................................

1H0707-495-comb-FM-fit-error.sl
Submitted batch job 3920651

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.249877e-05           0       0.001
  2  lag_freq(1).log_mass   0     1              6.1           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              350           0           0
 15  lag_freq(1).t_shift    0     1               70           0           0



Obsid 1H0707_comb_FM
chi^2 = 4.192618e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+2.719761e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+3.360468e-02 -1.272439e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+7.745774e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+4.711777e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.500000e+02 (+5.831812e+01 -6.362193e+00)
Parameter t_shift = 7.000000e+01 (+6.720936e+00 -2.406533e+01)

.................................................................


1H0707-495-comb-FM-fit-error3.sl
Submitted batch job 3920653

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.738447e-05           0       0.001
  2  lag_freq(1).log_mass   0     1              6.1           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              350           0           0
 15  lag_freq(1).t_shift    0     1               60           0           0


Obsid 1H0707_comb_FM3
chi^2 = 4.900568e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+2.712885e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+3.740346e-02 -1.490067e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+6.552124e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.500000e+02 (+6.896030e+01 -8.707709e+01)
Parameter t_shift = 6.000000e+01 (+1.654999e+01 -2.624673e+01)



#####################
###################

M = 6.02 -6.5

####################

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.6]; % Gamma1
vals_to_fit[3] = [1.4, 1.6, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.0, 100.0, 150.0, 200.0, 250.0, 300.0, 350.0, 400.0, 450.0,\
 470.0, 500.0, 520.0, 550.0, 600.0, 650.0, 700.0, 800.0, 850.0, 900.0]; % t_max\
 (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10.0, 12.0, 15.0, 18.0, 20.0, 25.0, 30.0, 35.0, 40.0, 5\
0.0, 55.0, 60.0, 70.0, 90.0, 100.0, 120.0, 140.0, 160.0, 200.0]; % t_shift

1H0707-495-comb-FM-fit-error.sl
Submitted batch job 3921099

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.508678e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.02           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              600           0           0
 15  lag_freq(1).t_shift    0     1               90           0           0

Obsid 1H0707_comb_FM
chi^2 = 2.714416e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+2.285575e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.500000e+00 (+0.000000e+00 -1.859749e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -7.007857e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+3.656611e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.000000e+02 (+8.349410e-01 -7.986695e+01)
Parameter t_shift = 9.000000e+01 (+6.224539e+00 -4.038117e+00)

........................................................

1H0707-495-comb-FM-fit-error2.sl
Submitted batch job 3921101

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.945349e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.05           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              550           0           0
 15  lag_freq(1).t_shift    0     1               90           0           0


Obsid 1H0707_comb_FM2
chi^2 = 3.728020e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+3.870833e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.700000e+00 (+0.000000e+00 -1.614167e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -6.466236e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.500000e+02 (+5.024431e+01 -2.366001e+02)
Parameter t_shift = 9.000000e+01 (+3.374776e+00 -2.252070e+01)


.......................................................

1H0707-495-comb-FM-fit-error3.sl
Submitted batch job 3921158

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      3.38702e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.05           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0


Obsid 1H0707_comb_FM3
chi^2 = 3.684443e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+3.147827e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+0.000000e+00 -6.217860e-03)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+3.414930e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.111197e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+1.627496e+02 -8.768644e+01)
Parameter t_shift = 8.000000e+01 (+1.072777e+01 -1.210617e+01)

...................................

1H0707-495-comb-FM-fit-error.sl
Submitted batch job 3922282

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.6]; % Gamma1
vals_to_fit[3] = [1.4, 1.6, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.00, 150.0, 200.0, 250.0, 300.0, 350.0, 400.0, 450.0, 470.0\
, 500.0, 520.0, 550.0, 580.0, 590.0, 600.0, 620.0, 630.0, 650.0, 660.0, 700.0, \
800.0, 850.0, 900.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10.0, 12.0, 15.0, 18.0, 20.0, 25.0, 30.0, 35.0, 40.0, 5\
0.0, 55.0, 60.0, 70.0, 80.0, 85.0, 90.0, 95.0, 100.0, 120.0, 140.0, 160.0, 200.\
0]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.575079e-05           0       0.001
  2  lag_freq(1).log_mass   0     1            6.025           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               55           0           0

Obsid 1H0707_comb_FM
chi^2 = 2.679942e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+4.332828e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.500000e+00 (+0.000000e+00 -1.590989e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -7.019220e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+5.019818e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.800000e+02 (+2.032972e+01 -5.958043e+01)
Parameter t_shift = 9.500000e+01 (+3.271918e+00 -1.807723e+01)

......................................


1H0707-495-comb-FM-fit-error2.sl
Submitted batch job 3922283

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.8]; % Gamma1
vals_to_fit[3] = [1.6, 1.7, 1.8, 2.0, 2.2, 2.5, 2.6, 2.7]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.0, 80.0, 100.0, 120.0, 150.0, 170.0, 190.0, 200.0, 220.0, \
250.0, 280.0, 300.0, 350.0, 400.0, 450.0, 450.0, 500.0, 550.0, 580.0, 600.0, 62\
0.0, 650.0, 700.0, 750.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5, 10.0, 20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100\
.0, 110.0, 120.0]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      4.36123e-05           0       0.001
  2  lag_freq(1).log_mass   0     1            6.025           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              580           0           0
 15  lag_freq(1).t_shift    0     1               90           0           0


Obsid 1H0707_comb_FM2
chi^2 = 2.369402e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.940624e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.700000e+00 (+0.000000e+00 -1.791846e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -6.923748e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+5.859180e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.800000e+02 (+2.032522e+01 -5.980427e+01)
Parameter t_shift = 9.000000e+01 (+5.002098e+00 -1.438482e+01)


...................................

1H0707-495-comb-FM-fit-error3.sl
Submitted batch job 3922285


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.6]; % Gamma1
vals_to_fit[3] = [1.4, 1.6, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.00, 150.0, 200.0, 250.0, 300.0, 350.0, 400.0, 450.0, 470.0\
, 500.0, 520.0, 550.0, 580.0, 590.0, 600.0, 620.0, 630.0, 650.0, 660.0, 700.0, \
800.0, 850.0, 900.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10.0, 12.0, 15.0, 18.0, 20.0, 25.0, 30.0, 35.0, 40.0, 5\
0.0, 55.0, 60.0, 70.0, 80.0, 85.0, 90.0, 95.0, 100.0, 120.0, 140.0, 160.0, 200.\
0]; % t_shift


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      3.38702e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.05           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0

Obsid 1H0707_comb_FM3
chi^2 = 3.684443e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+3.147827e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+0.000000e+00 -6.217860e-03)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+3.414930e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.111197e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+1.627496e+02 -8.768644e+01)
Parameter t_shift = 8.000000e+01 (+1.072777e+01 -1.210617e+01)

...........................................................


1H0707-495-comb-FM-fit-error.sl

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.511163e-05           0       0.001
  2  lag_freq(1).log_mass   0     1            6.015           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              580           0           0
 15  lag_freq(1).t_shift    0     1               95           0           0


Obsid 1H0707_comb_FM
chi^2 = 2.412027e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+4.270761e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.500000e+00 (+0.000000e+00 -1.652580e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -7.222650e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+4.534590e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.800000e+02 (+2.030395e+01 -5.968590e+01)
Parameter t_shift = 9.500000e+01 (+4.340185e+00 -5.280527e+00)


#+END_EXAMPLE


###############
#############

Use Hi gamma and drop Tshift to include zero

###################
#################

#+BEGIN_EXAMPLE

1H0707-495-comb-FM-fit-error2.sl
Submitted batch job 3925140

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [3.0]; % Gamma1
vals_to_fit[3] = [2.7, 2.8, 2.9]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [10.0, 50.0, 100.0, 150.0, 200.0, 300.0, 350.0, 400.0, 450.0, 500.0, 550.0, 600.0, 650.0, 700.0, 800.0, \
850.0, 900.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [0.0, 5.0, 10.0, 15.0, 20.0, 25.0, 30.0, 35.0, 40.0, 50.0, 55.0, 60.0, 70.0, 80.0, 85.0, 90.0, 95.0, 10\
0.0, 150.0, 200.0]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.166386e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0


Obsid 1H0707_comb_FM2
chi^2 = 1.199558e+01 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+7.680237e-01 -0.000000e+00)
Parameter Gamma1 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.800000e+00 (+1.175096e-02 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -9.822867e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+3.525653e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+2.048195e+01 -1.497673e+02)
Parameter t_shift = 5.000000e+01 (+1.762827e+00 -1.276579e+01)

......................................................

1H0707-495-comb-FM-fit-error3.sl
Submitted batch job 3925141

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.6]; % Gamma1
vals_to_fit[3] = [1.4, 1.6, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.00, 100.0, 150.0, 200.0, 250.0, 300.0, 350.0, 400.0, 450.0, 470.0, 500.0, 520.0, 550.0, 580.0, 590.0\
, 600.0, 650.0, 700.0, 800.0, 900.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10.0, 12.0, 15.0, 18.0, 20.0, 25.0, 30.0, 35.0, 40.0, 50.0, 55.0, 60.0, 70.0, 80.0, 85.0, 90.0, 9\
5.0, 100.0, 120.0, 140.0, 160.0, 200.0]; % t_shift


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.167491e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid 1H0707_comb_FM3
chi^2 = 8.081040e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+1.751087e-01 -1.025582e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.100000e+00 (+1.243344e-01 -6.736668e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+2.586283e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.000000e+02 (+1.621872e+01 -3.336654e+01)
Parameter t_shift = 2.000000e+01 (+8.005985e+00 -1.363596e+00)

.........................................................

1H0707-495-comb-FM-fit-error4.sl
Submitted batch job 3925144

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.9]; % Gamma1
vals_to_fit[3] = [2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [20.0, 50.00, 80.0, 100.0, 150.0, 170.0, 200.0, 250.0, 300.0, 350.0, 400.0, 450.0, 500.0, 600.0, 800.0, \
 900.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10.0, 12.0, 15.0, 18.0, 20.0, 25.0, 30.0, 35.0, 40.0, 50.0, 55.0, 60.0, 70.0, 80.0, 85.0, 90.0, 9\
5.0, 100.0, 140.0, ]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.834649e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.9           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid 1H0707_comb_FM4
chi^2 = 6.237110e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+9.789471e-02 -4.538536e-01)
Parameter Gamma1 = 2.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.500000e+00 (+3.472419e-02 -6.933853e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+4.583541e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+1.996107e-01 -2.627210e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.000000e+02 (+1.400824e+01 -2.948790e+01)
Parameter t_shift = 2.000000e+01 (+3.686395e+00 -1.410253e+00)

..........................................................

1H0707-495-comb-FM-fit-error2.sl
Submitted batch job 3925149

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [3.0]; % Gamma1
vals_to_fit[3] = [2.7, 2.8, 2.9]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [10.0, 50.0, 100.0, 150.0, 180.0, 190.0, 200.0, 220.0, 250.0, 300.0, 350.0, 400.0, 450.0, 500.0, 550.0, \
600.0, 650.0, 700.0, 800.0, 850.0, 900.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [0.0, 5.0, 10.0, 15.0, 20.0, 25.0, 30.0, 35.0, 40.0, 50.0, 55.0, 60.0, 70.0, 80.0, 85.0, 90.0, 95.0, 10\
0.0, 150.0, 200.0]; % t_shift


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      2.14036e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              220           0           0
 15  lag_freq(1).t_shift    0     1               40           0           0


Obsid 1H0707_comb_FM2
chi^2 = 1.180287e+01 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+7.281945e-01 -0.000000e+00)
Parameter Gamma1 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.700000e+00 (+1.109141e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -9.823090e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.327457e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.200000e+02 (+1.956939e+01 -2.848142e+01)
Parameter t_shift = 4.000000e+01 (+1.163728e+01 -1.408662e+00)

............................................

1H0707-495-comb-FM-fit-error4.sl
Submitted batch job 3925153


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.9]; % Gamma1
vals_to_fit[3] = [2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [20.0, 50.00, 80.0, 100.0, 150.0, 170.0, 180.0, 200.0, 210.0, 22.0, 250.0, 300.0, 350.0, 400.0, 450.0, 5\
00.0, 600.0, 800.0,  900.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10.0, 12.0, 15.0, 18.0, 20.0, 25.0, 30.0, 35.0, 40.0, 50.0, 55.0, 60.0, 70.0, 80.0, 85.0, 90.0, 9\
5.0, 100.0, 140.0, ]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.834649e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.9           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid 1H0707_comb_FM4
chi^2 = 6.237110e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+9.789471e-02 -0.000000e+00)
Parameter Gamma1 = 2.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.500000e+00 (+4.565506e-02 -1.976028e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+4.583541e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+1.996107e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.000000e+02 (+4.565506e+00 -2.986899e+01)
Parameter t_shift = 2.000000e+01 (+3.686395e+00 -1.410253e+00)

.................................................

1H0707-495-comb-FM-fit-error2.sl
Submitted batch job 3925191

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.8]; % Gamma1
vals_to_fit[3] = [2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [10.0, 50.0, 100.0, 150.0, 180.0, 190.0, 200.0, 220.0, 250.0, 300.0, 350.0, 400.0, 450.0, 500.0, 550.0, \
600.0, 650.0, 700.0, 800.0, 850.0, 900.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [0.0, 5.0, 10.0, 15.0, 20.0, 25.0, 30.0, 35.0, 40.0, 50.0, 55.0, 60.0, 70.0, 80.0, 85.0, 90.0, 95.0, 10\
0.0, 150.0, 200.0]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.739119e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              180           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Obsid 1H0707_comb_FM2
chi^2 = 6.963585e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+2.880659e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+5.514609e-02 -1.767295e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.202166e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.800000e+02 (+4.112743e+01 -1.911035e+01)
Parameter t_shift = 2.000000e+01 (+5.456773e+00 -2.093138e+00)


................................................................

1H0707-495-comb-FM-fit-error.sl
Submitted batch job 3925192

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.6, 2.7, 2.8]; % Gamma1
vals_to_fit[3] = [2.2, 2.3, 2.4, 2.5, 2.6, 2.7]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [0.0, 20.0, 50.00, 100.0, 150.0, 200.0, 250.0, 300.0, 350.0, 400.0, 450.0, 470.0, 500.0, 550.0, 600.0, 6\
50.0, 700.0, 800.0, 850.0, 900.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10.0, 12.0, 15.0, 18.0, 20.0, 25.0, 30.0, 35.0, 40.0, 50.0, 55.0, 60.0, 70.0, 80.0, 85.0, 90.0, 9\
5.0, 100.0, 105.0, 120.0, 140.0, 160.0, 200.0]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.984409e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Obsid 1H0707_comb_FM
chi^2 = 7.047105e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+1.001912e+00 -2.792115e-01)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+5.711012e-02 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+2.086042e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.000000e+02 (+1.525812e+01 -3.164493e+01)
Parameter t_shift = 2.000000e+01 (+5.973866e+00 -1.382526e+00)


........................................................

1H0707-495-comb-FM-fit-error2.sl
Submitted batch job 3925233

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.4]; % Gamma1
vals_to_fit[3] = [1.8, 2.0, 2.1, 2.2, 2.3]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [10.0, 50.0, 80.0, 100.0, 150.0, 180.0, 190.0, 200.0, 220.0, 250.0, 300.0, 350.0, 400.0, 450.0, 5\
00.0, 550.0, 600.0, 650.0, 700.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [0.0, 5.0, 10.0, 15.0, 20.0, 25.0, 30.0, 35.0, 40.0, 50.0, 55.0, 60.0, 70.0, 80.0, 85.0, 90.0, 9\
5.0, 100.0, 120.0,]; % t_shift


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     6.070348e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Obsid 1H0707_comb_FM2
chi^2 = 5.934916e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+2.824208e-01 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+3.435618e-02 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+2.000309e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.000000e+02 (+1.696550e+01 -4.723343e+01)
Parameter t_shift = 2.000000e+01 (+5.023422e+00 -3.504386e+00)



................................................................

1H0707-495-comb-FM-fit-error3.sl
Submitted batch job 3925238



vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.3]; % Gamma1
vals_to_fit[3] = [1.4, 1.6, 1.8, 2.0, 2.1, 2.2]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [10.0, 50.00, 80.0, 100.0, 120.0, 150.0, 200.0, 250.0, 300.0, 350.0, 400.0, 450.0, 470.0, 500.0, \
520.0, 550.0, 580.0, 590.0, 600.0, 650.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10.0, 15.0, 20.0, 25.0, 30.0, 35.0, 40.0, 50.0, 55.0, 60.0, 70.0, 80.0, 85.0, 90.0, 95.0, \
100.0, 120.0]; % t_shift



lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.613057e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0



Obsid 1H0707_comb_FM3
chi^2 = 1.082610e+01 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.465920e+00 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+2.396651e-01 -2.815802e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.258612e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.000000e+02 (+1.654339e+01 -3.121377e+01)
Parameter t_shift = 3.000000e+01 (+4.476038e+00 -1.460988e+01)

....................................................





#+END_EXAMPLE

###############
################

use gamma 1 < gamma 2

#####################
#############

#+BEGIN_EXAMPLE
1H0707-495-comb-FM-fit-error3.sl
Submitted batch job 3925207

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.6]; % Gamma1
vals_to_fit[3] = [2.7, 2.8, 2.9, 3.0]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.00, 100.0, 150.0, 200.0, 250.0, 300.0, 350.0, 400.0, 450.0, 470.0, 500.0, 520.0, 550.0, 580.0\
, 590.0, 600.0, 650.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10.0, 15.0, 20.0, 25.0, 30.0, 35.0, 40.0, 50.0, 55.0, 60.0, 70.0, 80.0, 85.0, 90.0, 95.0, \
100.0, 120.0]; % t_shift

################################

Model fails!1! ##################

###############################

Obsid 1H0707_comb_FM3
chi^2 = 1.647618e+02 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.000000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.500000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 1.200000e+02 (+0.000000e+00 -0.000000e+00)
#+END_EXAMPLE

*** Combined FM = 6.03, 6.1

M = 6.03

#+BEGIN_EXAMPLE
1H0707-comb-fit-error.sl
Submitted batch job 4012472

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.280247e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.03         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              570           0           0
 15  lag_freq(1).t_shift    0     1               90           0           0



Obsid 1H0707_comb
chi^2 = 2.056477e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+2.709448e+00 -0.000000e+00)
Parameter Gamma1 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+9.177618e-01 -1.998474e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.700000e+02 (+4.051506e+01 -4.362992e+01)
Parameter t_shift = 9.000000e+01 (+4.427871e+00 -1.901045e+01)

#+END_EXAMPLE

M = 6.1

#+BEGIN_EXAMPLE
Submitted batch job 4012498


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      2.88709e-05           0       0.001
  2  lag_freq(1).log_mass   0     1              6.1         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              350           0           0
 15  lag_freq(1).t_shift    0     1               70           0           0


Obsid 1H0707_comb
chi^2 = 4.658730e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+1.938283e+00 -0.000000e+00)
Parameter Gamma1 = 3.000000e+00 (+0.000000e+00 -1.396653e-01)
Parameter Gamma2 = 2.800000e+00 (+3.410662e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+5.759017e-01 -9.830984e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.500000e+02 (+4.170030e+01 -0.000000e+00)
Parameter t_shift = 7.000000e+01 (+5.759017e+00 -3.878550e+01)




#+END_EXAMPLE


M = 6.15

#+BEGIN_EXAMPLE
1H0707-comb-fit-error.sl
Submitted batch job 4016701

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.026637e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.15         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               60           0           0

Obsid 1H0707_comb
chi^2 = 5.681542e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.840663e+00 -0.000000e+00)
Parameter Gamma1 = 3.000000e+00 (+8.878300e-02 -1.683769e-01)
Parameter Gamma2 = 2.800000e+00 (+8.628258e-02 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -2.996797e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+7.293004e-01 -9.829897e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+7.688525e+01 -0.000000e+00)
Parameter t_shift = 6.000000e+01 (+7.293004e+00 -1.216862e+01)



#+END_EXAMPLE

*** Results

PATH =/home/steff075/phd_ecm/ecm_model/1H0707-comb-FM.csv=

PATH =/home/steff075/phd_ecm/ecm_model/1H0707-comb-FM.vsz=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-comb-FM.png

*** Fixed Mass behaviour

PATH =/home/steff075/phd_ecm/ecm_model/1H0707-comb-FM.csv=

PATH =/home/steff075/phd_ecm/ecm_model/1H0707-model-pars-V-chi-sq-FM.vsz=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-model-pars-V-chi-sq-FM.png

*** *Lo flux variable mass fits*

PATH =/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495-loflux-fit-error.sl=

#+BEGIN_EXAMPLE
isis-script 1H0707-495-loflux-fit-error.sl fit plot

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001326689           0       0.001
  2  lag_freq(1).log_mass   0     0         6.253955           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0

runtime 2339 - 2349 = 10 mins

Obsid 1H0707_loflux
chi^2 = 4.906172e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+4.531211e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+6.654365e-02 -3.809926e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+1.744554e+00 -2.842614e+01)
Parameter t_shift = 3.000000e+01 (+3.023133e+01 -0.000000e+00)

..............................................................................

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.7]; % Gamma1
vals_to_fit[3] = [1.9, 2.0, 2.1, 2.3, 2.4, 2.5, 2.6]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [180.0, 200.0, 220.0, 250.0, 300.0, 350.0, 370.0, 400.0, 420.0, 440.0, 450.0, 460.0, 480.0, 500.0, 550.0, 600.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [10.0, 20.0, 30.0, 40.0, 45.0, 50.0, 55.0, 60.0, 65.0, 70.0, 75.0, 80.0, 85.0, 90.0, 95.0, 100.0]; % t_shift


run 2357 - 0050 = 53 mins

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001074851           0       0.001
  2  lag_freq(1).log_mass   0     0         6.164274           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0


Obsid 1H0707_loflux
chi^2 = 2.145210e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+2.360925e-01 -2.241864e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.500000e+02 (+9.142557e+01 -0.000000e+00)
Parameter t_shift = 1.000000e+01 (+2.671087e+01 -0.000000e+00)

................................................................................

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.7]; % Gamma1
vals_to_fit[3] = [2.0, 2.1, 2.3, 2.4, 2.5]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [200.0, 220.0, 240.0, 245.0, 250.0, 260.0, 300.0, 350.0, 400.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 8.0, 9.0, 10.0, 11.0, 12.0, 15.0, 20.0, 30.0, 45.0, 60.0, 90.0, 100.0]; % t_shift

run time 6.36m

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001074851           0       0.001
  2  lag_freq(1).log_mass   0     0         6.164274           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0

Obsid 1H0707_loflux
chi^2 = 2.145210e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.500000e+02 (+9.142557e+01 -0.000000e+00)
Parameter t_shift = 1.000000e+01 (+8.009893e-02 -9.199011e-01)


..........................................................

1H0707-495-loflux-fit-error.sl
Submitted batch job 3922513

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001074851           0       0.001
  2  lag_freq(1).log_mass   0     0         6.164274         5.9         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0

Obsid 1H0707_loflux
chi^2 = 2.145210e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+2.225566e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.500000e+02 (+9.142557e+01 -6.958981e+01)
Parameter t_shift = 1.000000e+01 (+9.255841e+00 -0.000000e+00)

..........................................................

1H0707-495-loflux-fit-error2.sl
Submitted batch job 3922514


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     9.524307e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.264723         5.9         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1                5           0           0


.Obsid 1H0707_loflux2
chi^2 = 2.156081e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+2.817047e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.100000e+00 (+3.528530e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.200000e+02 (+1.190032e+02 -3.985921e+01)
Parameter t_shift = 1.000000e+01 (+9.354022e+00 -0.000000e+00)

.....................................................

1H0707-495-loflux-fit-error3.sl
Submitted batch job 3922515

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001056899           0       0.001
  2  lag_freq(1).log_mass   0     0         6.126946         5.9         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                7           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0

Obsid 1H0707_loflux3
chi^2 = 2.314884e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 7.000000e+00 (+7.246505e-01 -0.000000e+00)
Parameter Gamma1 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.900000e+00 (+4.171635e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.500000e+02 (+9.421015e+01 -7.490459e+01)
Parameter t_shift = 1.000000e+01 (+9.373378e+00 -0.000000e+00)

.................................................................

1H0707-495-loflux-fit-error.sl
Submitted batch job 3923862


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.5]; % Gamma1
vals_to_fit[3] = [2.0, 2.1, 2.2, 2.3, 2.4]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [150.0, 200.0, 210.0, 220.0, 230.0, 240.0, 250.0, 280.0, 300.0, 350.0, 380.0, 400.0, 500.0, \
550.0, 600.00, ]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10, 15.0, 20,0, 25.0, 30.0, 40.0, 50.0, 60.0, 700.,80.0, 90.0, 100.0 ]; % t_shift


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001099133           0       0.001
  2  lag_freq(1).log_mass   0     0         6.164736         5.9         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              240           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0


Obsid 1H0707_loflux
chi^2 = 2.194202e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+2.221992e+00 -0.000000e+00)
Parameter Gamma1 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+3.127437e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.400000e+02 (+1.022172e+02 -6.625659e+01)
Parameter t_shift = 1.000000e+01 (+9.449024e+00 -0.000000e+00)

..............................................................

1H0707-495-loflux-fit-error2.sl
Submitted batch job 3923863



vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.7]; % Gamma1
vals_to_fit[3] = [2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [150.0, 200.0, 210.0, 220.0, 230.0, 240.0, 250.0, 280.0, 300.0, 350.0, 380.0, 400.0, 500.0, \
550.0, 600.00, ]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10, 15.0, 20,0, 25.0, 30.0, 40.0, 50.0, 60.0, 700.,80.0, 90.0, 100.0 ]; % t_shift


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001046856           0       0.001
  2  lag_freq(1).log_mass   0     0         6.134793         5.9         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                7           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              240           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0

Obsid 1H0707_loflux2
chi^2 = 2.139932e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 7.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+3.223556e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.400000e+02 (+1.101108e+02 -5.965280e+01)
Parameter t_shift = 1.000000e+01 (+9.259111e+00 -0.000000e+00)

................................................................

1H0707-495-loflux-fit-error3.sl
Submitted batch job 3923867

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.4]; % Gamma1
vals_to_fit[3] = [1.4, 1.6, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [150.0, 200.0, 220.0, 240.0, 250.0, 280.0, 300.0, 350.0, 380.0, 400.0, 500.0, 550.0, 600.00,\
 ]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10.0, 15.0, 20,0, 25.0, 30.0, 35.0, 40.0, 50.0, 60.0, 700.,80.0, 90.0, 100.0 ]; % t_s\
hift


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001056899           0       0.001
  2  lag_freq(1).log_mass   0     0         6.126946         5.9         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                7           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0


Obsid 1H0707_loflux3
chi^2 = 2.314884e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 7.000000e+00 (+7.246505e-01 -0.000000e+00)
Parameter Gamma1 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.900000e+00 (+4.171635e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.500000e+02 (+9.421015e+01 -7.490459e+01)
Parameter t_shift = 1.000000e+01 (+9.373378e+00 -0.000000e+00)

.............................................

1H0707-495-loflux-fit-error4.sl
Submitted batch job 3923892


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.3]; % Gamma1
vals_to_fit[3] = [1.4, 1.6, 1.8, 1.9, 2.0, 2.1, 2.2]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [150.0, 200.0, 220.0, 240.0, 250.0, 280.0, 300.0, 350.0, 380.0, 400.0, 500.0, 550.0, 600.00,\
 ]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10.0, 15.0, 20,0, 25.0, 30.0, 35.0, 40.0, 50.0, 60.0, 700.,80.0, 90.0, 100.0 ]; % t_s\
hift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001143545           0       0.001
  2  lag_freq(1).log_mass   0     0         6.145208         5.9         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              240           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0

Obsid 1H0707_loflux4
chi^2 = 2.638725e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+3.459239e+00 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+3.427541e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.400000e+02 (+9.893322e+01 -5.290664e+01)
Parameter t_shift = 1.000000e+01 (+9.730751e+00 -0.000000e+00)

............................................................

1H0707-495-loflux-fit-error.sl
Submitted batch job 3924064


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.8]; % Gamma1
vals_to_fit[3] = [2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [150.0, 200.0, 210.0, 220.0, 230.0, 240.0, 250.0, 280.0, 300.0, 350.0, 380.0, 400.0, 500.0, 550.0,\
 600.00, ]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10, 15.0, 20,0, 25.0, 30.0, 40.0, 50.0, 60.0, 700.,80.0, 90.0, 100.0 ]; % t_shift


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001093006           0       0.001
  2  lag_freq(1).log_mass   0     0         6.164736         5.9         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              240           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0

Obsid 1H0707_loflux
chi^2 = 1.838960e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+2.228890e-01 -2.361782e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.400000e+02 (+1.040053e+02 -5.951409e+01)
Parameter t_shift = 1.000000e+01 (+9.277356e+00 -0.000000e+00)

...............................................................

1H0707-495-loflux-fit-error2.sl
Submitted batch job 3924068


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.9]; % Gamma1
vals_to_fit[3] = [2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [150.0, 200.0, 210.0, 220.0, 230.0, 240.0, 250.0, 280.0, 300.0, 350.0, 380.0, 400.0, 500.0, 550.0, \
600.00, ]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10, 15.0, 20,0, 25.0, 30.0, 40.0, 50.0, 60.0, 700.,80.0, 90.0, 100.0 ]; % t_shift


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001141923           0       0.001
  2  lag_freq(1).log_mass   0     0         6.172441         5.9         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.9           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              230           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0

Obsid 1H0707_loflux2
chi^2 = 1.798714e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+9.202258e-01 -0.000000e+00)
Parameter Gamma1 = 2.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.500000e+00 (+2.110145e-01 -1.032109e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+1.070724e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.300000e+02 (+7.928574e-01 -7.702861e+01)
Parameter t_shift = 1.000000e+01 (+9.407801e+00 -0.000000e+00)


.............................................................

1H0707-495-loflux-fit-error3.sl
Submitted batch job 3924243


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [3.0]; % Gamma1
vals_to_fit[3] = [2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [150.0, 200.0, 220.0, 230.0, 240.0, 250.0, 260.0, 280.0, 300.0, 350.0, 380.0, 400.0, 500.0, 550.0, \
600.00, ]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10.0, 15.0, 20,0, 25.0, 30.0, 35.0, 40.0, 50.0, 60.0, 700.,80.0, 90.0, 100.0 ]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001102943           0       0.001
  2  lag_freq(1).log_mass   0     0         6.171217         5.9         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              230           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0


Obsid 1H0707_loflux3
chi^2 = 1.684467e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+2.822558e+00 -0.000000e+00)
Parameter Gamma1 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+2.049027e-01 -1.347231e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+1.048481e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.300000e+02 (+1.107680e+02 -7.691302e+01)
Parameter t_shift = 1.000000e+01 (+9.131478e+00 -0.000000e+00)


##################
#################

Decreasing Gamma

################

...............................................

1H0707-495-loflux-fit-error4.sl
Submitted batch job 3924423

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.1]; % Gamma1
vals_to_fit[3] = [1.4, 1.6, 1.6, 1.7, 1.8, 1.9, 2.0]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [150.0, 200.0, 220.0, 240.0, 250.0, 280.0, 300.0, 350.0, 380.0, 400.0, 500.0, 550.0, 600.00, ]; % t\
_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10.0, 15.0, 20,0, 25.0, 30.0, 35.0, 40.0, 50.0, 60.0, 700.,80.0, 90.0, 100.0 ]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001151369           0       0.001
  2  lag_freq(1).log_mass   0     0         6.156471         5.9         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.1           0           0
  8  lag_freq(1).Gamma2     0     1              1.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              240           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0

Obsid 1H0707_loflux4
chi^2 = 2.542571e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+3.901268e+00 -0.000000e+00)
Parameter Gamma1 = 2.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.600000e+00 (+2.218312e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.400000e+02 (+9.711117e+01 -6.192970e+01)
Parameter t_shift = 1.000000e+01 (+3.752645e+00 -0.000000e+00)


....................................................
Submitted batch job 3924424

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.01]; % Gamma1
vals_to_fit[3] = [1.4, 1.6, 1.6, 1.7, 1.8, 1.9]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [150.0, 200.0, 220.0, 240.0, 250.0, 280.0, 300.0, 350.0, 380.0, 400.0, 500.0, 550.0, 600.00, ]; % t\
_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10.0, 15.0, 20,0, 25.0, 30.0, 35.0, 40.0, 50.0, 60.0, 700.,80.0, 90.0, 100.0 ]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001186096           0       0.001
  2  lag_freq(1).log_mass   0     0         6.105244         5.9         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                8           0           0
  7  lag_freq(1).Gamma1     0     1                2           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0


Obsid 1H0707_loflux5
chi^2 = 2.429496e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 8.000000e+00 (+7.780175e-01 -0.000000e+00)
Parameter Gamma1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.400000e+00 (+2.770908e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.500000e+02 (+7.190350e+01 -8.192464e+01)
Parameter t_shift = 1.000000e+01 (+3.865848e+00 -0.000000e+00)

................................................

1H0707-495-loflux-fit-error.sl
Submitted batch job 3924428

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [1.9]; % Gamma1
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [150.0, 200.0, 210.0, 220.0, 230.0, 240.0, 250.0, 280.0, 300.0, 350.0, 380.0, 400.0, 500.0, 550.0, \
600.00, ]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10, 15.0, 20,0, 25.0, 30.0, 40.0, 50.0, 60.0, 700.,80.0, 90.0, 100.0 ]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      0.000106389           0       0.001
  2  lag_freq(1).log_mass   0     0         6.126347         5.9         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              1.9           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0

Obsid 1H0707_loflux
chi^2 = 2.471142e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+3.058983e+00 -0.000000e+00)
Parameter Gamma1 = 1.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.400000e+00 (+1.314926e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -3.171828e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+3.856655e+01 -9.522932e+01)
Parameter t_shift = 1.000000e+01 (+9.446318e+00 -0.000000e+00)

..................................................................

1H0707-495-loflux-fit-error.sl
Submitted batch job 3924549

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [1.8]; % Gamma1
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [150.0, 200.0, 210.0, 220.0, 230.0, 240.0, 250.0, 280.0, 300.0, 350.0, 380.0, 400.0, 500.0, 550\
.0, 600.00, ]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10, 15.0, 20,0, 25.0, 30.0, 40.0, 50.0, 60.0, 700.,80.0, 90.0, 100.0 ]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001149907           0       0.001
  2  lag_freq(1).log_mass   0     0         6.046227         5.9         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               10           0           0
  7  lag_freq(1).Gamma1     0     1              1.8           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

File Edit Options Buffers Tools Help
Obsid 1H0707_loflux
chi^2 = 2.463590e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.000000e+01 (+0.000000e+00 -5.571254e-01)
Parameter Gamma1 = 1.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.400000e+00 (+8.738639e-02 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -4.446828e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+8.226764e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+3.569307e+01 -5.069758e+01)
Parameter t_shift = 2.000000e+01 (+-1.617220e+00 -2.797321e+00)



.............................................................

1H0707-495-loflux-fit-error5.sl
Submitted batch job 3924550


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [1.7]; % Gamma1
vals_to_fit[3] = [1.4, 1.5, 1.6]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [150.0, 200.0, 220.0, 240.0, 250.0, 280.0, 300.0, 350.0, 380.0, 400.0, 500.0, 550.0, 600.00, ];\
 % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10.0, 15.0, 20,0, 25.0, 30.0, 35.0, 40.0, 50.0, 60.0, 700.,80.0, 90.0, 100.0 ]; % t_shif\

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     9.656425e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.246099         5.9         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.7           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0


Obsid 1H0707_loflux5
chi^2 = 5.398041e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+2.496216e+00 -0.000000e+00)
Parameter Gamma1 = 1.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.400000e+00 (+1.189026e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -2.153643e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+1.653984e+02 -1.822734e+01)
Parameter t_shift = 3.000000e+01 (+3.000000e+01 -5.818668e-01)

.........................................................

1H0707-495-loflux-fit-error4.sl
Submitted batch job 3924551


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [1.6]; % Gamma1
vals_to_fit[3] = [1.4, 1.5]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [150.0, 200.0, 220.0, 240.0, 250.0, 280.0, 300.0, 350.0, 380.0, 400.0, 500.0, 550.0, \
600.00, ]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10.0, 15.0, 20,0, 25.0, 30.0, 35.0, 40.0, 50.0, 60.0, 700.,80.0, 90.0, 100.0 ]\
; % t_shift


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     7.259178e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.074412         5.9         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                8           0           0
  7  lag_freq(1).Gamma1     0     1              1.6           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              550           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0

Obsid 1H0707_loflux4
chi^2 = 5.319910e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 8.000000e+00 (+6.676168e-01 -0.000000e+00)
Parameter Gamma1 = 1.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.400000e+00 (+1.349424e-02 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -7.524349e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.291196e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.500000e+02 (+0.000000e+00 -7.140659e+01)
Parameter t_shift = 8.000000e+01 (+0.000000e+00 --6.200000e+02)

 ....................................................................

1H0707-495-loflux-fit-error.sl
Submitted batch job 3924620



vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [3.0]; % Gamma1
vals_to_fit[3] = [2.8, 2.9];% Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [150.0, 200.0, 210.0, 220.0, 230.0, 240.0, 250.0, 280.0, 300.0, 350.0, 380.0, 400.0, \
500.0, 550.0, 600.00, ]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10, 15.0, 20,0, 25.0, 30.0, 40.0, 50.0, 60.0, 700.,80.0, 90.0, 100.0 ]; % t_sh\
ift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001039654           0       0.001
  2  lag_freq(1).log_mass   0     0         6.255122         5.9         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0

Obsid 1H0707_loflux
chi^2 = 4.268743e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+8.595694e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+1.665110e+02 -1.829057e+01)
Parameter t_shift = 3.000000e+01 (+3.000000e+01 -2.818985e+01)


...................................................................

1H0707-495-loflux-fit-error5.sl
Submitted batch job 3924621


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.9]; % Gamma1
vals_to_fit[3] = [2.7, 2.8]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [150.0, 200.0, 220.0, 240.0, 250.0, 280.0, 300.0, 350.0, 380.0, 400.0, 500.0, 550.0, \
600.00, ]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10.0, 15.0, 20,0, 25.0, 30.0, 35.0, 40.0, 50.0, 60.0, 700.,80.0, 90.0, 100.0 ]\
; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     8.598103e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.198042         5.9         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.9           0           0
  8  lag_freq(1).Gamma2     0     1              2.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1                5           0           0


Obsid 1H0707_loflux5
chi^2 = 4.314949e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+8.568350e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+1.540104e+02 -1.828807e+01)
Parameter t_shift = 3.000000e+01 (+3.000000e+01 -2.821923e+01)



...............................................................

1H0707-495-loflux-fit-error4.sl
Submitted batch job 3924624

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.8]; % Gamma1
vals_to_fit[3] = [2.6, 2.7]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [150.0, 200.0, 220.0, 240.0, 250.0, 280.0, 300.0, 350.0, 380.0, 400.0, 500.0, 550.0, \
600.00, ]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10.0, 15.0, 20,0, 25.0, 30.0, 35.0, 40.0, 50.0, 60.0, 700.,80.0, 90.0, 100.0 ]\
; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001087164           0       0.001
  2  lag_freq(1).log_mass   0     0         6.255242         5.9         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0


Obsid 1H0707_loflux4
chi^2 = 4.267124e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+0.000000e+00 -1.829066e+01)
Parameter t_shift = 3.000000e+01 (+3.000000e+01 -2.828730e+01)


..................................................................

1H0707-495-loflux-fit-error3.sl
Submitted batch job 3924627


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.7]; % Gamma1
vals_to_fit[3] = [2.5, 2.6]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [150.0, 200.0, 220.0, 230.0, 240.0, 250.0, 260.0, 280.0, 300.0, 350.0, 380.0, 400.0, \
500.0, 550.0, 600.00, ]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10.0, 15.0, 20,0, 25.0, 30.0, 35.0, 40.0, 50.0, 60.0, 700.,80.0, 90.0, 100.0 ]\
; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001163935           0       0.001
  2  lag_freq(1).log_mass   0     0          6.25464         5.9         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0


Obsid 1H0707_loflux3
chi^2 = 4.258983e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+1.511289e+02 -1.829110e+01)
Parameter t_shift = 3.000000e+01 (+3.000000e+01 -2.820959e+01)

....................................................................

1H0707-495-loflux-fit-error.sl
Submitted batch job 3925334


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [3.0]; % Gamma1
vals_to_fit[3] = [2.8, 2.9];% Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [10.0, 50.0, 80.0, 100.0, 110.0, 150.0, 200.0, 210.0, 230.0, 240.0, 250.0, 280.0, 300.0, 350.0, 3\
80.0, 400.0, 500.0, 550.0, 600.00, ]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10, 15.0, 20,0, 25.0, 30.0, 40.0, 50.0, 60.0, 70.0 ,80.0, 90.0, 100.0 ]; % t_shift


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001039654           0       0.001
  2  lag_freq(1).log_mass   0     0         6.255122         5.9         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0


Obsid 1H0707_loflux
chi^2 = 4.268743e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+8.595694e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+1.665110e+02 -1.829057e+01)
Parameter t_shift = 3.000000e+01 (+4.435327e+01 -2.818985e+01)

..........................................................

1H0707-495-loflux-fit-error2.sl
Submitted batch job 3925338


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.9]; % Gamma1
vals_to_fit[3] = [2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [10.0, 50.0, 80.0, 100.0, 150.0, 180.0, 200.0, 210.0, 220.0, 230.0, 240.0, 250.0, 280.0, 300.0, 3\
50.0, 380.0, 400.0, 500.0, 550.0, 600.00, ]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10, 15.0, 20.0, 25.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0]; % t_shift


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001141923           0       0.001
  2  lag_freq(1).log_mass   0     0         6.172441         5.9         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.9           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              230           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0

Obsid 1H0707_loflux2
chi^2 = 1.798714e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+9.202258e-01 -0.000000e+00)
Parameter Gamma1 = 2.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.500000e+00 (+2.110145e-01 -1.032109e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+1.070724e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.300000e+02 (+7.928574e-01 -7.702861e+01)
Parameter t_shift = 1.000000e+01 (+9.407801e+00 -0.000000e+00)

...............................................................

1H0707-495-loflux-fit-error3.sl
Submitted batch job 3925340


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.7]; % Gamma1
vals_to_fit[3] = [2.4, 2.5, 2.6]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.0, 100.0, 120.0, 150.0, 200.0, 220.0, 230.0, 240.0, 250.0, 260.0, 280.0, 300.0, 350.0, 380.0,\
 400.0, 500.0, 550.0, 600.00, ]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10.0, 15.0, 20,0, 25.0, 30.0, 35.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0 ]; % t_shift


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001163935           0       0.001
  2  lag_freq(1).log_mass   0     0          6.25464         5.9         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0

Obsid 1H0707_loflux3
chi^2 = 4.258983e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+1.511289e+02 -1.829110e+01)
Parameter t_shift = 3.000000e+01 (+3.000000e+01 -2.820959e+01)

.......................................................................

1H0707-495-loflux-fit-error4.sl
Submitted batch job 3925341

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.6]; % Gamma1
vals_to_fit[3] = [2.0, 2.3, 2.4, 2.5]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.0, 100.0, 110.0, 150.0, 200.0, 220.0, 240.0, 250.0, 280.0, 300.0, 350.0, 380.0, 400.0, 500.0,\
 550.0, 600.00, ]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10.0, 15.0, 20,0, 25.0, 30.0, 35.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0 ]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001142067           0       0.001
  2  lag_freq(1).log_mass   0     0         6.154735         5.9         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                7           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              220           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0

Obsid 1H0707_loflux4
chi^2 = 3.301631e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 7.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.200000e+02 (+1.312718e+02 -2.587064e+01)
Parameter t_shift = 1.000000e+01 (+8.640356e+00 -0.000000e+00)

........................................................

1H0707-495-loflux-fit-error2.sl
Submitted batch job 3925342




vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.5]; % Gamma1
vals_to_fit[3] = [1.8, 2.0, 2.1, 2.2, 2.3, 2.4]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [10.0, 50.0, 80.0, 100.0, 150.0, 180.0, 200.0, 210.0, 220.0, 230.0, 240.0, 250.0, 280.0, 300.0, 3\
50.0, 380.0, 400.0, 500.0, 550.0, 600.00, ]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10, 15.0, 20.0, 25.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001099133           0       0.001
  2  lag_freq(1).log_mass   0     0         6.164736         5.9         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              240           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0

Obsid 1H0707_loflux2
chi^2 = 2.194202e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+2.503841e+00 -0.000000e+00)
Parameter Gamma1 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+3.127437e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.400000e+02 (+1.022172e+02 -8.006481e+01)
Parameter t_shift = 1.000000e+01 (+2.447285e+01 -0.000000e+00)

.............................................................

1H0707-495-loflux-fit-error3.sl
Submitted batch job 3925348

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [3.0]; % Gamma1
vals_to_fit[3] = [2.4, 2.5, 2.6, 2.7, 2.8, 2.9]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.0, 100.0, 120.0, 150.0, 200.0, 220.0, 230.0, 240.0, 250.0, 260.0, 280.0, 300.0, 350.0, 380.\
0, 400.0, 500.0, 550.0, 600.00, ]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10.0, 15.0, 20,0, 25.0, 30.0, 35.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0 ]; % t_shi


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001102943           0       0.001
  2  lag_freq(1).log_mass   0     0         6.171217         5.9         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              230           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0

Obsid 1H0707_loflux3
chi^2 = 1.684467e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+2.822558e+00 -0.000000e+00)
Parameter Gamma1 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+2.060143e-01 -1.347231e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+1.048481e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.300000e+02 (+1.107680e+02 -7.691302e+01)
Parameter t_shift = 1.000000e+01 (+9.131478e+00 -0.000000e+00)

.....................................................

run finer pars

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [3.0]; % Gamma1
vals_to_fit[3] = [2.6]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.0, 100.0, 120.0, 150.0, 200.0, 220.0, 225.0, 230.0, 235.0, 240.0, 250.0, 260.0, 280.0, 300.0, 350.0,\
 380.0, 400.0, 500.0 ]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 8.0, 9.0, 10.0, 11.0, 12.0, 15.0, 20,0]; % t_shift

No fine grid has been run

#+END_EXAMPLE


##################

############

Run finer grid with higher Gamma up to 3.3 (13 July 2020)

###################

###############


#+BEGIN_EXAMPLE

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001070287           0       0.001
  2  lag_freq(1).log_mass   0     0         6.264442         5.9         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1                8           0           0

Obsid 1H0707_loflux3
chi^2 = 1.630178e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+4.688703e+00 -0.000000e+00)
Parameter Gamma1 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+2.033319e-01 -5.490187e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+1.744485e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.000000e+02 (+7.889615e-02 -9.211039e-01)
Parameter t_shift = 8.000000e+00 (+7.889615e-02 -9.211039e-01)

..............................................................

1H0707-loflux-fit-error.sl
Submitted batch job 4041607

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001016134           0       0.001
  2  lag_freq(1).log_mass   0     0         6.144442           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              3.3           0           0
  8  lag_freq(1).Gamma2     0     1              2.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0


Obsid 1H0707_loflux
chi^2 = 1.591134e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 3.300000e+00 (+0.000000e+00 -6.963252e-01)
Parameter Gamma2 = 2.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.500000e+02 (+8.828400e+01 -1.212162e+02)
Parameter t_shift = 1.000000e+01 (+2.179257e+01 -0.000000e+00)

lag_freq(1).log_mass,6.144442e+00,+5.198293e-02,-4.371130e-02
  Parameter 2 = 6.144442e+00 (6.100731e+00 - 6.196425e+00)

#+END_EXAMPLE

*** Results

PATH =/home/steff075/phd_ecm/ecm_model/1H0707-495/1H0707-loflux-fit-Vari-M.csv=

PATH =/home/steff075/phd_ecm/ecm_model/1H0707-495/1H0707-loflux-Vari-M.vsz=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-loflux-Vari-M.png


Best fit was
#+BEGIN_EXAMPLE

Submitted batch job 3943723

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001102943           0       0.001
  2  lag_freq(1).log_mass   0     0         6.171217         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              230           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0


Obsid 1H0707_loflux
chi^2 = 1.684467e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+0.000000e+00 -1.187209e+00)
Parameter Gamma1 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+2.062125e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+1.160407e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.300000e+02 (+1.895456e+02 -7.920004e+01)
Parameter t_shift = 1.000000e+01 (+2.119785e+01 -3.168055e+00)

.....................................................
Obsid 1H0707_loflux
chi^2 = 1.684467e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+2.421319e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+2.553651e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.300000e+02 (+4.426050e-01 -1.557673e+00)
Parameter t_shift = 1.000000e+01 (+7.902122e-02 -8.380907e+00)

lag_freq(1).log_mass,6.352162e+00,+1.478376e-01,-1.373124e-01


##### Convert ps to png and rotate #######

convert -rotate "90"  1H0707_loflux_best_fit.png
display 1H0707_loflux_best_fit.png

##### Pull into Lyra WWW (from Lyra) #####

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_loflux_best_fit.pdf .

#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_loflux_best_fit.png

*** *Lo flux fixed mass fits*

#+BEGIN_EXAMPLE
1H0707-495-loflux-FM-fit-error.sl
Submitted batch job 3924259

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.8]; % Gamma1
vals_to_fit[3] = [2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [150.0, 200.0, 210.0, 220.0, 230.0, 240.0, 250.0, 280.0, 300.0, 350.0, 380.0, 400.0, 500.0, 550.0, \
600.00, ]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10, 15.0, 20,0, 25.0, 30.0, 40.0, 50.0, 60.0, 700.,80.0, 90.0, 100.0 ]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     8.356895e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1                5           0           0

Obsid 1H0707_loflux_FM
chi^2 = 3.376242e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.116790e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+3.272574e-01 -2.984569e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+1.976239e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.000000e+02 (+3.158291e+01 -7.134057e+00)
Parameter t_shift = 5.000000e+00 (+4.286594e+00 -0.000000e+00)

.....................................................

1H0707-495-loflux-FM-fit-error2.sl
Submitted batch job 3924433

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     7.651407e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.9           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1                5           0           0

Obsid Ark564_comb_FM2
chi^2 = 3.313709e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.021130e+00 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.900000e+00 (+0.000000e+00 -2.130523e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+2.239624e-02 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+1.001996e+02 -1.499925e+02)
Parameter t_shift = 1.500000e+01 (+2.035798e+00 -2.932811e+00)

.......................................................

1H0707-495-loflux-FM-fit-error3.sl
Submitted batch job 3924439

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     8.647213e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1                5           0           0


Obsid 1H0707_loflux_FM3
chi^2 = 4.192836e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.602598e+00 -0.000000e+00)
Parameter Gamma1 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+2.480116e-01 -1.459644e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -9.147330e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.000000e+02 (+3.514506e+01 -4.573665e+01)
Parameter t_shift = 5.000000e+00 (+5.906875e+00 -0.000000e+00)

...........................

1H0707-495-loflux-FM-fit-error2.sl
Submitted batch job 3925411


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     7.651407e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.9           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1                5           0           0


Obsid 1H0707_loflux_FM2
chi^2 = 3.951989e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.467476e+00 -0.000000e+00)
Parameter Gamma1 = 2.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+3.396295e-01 -3.892095e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+1.062257e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.000000e+02 (+3.039570e+01 -4.576876e+01)
Parameter t_shift = 5.000000e+00 (+4.785716e+00 -0.000000e+00)

........................................

1H0707-495-loflux-FM-fit-error3.sl
Submitted batch job 3925412

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     9.456989e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1                5           0           0


Obsid 1H0707_loflux_FM3
chi^2 = 3.014632e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.075127e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+3.219546e-01 -1.132643e-03)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+1.724863e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.000000e+02 (+2.206852e+01 -3.172079e+01)
Parameter t_shift = 5.000000e+00 (+3.485793e+00 -0.000000e+00)


.........................................

1H0707-495-loflux-FM-fit-error4.sl
Submitted batch job 3925413

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     9.878367e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              190           0           0
 15  lag_freq(1).t_shift    0     1                5           0           0


Obsid 1H0707_loflux_FM4
chi^2 = 3.218351e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.139722e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.100000e+00 (+3.278770e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+6.756015e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.900000e+02 (+3.984305e+01 -1.366729e+01)
Parameter t_shift = 5.000000e+00 (+3.811613e+00 -0.000000e+00)


...........................................

1H0707-495-loflux-FM-fit-error5.sl
Submitted batch job 3925415

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     8.957811e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1                5           0           0


Obsid 1H0707_loflux_FM5
chi^2 = 4.119326e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.046256e+00 -0.000000e+00)
Parameter Gamma1 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+3.360249e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.000000e+02 (+3.447698e+01 -2.780894e+01)
Parameter t_shift = 5.000000e+00 (+7.391239e+00 -0.000000e+00)

...........................................

1H0707-495-loflux-FM-fit-error.sl
Submitted batch job 3925417

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001098911           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1                5           0           0


Obsid 1H0707_loflux_FM
chi^2 = 4.333596e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.079027e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.900000e+00 (+2.439256e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.000000e+02 (+3.195597e+01 -2.679428e+01)
Parameter t_shift = 5.000000e+00 (+3.672146e+00 -0.000000e+00)

.............................................

1H0707-495-loflux-FM-fit-error4.sl
Submitted batch job 3925456

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     8.034758e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1                5           0           0


Obsid 1H0707_loflux_FM4
chi^2 = 4.740641e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.130029e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.600000e+00 (+4.008390e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -2.884656e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.000000e+02 (+3.350140e+01 -3.055638e+01)
Parameter t_shift = 5.000000e+00 (+3.524443e+00 -0.000000e+00)

...........................................

1H0707-495-loflux-FM-fit-error5.sl
Submitted batch job 3925457

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      8.85105e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.1           0           0
  8  lag_freq(1).Gamma2     0     1              1.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              190           0           0
 15  lag_freq(1).t_shift    0     1                5           0           0

Obsid 1H0707_loflux_FM5
chi^2 = 4.502148e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.271960e+00 -0.000000e+00)
Parameter Gamma1 = 2.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.500000e+00 (+2.901506e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.900000e+02 (+3.519611e+01 -1.448495e+01)
Parameter t_shift = 5.000000e+00 (+3.417319e+00 -0.000000e+00)

.......................................................
##################
####################

At this stage I am obtaining the same results repeated as already obtained above

####################
##################

try minimising gaps between gamma

###################
#################

1H0707-495-loflux-FM-fit-error2.sl
Submitted batch job 3925557


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001014634           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1                5           0           0


Obsid 1H0707_loflux_FM2
chi^2 = 4.209949e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+8.089966e-01 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+2.486684e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.000000e+02 (+3.807700e+01 -4.586482e+01)
Parameter t_shift = 5.000000e+00 (+1.421725e+01 -0.000000e+00)

-----------------------------------------------------------

1H0707-495-loflux-FM-fit-error3.sl
Submitted batch job 3925559

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      0.000117893           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              350           0           0
 15  lag_freq(1).t_shift    0     1               25           0           0


Obsid 1H0707_loflux_FM3
chi^2 = 4.738264e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+9.607433e-01 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.500000e+00 (+6.047551e-02 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.500000e+02 (+2.602743e+00 -5.385959e+01)
Parameter t_shift = 2.500000e+01 (+4.855188e+00 -2.283105e+01)

...................................................

1H0707-495-loflux-FM-fit-error4.sl
Submitted batch job 3925561
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.670721e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               90           0           0


Obsid 1H0707_loflux_FM4
chi^2 = 9.212802e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.352255e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+2.976855e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -1.618111e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.000000e+02 (+0.000000e+00 -2.611839e+01)
Parameter t_shift = 9.000000e+01 (+9.190674e+00 -1.590658e+01)

..........................................................


#+END_EXAMPLE

*** Loflux FM = 6.03, 6.1

M = 6.03

#+BEGIN_EXAMPLE
1H0707-loflux-fit-error.sl
Submitted batch job 4012474


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     8.320658e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.03           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                9           0           0
  7  lag_freq(1).Gamma1     0     1              3.2           0           0
  8  lag_freq(1).Gamma2     0     1                3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              600           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0


Obsid 1H0707_loflux
chi^2 = 6.603870e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 9.000000e+00 (+0.000000e+00 -1.492167e-01)
Parameter Gamma1 = 3.200000e+00 (+0.000000e+00 -4.885260e-01)
Parameter Gamma2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.000000e+02 (+0.000000e+00 -2.672349e+01)
Parameter t_shift = 3.000000e+01 (+2.393133e+01 -2.572450e+01)

#+END_EXAMPLE

M = 6.1

#+BEGIN_EXAMPLE
Submitted batch job 4012500

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001161017           0       0.001
  2  lag_freq(1).log_mass   0     1              6.1           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                7           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Obsid 1H0707_loflux
chi^2 = 3.002932e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 7.000000e+00 (+0.000000e+00 -1.743835e+00)
Parameter Gamma1 = 3.000000e+00 (+0.000000e+00 -2.684021e-01)
Parameter Gamma2 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+9.751180e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+4.381744e+01 -5.579131e+01)
Parameter t_shift = 2.000000e+01 (+8.347374e+00 -0.000000e+00)




#+END_EXAMPLE

M = 6.15

#+BEGIN_EXAMPLE
1H0707-loflux-fit-error.sl
Submitted batch job 4016713

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001004539           0       0.001
  2  lag_freq(1).log_mass   0     1             6.15           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              3.3           0           0
  8  lag_freq(1).Gamma2     0     1              2.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0


Obsid 1H0707_loflux
chi^2 = 1.649638e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+9.972469e-01 -1.695975e+00)
Parameter Gamma1 = 3.300000e+00 (+0.000000e+00 -5.905782e-01)
Parameter Gamma2 = 2.900000e+00 (+9.983682e-02 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.500000e+02 (+8.750814e+01 -1.383147e+02)
Parameter t_shift = 1.000000e+01 (+9.983682e+00 -0.000000e+00)



#+END_EXAMPLE

*** Results

PATH =/home/steff075/phd_ecm/ecm_model/1H0707/1H0707-loflux-FM.csv=

PATH =/home/steff075/phd_ecm/ecm_model/1H0707/1H0707-loflux-FM.vsz=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-loflux-FM.png

The best loflux fixed mass fit was:


#+BEGIN_EXAMPLE

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     9.456989e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.31           0           0
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1                5           0           0


Obsid 1H0707_loflux_FM3
chi^2 = 3.014632e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.075127e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+3.219546e-01 -1.132643e-03)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+1.724863e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.000000e+02 (+2.206852e+01 -3.172079e+01)
Parameter t_shift = 5.000000e+00 (+3.485793e+00 -0.000000e+00)


replot:

1H0707-495-loflux-FM-fit-error2.sl

##### Convert ps to png and rotate #######

convert -rotate "90"  1H0707_loflux_FM2_best_fit.png
display 1H0707_loflux_FM2_best_fit.png

##### Pull into Lyra WWW (from Lyra) #####

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707_loflux_FM2_best_fit.png /home/WWW/steff/ecm
#+END_EXAMPLE

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707_loflux_FM2_best_fit.png

*** Hiflux

#+BEGIN_EXAMPLE

1H0707-hiflux-fit-error.sl

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.279969e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.027837         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              569           0           0
 15  lag_freq(1).t_shift    0     1               91           0           0


Obsid 1H0707_hiflux
chi^2 = 1.894834e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.900000e+00 (+1.018257e-01 -1.703251e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -8.570487e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+3.821219e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.690000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 9.100000e+01 (+0.000000e+00 -1.826007e+01)

.............................................

Try finer H2



sacct -j 3943645

No finer height fits found !!!!



convert -rotate "90" 1H0707_hiflux_best_fit.ps 1H0707_hiflux_ecm.png

##### Pull into Lyra WWW (from Lyra) #####

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_hiflux_ecm.png    /home/WWW/steff/ecm

#+END_EXAMPLE


#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707_hiflux_ecm.png

*** New Hi Flux lags (July 2020)

There was littel varibility between the hi- flux and combined lag upo
to this point. The spectar were revisited and new hi  and meduim flux
lags were extracted - The combined and low flux above remain the same.


#+BEGIN_EXAMPLE
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.421311e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         5.981947         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               60           0           0


Obsid 1H0707_hiflux
chi^2 = 3.843623e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+4.624068e+00 -1.197164e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -5.441694e-01)
Parameter Gamma2 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+0.000000e+00 -1.573008e+02)
Parameter t_shift = 6.000000e+01 (+1.102683e+01 -2.530077e+01)

.................................................................

1H0707-hiflux-fit-error.sl
Submitted batch job 3949254

Obsid 1H0707_hiflux
chi^2 = 3.777553e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+1.066608e+00 -1.196753e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+8.625873e-02 -4.913741e+00)
Parameter t_shift = 6.000000e+01 (+1.725175e-02 -1.965497e+00)


Run blob for finer pars for this fit'

./submit-blob-delta-3.pl and submit-blob-delta-4.pl

           3950414    serial   reverb  so14935  R       1:23      1 compute077
           3950411    serial   reverb  so14935  R       1:42      1 compute077
           3950412    serial   reverb  so14935  R       1:42      1 compute077
           3950413    serial   reverb  so14935  R       1:42      1 compute077
           3950410    serial   reverb  so14935  R       1:56      1 compute077
           3950409    serial   reverb  so14935  R       6:23      1 compute077

.................................................................

1H0707-hiflux-fit-error.sl

Obsid 1H0707_hiflux
chi^2 = 3.726228e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+4.636559e+00 -1.196638e+00)
Parameter Gamma1 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.719850e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.250000e+02 (+1.830948e+01 -2.734627e+02)
Parameter t_shift = 5.500000e+01 (+1.659772e+01 -2.231614e+01)

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.682978e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.007727         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              425           0           0
 15  lag_freq(1).t_shift    0     1               55           0           0

................................................................

1H0707-hiflux-fit-error.sl
Submitted batch job 3951987

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      4.14568e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.026349         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              410           0           0
 15  lag_freq(1).t_shift    0     1               55           0           0


Obsid 1H0707_hiflux
chi^2 = 3.726228e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+4.636559e+00 -1.196638e+00)
Parameter Gamma1 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.719850e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.250000e+02 (+1.830948e+01 -2.734627e+02)
Parameter t_shift = 5.500000e+01 (+1.659772e+01 -2.231614e+01)


................................................................

1H0707-hiflux-fit-error.sl
Submitted batch job 3952374


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.061419e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.026492         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              410           0           0
 15  lag_freq(1).t_shift    0     1               56           0           0

lag_freq(1).log_mass,6.020000e+00,+4.800000e-01,-2.200000e-01


Obsid 1H0707_hiflux
chi^2 = 3.626431e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+4.683544e+00 -1.196639e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.266166e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.100000e+02 (+3.009516e+01 -2.593991e+02)
Parameter t_shift = 5.600000e+01 (+1.723514e-02 -2.227459e+01)

############################################
###########################################

Note there is a big gap in the lag-files at:

[so14935@bc4gpulogin1 x-ray-reverberation]$ cd lag-files/i53/a0.998/h02.0+05.0/g2.3+2.0/A01.0/x3.0/p00.0/b03.0/q0.5/
[so14935@bc4gpulogin1 q0.5]$ ls
tmax0000  tmax0050  tmax0100  tmax0150  tmax0200  tmax0250  tmax0300  tmax0680  tmax0780  tmax0880
tmax0010  tmax0060  tmax0110  tmax0160  tmax0210  tmax0260  tmax0600  tmax0700  tmax0800  tmax0900
tmax0020  tmax0070  tmax0120  tmax0170  tmax0220  tmax0270  tmax0620  tmax0720  tmax0820
tmax0030  tmax0080  tmax0130  tmax0180  tmax0230  tmax0280  tmax0640  tmax0740  tmax0840
tmax0040  tmax0090  tmax0140  tmax0190  tmax0240  tmax0290  tmax0660  tmax0760  tmax0860

................................................................

1H0707-hiflux-fit-error.sl
Submitted batch job 3972280

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9, 3.0, 3.1, 3.2]; % Gamma 1
vals_to_fit[3] = [2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9, 3.0, 3.1]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 150.0, 200.0, 300.0, 350.0, 400.0, 410.0, 420.0, 440.0, 500.0, 550.0, 600.0, 700.0, 800\
.0, 900.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [0.0, 5.0, 10.0, 20.0, 30.0, 40.0, 45.0, 48.0, 50.0, 52.0, 55.0, 56.0, 57.0, 58.0, 60.0, 65.0,\
 70.0, 75.0, 80.0, 90.0, 100.0, 110.0]; % t_shift


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.061419e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.026492           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              410           0           0
 15  lag_freq(1).t_shift    0     1               56           0           0



Obsid 1H0707_hiflux
chi^2 = 3.626431e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+2.216161e+00 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+7.779399e-01 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+9.553021e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.100000e+02 (+3.458878e+02 -2.591312e+02)
Parameter t_shift = 5.600000e+01 (+1.723514e-02 -2.263485e+01)


................................................................

1H0707-hiflux-fit-error.sl
Submitted batch job 3972439

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.765347e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.005459           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1                2           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              425           0           0
 15  lag_freq(1).t_shift    0     1               60           0           0


Obsid 1H0707_hiflux
chi^2 = 3.504583e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+4.073777e+00 -0.000000e+00)
Parameter Gamma1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.700000e+00 (+5.944313e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.553774e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.250000e+02 (+2.264516e+02 -1.407535e+02)
Parameter t_shift = 6.000000e+01 (+1.020762e+01 -2.985008e+00)

................................................................

1H0707-hiflux-fit-error.sl
Submitted batch job 3972571

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [1.6, 1.7, 1.8, 1.9, 2.0, 2.1]; % Gamma 1
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 200.0, 300.0, 350.0, 400.0, 405.0, 410.0, 415.0, 420.0, 425.0, 440.0, 500.0, 600.0, 800.\
0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [0.0, 5.0, 10.0, 20.0, 30.0, 40.0, 45.0, 48.0, 50.0, 52.0, 55.0, 56.0, 57.0, 58.0, 60.0, 65.0, \
70.0, 75.0, 80.0, 90.0, 100.0, 110.0]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.913186e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         5.936861         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              1.8           0           0
  8  lag_freq(1).Gamma2     0     1              1.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               70           0           0



Obsid 1H0707_hiflux
chi^2 = 3.436780e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+5.411263e+00 -0.000000e+00)
Parameter Gamma1 = 1.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.500000e+00 (+4.271150e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.525387e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.000000e+02 (+1.567494e+02 -3.191710e+00)
Parameter t_shift = 7.000000e+01 (+0.000000e+00 -1.294452e+01)


#####################
##################

Run submit-blob-delta-3.pl for:

# First source height ("o")
my $first_source_height_low = 2.0;      # low value
my $first_source_height_high = 2.0;     # high value
my $source_height_delta = 2.0;                  # step size (same for both sources)
# First source height ("d")
my $second_source_height_low = 4.0;     # $first_source_height_low + $source_height_delta;
my $second_source_height_high = 4.0; # $first_source_height_high;
# Inclination angle of disk ("i")
my $inclination_low = 53.0;
my $inclination_high = 53.0;
my $inclination_delta = 1.0;
# Photon index of first source ("g")
my $first_source_photon_index_low = 1.4;
my $first_source_photon_index_high = 2.0;
my $first_source_photon_index_delta = 0.1;
# Photon index of second source ("e")
my $second_source_photon_index_low = 1.4;
my $second_source_photon_index_high = 1.9;
my $second_source_photon_index_delta = 0.1;

my $tmax_low = 400.0;
my $tmax_high = 600.0;
my $tmax_delta = 10.0;
# "q" is the time shift between first and second source
my $tshift_low = 50.0;
my $tshift_high = 100.0;
my $tshift_delta = 5.0;


           3989213    serial   reverb  so14935  R       1:01      1 compute077
           3989212    serial   reverb  so14935  R       1:07      1 compute077
           3989211    serial   reverb  so14935  R       1:11      1 compute077
           3989210    serial   reverb  so14935  R       1:17      1 compute077
           3989209    serial   reverb  so14935  R       1:21      1 compute076
           3989208    serial   reverb  so14935  R       1:24      1 compute076
           3989206    serial   reverb  so14935  R       1:30      1 compute076
           3989214    serial   reverb  so14935 PD       0:00      1 (Resources)
           3989215    serial   reverb  so14935 PD       0:00      1 (Priority)
           3989216    serial   reverb  so14935 PD       0:00      1 (Priority)
           3989217    serial   reverb  so14935 PD       0:00      1 (Priority)
           3989219    serial   reverb  so14935 PD       0:00      1 (Priority)
           3989220    serial   reverb  so14935 PD       0:00      1 (Priority)
           3989221    serial   reverb  so14935 PD       0:00      1 (Priority)
           3989222    serial   reverb  so14935 PD       0:00      1 (Priority)
           3989223    serial   reverb  so14935 PD       0:00      1 (Priority)
           3989224    serial   reverb  so14935 PD       0:00      1 (Priority)
           3989225    serial   reverb  so14935 PD       0:00      1 (Priority)
           3989226    serial   reverb  so14935 PD       0:00      1 (Priority)
           3989227    serial   reverb  so14935 PD       0:00      1 (Priority)


./submit-blob-delta-3.pl



#####################
##################

................................................................

1H0707-hiflux-fit-error.sl
Submitted batch job 3993962

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.886128e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         5.943525         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              1.7           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              490           0           0
 15  lag_freq(1).t_shift    0     1               65           0           0



Obsid 1H0707_hiflux
chi^2 = 3.344087e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 1.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.900000e+02 (+0.000000e+00 -2.063219e+02)
Parameter t_shift = 6.500000e+01 (+0.000000e+00 -7.970767e+00)

lag_freq(1).log_mass,5.943525e+00,+3.577218e-02,-3.508627e-02
  Parameter 2 = 5.943525e+00 (5.908439e+00 - 5.979297e+00)
................................................................

#+END_EXAMPLE

*** Hiflux FM = 6.03, 6.1

M = 6.03

#+BEGIN_EXAMPLE
1H0707-hiflux-fit-error.sl
Submitted batch job 4012475

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.974589e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.03         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1                2           0           0
  8  lag_freq(1).Gamma2     0     1              1.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               55           0           0

Obsid 1H0707_hiflux
chi^2 = 3.579155e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+1.836552e+00 -0.000000e+00)
Parameter Gamma1 = 2.000000e+00 (+0.000000e+00 -4.995966e-01)
Parameter Gamma2 = 1.600000e+00 (+1.772545e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.052256e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+4.652520e+01 -4.086763e+00)
Parameter t_shift = 5.500000e+01 (+4.721795e-01 -1.860907e+00)

#+END_EXAMPLE

M = 6.1

#+BEGIN_EXAMPLE
Submitted batch job 4012501

///// Note I ran M = 6.01 by error !!! ///////
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      3.81414e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.01         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1                2           0           0
  8  lag_freq(1).Gamma2     0     1              1.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              440           0           0
 15  lag_freq(1).t_shift    0     1               60           0           0



chi^2 = 3.656003e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+9.242494e-01 -0.000000e+00)
Parameter Gamma1 = 2.000000e+00 (+0.000000e+00 -3.112502e-01)
Parameter Gamma2 = 1.600000e+00 (+1.581480e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+8.938045e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.400000e+02 (+3.050499e+01 -6.846472e+01)
Parameter t_shift = 6.000000e+01 (+1.179795e+01 -8.531062e-01)

.......................................

1H0707-hiflux-fit-error.sl
Submitted batch job 4012588

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.659737e-05           0       0.001
  2  lag_freq(1).log_mass   0     1              6.1         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1                2           0           0
  8  lag_freq(1).Gamma2     0     1              1.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              350           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0


Obsid 1H0707_hiflux
chi^2 = 3.813814e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+8.187607e-01 -0.000000e+00)
Parameter Gamma1 = 2.000000e+00 (+0.000000e+00 -2.044115e-01)
Parameter Gamma2 = 1.600000e+00 (+1.700154e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+7.884249e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.386811e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.500000e+02 (+2.733121e+01 -6.765554e+00)
Parameter t_shift = 5.000000e+01 (+2.729848e-01 -1.767215e+00)


#+END_EXAMPLE


M = 6.15

#+BEGIN_EXAMPLE
1H0707-hiflux-fit-error.sl
Submitted batch job 4016719

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.999295e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.15         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               40           0           0




Obsid 1H0707_hiflux
chi^2 = 4.974803e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.444890e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -6.126856e-01)
Parameter Gamma2 = 2.100000e+00 (+2.626548e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.790217e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+3.841180e+01 -6.067356e+01)
Parameter t_shift = 4.000000e+01 (+5.390699e+00 -5.489168e+00)


#+END_EXAMPLE

*** Med flux

#+BEGIN_EXAMPLE

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     6.910959e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         5.918436         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              100           0           0
 15  lag_freq(1).t_shift    0     1               60           0           0


Obsid 1H0707_medflux
chi^2 = 2.662166e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+0.000000e+00 -2.154972e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 6.000000e+01 (+0.000000e+00 -5.809527e+01)

.................................................................

1H0707-medflux-fit-error.sl
Submitted batch job 3952076

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     6.910959e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         5.918436         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              100           0           0
 15  lag_freq(1).t_shift    0     1               60           0           0


Obsid 1H0707_medflux
chi^2 = 2.662166e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+0.000000e+00 -2.157217e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.000000e+02 (+4.559000e-01 -1.544100e+00)
Parameter t_shift = 6.000000e+01 (+2.279500e-01 -7.720500e-01)

lag_freq(1).log_mass,6.020000e+00,+4.800000e-01,-2.200000e-01

.................................................................

1H0707-medflux-fit-error.sl
Submitted batch job 4041623

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0       6.4337e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         5.925513           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              2.9           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              100           0           0
 15  lag_freq(1).t_shift    0     1               60           0           0


Obsid 1H0707_medflux
chi^2 = 2.649080e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.000000e+02 (+4.558497e-01 -1.544150e+00)
Parameter t_shift = 6.000000e+01 (+2.279249e-01 -7.720751e-01)

lag_freq(1).log_mass,5.928386e+00,+1.593499e-01,-7.759564e-02
  Parameter 2 = 5.928386e+00 (5.850790e+00 - 6.087736e+00)


#############################################

This is a decent fit! Lets look at the data fit image:

Pull image into: /home/steff075/phd_ecm/results-ecm

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_medflux_best_fit.ps .

ps2pdf 1H0707_medflux_best_fit.ps

pdftocairo -png 1H0707_medflux_best_fit.pdf

cp 1H0707_medflux_best_fit-1.png /home/WWW/steff/ecm


#+END_EXAMPLE


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_medflux_best_fit-1.png

*** Medflux FM = 6.03, 6.1

M = 6.03

#+BEGIN_EXAMPLE
1H0707-medflux-fit-error.sl
Submitted batch job 4012590

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     6.280354e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.03         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1               80           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0





Obsid 1H0707_medflux
chi^2 = 3.650113e-01 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+0.000000e+00 -1.156419e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 8.000000e+01 (+1.109704e+01 -2.803571e+01)
Parameter t_shift = 5.000000e+01 (+5.288752e+00 -1.519068e+01)


#+END_EXAMPLE


M = 6.1

#+BEGIN_EXAMPLE
Submitted batch job 4012505


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.928239e-05           0       0.001
  2  lag_freq(1).log_mass   0     1              6.1         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1               60           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0

Obsid 1H0707_medflux
chi^2 = 5.031737e-01 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+0.000000e+00 -1.534814e-01)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.000000e+01 (+3.110869e+01 -8.605134e-01)
Parameter t_shift = 5.000000e+01 (+5.425663e+00 -2.353018e+01)



#+END_EXAMPLE


M = 6.15

#+BEGIN_EXAMPLE
1H0707-medflux-fit-error.sl
Submitted batch job 4016721


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.239736e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.15         5.8         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1               70           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0

Obsid 1H0707_medflux
chi^2 = 3.000282e-01 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 7.000000e+01 (+2.103453e+01 -2.581257e+01)
Parameter t_shift = 3.000000e+01 (+2.540795e+01 -2.828503e+01)



#+END_EXAMPLE

*** Common fitting commands

#+BEGIN_EXAMPLE
cd /mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/
queue | grep so14935

##### Running the codes #####################

isis-script 1H0707-495-comb-FM-fit-error.sl fit

##### Combined ##################
emacs 1H0707-495-fit-error.sl -nw
isis-script 1H0707-495-fit-error.sl fit plot
emacs 1H0707_combined_best_fit.par -nw
emacs 1H0707_combined_fit_info.txt -nw
emacs 1H0707_combined_best_fit.ps -nw


##### Lo flux ###################
time isis-script 1H0707-495-loflux-fit-error.sl fit plot
emacs 1H0707_loflux_best_fit.par -nw
emacs 1H0707_loflux_fit_info.txt -nw
emacs 1H0707_loflux_best_fit.ps -nw

##### Convert ps to png and rotate #######

convert -rotate "90" steff_test_best_fit.ps steff_test_best_fit.png
display steff_test_best_fit.png

##### Pull into Lyra WWW (from Lyra) #####

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/steff_test_best_fit.png /home/WWW/steff/ecm



#+END_EXAMPLE

*** Lo counts lc <20 cts $s^{-1}$

PATH = =1H0707-lo-cts-lc-data.sl=

#+BEGIN_EXAMPLE
Fitting:

1H0707-495-time-lags-lc-cts-below20.fits
1H0707-495-time-lags-lc-cts-below20.rsp

...................................

1H0707-lo-cts-lc-data.sl
Submitted batch job 3971856

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.730167e-05           0       0.001
  2  lag_freq(1).log_mass   0     0          6.27923           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid 1H0707_lo_cts_data
chi^2 = 1.899643e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 3.000000e+00 (+1.370592e-01 -2.622868e-01)
Parameter Gamma2 = 2.700000e+00 (+1.377591e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.500000e+02 (+2.585651e+02 -1.383473e+02)
Parameter t_shift = 2.000000e+01 (+5.255792e+01 -1.889835e+01)

..............................................

1H0707-lo-cts-lc-data.sl
Submitted batch job 3972013

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0]; % h2
vals_to_fit[2] = [2.8, 2.9, 3.0, 3.1]; % Gamma 1
vals_to_fit[3] = [2.5, 2.6, 2.7, 2.8, 2.9]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [200.0, 210.0, 220.0, 230.0, 240.0, 245.0, 247.0, 248.0, 250.0, 252.0, 255.0, 256.0, 26\
0.0, 270.0, 300.0, 350.0, 400.0, 450.0, 500.0, 550.0, 600.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [0.0, 0.5, 10.0, 15.0, 16.0, 17.0, 18.0, 20.0, 22.0, 24.0, 25.0, 30.0, 35.0, 40.0, 50.\
0, 60.0, 70.0, 80.0, 90.0, 100.0]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      4.80623e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.258479           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              210           0           0
 15  lag_freq(1).t_shift    0     1               17           0           0


Obsid 1H0707_lo_cts_data
chi^2 = 9.511672e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 3.000000e+00 (+9.692640e-02 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+2.234535e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.100000e+02 (+3.654746e+01 -0.000000e+00)
Parameter t_shift = 1.700000e+01 (+3.384877e+00 -1.594818e+01)

lag_freq(1).log_mass,6.258481e+00,+2.027798e-02,-2.491601e-02
  Parameter 2 = 6.258481e+00 (6.233565e+00 - 6.278759e+00)


.....................................................................


##### Pull into Lyra  #####

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_lo_cts_data_best_fit.ps .

##### Convert ps to png and rotate #######

ps2pdf 1H0707_lo_cts_data_best_fit.ps

pdftocairo -png 1H0707_lo_cts_data_best_fit.pdf

display 1H0707_lo_cts_data_best_fit-1.png

cp 1H0707_lo_cts_data_best_fit-1.png /home/WWW/steff/ecm

#+END_EXAMPLE

PATH =
=/home/steff075/phd_ecm/results-ecm/1H0707_lo_cts_data_best_fit-1.png=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707_lo_cts_data_best_fit-1.png

*** Lo counts FM = 6.03, 6.1

M = 6.03

#+BEGIN_EXAMPLE
1H0707-lo-cts-lc-data.sl
Submitted batch job 4012477

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.725789e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.03           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              2.9           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Obsid 1H0707_lo_cts_data
chi^2 = 4.696549e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+1.094504e+00 -0.000000e+00)
Parameter Gamma1 = 2.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+0.000000e+00 -4.203647e+00)
Parameter t_shift = 2.000000e+01 (+9.516900e-02 -7.022910e-01)

#+END_EXAMPLE


M = 6.1

#+BEGIN_EXAMPLE
Submitted batch job 4012507

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.583006e-05           0       0.001
  2  lag_freq(1).log_mass   0     1              6.1           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              3.1           0           0
  8  lag_freq(1).Gamma2     0     1              2.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0



Obsid 1H0707_lo_cts_data
chi^2 = 2.642809e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+1.144186e+00 -0.000000e+00)
Parameter Gamma1 = 3.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+0.000000e+00 -4.395825e+01)
Parameter t_shift = 1.000000e+01 (+5.743444e+00 -0.000000e+00)



#+END_EXAMPLE

M = 6.15

#+BEGIN_EXAMPLE
1H0707-lo-cts-lc-data.sl
Submitted batch job 4016728

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.539786e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.15           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              270           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0


Obsid 1H0707_lo_cts_data
chi^2 = 2.425172e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+4.758402e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.700000e+02 (+1.396980e+02 -4.760076e+01)
Parameter t_shift = 3.000000e+01 (+2.301255e+01 -5.978115e+00)

#+END_EXAMPLE

*** Hi counts lc >20 cts $s^{-1}$

PATH = =1H0707-hi-cts-lc-data.sl=

#+BEGIN_EXAMPLE
Fitting:

1H0707-495-time-lags-lc-cts-above20.fits
1H0707-495-time-lags-lc-cts-above20.rsp

...................................

1H0707-hi-cts-lc-data.sl
Submitted batch job 3971882

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0]; % h2
vals_to_fit[2] = [2.6, 2.7, 2.8, 2.9, 3.0, 3.1, 3.2, 3.3]; % Gamma 1
vals_to_fit[3] = [2.5, 2.6, 2.7, 2.8, 2.9, 3.0, 3.1, 3.2,]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 200.0, 210.0, 220.0, 230.0, 250.0, 300.0, 350.0, 400.0, 450.0, 500.0, 550.0, 600.0]; % t\
_max (zero doesn't seem to work)
vals_to_fit[10] = [0.0, 0.5, 10.0, 15.0, 20.0, 30.0, 50.0, 60.0, 70.0, 80.0, 85.0, 90.0, 95.0, 100.0, 110.0, 120.\
0]; % t_shift


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.794775e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.160047           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                7           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0


Obsid 1H0707_hi_cts_data
chi^2 = 2.709290e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 7.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+2.523885e-01 -1.500765e-01)
Parameter Gamma2 = 2.500000e+00 (+3.565638e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.634741e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+2.180566e+02 -6.122328e+01)
Parameter t_shift = 5.000000e+01 (+3.144596e+01 -3.356834e+00)

........................................

Above fit found on multiple occasions - run finer blob code?

#############################################################

1H0707-hi-cts-lc-data.sl
Submitted batch job 3972441


Improved fit...
ffopen could not interpret primary array header of file:
/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/lag-files/i53/a0.998
/h02.0+04.0/g2.3+2.3/A01.0/x3.0/p00.0/b02.0/q0.5/tmax0500/tshift0015/lag.fits
tried to move past end of file: /mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/lag-files/i53/a0.998/\
h02.0+04.0/g2.3+2.3/A01.0/x3.0/p00.0/b02.0/q0.5/tmax0500/tshift0015/lag.fits^M
/mnt/storage/scratch/so14935/isis/1.6.2/share/fits.sl:123:fits_check_error:Fits Error
Error: function evaluation failed^M
Traceback: _mode_switch
Traceback: _fit
............................................................

File deleted and now submitted to fit:


1H0707-hi-cts-lc-data.sl
Submitted batch job 3972505


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9]; % Gamma 1
vals_to_fit[3] = [2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 150.0, 170.0, 200.0, 210.0, 220.0, 230.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0, 310.\
0, 315.0, 320.0, 330.0, 350.0, 400.0, 450.0, 500.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [20.0, 30.0, 40.0, 45.0, 48.0, 49.0, 50.0, 52.0, 55.0, 56.0, 60.0, 70.0, 80.0]; % t_shift


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.879465e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.172014           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              290           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0


Obsid 1H0707_hi_cts_data
chi^2 = 2.653772e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.500000e+00 (+0.000000e+00 -2.917886e-01)
Parameter Gamma2 = 2.200000e+00 (+5.347168e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+6.823773e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.900000e+02 (+2.006375e+01 -1.322326e+02)
Parameter t_shift = 5.000000e+01 (+0.000000e+00 -9.802372e-01)

No better fits found unless tmax and tshift are run finer!

............................................................

1H0707-hi-cts-lc-data.sl
Submitted batch job 3993972

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.832556e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.040349         5.9         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               70           0           0


Obsid 1H0707_hi_cts_data
chi^2 = 2.512462e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.293341e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+0.000000e+00 -8.491599e+01)
Parameter t_shift = 7.000000e+01 (+0.000000e+00 -0.000000e+00)

............................................................

1H0707-hi-cts-lc-data.sl
Submitted batch job 3994530

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.389867e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         5.938911         5.9         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              1.9           0           0
  8  lag_freq(1).Gamma2     0     1              1.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               90           0           0



Obsid 1H0707_hi_cts_data
chi^2 = 2.427662e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 1.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+8.111265e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.000000e+02 (+0.000000e+00 -1.686457e+02)
Parameter t_shift = 9.000000e+01 (+0.000000e+00 -7.219060e+01)

lag_freq(1).log_mass,5.992163e+00,+3.424643e-02,-3.403119e-02
  Parameter 2 = 5.992163e+00 (5.958132e+00 - 6.026409e+00)

#+END_EXAMPLE

*** Hi counts FM = 6.03, 6.1

M = 6.03

#+BEGIN_EXAMPLE
1H0707-hi-cts-lc-data.sl
Submitted batch job 4012478

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.347864e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.03         5.9         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.9           0           0
  8  lag_freq(1).Gamma2     0     1              1.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               70           0           0

Obsid 1H0707_hi_cts_data
chi^2 = 2.600068e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+4.644326e+00 -0.000000e+00)
Parameter Gamma1 = 1.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+5.677651e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+7.748854e+01 -6.861715e+01)
Parameter t_shift = 7.000000e+01 (+1.122915e+01 -1.441694e+01)


#+END_EXAMPLE

M = 6.1

#+BEGIN_EXAMPLE
1H0707-hi-cts-lc-data.sl
Submitted batch job 4014238

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.923231e-05           0       0.001
  2  lag_freq(1).log_mass   0     1              6.1         5.9         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              1.8           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              320           0           0
 15  lag_freq(1).t_shift    0     1               60           0           0



Obsid 1H0707_hi_cts_data
chi^2 = 3.466157e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 1.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+8.500868e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.200000e+02 (+1.988072e-01 -4.900596e+00)
Parameter t_shift = 6.000000e+01 (+7.984094e+00 -1.408271e+01)


#+END_EXAMPLE

M = 6.15

#+BEGIN_EXAMPLE
1H0707-hi-cts-lc-data.sl
Submitted batch job 4016735

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.448094e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.15         5.9         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.1           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               55           0           0


Obsid 1H0707_hi_cts_data
chi^2 = 2.857208e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+5.775912e+00 -0.000000e+00)
Parameter Gamma1 = 2.100000e+00 (+0.000000e+00 -3.485095e-01)
Parameter Gamma2 = 1.800000e+00 (+3.596585e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+6.679004e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+1.979217e-01 -3.477401e+01)
Parameter t_shift = 5.500000e+01 (+7.226523e+00 -1.440085e+01)





#+END_EXAMPLE

*** OBS 0110890201 (2000)

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_0110890201.sl=


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0110890201_lagfreq.gif

saved in =time_lags_0110890201_A.csv=

*ECM Fitting*


#+BEGIN_EXAMPLE

1H0707-0110890201-fit-error.sl
Submitted batch job 3973800

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.4, 2.5, 2.6, 2.8, 2.9, 3.0, 3.1, 3.2]; % Gamma1
vals_to_fit[3] = [2.2, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9, 3.0, 3.1]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 150.0, 200.0, 220.0, 250.0, 280.0, 300.0, 350.0, 400.0, 420.0,  450.0, 480.0, 500.0\
, 540.0, 550.0, 600.0, 700.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [0.0, 10.0, 20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0, 105.0, 110.0, 120.0]; %\
 t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     6.761046e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.094733           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Obsid 1H0707_0110890201
chi^2 = 2.284032e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 3.000000e+00 (+8.723370e-02 -0.000000e+00)
Parameter Gamma2 = 2.800000e+00 (+8.707566e-02 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.000000e+02 (+3.041687e+01 -2.385632e-01)
Parameter t_shift = 2.000000e+01 (+2.732335e+01 -1.231063e+01)

.......................................................

1H0707-0110890201-fit-error.sl
Submitted batch job 3974240

no better fit found yet

###############################################
Copy fit to Lyra and WWW:

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0110890201_best_fit.ps .

ps2pdf 1H0707_0110890201_best_fit.ps
pdftocairo -png 1H0707_0110890201_best_fit.pdf
cp 1H0707_0110890201_best_fit-1.png /home/WWW/steff/ecm

#+END_EXAMPLE

Improve fit
#+BEGIN_EXAMPLE
1H0707-0110890201-fit-error.sl
Submitted batch job 3982306


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.8, 2.9, 3.0, 3.1, 3.2]; % Gamma1
vals_to_fit[3] = [2.6, 2.7, 2.8, 2.9, 3.0]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 150.0, 200.0, 220.0, 250.0, 280.0, 300.0, 350.0, 400.0, 420.0,  450.0, 480.0, 420.0, 450.0, 460.0,\
 500.0, 540.0, 550.0, 600.0, 700.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [0.0, 10.0, 15.0, 20.0, 25.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0, 105.0, 110.0, 120.0]; % t_\
shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     6.946307e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.094713           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              3.2           0           0
  8  lag_freq(1).Gamma2     0     1                3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Obsid 1H0707_0110890201
chi^2 = 2.159083e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 3.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.000000e+02 (+1.237720e+02 -3.055356e+02)
Parameter t_shift = 2.000000e+01 (+2.462073e+01 -1.018980e+01)

....................................................................

1H0707-0110890201-fit-error.sl
Submitted batch job 3988067


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [3.1, 3.2, 3.3]; % Gamma1
vals_to_fit[3] = [2.8, 2.9, 3.0, 3.1, 3.2]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [200.0, 300.0, 420.0, 450.0, 480.0, 420.0, 450.0, 460.0, 480.0, 490.0, 500.0, 510.0, 520.0, 530.0, 5\
40.0, 550.0, 560.0, 580.0, 600.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [0.0, 10.0, 15.0, 20.0, 25.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0, 110.0, 120.0]; % t_s\
hift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      6.93946e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.074621           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                7           0           0
  7  lag_freq(1).Gamma1     0     1              3.2           0           0
  8  lag_freq(1).Gamma2     0     1                3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              560           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid 1H0707_0110890201
chi^2 = 1.704246e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 7.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 3.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 3.000000e+00 (+1.805706e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.600000e+02 (+0.000000e+00 -4.149611e+00)
Parameter t_shift = 2.000000e+01 (+1.371752e+00 -3.628248e+00)

....................................................................

1H0707-0110890201-fit-error.sl
Submitted batch job 4034042

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     7.013862e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.074584           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                7           0           0
  7  lag_freq(1).Gamma1     0     1              3.2           0           0
  8  lag_freq(1).Gamma2     0     1                3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              560           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Obsid 1H0707_0110890201
chi^2 = 1.687988e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 7.000000e+00 (+0.000000e+00 -1.005661e+00)
Parameter Gamma1 = 3.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 3.000000e+00 (+0.000000e+00 -2.037888e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.600000e+02 (+5.140835e+00 -2.754557e+01)
Parameter t_shift = 2.000000e+01 (+1.369494e+00 -2.213573e+00)

Parameter 2 = 6.074584e+00 (6.034053e+00 - 6.110085e+00)
lag_freq(1).log_mass,6.074584e+00,+3.550052e-02,-4.053131e-02
................................................................

Obtain Mass Error

To do this you must set the script to fit only the single parameter values listed above.
Do this using the following code placed into line 293 of the fitting script:

	variable z = [2], all_good, good, i, lo, hi;

	variable all_good, good, i, lo, hi;

	do {
		vmessage("\n\n--Starting to determine confidence intervals--\n");
		all_good = 1;
		fp = fopen(obsid + "_mass_error.par","w");% Create the file
	        for (i=0; i<length(z); i++) {
			do {
				good = 1;
				(lo, hi) = conf(z[i]);
				vmessage("  Parameter %i = %e (%e - %e)", z[i], get_par(z[i]), lo, hi);
		        	() = fprintf(fp, "%s,%e,+%e,-%e\n", get_par_info(z[i]).name, get_par(z[i]), hi-get_par(z[i]), get_par(z[i])-lo);
                        	if (lo == hi) {
				        % this means that a better fit was found
				        vmessage("Found a better fit!");
				        () = fit_counts;
				        good = 0;
				        all_good = 0;
			        }
			} while (good == 0);
			%vmessage("Parameter %i = %e (%e - %e)", p[i], get_par(p[i]), lo, hi);
		}
        	() = fclose(fp);
	} while (all_good == 0);



###########################################################
Refit with 1H0707-495-OBS-0110890201-time-lags-A.fits & rsp
###########################################################



.......................................................................

refit to check errors

Submitted batch job 4050532

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.514207e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.034376           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                7           0           0
  7  lag_freq(1).Gamma1     0     1              3.1           0           0
  8  lag_freq(1).Gamma2     0     1              2.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              560           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid 1H0707_0110890201_A
chi^2 = 8.285098e-02 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 7.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 3.100000e+00 (+0.000000e+00 -6.731786e-01)
Parameter Gamma2 = 2.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.600000e+02 (+0.000000e+00 -3.634727e+02)
Parameter t_shift = 2.000000e+01 (+0.000000e+00 -0.000000e+00)


lag_freq(1).log_mass,6.034376e+00,+1.159044e-01,-2.871615e-02
 Parameter 2 = 6.034376e+00 (6.005660e+00 - 6.150281e+00)

################################################################################

All data copied to

/data/typhon1/reverb/1H0707-495

ps2pdf 1H0707_0110890201_A_best_fit.ps

pdftocairo -png 1H0707_0110890201_A_best_fit.pdf

#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_A_best_fit.png


**** Fix M to 6.03

#+BEGIN_EXAMPLE
1H0707-0110890201-fit-error.sl
Submitted batch job 4010906

ag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     8.405864e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.03           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               10           0           0
  7  lag_freq(1).Gamma1     0     1              3.2           0           0
  8  lag_freq(1).Gamma2     0     1                3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              600           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0


Obsid 1H0707_0110890201
chi^2 = 2.830950e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.000000e+01 (+0.000000e+00 -3.522783e+00)
Parameter Gamma1 = 3.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.000000e+02 (+0.000000e+00 -4.559135e+01)
Parameter t_shift = 3.000000e+01 (+2.322329e+01 -3.451342e+00)
#+END_EXAMPLE


*Fix M to 6.1*


#+BEGIN_EXAMPLE
1H0707-0110890201-fit-error.sl
Submitted batch job 4012235

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     7.207078e-05           0       0.001
  2  lag_freq(1).log_mass   0     1              6.1           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              3.3           0           0
  8  lag_freq(1).Gamma2     0     1              3.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

bsid 1H0707_0110890201
chi^2 = 2.296485e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+0.000000e+00 -1.714467e+00)
Parameter Gamma1 = 3.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 3.100000e+00 (+8.946861e-02 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.000000e+02 (+2.918760e+00 -7.081240e+00)
Parameter t_shift = 2.000000e+01 (+1.459380e+00 -3.540620e+00)

#+END_EXAMPLE



*Fix M to 6.15*


#+BEGIN_EXAMPLE
1H0707-0110890201-fit-error.sl
Submitted batch job 4016111

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      7.94525e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.15           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                7           0           0
  7  lag_freq(1).Gamma1     0     1              3.3           0           0
  8  lag_freq(1).Gamma2     0     1              3.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0

Obsid 1H0707_0110890201
chi^2 = 2.516938e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 7.000000e+00 (+0.000000e+00 -3.645383e+00)
Parameter Gamma1 = 3.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 3.100000e+00 (+9.461367e-02 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.000000e+02 (+2.989854e+00 -7.010146e+00)
Parameter t_shift = 3.000000e+01 (+9.046247e+00 -3.505073e+00)


#+END_EXAMPLE

*** OBS 0110890201 ECM Best fit

PATH = =/home/steff075/phd_ecm/results-for-all/emcee=

The fit file for this observation is:

#+BEGIN_EXAMPLE
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.514207e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.034376           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                7           0           0
  7  lag_freq(1).Gamma1     0     1              3.1           0           0
  8  lag_freq(1).Gamma2     0     1              2.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              560           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Obsid 1H0707_0110890201_A
chi^2 = 8.285098e-02 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 7.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 3.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.600000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 2.000000e+01 (+0.000000e+00 -0.000000e+00)

lag_freq(1).log_mass,6.034376e+00,+1.159044e-01,-2.871615e-02
 Parameter 2 = 6.034376e+00 (6.005660e+00 - 6.150281e+00)

Located in: /mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/

cd lag-files/i53/a0.998/h02.0+07.0/g3.1+2.9/A01.0/x3.0/p00.0/b03.0/q0.5/tmax0560/tshift0020/

#+END_EXAMPLE

Copy fits file to Lyra and rename file for use

#+BEGIN_EXAMPLE
scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/lag-files/i53/a0.998/h02.0+07.0/g3.1+2.9/A01.0/x3.0/p00.0/b03.0/q0.5/tmax0560/tshift0020/lag.fits .

mv lag.fits 1H0707_0110890201_best_fit_lag.fits
#+END_EXAMPLE

Run csv2fits.py

#+BEGIN_EXAMPLE
import csv
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from astropy.io import fits as pyfits

# Prepare to write the data to a CSV file by reading the fits header line using pyfits
data = pyfits.getdata(r'1H0707_0110890201_best_fit_lag.fits')
#print (data)

# Create the csv file
with open(r'1H0707_0110890201_best_fit_lag.csv', 'w') as csvfile:
    writer = csv.writer(csvfile)
    writer.writerows(data)

# Import csv with pandas and name cloumn headers
cols=['Freq', 'Lag']
df = pd.read_csv(r'1H0707_0110890201_best_fit_lag.csv', names=cols, header=None)
print (df)

# Plot the data
df.plot(x="Freq", y="Lag", logx=True, xlim=(1e-4,1.0), figsize=(6,4))
#plt.show()
plt.savefig(r'1H0707_0110890201_best_fit_lag.pdf')
plt.savefig(r'1H0707_0110890201_best_fit_lag.png')
#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_best_fit_lag.png


Copy this fit script to 1H0707-emcee-test1.sl

set script to best fit pars and run to check all is working ok

Submitted batch job 4050539


*Plot the data and the model*

PATH =/home/steff075/phd_ecm/results-for-all/emcee/1H0707_0110890201_best_fit_lag_and_data.py=
#+BEGIN_EXAMPLE
import numpy as np
import matplotlib.pyplot as plt
import os
import sys
import numpy as np
import emcee

plt.style.use('classic')
plt.rcParams['font.family'] = 'serif'
plt.rcParams['font.serif'] = ['Times New Roman'] + plt.rcParams['font.serif']

#Import data
data = np.loadtxt('1H0707_0110890201_lags.csv', delimiter=',', skiprows=1)
model = np.loadtxt('1H0707_0110890201_best_fit_lag.csv', delimiter=',', skiprows=1)

# Model Mass for data
logM = 6.034376
# Define units of tg = GM/c^3
# tg = LogM * M_sun * G / c^3 =((2041737.945*2E33*6.67408E-8)/(2.99E10)**3) in cgs units
# Define M = mass of AGN in M_sun and other constants
M = 10 ** logM
Msun = 2.0E33
G = 6.67408E-8
c = 2.998E10
tg = M * Msun * G / c **3

dlag = data[:,2]
dlag_tg = dlag / tg
dlag_err = data[:,3]
dlag_err_tg = dlag_tg / tg
dfreq = data[:,0]
dfreq_err = data[:,1]
mlag = model[:,1]
mfreq = model[:,0]

x = dfreq
y = dlag
yerr = dlag_err
x_model = mfreq
y_model = mlag * tg

# Plot data in units of tg
plt.errorbar(x, y, yerr, fmt='o', c='b')
plt.plot(x_model, y_model, c = 'r')
plt.xscale('log')
plt.xlabel(r'$Frequency~(Hz)$', fontsize=15)
plt.ylabel(r'$Time~Lag~(s)$', fontsize=15)
plt.xlim(5e-5,0.01)
line = ([-1e-5, 0.1], [0,0])
plt.plot(line, linestyle='dashed', linewidth='0.3', color = 'black')
#plt.show(block=False)
#plt.show()
#plt.savefig('1H0707_0110890201_best_fit_lag_and_data.png')

# Plot Model
plt.plot(x_model, y_model, c = 'r')
plt.xscale('log')
plt.xlabel(r'$Frequency~(Hz)$', fontsize=15)
plt.ylabel(r'$Time~Lag~(t_g)$', fontsize=15)
#plt.xlim(5e-5,0.01)
#line = ([-1e-5, 0.1], [0,0])
#plt.plot(line, linestyle='dashed', linewidth='0.3', color = 'black')
#plt.show(block=False)
#plt.savefig('1H0707_0110890201_best_fit_lag.png')pl

#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_best_fit_lag_and_data.png


The frequency should be reversed so flip the array
#+BEGIN_EXAMPLE
x_model = np.flipud(mfreq)
#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_best_fit_lag_and_data_flip.png

*** OBS 0110890201 isis emcee

PATH TO DATA = =/data/typhon1/reverb/1H0707-495/isis_emcee/=

Fit script = =1H0707-0110890201-fit-emcee.sl=

Fitting Parameter file =1H0707_0110890201_A_best_fit.par=

Fit obs 0110890201 to the best fit using the scripts outlined (above)

Make good image of the ECM Model fit

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0110890201_best fit.ps/cps");
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
plot_comps(1,popt,&plot_data);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgsci(1); % make line colour black
_pgdraw(1,0);
close_plot(pid);
#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_best_fit-1.png

This model fit with χ²=0.08 and the parameters for this particular fit are:

+----------+----------------------+--------+--------+--------------+-----+-------+
| lag_freq |                      |        |        |              |     |       |
+----------+----------------------+--------+--------+--------------+-----+-------+
|      idx | param                | tie-to | freeze |        value | min |   max |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        1 | lag_freq(1).norm     |      0 |      0 | 4.514207e-05 |   0 | 0.001 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        2 | lag_freq(1).log_mass |      0 |      0 |     6.034376 |   5 |     7 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        3 | lag_freq(1).i        |      0 |      1 |           53 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        4 | lag_freq(1).a        |      0 |      1 |        0.998 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        5 | lag_freq(1).h1       |      0 |      1 |            2 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        6 | lag_freq(1).h2       |      0 |      1 |            7 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        7 | lag_freq(1).Gamma1   |      0 |      1 |          3.1 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        8 | lag_freq(1).Gamma2   |      0 |      1 |          2.9 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        9 | lag_freq(1).Fe       |      0 |      1 |            1 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       10 | lag_freq(1).xi       |      0 |      1 |            3 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       11 | lag_freq(1).p        |      0 |      1 |            0 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       12 | lag_freq(1).b        |      0 |      1 |            3 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       13 | lag_freq(1).q2       |      0 |      1 |          0.5 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       14 | lag_freq(1).t_max    |      0 |      1 |          560 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       15 | lag_freq(1).t_shift  |      0 |      1 |           20 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+



#+BEGIN_EXAMPLE
isis

.source("1H0707-0110890201-fit-emcee.sl");

where

% Perform MCMC
emcee(500, 5000; output="1H0707_0110890201_chain_500_5000.fits", serial);

% Read the chain-file
(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("1H0707_0110890201_chain_500_5000.fits");
#+END_EXAMPLE


*Paths of the walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_walkers-1.png


*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_mass_accept_rate-1.png


Obtain the Norm pobability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_norm_probability-1.png


Obtain the Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_mass_probability-1.png

*Contours: paths in 2D*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_chain_hist2d-1.png

*Chain statistics*


#+BEGIN_EXAMPLE
s=600; % start at this iteration step
min(min_statistic[[s:]]);


min(min_statistic[[s:]]);
0.08284946618179345
#+END_EXAMPLE

Here, this results in χ²=0.08, which is identical after previously
fitting the data where χ²=0.08 as outlined above.

Plotting the statistic array is another diagnostic tool:

#+BEGIN_EXAMPLE

n=length(max_statistic)-1;
yrange(min(min_statistic[[s:]])*.9, max(max_statistic[[s:]])*1.1);
plot([s:n], min_statistic[[600:]]);
oplot([s:n], max_statistic[[600:]]);
oplot([s:n], med_statistic[[600:]]);

#+END_EXAMPLE

Make good image of the statistics

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0110890201_statistics.ps/cps");
charsize(1.3); %good font size
_pgscf(2); %make font roman
plot([s:n], min_statistic[[600:]]);
oplot([s:n], max_statistic[[600:]]);
oplot([s:n], med_statistic[[600:]]);
close_plot(pid);

Then:

ps2pdf 1H0707_0110890201_statistics.ps
pdftocairo -png 1H0707_0110890201_statistics.pdf
cp  1H0707_0110890201_statistics-1.png /home/WWW/steff/ecm

#+END_EXAMPLE


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_statistics-1.png


Error analysis

#+CAPTION: The 68% confidence probability for 1H0707-495 Mass value where $\mu = 6.05\pm0.03$ (solid blue line. Error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_logmass_conf68.gif



#+CAPTION: The 90% confidence probability for 1H0707-495 Mass value where $\mu = 6.06\pm0.05$ (solid blue line) with the error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_logmass_conf90.gif

*** OBS 0110890201 segs <2.8E-3 Hz

PATH = =1H0707-0110890201-fit-segs.sl=

Fitting:
#+BEGIN_EXAMPLE
1H0707-495-OBS-0110890201-time-lags-segs.fits
1H0707-495-OBS-0110890201-time-lags-segs.rsp
#+END_EXAMPLE


#+BEGIN_EXAMPLE

#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/





*** OBS 0148010301 (2002)

Use script =/homeb/steff075/phd_ecm/1h0707/lagfreq_single_script.sl=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0148010301_lagfreq.gif

*ECM Fitting*


#+BEGIN_EXAMPLE
1H0707-0148010301-fit-error.sl
Submitted batch job 3973811

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.782212e-05           0       0.001
  2  lag_freq(1).log_mass   0     0          6.20887           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              700           0           0
 15  lag_freq(1).t_shift    0     1               60           0           0


Obsid 1H0707_0148010301
chi^2 = 9.586174e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+7.085975e-01 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+7.566511e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 7.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 6.000000e+01 (+4.359527e+01 -5.748670e+01)


###################################################
1H0707-0148010301-fit-error.sl
Submitted batch job 3974241

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0148010301_best_fit.ps .

ps2pdf 1H0707_0148010301_best_fit.ps
pdftocairo -png 1H0707_0148010301_best_fit.pdf
cp 1H0707_0148010301_best_fit-1.png /home/WWW/steff/ecm

...................................................


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.782242e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.208855           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              700           0           0
 15  lag_freq(1).t_shift    0     1               60           0           0

Obsid 1H0707_0148010301
chi^2 = 9.586250e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+2.671654e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.248354e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 7.000000e+02 (+2.556965e+01 -4.472711e+01)
Parameter t_shift = 6.000000e+01 (+0.000000e+00 -4.059411e+00)


lag_freq(1).log_mass,6.214620e+00,+6.450091e-02,-6.886682e-02

########################################################

refit - A

Submitted batch job 4090565

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.948793e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.316628           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0


Obsid 1H0707_0148010301_A
chi^2 = 5.841070e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.000000e+02 (+2.074945e+02 -0.000000e+00)
Parameter t_shift = 5.000000e+01 (+4.291827e+01 -2.154183e+01)

lag_freq(1).log_mass,6.316628e+00,+5.792293e-02,-5.775432e-02
  Parameter 2 = 6.316628e+00 (6.258873e+00 - 6.374551e+00)



#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0148010301_A_best_fit.png

**** Fixing logM

*Fix M to 6.03*


#+BEGIN_EXAMPLE
1H0707-0148010301-fit-error.sl
Submitted batch job 4010907

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.643828e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.03           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              150           0           0
 15  lag_freq(1).t_shift    0     1               90           0           0




Obsid 1H0707_0148010301
chi^2 = 2.879772e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.500000e+02 (+4.554346e+02 -0.000000e+00)
Parameter t_shift = 9.000000e+01 (+0.000000e+00 -0.000000e+00)


#+END_EXAMPLE



*Fix M to 6.1*


#+BEGIN_EXAMPLE
1H0707-0148010301-fit-error.sl
Submitted batch job 4012236


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.246266e-05           0       0.001
  2  lag_freq(1).log_mass   0     1              6.1           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              800           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0

Obsid 1H0707_0148010301
chi^2 = 1.301536e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 8.000000e+02 (+0.000000e+00 -4.036441e+01)
Parameter t_shift = 8.000000e+01 (+2.074609e+01 -7.298019e+01)


#+END_EXAMPLE



*Fix M to 6.15*


#+BEGIN_EXAMPLE
Obsid 1H0707_0148010301
Submitted batch job 4016112

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.185058e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.15           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              800           0           0
 15  lag_freq(1).t_shift    0     1               70           0           0

Obsid 1H0707_0148010301
chi^2 = 9.876768e-01 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 8.000000e+02 (+0.000000e+00 -4.057508e+01)
Parameter t_shift = 7.000000e+01 (+2.093086e+01 -6.617500e+01)


#+END_EXAMPLE

*** OBS 0148010301 isis emcee

PATH TO DATA = =/data/typhon1/reverb/1H0707-495/isis_emcee/=

Fit script = =1H0707-0148010301-fit-emcee.sl=

Fitting Parameter file =1H0707_0148010301_best_fit.par=

Make good image of the ECM Model fit

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0148010301_best_fit.ps/cps");
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
plot_comps(1,popt,&plot_data);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgsci(1); % make line colour black
_pgdraw(1,0);
close_plot(pid);
#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0148010301_best_fit-1.png

This model fit with χ²=0.96 and the parameters for this particular fit are:

+----------+----------------------+--------+--------+--------------+-----+-------+
| lag_freq |                      |        |        |              |     |       |
+----------+----------------------+--------+--------+--------------+-----+-------+
|      idx | param                | tie-to | freeze |        value | min |   max |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        1 | lag_freq(1).norm     |      0 |      0 | 2.782242e-05 |   0 | 0.001 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        2 | lag_freq(1).log_mass |      0 |      0 |     6.208855 |   5 |     7 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        3 | lag_freq(1).i        |      0 |      1 |           53 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        4 | lag_freq(1).a        |      0 |      1 |        0.998 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        5 | lag_freq(1).h1       |      0 |      1 |            2 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        6 | lag_freq(1).h2       |      0 |      1 |            5 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        7 | lag_freq(1).Gamma1   |      0 |      1 |          2.4 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        8 | lag_freq(1).Gamma2   |      0 |      1 |          2.2 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        9 | lag_freq(1).Fe       |      0 |      1 |            1 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       10 | lag_freq(1).xi       |      0 |      1 |            2 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       11 | lag_freq(1).p        |      0 |      1 |            0 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       12 | lag_freq(1).b        |      0 |      1 |            3 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       13 | lag_freq(1).q2       |      0 |      1 |          0.5 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       14 | lag_freq(1).t_max    |      0 |      1 |          700 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       15 | lag_freq(1).t_shift  |      0 |      1 |           60 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+



*Lets Apply EMCEE to this model and use 500 Walkers with 5000 iterations in the chain*

#+BEGIN_EXAMPLE
isis

.source("1H0707-0148010301-fit-emcee.sl");

where

% Perform MCMC
emcee(500, 5000; output="1H0707_0148010301_chain_500_5000.fits", serial);

 *** Using 1H0707_0148010301_chain_500_5000.fits for output file ***

 Serial Run

 Sim loop:
50 ...


[detached from 120588.pts-4.hm00]





% Read the chain-file
(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("1H0707_0148010301_chain_500_5000.fits");
#+END_EXAMPLE


*Paths of the walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0148010301_walkers-1.png



*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0148010301_mass_accept_rate-1.png


Norm probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0148010301_norm_probability-1.png


Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0148010301_mass_probability-1.png

*Contours: paths in 2D*


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0148010301_chain_hist2d-1.png

#########################

  STOP !!!!!



########################################################################
########################################################################

This chain did not converge - try 500 walkers and 5000 iterations

########################################################################
########################################################################







*Chain statistics*


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0148010301_statistics-1.png


*Uncertainty estimation*

#+BEGIN_EXAMPLE
min(min_statistic[[s:]]);

pmin;
pmax; 6

..............................

At 68% conf = conf_min; , conf_max;,  conf_mean;

...................................

At 90% conf = conf_min; ,  conf_max; , conf_mean;

#+END_EXAMPLE

#+CAPTION: The 68 % confidence mass for 1H0707-495 OBS ID 0148010301 at $\pm ~logM_{\odot}$.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0148010301_logmass_conf68.gif

#+CAPTION: The 90 % confidence mass for 1H0707-495 OBS ID 0148010301 at $\pm ~logM_{\odot}$
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0148010301_logmass_conf90.gif


*** OBS 0506200201 (2007)

Use script =/homeb/steff075/phd_ecm/1h0707/lagfreq_single_script.sl=


#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0506200201_lagfreq.gif

*ECM Fitting*

#+BEGIN_EXAMPLE
1H0707-0506200201-fit-error.sl
Submitted batch job 3973825

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.4, 2.5, 2.6, 2.8, 2.9, 3.0, 3.1, 3.2]; % Gamma1
vals_to_fit[3] = [2.2, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9, 3.0, 3.1]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 150.0, 200.0, 220.0, 250.0, 280.0, 300.0, 350.0, 400.0, 420.0,  450.0, 480.0, 500.0, 540.0, 550.0, 600.0, 700.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [0.0, 10.0, 20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0, 105.0, 110.0, 120.0]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001016224           0       0.001
  2  lag_freq(1).log_mass   0     0         6.153943           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0


Obsid 1h0707-_0506200201
chi^2 = 1.186959e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+3.266471e-01 -0.000000e+00)
Parameter Gamma2 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 8.000000e+01 (+0.000000e+00 -2.693123e+01)

........................................................

1H0707-0506200201-fit-error.sl
Submitted batch job 3974242

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     9.327259e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.154736           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               85           0           0


Obsid 1H0707_0506200201
chi^2 = 1.165760e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 8.500000e+01 (+0.000000e+00 -3.160186e+01)

lag_freq(1).log_mass,6.154736e+00,+5.875099e-02,-4.389139e-02

########################################################

refit - A

Submitted batch job 4090566

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.305398e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.311795           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               95           0           0


Obsid 1H0707_0506200201_A
chi^2 = 1.817201e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 3.000000e+00 (+3.510490e+00 -0.000000e+00)
Parameter Gamma2 = 2.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 9.500000e+01 (+0.000000e+00 -8.087597e+01)


Submitted batch job 4090601


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.473539e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.179126           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               11           0           0
  7  lag_freq(1).Gamma1     0     1              2.9           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0


Obsid 1H0707_0506200201_A
chi^2 = 9.997359e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.100000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 1.000000e+01 (+0.000000e+00 -0.000000e+00)


###########################################################
scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0506200201_best_fit.ps .

ps2pdf 1H0707_0506200201_best_fit.ps
pdftocairo -png 1H0707_0506200201_best_fit.pdf
cp 1H0707_0506200201_best_fit-1.png /home/WWW/steff/ecm

#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_A_best_fit.png

**** Fixing logM


*Fix M to 6.03*


#+BEGIN_EXAMPLE
1H0707-0506200201-fit-error.sl
Submitted batch job 4010908

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001117046           0       0.001
  2  lag_freq(1).log_mass   0     1             6.03           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               10           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

bsid 1H0707_0506200201
chi^2 = 2.626258e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.000000e+01 (+0.000000e+00 -3.882296e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+3.425485e+01 -3.376999e+01)
Parameter t_shift = 2.000000e+01 (+2.965023e+01 -0.000000e+00)




#+END_EXAMPLE



*Fix M to 6.1*


#+BEGIN_EXAMPLE
1H0707-0506200201-fit-error.sl
Submitted batch job 4012237

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     9.020958e-05           0       0.001
  2  lag_freq(1).log_mass   0     1              6.1           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                8           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              540           0           0
 15  lag_freq(1).t_shift    0     1               90           0           0


Obsid 1H0707_0506200201
chi^2 = 1.195301e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 8.000000e+00 (+0.000000e+00 -3.873813e+00)
Parameter Gamma1 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.400000e+02 (+9.912048e+01 -3.396992e+02)
Parameter t_shift = 9.000000e+01 (+1.292079e+01 -1.170116e+00)


#+END_EXAMPLE



*Fix M to 6.15*


#+BEGIN_EXAMPLE
Obsid 1H0707_0506200201
Submitted batch job 4016113

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001009302           0       0.001
  2  lag_freq(1).log_mass   0     1             6.15           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              2.9           0           0
  8  lag_freq(1).Gamma2     0     1              2.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0

Obsid 1H0707_0506200201
chi^2 = 1.175744e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+0.000000e+00 -2.940060e+00)
Parameter Gamma1 = 2.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.000000e+02 (+1.206518e+02 -3.126486e+02)
Parameter t_shift = 8.000000e+01 (+0.000000e+00 -1.445129e+01)





#+END_EXAMPLE

*** OBS 0506200201 isis emcee

PATH TO DATA = =/data/typhon1/reverb/1H0707-495/isis_emcee/=

Fit script = =1H0707-0506200201-fit-emcee.sl=

Fitting Parameter file =1H0707_0506200201_best_fit.par=

Fit obs 0506200201 to the best fit using the scripts outlined (above)

Make good image of the ECM Model fit

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0506200201_best_fit.ps/cps");
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
plot_comps(1,popt,&plot_data);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgsci(1); % make line colour black
_pgdraw(1,0);
close_plot(pid);
#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_best_fit-1.png

This model fit with χ²=1.17  and the parameters for this particular fit are:

+----------+----------------------+--------+--------+--------------+-----+-------+
| lag_freq |                      |        |        |              |     |       |
+----------+----------------------+--------+--------+--------------+-----+-------+
|      idx | param                | tie-to | freeze |        value | min |   max |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        1 | lag_freq(1).norm     |      0 |      0 | 9.327259e-05 |   0 | 0.001 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        2 | lag_freq(1).log_mass |      0 |      0 |     6.154736 |   6 |   6.5 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        3 | lag_freq(1).i        |      0 |      1 |           53 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        4 | lag_freq(1).a        |      0 |      1 |        0.998 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        5 | lag_freq(1).h1       |      0 |      1 |            2 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        6 | lag_freq(1).h2       |      0 |      1 |            5 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        7 | lag_freq(1).Gamma1   |      0 |      1 |            3 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        8 | lag_freq(1).Gamma2   |      0 |      1 |          2.9 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        9 | lag_freq(1).Fe       |      0 |      1 |            1 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       10 | lag_freq(1).xi       |      0 |      1 |            0 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       11 | lag_freq(1).p        |      0 |      1 |            0 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       12 | lag_freq(1).b        |      0 |      1 |            1 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       13 | lag_freq(1).q2       |      0 |      1 |          0.5 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       14 | lag_freq(1).t_max    |      0 |      1 |          500 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       15 | lag_freq(1).t_shift  |      0 |      1 |           85 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+




*Lets Apply EMCEE to this model and use 500 Walkers with 5000 iterations in the chain*

#+BEGIN_EXAMPLE
isis

.source("1H0707-0506200201-fit-emcee.sl");

where

% Perform MCMC
emcee(500, 5000; output="1H0707_0110890201_chain_500_5000.fits", serial);

% Read the chain-file
(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("1H0707_0110890201_chain_500_5000.fits");
#+END_EXAMPLE


*Paths of the walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_walkers-1.png



*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_mass_accept_rate-1.png


Norm probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_norm_probability-1.png


Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_mass_probability-1.png

*Contours: paths in 2D*


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_chain_hist2d-1.png

*Chain statistics*


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_statistics-1.png


*Uncertainty estimation*

#+BEGIN_EXAMPLE
min(min_statistic[[s:]]); 1.1657597134124094

pmin; 6.000844955444336
pmax; 6.3415846824646

..............................

At 68% conf = conf_min; 6.126918654441834, conf_max; 6.188251805305481,  conf_mean; 6.157585229873657

...................................

At 90% conf = conf_min; 6.106474270820618,  conf_max; 6.2052887916564945, conf_mean; 6.155881531238556

#+END_EXAMPLE

#+CAPTION: The 68 % confidence mass for 1H0707-495 OBS ID 0506200201 at $6.1575\pm 0.031~logM_{\odot}$.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_logmass_conf68.gif

#+CAPTION: The 90 % confidence mass for 1H0707-495 OBS ID 0506200201 at $6.1558\pm 0.049~logM_{\odot}$
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_logmass_conf90.gif


*** OBS 0506200301 (2007)

Use script =/homeb/steff075/phd_ecm/1h0707/lagfreq_single_script.sl=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0506200301_lagfreq.gif

*ECM Fitting*


#+BEGIN_EXAMPLE
1H0707-0506200301-fit-error.sl
Submitted batch job 3973829

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.441801e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.026365           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               10           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              100           0           0
 15  lag_freq(1).t_shift    0     1               90           0           0

Obsid 1H0707_0506200301
chi^2 = 1.359085e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.000000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+2.552141e-01 -0.000000e+00)
Parameter Gamma2 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 9.000000e+01 (+2.504543e+01 -8.751270e+01)

.......................................................................

1H0707-0506200301-fit-error.sl
Submitted batch job 3974441


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.043314e-05           0       0.001
  2  lag_freq(1).log_mass   0     0                6           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0


bsid 1H0707_0506200301
chi^2 = 1.347799e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.500000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 8.000000e+01 (+3.533683e+01 -7.787714e+01)

lag_freq(1).log_mass,5.986613e+00,+1.149233e-01,-8.210227e-02
Obsid 1H0707_0506200301
chi^2 = 1.308833e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through

###########################################################


Fit -A


Submitted batch job 4090578

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      9.45803e-06           0       0.001
  2  lag_freq(1).log_mass   0     0         5.954612           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                7           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0


Obsid 1H0707_0506200301_A
chi^2 = 1.275308e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 7.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.500000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 8.000000e+01 (+0.000000e+00 -0.000000e+00)

..................................................................
Submitted batch job 4091246

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.599124e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.008443           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                8           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0


Obsid 1H0707_0506200301_A
chi^2 = 1.294163e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 8.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.500000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 5.000000e+01 (+0.000000e+00 -4.033783e+01)

lag_freq(1).log_mass,6.008443e+00,+1.388863e-01,-1.037775e-01
  Parameter 2 = 6.008443e+00 (5.904665e+00 - 6.147329e+00)


###########################################################
scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0506200301_best_fit.ps .

ps2pdf 1H0707_0506200301_best_fit.ps
pdftocairo -png 1H0707_0506200301_best_fit.pdf
cp 1H0707_0506200301_best_fit-1.png /home/WWW/steff/ecm

#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200301_A_best_fit.png


**** Fixing logM

*Fix M to 6.03*


#+BEGIN_EXAMPLE
1H0707-0506200201-fit-error.sl
Submitted batch job 4010909

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.134464e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.03           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              2.9           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              220           0           0
 15  lag_freq(1).t_shift    0     1               70           0           0







Obsid 1H0707_0506200301
chi^2 = 1.359045e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.200000e+02 (+0.000000e+00 -1.510131e+02)
Parameter t_shift = 7.000000e+01 (+4.018062e+01 -2.500639e+01)


#+END_EXAMPLE


*Fix M to 6.1*


#+BEGIN_EXAMPLE
1H0707-0506200301-fit-error.sl
Submitted batch job 4012238

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.986861e-05           0       0.001
  2  lag_freq(1).log_mass   0     1              6.1           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              100           0           0
 15  lag_freq(1).t_shift    0     1               70           0           0

Obsid 1H0707_0506200301
chi^2 = 1.439554e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.000000e+02 (+0.000000e+00 -2.940377e+01)
Parameter t_shift = 7.000000e+01 (+3.069422e+01 -3.510573e+01)


#+END_EXAMPLE



*Fix M to 6.15*


#+BEGIN_EXAMPLE
Obsid 1H0707_0506200301
Submitted batch job 4016115

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     9.733422e-06           0       0.001
  2  lag_freq(1).log_mass   0     1             6.15           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               10           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                1           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              120           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0


Obsid 1H0707_0506200301
chi^2 = 1.414358e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.000000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.200000e+02 (+0.000000e+00 -4.540117e+01)
Parameter t_shift = 5.000000e+01 (+4.120726e+01 -4.994056e+01)




#+END_EXAMPLE

*** OBS 0506200301 isis emcee

PATH TO DATA = =/data/typhon1/reverb/1H0707-495/isis_emcee/=

Fit script = =1H0707-0506200301-fit-emcee.sl=

Fitting Parameter file =1H0707_0506200301_best_fit.par=

Fit obs 0506200201 to the best fit using the scripts outlined (above)

Make good image of the ECM Model fit

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0506200301_best_fit.ps/cps");
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
plot_comps(1,popt,&plot_data);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgsci(1); % make line colour black
_pgdraw(1,0);
close_plot(pid);
#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200301_best_fit-1.png

This model fit with χ²=1.35  and the parameters for this particular fit are:

+----------+----------------------+--------+--------+--------------+-----+-------+
| lag_freq |                      |        |        |              |     |       |
+----------+----------------------+--------+--------+--------------+-----+-------+
|      idx | param                | tie-to | freeze |        value | min |   max |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        1 | lag_freq(1).norm     |      0 |      0 | 3.043314e-05 |   0 | 0.001 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        2 | lag_freq(1).log_mass |      0 |      0 |            6 |   6 |   6.5 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        3 | lag_freq(1).i        |      0 |      1 |           53 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        4 | lag_freq(1).a        |      0 |      1 |        0.998 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        5 | lag_freq(1).h1       |      0 |      1 |            2 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        6 | lag_freq(1).h2       |      0 |      1 |            3 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        7 | lag_freq(1).Gamma1   |      0 |      1 |          2.5 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        8 | lag_freq(1).Gamma2   |      0 |      1 |          2.3 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        9 | lag_freq(1).Fe       |      0 |      1 |            1 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       10 | lag_freq(1).xi       |      0 |      1 |            3 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       11 | lag_freq(1).p        |      0 |      1 |            0 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       12 | lag_freq(1).b        |      0 |      1 |            3 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       13 | lag_freq(1).q2       |      0 |      1 |          0.5 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       14 | lag_freq(1).t_max    |      0 |      1 |          250 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       15 | lag_freq(1).t_shift  |      0 |      1 |           80 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+


*Lets Apply EMCEE to this model and use 500 Walkers with 5000 iterations in the chain*

#+BEGIN_EXAMPLE
isis

.source("1H0707-0506200301-fit-emcee.sl");

where

% Perform MCMC
emcee(500, 5000; output="1H0707_0110890301_chain_500_5000.fits", serial);

% Read the chain-file
(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("1H0707_0110890301_chain_500_5000.fits");
#+END_EXAMPLE


*Paths of the walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200301_walkers-1.png



*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200301_mass_accept_rate-1.png


Norm probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200301_norm_prob-1.png


Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200301_mass_prob-1.png

*Contours: paths in 2D*


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200301_chain_hist2d-1.png

*Chain statistics*


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200301_statistics-1.png


*Uncertainty estimation*

#+BEGIN_EXAMPLE
min(min_statistic[[s:]]); 1.3043014293904136

pmin; 5.708454132080078
pmax; 6.275014400482178

..............................

At 68% conf = conf_min; 5.912415828704834 , conf_max; 6.022895081043243,  conf_mean; 5.967655454874039


...................................

At 90% conf = conf_min; ,  conf_max; , conf_mean; 6

#+END_EXAMPLE

#+CAPTION: The 68 % confidence mass for 1H0707-495 OBS ID 0506200201 at $\pm ~logM_{\odot}$.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200301_logmass_conf68-1.png


#+CAPTION: The 90 % confidence mass for 1H0707-495 OBS ID 0506200201 at $\pm ~logM_{\odot}$
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200301_logmass_conf90.gif


*** OBS 0506200401 (2007)

Use script =/homeb/steff075/phd_ecm/1h0707/lagfreq_single_script.sl=

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0506200401_lagfreq.gif

*ECM Fitting*


#+BEGIN_EXAMPLE
1H0707-0506200401-fit-error.sl
Submitted batch job 3973830


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.4, 2.5, 2.6, 2.8, 2.9, 3.0, 3.1, 3.2]; % Gamma1
vals_to_fit[3] = [2.2, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9, 3.0, 3.1]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 150.0, 200.0, 220.0, 250.0, 280.0, 300.0, 350.0, 400.0, 420.0,  450.0, 480.0, 500.0, 540.0, 550.0, 600.0, 700.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [0.0, 10.0, 20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0, 105.0, 110.0, 120.0]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      9.20146e-06           0       0.001
  2  lag_freq(1).log_mass   0     0         6.126042           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              600           0           0
 15  lag_freq(1).t_shift    0     1              110           0           0


Obsid 1H0707_0506200401
chi^2 = 1.108698e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+8.468204e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 1.100000e+02 (+0.000000e+00 -0.000000e+00)

lag_freq(1).log_mass,6.126042e+00,+1.556264e-01,-1.963007e-01

........................................................................


###########################################################

Fit - A

Submitted batch job 4090604

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.497609e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.094888           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1              120           0           0


Obsid 1H0707_0506200401_A
chi^2 = 5.543405e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+2.672511e+01 -0.000000e+00)
Parameter Gamma1 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 1.200000e+02 (+0.000000e+00 -0.000000e+00)

ag_freq(1).log_mass,6.094888e+00,+6.792075e-02,-9.292543e-02
  Parameter 2 = 6.094888e+00 (6.001962e+00 - 6.162809e+00)


###########################################################
scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0506200401_best_fit.ps .

ps2pdf 1H0707_0506200401_best_fit.ps
pdftocairo -png 1H0707_0506200401_best_fit.pdf
cp 1H0707_0506200401_best_fit-1.png /home/WWW/steff/ecm

#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200401_A_best_fit.png

**** Fixing logM

*Fix M to 6.03*


#+BEGIN_EXAMPLE
1H0707-0506200401-fit-error.sl
Submitted batch job 4010910

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      6.58105e-06           0       0.001
  2  lag_freq(1).log_mass   0     1             6.03           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                1           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              600           0           0
 15  lag_freq(1).t_shift    0     1              120           0           0

Obsid 1H0707_0506200401
chi^2 = 1.599609e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.000000e+02 (+8.107410e+00 -4.131897e+02)
Parameter t_shift = 1.200000e+02 (+0.000000e+00 -4.189259e+00)




#+END_EXAMPLE



*Fix M to 6.1*


#+BEGIN_EXAMPLE
1H0707-0506200401-fit-error.sl
Submitted batch job 4012239


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      9.23284e-06           0       0.001
  2  lag_freq(1).log_mass   0     1              6.1           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              600           0           0
 15  lag_freq(1).t_shift    0     1              110           0           0

Obsid 1H0707_0506200401
chi^2 = 1.157823e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.000000e+02 (+7.898321e+00 -4.995389e+02)
Parameter t_shift = 1.100000e+02 (+7.898321e-01 -0.000000e+00)


#+END_EXAMPLE



*Fix M to 6.15*


#+BEGIN_EXAMPLE
Obsid 1H0707_0506200401
Submitted batch job 4016117


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     9.533691e-06           0       0.001
  2  lag_freq(1).log_mass   0     1             6.15           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              600           0           0
 15  lag_freq(1).t_shift    0     1              105           0           0

Obsid 1H0707_0506200401
chi^2 = 1.134025e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.000000e+02 (+7.887364e+00 -4.911630e+02)
Parameter t_shift = 1.050000e+02 (+5.788289e+00 -0.000000e+00)


#+END_EXAMPLE

*** OBS 0506200401 isis emcee

PATH TO DATA = =/data/typhon1/reverb/1H0707-495/isis_emcee/=

Fit script = =1H0707-0506200401-fit-emcee.sl=

Fitting Parameter file =1H0707_0506200401_best_fit.par=

Fit obs 0506200201 to the best fit using the scripts outlined (above)

Make good image of the ECM Model fit

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0506200401_best_fit.ps/cps");
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
plot_comps(1,popt,&plot_data);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgsci(1); % make line colour black
_pgdraw(1,0);
close_plot(pid);
#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200401_best_fit-1.png

This model fit with χ²=1.11  and the parameters for this particular fit are:

+----------+----------------------+--------+--------+-------------+-----+-------+
| lag_freq |                      |        |        |             |     |       |
+----------+----------------------+--------+--------+-------------+-----+-------+
|      idx | param                | tie-to | freeze |       value | min |   max |
+----------+----------------------+--------+--------+-------------+-----+-------+
|        1 | lag_freq(1).norm     |      0 |      0 | 9.20146e-06 |   0 | 0.001 |
+----------+----------------------+--------+--------+-------------+-----+-------+
|        2 | lag_freq(1).log_mass |      0 |      0 |    6.126042 |   6 |   6.5 |
+----------+----------------------+--------+--------+-------------+-----+-------+
|        3 | lag_freq(1).i        |      0 |      1 |          53 |   0 |     0 |
+----------+----------------------+--------+--------+-------------+-----+-------+
|        4 | lag_freq(1).a        |      0 |      1 |       0.998 |   0 |     0 |
+----------+----------------------+--------+--------+-------------+-----+-------+
|        5 | lag_freq(1).h1       |      0 |      1 |           2 |   0 |     0 |
+----------+----------------------+--------+--------+-------------+-----+-------+
|        6 | lag_freq(1).h2       |      0 |      1 |           3 |   0 |     0 |
+----------+----------------------+--------+--------+-------------+-----+-------+
|        7 | lag_freq(1).Gamma1   |      0 |      1 |         2.6 |   0 |     0 |
+----------+----------------------+--------+--------+-------------+-----+-------+
|        8 | lag_freq(1).Gamma2   |      0 |      1 |           2 |   0 |     0 |
+----------+----------------------+--------+--------+-------------+-----+-------+
|        9 | lag_freq(1).Fe       |      0 |      1 |           1 |   0 |     0 |
+----------+----------------------+--------+--------+-------------+-----+-------+
|       10 | lag_freq(1).xi       |      0 |      1 |           0 |   0 |     0 |
+----------+----------------------+--------+--------+-------------+-----+-------+
|       11 | lag_freq(1).p        |      0 |      1 |           0 |   0 |     0 |
+----------+----------------------+--------+--------+-------------+-----+-------+
|       12 | lag_freq(1).b        |      0 |      1 |           1 |   0 |     0 |
+----------+----------------------+--------+--------+-------------+-----+-------+
|       13 | lag_freq(1).q2       |      0 |      1 |         0.5 |   0 |     0 |
+----------+----------------------+--------+--------+-------------+-----+-------+
|       14 | lag_freq(1).t_max    |      0 |      1 |         600 |   0 |     0 |
+----------+----------------------+--------+--------+-------------+-----+-------+
|       15 | lag_freq(1).t_shift  |      0 |      1 |         110 |   0 |     0 |
+----------+----------------------+--------+--------+-------------+-----+-------+


*Lets Apply EMCEE to this model and use 500 Walkers with 5000 iterations in the chain*

#+BEGIN_EXAMPLE
isis

.source("1H0707-0506200401-fit-emcee.sl");

where

% Perform MCMC
emcee(500, 5000; output="1H0707_0110890401_chain_500_5000.fits", serial);

% Read the chain-file
(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("1H0707_0110890401_chain_500_5000.fits");
#+END_EXAMPLE


*Paths of the walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200401_walkers-1.png



*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200401_mass_accept_rate-1.png


Norm probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200401_norm_prob-1.png


Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200401_mass_prob-1.png

*Contours: paths in 2D*


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200401_chain_hist2d-1.png

*Chain statistics*


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200401_statistics-1.png


*Uncertainty estimation*

#+BEGIN_EXAMPLE
min(min_statistic[[s:]]); 1.1086987386439158

pmin; 5.33912992477417
pmax; 6.680459976196289

..............................

At 68% conf = conf_min; 5.956141748428345, conf_max; 6.284767611026764,  conf_mean; 6.120454679727555


...................................

At 90% conf = conf_min; ,  conf_max; , conf_mean;

#+END_EXAMPLE

#+CAPTION: The 68 % confidence mass for 1H0707-495 OBS ID 0506200401 at $6.120\pm0.164 ~logM_{\odot}$
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200401_logmass_conf68-1.png

#+CAPTION: The 90 % confidence mass for 1H0707-495 OBS ID 0506200401 at $\pm ~logM_{\odot}$
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200401_logmass_conf90.gif

*** OBS 0506200501 (2007)

Use script =/homeb/steff075/phd_ecm/1h0707/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
Freq,Lag,+-
1.163636e-04,6.464982e+02,2.386383e+02
2.221488e-04,7.559863e+01,8.574391e+01
4.241022e-04,-3.856400e+01,4.609986e+01
8.096496e-04,-1.533798e+00,2.518060e+01
1.545695e-03,2.658813e+00,2.010668e+01
2.950872e-03,-9.177687e+00,1.959578e+01
5.633482e-03,-2.257983e+01,2.311246e+01

#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0506200501_lag-freq.png

*ECM Fitting*


#+BEGIN_EXAMPLE
1H0707-0506200501-fit-error.sl
Submitted batch job 3973834

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.774244e-06           0       0.001
  2  lag_freq(1).log_mass   0     0         6.469103           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1              120           0           0

Obsid 1H0707_0506200501
chi^2 = 1.286018e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 3.000000e+00 (+7.296251e-02 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+8.336481e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+0.000000e+00 -2.905920e+02)
Parameter t_shift = 1.200000e+02 (+0.000000e+00 -0.000000e+00)

........................................................................

1H0707-0506200501-fit-error.sl
Submitted batch job 3974445

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      1.68761e-06           0       0.001
  2  lag_freq(1).log_mass   0     0         6.471828           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              350           0           0
 15  lag_freq(1).t_shift    0     1              120           0           0



Obsid 1H0707_0506200501
chi^2 = 1.267381e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 3.000000e+00 (+5.894929e-02 -0.000000e+00)
Parameter Gamma2 = 1.700000e+00 (+1.133216e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.500000e+02 (+0.000000e+00 -2.412132e+02)
Parameter t_shift = 1.200000e+02 (+0.000000e+00 -0.000000e+00)

lag_freq(1).log_mass,6.471828e+00,+6.148670e-02,-8.877457e-02

###########################################################

Fit -A

Obsid 1H0707_0506200501_A
chi^2 = 1.581447e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 3.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.700000e+00 (+0.000000e+00 --2.047082e+01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.000000e+02 (+0.000000e+00 -4.785462e+02)
Parameter t_shift = 0.000000e+00 (+1.202740e+02 -0.000000e+00)

.....................................

Submitted batch job 4092265


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.480734e-05           0       0.001
  2  lag_freq(1).log_mass   0     0          6.45162           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               13           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid 1H0707_0506200501_A
chi^2 = 1.312343e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.300000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+6.696571e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+0.000000e+00 -2.802405e+02)
Parameter t_shift = 2.000000e+01 (+0.000000e+00 -0.000000e+00)

.....................................................................

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.030306e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.463244           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               13           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid 1H0707_0506200501_A
chi^2 = 1.248540e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.300000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 2.000000e+01 (+0.000000e+00 -0.000000e+00)

lag_freq(1).log_mass,6.463244e+00,+2.135971e-02,-6.843029e-02
  Parameter 2 = 6.463244e+00 (6.394813e+00 - 6.484603e+00)


###########################################################
scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0506200501_best_fit.ps .

ps2pdf 1H0707_0506200501_best_fit.ps
pdftocairo -png 1H0707_0506200501_best_fit.pdf
cp 1H0707_0506200501_best_fit-1.png /home/WWW/steff/ecm

#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200501_A_best_fit.png

**** Fixing logM

*Fix M to 6.03*


#+BEGIN_EXAMPLE
1H0707-0506200501-fit-error.sl
Submitted batch job 4010911


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.441863e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.03           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                1           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              700           0           0
 15  lag_freq(1).t_shift    0     1                0           0           0

Obsid 1H0707_0506200501
chi^2 = 2.193658e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+4.737411e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 7.000000e+02 (+0.000000e+00 -2.537770e+02)
Parameter t_shift = 0.000000e+00 (+6.590838e+01 -0.000000e+00)


#+END_EXAMPLE




*Fix M to 6.1*


#+BEGIN_EXAMPLE
1H0707-0506200501-fit-error.sl
Submitted batch job 4012241


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.508214e-05           0       0.001
  2  lag_freq(1).log_mass   0     1              6.1           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              600           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0

Obsid 1H0707_0506200501
chi^2 = 2.231798e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.000000e+02 (+0.000000e+00 -2.257892e+02)
Parameter t_shift = 1.000000e+01 (+7.997380e+01 -0.000000e+00)


#+END_EXAMPLE



*Fix M to 6.15*


#+BEGIN_EXAMPLE
Obsid 1H0707_0506200501
Submitted batch job 4016118

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.808991e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.15           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              600           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0







File Edit Options Buffers Tools Help
Obsid 1H0707_0506200501
chi^2 = 2.149720e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.000000e+02 (+0.000000e+00 -2.986860e+02)
Parameter t_shift = 1.000000e+01 (+0.000000e+00 -0.000000e+00)


#+END_EXAMPLE

*** OBS 0506200501 isis emcee

PATH TO DATA = =/data/typhon1/reverb/1H0707-495/isis_emcee/=

Fit script = =1H0707-0506200501-fit-emcee.sl=

Fitting Parameter file =1H0707_0506200501_best_fit.par=

Make good image of the ECM Model fit

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0506200501_best_fit.ps/cps");
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
plot_comps(1,popt,&plot_data);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgsci(1); % make line colour black
_pgdraw(1,0);
close_plot(pid);
#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200401_best_fit-1.png

This model fit with χ²=1.27  and the parameters for this particular fit are:

+----------+----------------------+--------+--------+-------------+-----+-------+
| lag_freq |                      |        |        |             |     |       |
+----------+----------------------+--------+--------+-------------+-----+-------+
|      idx | param                | tie-to | freeze |       value | min |   max |
+----------+----------------------+--------+--------+-------------+-----+-------+
|        1 | lag_freq(1).norm     |      0 |      0 | 1.68761e-06 |   0 | 0.001 |
+----------+----------------------+--------+--------+-------------+-----+-------+
|        2 | lag_freq(1).log_mass |      0 |      0 |    6.471828 |   6 |   6.5 |
+----------+----------------------+--------+--------+-------------+-----+-------+
|        3 | lag_freq(1).i        |      0 |      1 |          53 |   0 |     0 |
+----------+----------------------+--------+--------+-------------+-----+-------+
|        4 | lag_freq(1).a        |      0 |      1 |       0.998 |   0 |     0 |
+----------+----------------------+--------+--------+-------------+-----+-------+
|        5 | lag_freq(1).h1       |      0 |      1 |           2 |   0 |     0 |
+----------+----------------------+--------+--------+-------------+-----+-------+
|        6 | lag_freq(1).h2       |      0 |      1 |           3 |   0 |     0 |
+----------+----------------------+--------+--------+-------------+-----+-------+
|        7 | lag_freq(1).Gamma1   |      0 |      1 |           3 |   0 |     0 |
+----------+----------------------+--------+--------+-------------+-----+-------+
|        8 | lag_freq(1).Gamma2   |      0 |      1 |         1.7 |   0 |     0 |
+----------+----------------------+--------+--------+-------------+-----+-------+
|        9 | lag_freq(1).Fe       |      0 |      1 |           1 |   0 |     0 |
+----------+----------------------+--------+--------+-------------+-----+-------+
|       10 | lag_freq(1).xi       |      0 |      1 |           3 |   0 |     0 |
+----------+----------------------+--------+--------+-------------+-----+-------+
|       11 | lag_freq(1).p        |      0 |      1 |           0 |   0 |     0 |
+----------+----------------------+--------+--------+-------------+-----+-------+
|       12 | lag_freq(1).b        |      0 |      1 |           2 |   0 |     0 |
+----------+----------------------+--------+--------+-------------+-----+-------+
|       13 | lag_freq(1).q2       |      0 |      1 |         0.5 |   0 |     0 |
+----------+----------------------+--------+--------+-------------+-----+-------+
|       14 | lag_freq(1).t_max    |      0 |      1 |         350 |   0 |     0 |
+----------+----------------------+--------+--------+-------------+-----+-------+
|       15 | lag_freq(1).t_shift  |      0 |      1 |         120 |   0 |     0 |
+----------+----------------------+--------+--------+-------------+-----+-------+


*Lets Apply EMCEE to this model and use 500 Walkers with 5000 iterations in the chain*

#+BEGIN_EXAMPLE
isis

.source("1H0707-0506200501-fit-emcee.sl");

where

% Perform MCMC
emcee(500, 5000; output="1H0707_0110890501_chain_500_5000.fits", serial);

% Read the chain-file
(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("1H0707_0110890501_chain_500_5000.fits");
#+END_EXAMPLE


*Paths of the walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200501_walkers-1.png



*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200501_mass_accept_rate-1.png


Norm probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200501_norm_prob-1.png


Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200501_mass_prob-1.png

*Contours: paths in 2D*


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200501_chain_hist2d-1.png

*Chain statistics*


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200501_statistics-1.png


*Uncertainty estimation*

#+BEGIN_EXAMPLE
min(min_statistic[[s:]]); 1.267381951580101

pmin;
pmax;

isis> pmin;
6.29780912399292
isis> pmax;
6.69590425491333

..............................
isis> conf_min;
6.417237663269043
isis> conf_max;
6.514770970344544
isis> conf_mean;
6.466004316806794
isis>



At 68% conf
isis> conf_min;
6.417237663269043
isis> conf_max;
6.514770970344544
isis> conf_mean;
6.466004316806794
isis> conf_mean - conf_min;
0.04876665353775067
isis>

...................................

At 90% conf = conf_min;,  conf_max; 6, conf_mean;

#+END_EXAMPLE

#+CAPTION: The 68 % confidence mass for 1H0707-495 OBS ID 0506200501 at $6.466\pm0.0487~logM_{\odot}$
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200501_logmass_conf68-1.png

#+CAPTION: The 90 % confidence mass for 1H0707-495 OBS ID 0506200501 at $\pm ~logM_{\odot}$
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200501_logmass_conf90.gif

*** OBS 0511580101 (2008)

Use script =/homeb/steff075/phd_ecm/1h0707/lagfreq_single_script.sl=


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0511580101_lagfreq.gif

*ECM Fitting*


#+BEGIN_EXAMPLE

1H0707-0511580101-fit-error.sl
Submitted batch job 3973838

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.847017e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.249992           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Obsid 1H0707_0511580101
chi^2 = 2.436157e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.500000e+02 (+4.347296e+02 -7.244660e+01)
Parameter t_shift = 2.000000e+01 (+9.913021e+01 -0.000000e+00)

lag_freq(1).log_mass,6.249992e+00,+4.327736e-02,-6.134562e-02


........................................................................
#####################################################################


Fit - A

Submitted batch job 4091944


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.833204e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         5.895054           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               16           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              550           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0


Obsid 1H0707_0511580101_A
chi^2 = 2.751007e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.600000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.500000e+02 (+0.000000e+00 -3.144054e+02)
Parameter t_shift = 1.000000e+01 (+1.103258e+02 -0.000000e+00)

lag_freq(1).log_mass,5.895054e+00,+2.588629e-02,-2.867923e-02
  Parameter 2 = 5.895054e+00 (5.866374e+00 - 5.920940e+00)




###############################################
Copy fit to Lyra and WWW:

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0511580101_best_fit.ps .

ps2pdf 1H0707_0511580101_best_fit.ps
pdftocairo -png 1H0707_0511580101_best_fit.pdf
cp 1H0707_0511580101_best_fit-1.png /home/WWW/steff/ecm

#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580101_A_best_fit.png

**** Fixing logM

*Fix M to 6.03*


#+BEGIN_EXAMPLE
1H0707-0511580101-fit-error.sl
Submitted batch job 4015601

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     6.503375e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.03           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                7           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Obsid 1H0707_0511580101
chi^2 = 2.951180e-01 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 7.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+2.448454e+02 -1.246221e+02)
Parameter t_shift = 2.000000e+01 (+9.008089e+01 -0.000000e+00)



#+END_EXAMPLE


*Fix M to 6.1*


#+BEGIN_EXAMPLE
1H0707-0511580101-fit-error.sl
Submitted batch job 4014273

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     7.188135e-05           0       0.001
  2  lag_freq(1).log_mass   0     1              6.1           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              350           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0




Obsid 1H0707_0511580101
chi^2 = 5.048580e-01 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.500000e+02 (+2.224885e+02 -1.428150e+02)
Parameter t_shift = 2.000000e+01 (+7.828605e+01 -0.000000e+00)

#+END_EXAMPLE



*Fix M to 6.15*


#+BEGIN_EXAMPLE
Obsid 1H0707_0511580101
Submitted batch job 4016120

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     6.614663e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.15           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               15           0           0

Obsid 1H0707_0511580101
chi^2 = 4.538171e-01 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+2.016729e+02 -8.346762e+01)
Parameter t_shift = 1.500000e+01 (+7.203333e+01 -0.000000e+00)

#+END_EXAMPLE

*** OBS 0511580101 isis emcee

PATH TO DATA = =/data/typhon1/reverb/1H0707-495/isis_emcee/=

Fit script = =1H0707-0511580101-fit-emcee.sl=

Fitting Parameter file =1H0707_0511580101_best_fit.par=

Make good image of the ECM Model fit

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0511580101_best_fit.ps/cps");
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
plot_comps(1,popt,&plot_data);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgsci(1); % make line colour black
_pgdraw(1,0);
close_plot(pid);
#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580101_best_fit-1.png

This model fit with χ²=0.24  and the parameters for this particular fit are:

+----------+----------------------+--------+--------+--------------+-----+-------+
| lag_freq |                      |        |        |              |     |       |
+----------+----------------------+--------+--------+--------------+-----+-------+
|      idx | param                | tie-to | freeze |        value | min |   max |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        1 | lag_freq(1).norm     |      0 |      0 | 5.847017e-05 |   0 | 0.001 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        2 | lag_freq(1).log_mass |      0 |      0 |     6.249992 |   6 |   6.5 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        3 | lag_freq(1).i        |      0 |      1 |           53 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        4 | lag_freq(1).a        |      0 |      1 |        0.998 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        5 | lag_freq(1).h1       |      0 |      1 |            2 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        6 | lag_freq(1).h2       |      0 |      1 |            6 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        7 | lag_freq(1).Gamma1   |      0 |      1 |          2.6 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        8 | lag_freq(1).Gamma2   |      0 |      1 |          2.2 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        9 | lag_freq(1).Fe       |      0 |      1 |            1 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       10 | lag_freq(1).xi       |      0 |      1 |            0 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       11 | lag_freq(1).p        |      0 |      1 |            0 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       12 | lag_freq(1).b        |      0 |      1 |            2 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       13 | lag_freq(1).q2       |      0 |      1 |          0.5 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       14 | lag_freq(1).t_max    |      0 |      1 |          250 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       15 | lag_freq(1).t_shift  |      0 |      1 |           20 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+


*Lets Apply EMCEE to this model and use 500 Walkers with 5000 iterations in the chain*

#+BEGIN_EXAMPLE
isis

.source("1H0707-0511580101-fit-emcee.sl");

where

% Perform MCMC
emcee(500, 5000; output="1H0707_0511580101_chain_500_5000.fits", serial);

% Read the chain-file
(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("1H0707_0511580101_chain_500_5000.fits");
#+END_EXAMPLE


*Paths of the walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580101_walkers-1.png



*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580101_mass_accept_rate-1.png


Norm probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580101_norm_prob-1.png


Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580101_mass_prob-1.png

*Contours: paths in 2D*


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580101_chain_hist2d-1.png

*Chain statistics*


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580101_statistics-1.png


*Uncertainty estimation*

#+BEGIN_EXAMPLE
min(min_statistic[[s:]]); 0.24361592725043826


pmin;
pmax;

isis> pmin;
6.010861396789551
isis> pmax;
6.456834316253662

..............................

At 68% conf
isis> pmax;
6.456834316253662
isis> conf_min;
6.200399887561798
isis> conf_max;
6.285134742259979
isis> conf_mean;
6.242767314910889
isis> 6.466004316806794
isis> conf_mean - conf_min;
0.042367427349090825

...................................

At 90% conf = conf_min;,  conf_max; 6, conf_mean;

#+END_EXAMPLE

#+CAPTION: The 68 % confidence mass for 1H0707-495 OBS ID 0511580101 at $6.242\pm0.04~logM_{\odot}$
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580101_logmass_conf68-1.png

#+CAPTION: The 90 % confidence mass for 1H0707-495 OBS ID 0511580101 at $\pm ~logM_{\odot}$
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580101_logmass_conf90.gif

*** OBS 0511580201 (2008)

Use script =/homeb/steff075/phd_ecm/1h0707/lagfreq_single_script.sl=


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0511580201_lagfreq.gif

*ECM Fitting*

#+BEGIN_EXAMPLE
1H0707-0511580201-fit-error.sl
Submitted batch job 3973843

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.620368e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.397703           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                8           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                1           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              150           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0

Obsid 1H0707_0511580201
chi^2 = 1.253350e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 8.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+2.833597e-01 -4.038781e-01)
Parameter Gamma2 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.500000e+02 (+3.134174e+02 -0.000000e+00)
Parameter t_shift = 3.000000e+01 (+6.462658e+01 -2.731148e+01)

lag_freq(1).log_mass,6.397703e+00,+5.726708e-02,-1.005730e-01

........................................................................

#####################################################################


Fit - A


Submitted batch job 4091945


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.083867e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.263942           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               19           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0


Obsid 1H0707_0511580201_A
chi^2 = 2.615454e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.900000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 3.000000e+01 (+9.013741e+01 -0.000000e+00)

lag_freq(1).log_mass,6.263942e+00,+5.212072e-02,-8.150736e-02
  Parameter 2 = 6.263942e+00 (6.182434e+00 - 6.316062e+00)


###############################################
Copy fit to Lyra and WWW:

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0511580201_best_fit.ps .

ps2pdf 1H0707_0511580201_best_fit.ps
pdftocairo -png 1H0707_0511580201_best_fit.pdf
cp 1H0707_0511580201_best_fit-1.png /home/WWW/steff/ecm

#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580201_best_fit-1.png

**** Fixing logM

*Fix M to 6.03*


#+BEGIN_EXAMPLE
1H0707-0511580201-fit-error.sl
Submitted batch job 4010915

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.457682e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.03           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               10           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              150           0           0
 15  lag_freq(1).t_shift    0     1               90           0           0



Obsid 1H0707_0511580201
chi^2 = 2.860957e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.000000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.108398e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.500000e+02 (+9.344356e+01 -2.899072e+01)
Parameter t_shift = 9.000000e+01 (+1.062997e+01 -2.618265e+01)



#+END_EXAMPLE



*Fix M to 6.1*


#+BEGIN_EXAMPLE
1H0707-0511580201-fit-error.sl
Submitted batch job 4012243


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.767843e-05           0       0.001
  2  lag_freq(1).log_mass   0     1              6.1           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               10           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              150           0           0
 15  lag_freq(1).t_shift    0     1               70           0           0

bsid 1H0707_0511580201
chi^2 = 2.868829e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.000000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.219651e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.500000e+02 (+5.961353e+01 -0.000000e+00)
Parameter t_shift = 7.000000e+01 (+2.285127e+01 -1.138839e+00)


#+END_EXAMPLE


*Fix M to 6.15*


#+BEGIN_EXAMPLE
Obsid 1H0707_0511580201
Submitted batch job 4016123

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.541475e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.15           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               10           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              100           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0

Obsid 1H0707_0511580201
chi^2 = 2.914517e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.000000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.000000e+02 (+1.073003e+02 -0.000000e+00)
Parameter t_shift = 8.000000e+01 (+1.189109e+01 -3.165655e+01)


#+END_EXAMPLE

*** OBS 0511580201 isis emcee

PATH TO DATA = =/data/typhon1/reverb/1H0707-495/isis_emcee/=

Fit script = =1H0707-0511580201-fit-emcee.sl=

Fitting Parameter file =1H0707_0511580201_best_fit.par=

Make good image of the ECM Model fit

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0511580201_best_fit.ps/cps");
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
plot_comps(1,popt,&plot_data);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgsci(1); % make line colour black
_pgdraw(1,0);
close_plot(pid);
#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580201_best_fit-1.png

This model fit with χ²=1.25  and the parameters for this particular fit are:

+----------+----------------------+--------+--------+--------------+-----+-------+
| lag_freq |                      |        |        |              |     |       |
+----------+----------------------+--------+--------+--------------+-----+-------+
|      idx | param                | tie-to | freeze |        value | min |   max |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        1 | lag_freq(1).norm     |      0 |      0 | 1.620368e-05 |   0 | 0.001 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        2 | lag_freq(1).log_mass |      0 |      0 |     6.397703 |   6 |   6.5 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        3 | lag_freq(1).i        |      0 |      1 |           53 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        4 | lag_freq(1).a        |      0 |      1 |        0.998 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        5 | lag_freq(1).h1       |      0 |      1 |            2 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        6 | lag_freq(1).h2       |      0 |      1 |            8 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        7 | lag_freq(1).Gamma1   |      0 |      1 |          2.8 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        8 | lag_freq(1).Gamma2   |      0 |      1 |            2 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        9 | lag_freq(1).Fe       |      0 |      1 |            1 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       10 | lag_freq(1).xi       |      0 |      1 |            1 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       11 | lag_freq(1).p        |      0 |      1 |            0 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       12 | lag_freq(1).b        |      0 |      1 |            1 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       13 | lag_freq(1).q2       |      0 |      1 |          0.5 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       14 | lag_freq(1).t_max    |      0 |      1 |          150 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       15 | lag_freq(1).t_shift  |      0 |      1 |           30 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+

*Lets Apply EMCEE to this model and use 500 Walkers with 5000 iterations in the chain*

#+BEGIN_EXAMPLE
isis

.source("1H0707-0511580201-fit-emcee.sl");

where

% Perform MCMC
emcee(500, 5000; output="1H0707_0511580201_chain_500_5000.fits", serial);

% Read the chain-file
(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("1H0707_0511580201_chain_500_5000.fits");
#+END_EXAMPLE


*Paths of the walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580201_walkers-1.png



*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580201_mass_accept_rate-1.png


Norm probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580201_norm_prob-1.png


Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580201_mass_prob-1.png

*Contours: paths in 2D*


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580201_chain_hist2d-1.png

*Chain statistics*


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580201_statistics-1.png


*Uncertainty estimation*

#+BEGIN_EXAMPLE
min(min_statistic[[s:]]);
1.253343498172209


pmin;
pmax;

isis> pmin;
6.172215461730957
isis> pmax;
6.535646915435791


..............................

At 68% conf


...................................

At 90% conf = conf_min;  conf_max;  conf_mean;

#+END_EXAMPLE

#+CAPTION: The 68 % confidence mass for 1H0707-495 OBS ID 0511580201 at $\pm~logM_{\odot}$
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580201_logmass_conf68-1.png

#+CAPTION: The 90 % confidence mass for 1H0707-495 OBS ID 0511580101 at $\pm ~logM_{\odot}$
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580201_logmass_conf90.gif

*** OBS 0511580301 (2008)

Use script =/homeb/steff075/phd_ecm/1h0707/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
Freq,Lag,+-
1.163636e-04,3.636364e-05,2.051130e+01,1.466107e+02
2.221488e-04,6.942149e-05,3.731227e+02,6.582149e+01
4.241022e-04,1.325319e-04,-9.148262e+00,3.182743e+01
8.096496e-04,2.530155e-04,2.179021e+01,2.199061e+01
1.545695e-03,4.830296e-04,-3.129066e+01,9.283084e+00
2.950872e-03,9.221474e-04,-9.826425e+00,5.006751e+00
5.633482e-03,1.760463e-03,-1.871316e+00,2.223872e+00
#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0511580301_lag-freq.png

*ECM Fitting*

#+BEGIN_EXAMPLE
1H0707-0511580301-fit-error.sl
Submitted batch job 3973850

ag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     7.627938e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.182876           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               10           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0


Obsid 1H0707_0511580301
chi^2 = 3.430280e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.000000e+01 (+0.000000e+00 -2.819449e+00)
Parameter Gamma1 = 3.000000e+00 (+2.401283e-02 -4.330034e-01)
Parameter Gamma2 = 2.700000e+00 (+5.910265e-02 -2.175457e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -2.034354e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -2.061901e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+1.163473e+01 -2.512439e+01)
Parameter t_shift = 3.000000e+01 (+7.044915e+00 -1.860568e+01)


lag_freq(1).log_mass,6.182876e+00,+1.901788e-02,-2.111190e-02

................................................................

no better fit found - see below - run higher H2....

###############################################
Copy fit to Lyra and WWW:

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0511580301_best_fit.ps .

ps2pdf 1H0707_0511580301_best_fit.ps
pdftocairo -png 1H0707_0511580301_best_fit.pdf
cp 1H0707_0511580301_best_fit-1.png /home/WWW/steff/ecm

#+END_EXAMPLE

Improve fit - Increase H2

#+BEGIN_EXAMPLE
1H0707-0511580301-fit-error.sl
Submitted batch job 3988070

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.8, 2.9, 3.0, 3.1, 3.2, 3.3]; % Gamma1
vals_to_fit[3] = [2.6, 2.7, 2.8, 2.9, 3.0]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 150.0, 200.0, 220.0, 250.0, 280.0, 300.0, 350.0, 360.0, 380.0, 400.0, 420.0, 440.0, 450.0, 4\
60.0, 480.0, 500.0, 540.0, 550.0, 600.0, 700.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [0.0, 10.0, 20.0, 25.0, 30.0, 35.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0, 105.0, 110.0, 120.0]\
; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     7.627938e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.182876           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               10           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0


Obsid 1H0707_0511580301
chi^2 = 3.430280e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.000000e+01 (+0.000000e+00 -1.107743e+00)
Parameter Gamma1 = 3.000000e+00 (+0.000000e+00 -1.399073e-01)
Parameter Gamma2 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -2.280138e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.463278e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+3.561137e+01 -7.111190e+00)
Parameter t_shift = 3.000000e+01 (+5.810567e+00 -1.170675e+00)

No improvement found!


RUN HIGHER H2 - submit-blob-delta-2.pl for h2 = 13

(74 scripts at batch size = 6000)

started 13 Nov 20
cd ..


.......................................................................................

#############################################################
########     And also the ABS lags
#############################################################

Submitted batch job 4040865

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      7.95844e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.164795           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               12           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              350           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0

Obsid 1H0707_0511580301_A
chi^2 = 3.151890e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.300000e+01 (+0.000000e+00 -6.296036e-01)
Parameter Gamma1 = 2.900000e+00 (+3.576559e-02 -4.199845e-02)
Parameter Gamma2 = 2.400000e+00 (+3.564485e-02 -8.399689e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -4.631908e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -4.761784e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+2.065112e+01 -1.464604e+01)
Parameter t_shift = 2.000000e+01 (+1.328450e+00 -7.016433e+00)

...............................................................

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     8.968847e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.236177           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               13           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Obsid 1H0707_0511580301_A
chi^2 = 2.754776e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.300000e+01 (+0.000000e+00 -6.486992e-01)
Parameter Gamma1 = 2.600000e+00 (+5.729119e-01 -1.881366e-01)
Parameter Gamma2 = 2.100000e+00 (+9.684450e-02 -1.466785e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -5.135714e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+2.542955e+01 -1.484842e+01)
Parameter t_shift = 2.000000e+01 (+1.278596e+00 -7.141588e+00)

...................................................................

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.159426e-05           0       0.001
  2  lag_freq(1).log_mass   0     0          6.32283           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               16           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid 1H0707_0511580301_A
chi^2 = 9.456217e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.600000e+01 (+0.000000e+00 -3.883569e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -3.877714e-01)
Parameter Gamma2 = 2.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -6.329429e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.500000e+02 (+6.592136e+00 -2.310952e+01)
Parameter t_shift = 2.000000e+01 (+1.091915e+00 -7.600202e+00)

lag_freq(1).log_mass,6.322830e+00,+3.361650e-02,-2.201713e-02
  Parameter 2 = 6.322830e+00 (6.300813e+00 - 6.356446e+00)



Run again = Submitted batch job 4091946
--- Same reslults as above --




#+END_EXAMPLE



#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580301_A_best_fit-1.png

**** Fixing logM


*Fix M to 6.03*

#+BEGIN_EXAMPLE


1H0707-0511580301-fit-error.sl
Submitted batch job 4010917

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     7.112094e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.03           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                8           0           0
  7  lag_freq(1).Gamma1     0     1              2.9           0           0
  8  lag_freq(1).Gamma2     0     1              2.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              600           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0

Obsid 1H0707_0511580301
chi^2 = 7.675638e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 8.000000e+00 (+0.000000e+00 -3.127281e+00)
Parameter Gamma1 = 2.900000e+00 (+2.906934e-01 -1.887001e-01)
Parameter Gamma2 = 2.700000e+00 (+0.000000e+00 -1.207650e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.158407e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.000000e+02 (+3.113456e+01 -1.474613e+02)
Parameter t_shift = 5.000000e+01 (+9.417051e+00 -1.426818e+01)
#+END_EXAMPLE

*Fix M to 6.1*

#+BEGIN_EXAMPLE
1H0707-0511580301-fit-error.sl
Submitted batch job 4012244

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     6.785186e-05           0       0.001
  2  lag_freq(1).log_mass   0     1              6.1           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               10           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               35           0           0

Obsid 1H0707_0511580301
chi^2 = 7.467253e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.000000e+01 (+0.000000e+00 -1.034874e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.500000e+00 (+0.000000e+00 -2.500432e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -3.039755e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+1.293540e+02 -8.057318e+00)
Parameter t_shift = 3.500000e+01 (+1.538035e+01 -1.184192e+01)
#+END_EXAMPLE

*Fix M to 6.15*

#+BEGIN_EXAMPLE
Obsid 1H0707_0511580301
Submitted batch job 4016126

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     6.743874e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.15           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                9           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               35           0           0

Obsid 1H0707_0511580301
chi^2 = 5.946836e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 9.000000e+00 (+0.000000e+00 -1.001680e+00)
Parameter Gamma1 = 3.000000e+00 (+1.719532e-01 -2.265813e-01)
Parameter Gamma2 = 2.700000e+00 (+0.000000e+00 -2.358050e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.686073e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+6.250759e+01 -4.497595e+00)
Parameter t_shift = 3.500000e+01 (+7.867084e+00 -7.251401e+00)
#+END_EXAMPLE

*** OBS 0511580301 isis emcee

PATH TO DATA = =/data/typhon1/reverb/1H0707-495/isis_emcee/=

Fit script = =1H0707-0511580301-fit-emcee.sl=

Fitting Parameter file =1H0707_0511580201_best_fit.par=

Make good image of the ECM Model fit

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0511580301_best_fit.ps/cps");
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
plot_comps(1,popt,&plot_data);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgsci(1); % make line colour black
_pgdraw(1,0);
close_plot(pid);
#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580301_A_best_fit-1.png


This model fit with χ²=0.95  and the parameters for this particular fit are:

+----------+----------------------+--------+--------+--------------+-----+-------+
| lag_freq |                      |        |        |              |     |       |
+----------+----------------------+--------+--------+--------------+-----+-------+
|      idx | param                | tie-to | freeze |        value | min |   max |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        1 | lag_freq(1).norm     |      0 |      0 | 5.159426e-05 |   0 | 0.001 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        2 | lag_freq(1).log_mass |      0 |      0 |      6.32283 |   5 |     7 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        3 | lag_freq(1).i        |      0 |      1 |           53 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        4 | lag_freq(1).a        |      0 |      1 |        0.998 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        5 | lag_freq(1).h1       |      0 |      1 |            2 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        6 | lag_freq(1).h2       |      0 |      1 |           16 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        7 | lag_freq(1).Gamma1   |      0 |      1 |          2.8 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        8 | lag_freq(1).Gamma2   |      0 |      1 |          2.1 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        9 | lag_freq(1).Fe       |      0 |      1 |            1 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       10 | lag_freq(1).xi       |      0 |      1 |            3 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       11 | lag_freq(1).p        |      0 |      1 |            0 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       12 | lag_freq(1).b        |      0 |      1 |            3 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       13 | lag_freq(1).q2       |      0 |      1 |          0.5 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       14 | lag_freq(1).t_max    |      0 |      1 |          250 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       15 | lag_freq(1).t_shift  |      0 |      1 |           20 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+


*Lets Apply EMCEE to this model and use 500 Walkers with 5000 iterations in the chain*

#+BEGIN_EXAMPLE
isis

.source("1H0707-0511580301-fit-emcee.sl");

where

% Perform MCMC
emcee(500, 5000; output="1H0707_0511580301_chain_500_5000.fits", serial);

% Read the chain-file
(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("1H0707_0511580301_chain_500_5000.fits");

#+END_EXAMPLE


*Paths of the walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580301_walkers-1.png


*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580301_mass_accept_rate-1.png

Norm probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580301_norm_prob-1.png

Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580301_mass_prob-1.png

*Contours: paths in 2D*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580301_chain_hist2d-1.png

*Chain statistics*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580301_statistics-1.png


*Uncertainty estimation*

#+BEGIN_EXAMPLE
min(min_statistic[[s:]]);
0.9456226077309412

pmin;
pmax;

isis> pmin;
6.262449264526367
isis> pmax;
6.500744819641113

.............................

At 68% conf

isis> conf_min;
6.310411462783813
isis> conf_max;
6.339775035381317
isis> conf_mean;
6.325093249082565

...................................

At 90% conf = conf_min;  conf_max;  conf_mean;

#+END_EXAMPLE

#+CAPTION: The 68 % confidence mass for 1H0707-495 OBS ID 0511580301 at $6.325\pm0.0147~logM_{\odot}$
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580301_logmass_conf68-1.png

#+CAPTION: The 90 % confidence mass for 1H0707-495 OBS ID 0511580101 at $\pm ~logM_{\odot}$
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580301_logmass_conf90.gif

*** OBS 0511580401 (2008)

Use script =/homeb/steff075/phd_ecm/1h0707/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
Freq,Lag,+-
1.163636e-04,8.807623e+01,1.602297e+02
2.221488e-04,1.863844e+02,8.255149e+01
4.241022e-04,1.557953e+02,3.843947e+01
8.096496e-04,-6.019749e+01,2.399668e+01
1.545695e-03,-4.388871e+01,1.971752e+01
2.950872e-03,-6.167873e+00,9.407324e+00
5.633482e-03,-4.517172e+00,1.076603e+01


#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0511580401_lag-freq.png

*ECM Fitting*

#+BEGIN_EXAMPLE
1H0707-0511580401-fit-error.sl
Submitted batch job 3973851

ag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.370748e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.399108           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0


Obsid 1H0707_0511580401
chi^2 = 6.636144e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 5.000000e+01 (+0.000000e+00 -4.775975e+01)

lag_freq(1).log_mass,6.399108e+00,+5.350087e-02,-2.419227e-02

..............................................................

1H0707-0511580401-fit-error.sl
Submitted batch job 3974453

no better fit found

#######################################################

Copy to Lyra and WWW

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0511580401_best_fit.ps .

ps2pdf 1H0707_0511580401_best_fit.ps
pdftocairo -png 1H0707_0511580401_best_fit.pdf
cp 1H0707_0511580401_best_fit-1.png /home/WWW/steff/ecm

#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580401_best_fit-1.png


*Fix M to 6.03*


#+BEGIN_EXAMPLE
1H0707-0511580401-fit-error.sl
Submitted batch job 4010919


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.500529e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.03           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              420           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0

Obsid 1H0707_0511580401
chi^2 = 8.447789e-01 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -3.854209e-01)
Parameter Gamma2 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.200000e+02 (+0.000000e+00 -3.152226e+02)
Parameter t_shift = 8.000000e+01 (+0.000000e+00 -5.955428e+00)



#+END_EXAMPLE


*Fix M to 6.1*


#+BEGIN_EXAMPLE
1H0707-0511580401-fit-error.sl
Submitted batch job 4012245

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.665455e-05           0       0.001
  2  lag_freq(1).log_mass   0     1              6.1           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              350           0           0
 15  lag_freq(1).t_shift    0     1               70           0           0

Obsid 1H0707_0511580401
chi^2 = 9.230434e-01 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.500000e+00 (+0.000000e+00 -2.834178e-01)
Parameter Gamma2 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.500000e+02 (+3.369851e+02 -2.189534e+02)
Parameter t_shift = 7.000000e+01 (+0.000000e+00 -5.421442e+00)



#+END_EXAMPLE

*Fix M to 6.15*


#+BEGIN_EXAMPLE
Obsid 1H0707_0511580401
Submitted batch job 4016128

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.790843e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.15           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               10           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               70           0           0

Obsid 1H0707_0511580401
chi^2 = 9.339651e-01 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.000000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.500000e+02 (+4.217016e+02 -0.000000e+00)
Parameter t_shift = 7.000000e+01 (+0.000000e+00 -1.339556e+01)


#+END_EXAMPLE

*** OBS 0511580401 isis emcee

PATH TO DATA = =/data/typhon1/reverb/1H0707-495/isis_emcee/=

Fit script = =1H0707-0511580401-fit-emcee.sl=

Fitting Parameter file =1H0707_0511580401_best_fit.par=

Make good image of the ECM Model fit

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0511580401_best_fit.ps/cps");
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
plot_comps(1,popt,&plot_data);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgsci(1); % make line colour black
_pgdraw(1,0);
close_plot(pid);
#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580401_best_fit-1.png


This model fit with χ²=0.66  and the parameters for this particular fit are:

+----------+----------------------+--------+--------+--------------+-----+-------+
| lag_freq |                      |        |        |              |     |       |
+----------+----------------------+--------+--------+--------------+-----+-------+
|      idx | param                | tie-to | freeze |        value | min |   max |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        1 | lag_freq(1).norm     |      0 |      0 | 3.370748e-05 |   0 | 0.001 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        2 | lag_freq(1).log_mass |      0 |      0 |     6.399108 |   6 |   6.5 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        3 | lag_freq(1).i        |      0 |      1 |           53 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        4 | lag_freq(1).a        |      0 |      1 |        0.998 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        5 | lag_freq(1).h1       |      0 |      1 |            2 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        6 | lag_freq(1).h2       |      0 |      1 |            3 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        7 | lag_freq(1).Gamma1   |      0 |      1 |          2.6 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        8 | lag_freq(1).Gamma2   |      0 |      1 |          2.4 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        9 | lag_freq(1).Fe       |      0 |      1 |            1 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       10 | lag_freq(1).xi       |      0 |      1 |            0 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       11 | lag_freq(1).p        |      0 |      1 |            0 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       12 | lag_freq(1).b        |      0 |      1 |            3 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       13 | lag_freq(1).q2       |      0 |      1 |          0.5 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       14 | lag_freq(1).t_max    |      0 |      1 |          300 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       15 | lag_freq(1).t_shift  |      0 |      1 |           50 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+


*Lets Apply EMCEE to this model and use 500 Walkers with 5000 iterations in the chain*

#+BEGIN_EXAMPLE
isis

.source("1H0707-0511580401-fit-emcee.sl");

where

% Perform MCMC
emcee(500, 5000; output="1H0707_0511580401_chain_500_5000.fits", serial);

% Read the chain-file
(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("1H0707_0511580401_chain_500_5000.fits");

#+END_EXAMPLE


*Paths of the walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580401_walkers-1.png


*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580401_mass_accept_rate-1.png

Norm probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580401_norm_prob-1.png

Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580401_mass_prob-1.png

*Contours: paths in 2D*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580401_chain_hist2d-1.png

*Chain statistics*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580401_statistics-1.png


*Uncertainty estimation*

#+BEGIN_EXAMPLE
min(min_statistic[[s:]]);
0.6636162344466036


pmin;
pmax;

isis> pmin;
6.3269124031066895
isis> pmax;
6.633172988891602


.............................

At 68% conf

isis> conf_min;
6.385101914405823
isis> conf_max;
6.418790578842163
isis> conf_mean;
6.401946246623993


...................................

At 90% conf = conf_min;  conf_max;  conf_mean;

#+END_EXAMPLE

#+CAPTION: The 68 % confidence mass for 1H0707-495 OBS ID 0511580401 at $6.401\pm0.0168~logM_{\odot}$
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580401_logmass_conf68-1.png

#+CAPTION: The 90 % confidence mass for 1H0707-495 OBS ID 0511580401 at $\pm ~logM_{\odot}$
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580401_logmass_conf90.gif

*** OBS 0554710801 (2011)

Use script =/homeb/steff075/phd_ecm/1h0707/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
Freq,+-,Lag,+-
1.163636e-04,3.636364e-05,2.271602e+02,2.146345e+02
2.221488e-04,6.942149e-05,-8.595560e+01,1.616738e+02
4.241022e-04,1.325319e-04,1.132464e+02,6.648597e+01
8.096496e-04,2.530155e-04,6.644807e+01,3.071537e+01
1.545695e-03,4.830296e-04,-2.331277e+00,1.367376e+01
2.950872e-03,9.221474e-04,-8.458852e+00,5.037530e+00
5.633482e-03,1.760463e-03,4.788745e+00,2.227398e+00
#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0554710801_ecm_lags.gif

*ECM Fitting*

#+BEGIN_EXAMPLE
1H0707-0554710801-fit-error.sl
Submitted batch job 3973854

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0002154063           0       0.001
  2  lag_freq(1).log_mass   0     0         6.190454           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              100           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0


Obsid 1H0707_0554710801
chi^2 = 1.788520e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 3.000000e+00 (+2.370441e-02 -6.849094e-01)
Parameter Gamma2 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.000000e+02 (+1.769499e+02 -0.000000e+00)
Parameter t_shift = 1.000000e+01 (+6.817600e+01 -7.934922e+00)

lag_freq(1).log_mass,6.190454e+00,+8.979228e-02,-6.309963e-02

..............................................................

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.115237e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.085757           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               17           0           0
  7  lag_freq(1).Gamma1     0     1              3.2           0           0
  8  lag_freq(1).Gamma2     0     1              2.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              100           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0


Obsid 1H0707_0554710801
chi^2 = 1.838936e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.700000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 3.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.000000e+02 (+1.855512e+02 -0.000000e+00)
Parameter t_shift = 3.000000e+01 (+6.871780e+01 -1.002188e+01)

..............................................................

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     7.059471e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.062754           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               14           0           0
  7  lag_freq(1).Gamma1     0     1              3.3           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              100           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid 1H0707_0554710801
chi^2 = 1.815433e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.400000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 3.300000e+00 (+0.000000e+00 -1.122632e+00)
Parameter Gamma2 = 1.700000e+00 (+1.246512e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.000000e+02 (+1.916705e+02 -0.000000e+00)
Parameter t_shift = 2.000000e+01 (+7.905577e+01 -1.387229e+01)

............................................................................

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     9.095777e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.123721           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              100           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0

Obsid 1H0707_0554710801
chi^2 = 1.961411e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+4.983367e+00 -0.000000e+00)
Parameter Gamma1 = 3.000000e+00 (+0.000000e+00 -3.008072e-01)
Parameter Gamma2 = 2.200000e+00 (+1.161624e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.000000e+02 (+1.621990e+02 -0.000000e+00)
Parameter t_shift = 1.000000e+01 (+0.000000e+00 -0.000000e+00)

.............................................................................

Run  blob for h2 = 14rg

my $first_source_photon_index_low = 1.8;
my $first_source_photon_index_high = 3.3;
my $first_source_photon_index_delta = 0.1;
# Photon index of second source ("e")
my $second_source_photon_index_low = 1.5;
my $second_source_photon_index_high = 2.9;
my $second_source_photon_index_delta = 0.1;

my $tmax_low = 20.0;
my $tmax_high = 140.0;
my $tmax_delta = 20.0;
# "q" is the time shift between first and second source
my $tshift_low = 0.0;
my $tshift_high = 50.0;
my $tshift_delta = 5.0;

.........................................................

Submitted batch job 4093318

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.863406e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.108223           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               14           0           0
  7  lag_freq(1).Gamma1     0     1              3.2           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               40           0           0


Obsid 1H0707_0554710801
chi^2 = 1.785033e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.400000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 3.200000e+00 (+0.000000e+00 -1.180832e+00)
Parameter Gamma2 = 2.500000e+00 (+3.438011e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.000000e+02 (+0.000000e+00 -1.310992e+02)
Parameter t_shift = 4.000000e+01 (+0.000000e+00 -3.899017e+01)

.....................................................................

Submitted batch job 4093363


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.116299e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         5.768704           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               18           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              600           0           0
 15  lag_freq(1).t_shift    0     1              100           0           0

Obsid 1H0707_0554710801
chi^2 = 1.531615e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.800000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.000000e+02 (+0.000000e+00 -5.795039e+02)
Parameter t_shift = 1.000000e+02 (+0.000000e+00 -0.000000e+00)

lag_freq(1).log_mass,5.904735e+00,+7.237250e-02,-4.544327e-02
  Parameter 2 = 5.904735e+00 (5.859292e+00 - 5.977108e+00)

..................................................................

Submitted batch job 4095247

No better fit found!!! (after many attempts

#######################################################

Copy to Lyra and WWW

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0554710801_best_fit.ps .

ps2pdf 1H0707_0554710801_best_fit.ps
pdftocairo -png 1H0707_0554710801_best_fit.pdf
cp 1H0707_0554710801_best_fit-1.png /home/WWW/steff/ecm

#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0554710801_best_fit.png

**** Fixing logM

*Fix M to 6.03*


#+BEGIN_EXAMPLE
1H0707-0554710801-fit-error.sl
Submitted batch job 4010920

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001358057           0       0.001
  2  lag_freq(1).log_mass   0     1             6.03           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              100           0           0
 15  lag_freq(1).t_shift    0     1               60           0           0


Obsid 1H0707_0554710801
chi^2 = 3.005332e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+0.000000e+00 -7.217371e-03)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.000000e+02 (+1.751306e+02 -3.898847e+01)
Parameter t_shift = 6.000000e+01 (+2.882763e+01 -5.437732e+01)




#+END_EXAMPLE



*Fix M to 6.1*


#+BEGIN_EXAMPLE
1H0707-0554710801-fit-error.sl
Submitted batch job 4012246

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001942223           0       0.001
  2  lag_freq(1).log_mass   0     1              6.1           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              3.1           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              120           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0

bsid 1H0707_0554710801
chi^2 = 1.884070e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+0.000000e+00 -1.083401e+00)
Parameter Gamma1 = 3.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.200000e+02 (+1.171413e+02 -6.331221e+01)
Parameter t_shift = 1.000000e+01 (+2.801832e+00 -3.757874e+00)



#+END_EXAMPLE


*Fix M to 6.15*


#+BEGIN_EXAMPLE
Obsid 1H0707_0554710801
Submitted batch job 4016129


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0002087157           0       0.001
  2  lag_freq(1).log_mass   0     1             6.15           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              100           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0


Obsid 1H0707_0554710801
chi^2 = 2.119720e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.000000e+02 (+1.858714e+02 -2.123320e+01)
Parameter t_shift = 1.000000e+01 (+4.476416e+00 -3.686543e+00)

#+END_EXAMPLE

*** OBS 0554710801 isis emcee

PATH TO DATA = =/data/typhon1/reverb/1H0707-495/isis_emcee/=

Fit script = =1H0707-0554710801-fit-emcee.sl=

Fitting Parameter file =1H0707_0554710801_best_fit.par=

Make good image of the ECM Model fit

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0554710801_best_fit.ps/cps");
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
plot_comps(1,popt,&plot_data);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgsci(1); % make line colour black
_pgdraw(1,0);
close_plot(pid);
#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0554710801_best_fit-1.png


This model fit with χ²=1.79  and the parameters for this particular fit are:

+----------+----------------------+--------+--------+--------------+-----+-------+
| lag_freq |                      |        |        |              |     |       |
+----------+----------------------+--------+--------+--------------+-----+-------+
|      idx | param                | tie-to | freeze |        value | min |   max |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        1 | lag_freq(1).norm     |      0 |      0 | 0.0002154063 |   0 | 0.001 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        2 | lag_freq(1).log_mass |      0 |      0 |     6.190454 |   6 |   6.5 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        3 | lag_freq(1).i        |      0 |      1 |           53 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        4 | lag_freq(1).a        |      0 |      1 |        0.998 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        5 | lag_freq(1).h1       |      0 |      1 |            2 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        6 | lag_freq(1).h2       |      0 |      1 |            3 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        7 | lag_freq(1).Gamma1   |      0 |      1 |            3 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        8 | lag_freq(1).Gamma2   |      0 |      1 |          2.3 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        9 | lag_freq(1).Fe       |      0 |      1 |            1 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       10 | lag_freq(1).xi       |      0 |      1 |            0 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       11 | lag_freq(1).p        |      0 |      1 |            0 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       12 | lag_freq(1).b        |      0 |      1 |            2 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       13 | lag_freq(1).q2       |      0 |      1 |          0.5 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       14 | lag_freq(1).t_max    |      0 |      1 |          100 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       15 | lag_freq(1).t_shift  |      0 |      1 |           10 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+



*Lets Apply EMCEE to this model and use 500 Walkers with 5000 iterations in the chain*

#+BEGIN_EXAMPLE
isis

.source("1H0707-0554710801-fit-emcee.sl");

where

% Perform MCMC
emcee(500, 5000; output="1H0707_0554710801_chain_500_5000.fits", serial);

% Read the chain-file
(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("1H0707_0554710801_chain_500_5000.fits");

#+END_EXAMPLE


*Paths of the walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0554710801_walkers-1.png


*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0554710801_mass_accept_rate-1.png

Norm probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0554710801_norm_prob-1.png

Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0554710801_mass_prob-1.png

*Contours: paths in 2D*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0554710801_chain_hist2d-1.png

*Chain statistics*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0554710801_statistics-1.png


*Uncertainty estimation*

#+BEGIN_EXAMPLE
min(min_statistic[[s:]]);
0.6636162344466036


pmin;
pmax;

isis> pmin;
6.3269124031066895
isis> pmax;
6.633172988891602


.............................

At 68% conf




...................................

At 90% conf = conf_min;  conf_max;  conf_mean;

#+END_EXAMPLE

#+CAPTION: The 68 % confidence mass for 1H0707-495 OBS ID 0554710801  at $\pm~logM_{\odot}$
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0554710801_logmass_conf68-1.png

#+CAPTION: The 90 % confidence mass for 1H0707-495 OBS ID 0554710801 at $\pm ~logM_{\odot}$
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0554710801_logmass_conf90.gif

*** OBS 0653510301 (2010)

Use script =/homeb/steff075/phd_ecm/1h0707/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
Freq,Lag,+-
1.163636e-04,7.807517e+01,1.255008e+02
2.221488e-04,-5.552281e+01,6.563108e+01
4.241022e-04,9.651711e+01,3.960063e+01
8.096496e-04,-7.364963e+01,3.533887e+01
1.545695e-03,-1.663805e+01,1.421825e+01
2.950872e-03,3.036346e+00,1.642947e+01
5.633482e-03,6.256485e+00,4.676347e+01

#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0653510301_lag-freq.png

*ECM Fitting*

#+BEGIN_EXAMPLE
1H0707-0653510301-fit-error.sl
Submitted batch job 3974431

ag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.512815e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.256892           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              700           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0



Obsid 1H0707_0653510301
chi^2 = 6.498529e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+3.358864e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 7.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 8.000000e+01 (+0.000000e+00 -4.195393e+01)

lag_freq(1).log_mass,6.257060e+00,+7.651331e-02,-6.801731e-02

..............................................................

######################################################################


Fit -A


Submitted batch job 4091269

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      6.73772e-06           0       0.001
  2  lag_freq(1).log_mass   0     0         6.257197           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               10           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              150           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0

Obsid 1H0707_0653510301_A
chi^2 = 1.659849e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.000000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.500000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 8.000000e+01 (+4.179359e+01 -5.573965e+01)

...........................................................................

Submitted batch job 4094881

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     9.977636e-06           0       0.001
  2  lag_freq(1).log_mass   0     0         6.215645           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               12           0           0
  7  lag_freq(1).Gamma1     0     1                2           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              700           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0


Obsid 1H0707_0653510301_A
chi^2 = 7.225035e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.200000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 7.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 8.000000e+01 (+4.111475e+01 -5.089704e+01)

lag_freq(1).log_mass,6.215645e+00,+9.981428e-02,-5.576864e-02
  Parameter 2 = 6.215645e+00 (6.159876e+00 - 6.315459e+00)

#######################################################

Copy to Lyra and WWW

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0653510301_best_fit.ps .

ps2pdf 1H0707_0653510301_best_fit.ps
pdftocairo -png 1H0707_0653510301_best_fit.pdf
cp 1H0707_0653510301_best_fit-1.png /home/WWW/steff/ecm

#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510301_A_best_fit.png

**** Fixing logM

*Fix M to 6.03*


#+BEGIN_EXAMPLE
1H0707-0653510301-fit-error.sl
Submitted batch job 4010921

ag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      2.63473e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.03           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              280           0           0
 15  lag_freq(1).t_shift    0     1              120           0           0

Obsid 1H0707_0653510301
chi^2 = 2.155073e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+2.337051e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.800000e+02 (+2.652264e+02 -1.771220e+02)
Parameter t_shift = 1.200000e+02 (+0.000000e+00 -4.861670e+01)




#+END_EXAMPLE



*Fix M to 6.1*


#+BEGIN_EXAMPLE
1H0707-0653510301-fit-error.sl
Submitted batch job 4012251


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      1.90653e-05           0       0.001
  2  lag_freq(1).log_mass   0     1              6.1           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              2.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              230           0           0
 15  lag_freq(1).t_shift    0     1              110           0           0


Obsid 1H0707_0653510301
chi^2 = 1.902670e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.100000e+00 (+4.439604e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.300000e+02 (+3.075952e+02 -1.089132e+02)
Parameter t_shift = 1.100000e+02 (+0.000000e+00 -3.058047e+01)



#+END_EXAMPLE


*Fix M to 6.15*


#+BEGIN_EXAMPLE
Obsid 1H0707_0653510301
Submitted batch job 4016139


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.172556e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.15           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               10           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                1           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              150           0           0
 15  lag_freq(1).t_shift    0     1              120           0           0

Obsid 1H0707_0653510301
chi^2 = 1.700824e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.000000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.500000e+02 (+2.934261e+02 -3.245601e+00)
Parameter t_shift = 1.200000e+02 (+0.000000e+00 -5.431341e+01)

#+END_EXAMPLE

*** OBS 0653510301 isis emcee

PATH TO DATA = =/data/typhon1/reverb/1H0707-495/isis_emcee/=

Fit script = =1H0707-0653510301-fit-emcee.sl=

Fitting Parameter file =1H0707_0653510301_best_fit.par=

Make good image of the ECM Model fit

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0653510301_best_fit.ps/cps");
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
plot_comps(1,popt,&plot_data);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgsci(1); % make line colour black
_pgdraw(1,0);
close_plot(pid);
#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510301_best_fit-1.png


This model fit with χ²=0.65 and the parameters for this particular fit are:

+----------+----------------------+--------+--------+--------------+-----+-------+
| lag_freq |                      |        |        |              |     |       |
+----------+----------------------+--------+--------+--------------+-----+-------+
|      idx | param                | tie-to | freeze |        value | min |   max |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        1 | lag_freq(1).norm     |      0 |      0 | 0.0002154063 |   0 | 0.001 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        2 | lag_freq(1).log_mass |      0 |      0 |     6.190454 |   6 |   6.5 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        3 | lag_freq(1).i        |      0 |      1 |           53 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        4 | lag_freq(1).a        |      0 |      1 |        0.998 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        5 | lag_freq(1).h1       |      0 |      1 |            2 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        6 | lag_freq(1).h2       |      0 |      1 |            3 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        7 | lag_freq(1).Gamma1   |      0 |      1 |            3 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        8 | lag_freq(1).Gamma2   |      0 |      1 |          2.3 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        9 | lag_freq(1).Fe       |      0 |      1 |            1 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       10 | lag_freq(1).xi       |      0 |      1 |            0 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       11 | lag_freq(1).p        |      0 |      1 |            0 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       12 | lag_freq(1).b        |      0 |      1 |            2 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       13 | lag_freq(1).q2       |      0 |      1 |          0.5 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       14 | lag_freq(1).t_max    |      0 |      1 |          100 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       15 | lag_freq(1).t_shift  |      0 |      1 |           10 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+



*Lets Apply EMCEE to this model and use 500 Walkers with 5000 iterations in the chain*

#+BEGIN_EXAMPLE
isis

.source("1H0707-0653510301-fit-emcee.sl");

where

% Perform MCMC
emcee(500, 5000; output="1H0707_0653510301_chain_500_5000.fits", serial);

% Read the chain-file
(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("1H0707_0653510301_chain_500_5000.fits");

#+END_EXAMPLE


*Paths of the walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510301_walkers-1.png


*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510301_mass_accept_rate-1.png

Norm probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510301_norm_prob-1.png

Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510301_mass_prob-1.png

*Contours: paths in 2D*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510301_chain_hist2d-1.png

*Chain statistics*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510301_statistics-1.png


*Uncertainty estimation*

#+BEGIN_EXAMPLE
min(min_statistic[[s:]]);
0.6491598787008719

pmin;
pmax;

isis> pmin;
6.041879177093506
isis> pmax;
6.500605583190918

.............................

At 68% conf

isis> conf_min;
6.204727051258087
isis> conf_max;
6.2964723324775695
isis> conf_mean;
6.250599691867828

...................................

At 90% conf = conf_min;  conf_max;  conf_mean;

#+END_EXAMPLE

#+CAPTION: The 68 % confidence mass for 1H0707-495 OBS ID 0653510301  at $6.250\pm0.0458~logM_{\odot}$
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510301_logmass_conf68-1.png

#+CAPTION: The 90 % confidence mass for 1H0707-495 OBS ID 0653510301 at $\pm ~logM_{\odot}$
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510301_logmass_conf90.gif

*** OBS 0653510401 (2010)

Use script =/homeb/steff075/phd_ecm/1h0707/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
Freq,Lag,+-
1.163636e-04,1.787745e+01,1.702074e+02
2.221488e-04,1.060390e+02,5.669055e+01
4.241022e-04,-1.007740e+01,4.112445e+01
8.096496e-04,1.455203e+00,1.806763e+01
1.545695e-03,-4.139264e+01,8.911063e+00
2.950872e-03,-4.000691e+01,1.032533e+01
5.633482e-03,-1.499149e+01,2.209454e+01

#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0653510401_lag-freq.png

*ECM Fitting*

#+BEGIN_EXAMPLE
1H0707-0653510401-fit-error.sl
Submitted batch job 3974432

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     8.654661e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.011134           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              480           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0

Obsid 1H0707_0653510401
chi^2 = 9.329506e-02 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+2.590800e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -2.290844e-02)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.800000e+02 (+4.867095e+01 -2.187227e+02)
Parameter t_shift = 5.000000e+01 (+1.161833e+01 -2.675724e+01)

lag_freq(1).log_mass,6.011134e+00,+6.203806e-02,-3.395156e-02


...............................................
###############################################


Fit - A




Submitted batch job 4091270

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.964559e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         5.945929           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               12           0           0
  7  lag_freq(1).Gamma1     0     1                2           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              550           0           0
 15  lag_freq(1).t_shift    0     1               70           0           0



Obsid 1H0707_0653510401_A
chi^2 = 4.598292e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.200000e+01 (+4.959827e+00 -0.000000e+00)
Parameter Gamma1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.500000e+02 (+0.000000e+00 -3.406661e+02)
Parameter t_shift = 7.000000e+01 (+3.510221e+01 -3.475029e+01)

.............................................................................

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.884462e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         5.885895           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               16           0           0
  7  lag_freq(1).Gamma1     0     1              2.1           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              700           0           0
 15  lag_freq(1).t_shift    0     1               90           0           0


Obsid 1H0707_0653510401_A
chi^2 = 2.235630e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.600000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 7.000000e+02 (+8.202318e+01 -4.966338e+02)
Parameter t_shift = 9.000000e+01 (+3.030681e+01 -5.512524e+01)

lag_freq(1).log_mass,5.885895e+00,+1.967116e-02,-2.222450e-02
  Parameter 2 = 5.885895e+00 (5.863671e+00 - 5.905566e+00)

###############################################
Copy fit to Lyra and WWW:

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0653510401_best_fit.ps .

ps2pdf 1H0707_0653510401_best_fit.ps
pdftocairo -png 1H0707_0653510401_best_fit.pdf
cp 1H0707_0653510401_best_fit-1.png /home/WWW/steff/ecm

#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510401_A_best_fit.png


**** Fixing logM

*Fix M to 6.03*


#+BEGIN_EXAMPLE
1H0707-0653510401-fit-error.sl
Submitted batch job 4010922

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     9.369905e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.03           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.1           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0


Obsid 1H0707_0653510401
chi^2 = 3.189991e-01 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+4.320877e+00 -0.000000e+00)
Parameter Gamma1 = 2.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.900000e+00 (+3.868944e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -2.225777e-02)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+0.000000e+00 -7.474633e+01)
Parameter t_shift = 5.000000e+01 (+7.940621e+00 -3.379884e+00)




#+END_EXAMPLE

*Fix M to 6.1*


#+BEGIN_EXAMPLE
1H0707-0653510401-fit-error.sl
Submitted batch job 4012253

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     8.214066e-05           0       0.001
  2  lag_freq(1).log_mass   0     1              6.1           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.1           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               40           0           0


Obsid 1H0707_0653510401
chi^2 = 5.335608e-01 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+3.313944e+00 -0.000000e+00)
Parameter Gamma1 = 2.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.900000e+00 (+4.877715e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -1.654055e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+1.052030e+02 -5.915912e+01)
Parameter t_shift = 4.000000e+01 (+1.023822e+01 -5.261508e+00)


#+END_EXAMPLE


*Fix M to 6.15*


#+BEGIN_EXAMPLE
Obsid 1H0707_0653510401
Submitted batch job 4016140

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     7.951838e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.15           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1                2           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               40           0           0

Obsid 1H0707_0653510401
chi^2 = 1.329946e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+3.546666e+00 -0.000000e+00)
Parameter Gamma1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+5.548018e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.094110e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+1.211782e+02 -1.597159e+02)
Parameter t_shift = 4.000000e+01 (+6.990341e+00 -1.084006e+00)



#+END_EXAMPLE

*** OBS 0653510401 isis emcee

PATH TO DATA = =/data/typhon1/reverb/1H0707-495/isis_emcee/=

Fit script = =1H0707-0653514301-fit-emcee.sl=

Fitting Parameter file =1H0707_0653510401_best_fit.par=

Make good image of the ECM Model fit

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0653510401_best_fit.ps/cps");
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
plot_comps(1,popt,&plot_data);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgsci(1); % make line colour black
_pgdraw(1,0);
close_plot(pid);
#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510401_best_fit-1.png


This model fit with χ²=0.01 and the parameters for this particular fit are:

+----------+----------------------+--------+--------+--------------+-----+-------+
| lag_freq |                      |        |        |              |     |       |
+----------+----------------------+--------+--------+--------------+-----+-------+
|      idx | param                | tie-to | freeze |        value | min |   max |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        1 | lag_freq(1).norm     |      0 |      0 | 8.654661e-05 |   0 | 0.001 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        2 | lag_freq(1).log_mass |      0 |      0 |     6.011134 |   5 |     7 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        3 | lag_freq(1).i        |      0 |      1 |           53 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        4 | lag_freq(1).a        |      0 |      1 |        0.998 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        5 | lag_freq(1).h1       |      0 |      1 |            2 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        6 | lag_freq(1).h2       |      0 |      1 |            5 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        7 | lag_freq(1).Gamma1   |      0 |      1 |          2.2 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        8 | lag_freq(1).Gamma2   |      0 |      1 |            2 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        9 | lag_freq(1).Fe       |      0 |      1 |            1 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       10 | lag_freq(1).xi       |      0 |      1 |            2 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       11 | lag_freq(1).p        |      0 |      1 |            0 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       12 | lag_freq(1).b        |      0 |      1 |            2 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       13 | lag_freq(1).q2       |      0 |      1 |          0.5 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       14 | lag_freq(1).t_max    |      0 |      1 |          480 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       15 | lag_freq(1).t_shift  |      0 |      1 |           50 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+


*Lets Apply EMCEE to this model and use 500 Walkers with 5000 iterations in the chain*

#+BEGIN_EXAMPLE
isis

.source("1H0707-0653510401-fit-emcee.sl");

where

% Perform MCMC
emcee(500, 5000; output="1H0707_0653510401_chain_500_5000.fits", serial);

% Read the chain-file
(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("1H0707_0653510401_chain_500_5000.fits");

#+END_EXAMPLE


*Paths of the walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510401_walkers-1.png


*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510401_mass_accept_rate-1.png

Norm probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510401_norm_prob-1.png

Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510401_mass_prob-1.png

*Contours: paths in 2D*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510401_chain_hist2d-1.png

*Chain statistics*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510401_statistics-1.png


*Uncertainty estimation*

#+BEGIN_EXAMPLE
min(min_statistic[[s:]]);
0.0932960524176573


pmin;
pmax;

isis> pmin;
5.924603462219238
isis> pmax;
6.225374221801758

.............................

At 68% conf


isis> conf_min;
5.990773029327393
isis> conf_max;
6.040400204658508
isis> conf_mean;
6.01558661699295

...................................

At 90% conf = conf_min;  conf_max;  conf_mean;

#+END_EXAMPLE

#+CAPTION: The 68 % confidence mass for 1H0707-495 OBS ID 0653510401  at $6.015\pm0.0248~logM_{\odot}$
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510401_logmass_conf68-1.png

#+CAPTION: The 90 % confidence mass for 1H0707-495 OBS ID 0653510401 at $\pm ~logM_{\odot}$
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510401_logmass_conf90.gif

*** OBS 0653510501 (2010)

Use script =/homeb/steff075/phd_ecm/1h0707/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
Freq,Lag,+-
1.163636e-04,-4.450079e+02,2.278669e+02
2.221488e-04,1.305822e+02,9.918457e+01
4.241022e-04,5.844982e+01,4.164513e+01
8.096496e-04,-2.265454e+01,1.806128e+01
1.545695e-03,-1.730471e+01,1.370713e+01
2.950872e-03,-4.018026e+01,1.872437e+01
5.633482e-03,6.188634e+01,2.614960e+01

#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0653510501_lag-freq.png

*ECM Fitting*

#+BEGIN_EXAMPLE
...............................................

1H0707-0653510501-fit-error.sl
Submitted batch job 3975115

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001079742           0       0.001
  2  lag_freq(1).log_mass   0     0         6.084569           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid 1H0707_0653510501
chi^2 = 5.813902e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+2.330199e-01 -0.000000e+00)
Parameter Gamma2 = 2.500000e+00 (+2.914607e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.134940e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+2.357095e+01 -1.907591e+02)
Parameter t_shift = 2.000000e+01 (+1.889128e+01 -1.857492e+01)

..................................................................................
Submitted batch job 4034695

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      0.000111045           0       0.001
  2  lag_freq(1).log_mass   0     0         6.084721           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid 1H0707_0653510501
chi^2 = 5.775628e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -8.006063e-01)
Parameter Gamma2 = 2.500000e+00 (+3.807664e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+3.652046e+01 -1.914052e+02)
Parameter t_shift = 2.000000e+01 (+1.904530e+01 -1.835009e+01)

lag_freq(1).log_mass,6.084721e+00,+5.613212e-02,-2.431212e-02

...............................................


##########################################################
#########################################################


In addition running the ABS lags on 4038778


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     9.020731e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.174549         4.5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                9           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              280           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Obsid 1H0707_0653510501_A
chi^2 = 3.560333e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 9.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.800000e+02 (+3.787726e+02 -0.000000e+00)
Parameter t_shift = 2.000000e+01 (+9.208725e+00 -0.000000e+00)

.............................................................................

Submitted batch job 4040864

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.514516e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.292034           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                7           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid 1H0707_0653510501_A
chi^2 = 2.548949e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 7.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 2.000000e+01 (+9.040181e+00 -0.000000e+00)

......................................................................................

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     7.308806e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.052582           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               14           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              350           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid 1H0707_0653510501_A
chi^2 = 2.048885e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.400000e+01 (+0.000000e+00 -1.039764e+01)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.500000e+02 (+2.791418e+01 -3.432485e+00)
Parameter t_shift = 2.000000e+01 (+1.493615e+01 -1.325531e+01)

.....................................................................

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.580772e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.449434           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               18           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              150           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid 1H0707_0653510501_A
chi^2 = 1.856022e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.800000e+01 (+0.000000e+00 -1.308812e+01)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.500000e+02 (+1.509987e+02 -8.523998e+00)
Parameter t_shift = 2.000000e+01 (+1.528274e+01 -1.510135e+01)


.........................................................


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     7.445395e-05           0       0.001
  2  lag_freq(1).log_mass   0     0          6.00742           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               19           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid 1H0707_0653510501_A
chi^2 = 1.644625e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.900000e+01 (+0.000000e+00 -1.442119e+01)
Parameter Gamma1 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+1.820185e+01 -3.441775e+00)
Parameter t_shift = 2.000000e+01 (+1.466731e+01 -1.822024e+01)

lag_freq(1).log_mass,6.007420e+00,+2.393270e-02,-6.635215e-02
  Parameter 2 = 6.007420e+00 (5.941068e+00 - 6.031353e+00)

.....................................................................

Submitted batch job 4092270





###############################################
Copy fit to Lyra and WWW:

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0653510501_best_fit.ps .

ps2pdf 1H0707_0653510501_best_fit.ps
pdftocairo -png 1H0707_0653510501_best_fit.pdf
cp 1H0707_0653510501_best_fit-1.png /home/WWW/steff/ecm

#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510501_A_best_fit-1.png

**** Fixing logM


*Fix M to 6.03*

#+BEGIN_EXAMPLE
1H0707-0653510501-fit-error.sl
Submitted batch job 4010923

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0       0.00010184           0       0.001
  2  lag_freq(1).log_mass   0     1             6.03         5.9         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               10           0           0
  7  lag_freq(1).Gamma1     0     1              2.9           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid 1H0707_0653510501
chi^2 = 7.394238e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.000000e+01 (+0.000000e+00 -3.091304e+00)
Parameter Gamma1 = 2.900000e+00 (+0.000000e+00 -8.634992e-01)
Parameter Gamma2 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+2.191172e+01 -1.273947e+01)
Parameter t_shift = 2.000000e+01 (+2.350848e+01 -1.798542e+01)
#+END_EXAMPLE

*Fix M to 6.1*

#+BEGIN_EXAMPLE
1H0707-0653510501-fit-error.sl
Submitted batch job 4012254

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001080698           0       0.001
  2  lag_freq(1).log_mass   0     1              6.1         5.9         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              290           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Obsid 1H0707_0653510501
chi^2 = 6.293272e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+0.000000e+00 -1.961218e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -7.082405e-01)
Parameter Gamma2 = 2.500000e+00 (+2.792201e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.900000e+02 (+3.978058e+01 -1.162275e+02)
Parameter t_shift = 2.000000e+01 (+1.516163e+01 -1.749467e+01)
#+END_EXAMPLE

*Fix M to 6.15*

#+BEGIN_EXAMPLE
Obsid 1H0707_0653510501
Submitted batch job 4016141

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     7.798173e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.15         5.9         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                7           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              280           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0


Obsid 1H0707_0653510501
chi^2 = 7.388611e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 7.000000e+00 (+0.000000e+00 -3.751235e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -1.601043e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.800000e+02 (+3.595091e+01 -1.727303e+02)
Parameter t_shift = 3.000000e+01 (+4.483688e+00 -2.595064e+01)
#+END_EXAMPLE

*** OBS 0653510501 isis emcee

PATH TO DATA = =/data/typhon1/reverb/1H0707-495/isis_emcee/=

Fit script = =1H0707-0653510501-fit-emcee.sl=

Fitting Parameter file =1H0707_065351051_best_fit.par=

Make good image of the ECM Model fit

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0653510501_best_fit.ps/cps");
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
plot_comps(1,popt,&plot_data);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgsci(1); % make line colour black
_pgdraw(1,0);
close_plot(pid);
#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510501_best_fit-1.png


This model fit with χ²=1.64 and the parameters for this particular fit are:

+----------+----------------------+--------+--------+--------------+-----+-------+
| lag_freq |                      |        |        |              |     |       |
+----------+----------------------+--------+--------+--------------+-----+-------+
|      idx | param                | tie-to | freeze |        value | min |   max |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        1 | lag_freq(1).norm     |      0 |      0 | 7.445395e-05 |   0 | 0.001 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        2 | lag_freq(1).log_mass |      0 |      0 |      6.00742 |   5 |     7 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        3 | lag_freq(1).i        |      0 |      1 |           53 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        4 | lag_freq(1).a        |      0 |      1 |        0.998 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        5 | lag_freq(1).h1       |      0 |      1 |            2 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        6 | lag_freq(1).h2       |      0 |      1 |           19 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        7 | lag_freq(1).Gamma1   |      0 |      1 |          2.5 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        8 | lag_freq(1).Gamma2   |      0 |      1 |          1.8 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        9 | lag_freq(1).Fe       |      0 |      1 |            1 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       10 | lag_freq(1).xi       |      0 |      1 |            0 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       11 | lag_freq(1).p        |      0 |      1 |            0 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       12 | lag_freq(1).b        |      0 |      1 |            3 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       13 | lag_freq(1).q2       |      0 |      1 |          0.5 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       14 | lag_freq(1).t_max    |      0 |      1 |          400 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       15 | lag_freq(1).t_shift  |      0 |      1 |           20 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+


*Lets Apply EMCEE to this model and use 500 Walkers with 5000 iterations in the chain*

#+BEGIN_EXAMPLE
isis

.source("1H0707-0653510501-fit-emcee.sl");

where

% Perform MCMC
emcee(500, 5000; output="1H0707_0653510501_chain_500_5000.fits", serial);

% Read the chain-file
(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("1H0707_0653510501_chain_500_5000.fits");

#+END_EXAMPLE


*Paths of the walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510501_walkers-1.png


*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510501_mass_accept_rate-1.png

Norm probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510501_norm_prob-1.png

Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510501_mass_prob-1.png

*Contours: paths in 2D*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510501_chain_hist2d-1.png

*Chain statistics*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510501_statistics-1.png


*Uncertainty estimation*

#+BEGIN_EXAMPLE
min(min_statistic[[s:]]);


pmin;
pmax;

isis> pmin;
5.842747688293457
isis> pmax;
6.1599650382995605


.............................

At 68% conf



...................................

At 90% conf = conf_min;  conf_max;  conf_mean;

#+END_EXAMPLE

#+CAPTION: The 68 % confidence mass for 1H0707-495 OBS ID 0653510501  at $\pm~logM_{\odot}$
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510501_logmass_conf68-1.png

#+CAPTION: The 90 % confidence mass for 1H0707-495 OBS ID 0653510501 at $\pm ~logM_{\odot}$
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510501_logmass_conf90.gif

*** OBS 0653510601 (2010)

Use script =/homeb/steff075/phd_ecm/1h0707/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
Freq,Lag,+-
1.163636e-04,3.636364e-05,4.248069e+02,1.262799e+02
2.221488e-04,6.942149e-05,3.124446e+02,5.847211e+01
4.241022e-04,1.325319e-04,4.903590e+01,3.536553e+01
8.096496e-04,2.530155e-04,-1.223158e+00,2.014476e+01
1.545695e-03,4.830296e-04,-2.205842e+01,1.091538e+01
2.950872e-03,9.221474e-04,-1.166931e+01,4.893659e+00
5.633482e-03,1.760463e-03,-3.203729e+00,1.877995e+00
#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0653510601_lagfreq.gif

*ECM Fitting*

#+BEGIN_EXAMPLE

...............................................

1H0707-0653510601-fit-error.sl
Submitted batch job 3975116

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     9.357592e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.010351           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.9           0           0
  8  lag_freq(1).Gamma2     0     1              2.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               40           0           0

Obsid 1H0707_0653510601
chi^2 = 2.389827e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+5.088907e+00 -0.000000e+00)
Parameter Gamma1 = 2.900000e+00 (+1.776486e-01 -0.000000e+00)
Parameter Gamma2 = 2.700000e+00 (+1.430562e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+2.993012e+02 -1.370506e+02)
Parameter t_shift = 4.000000e+01 (+4.302528e+01 -3.894351e+01)

...............................................

1H0707-0653510601-fit-error.sl
Submitted batch job 3975390

no better fit found - run blob code again?

###############################################
Copy fit to Lyra and WWW:

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0653510601_best_fit.ps .

ps2pdf 1H0707_0653510601_best_fit.ps
pdftocairo -png 1H0707_0653510601_best_fit.pdf
cp 1H0707_0653510601_best_fit-1.png /home/WWW/steff/ecm

#+END_EXAMPLE

Improve fit
#+BEGIN_EXAMPLE
1H0707-0653510601-fit-error.sl
Submitted batch job 3988074

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.8, 2.7, 2.9, 3.0, 3.1, 3.2]; % Gamma1
vals_to_fit[3] = [2.5, 2.6, 2.7, 2.8, 2.9, 3.0]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 150.0, 200.0, 220.0, 250.0, 280.0, 300.0, 350.0, 360.0, 380.0, 400.0, 410.0, 420.0, 450.0, 4\
60.0, 500.0, 520.0, 550.0, 600.0, 700.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [0.0, 10.0, 20.0, 30.0, 35.0, 40.0, 45.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0, 105.0, 110.0, 120.0]\
; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     9.484965e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.001751           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              410           0           0
 15  lag_freq(1).t_shift    0     1               40           0           0


Obsid 1H0707_0653510601
chi^2 = 2.335131e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+5.497974e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.100000e+02 (+2.784364e+02 -1.500287e+02)
Parameter t_shift = 4.000000e+01 (+4.319942e+01 -3.219332e+01)

...............................................................

1H0707-0653510601-fit-error.sl
Submitted batch job 4036103

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      0.000129102           0       0.001
  2  lag_freq(1).log_mass   0     0         5.906629         4.5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              520           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0

Obsid 1H0707_0653510601
chi^2 = 1.691122e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 3.000000e+00 (+0.000000e+00 -4.988346e-01)
Parameter Gamma2 = 2.800000e+00 (+3.433955e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.200000e+02 (+0.000000e+00 -2.257099e+02)
Parameter t_shift = 3.000000e+01 (+5.925632e+01 -1.016619e+01)

lag_freq(1).log_mass,5.906629e+00,+6.388573e-02,-5.514551e-02

....................................................................


################################################################

Now fit ABS lags

################################################################

Submitted batch job 4039636

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.536946e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         5.992997           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                7           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              550           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0

Obsid 1H0707_0653510601_A
chi^2 = 5.088582e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 7.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 3.000000e+00 (+0.000000e+00 -3.944674e-01)
Parameter Gamma2 = 2.700000e+00 (+4.025510e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.500000e+02 (+0.000000e+00 -3.145839e+02)
Parameter t_shift = 8.000000e+01 (+0.000000e+00 -0.000000e+00)

lag_freq(1).log_mass,5.992997e+00,+3.634065e-02,-4.675688e-02
  Parameter 2 = 5.992997e+00 (5.946240e+00 - 6.029338e+00)

#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510601_A_best_fit.png



**** Fixing logM

*Fix M to 6.03*

#+BEGIN_EXAMPLE
1H0707-0653510601-fit-error.sl
Submitted batch job 4010924

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     8.877066e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.03           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.9           0           0
  8  lag_freq(1).Gamma2     0     1              2.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               40           0           0


Obsid 1H0707_0653510601
chi^2 = 2.585293e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+4.529066e+00 -0.000000e+00)
Parameter Gamma1 = 2.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+2.510674e+02 -5.132162e+01)
Parameter t_shift = 4.000000e+01 (+4.094907e+01 -3.567602e+01)
#+END_EXAMPLE



*Fix M to 6.1*


#+BEGIN_EXAMPLE
1H0707-0653510601-fit-error.sl
Submitted batch job 4012255

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001238993           0       0.001
  2  lag_freq(1).log_mass   0     1              6.1           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              350           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Obsid 1H0707_0653510601
chi^2 = 2.950421e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+2.063358e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.500000e+02 (+9.667904e+00 -8.391581e+01)
Parameter t_shift = 2.000000e+01 (+4.393619e+01 -1.903183e+01)
#+END_EXAMPLE


*Fix M to 6.15*


#+BEGIN_EXAMPLE
Obsid 1H0707_0653510601
Submitted batch job 4016143

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      5.82928e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.15           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0

Obsid 1H0707_0653510601
chi^2 = 4.408848e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+3.520166e+00 -0.000000e+00)
Parameter Gamma1 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+5.844120e+01 -6.537953e+01)
Parameter t_shift = 3.000000e+01 (+3.414022e+01 -2.765144e+01)
#+END_EXAMPLE

*** OBS 0653510601 isis emcee

PATH TO DATA = =/data/typhon1/reverb/1H0707-495/isis_emcee/=

Fit script = =1H0707-0653510601-fit-emcee.sl=

Fitting Parameter file =1H0707_0653510601_best_fit.par=

Make good image of the ECM Model fit

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0653510601_best_fit.ps/cps");
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
plot_comps(1,popt,&plot_data);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgsci(1); % make line colour black
_pgdraw(1,0);
close_plot(pid);
#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510601_best_fit-1.png


This model fit with χ²=0.51 and the parameters for this particular fit are:

+----------+----------------------+--------+--------+--------------+-----+-------+
| lag_freq |                      |        |        |              |     |       |
+----------+----------------------+--------+--------+--------------+-----+-------+
|      idx | param                | tie-to | freeze |        value | min |   max |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        1 | lag_freq(1).norm     |      0 |      0 | 2.536946e-05 |   0 | 0.001 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        2 | lag_freq(1).log_mass |      0 |      0 |     5.992997 |   5 |     7 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        3 | lag_freq(1).i        |      0 |      1 |           53 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        4 | lag_freq(1).a        |      0 |      1 |        0.998 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        5 | lag_freq(1).h1       |      0 |      1 |            2 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        6 | lag_freq(1).h2       |      0 |      1 |            7 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        7 | lag_freq(1).Gamma1   |      0 |      1 |            3 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        8 | lag_freq(1).Gamma2   |      0 |      1 |          2.7 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|        9 | lag_freq(1).Fe       |      0 |      1 |            1 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       10 | lag_freq(1).xi       |      0 |      1 |            3 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       11 | lag_freq(1).p        |      0 |      1 |            0 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       12 | lag_freq(1).b        |      0 |      1 |            1 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       13 | lag_freq(1).q2       |      0 |      1 |          0.5 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       14 | lag_freq(1).t_max    |      0 |      1 |          550 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+
|       15 | lag_freq(1).t_shift  |      0 |      1 |           80 |   0 |     0 |
+----------+----------------------+--------+--------+--------------+-----+-------+



*Lets Apply EMCEE to this model and use 500 Walkers with 5000 iterations in the chain*

#+BEGIN_EXAMPLE
isis

.source("1H0707-0653510601-fit-emcee.sl");

where

% Perform MCMC
emcee(500, 5000; output="1H0707_0653510601_chain_500_5000.fits", serial);

% Read the chain-file
(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("1H0707_0653510601_chain_500_5000.fits");

#+END_EXAMPLE


*Paths of the walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510601_walkers-1.png


*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510601_mass_accept_rate-1.png

Norm probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510601_norm_prob-1.png

Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510601_mass_prob-1.png

*Contours: paths in 2D*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510601_chain_hist2d-1.png

*Chain statistics*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510601_statistics-1.png


*Uncertainty estimation*

#+BEGIN_EXAMPLE
min(min_statistic[[s:]]);
0.5088584448668703

pmin;
pmax;

isis>  pmin;
5.6796650886535645
isis> pmax;
6.140117645263672


.............................

At 68% conf

isis> conf_min;
5.942123045921326
isis> conf_max;
6.027306768894196
isis> conf_mean;
5.984714907407761

 conf_mean - conf_min; 0.0425918614864349


..................................

At 90% conf = conf_min;  conf_max;  conf_mean;

#+END_EXAMPLE

#+CAPTION: The 68 % confidence mass for 1H0707-495 OBS ID 0653510601  at $5.984\pm0.0425~logM_{\odot}$
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510601_logmass_conf68-1.png

#+CAPTION: The 90 % confidence mass for 1H0707-495 OBS ID 0653510601 at $\pm ~logM_{\odot}$
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510601_logmass_conf90.gif

** *1H0707-495 Results* (at a glance)

The literature value initially used for fitting was $logM_{\odot} =
6.31$. This table shows all the ECM results for the initial fits
which were completed by setting the mass to 6.31 and leaving the parameter free to
vary between 5.0 - 7.0. Additional fixed Mass value fits have also been completed for
each data set as presented below.

*VARIABLE MASS Fits including logM errors (single observations)*

These results included in =/home/steff075/phd_ecm/results-for-all/1H0707-495_results_single_obs.ods=

The full data file (inlcuding spectral results) can be downloaded in csv format from [[http://www.star.bris.ac.uk/steff/ecm/1H0707-495_results_single_obs.csv][here]]

|      Data | ECM-Chi2 | ECM_logM |    + |    - | ECM-h2 |    + |     - | ECM-Gama1 |    + |    - | ECM-Gamma2 |    + |    - | Delta-G | ECM-xi | + | - | ECM-b |    + |    - | tmax |      + |      - | tshift |     + |     - |
|  Combined |     2.04 | 6.027921 | 0.02 | 0.02 |      3 | 0.03 |  0.19 |         3 |    0 |    0 |        2.9 |    0 | 0.19 |     0.1 |      3 | 0 | 0 |     2 |    0 |    0 |  569 |      0 |  48.52 |     91 | 10.06 |     0 |
|   Hi-spec |     3.34 | 5.943525 | 0.04 | 0.04 |      4 |    0 |     0 |       1.7 |    0 |    0 |        1.4 |    0 |    0 |     0.3 |      1 | 0 | 0 |     1 |    0 |    0 |  490 |      0 | 206.32 |     65 |     0 |  7.97 |
| Hi-cts>20 |     2.43 | 5.992163 | 0.03 | 0.03 |      5 |    0 |     0 |       1.9 |    0 |    0 |        1.6 |    0 |    0 |     0.3 |      0 | 0 | 0 |     1 | 0.81 |    0 |  500 |      0 | 168.65 |     90 |     0 | 72.19 |
|  Med-spec |     0.27 | 5.928386 | 0.16 | 0.08 |      6 |    0 |  2.16 |       2.8 |    0 |    0 |        2.4 |    0 |    0 |     0.4 |      2 | 0 | 0 |     2 |    0 |    0 |  100 |   0.46 |   1.54 |     60 |  0.23 |  0.77 |
|   Lo-spec |     1.59 | 6.144442 | 0.05 | 0.04 |      6 |    0 |     0 |       3.3 |    0 | 0.69 |        2.9 |    0 |    0 |     0.4 |      1 | 0 | 0 |     1 |    0 |    0 |  250 |  88.28 | 121.22 |     10 | 21.79 |     0 |
| Lo-cts<20 |     0.95 | 6.258481 | 0.02 | 0.02 |      5 |    0 |     0 |         3 |  0.1 |    0 |        2.6 | 0.22 |    0 |     0.4 |      0 | 0 |   |     2 |    0 |    0 |  210 |  36.55 |      0 |     17 |  3.38 | 15.94 |
| 110890201 |     0.08 | 6.034376 | 0.12 | 0.03 |      7 |    0 |   1.0 |       3.1 |    0 |    0 |        2.9 |    0 |  0.2 |     0.2 |      3 | 0 | 0 |     3 |    0 |    0 |  560 |   5.14 |  27.55 |     20 |  1.37 |  2.21 |
| 148010301 |     0.96 | 6.214620 | 0.06 | 0.07 |      5 | 2.67 |     0 |       2.4 |    0 |    0 |        2.2 | 0.75 |    0 |     0.2 |      2 | 0 | 0 |     3 |    0 | 1.25 |  700 |  25.57 |  44.73 |     60 |     0 |  4.06 |
| 506200201 |     1.17 | 6.154736 | 0.06 | 0.04 |      5 |    0 |     0 |         3 |    0 |    0 |        2.9 |    0 |    0 |     0.1 |      0 | 0 | 0 |     1 |    0 |    0 |  500 |      0 |      0 |     85 |     0 |  31.6 |
| 506200301 |     1.31 | 5.986613 | 0.11 | 0.08 |      3 |    0 |     0 |       2.5 |    0 |    0 |        2.3 |    0 |    0 |     0.2 |      3 | 0 | 0 |     3 |    0 |    0 |  250 |      0 |      0 |     80 | 35.34 | 77.88 |
| 506200401 |     1.11 | 6.126042 | 0.16 | 0.19 |      3 |    0 |     0 |       2.6 |    0 |    0 |          2 | 0.84 |    0 |     0.6 |      0 | 0 | 0 |     1 |    0 |    0 |  600 |      0 |      0 |    110 |     0 |     0 |
| 506200501 |     0.95 | 6.471828 | 0.06 | 0.09 |      3 |    0 |     0 |         3 | 0.06 |    0 |        1.7 | 1.13 |    0 |     1.3 |      3 | 0 | 0 |     2 |    0 |    0 |  350 |      0 | 241.21 |    120 |     0 |     0 |
| 511580101 |     0.24 | 6.249992 | 0.04 | 0.06 |      6 |    0 |     0 |       2.6 |    0 |    0 |        2.2 |    0 |    0 |     0.4 |      1 | 0 | 0 |     2 |    0 |    0 |  250 | 434.73 |  72.45 |     20 | 99.13 |     0 |
| 511580201 |     1.25 | 6.397703 | 0.06 | 0.10 |      8 |    0 |     0 |       2.8 | 0.28 |  0.4 |          2 |    0 |    0 |     0.8 |      1 | 0 | 0 |     1 |    0 |    0 |  150 | 313.42 |      0 |     30 | 64.62 | 27.31 |
| 511580301 |     0.95 | 6.322830 | 0.03 | 0.02 |     16 |    0 |  3.88 |       2.8 |    0 | 0.39 |        2.1 |    0 |    0 |     0.7 |      3 | 0 | 0 |     3 |    0 | 0.63 |  250 |   6.59 |   0.23 |     20 |  1.09 |  7.60 |
| 511580401 |     0.66 | 6.399108 | 0.05 | 0.02 |      3 |    0 |     0 |       2.6 |    0 |    0 |        2.4 |    0 |    0 |     0.2 |      1 | 0 | 0 |     3 |    0 |    0 |  300 |      0 |      0 |     50 |     0 | 47.76 |
| 554710801 |     1.82 | 6.062754 | 0.06 | 0.05 |     14 |    0 |     0 |       3.3 |    0 | 1.12 |        1.7 | 1.24 |    0 |     1.6 |      3 | 0 | 0 |     1 |    0 |    0 |  100 | 191.67 |      0 |     20 | 79.05 | 13.87 |
| 653510301 |     0.65 | 6.256892 | 0.08 | 0.07 |      5 |    0 |     0 |       2.3 |    0 |    0 |        2.2 | 0.35 |    0 |     0.1 |      2 | 0 | 0 |     3 |    0 |    0 |  700 |      0 |      0 |     80 |     0 | 41.95 |
| 653510401 |     0.09 | 6.011134 | 0.06 | 0.03 |      5 | 2.59 |     0 |       2.2 |    0 |    0 |          2 |    0 |    0 |     0.2 |      2 | 0 | 0 |     2 |    0 | 0.02 |  480 |  48.67 | 218.72 |     50 | 11.61 | 26.76 |
| 653510501 |     1.64 |  6.00742 | 0.02 | 0.07 |     19 |    0 | 14.42 |       2.5 |    0 |    0 |        1.8 |    0 |    0 |     0.8 |      1 | 0 | 0 |     3 |    0 |    0 |  400 |  18.20 |   3.44 |     20 | 14.67 | 18.22 |
| 653510601 |     1.69 | 5.906629 | 0.06 | 0.06 |      5 |    0 |     0 |         3 |    0 |  0.5 |        2.8 | 0.34 |    0 |     0.2 |      2 | 0 | 0 |     2 |    0 |    0 |  520 |      0 | 225.70 |     30 | 59.26 | 10.17 |


*2nd Fits - Individual OBS only - taking the lags to the ABS vals (to obtain 0 lag at high f) and some to higher frequencies  for shorter obs*

|      Data | ECM-Chi2 | ECM_logM |    + |    - | ECM-h2 |     + |     - | ECM-Gama1 | + |    - | ECM-Gamma2 |   + |   - | Delta-G | ECM-xi | + | - | ECM-b | + |    - | tmax |      + |      - | tshift |      + |     - |
| 110890201 |     0.08 | 6.034376 | 0.12 | 0.03 |      7 |     0 |   1.0 |       3.1 | 0 |    0 |        2.9 |   0 | 0.2 |     0.2 |      3 | 0 | 0 |     3 | 0 |    0 |  560 |   5.14 |  27.55 |     20 |   1.37 |  2.21 |
| 148010301 |     0.58 | 6.316628 | 0.06 | 0.06 |      4 |     0 |     0 |       2.2 | 0 |    0 |        1.9 |   0 |   0 |     0.2 |      1 | 0 | 0 |     3 | 0 |    0 |  500 | 207.49 |      0 |     50 |  42.92 | 21.54 |
| 506200201 |     1.00 | 6.179126 | 0.04 | 0.06 |     11 |     0 |     0 |       2.9 | 0 |    0 |        2.5 |   0 |   0 |     0.4 |      2 | 0 | 0 |     2 | 0 |    0 |  400 |      0 |      0 |     10 |      0 |     0 |
| 506200301 |     0.13 | 6.008443 | 0.14 | 0.10 |      8 |     0 |     0 |       2.8 | 0 |    0 |        2.4 |   0 |   0 |     0.4 |      3 | 0 | 0 |     3 | 0 |    0 |  250 |      0 |      0 |     50 |      0 | 40.34 |
| 506200401 |     0.55 | 6.094888 | 0.07 | 0.09 |      3 | 26.25 |     0 |       2.5 | 0 |    0 |        1.8 |   0 |   0 |     0.7 |      1 | 0 | 0 |     3 | 0 |    0 |  200 |      0 |      0 |    120 |      0 |     0 |
| 506200501 |     1.25 | 6.463244 | 0.02 | 0.07 |     13 |     0 |     0 |       2.7 | 0 |    0 |        2.2 |   0 |   0 |     0.5 |      0 | 0 | 0 |     3 | 0 |    0 |  400 |      0 |      0 |     20 |      0 |     0 |
| 511580101 |     0.28 | 5.895054 | 0.03 | 0.03 |     16 |     0 |     0 |       2.7 | 0 |    0 |        2.2 |   0 |   0 |     0.5 |      3 | 0 | 0 |     3 | 0 |    0 |  550 |      0 | 314.45 |     10 | 110.33 |     0 |
| 511580201 |     0.26 | 6.263942 | 0.05 | 0.08 |     19 |     0 |     0 |       2.8 | 0 |    0 |        1.7 |   0 |   0 |     1.1 |      2 | 0 | 0 |     1 | 0 |    0 |  200 |      0 |      0 |     30 |  90.14 |     0 |
| 511580301 |     0.95 | 6.322830 | 0.03 | 0.02 |     16 |     0 |  3.88 |       2.8 | 0 | 0.39 |        2.1 |   0 |   0 |     0.7 |      3 | 0 | 0 |     3 | 0 | 0.63 |  250 |   6.59 |   0.23 |     20 |   1.09 |  7.60 |
| 511580401 |     0.66 | 6.399108 | 0.05 | 0.02 |      3 |     0 |     0 |       2.6 | 0 |    0 |        2.4 |   0 |   0 |     0.2 |      1 | 0 | 0 |     3 | 0 |    0 |  300 |      0 |      0 |     50 |      0 | 47.76 |
| 554710801 |     1.53 | 5.768704 | 0.07 | 0.05 |     18 |     0 |     0 |       2.7 | 0 |    0 |        2.3 |   0 |   0 |     0.4 |      3 | 0 | 0 |     1 | 0 |    0 |  600 |      0 | 579.50 |    100 |      0 |     0 |
| 653510301 |     0.72 | 6.215645 | 0.09 | 0.06 |     12 |     0 |     0 |       2.0 | 0 |    0 |        1.7 |   0 |   0 |     0.3 |      2 | 0 | 0 |     3 | 0 |    0 |  700 |      0 |      0 |     80 |  41.11 | 50.90 |
| 653510401 |     0.22 | 5.885895 | 0.02 | 0.02 |     16 |     0 |     0 |       2.1 | 0 |    0 |        1.8 |   0 |   0 |     0.3 |      3 | 0 | 0 |     1 | 0 |    0 |  700 |  82.02 | 496.63 |     90 |  30.31 | 55.12 |
| 653510501 |     1.64 |  6.00742 | 0.02 | 0.07 |     19 |     0 | 14.42 |       2.5 | 0 |    0 |        1.8 |   0 |   0 |     0.8 |      1 | 0 | 0 |     3 | 0 |    0 |  400 |  18.20 |   3.44 |     20 |  14.67 | 18.22 |
| 653510601 |     0.51 | 5.992997 | 0.04 | 0.05 |      7 |     0 |     0 |         3 | 0 | 0.39 |        2.7 | 0.4 |   0 |     0.3 |      3 | 0 | 0 |     1 | 0 |    0 |  550 |      0 | 314.58 |     80 |      0 |     0 |

** *1H0707-495 Best fit plots and parameters* (at a glance)
*** OBS 110890201


#+BEGIN_EXAMPLE
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.514207e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.034376           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                7           0           0
  7  lag_freq(1).Gamma1     0     1              3.1           0           0
  8  lag_freq(1).Gamma2     0     1              2.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              560           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid 1H0707_0110890201_A
chi^2 = 8.285098e-02 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 7.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 3.100000e+00 (+0.000000e+00 -6.731786e-01)
Parameter Gamma2 = 2.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.600000e+02 (+0.000000e+00 -3.634727e+02)
Parameter t_shift = 2.000000e+01 (+0.000000e+00 -0.000000e+00)


lag_freq(1).log_mass,6.034376e+00,+1.159044e-01,-2.871615e-02
 Parameter 2 = 6.034376e+00 (6.005660e+00 - 6.150281e+00)


Pull into dir: /home/steff075/phd_ecm/results-ecm/1H0707_plots

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/best-fit-plots/1H0707_0110890201_A_best_fit.png .
#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_A_best_fit.png

*** OBS 148010301

#+BEGIN_EXAMPLE
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.948793e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.316628           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0


Obsid 1H0707_0148010301_A
chi^2 = 5.841070e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.000000e+02 (+2.074945e+02 -0.000000e+00)
Parameter t_shift = 5.000000e+01 (+4.291827e+01 -2.154183e+01)

lag_freq(1).log_mass,6.316628e+00,+5.792293e-02,-5.775432e-02
  Parameter 2 = 6.316628e+00 (6.258873e+00 - 6.374551e+00)

#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0148010301_A_best_fit.png

*** OBS 506200201

#+BEGIN_EXAMPLE
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.473539e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.179126           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               11           0           0
  7  lag_freq(1).Gamma1     0     1              2.9           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0


Obsid 1H0707_0506200201_A
chi^2 = 9.997359e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.100000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 1.000000e+01 (+0.000000e+00 -0.000000e+00)
#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_A_best_fit.png

*** OBS 506200301

#+BEGIN_EXAMPLE
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.599124e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.008443           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                8           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0


Obsid 1H0707_0506200301_A
chi^2 = 1.294163e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 8.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.500000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 5.000000e+01 (+0.000000e+00 -4.033783e+01)

lag_freq(1).log_mass,6.008443e+00,+1.388863e-01,-1.037775e-01
  Parameter 2 = 6.008443e+00 (5.904665e+00 - 6.147329e+00)
#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200301_A_best_fit.png

*** OBS 506200401

#+BEGIN_EXAMPLE
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.497609e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.094888           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1              120           0           0


Obsid 1H0707_0506200401_A
chi^2 = 5.543405e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+2.672511e+01 -0.000000e+00)
Parameter Gamma1 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 1.200000e+02 (+0.000000e+00 -0.000000e+00)

lag_freq(1).log_mass,6.094888e+00,+6.792075e-02,-9.292543e-02
  Parameter 2 = 6.094888e+00 (6.001962e+00 - 6.162809e+00)
#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200401_A_best_fit.png

*** OBS 506200501

#+BEGIN_EXAMPLE
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.030306e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.463244           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               13           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid 1H0707_0506200501_A
chi^2 = 1.248540e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.300000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 2.000000e+01 (+0.000000e+00 -0.000000e+00)

lag_freq(1).log_mass,6.463244e+00,+2.135971e-02,-6.843029e-02
  Parameter 2 = 6.463244e+00 (6.394813e+00 - 6.484603e+00)

#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200501_A_best_fit.png

*** OBS 511580101

#+BEGIN_EXAMPLE
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.833204e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         5.895054           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               16           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              550           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0


Obsid 1H0707_0511580101_A
chi^2 = 2.751007e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.600000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.500000e+02 (+0.000000e+00 -3.144054e+02)
Parameter t_shift = 1.000000e+01 (+1.103258e+02 -0.000000e+00)

lag_freq(1).log_mass,5.895054e+00,+2.588629e-02,-2.867923e-02
  Parameter 2 = 5.895054e+00 (5.866374e+00 - 5.920940e+00)


#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580101_A_best_fit.png

*** OBS 511580201

#+BEGIN_EXAMPLE
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.083867e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.263942           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               19           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0


Obsid 1H0707_0511580201_A
chi^2 = 2.615454e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.900000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 3.000000e+01 (+9.013741e+01 -0.000000e+00)

lag_freq(1).log_mass,6.263942e+00,+5.212072e-02,-8.150736e-02
  Parameter 2 = 6.263942e+00 (6.182434e+00 - 6.316062e+00)
#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580201_A_best_fit.png

*** OBS 511580301

#+BEGIN_EXAMPLE
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.159426e-05           0       0.001
  2  lag_freq(1).log_mass   0     0          6.32283           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               16           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid 1H0707_0511580301_A
chi^2 = 9.456217e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.600000e+01 (+0.000000e+00 -3.883569e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -3.877714e-01)
Parameter Gamma2 = 2.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -6.329429e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.500000e+02 (+6.592136e+00 -2.310952e+01)
Parameter t_shift = 2.000000e+01 (+1.091915e+00 -7.600202e+00)

lag_freq(1).log_mass,6.322830e+00,+3.361650e-02,-2.201713e-02
  Parameter 2 = 6.322830e+00 (6.300813e+00 - 6.356446e+00)
#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580301_A_best_fit.png

*** OBS 511580401

#+BEGIN_EXAMPLE
ag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.370748e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.399108           6         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0


Obsid 1H0707_0511580401
chi^2 = 6.636144e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 5.000000e+01 (+0.000000e+00 -4.775975e+01)

lag_freq(1).log_mass,6.399108e+00,+5.350087e-02,-2.419227e-02
#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580401_best_fit.png

*** OBS 554710801

#+BEGIN_EXAMPLE
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.116299e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         5.768704           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               18           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              600           0           0
 15  lag_freq(1).t_shift    0     1              100           0           0

Obsid 1H0707_0554710801
chi^2 = 1.531615e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.800000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.000000e+02 (+0.000000e+00 -5.795039e+02)
Parameter t_shift = 1.000000e+02 (+0.000000e+00 -0.000000e+00)

lag_freq(1).log_mass,5.904735e+00,+7.237250e-02,-4.544327e-02
  Parameter 2 = 5.904735e+00 (5.859292e+00 - 5.977108e+00)
#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0554710801_best_fit.png

*** OBS 653510301

#+BEGIN_EXAMPLE

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     9.977636e-06           0       0.001
  2  lag_freq(1).log_mass   0     0         6.215645           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               12           0           0
  7  lag_freq(1).Gamma1     0     1                2           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              700           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0

Obsid 1H0707_0653510301_A
chi^2 = 7.225035e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.200000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 7.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 8.000000e+01 (+4.111475e+01 -5.089704e+01)

lag_freq(1).log_mass,6.215645e+00,+9.981428e-02,-5.576864e-02
  Parameter 2 = 6.215645e+00 (6.159876e+00 - 6.315459e+00)


#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510301_A_best_fit.png

*** OBS 653510401

#+BEGIN_EXAMPLE
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.884462e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         5.885895           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               16           0           0
  7  lag_freq(1).Gamma1     0     1              2.1           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              700           0           0
 15  lag_freq(1).t_shift    0     1               90           0           0


Obsid 1H0707_0653510401_A
chi^2 = 2.235630e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.600000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 7.000000e+02 (+8.202318e+01 -4.966338e+02)
Parameter t_shift = 9.000000e+01 (+3.030681e+01 -5.512524e+01)

lag_freq(1).log_mass,5.885895e+00,+1.967116e-02,-2.222450e-02
  Parameter 2 = 5.885895e+00 (5.863671e+00 - 5.905566e+00)
#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510401_A_best_fit.png

*** OBS 653510501

#+BEGIN_EXAMPLE

#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/

*** OBS 653510601

#+BEGIN_EXAMPLE
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.536946e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         5.992997           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                7           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              550           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0

Obsid 1H0707_0653510601_A
chi^2 = 5.088582e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 7.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 3.000000e+00 (+0.000000e+00 -3.944674e-01)
Parameter Gamma2 = 2.700000e+00 (+4.025510e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.500000e+02 (+0.000000e+00 -3.145839e+02)
Parameter t_shift = 8.000000e+01 (+0.000000e+00 -0.000000e+00)

lag_freq(1).log_mass,5.992997e+00,+3.634065e-02,-4.675688e-02
  Parameter 2 = 5.992997e+00 (5.946240e+00 - 6.029338e+00)

#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510601_A_best_fit.png

** *Various plots of fits*

PATH = =/home/steff075/phd_ecm/results-for-all/emcee/plot_ecm_pars.py=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-ecm-pars.png


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-ecm-tshift-tmax.png


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-ecm-h2-tshift-tmax.png


*VARIABLE MASS Fits (as above) plus some FIXED MASS investigation*

PATH to data =
=home/steff075/phd_ecm/results-ecm/1H0707-495_results_ecm_fits.ods=
(also in csv format).

 The csv file can be downloaded from [[http://www.star.bris.ac.uk/steff/ecm/1H0707-495_results_complete.csv][here]]

|              Data | ECM-Chi2 | ECM_logM | ECM-h2 |    + |    - | ECM-Gama1 |     + |    - | ECM-Gamma2 |     + |    - | Delta-G | ECM-xi |    + |    - | ECM-b |    + |    - | tmax |      + |      - | tshift |     + |     - |
|       1H0707-comb |     2.04 | 6.027921 |      3 | 0.03 | 0.19 |         3 |     0 |    0 |        2.9 |     0 | 0.19 |     0.1 |      3 |    0 |    0 |     2 |    0 |    0 |  569 |      0 |  48.52 |     91 | 10.06 |     0 |
|       1H0707-comb |     2.05 | 6.03f    |      3 | 2.71 |    0 |         3 |     0 |    0 |        2.9 |     0 |    0 |     0.1 |      3 |    0 |    0 |     2 | 0.92 | 1.99 |  570 |  40.51 |  43.62 |     90 |  4.42 | 19.01 |
|       1H0707-comb |     4.65 | 6.1f     |      4 | 1.93 |    0 |         3 |     0 | 0.14 |        2.8 |  0.34 |    0 |     0.2 |      0 |    0 |    0 |     0 | 0.57 | 0.98 |  350 |   41.7 |      0 |     70 |  5.75 | 38.79 |
|       1H0707-comb |     5.68 | 6.15f    |      3 | 1.84 |    0 |         3 |  0.09 | 0.16 |        2.8 |  0.09 |    0 |     0.2 |      3 |    0 | 0.29 |     1 | 0.73 | 0.98 |  300 |  76.86 |      0 |     60 |  7.29 | 12.17 |
|                   |          |          |        |      |      |           |       |      |            |       |      |         |        |      |      |       |      |      |      |        |        |        |       |       |
|         1H0707-hi |     3.34 | 5.943525 |      4 |    0 |    0 |       1.7 |     0 |    0 |        1.4 |     0 |    0 |     0.3 |      1 |    0 |    0 |     1 |    0 |    0 |  490 |      0 | 206.32 |     65 |     0 |  7.97 |
|         1H0707-hi |     3.58 | 6.03f    |      5 | 1.83 |    0 |         2 |     0 |  0.5 |        1.6 |  0.18 |  0.5 |     0.4 |      0 |    0 |    0 |     1 | 1.05 |    0 |  400 |  46.52 |  40.87 |     55 |  0.47 |  1.86 |
|         1H0707-hi |      3.8 | 6.1f     |      4 | 0.82 |    0 |         2 |     0 |  0.2 |        1.6 |  0.17 |    0 |     0.4 |      0 |    0 |    0 |     1 | 1.38 |    0 |  350 |  27.33 |   6.76 |     50 |  0.27 |  1.76 |
|         1H0707-hi |     4.97 | 6.15     |      3 | 1.44 |    0 |       2.4 |     0 | 0.61 |        2.1 |  0.26 |    0 |     0.3 |      2 |    0 |    0 |     1 | 1.79 |    0 |  300 |  38.41 |  60.67 |     40 |  5.39 |  5.49 |
|                   |          |          |        |      |      |           |       |      |            |       |      |         |        |      |      |       |      |      |      |        |        |        |       |       |
|  1H0707-hi-cts>20 |     2.43 | 5.938911 |      5 |    0 |    0 |       1.9 |     0 |    0 |        1.6 |     0 |    0 |     0.3 |      0 |    0 |    0 |     1 | 0.81 |    0 |  500 |      0 | 168.65 |     90 |     0 | 72.19 |
|  1H0707-hi-cts>20 |      2.6 | 6.03f    |      3 | 4.64 |    0 |       1.9 |     0 |    0 |        1.6 |     0 |    0 |     0.3 |      0 |    0 |    0 |     1 | 0.56 |    0 |  400 |  77.48 |  68.61 |     70 | 11.22 | 12.41 |
|  1H0707-hi-cts>20 |     3.47 | 6.1f     |      6 |    0 |    0 |       1.8 |     0 |    0 |        1.4 |     0 |    0 |     0.4 |      3 |    0 |    0 |     1 | 0.85 |    0 |  320 |   0.19 |    4.9 |     60 |  7.98 | 14.08 |
|  1H0707-hi-cts>20 |     2.86 | 6.15     |      4 | 5.77 |    0 |       2.1 |     0 | 0.35 |        1.8 |  0.36 |    0 |     0.3 |      3 |    0 |    0 |     1 | 0.67 |    0 |  300 |   0.19 |  34.77 |     55 |  7.22 |  14.4 |
|                   |          |          |        |      |      |           |       |      |            |       |      |         |        |      |      |       |      |      |      |        |        |        |       |       |
|        1H0707-med |     0.27 | 5.918436 |      6 |    0 | 2.16 |       2.8 |     0 |    0 |        2.4 |     0 |    0 |     0.4 |      2 |    0 |    0 |     2 |    0 |    0 |  100 |   0.46 |   1.54 |     60 |  0.23 |  0.77 |
|        1H0707-med |     0.36 | 6.03f    |      5 |    0 | 1.15 |       2.8 |     0 |    0 |        2.4 |     0 |    0 |     0.4 |      3 |    0 |    0 |     2 |    0 |    0 |  800 |  11.09 |  28.03 |     50 |  5.28 | 15.19 |
|        1H0707-med |      0.5 | 6.1f     |      4 |    0 | 0.15 |       2.8 |     0 |    0 |        2.4 |     0 |    0 |     0.4 |      3 |    0 |    0 |     2 |    0 |    0 |   60 |  31.11 |   0.86 |     50 |  5.43 | 23.53 |
|        1H0707-med |      0.3 | 6.15f    |      3 |    0 |    0 |       2.8 |     0 |    0 |        2.3 |     0 |    0 |     0.5 |      3 |    0 |    0 |     2 |    0 |    0 |   70 |  21.03 |  25.82 |     30 | 25.41 | 28.29 |
|                   |          |          |        |      |      |           |       |      |            |       |      |         |        |      |      |       |      |      |      |        |        |        |       |       |
|         1H0707-lo |     1.68 | 6.171217 |      5 |    0 | 1.19 |         3 |     0 |    0 |        2.6 |  0.21 |    0 |     0.4 |      0 | 1.16 |    0 |     1 |    0 |    0 |  230 | 110.77 |  76.91 |     10 |  9.13 |     0 |
|         1H0707-lo |      6.6 | 6.03f    |      9 |    0 | 0.14 |       3.2 |     0 | 0.48 |          3 |     0 |    0 |     0.2 |      1 |    0 |    0 |     2 |    0 |    0 |  600 |      0 |  26.72 |     30 | 23.91 | 25.72 |
|         1H0707-lo |        3 | 6.1f     |      7 |    0 | 1.74 |         3 |     0 | 0.26 |        2.7 |     0 |    0 |     0.3 |      0 |    0 |    0 |     1 | 0.97 |    0 |  300 |  43.81 |  55.79 |     20 |  8.34 |     0 |
|         1H0707-lo |     1.65 | 6.15f    |      6 | 0.99 | 1.69 |       3.3 |     0 | 0.59 |        2.9 |  0.09 |    0 |     0.4 |      1 |    0 |    0 |     1 |    0 |    0 |  250 |  87.51 | 138.31 |     10 |  9.98 |     0 |
|                   |          |          |        |      |      |           |       |      |            |       |      |         |        |      |      |       |      |      |      |        |        |        |       |       |
| 1H-0707-lo-cts<20 |     0.95 | 6.258479 |      5 |    0 |    0 |         3 |   0.1 |    0 |        2.6 |  0.22 |    0 |     0.4 |      0 |    0 |      |     2 |    0 |    0 |  210 |  36.55 |      0 |     17 |  3.38 | 15.94 |
| 1H-0707-lo-cts<20 |     4.69 | 6.03f    |      6 | 1.09 |    0 |       2.9 |     0 |    0 |        2.6 |     0 |    0 |     0.3 |      3 |    0 |    0 |     1 |    0 |    0 |  300 |      0 |    4.2 |     20 |  0.09 |   0.7 |
| 1H-0707-lo-cts<20 |     2.64 | 6.1f     |      6 | 1.14 |    0 |       3.1 |     0 |    0 |        2.7 |     0 |    0 |     0.4 |      3 |    0 |    0 |     3 |    0 |    0 |  300 |      0 |  43.95 |     10 |  5.74 |     0 |
| 1H-0707-lo-cts<20 |     2.43 | 6.15f    |      6 |    0 |    0 |       2.7 |  0.48 |    0 |        2.4 |  0.48 |    0 |     0.3 |      3 |    0 |    0 |     1 |    0 |    0 |  270 |  139.7 |   47.6 |     30 | 23.01 |  5.97 |
|                   |          |          |        |      |      |           |       |      |            |       |      |         |        |      |      |       |      |      |      |        |        |        |       |       |
|         110890201 |      1.7 | 6.074621 |      7 |    0 |    0 |       3.2 |     0 |    0 |          3 |  0.18 |    0 |     0.2 |      3 |    0 |    0 |     3 |    0 |    0 |  560 |      0 |   4.14 |     20 |  1.37 |  3.63 |
|         110890201 |     2.83 | 6.03f    |     10 |    0 | 3.52 |       3.2 |     0 |    0 |          3 |     0 |    0 |     0.2 |      2 |    0 |    0 |     3 |    0 |    0 |  600 |      0 |  45.59 |     30 | 23.22 |  3.45 |
|         110890201 |     2.29 | 6.1f     |      6 |    0 | 1.74 |       3.3 |     0 |    0 |        3.1 |  0.09 |    0 |     0.2 |      2 |    0 |    0 |     3 |    0 |    0 |  500 |   2.91 |   7.08 |     20 |  1.45 |  3.54 |
|         110890201 |     2.52 | 6.15f    |      7 |    0 | 3.65 |       3.3 |     0 |    0 |        3.1 |  0.09 |    0 |     0.2 |      1 |    0 |    0 |     3 |    0 |    0 |  500 |   2.98 |      7 |     30 |  9.04 |   3.5 |
|                   |          |          |        |      |      |           |       |      |            |       |      |         |        |      |      |       |      |      |      |        |        |        |       |       |
|         148010301 |     0.96 | 6.20887  |      5 |    0 |    0 |       2.4 |  0.71 |    0 |        2.2 |  0.75 |    0 |     0.2 |      2 |    0 |    0 |     3 |    0 |    0 |  700 |      0 |      0 |     60 | 43.59 | 57.48 |
|         148010301 |     2.88 | 6.03f    |      6 |    0 |    0 |       2.8 |     0 |    0 |        2.5 |     0 |    0 |     0.3 |      3 |    0 |    0 |     2 |    0 |    0 |  150 | 455.43 |      0 |     90 |     0 |     0 |
|         148010301 |      1.3 | 6.1f     |      5 |    0 |    0 |       2.2 |     0 |    0 |          2 |     0 |    0 |     0.2 |      1 |    0 |    0 |     3 |    0 |    0 |  800 |      0 |  40.36 |     80 | 20.74 | 72.98 |
|         148010301 |     0.98 | 6.15f    |      5 |    0 |    0 |       2.2 |     0 |    0 |          2 |     0 |    0 |     0.2 |      2 |    0 |    0 |     3 |    0 |    0 |  800 |      0 |  40.58 |     70 | 20.93 | 66.17 |
|                   |          |          |        |      |      |           |       |      |            |       |      |         |        |      |      |       |      |      |      |        |        |        |       |       |
|         506200201 |     1.16 | 6.154736 |      5 |    0 |    0 |         3 |     0 |    0 |        2.9 |     0 |    0 |     0.1 |      0 |    0 |    0 |     1 |    0 |    0 |  500 |      0 |      0 |     85 |     0 |  31.6 |
|         506200201 |     2.62 | 6.03f    |     10 |    0 | 3.88 |       2.8 |     0 |    0 |        2.5 |     0 |    0 |     0.3 |      0 |    0 |    0 |     1 |    0 |    0 |  400 |  34.25 |  33.76 |     20 | 29.65 |     0 |
|         506200201 |     1.19 | 6.1f     |      8 |    0 | 3.87 |         3 |     0 |    0 |        2.9 |     0 |    0 |     0.1 |      2 |    0 |    0 |     1 |    0 |    0 |  540 |  99.12 |    339 |     90 | 12.92 |  1.17 |
|         506200201 |     1.18 | 6.15f    |      6 |    0 | 2.94 |       2.9 |     0 |    0 |        2.8 |     0 |    0 |     0.1 |      3 |    0 |    0 |     1 |    0 |    0 |  500 | 120.65 | 312.64 |     80 |     0 | 14.45 |
|                   |          |          |        |      |      |           |       |      |            |       |      |         |        |      |      |       |      |      |      |        |        |        |       |       |
|         506200301 |     1.35 | 6        |      3 |    0 |    0 |       2.5 |     0 |    0 |        2.3 |     0 |    0 |     0.2 |      3 |    0 |    0 |     3 |    0 |    0 |  250 |      0 |      0 |     80 | 35.34 | 77.88 |
|         506200301 |     1.35 | 6.03f    |      6 |    0 |    0 |       2.9 |     0 |    0 |        2.6 |     0 |    0 |     0.3 |      3 |    0 |    0 |     3 |    0 |    0 |  220 |      0 |    151 |     70 | 40.18 |    25 |
|         506200301 |     1.44 | 6.1f     |      4 |    0 |    0 |       2.6 |     0 |    0 |        2.3 |     0 |    0 |     0.3 |      2 |    0 |    0 |     1 |    0 |    0 |  100 |      0 |   29.4 |     70 | 30.69 |  35.1 |
|         506200301 |     1.41 | 6.15f    |     10 |    0 |    0 |       2.8 |     0 |    0 |        2.2 |     0 |    0 |     0.6 |      1 |    0 |    0 |     2 |    0 |    0 |  120 |      0 |   45.4 |     50 | 41.21 | 49.94 |
|                   |          |          |        |      |      |           |       |      |            |       |      |         |        |      |      |       |      |      |      |        |        |        |       |       |
|         506200401 |      1.1 | 6.126042 |      3 |    0 |    0 |       2.6 |     0 |    0 |          2 |  0.84 |    0 |     0.6 |      0 |    0 |    0 |     1 |    0 |    0 |  600 |      0 |      0 |    110 |     0 |     0 |
|         506200401 |     1.59 | 6.03f    |      5 |    0 |    0 |       2.8 |     0 |    0 |        1.9 |     0 |    0 |     0.9 |      1 |    0 |    0 |     1 |    0 |    0 |  600 |   8.11 | 413.18 |    120 |     0 |  4.19 |
|         506200401 |     1.15 | 6.1f     |      3 |    0 |    0 |       2.4 |     0 |    0 |        1.7 |     0 |    0 |     0.7 |      0 |    0 |    0 |     1 |    0 |    0 |  600 |   7.89 | 499.54 |    110 |  0.78 |     0 |
|         506200401 |     1.13 | 6.15     |      3 |    0 |    0 |       2.8 |     0 |    0 |        2.3 |     0 |    0 |     0.5 |      3 |    0 |    0 |     1 |    0 |    0 |  600 |   7.88 | 491.16 |    105 |  5.79 |     0 |
|                   |          |          |        |      |      |           |       |      |            |       |      |         |        |      |      |       |      |      |      |        |        |        |       |       |
|         506200501 |     1.27 | 6.471828 |      3 |    0 |    0 |         3 |  0.06 |    0 |        1.7 |  1.13 |    0 |     1.3 |      3 |    0 |    0 |     2 |    0 |    0 |  350 |      0 | 241.21 |    120 |     0 |     0 |
|         506200501 |     2.19 | 6.03f    |      5 | 4.73 |    0 |       2.8 |     0 |    0 |          2 |     0 |    0 |     0.8 |      1 |    0 |    0 |     1 |    0 |    0 |  700 |      0 | 253.77 |      0 | 65.91 |     0 |
|         506200501 |     2.23 | 6.1f     |      3 |    0 |    0 |       2.6 |     0 |    0 |        2.2 |     0 |    0 |     0.4 |      3 |    0 |    0 |     1 |    0 |    0 |  600 |      0 | 225.78 |     10 | 79.97 |     0 |
|         506200501 |     2.15 | 6.15     |      3 |    0 |    0 |       2.4 |     0 |    0 |        1.7 |     0 |    0 |     0.7 |      0 |    0 |    0 |     1 |    0 |    0 |  600 |      0 | 298.68 |     10 |     0 |     0 |
|                   |          |          |        |      |      |           |       |      |            |       |      |         |        |      |      |       |      |      |      |        |        |        |       |       |
|         511580101 |     0.24 | 6.249992 |      6 |    0 |    0 |       2.6 |     0 |    0 |        2.2 |     0 |    0 |     0.4 |      1 |    0 |    0 |     2 |    0 |    0 |  250 | 434.73 |  72.45 |     20 | 99.13 |     0 |
|         511580101 |     0.29 | 6.03f    |      7 |    0 |    0 |       2.7 |     0 |    0 |        2.4 |     0 |    0 |     0.3 |      0 |    0 |    0 |     2 |    0 |    0 |  400 | 244.84 | 124.62 |     20 | 90.08 |     0 |
|         511580101 |     0.50 | 6.1f     |      4 |    0 |    0 |       2.4 |     0 |    0 |        2.1 |     0 |    0 |     0.3 |      0 |    0 |    0 |     2 |    0 |    0 |  350 | 222.48 | 142.81 |     20 | 78.28 |     0 |
|         511580101 |     0.45 | 6.15f    |      4 |    0 |    0 |       2.5 |     0 |    0 |        2.2 |     0 |    0 |     0.3 |      3 |    0 |    0 |     2 |    0 |    0 |  300 | 201.67 |  83.47 |     15 | 72.03 |     0 |
|                   |          |          |        |      |      |           |       |      |            |       |      |         |        |      |      |       |      |      |      |        |        |        |       |       |
|         511580201 |     1.25 | 6.397703 |      8 |    0 |    0 |       2.8 |  0.28 |  0.4 |          2 |     0 |    0 |     0.8 |      1 |    0 |    0 |     1 |    0 |    0 |  150 | 313.42 |      0 |     30 | 64.62 | 27.31 |
|         511580201 |     2.86 | 6.03f    |     10 |    0 |    0 |       2.8 |     0 |    0 |        2.2 |     0 |    0 |     0.6 |      2 |    0 |    0 |     3 |    0 |  1.1 |  150 |  93.44 |  28.99 |     90 | 10.63 | 26.18 |
|         511580201 |     2.87 | 6.1f     |     10 |    0 |    0 |       2.4 |     0 |    0 |        1.7 |     0 |    0 |     0.7 |      3 |    0 |    0 |     3 |    0 | 1.22 |  150 |  59.61 |      0 |     70 | 22.85 |  1.13 |
|         511580201 |     2.91 | 6.15f    |     10 |    0 |    0 |       2.3 |     0 |    0 |        1.7 |     0 |    0 |     0.6 |      3 |    0 |    0 |     3 |    0 |    0 |  100 |  107.3 |      0 |     80 | 11.89 | 31.65 |
|                   |          |          |        |      |      |           |       |      |            |       |      |         |        |      |      |       |      |      |      |        |        |        |       |       |
|         511580301 |     3.43 | 6.182876 |     10 |    0 | 2.82 |         3 | 0.002 | 0.43 |        2.7 | 0.006 | 0.22 |     0.3 |      3 |    0 |  0.2 |     3 |    0 | 0.21 |  400 |  11.63 |  25.12 |     30 |  7.04 | 18.61 |
|         511580301 |     7.67 | 6.03f    |      8 |    0 | 3.12 |       2.9 |  0.29 | 0.18 |        2.7 |     0 | 0.12 |     0.2 |      2 |    0 |    0 |     3 |    0 | 1.15 |  600 |  31.13 | 147.46 |     50 |  9.42 | 14.26 |
|         511580301 |     7.46 | 6.1f     |     10 |    0 | 1.03 |       2.8 |     0 |    0 |        2.5 |     0 | 0.03 |     0.3 |      0 |    0 |    0 |     2 |    0 |  0.3 |  400 | 129.35 |   8.06 |     35 | 15.38 | 11.84 |
|         511580301 |     5.95 | 6.15f    |      9 |    0 |    1 |         3 |  0.17 | 0.23 |        2.7 |     0 | 0.23 |     0.3 |      0 |    0 |    0 |     3 |    0 | 1.68 |  400 |   62.5 |   4.49 |     35 |  7.87 |  7.25 |
|                   |          |          |        |      |      |           |       |      |            |       |      |         |        |      |      |       |      |      |      |        |        |        |       |       |
|         511580401 |     0.66 | 6.399108 |      3 |    0 |    0 |       2.6 |     0 |    0 |        2.4 |     0 |    0 |     0.2 |      1 |    0 |    0 |     3 |    0 |    0 |  300 |      0 |      0 |     50 |     0 | 47.76 |
|         511580401 |     0.84 | 6.03f    |      6 |    0 |    0 |       2.6 |     0 | 0.38 |        2.3 |     0 |    0 |     0.3 |      3 |    0 |    0 |     3 |    0 |    0 |  420 |      0 | 315.22 |     80 |     0 |  5.96 |
|         511580401 |     0.92 | 6.1f     |      4 |    0 |    0 |       2.5 |     0 | 0.28 |        2.2 |     0 |    0 |     0.3 |      3 |    0 |    0 |     3 |    0 |    0 |  350 | 336.98 | 218.95 |     70 |     0 |  5.42 |
|         511580401 |     0.93 | 6.15f    |     10 |    0 |    0 |       2.5 |     0 |    0 |        2.2 |     0 |    0 |     0.3 |      3 |    0 |    0 |     1 |    0 |    0 |  250 | 421.17 |      0 |     70 |     0 | 13.39 |
|                   |          |          |        |      |      |           |       |      |            |       |      |         |        |      |      |       |      |      |      |        |        |        |       |       |
|         653510301 |     0.65 | 6.256892 |      5 |    0 |    0 |       2.3 |     0 |    0 |        2.2 |  0.35 |    0 |     0.1 |      2 |    0 |    0 |     3 |    0 |    0 |  700 |      0 |      0 |     80 |     0 | 41.95 |
|         653510301 |     2.15 | 6.03f    |      3 |    0 |    0 |       2.4 |     0 |    0 |        2.3 |  0.23 |    0 |     0.1 |      2 |    0 |    0 |     1 |    0 |    0 |  280 | 265.22 | 177.12 |    120 |     0 | 48.62 |
|         653510301 |     0.53 | 6.1f     |      4 | 3.13 |    0 |       2.1 |     0 |    0 |        1.9 |  0.48 |    0 |     0.2 |      3 |    0 |    0 |     2 |    0 | 0.16 |  400 |  105.2 |  59.16 |     40 | 10.23 |  5.26 |
|         653510301 |      1.7 | 6.15f    |     10 |    0 |    0 |       2.5 |     0 |    0 |        2.3 |     0 |    0 |     0.2 |      1 |    0 |    0 |     1 |    0 |    0 |  150 | 293.42 |   3.24 |    120 |     0 | 54.31 |
|                   |          |          |        |      |      |           |       |      |            |       |      |         |        |      |      |       |      |      |      |        |        |        |       |       |
|         653510401 |     0.09 | 6.011134 |      5 | 2.59 |    0 |       2.2 |     0 |    0 |          2 |     0 |    0 |     0.2 |      2 |    0 |    0 |     2 |    0 | 0.02 |  480 |  48.67 | 218.72 |     50 | 11.61 | 26.76 |
|         653510401 |     0.32 | 6.03f    |      3 | 4.32 |    0 |       2.1 |     0 |    0 |        1.9 |  0.38 |    0 |     0.2 |      0 |    0 |    0 |     2 |    0 | 0.02 |  450 |      0 |  74.75 |     50 |   7.9 |  3.38 |
|         653510401 |     0.53 | 6.1f     |      4 | 3.13 |    0 |       2.1 |     0 |    0 |        1.9 |  0.48 |    0 |     0.2 |      3 |    0 |    0 |     2 |    0 | 0.16 |  400 |  105.2 |  59.16 |     40 | 10.23 |  5.26 |
|         653510401 |     1.32 | 6.15f    |      3 | 3.55 |    0 |         2 |     0 |    0 |        1.8 |  0.55 |    0 |     0.2 |      3 |    0 |    0 |     3 |    0 | 1.09 |  450 | 121.17 | 159.71 |     40 |  6.99 |  1.08 |
|                   |          |          |        |      |      |           |       |      |            |       |      |         |        |      |      |       |      |      |      |        |        |        |       |       |
|         653510501 |     5.79 | 6.08472  |      6 |    0 |    0 |       2.8 |  0.23 |    0 |        2.5 |  0.29 |    0 |     0.3 |      3 |    0 |    0 |     3 |    0 | 1.13 |  300 |  23.57 | 190.76 |     20 | 18.89 | 18.57 |
|         653510501 |     7.39 | 6.03f    |     10 |    0 | 3.09 |       2.9 |     0 | 0.86 |        2.6 |     0 |    0 |     0.3 |      3 |    0 |    0 |     3 |    0 |    0 |  400 |  21.91 |  12.73 |     20 |  23.5 |  17.9 |
|         653510501 |     6.29 | 6.1f     |      6 |    0 | 1.96 |       2.8 |     0 |  0.7 |        2.5 |  0.27 |    0 |     0.3 |      3 |    0 |    0 |     3 |    0 |    0 |  290 |  39.78 | 116.22 |     20 | 15.16 | 17.49 |
|         653510501 |     7.38 | 6.15f    |      7 |    0 | 3.75 |       2.6 |     0 |    0 |        2.3 |     0 |    0 |     0.3 |      1 |    0 |    0 |     2 |    0 | 0.16 |  280 |  35.95 | 172.73 |     30 |  4.48 | 25.95 |
|                   |          |          |        |      |      |           |       |      |            |       |      |         |        |      |      |       |      |      |      |        |        |        |       |       |
|         653510601 |     2.34 | 6.001751 |      3 | 5.49 |    0 |       2.8 |     0 |    0 |        2.6 |     0 |    0 |     0.2 |      3 |    0 |    0 |     1 |    0 |    0 |  410 | 278.43 | 150.03 |     40 |  43.2 | 32.19 |
|         653510601 |     2.58 | 6.03f    |      3 | 4.53 |    0 |       2.9 |     0 |    0 |        2.7 |     0 |    0 |     0.2 |      3 |    0 |    0 |     1 |    0 |    0 |  400 | 251.07 |  51.32 |     40 | 40.95 | 35.68 |
|         653510601 |     2.95 | 6.1f     |      3 | 2.06 |    0 |       2.6 |     0 |    0 |        2.3 |     0 |    0 |     0.3 |      0 |    0 |    0 |     3 |    0 |    0 |  350 |   9.66 |  83.92 |     20 | 43.93 | 19.03 |
|         653510601 |     4.41 | 6.15f    |      3 | 3.52 |    0 |         3 |     0 |    0 |        2.7 |     0 |    0 |     0.3 |      3 |    0 |    0 |     1 |    0 |    0 |  300 |  58.44 |  65.37 |     30 | 34.14 | 27.65 |
|                   |          |          |        |      |      |           |       |      |            |       |      |         |        |      |      |       |      |      |      |        |        |        |       |       |
|         554710801 |     1.78 | 6.190454 |      3 |    0 |    0 |         3 |  0.02 | 0.68 |        2.3 |     0 |    0 |     0.7 |      0 |    0 |    0 |     2 |    0 |    0 |  100 | 176.69 |      0 |     10 | 68.17 |  7.93 |
|         554710801 |     3.01 | 6.03f    |      6 |    0 |    0 |       2.7 |     0 |    0 |        2.3 |     0 |    0 |         |      3 |    0 |    0 |     2 |    0 |    0 |  100 | 175.13 |  38.98 |     60 | 28.83 | 54.37 |
|         554710801 |     1.88 | 6.1f     |      6 |    0 | 1.08 |       3.1 |     0 |    0 |        2.4 |     0 |    0 |     0.7 |      3 |    0 |    0 |     2 |    0 |    0 |  120 | 117.14 |  63.31 |     10 |   2.8 |  3.75 |
|         554710801 |     2.12 | 6.15f    |      4 |    0 |    0 |         3 |     0 |    0 |        2.2 |     0 |    0 |     0.8 |      0 |    0 |    0 |     2 |    0 |    0 |  100 | 185.87 |  21.23 |     10 |  4.47 |  3.68 |


*Note:* the old hi-flux lags were recalculated with slightly different
data as they were almost exactly identical to the combined lags (hence
the new hi flux).

Finally, the high and low lags were taken from the light curve plots
above and below 20 cts per sec to generate alternative hi and lo lags respectively.

-----------------------------------------------------------------------------------------



*** Lag Frequency fits for combinations

*Combined*


#+ATTR_HTML: :width 600
#+CAPTION: 1H0707-495 Combined best fit
http://www.star.bris.ac.uk/steff/ecm/1H0707_comb_best_fit_ecm.png


-----------------------------------------------------------------------------------------

*Hi flux (old)*

/(almost identical to the combined lags above, hence
new hi flux lags were calculated as shown below)/

#+ATTR_HTML: :width 600
#+CAPTION: 1H0707-495 Old High flux best fit
http://www.star.bris.ac.uk/steff/ecm/1H0707_hiflux_ecm.png

-----------------------------------------------------------------------------------------
*Hi flux (new)*

#+ATTR_HTML: :width 600
#+CAPTION: 1H0707-495 New High flux best fit
http://www.star.bris.ac.uk/steff/ecm/1H0707_hiflux_best_fit-1.png

-----------------------------------------------------------------------------------------
*Hi flux >20 cts $s^{-1}$*

These  lags were taken from the high counts (>20) light curves as seen
in the fill light curve plot graph below (as generated during the
timing analysis for this AGN):

#+ATTR_HTML: :width 1000
#+CAPTION: 1H0707-495 light curves (0.3 - 10 keV)
http://www.star.bris.ac.uk/steff/ecm/1H0707_multi_lc_plots_ALL.png

#+ATTR_HTML: :width 600
#+CAPTION: 1H0707-495 High cts (>20) best fit
http://www.star.bris.ac.uk/steff/ecm/1H0707_hi_cts_data_best_fit-1.png

-----------------------------------------------------------------------------------------
*Low-flux*
#+ATTR_HTML: :width 600
#+CAPTION: 1H0707-495 Low flux best fit
http://www.star.bris.ac.uk/steff/ecm/1H0707_loflux_best_fit.png


-----------------------------------------------------------------------------------------
*Lo flux <20 cts $s^{-1}$*

These  lags were taken from the low counts (<20) light curves as seen
in the fill light curve plot graph above:

#+ATTR_HTML: :width 600
#+CAPTION: 1H0707-495 Low cts (<20) best fit
http://www.star.bris.ac.uk/steff/ecm/1H0707_lo_cts_data_best_fit-1.png

-----------------------------------------------------------------------------------------

*Medium Flux*

#+ATTR_HTML: :width 600
#+CAPTION: 1H0707-495 Medium flux best fit
http://www.star.bris.ac.uk/steff/ecm/1H0707_medflux_best_fit-1.png

*** Luminosity and source height H2

PATH = =/home/steff075/phd_ecm/results-for-all/emcee/plot_ecm_pars.py=

IMPORTING =1H0707-495_results_single_obs.csv=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-ecm-h2-lumin.png


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-ecm-h2-lumin-2-10keV.png


*** Luminosity and time lag

PATH = =/home/steff075/phd_ecm/results-for-all/emcee/plot_ecm_pars.py=

IMPORTING =1H0707-495_results_single_obs.csv=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-ecm-lag-lumin.png

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-ecm-lag-lumin-2-10keV.png

*** Luminosity and model parameters

Use csv file =
=/home/steff075/phd_ecm/results-for-all/1H0707-495_reults_complete.ods
& csv=

PATH = =/home/steff075/phd_ecm/results-for-all/1H0707_LumVecm_pars.vsz=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_LumVecm_pars.png

*** Lag and model parameters

Use csv file =
=/home/steff075/phd_ecm/results-for-all/1H0707-495_reults_complete.ods
& csv=

PATH = =/home/steff075/phd_ecm/results-for-all/1H0707_lagVecm_pars.vsz=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_lagVecm_pars.png


*** T-max and model parameters

Use csv file =
=/home/steff075/phd_ecm/results-for-all/1H0707-495_reults_complete.ods
& csv=

PATH = =/home/steff075/phd_ecm/results-for-all/1H0707_tmaxVecm_pars.vsz=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_tmaxVecm_pars.png

*** T-shift and model parameters

Use csv file =
=/home/steff075/phd_ecm/results-for-all/1H0707-495_reults_complete.ods
& csv=

PATH = =/home/steff075/phd_ecm/results-for-all/1H0707_tshiftVecm_pars.vsz=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_tshiftVecm_pars.png




*** xi and model parameters

Use csv file =
=/home/steff075/phd_ecm/results-for-all/1H0707-495_reults_complete.ods
& csv=

PATH = =/home/steff075/phd_ecm/results-for-all/1H0707_xiVecm_pars.vsz=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_xiVecm_pars.png

*** b and model parameters

Use csv file =
=/home/steff075/phd_ecm/results-for-all/1H0707-495_reults_complete.ods
& csv=

PATH = =/home/steff075/phd_ecm/results-for-all/1H0707_bVecm_pars.vsz=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_bVecm_pars.png

PATH = =/home/steff075/phd_ecm/results-for-all/emcee/plot_ecm_pars.py=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-ecm-h2-b.png

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-ecm-Cvr-Frac-b.png

*** $\Delta \Gamma$ and model parameters

Use csv file =
=/home/steff075/phd_ecm/results-for-all/1H0707-495_reults_complete.ods
& csv=

PATH = =/home/steff075/phd_ecm/results-for-all/1H0707_dGVecm_pars.vsz=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_dGVecm_pars.png


*** $\Gamma_2$ and model parameters

Use csv file =
=/home/steff075/phd_ecm/results-for-all/1H0707-495_reults_complete.ods
& csv=

PATH = =/home/steff075/phd_ecm/results-for-all/1H0707_g2Vecm_pars.vsz=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_g2Vecm_pars.png

*** All $\Gamma$

PATH = =/home/steff075/phd_ecm/results-for-all/1H0707_G2VL_ecm.vsz=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_G2VL_ecm.png


PATH = =/home/steff075/phd_ecm/results-for-all/plot_ecm_pars.py=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-ecm-lag-gamma.png


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-ecm-h2-gamma.png


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-ecm-2-10klum-gamma.png

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-ecm-shift-gamma.png

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-ecm-tmax-gamma.png



*** T-shift and T-max

PATH = =/home/steff075/phd_ecm/results-for-all/1H0707_tshiftVtmax_ecm.vsz=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_tshiftVtmax_ecm.png

*** H2 and L

PATH = =/home/steff075/phd_ecm/results-for-all/1H0707_H2VL_ecm.vsz=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_H2VL_ecm.png


*** Pearson correlations for data



Correlate results

PATH = =/steff075/phd_ecm/resulkts-for-all/correlate-1H0707.py=

#+BEGIN_EXAMPLE
# Pearson correlation coefficient is a statistic that measures linear correlation between two variables
X and Y. It has a value between +1 and −1. A value of +1 is total positive linear correlation, 0 is no linear
correlation, and −1 is total negative linear correlation.

import pandas as pd

# Import the spreadsheet
df = pd.read_csv("1H0707-495_reults_complete.csv")
#df
# To find the correlation among the columns using pearson method
df.corr(method ='pearson')

#+END_EXAMPLE

Pearson correlation results

#+BEGIN_EXAMPLE

| Luminosity | and    | Lag        | =                    |     -0.52171796704292 |
| Luminosity | and    | L_bol      | =                    | -9.42632154623642e-17 |
| Luminosity | and    | Edd_ratio  | =                    |  9.42632154623642e-17 |
| Luminosity | and    | Flux       | =                    |    0.9999981839101415 |
| Luminosity | and    | Relx_F     | =                    |    0.9887760237139824 |
| Luminosity | and    | Ref_F      | =                    |    0.9683260430665731 |
| Luminosity | and    | Plaw_F     | =                    |    0.9988263090989488 |
| Luminosity | and    | Gamma_Relx | =                    |    0.7873772856170871 |
| Luminosity | and    | xi         | =                    |  -0.22392695741539062 |
| Luminosity | and    | Cvr        | =                    |   -0.3849129475392094 |
| Lag        | and    | Cvr        | =                    |    0.3093009242459401 |
| Relx_F     | and    | Plaw_F     | =                    |    0.9857886461828815 |
| Ref_F      | and    | Plaw_F     | =                    |     0.969753052969061 |
| Relx_F     | and    | Ref_F      | =                    |    0.9875855921998787 |
| Lag        | and    | Lag_freq   | =                    |   -0.2810853225392384 |
| Lag        | and    | ECM_H2     | =                    |    0.0304632919120835 |
| Lag        | and    | ECM_G1     | =                    |   0.23679643555671015 |
| Lag        | and    | ECM_G2     | =                    |   0.37644721744070136 |
| Lag        | and    | ECM_dG     | =                    |  -0.23667736194096592 |
| Lag        | and    | ECM_xi     | =                    |   -0.3173841190571499 |
| Lag        | and    | ECM_b      | =                    |  -0.17945287933026827 |
| Lag        | and    | ECM_tmax   | =                    |   0.12768259560065753 |
| Lag        | and    | ECM_tshift | =                    |   0.09643414740581764 |
| ECM_H2     | and    | ECM_G1     | =                    |    0.1797768947399774 |
| ECM_H2     | and    | ECM_G2     | =                    |   0.21395394944461854 |
| ECM_H2     | and    | ECM_dG     | =                    |  -0.07194489115259897 |
| ECM_H2     | and    | ECM_xi     | =                    |   0.13174491177761222 |
| ECM_H2     | and    | ECM_b      | =                    |   0.19192426882990488 |
| ECM_H2     | and    | ECM_tmax   | =                    |  -0.09456479752587221 |
| ECM_H2     | and    | ECM_tshift | =                    |  -0.45912703959039847 |
| ECM_G1     | and    | ECM_G2     | =                    |    0.7623683933242967 |
| ECM_G1     | and    | ECM_dG     | =                    |    0.2412528086308455 |
| ECM_G1     | and    | ECM_xi     | =                    |   0.17106456308450615 |
| ECM_G1     | and    | ECM_b      | =                    |    0.1513530907978907 |
| ECM_G1     | and    | ECM_tmax   | =                    |   -0.3481789186475476 |
| ECM_G1     | and    | ECM_tshift | =                    |   -0.3191508824148746 |
| ECM_G2     | and    | ECM_dG     | =                    |   -0.4441046480468571 |
| ECM_G2     | and    | ECM_xi     | =                    |   0.13174491177761222 |
| ECM_G2     | and    | ECM_b      | =                    |   0.19192426882990488 |
| ECM_G2     | and    | ECM_tmax   | =                    |  -0.09456479752587221 |
| ECM_G2     | and    | ECM_tshift | =                    |  -0.45912703959039847 |
| ECM_dG     | and    | ECM_G1     | =                    |   0.24125280863084547 |
| ECM_dG     | and    | ECM_G2     | =                    |   -0.4441046480468571 |
| ECM_dG     | and    | ECM_xi     | =                    |  -0.11239874874127515 |
| ECM_dG     | and    | ECM_b      | =                    |  -0.25145944030220063 |
| ECM_dG     | and    | ECM_tmax   | =                    |   -0.4210391455415891 |
| ECM_dG     | and    | ECM_tshift | =                    |    0.1332457248552889 |
| ECM_xi     | and    | ECM_G1     | =                    |   0.17106456308450613 |
| ECM_xi     | and    | ECM_G2     | =                    |   0.23288658762699377 |
| ECM_xi     | and    | ECM_dG     | =                    |  -0.11239874874127513 |
| ECM_xi     | and    | ECM_b      | =                    |    0.5746957711326908 |
| ECM_xi     | and    | ECM_tmax   | =                    |    0.1870866190769631 |
| ECM_xi     | and    | ECM_tshift | =                    |    0.0947009671680572 |
| ECM_b      | and    | ECM_G1     | =                    |   0.15135309079789067 |
| ECM_b      | and    | ECM_G2     | =                    |   0.30741932095449176 |
| ECM_b      | and    | ECM_dG     | =                    |  -0.25145944030220063 |
| ECM_b      | and    | ECM_xi     | =                    |    0.5746957711326907 |
| ECM_b      | and    | ECM_tmax   | =                    |   0.10689382147100573 |
| ECM_b      | and    | ECM_tshift | =                    |  -0.15946889095561168 |
| ECM_tmax   | and    | ECM_G1     | =                    |   -0.3481789186475476 |
| ECM_tmax   | and    | ECM_G2     | =                    |  -0.04068877608175052 |
| ECM_tmax   | and    | ECM_dG     | =                    |   -0.4210391455415891 |
| ECM_tmax   | and    | ECM_xi     | =                    |    0.1870866190769631 |
| ECM_tmax   | and    | ECM_b      | =                    |   0.10689382147100573 |
| ECM_tmax   | and    | ECM_tshift | =                    |    0.5022105203939518 |
| ECM_tshift | and    | ECM_G1     | =                    |   -0.3191508824148746 |
| ECM_tshift | and    | ECM_G2     | =                    |  -0.38350821258707773 |
| ECM_tshift | and    | ECM_dG     | =                    |    0.1332457248552889 |
| ECM_tshift | and    | ECM_xi     | =                    |    0.0947009671680572 |
| ECM_tshift | and    | ECM_b      | =                    |  -0.15946889095561168 |
| ECM_tshift | and    | ECM_tmax   | =                    |    0.5022105203939518 |
| Lag        | and    | Lag_freq   | =                    |   -0.2810853225392384 |
| Gamma_Relx | and    | ECM_M      | =                    |   0.19902293353674008 |
| Gamma_Relx | and    | ECM_H2     | =                    |    0.0924185589724659 |
| Gamma_Relx | and    | ECM_G1     | =                    |   -0.4082931213518545 |
| Gamma_Relx | and    | ECM_G2     | =                    |  -0.45999818067004217 |
| Gamma_Relx | and    | ECM_dG     | =                    |   0.12453269310165496 |
| Gamma_Relx | and    | ECM_xi     | =                    | -0.004550061026206781 |
| Gamma_Relx | and    | ECM_b      | =                    |   -0.0438498754595521 |
| Gamma_Relx | and    | ECM_tmax   | =                    |   0.14674226827698236 |
| Gamma_Relx | and    | ECM_tshift | =                    |   0.01781625440483693 |
| xi         | and    | Lag        | =                    |    0.3988975880084252 |
| xi         | and    | Lag_F      | =                    |   -0.3082922354567487 |
| xi         | and    | ECM_M      | =                    |    0.1154886913371517 |
| xi         | and    | ECM_H2     | =                    |    0.3026152798338213 |
| xi         | and    | ECM_G1     | =                    |   0.03715471732046223 |
| xi         | and    | ECM_G2     | =                    |    -0.100071271635384 |
| xi         | and    | ECM_dG     | =                    |   0.20150883819245755 |
| xi         | and    | ECM_xi     | =                    |   -0.4671114720472536 |
| xi         | and    | ECM_b      | =                    |  -0.30591657395856087 |
| xi         | and    | ECM_tmax   | =                    |   -0.4884332185491235 |
| xi         | and    | ECM_tshift | =                    |  -0.10156878119150128 |
| Fe         | and    | Lag        | =                    |    0.4094882817111525 |
| Fe         | and    | Lag_F      | =                    |  -0.14869945369414864 |
| Fe         | and    | ECM_M      | =                    |   -0.2437596491016355 |
| Fe         | and    | ECM_H2     | =                    |   0.10102278547258807 |
| Fe         | and    | ECM_G1     | =                    |   0.20375216825957437 |
| Fe         | and    | ECM_G2     | =                    |    0.2279412783336636 |
| Fe         | and    | ECM_dG     | =                    | -0.059726471232259694 |
| Fe         | and    | ECM_xi     | =                    |  -0.21998839736666073 |
| Fe         | and    | ECM_b      | =                    |   -0.2708695461036844 |
| Fe         | and    | ECM_tmax   | =                    |  -0.33818411330993003 |
| Fe         | and    | ECM_tshift | =                    |  -0.10411666802055848 |
| F          | and    | Lag        | =                    |   -0.5218988152075511 |
| F          | and    | Lag_F      | =                    |  -0.23846888685041773 |
| F          | and    | ECM_M      | =                    |   0.32310743492044436 |
| F          | and    | ECM_H2     | =                    |   0.10379801219653882 |
| F          | and    | ECM_G1     | =                    |  -0.34573805312582057 |
| F          | and    | ECM_G2     | =                    |   -0.5544849629909182 |
| F          | and    | ECM_dG     | =                    |    0.3528339610979436 |
| F          | and    | ECM_xi     | =                    |   0.18520065598309352 |
| F          | and    | ECM_b      | =                    |  -0.08280933497760966 |
| F          | and    | ECM_tmax   | =                    |   0.21575096902881158 |
| F          | and    | ECM_tshift | =                    |   0.29096541405527443 |
| Cvr        | and    | Cts        | =                    |  -0.21427162813432157 |
| Cvr        | and    | Lag        | =                    |   0.30930092424594013 |
| Cvr        | and    | F          | =                    |   -0.3855514253459213 |
| Cvr        | and    | Lag_F      | =                    |   0.31293057722655176 |
| Cvr        | and    | Relx_F     | =                    |   -0.6433699269348807 |
| Cvr        | and    | Ref_F      | =                    |   -0.7228809464985598 |
| Cvr        | and    | Plaw_F     | =                    |   -0.7063109581252761 |
| Cvr        | and    | Gamma_Relx | =                    |  -0.19172487471866795 |
| Cvr        | and    | ECM_M      | =                    |  -0.07859093261817084 |
| Cvr        | and    | ECM_H2     | =                    |   0.23310424553023576 |
| Cvr        | and    | ECM_G1     | =                    |  0.013961825050956563 |
| Cvr        | and    | ECM_G2     | =                    |   0.03166339225316007 |
| Cvr        | and    | ECM_dG     | =                    |  -0.02815247233754899 |
| Cvr        | and    | ECM_xi     | =                    |    -0.408695520189957 |
| Cvr        | and    | ECM_b      | =                    |   -0.1704598030912574 |
| Cvr        | and    | ECM_tmax   | =                    |  -0.12747641487431458 |
| Cvr        | and    | ECM_tshift | =                    |   -0.4638474227917231 |
| L          | and    | Lag        | =                    |     -0.52171796704292 |
| L          | and    | Lag_freq   | =                    |   -0.2386820557828424 |
| L          | and    | ECM_H2     | =                    |   0.10390493174893038 |
| L          | and    | ECM_G1     | =                    |  -0.34571888978623444 |
| L          | and    | ECM_G2     | =                    |   -0.5548746304843869 |
| L          | and    | ECM_dG     | =                    |   0.35344484201629456 |
| L          | and    | ECM_xi     | =                    |   0.18485125296099392 |
| L          | and    | ECM_b      | =                    |  -0.08299620968432368 |
| L          | and    | ECM_tmax   | =                    |    0.2159868063114166 |
| L          | and    | ECM_tshift | =                    |   0.29145318349841737 |
| L          | and    | xi         | =                    |  -0.22392695741539062 |
| L          | and    | Fe         | =                    |   -0.5581291497983003 |
| L          | and    | Cts        | =                    |    0.2802862891244476 |
| L          | and    | F          | =                    |    0.9999981839101415 |

#+END_EXAMPLE

** 1H0707-495 ECM Mass range and Posterior density

*** Posterior density (1st fits)

PATH = =/home/steff075/phd_ecm/results-for-all/emcee=

script = =/home/steff075/phd_ecm/results-for-all/emcee/posterior_density.py=

#+BEGIN_EXAMPLE
import numpy as np
import matplotlib.pyplot as plt

#Import data
#data = np.loadtxt('1H0707-495_Mass_combined.csv', delimiter=',', skiprows=1)
data = np.loadtxt('1H0707-495_results_single_obs.csv', delimiter=',', skiprows=1)

mass = data[:,28]

ndim = 15 # define number of dimensions of the data

cov = 0.5 - np.random.rand(ndim ** 2).reshape((ndim, ndim))
cov = np.triu(cov)
cov += cov.T - np.diag(cov.diagonal())
cov = np.dot(cov, cov)

nwalkers = 100

# Guess sarting point for each of the 100 walkers.
p0 = np.random.rand(nwalkers, ndim)

# Define function that returns the density p(x⃗ ) for specific values of x⃗ , μ⃗  and Σ−1. In fact, emcee actually requires the logarithm of p.

def log_prob(x, mu, cov):
    diff = x - mu
    return -0.5 * np.dot(diff, np.linalg.solve(cov, diff))

# Import EMCEE and define the Ensembler
import emcee

sampler = emcee.EnsembleSampler(nwalkers, ndim, log_prob, args=[mass, cov])

# Define the probability function (log_prob) for this data
log_prob(p0[0], mass, cov)

print("log_prob: {0:.3f}".format(log_prob(p0[0], mass, cov)))

# Setup some initial 'burn- in' steps for the MCMC chain to allow walkers to explore parameter space to settle into the maximum of the density
print("Running burn-in...")
state = sampler.run_mcmc(p0, 100) # Save the final position of the walkers after N steps as 'state'

sampler.reset() # Reset the sampler before running MCMC

# Run MCMC for N steps starting at the final 'burn-in' locations
print("Running MCMC chain...")
sampler.run_mcmc(state, 50000);

mass_mean = np.mean(mass)
mass_sigma = np.std(mass)

print("Mean acceptance fraction: {0:.3f}".format(np.mean(sampler.acceptance_fraction)))
print("Mean autocorrelation time: {0:.3f}steps".format(np.mean(sampler.get_autocorr_time())))
print("Mass mean: {0:.3f}".format(np.mean(mass)))
print("Mass sigma: {0:.3f}".format(np.std(mass)))

conf68 = stats.norm.interval(0.68, loc=mass_mean, scale=mass_sigma/np.sqrt(len(mass)))
conf95 = stats.norm.interval(0.95, loc=mass_mean, scale=mass_sigma/np.sqrt(len(mass)))

#conf68_lines = (conf68[:,0], mass_median, conf68[:,1])

samples = sampler.get_chain(flat=True)
plt.hist(samples[:, 0], 100, color="k", histtype="step")
#plt.axvline(6.098, lw =0.7)
#plt.axvline(6.259, lw =0.7)
plt.axvline(6.179, lw =0.5, c="k") # Mean
plt.axvline(6.021, lw =0.8, linestyle='dashed', c="grey") # sigma_lo
plt.axvline(6.338, lw =0.8, linestyle='dashed', c="grey") # sigma_hi
plt.axvspan(6.021, 6.338, alpha=0.2, color="b")
plt.xlim(1,10)
plt.xlabel(r"$M_{BH}~logM_{\odot}$")
plt.ylabel(r"Posterior Density")
plt.gca().set_yticks([]);
#plt.show(block=False)
plt.savefig('1H0707-mass-density-histogram.png')
plt.savefig('1H0707-mass-density-histogram.pdf')

#+END_EXAMPLE

Posterior density results

#+BEGIN_EXAMPLE

Mean acceptance fraction: 0.345

Mean autocorrelation time: 198.239steps

Mass mean: 6.182

Mass median: 6.190

Mass sigma: 0.165

conf68
(6.139666966509256, 6.224383300157408)

conf95
(6.09854197851297, 6.2655082881536925)


#+END_EXAMPLE

#+ATTR_HTML: :width 600
#+CAPTION: The posterior distribution for 1H0707-495 Mass values where $\mu$ = 6.182 (solid black line) and $\sigma$ = 0.165 (blue region). The Median value was 6.19.
http://www.star.bris.ac.uk/steff/ecm/1H0707-mass-density-histogram.png

*** Posterior density (ABS lags fits)

PATH = =/home/steff075/phd_ecm/results-for-all/emcee=

script = =/home/steff075/phd_ecm/results-for-all/emcee/posterior_density.py=

#+BEGIN_EXAMPLE
import numpy as np
import matplotlib.pyplot as plt

#Import data
data = np.loadtxt('1H0707-495_results_single_obs.csv', delimiter=',', skiprows=1)

mass = data[:,68]

ndim = 15 # define number of dimensions of the data

cov = 0.5 - np.random.rand(ndim ** 2).reshape((ndim, ndim))
cov = np.triu(cov)
cov += cov.T - np.diag(cov.diagonal())
cov = np.dot(cov, cov)

nwalkers = 100

# Guess sarting point for each of the 100 walkers.
p0 = np.random.rand(nwalkers, ndim)

# Define function that returns the density p(x⃗ ) for specific values of x⃗ , μ⃗  and Σ−1. In fact, emcee actually requires the logarithm of p.

def log_prob(x, mu, cov):
    diff = x - mu
    return -0.5 * np.dot(diff, np.linalg.solve(cov, diff))

# Import EMCEE and define the Ensembler
import emcee

sampler = emcee.EnsembleSampler(nwalkers, ndim, log_prob, args=[mass, cov])

# Define the probability function (log_prob) for this data
log_prob(p0[0], mass, cov)

print("log_prob: {0:.3f}".format(log_prob(p0[0], mass, cov)))

# Setup some initial 'burn- in' steps for the MCMC chain to allow walkers to explore parameter space to settle into the maximum of the density
print("Running burn-in...")
state = sampler.run_mcmc(p0, 100) # Save the final position of the walkers after N steps as 'state'

sampler.reset() # Reset the sampler before running MCMC

# Run MCMC for N steps starting at the final 'burn-in' locations
print("Running MCMC chain...")
sampler.run_mcmc(state, 50000);

mass_mean = np.mean(mass)
mass_sigma = np.std(mass)

print("Mean acceptance fraction: {0:.3f}".format(np.mean(sampler.acceptance_fraction)))
print("Mean autocorrelation time: {0:.3f}steps".format(np.mean(sampler.get_autocorr_time())))
print("Mass mean: {0:.3f}".format(np.mean(mass)))
print("Mass sigma: {0:.3f}".format(np.std(mass)))

conf68 = stats.norm.interval(0.68, loc=mass_mean, scale=mass_sigma/np.sqrt(len(mass)))
conf95 = stats.norm.interval(0.95, loc=mass_mean, scale=mass_sigma/np.sqrt(len(mass)))

#conf68_lines = (conf68[:,0], mass_median, conf68[:,1])

samples = sampler.get_chain(flat=True)
plt.hist(samples[:, 0], 100, color="k", histtype="step")
#plt.axvline(6.098, lw =0.7)
#plt.axvline(6.259, lw =0.7)
plt.axvline(6.123, lw =0.5, c="k") # Mean
plt.axvline(mass_mean - mass_sigma, lw =0.8, linestyle='dashed', c="grey") # sigma_lo
plt.axvline(mass_mean + mass_sigma, lw =0.8, linestyle='dashed', c="grey") # sigma_hi
plt.axvspan(mass_mean - mass_sigma, mass_mean + mass_sigma, alpha=0.2, color="b")
plt.xlim(1,10)
plt.xlabel(r"$M_{BH}~logM_{\odot}$", fontsize=16)
plt.ylabel(r"Posterior Density", fontsize=16 )
plt.gca().set_yticks([]);
plt.show(block=False)

plt.savefig('1H0707-mass-density-histogram-ABS.png')
plt.savefig('1H0707-mass-density-histogram-ABS.pdf')

#+END_EXAMPLE

Posterior density results

#+BEGIN_EXAMPLE
log_prob: -36906.105

Mean acceptance fraction: 0.345

Mean autocorrelation time: 197.311steps

Mass mean: 6.123

Mass median: 6.094888

Mass sigma: 0.198

conf68 = (6.072436449436044, 6.174003550563956)

conf95 = (6.0231313669940825, 6.223308633005917)

#+END_EXAMPLE

#+ATTR_HTML: :width 600
#+CAPTION: The posterior distribution for 1H0707-495 ABS-lags Mass values where $\mu$ = 6.123 (solid black line) and $\sigma$ = 0.198 (blue region). The Median value was 6.09.
http://www.star.bris.ac.uk/steff/ecm/1H0707-mass-density-histogram-ABS.png

*** Posterior density (lags taken to $f_{max}$)

PATH = =/home/steff075/phd_ecm/results-for-all/emcee=

script = =/home/steff075/phd_ecm/results-for-all/emcee/posterior_density.py=

#+BEGIN_EXAMPLE
import numpy as np
import matplotlib.pyplot as plt

#Import data
data = np.loadtxt('1H0707-495_results_single_obs.csv', delimiter=',', skiprows=1)

mass = data[:,101]

ndim = 15 # define number of dimensions of the data

cov = 0.5 - np.random.rand(ndim ** 2).reshape((ndim, ndim))
cov = np.triu(cov)
cov += cov.T - np.diag(cov.diagonal())
cov = np.dot(cov, cov)

nwalkers = 100

# Guess sarting point for each of the 100 walkers.
p0 = np.random.rand(nwalkers, ndim)

# Define function that returns the density p(x⃗ ) for specific values of x⃗ , μ⃗  and Σ−1. In fact, emcee actually requires the logarithm of p.

def log_prob(x, mu, cov):
    diff = x - mu
    return -0.5 * np.dot(diff, np.linalg.solve(cov, diff))

# Import EMCEE and define the Ensembler
import emcee

sampler = emcee.EnsembleSampler(nwalkers, ndim, log_prob, args=[mass, cov])

# Define the probability function (log_prob) for this data
log_prob(p0[0], mass, cov)

print("log_prob: {0:.3f}".format(log_prob(p0[0], mass, cov)))

# Setup some initial 'burn- in' steps for the MCMC chain to allow walkers to explore parameter space to settle into the maximum of the density
print("Running burn-in...")
state = sampler.run_mcmc(p0, 100) # Save the final position of the walkers after N steps as 'state'

sampler.reset() # Reset the sampler before running MCMC

# Run MCMC for N steps starting at the final 'burn-in' locations
print("Running MCMC chain...")
sampler.run_mcmc(state, 50000);

mass_mean = np.mean(mass)
mass_sigma = np.std(mass)

print("Mean acceptance fraction: {0:.3f}".format(np.mean(sampler.acceptance_fraction)))
print("Mean autocorrelation time: {0:.3f}steps".format(np.mean(sampler.get_autocorr_time())))
print("Mass mean: {0:.3f}".format(np.mean(mass)))
print("Mass sigma: {0:.3f}".format(np.std(mass)))

conf68 = stats.norm.interval(0.68, loc=mass_mean, scale=mass_sigma/np.sqrt(len(mass)))
conf95 = stats.norm.interval(0.95, loc=mass_mean, scale=mass_sigma/np.sqrt(len(mass)))

#conf68_lines = (conf68[:,0], mass_median, conf68[:,1])

samples = sampler.get_chain(flat=True)
plt.hist(samples[:, 0], 100, color="k", histtype="step")
plt.axvline(mass_mean, lw =0.5, c="k") # Mean
plt.axvline(mass_mean - mass_sigma, lw =0.8, linestyle='dashed', c="grey") # sigma_lo
plt.axvline(mass_mean + mass_sigma, lw =0.8, linestyle='dashed', c="grey") # sigma_hi
plt.axvspan(mass_mean - mass_sigma, mass_mean + mass_sigma, alpha=0.2, color="b") # Fill sigma range
plt.xlim(1,10)
plt.xlabel(r"$M_{BH}~logM_{\odot}$", fontsize=16)
plt.ylabel(r"Posterior Density", fontsize=16)
plt.gca().set_yticks([]);
#plt.show(block=False)

plt.savefig('1H0707-mass-density-histogram-fmax.png')
plt.savefig('1H0707-mass-density-histogram-fmax.pdf')

#+END_EXAMPLE

Posterior density results

#+BEGIN_EXAMPLE
log_prob: -3134.573

Mean acceptance fraction: 0.345

Mean autocorrelation time: 194.362steps

Mass mean: 6.280

Mass median: 6.233

Mass sigma: 0.204

conf68 = (6.228048428135312, 6.332945305198019)

conf95 = (6.177126927826195, 6.383866805507137)

#+END_EXAMPLE

#+ATTR_HTML: :width 600
#+CAPTION: The posterior distribution for 1H0707-495 $f_{max}$ lags Mass values where $\mu$ = 6.280 (solid black line) and $\sigma$ = 0.204 (blue region). The Median value was 6.233.
http://www.star.bris.ac.uk/steff/ecm/1H0707-mass-density-histogram-fmax.png

*** Generative probabilistic model

This work follows : https://emcee.readthedocs.io/en/stable/tutorials/line/#the-generative-probabilistic-model

PATH = =/home/steff075/phd_ecm/results-for-all/emcee/likelihood.py=

#+BEGIN_EXAMPLE
import numpy as np
import matplotlib.pyplot as plt

#Import data
data = np.loadtxt('1H0707-495_results_single_obs.csv', delimiter=',', skiprows=1)

# Define parameters
lag = data[:,2]
lag_err = data[:,3].T
lag_freq = data[:,4]
lag_freq_err = data[:,5].T
lum_03_10k_model = data[:,7]
lum_03_10k_data = data[:,8]
lum_2_10k_model = data[:,9]
lum_2_10k_data = data[:,10]
flux_03_10k_model = data[:,11]
flux_03_10k_data = data[:,12]
flux_2_10k_model = data[:,13]
flux_2_10k_data = data[:,14]
relx_g = data[:,15]
relx_g_err = np.flipud(data[:,15])
relx_xi = data[:,18]
relx_xi_err = np.flipud(data[:,18])
relx_fe = data[:,21]
relx_fe_err = np.flipud(data[:,21])
relx_inc = data[:,27]
relx_inc_err = np.flipud(data[:,27])
cvr_frac = data[:,30]
cvr_frac_err = np.flipud(data[: ,31:33].T)
chi = data[:,33]
mass = data[:,34]
mass_err = np.flipud(data[:, 35:37].T)
h2 = data[:,37]
h2_err = np.flipud(data[:, 38:40].T)
g1 = data[:,40]
g1_err = np.flipud(data[:, 41:43].T)
g2 = data[:,43]
g2_err = np.flipud(data[:, 44:46].T)
ecm_xi = data[:,47]
b = data[:,50]
tmax = data[:,53]
tmax_err = np.flipud(data[:,54:56].T)
tshift = data[:,56]
tshift_err = np.flipud(data[:,57:59].T)

x = chi
y = mass
yerr = mass_err

# Plot some reults
plt.errorbar(x, y, yerr, fmt='o')
m, b = np.polyfit(x, y, 1) # m = slope, b = intercept
plt.plot(x, m*x + b, "k", alpha=0.3, lw=3)
plt.xlabel(r'$\chi^2$', fontsize=14)
plt.ylabel(r'$M_{BH}~(log M_{\odot})$', fontsize=14)
plt.show(block=False)
#plt.savefig('1H0707-mass-chi.png')
#plt.close()
#+END_EXAMPLE

Where:

#+BEGIN_EXAMPLE

>>> m
-0.04689050906339207

>>> b
6.22744640644607

#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-mass-chi.png


#+BEGIN_EXAMPLE
# Generate a Vandermonde matrix.
A = np.vander(x, 2)

# Construct new yerr array as from https://stackoverflow.com/questions/27214027/how-to-construct-diagonal-array-using-a-2d-array-in-numpy
K = np.eye(yerr.shape[1]) * yerr[:, np.newaxis]

C = K ** 2

ATA = np.dot(A.T, A / (yerr ** 2)[:, 1])

cov = np.linalg.inv(ATA)

## Up To HERE !!! ##

w = np.linalg.solve(ATA, np.dot(A.T, y / yerr ** 2)


#+END_EXAMPLE

*** Alternative probabilistic model

This follows work done a ref:
http://mattpitkin.github.io/samplers-demo/pages/emcee/


Using the model above where the data is fitted with a straight line
of:

slope = m = -0.04787065142574779

intercept = b = 6.240437536042262

Generate random data (100) with gaussian errors

PATH = =/home/steff075/phd_ecm/results-for-all/emcee/likelihood2.py=

#+BEGIN_EXAMPLE
import numpy as np
import matplotlib.pyplot as plt
import os
import sys
import numpy as np
import emcee

# slope of the line
m = -0.04689050906339207

# y-intercept of the line
b = 6.22744640644607

# set the "predictor variable"/abscissa
M = 100
xmin = 0.
xmax = 5.
stepsize = (xmax-xmin)/M
a = np.arange(xmin, xmax, stepsize)

# define the model function
def straight_line(a, m, b):
    return m*a + b

# create the data - the model plus Gaussian noise
sigma = 0.5 # standard deviation of the noise
data = straight_line(a, m, b) + sigma*np.random.randn(M)
plt.plot(data, "k", alpha=0.3, lw=3)
plt.show(block=False)
#plt.savefig('data-100-gauss.png')

#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/data-100-gauss.png


#+BEGIN_EXAMPLE
import numpy as np
import matplotlib.pyplot as plt
import os
import sys
import numpy as np
import emcee

# slope of the line
m = -0.04689050906339207

# y-intercept of the line
b = 6.22744640644607

# set the "predictor variable"/abscissa
M = 100
xmin = 0.
xmax = 10.
stepsize = (xmax-xmin)/M
a = np.arange(xmin, xmax, stepsize)

# define the model function
def straight_line(a, m, b):
    return m*a + b

# create the data - the model plus Gaussian noise
sigma = 0.5 # standard deviation of the noise
data = straight_line(a, m, b) + sigma*np.random.randn(M)
#plt.plot(data, "k", alpha=0.3, lw=3)
#plt.show(block=False)
#plt.savefig('data-100-gauss.png')

def logposterior(theta, data, sigma, a):
    lp = logprior(theta) # get the prior
    if not np.isfinite(lp): # if the prior is not finite return a probability of zero
        return -np.inf
    # return the likeihood times the prior (log likelihood plus the log prior)
    return lp + loglikelihood(theta, data, sigma, a)


def loglikelihood(theta, data, sigma, a):
    m, b = theta # unpack the model parameters from the tuple
    md = straight_line(a, m, b) # evaluate the model (assumes that the straight_line model is defined as above)
    return -0.5*np.sum(((md - data)/sigma)**2) # return the log likelihood


def logprior(theta):
    lp = 0.
    m, b = theta # unpack the model parameters from the tuple
    lp = 0. if bmin < b < bmax else -np.inf
    lp -= 0.5*((m - mmu)/msigma)**2
    return lp


# Gaussian prior on m
mmu = 0.   # mean of the Gaussian prior
msigma = 0.1 # standard deviation of the Gaussian prior
# uniform prior on b
bmin = -10.  # lower range of prior
bmax = 10.   # upper range of prior

Nens = 100   # number of ensemble points
mini = np.random.normal(mmu, msigma, Nens) # initial m points
bini = np.random.uniform(bmin, bmax, Nens) # initial b points
inisamples = np.array([mini, bini]).T # initial samples
ndims = inisamples.shape[1] # number of parameters/dimensions
Nburnin = 500   # number of burn-in samples
Nsamples = 500  # number of final posterior samples

# set additional args for the posterior (the data, the noise std. dev., and the abscissa)
argslist = (data, sigma, b)

# set up the sampler
sampler = emcee.EnsembleSampler(Nens, ndims, logposterior, args=argslist)

# pass the initial samples and total number of samples required
sampler.run_mcmc(inisamples, Nsamples+Nburnin);

# extract the samples (removing the burn-in)
postsamples = sampler.chain[:, Nburnin:, :].reshape((-1, ndims))

print('Number of posterior samples is {}'.format(postsamples.shape[0]))
#print('Mean acceptance fraction: {0:.3f}'.format(np.mean(sampler.acceptance_fraction)))
#print('Mean autocorrelation time: {0:.3f} steps'.format(np.mean(sampler.get_autocorr_time())))

import corner
fig = corner.corner(postsamples, labels=[r"$m$", r"$b$"], truths=[m, b])
#plt.show()
fig.savefig('emcee-mass-chi-50000.png')

..........................................................

Further information - Note here that

>>> mass
array([6.034376, 6.21462 , 6.154736, 5.986613, 6.126042, 6.471828,
       6.249992, 6.397703, 6.32283 , 6.399108, 6.256892, 6.011134,
       6.00742 , 5.906629, 6.190454])

>>> mass_mu = np.mean(mass)

>>> mass_mu
6.182025133333331

>>> mass_sigma = np.std(mass)
>>> mass_sigma
0.16496673962301886


>>> chi_mu = np.mean(chi)
>>> chi_mu
0.9686666666666667


>>> chi_sigma = np.std(chi)
>>> chi_sigma
0.5276219185068878
#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/emcee-mass-chi-50000.png

* *1H0707-495 segmented lags below $f_{max}$*
** Combined segmented lags for best estimation and max frequency


PATH = =/data/scratch3/steff/1H0707-495/combined/lagfreq_segs_ECM.sl=

All observations were split into 53 segments of between 18 - 25 ks
totalling 1158.6 ks of effective observation time. The combined
lag-frequency of these observations is shown below.


#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707_comb_segs_lagfreq.gif

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707_comb_segs_coh.gif

** Combined: for $~f_{max}$

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_comb_script.sl=

Lags found
#+BEGIN_EXAMPLE
1.085714e-04,2.857143e-05,8.914646e+01,6.802465e+01
1.861224e-04,4.897959e-05,1.653453e+02,2.815588e+01
3.190671e-04,8.396501e-05,1.323586e+02,1.599274e+01
5.469721e-04,1.439400e-04,-1.028120e+01,9.105510e+00
9.376664e-04,2.467543e-04,-1.796084e+01,5.265051e+00
1.607428e-03,4.230074e-04,-2.657116e+01,2.852366e+00
2.755591e-03,7.251556e-04,-7.426622e+00,1.627332e+00
#+END_EXAMPLE


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_lagfreq_comb_fmax.gif

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("1H0707-495-comb-time-lags-fmax.fits");
r=load_rmf("1H0707-495-comb-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE


Fit ECM

1H0707-comb-fit-error.sl

#+BEGIN_EXAMPLE
Submitted batch job 4117541

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.536363e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.222582           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               20           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid 1H0707_comb_fmax
chi^2 = 2.314450e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 2.000000e+01 (+0.000000e+00 -1.054020e-01)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -6.649659e-02)
Parameter Gamma2 = 2.100000e+00 (+7.219757e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -1.995078e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.500000e+02 (+6.782388e+01 -0.000000e+00)
Parameter t_shift = 2.000000e+01 (+1.104767e+01 -1.191995e+01)

lag_freq(1).log_mass,6.222582e+00,+1.022233e-02,-1.092162e-02
  Parameter 2 = 6.222582e+00 (6.211660e+00 - 6.232804e+00)

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_comb_fmax_best_fit.png

** Combined: for $~f_{max}$ isis emcee

PATH TO DATA = =/data/typhon1/reverb/1H0707-495/isis_emcee/=

Fit script = =1H0707-comb-fit-emcee.sl=

Fitting Parameter file =1H0707_comb_fmax_best_fit.par=

Make good image of the ECM Model fit

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_comb_fmax_best fit.ps/cps");
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
plot_comps(1,popt,&plot_data);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgsci(1); % make line colour black
_pgdraw(1,0);
close_plot(pid);
#+END_EXAMPLE


Obtain par file from BC4

#+BEGIN_EXAMPLE
scp -r so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0110890201_fmax_best_fit.par .
#+END_EXAMPLE

This model fit with χ²=2.31 and the parameters for this particular fit are:

| lag_freq |                      |        |        |              |     |       |
|      idx | param                | tie-to | freeze |        value | min |   max |
|        1 | lag_freq(1).norm     |      0 |      0 | 2.536363e-05 |   0 | 0.001 |
|        2 | lag_freq(1).log_mass |      0 |      0 |     6.222582 |   5 |     7 |
|        3 | lag_freq(1).i        |      0 |      1 |           53 |   0 |     0 |
|        4 | lag_freq(1).a        |      0 |      1 |        0.998 |   0 |     0 |
|        5 | lag_freq(1).h1       |      0 |      1 |            2 |   0 |     0 |
|        6 | lag_freq(1).h2       |      0 |      1 |           20 |   0 |     0 |
|        7 | lag_freq(1).Gamma1   |      0 |      1 |          2.6 |   0 |     0 |
|        8 | lag_freq(1).Gamma2   |      0 |      1 |          2.1 |   0 |     0 |
|        9 | lag_freq(1).Fe       |      0 |      1 |            1 |   0 |     0 |
|       10 | lag_freq(1).xi       |      0 |      1 |            3 |   0 |     0 |
|       11 | lag_freq(1).p        |      0 |      1 |            0 |   0 |     0 |
|       12 | lag_freq(1).b        |      0 |      1 |            2 |   0 |     0 |
|       13 | lag_freq(1).q2       |      0 |      1 |          0.5 |   0 |     0 |
|       14 | lag_freq(1).t_max    |      0 |      1 |          250 |   0 |     0 |
|       15 | lag_freq(1).t_shift  |      0 |      1 |           20 |   0 |     0 |



#+BEGIN_EXAMPLE
isis

.source("1H0707-comb-fit-emcee.sl");

where

% Perform MCMC
emcee(500, 5000; output="1H0707_comb_fmax_chain.fits", serial);

% Read the chain-file
(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("1H0707_comb_fmax_chain.fits");
#+END_EXAMPLE


*Paths of the walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_comb_fmax_walkers-1.png


*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_comb_fmax_mass_accept_rate-1.png


Obtain the Norm pobability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_comb_fmax_norm_prob-1.png


Obtain the Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_comb_fmax_mass_prob-1.png

*Contours: paths in 2D*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_comb_fmax_chain_hist2d-1.png


pdf at

http://www.star.bris.ac.uk/steff/ecm/1H0707_comb_fmax_chain_hist2d.pdf




*Chain statistics*


#+BEGIN_EXAMPLE
s=200; % start at this iteration step
min(min_statistic[[s:]]);
2.314449699522875


#+END_EXAMPLE


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_comb_fmax_statistics-1.png


Error analysis


Conf68
#+BEGIN_EXAMPLE
isis> conf_min;
6.215394694805145
isis> conf_max;
6.229039659500122
isis> conf_mean;
6.222217177152634

So :

conf_mean = 6.222 \pm 0.0068 at 68% confidence


#+END_EXAMPLE


#+CAPTION: The 68% confidence probability for 1H0707-495 Mass value where $\mu = 6.222\pm0.007$ (solid blue line. Error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_comb_fmax_logmass_conf68-1.png


Conf90
#+BEGIN_EXAMPLE
isis> conf_min;
6.210839490890503
isis> conf_max;
6.235152535438537
isis> conf_mean;
6.22299601316452

So :

conf_mean = 6.223 \pm 0.01215 at 90% confidence

source("1H0707-comb-fit-emcee.sl");

#+END_EXAMPLE

#+CAPTION: The 90% confidence probability for 1H0707-495 Mass value where $\mu = 6.223\pm0.012$ (solid blue line) with the error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_comb_fmax_logmass_conf90-1.png


pdf at:

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_comb_fmax_logmass.pdf


** Combined EMCEE - by reading the lag-files AND TM and importing emcee

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/IRAS13224-3809/fit-tm-emcee-comb.sl=


Run chain  200 walkers and 20,000 iterations = =IRAS_tm_emcee_comb.fits=

Best table model fit is

#+BEGIN_EXAMPLE
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         4.732302           0         100
  2  lag_freq(1).log_mass   0     0         6.662795         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         12.84473           3          20
  7  lag_freq(1).Gamma1     0     0         2.632042           2         3.3
  8  lag_freq(1).Gamma2     0     0         1.700001         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0     1.588869e-08           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.491961           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         306.6571         100        1400
 15  lag_freq(1).t_shift    0     0         19.30878          10         120
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -2.0576e-03     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-comb-time-lags-fmax.fits



#+END_EXAMPLE

Dont start at the best fit - provide a rough parfile =tm_comb_test.par=

#+BEGIN_EXAMPLE
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         4.732302           0         100
  2  lag_freq(1).log_mass   0     0              6.2         5.5           8
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0               10           3          20
  7  lag_freq(1).Gamma1     0     0              2.4         1.8         3.3
  8  lag_freq(1).Gamma2     0     0              1.8         1.4         3.2
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0                1           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0                2           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0              400          50        1500
 15  lag_freq(1).t_shift    0     0               30          10         150
#+END_EXAMPLE

#+BEGIN_EXAMPLE
Run code:

source("fit-tm-emcee-comb.sl");

emcee(200, 20000; output="IRAS_tm_emcee_comb.fits", serial);

#+END_EXAMPLE


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/


*Statistics*

#+BEGIN_EXAMPLE


#+END_EXAMPLE



#+ATTR_HTML: :width 700
#+CAPTION: The 90% confidence probability for IRAS13224-3809 Mass value where $\mu = 6.\pm0.0$ (solid blue line) with the error range between the black dashed lines.
http://www.star.bris.ac.uk/steff/ecm/


pdf at:


http://www.star.bris.ac.uk/steff/ecm/



** Hi-flux: for $~f_{max}$

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_hi_flux.sl=

Lags found
#+BEGIN_EXAMPLE
1.085714e-04,2.857143e-05,8.840774e+01,7.151235e+01
1.861224e-04,4.897959e-05,1.655761e+02,2.945983e+01
3.190671e-04,8.396501e-05,1.323719e+02,1.686690e+01
5.469721e-04,1.439400e-04,-1.038081e+01,9.601972e+00
9.376664e-04,2.467543e-04,-1.792205e+01,5.557540e+00
1.607428e-03,4.230074e-04,-2.655711e+01,3.012106e+00
2.755591e-03,7.251556e-04,-7.414404e+00,1.722310e+00


#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_lagfreq_hiflux_fmax.gif


#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("1H0707-495-hiflux-time-lags-fmax.fits");
r=load_rmf("1H0707-495-hiflux-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE


Fit ECM

1H0707-hiflux-fit-error.sl

#+BEGIN_EXAMPLE
Submitted batch job 4117546

Obsid 1H0707_hiflux_fmax
chi^2 = 2.351987e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.100000e+01 (+1.830836e+00 -3.788007e+00)
Parameter Gamma1 = 2.500000e+00 (+0.000000e+00 -2.623141e-01)
Parameter Gamma2 = 1.700000e+00 (+8.333369e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.000000e+02 (+1.253233e+02 -9.009377e+01)
Parameter t_shift = 2.000000e+01 (+1.174963e+01 -1.447716e+01)


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.825993e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.255366           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               11           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

lag_freq(1).log_mass,6.255366e+00,+8.542909e-03,-9.252513e-03
  Parameter 2 = 6.255366e+00 (6.246113e+00 - 6.263909e+00)

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_hiflux_fmax_best_fit.png

** Hi-cts>20: for $~f_{max}$

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_hi_cts_lc_data.sl=

Lags found
#+BEGIN_EXAMPLE
1.085714e-04,2.857143e-05,1.884863e+01,9.813812e+01
1.861224e-04,4.897959e-05,2.356483e+02,3.918422e+01
3.190671e-04,8.396501e-05,1.464038e+02,2.042925e+01
5.469721e-04,1.439400e-04,-1.276660e+00,1.269852e+01
9.376664e-04,2.467543e-04,-1.763777e+01,7.276261e+00
1.607428e-03,4.230074e-04,-3.251954e+01,3.934424e+00
2.755591e-03,7.251556e-04,-7.657706e+00,2.240515e+00
#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_lagfreq_hi_cts_lc_fmax.gif


#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("1H0707-495-hi-cts-time-lags-fmax.fits");
r=load_rmf("1H0707-495-hi-cts-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE



Fit ECM

1H0707-hi-cts-lc-data.sl

#+BEGIN_EXAMPLE
Submitted batch job 4117609

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.489644e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.330814           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               20           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0



Obsid 1H0707_hi_cts_fmax
chi^2 = 1.010813e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 2.000000e+01 (+0.000000e+00 -1.480007e+00)
Parameter Gamma1 = 3.000000e+00 (+0.000000e+00 -6.770687e-01)
Parameter Gamma2 = 2.400000e+00 (+4.351063e-02 -6.825758e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -5.508946e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.500000e+02 (+3.606996e+00 -1.231056e+01)
Parameter t_shift = 2.000000e+01 (+5.384799e+00 -6.359038e+00)

lag_freq(1).log_mass,6.330814e+00,+2.201794e-02,-1.459252e-02
  Parameter 2 = 6.330814e+00 (6.316221e+00 - 6.352832e+00)



#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_hi_cts_fmax_best_fit.png

** Med-flux: for $~f_{max}$

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_medflux.sl=

Lags found
#+BEGIN_EXAMPLE
1.085714e-04,2.857143e-05,6.233710e+02,6.191817e+02
1.861224e-04,4.897959e-05,2.254824e+01,1.211710e+02
3.190671e-04,8.396501e-05,-4.903933e+00,3.250190e+01
5.469721e-04,1.439400e-04,1.749989e+01,3.857641e+01
9.376664e-04,2.467543e-04,4.711189e+01,2.138309e+01
1.607428e-03,4.230074e-04,-3.568607e+01,9.631117e+00
2.755591e-03,7.251556e-04,-7.437850e+00,7.081652e+00
#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_lagfreq_medflux_fmax.gif

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("1H0707-495-med-time-lags-fmax.fits");
r=load_rmf("1H0707-495-med-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE


Fit ECM

1H0707-medflux-fit-error.sl

#+BEGIN_EXAMPLE
Submitted batch job 4117614


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.610026e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         5.839317           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1              100           0           0

Obsid 1H0707_medflux_fmax
chi^2 = 1.187804e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.000000e+02 (+0.000000e+00 -1.092557e+02)
Parameter t_shift = 1.000000e+02 (+0.000000e+00 -3.688550e+01)

lag_freq(1).log_mass,5.839317e+00,+5.670655e-02,-6.961025e-02
  Parameter 2 = 5.839317e+00 (5.769706e+00 - 5.896023e+00)

........................................................................


#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_medflux_fmax_best_fit.png

** Lo-flux: for $~f_{max}$

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_lo_flux.sl=

Lags found
#+BEGIN_EXAMPLE
1.085714e-04,2.857143e-05,2.947609e+02,1.275105e+02
1.861224e-04,4.897959e-05,1.333415e+02,5.355345e+01
3.190671e-04,8.396501e-05,1.292101e+02,5.232859e+01
5.469721e-04,1.439400e-04,2.705473e+01,4.634820e+01
9.376664e-04,2.467543e-04,-2.525674e+01,2.247588e+01
1.607428e-03,4.230074e-04,-2.871260e+01,1.052060e+01
2.755591e-03,7.251556e-04,-8.652118e+00,5.010411e+00
#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_lagfreq_loflux_fmax.gif


#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("1H0707-495-loflux-time-lags-fmax.fits");
r=load_rmf("1H0707-495-loflux-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE


Fit ECM

1H0707-loflux-fit-error.sl

#+BEGIN_EXAMPLE
Submitted batch job 4117618

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.332146e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.251642           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                8           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                1           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              220           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0


Obsid 1H0707_loflux_fmax
chi^2 = 7.392486e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 8.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.200000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 5.000000e+01 (+0.000000e+00 -0.000000e+00)

lag_freq(1).log_mass,6.251642e+00,+4.584799e-02,-9.827978e-02
  Parameter 2 = 6.251642e+00 (6.153362e+00 - 6.297490e+00)

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_loflux_fmax_best_fit.png

** Lo-cts<20: for $~f_{max}$

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_lo_cts_lc_data.sl=

Lags found
#+BEGIN_EXAMPLE
6.785714e-05,1.785714e-05,6.715279e+01,1.331887e+02
1.163265e-04,3.061224e-05,1.320719e+02,7.668210e+01
1.994169e-04,5.247813e-05,1.117502e+02,3.881146e+01
3.418576e-04,8.996252e-05,8.321893e+01,2.106502e+01
5.860415e-04,1.542215e-04,-2.352985e+01,1.171150e+01
1.004643e-03,2.643796e-04,-2.023512e+01,6.923334e+00
1.722244e-03,4.532222e-04,-1.956463e+01,3.788993e+00
#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_lagfreq_lo_cts_lc_fmax.gif

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("1H0707-495-lo-cts-time-lags-fmax.fits");
r=load_rmf("1H0707-495-lo-cts-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE


Fit ECM

1H0707-lo-cts-lc-data.sl

#+BEGIN_EXAMPLE
Submitted batch job 4117622

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      2.48114e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.147568           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               16           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Obsid 1H0707_lo_cts_fmax
chi^2 = 2.068729e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.600000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.500000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 2.000000e+01 (+5.319615e-01 -0.000000e+00)

lag_freq(1).log_mass,6.258481e+00,+2.027798e-02,-2.491601e-02
  Parameter 2 = 6.258481e+00 (6.233565e+00 - 6.278759e+00)

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_lo_cts_fmax_best_fit.png

** OBS 0110890201 for $~f_{max}$

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_0110890201_segs.sl=

Lags found

#+BEGIN_EXAMPLE
1.066667e-04,2.666667e-05,1.878117e+02,1.976700e+02
1.777778e-04,4.444444e-05,-1.279947e+00,5.553634e+01
2.962963e-04,7.407407e-05,5.765143e+01,6.771361e+01
4.938272e-04,1.234568e-04,-1.033002e+02,6.700916e+01
8.230453e-04,2.057613e-04,-4.767803e+00,5.639420e+01
1.371742e-03,3.429355e-04,-7.315667e+00,1.663436e+01
2.286237e-03,5.715592e-04,-3.297055e+01,1.217980e+01
#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0110890201_lagfreq_segs.gif

*ECM fit*

=1H0707-0110890201-fit-segs.sl=

#+BEGIN_EXAMPLE

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001033583           0       0.001
  2  lag_freq(1).log_mass   0     0           5.8989           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              600           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0

Obsid 1H0707_0110890201_segs
chi^2 = 2.236269e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 5.000000e+01 (+0.000000e+00 -0.000000e+00)

lag_freq(1).log_mass,5.898900e+00,+1.430149e-01,-6.403983e-02
  Parameter 2 = 5.898900e+00 (5.834861e+00 - 6.041915e+00)

..................................................................

Submitted batch job 4098134




Copy to WWW:

lyra:/home/WWW/steff/ecm> scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0110890201_fmax_best_fit.png .


#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_fmax_best_fit.png

** OBS 0110890201 for $~f_{max}$ isis emcee

PATH TO DATA = =/data/typhon1/reverb/1H0707-495/isis_emcee/=

Fit script = =1H0707-0110890201-fit-emcee.sl=

Fitting Parameter file =1H0707_0110890201_fmax_best_fit.par=

Make good image of the ECM Model fit

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0110890201_best fit.ps/cps");
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
plot_comps(1,popt,&plot_data);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgsci(1); % make line colour black
_pgdraw(1,0);
close_plot(pid);
#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_fmax_best_fit.png

Obtain par file from BC4

#+BEGIN_EXAMPLE
scp -r so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0110890201_fmax_best_fit.par .
#+END_EXAMPLE

This model fit with χ²=2.24 and the parameters for this particular fit are:

| lag_freq |                      |        |        |              |     |       |
|      idx | param                | tie-to | freeze |        value | min |   max |
|        1 | lag_freq(1).norm     |      0 |      0 | 0.0001033583 |   0 | 0.001 |
|        2 | lag_freq(1).log_mass |      0 |      0 |       5.8989 |   5 |     7 |
|        3 | lag_freq(1).i        |      0 |      1 |           53 |   0 |     0 |
|        4 | lag_freq(1).a        |      0 |      1 |        0.998 |   0 |     0 |
|        5 | lag_freq(1).h1       |      0 |      1 |            2 |   0 |     0 |
|        6 | lag_freq(1).h2       |      0 |      1 |            4 |   0 |     0 |
|        7 | lag_freq(1).Gamma1   |      0 |      1 |          2.6 |   0 |     0 |
|        8 | lag_freq(1).Gamma2   |      0 |      1 |          2.5 |   0 |     0 |
|        9 | lag_freq(1).Fe       |      0 |      1 |            1 |   0 |     0 |
|       10 | lag_freq(1).xi       |      0 |      1 |            0 |   0 |     0 |
|       11 | lag_freq(1).p        |      0 |      1 |            0 |   0 |     0 |
|       12 | lag_freq(1).b        |      0 |      1 |            2 |   0 |     0 |
|       13 | lag_freq(1).q2       |      0 |      1 |          0.5 |   0 |     0 |
|       14 | lag_freq(1).t_max    |      0 |      1 |          600 |   0 |     0 |
|       15 | lag_freq(1).t_shift  |      0 |      1 |           50 |   0 |     0 |



#+BEGIN_EXAMPLE
isis

.source("1H0707-0110890201-fit-emcee.sl");

[detached from 114232.pts-8.hm00] - started 27th 0955



where

% Perform MCMC
emcee(500, 5000; output="1H0707_0110890201_fmax_chain.fits", serial);

% Read the chain-file
(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("1H0707_0110890201_fmax_chain.fits");
#+END_EXAMPLE


*Paths of the walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_fmax_walkers-1.png


*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_fmax_mass_accept_rate-1.png


Obtain the Norm pobability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_fmax_norm_prob-1.png


Obtain the Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_fmax_mass_prob-1.png

*Contours: paths in 2D*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_fmax_chain_hist2d-1.png

*Chain statistics*


#+BEGIN_EXAMPLE
s=600; % start at this iteration step
min(min_statistic[[s:]]);

2.2362697267688487
#+END_EXAMPLE


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_fmax_statistics-1.png


Error analysis

conf68

#+BEGIN_EXAMPLE
isis> conf_min;
5.842016124725342
isis> conf_max;
5.923010540008545
isis> conf_mean;
5.882513332366944

 5.882513332366944-5.842016124725342 = 0.04049720764160192

#+END_EXAMPLE

#+CAPTION: The 68% confidence probability for 1H0707-495 Mass value where $\mu = 5.882\pm0.04$ (solid blue line. Error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_fmax_logmass_conf68-1.png



#+CAPTION: The 90% confidence probability for 1H0707-495 Mass value where $\mu =\pm0.0$ (solid blue line) with the error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_fmax_logmass_conf90.gif

** OBS 0148010301 for $~f_{max}$

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_0148010301_segs.sl=


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0148010301_lagfreq_segs.gif

*ECM fit*

=1H0707-0148010301-fit-segs.sl=

#+BEGIN_EXAMPLE

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.481053e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.315708           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               12           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              700           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0


Obsid 1H0707_0148010301_fmax
chi^2 = 1.519381e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.200000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 7.000000e+02 (+8.467528e+00 -0.000000e+00)
Parameter t_shift = 3.000000e+01 (+0.000000e+00 -0.000000e+00)


lag_freq(1).log_mass,6.315708e+00,+2.959821e-02,-3.176566e-02
  Parameter 2 = 6.315708e+00 (6.283942e+00 - 6.345306e+00)



Copy to WWW: e.g

lyra:/home/WWW/steff/ecm> scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0110890201_fmax_best_fit.png .


#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0148010301_fmax_best_fit.png

** OBS 0148010301  for $~f_{max}$ isis emcee

PATH TO DATA = =/data/typhon1/reverb/1H0707-495/isis_emcee/=

Fit script = =1H0707-0148010301-fit-emcee.sl=

Fitting Parameter file =1H0707_0148010301_fmax_best_fit.par=

Make good image of the ECM Model fit

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0148010301_best fit.ps/cps");
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
plot_comps(1,popt,&plot_data);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgsci(1); % make line colour black
_pgdraw(1,0);
close_plot(pid);
#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0148010301_fmax_best_fit.png

Obtain par file from BC4

#+BEGIN_EXAMPLE
scp -r so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0148010301_fmax_best_fit.par .
#+END_EXAMPLE

This model fit with χ²=1.52 and the parameters for this particular fit are:

| lag_freq |                      |        |        |              |     |       |
|      idx | param                | tie-to | freeze |        value | min |   max |
|        1 | lag_freq(1).norm     |      0 |      0 | 1.481053e-05 |   0 | 0.001 |
|        2 | lag_freq(1).log_mass |      0 |      0 |     6.315708 |   5 |     7 |
|        3 | lag_freq(1).i        |      0 |      1 |           53 |   0 |     0 |
|        4 | lag_freq(1).a        |      0 |      1 |        0.998 |   0 |     0 |
|        5 | lag_freq(1).h1       |      0 |      1 |            2 |   0 |     0 |
|        6 | lag_freq(1).h2       |      0 |      1 |           12 |   0 |     0 |
|        7 | lag_freq(1).Gamma1   |      0 |      1 |          2.8 |   0 |     0 |
|        8 | lag_freq(1).Gamma2   |      0 |      1 |          2.3 |   0 |     0 |
|        9 | lag_freq(1).Fe       |      0 |      1 |            1 |   0 |     0 |
|       10 | lag_freq(1).xi       |      0 |      1 |            0 |   0 |     0 |
|       11 | lag_freq(1).p        |      0 |      1 |            0 |   0 |     0 |
|       12 | lag_freq(1).b        |      0 |      1 |            2 |   0 |     0 |
|       13 | lag_freq(1).q2       |      0 |      1 |          0.5 |   0 |     0 |
|       14 | lag_freq(1).t_max    |      0 |      1 |          700 |   0 |     0 |
|       15 | lag_freq(1).t_shift  |      0 |      1 |           30 |   0 |     0 |

#+BEGIN_EXAMPLE
isis

.source("1H0707-0148010301-fit-emcee.sl");

where

% Perform MCMC
emcee(500, 5000; output="1H0707_0148010301_fmax_chain.fits", serial);

% Read the chain-file
(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("1H0707_0148010301_fmax_chain.fits");
#+END_EXAMPLE


*Paths of the walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0148010301_fmax_walkers-1.png


*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0148010301_fmax_mass_accept_rate-1.png


Obtain the Norm pobability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0148010301_fmax_norm_prob-1.png


Obtain the Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0148010301_fmax_mass_prob-1.png

*Contours: paths in 2D*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0148010301_fmax_chain_hist2d-1.png

*Chain statistics*

#+BEGIN_EXAMPLE
s=600; % start at this iteration step
min(min_statistic[[s:]]);

 min(min_statistic[[s:]]);
1.5193816590948659

#+END_EXAMPLE

Plotting the statistic array is another diagnostic tool:

#+BEGIN_EXAMPLE

n=length(max_statistic)-1;
yrange(min(min_statistic[[s:]])*.9, max(max_statistic[[s:]])*1.1);
plot([s:n], min_statistic[[600:]]);
oplot([s:n], max_statistic[[600:]]);
oplot([s:n], med_statistic[[600:]]);

#+END_EXAMPLE

Make good image of the statistics

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0110890201_fmax_statistics.ps/cps");
charsize(1.3); %good font size
_pgscf(2); %make font roman
plot([s:n], min_statistic[[600:]]);
oplot([s:n], max_statistic[[600:]]);
oplot([s:n], med_statistic[[600:]]);
close_plot(pid);
#+END_EXAMPLE


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0148010301_fmax_statistics-1.png


Error analysis

Conf 68
#+BEGIN_EXAMPLE
isis> conf_min;
6.292138733863831
isis> conf_max;
6.341024932861328
isis> conf_mean;
6.316581833362579

>>> 6.316581833362579-6.292138733863831 = 0.024443099498748566


#+END_EXAMPLE



#+CAPTION: The 68% confidence probability for 1H0707-495 Mass value where $\mu = 6.31\pm0.02$ (solid blue line. Error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0148010301_fmax_logmass_conf68-1.png



#+CAPTION: The 90% confidence probability for 1H0707-495 Mass value where $\mu = \pm0.0$ (solid blue line) with the error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0148010301_fmax_logmass_conf90.gif

** OBS 0506200201 for $~f_{max}$

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_0506200201_segs.sl=


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0506200201_lagfreq_segs.gif

*ECM fit*

=1H0707-0506200201-fit-segs.sl=

#+BEGIN_EXAMPLE

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.820776e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.452342           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               60           0           0

Obsid 1H0707_0506200201_fmax
chi^2 = 1.889556e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 6.000000e+01 (+-1.227502e+01 -2.253998e+01)

lag_freq(1).log_mass,6.452342e+00,+4.602078e-02,-2.740801e-02
  Parameter 2 = 6.452342e+00 (6.424934e+00 - 6.498363e+00)


Copy to WWW: e.g

lyra:/home/WWW/steff/ecm> scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0110890201_fmax_best_fit.png .


#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_fmax_best_fit.png

** OBS 0506200201 for $~f_{max}$ isis emcee

PATH TO DATA = =/data/typhon1/reverb/1H0707-495/isis_emcee/=

Fit script = =1H0707-0506200201-fit-emcee.sl=

Fitting Parameter file =1H0707_0506200201_fmax_best_fit.par=

Make good image of the ECM Model fit

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0506200201_fmax_best fit.ps/cps");
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
plot_comps(1,popt,&plot_data);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgsci(1); % make line colour black
_pgdraw(1,0);
close_plot(pid);
#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_fmax_best_fit.png

Obtain par file from BC4

#+BEGIN_EXAMPLE
scp -r so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0148010301_fmax_best_fit.par .
#+END_EXAMPLE

This model fit with χ²=0.19 and the parameters for this particular fit are:

| lag_freq |                      |        |        |              |     |       |
|      idx | param                | tie-to | freeze |        value | min |   max |
|        1 | lag_freq(1).norm     |      0 |      0 | 1.820776e-05 |   0 | 0.001 |
|        2 | lag_freq(1).log_mass |      0 |      0 |     6.452342 |   5 |     7 |
|        3 | lag_freq(1).i        |      0 |      1 |           53 |   0 |     0 |
|        4 | lag_freq(1).a        |      0 |      1 |        0.998 |   0 |     0 |
|        5 | lag_freq(1).h1       |      0 |      1 |            2 |   0 |     0 |
|        6 | lag_freq(1).h2       |      0 |      1 |            5 |   0 |     0 |
|        7 | lag_freq(1).Gamma1   |      0 |      1 |          2.7 |   0 |     0 |
|        8 | lag_freq(1).Gamma2   |      0 |      1 |          2.5 |   0 |     0 |
|        9 | lag_freq(1).Fe       |      0 |      1 |            1 |   0 |     0 |
|       10 | lag_freq(1).xi       |      0 |      1 |            0 |   0 |     0 |
|       11 | lag_freq(1).p        |      0 |      1 |            0 |   0 |     0 |
|       12 | lag_freq(1).b        |      0 |      1 |            3 |   0 |     0 |
|       13 | lag_freq(1).q2       |      0 |      1 |          0.5 |   0 |     0 |
|       14 | lag_freq(1).t_max    |      0 |      1 |          400 |   0 |     0 |
|       15 | lag_freq(1).t_shift  |      0 |      1 |           60 |   0 |     0 |


#+BEGIN_EXAMPLE
isis

.source("1H0707-0506200201-fit-emcee.sl");

where

% Perform MCMC
emcee(500, 5000; output="1H0707_0506200201_fmax_chain.fits", serial);

% Read the chain-file
(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("1H0707_0506200201_fmax_chain.fits");
#+END_EXAMPLE


*Paths of the walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_fmax_walkers-1.png


*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_fmax_mass_accept_rate-1.png


Obtain the Norm pobability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_fmax_norm_prob-1.png


Obtain the Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_fmax_mass_prob-1.png

*Contours: paths in 2D*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_fmax_chain_hist2d-1.png

*Chain statistics*


#+BEGIN_EXAMPLE
s=1200; % start at this iteration step
min(min_statistic[[s:]]);

 min(min_statistic[[s:]]);
0.18895705381945502

#+END_EXAMPLE

Plotting the statistic array is another diagnostic tool:

Make good image of the statistics

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0506200201_fmax_statistics.ps/cps");
charsize(1.3); %good font size
_pgscf(2); %make font roman
plot([s:n], min_statistic[[1200:]]);
oplot([s:n], max_statistic[[1200:]]);
oplot([s:n], med_statistic[[1200:]]);
close_plot(pid);
#+END_EXAMPLE


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_fmax_statistics-1.png


Error analysis

#+BEGIN_EXAMPLE

 min(min_statistic[[s:]]);s=1200; % start at this iteration step
0.18895705381945502


Conf 68
isis> conf_min;
6.4316519927978515
isis> conf_max;
6.478136477470398
isis> conf_mean;
6.454894235134125

>>> 6.454894235134125-6.4316519927978515 = 0.023242242336273478


#+END_EXAMPLE


#+CAPTION: The 68% confidence probability for 1H0707-495 Mass value where $\mu = 6.45\pm0.02$ (solid blue line). Error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_fmax_logmass_conf68-1.png



#+CAPTION: The 90% confidence probability for 1H0707-495 Mass value where $\mu = 6.0\pm0.0$ (solid blue line) with the error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_fmax_logmass_conf90.gif

** OBS 0506200301 for $~f_{max}$

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_0506200301_segs.sl=


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0506200301_lagfreq_segs.gif

*ECM fit*

=1H0707-0506200301-fit-segs.sl=

#+BEGIN_EXAMPLE

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.674851e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.168809           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               60           0           0


Obsid 1H0707_0506200301_fmax
chi^2 = 4.677898e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.653738e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.000000e+02 (+0.000000e+00 -1.630800e+02)
Parameter t_shift = 6.000000e+01 (+1.587733e+01 -5.583341e+01)

lag_freq(1).log_mass,6.168809e+00,+4.810561e-02,-9.628949e-02
  Parameter 2 = 6.168809e+00 (6.072519e+00 - 6.216914e+00)



Copy to WWW: e.g

lyra:/home/WWW/steff/ecm> scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0506200301_fmax_best_fit.png .


#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200301_fmax_best_fit.png

** OBS 0506200301 for $~f_{max}$ isis emcee

PATH TO DATA = =/data/typhon1/reverb/1H0707-495/isis_emcee/=

Fit script = =1H0707-0506200301-fit-emcee.sl=

Fitting Parameter file =1H0707_0506200301_fmax_best_fit.par=

Make good image of the ECM Model fit

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0506200301_fmax_best fit.ps/cps");
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
plot_comps(1,popt,&plot_data);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgsci(1); % make line colour black
_pgdraw(1,0);
close_plot(pid);
#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200301_fmax_best_fit.png

Obtain par file from BC4

#+BEGIN_EXAMPLE
scp -r so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0148010301_fmax_best_fit.par .
#+END_EXAMPLE

This model fit with χ²=0.47 and the parameters for this particular fit are:

| lag_freq |                      |        |        |              |     |       |
|      idx | param                | tie-to | freeze |        value | min |   max |
|        1 | lag_freq(1).norm     |      0 |      0 | 2.674851e-05 |   0 | 0.001 |
|        2 | lag_freq(1).log_mass |      0 |      0 |     6.168809 |   5 |     7 |
|        3 | lag_freq(1).i        |      0 |      1 |           53 |   0 |     0 |
|        4 | lag_freq(1).a        |      0 |      1 |        0.998 |   0 |     0 |
|        5 | lag_freq(1).h1       |      0 |      1 |            2 |   0 |     0 |
|        6 | lag_freq(1).h2       |      0 |      1 |            3 |   0 |     0 |
|        7 | lag_freq(1).Gamma1   |      0 |      1 |          2.2 |   0 |     0 |
|        8 | lag_freq(1).Gamma2   |      0 |      1 |            2 |   0 |     0 |
|        9 | lag_freq(1).Fe       |      0 |      1 |            1 |   0 |     0 |
|       10 | lag_freq(1).xi       |      0 |      1 |            0 |   0 |     0 |
|       11 | lag_freq(1).p        |      0 |      1 |            0 |   0 |     0 |
|       12 | lag_freq(1).b        |      0 |      1 |            3 |   0 |     0 |
|       13 | lag_freq(1).q2       |      0 |      1 |          0.5 |   0 |     0 |
|       14 | lag_freq(1).t_max    |      0 |      1 |          500 |   0 |     0 |
|       15 | lag_freq(1).t_shift  |      0 |      1 |           60 |   0 |     0 |

#+BEGIN_EXAMPLE
isis

.source("1H0707-0506200301-fit-emcee.sl");

where

% Perform MCMC
emcee(500, 5000; output="1H0707_0506200301_fmax_chain.fits", serial);

% Read the chain-file
(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("1H0707_0506200301_10K_fmax_chain.fits");
#+END_EXAMPLE


*Paths of the walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200301_fmax_walkers-1.png


/This did not converge, so a longer chain is required - run 500,
10000/

#+BEGIN_EXAMPLE
% Perform MCMC
emcee(500, 10000; output="1H0707_0506200301_10k_fmax_chain.fits", serial);
#+END_EXAMPLE


*Paths of the walkers with 10000 iterations*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200301_10k_fmax_walkers-1.png

*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200301_fmax_mass_accept_rate-1.png


Obtain the Norm pobability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200301_fmax_norm_prob-1.png


Obtain the Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200301_fmax_mass_prob-1.png

*Contours: paths in 2D*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200301_fmax_chain_hist2d-1.png

*Chain statistics*


#+BEGIN_EXAMPLE
s=1200; % start at this iteration step
min(min_statistic[[s:]]);
0.4677906127214885


#+END_EXAMPLE

Plotting the statistic array is another diagnostic tool:

Make good image of the statistics

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0506200301_fmax_statistics.ps/cps");
charsize(1.3); %good font size
_pgscf(2); %make font roman
plot([s:n], min_statistic[[1200:]]);
oplot([s:n], max_statistic[[1200:]]);
oplot([s:n], med_statistic[[1200:]]);
close_plot(pid);
#+END_EXAMPLE


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200301_fmax_statistics-1.png


Error analysis

#+BEGIN_EXAMPLE

 min(min_statistic[[s:]]);
isis> min(min_statistic[[s:]]);
0.4677906127214885

isis> conf_min;
6.093630981445313
isis> conf_max;
6.21800185918808
isis> conf_mean;
6.155816420316697

>>> 6.21800185918808-6.155816420316697 = 0.06218543887138317

#+END_EXAMPLE


#+CAPTION: The 68% confidence probability for 1H0707-495 Mass value where $\mu = 6.16\pm0.06$ (solid blue line. Error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200301_fmax_logmass_conf68-1.png



#+CAPTION: The 90% confidence probability for 1H0707-495 Mass value where $\mu = 0\pm0$ (solid blue line) with the error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200301_fmax_logmass_conf90.gif

** OBS 0506200401 for $~f_{max}$

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_0506200401_segs.sl=


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0506200401_lagfreq_segs.gif

*ECM fit*

=1H0707-0506200401-fit-segs.sl=

#+BEGIN_EXAMPLE
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.579158e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.537801           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               15           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid 1H0707_0506200401_fmax
chi^2 = 3.067381e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.500000e+01 (+1.653278e+01 -5.317322e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -3.499663e-01)
Parameter Gamma2 = 1.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.861785e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+2.381074e+01 -3.384129e+01)
Parameter t_shift = 2.000000e+01 (+9.779878e+00 -0.000000e+00)

lag_freq(1).log_mass,6.537801e+00,+1.119687e-02,-1.267481e-02
  Parameter 2 = 6.537801e+00 (6.525126e+00 - 6.548998e+00)

..................................................................................


Submitted batch job 4127056

Obsid 1H0707_0506200401_fmax
chi^2 = 3.067381e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.500000e+01 (+4.677360e+00 -5.317322e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -3.499663e-01)
Parameter Gamma2 = 1.800000e+00 (+8.409738e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.859128e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+2.381074e+01 -3.412787e+01)
Parameter t_shift = 2.000000e+01 (+9.779878e+00 -1.896378e+01)


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.579158e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.537801           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               15           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0




Copy to WWW: e.g

lyra:/home/WWW/steff/ecm> scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0506200401_fmax_best_fit.png .


#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200401_fmax_best_fit.png

** OBS 0506200401 for $~f_{max}$ isis emcee

PATH TO DATA = =/data/typhon1/reverb/1H0707-495/isis_emcee/=

Fit script = =1H0707-0506200401-fit-emcee.sl=

Fitting Parameter file =1H0707_0506200401_fmax_best_fit.par=

Make good image of the ECM Model fit

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0506200401_fmax_best fit.ps/cps");
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
plot_comps(1,popt,&plot_data);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgsci(1); % make line colour black
_pgdraw(1,0);
close_plot(pid);
#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200401_fmax_best_fit.png

Obtain par file from BC4

#+BEGIN_EXAMPLE
scp -r so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0148010301_fmax_best_fit.par .
#+END_EXAMPLE

This model fit with χ²= 3.07 and the parameters for this particular fit are:

| lag_freq |                      |        |        |              |     |       |
|      idx | param                | tie-to | freeze |        value | min |   max |
|        1 | lag_freq(1).norm     |      0 |      0 | 2.579158e-05 |   0 | 0.001 |
|        2 | lag_freq(1).log_mass |      0 |      0 |     6.537801 |   5 |     7 |
|        3 | lag_freq(1).i        |      0 |      1 |           53 |   0 |     0 |
|        4 | lag_freq(1).a        |      0 |      1 |        0.998 |   0 |     0 |
|        5 | lag_freq(1).h1       |      0 |      1 |            2 |   0 |     0 |
|        6 | lag_freq(1).h2       |      0 |      1 |           15 |   0 |     0 |
|        7 | lag_freq(1).Gamma1   |      0 |      1 |          2.8 |   0 |     0 |
|        8 | lag_freq(1).Gamma2   |      0 |      1 |          1.8 |   0 |     0 |
|        9 | lag_freq(1).Fe       |      0 |      1 |            1 |   0 |     0 |
|       10 | lag_freq(1).xi       |      0 |      1 |            0 |   0 |     0 |
|       11 | lag_freq(1).p        |      0 |      1 |            0 |   0 |     0 |
|       12 | lag_freq(1).b        |      0 |      1 |            3 |   0 |     0 |
|       13 | lag_freq(1).q2       |      0 |      1 |          0.5 |   0 |     0 |
|       14 | lag_freq(1).t_max    |      0 |      1 |          400 |   0 |     0 |
|       15 | lag_freq(1).t_shift  |      0 |      1 |           20 |   0 |     0 |



#+BEGIN_EXAMPLE
isis

.source("1H0707-0506200401-fit-emcee.sl");

where

% Perform MCMC
emcee(500, 5000; output="1H0707_0506200401_fmax_chain.fits", serial);

% Read the chain-file
(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("1H0707_0506200401_fmax_chain.fits");
#+END_EXAMPLE


*Paths of the walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200401_fmax_walkers-1.png


*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200401_fmax_mass_accept_rate-1.png


Obtain the Norm pobability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200401_fmax_norm_prob-1.png


Obtain the Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200401_fmax_mass_prob-1.png

*Contours: paths in 2D*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200401_fmax_chain_hist2d-1.png

*Chain statistics*


#+BEGIN_EXAMPLE
s=4500; % start at this iteration step
min(min_statistic[[s:]]);

3.0553976562303404


#+END_EXAMPLE

Plotting the statistic array is another diagnostic tool:

Make good image of the statistics

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0506200401_fmax_statistics.ps/cps");
charsize(1.3); %good font size
_pgscf(2); %make font roman
plot([s:n], min_statistic[[4500:]]);
oplot([s:n], max_statistic[[4500:]]);
oplot([s:n], med_statistic[[4500:]]);
close_plot(pid);
#+END_EXAMPLE


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200401_fmax_statistics-1.png


Error analysis

#+BEGIN_EXAMPLE
isis> conf_min;
6.526493330001831
isis> conf_max;
6.547235260009765
isis> conf_mean;
6.536864295005798
isis>

>>> 6.536864295005798-6.526493330001831 = 0.010370965003967392

#+END_EXAMPLE


#+CAPTION: The 68% confidence probability for 1H0707-495 Mass value where $\mu = 6.54\pm0.01$ (solid blue line) with the error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200401_fmax_logmass_conf68-1.png



#+CAPTION: The 90% confidence probability for 1H0707-495 Mass value where $\mu = 0\pm0$ (solid blue line) with the error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200401_fmax_logmass_conf90.gif

** OBS 0506200501 for $~f_{max}$

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_0506200501_segs.sl=


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0506200501_lagfreq_segs.gif

*ECM fit*

=1H0707-0506200501-fit-fmax.sl=

#+BEGIN_EXAMPLE

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      1.79121e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.852169           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               18           0           0
  7  lag_freq(1).Gamma1     0     1              3.1           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid 1H0707_0506200501_fmax
chi^2 = 1.336756e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.800000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 3.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+0.000000e+00 -2.932913e+02)
Parameter t_shift = 2.000000e+01 (+1.011491e+01 -0.000000e+00)

lag_freq(1).log_mass,6.852169e+00,+4.944752e-02,-4.607638e-02
  Parameter 2 = 6.852169e+00 (6.806093e+00 - 6.901617e+00)

......................................................................


Obsid 1H0707_0506200501_fmax
chi^2 = 1.304634e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.700000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+0.000000e+00 -1.724827e+02)
Parameter t_shift = 2.000000e+01 (+0.000000e+00 -0.000000e+00)

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.206969e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.492098           5         6.5
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               17           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

lag_freq(1).log_mass,6.492098e+00,+7.901768e-03,-4.514576e-02
  Parameter 2 = 6.492098e+00 (6.446952e+00 - 6.500000e+00)


Copy to WWW: e.g

lyra:/home/WWW/steff/ecm> scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0506200501_fmax_best_fit.png .


#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200501_fmax_best_fit.png

** OBS 0506200501 for $~f_{max}$ isis emcee

PATH TO DATA = =/data/typhon1/reverb/1H0707-495/isis_emcee/=

Fit script = =1H0707-0506200501-fit-emcee.sl=

Fitting Parameter file =1H0707_0506200501_fmax_best_fit.par=

Make good image of the ECM Model fit

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0506200501_fmax_best fit.ps/cps");
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
plot_comps(1,popt,&plot_data);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgsci(1); % make line colour black
_pgdraw(1,0);
close_plot(pid);
#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200501_fmax_best_fit.png

Obtain par file from BC4

#+BEGIN_EXAMPLE
scp -r so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0148010301_fmax_best_fit.par .
#+END_EXAMPLE

This model fit with χ² = 0.13 and the parameters for this particular fit are:

| lag_freq |                      |        |        |             |     |       |
|      idx | param                | tie-to | freeze |       value | min |   max |
|        1 | lag_freq(1).norm     |      0 |      0 | 1.79121e-05 |   0 | 0.001 |
|        2 | lag_freq(1).log_mass |      0 |      0 |    6.852169 |   5 |     7 |
|        3 | lag_freq(1).i        |      0 |      1 |          53 |   0 |     0 |
|        4 | lag_freq(1).a        |      0 |      1 |       0.998 |   0 |     0 |
|        5 | lag_freq(1).h1       |      0 |      1 |           2 |   0 |     0 |
|        6 | lag_freq(1).h2       |      0 |      1 |          18 |   0 |     0 |
|        7 | lag_freq(1).Gamma1   |      0 |      1 |         3.1 |   0 |     0 |
|        8 | lag_freq(1).Gamma2   |      0 |      1 |         1.8 |   0 |     0 |
|        9 | lag_freq(1).Fe       |      0 |      1 |           1 |   0 |     0 |
|       10 | lag_freq(1).xi       |      0 |      1 |           0 |   0 |     0 |
|       11 | lag_freq(1).p        |      0 |      1 |           0 |   0 |     0 |
|       12 | lag_freq(1).b        |      0 |      1 |           3 |   0 |     0 |
|       13 | lag_freq(1).q2       |      0 |      1 |         0.5 |   0 |     0 |
|       14 | lag_freq(1).t_max    |      0 |      1 |         450 |   0 |     0 |
|       15 | lag_freq(1).t_shift  |      0 |      1 |          20 |   0 |     0 |


#+BEGIN_EXAMPLE
isis

.source("1H0707-0506200501-fit-emcee.sl");

where

% Perform MCMC
emcee(500, 10000; output="1H0707_0506200501_fmax_chain.fits", serial);

% Read the chain-file
(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("1H0707_0506200501_fmax_chain.fits");
#+END_EXAMPLE


*Paths of the walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200501_fmax_walkers-1.png


*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200501_fmax_mass_accept_rate-1.png


Obtain the Norm pobability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200501_fmax_norm_prob-1.png


Obtain the Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200501_fmax_mass_prob-1.png

*Contours: paths in 2D*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200501_fmax_chain_hist2d-1.png

*Chain statistics*


#+BEGIN_EXAMPLE
s=3500; % start at this iteration step
min(min_statistic[[s:]]);


0.26735121396051625

#+END_EXAMPLE


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200501_fmax_statistics-1.png


Error analysis

#+BEGIN_EXAMPLE
isis> conf_min;
6.834731454849243
isis> conf_max;
6.871875667572022
isis> conf_mean;
6.853303561210632

>>> 6.853303561210632-6.834731454849243 = 0.01857210636138884

#+END_EXAMPLE


#+CAPTION: The 68% confidence probability for 1H0707-495 Mass value where $\mu = 6.853\pm0.0186$ (solid blue line) with the error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200501_fmax_logmass_conf68-1.png



#+CAPTION: The 90% confidence probability for 1H0707-495 Mass value where $\mu = 0\pm0$ (solid blue line) with the error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200501_fmax_logmass_conf90.gif

** OBS 0511580101 for $~f_{max}$

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_0511580101_segs.sl=


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0511580101_lagfreq_segs.gif

*ECM fit*

=1H0707-0511580101-fit-fmax.sl=

#+BEGIN_EXAMPLE

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.768596e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.206829           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               19           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0

Obsid 1H0707_0511580101_fmax
chi^2 = 1.014190e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.900000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+0.000000e+00 -2.213369e+02)
Parameter t_shift = 3.000000e+01 (+8.441424e+01 -0.000000e+00)

lag_freq(1).log_mass,6.206829e+00,+1.443235e-02,-1.694364e-02
  Parameter 2 = 6.206829e+00 (6.189886e+00 - 6.221262e+00)





Copy to WWW: e.g

lyra:/home/WWW/steff/ecm> scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0511580101_fmax_best_fit.png .


#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580101_fmax_best_fit.png

** OBS 0511580101 for $~f_{max}$ isis emcee

PATH TO DATA = =/data/typhon1/reverb/1H0707-495/isis_emcee/=

Fit script = =1H0707-0511580101-fit-emcee.sl=

Fitting Parameter file =1H0707_0511580101_fmax_best_fit.par=

Make good image of the ECM Model fit

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0511580101_fmax_best fit.ps/cps");
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
plot_comps(1,popt,&plot_data);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgsci(1); % make line colour black
_pgdraw(1,0);
close_plot(pid);
#+END_EXAMPLE

Obtain par file from BC4

#+BEGIN_EXAMPLE
scp -r so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0148010301_fmax_best_fit.par .
#+END_EXAMPLE

This model fit with χ² = 1.01 and the parameters for this particular fit
are:

| lag_freq |                      |        |        |              |     |       |
|      idx | param                | tie-to | freeze |        value | min |   max |
|        1 | lag_freq(1).norm     |      0 |      0 | 3.768596e-05 |   0 | 0.001 |
|        2 | lag_freq(1).log_mass |      0 |      0 |     6.206829 |   5 |     7 |
|        3 | lag_freq(1).i        |      0 |      1 |           53 |   0 |     0 |
|        4 | lag_freq(1).a        |      0 |      1 |        0.998 |   0 |     0 |
|        5 | lag_freq(1).h1       |      0 |      1 |            2 |   0 |     0 |
|        6 | lag_freq(1).h2       |      0 |      1 |           19 |   0 |     0 |
|        7 | lag_freq(1).Gamma1   |      0 |      1 |          2.5 |   0 |     0 |
|        8 | lag_freq(1).Gamma2   |      0 |      1 |            2 |   0 |     0 |
|        9 | lag_freq(1).Fe       |      0 |      1 |            1 |   0 |     0 |
|       10 | lag_freq(1).xi       |      0 |      1 |            3 |   0 |     0 |
|       11 | lag_freq(1).p        |      0 |      1 |            0 |   0 |     0 |
|       12 | lag_freq(1).b        |      0 |      1 |            2 |   0 |     0 |
|       13 | lag_freq(1).q2       |      0 |      1 |          0.5 |   0 |     0 |
|       14 | lag_freq(1).t_max    |      0 |      1 |          400 |   0 |     0 |
|       15 | lag_freq(1).t_shift  |      0 |      1 |           30 |   0 |     0 |


#+BEGIN_EXAMPLE
isis

.source("1H0707-0511580101-fit-emcee.sl");

where

% Perform MCMC
emcee(500, 10000; output="1H0707_0511580101_fmax_chain.fits", serial);

% Read the chain-file
(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("1H0707_0511580101_fmax_chain.fits");
#+END_EXAMPLE


*Paths of the walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580101_fmax_walkers-1.png


*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580101_fmax_mass_accept_rate-1.png


Obtain the Norm pobability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580101_fmax_norm_prob-1.png


Obtain the Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580101_fmax_mass_prob-1.png

*Contours: paths in 2D*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580101_fmax_chain_hist2d-1.png

*Chain statistics*


#+BEGIN_EXAMPLE
s=200; % start at this iteration step
min(min_statistic[[s:]]);

1.0141232045779245
#+END_EXAMPLE


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580101_fmax_statistics-1.png


Error analysis

#+BEGIN_EXAMPLE
isis> conf_min;
6.195569474697113
isis> conf_max;
6.216153590679169
isis> conf_mean;
6.205861532688141

>>> 6.205861532688141-6.195569474697113 - 0.010292057991028614

#+END_EXAMPLE


#+CAPTION: The 68% confidence probability for 1H0707-495 Mass value where $\mu = 6.206\pm0.010$ (solid blue line) with the error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580101_fmax_logmass_conf68-1.png



#+CAPTION: The 90% confidence probability for 1H0707-495 Mass value where $\mu = 0\pm0$ (solid blue line) with the error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580101_fmax_logmass_conf90.gif

** OBS 0511580201 for $~f_{max}$

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_0511580201_segs.sl=


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0511580201_lagfreq_segs.gif

*ECM fit*

=1H0707-0511580201-fit-fmax.sl=

#+BEGIN_EXAMPLE

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.712154e-05           0       0.001
  2  lag_freq(1).log_mass   0     0          6.19603           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               20           0           0
  7  lag_freq(1).Gamma1     0     1              2.9           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0


Obsid 1H0707_0511580201_fmax
chi^2 = 4.797608e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 2.000000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 1.000000e+01 (+1.105033e+02 -0.000000e+00)

lag_freq(1).log_mass,6.196030e+00,+2.079887e-02,-3.558936e-02
  Parameter 2 = 6.196030e+00 (6.160440e+00 - 6.216829e+00)


Copy to WWW: e.g

lyra:/home/WWW/steff/ecm> scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0511580201_fmax_best_fit.png .


#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580201_fmax_best_fit.png

** OBS 0511580201 for $~f_{max}$ isis emcee

PATH TO DATA = =/data/typhon1/reverb/1H0707-495/isis_emcee/=

Fit script = =1H0707-0511580201-fit-emcee.sl=

Fitting Parameter file =1H0707_0511580201_fmax_best_fit.par=

Make good image of the ECM Model fit

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0511580201_fmax_best fit.ps/cps");
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
plot_comps(1,popt,&plot_data);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgsci(1); % make line colour black
_pgdraw(1,0);
close_plot(pid);
#+END_EXAMPLE

Obtain par file from BC4

#+BEGIN_EXAMPLE
scp -r so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0148010301_fmax_best_fit.par .
#+END_EXAMPLE

This model fit with χ² = 0.48 and the parameters for this particular fit
are:

| lag_freq |                      |        |        |              |     |       |
|      idx | param                | tie-to | freeze |        value | min |   max |
|        1 | lag_freq(1).norm     |      0 |      0 | 2.712154e-05 |   0 | 0.001 |
|        2 | lag_freq(1).log_mass |      0 |      0 |      6.19603 |   5 |     7 |
|        3 | lag_freq(1).i        |      0 |      1 |           53 |   0 |     0 |
|        4 | lag_freq(1).a        |      0 |      1 |        0.998 |   0 |     0 |
|        5 | lag_freq(1).h1       |      0 |      1 |            2 |   0 |     0 |
|        6 | lag_freq(1).h2       |      0 |      1 |           20 |   0 |     0 |
|        7 | lag_freq(1).Gamma1   |      0 |      1 |          2.9 |   0 |     0 |
|        8 | lag_freq(1).Gamma2   |      0 |      1 |          1.9 |   0 |     0 |
|        9 | lag_freq(1).Fe       |      0 |      1 |            1 |   0 |     0 |
|       10 | lag_freq(1).xi       |      0 |      1 |            2 |   0 |     0 |
|       11 | lag_freq(1).p        |      0 |      1 |            0 |   0 |     0 |
|       12 | lag_freq(1).b        |      0 |      1 |            2 |   0 |     0 |
|       13 | lag_freq(1).q2       |      0 |      1 |          0.5 |   0 |     0 |
|       14 | lag_freq(1).t_max    |      0 |      1 |          200 |   0 |     0 |
|       15 | lag_freq(1).t_shift  |      0 |      1 |           10 |   0 |     0 |



#+BEGIN_EXAMPLE
isis

.source("1H0707-0511580201-fit-emcee.sl");

where

% Perform MCMC
emcee(500, 10000; output="1H0707_0511580201_fmax_chain.fits", serial);

% Read the chain-file
(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("1H0707_0511580201_fmax_chain.fits");
#+END_EXAMPLE


*Paths of the walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580201_fmax_walkers-1.png


*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580201_fmax_mass_accept_rate-1.png


Obtain the Norm pobability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580201_fmax_norm_prob-1.png


Obtain the Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580201_fmax_mass_prob-1.png

*Contours: paths in 2D*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580201_fmax_chain_hist2d-1.png

*Chain statistics*


#+BEGIN_EXAMPLE
s=200; % start at this iteration step
min(min_statistic[[s:]]);
0.47976143651943626

#+END_EXAMPLE


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580201_fmax_statistics-1.png


Error analysis

#+BEGIN_EXAMPLE
isis> conf_min;
6.164441680908203
isis> conf_max;
6.232228527069092
isis> conf_mean;
6.198335103988647

>>> 6.198335103988647-6.164441680908203 = 0.03389342308044441

#+END_EXAMPLE


#+CAPTION: The 68% confidence probability for 1H0707-495 Mass value where $\mu = 6.198\pm0.034$ (solid blue line) with the error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580201_fmax_logmass_conf68-1.png



#+CAPTION: The 90% confidence probability for 1H0707-495 Mass value where $\mu = 0\pm0$ (solid blue line) with the error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580201_fmax_logmass_conf90.gif

** OBS 0511580301 for $~f_{max}$

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_0511580301_segs.sl=


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0511580301_lagfreq_segs.gif

*ECM fit*

=1H0707-0511580301-fit-fmax.sl=

#+BEGIN_EXAMPLE
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.249129e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.218546           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               19           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              350           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0


bsid 1H0707_0511580301_fmax
chi^2 = 6.267794e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.900000e+01 (+0.000000e+00 -6.460231e+00)
Parameter Gamma1 = 2.400000e+00 (+9.547983e-02 -2.752704e-01)
Parameter Gamma2 = 1.700000e+00 (+1.014987e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -6.140007e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.500000e+02 (+9.386430e+00 -6.100043e+00)
Parameter t_shift = 3.000000e+01 (+1.583220e+00 -3.603664e+00)

ag_freq(1).log_mass,6.218546e+00,+8.190556e-03,-8.567754e-03
  Parameter 2 = 6.218546e+00 (6.209978e+00 - 6.226736e+00)


Copy to WWW: e.g

lyra:/home/WWW/steff/ecm> scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0511580301_fmax_best_fit.png .


#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580301_fmax_best_fit.png

** OBS 0511580301 for $~f_{max}$ isis emcee

PATH TO DATA = =/data/typhon1/reverb/1H0707-495/isis_emcee/=

Fit script = =1H0707-0511580301-fit-emcee.sl=

Fitting Parameter file =1H0707_0511580301_fmax_best_fit.par=

Make good image of the ECM Model fit

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0511580301_fmax_best fit.ps/cps");
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
plot_comps(1,popt,&plot_data);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgsci(1); % make line colour black
_pgdraw(1,0);
close_plot(pid);
#+END_EXAMPLE

Obtain par file from BC4

#+BEGIN_EXAMPLE
scp -r so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0148010301_fmax_best_fit.par .
#+END_EXAMPLE

This model fit with χ² = 0.63 and the parameters for this particular fit
are:

| lag_freq |                      |        |        |              |     |       |
|      idx | param                | tie-to | freeze |        value | min |   max |
|        1 | lag_freq(1).norm     |      0 |      0 | 5.249129e-05 |   0 | 0.001 |
|        2 | lag_freq(1).log_mass |      0 |      0 |     6.218546 |   5 |     7 |
|        3 | lag_freq(1).i        |      0 |      1 |           53 |   0 |     0 |
|        4 | lag_freq(1).a        |      0 |      1 |        0.998 |   0 |     0 |
|        5 | lag_freq(1).h1       |      0 |      1 |            2 |   0 |     0 |
|        6 | lag_freq(1).h2       |      0 |      1 |           19 |   0 |     0 |
|        7 | lag_freq(1).Gamma1   |      0 |      1 |          2.4 |   0 |     0 |
|        8 | lag_freq(1).Gamma2   |      0 |      1 |          1.7 |   0 |     0 |
|        9 | lag_freq(1).Fe       |      0 |      1 |            1 |   0 |     0 |
|       10 | lag_freq(1).xi       |      0 |      1 |            2 |   0 |     0 |
|       11 | lag_freq(1).p        |      0 |      1 |            0 |   0 |     0 |
|       12 | lag_freq(1).b        |      0 |      1 |            2 |   0 |     0 |
|       13 | lag_freq(1).q2       |      0 |      1 |          0.5 |   0 |     0 |
|       14 | lag_freq(1).t_max    |      0 |      1 |          350 |   0 |     0 |
|       15 | lag_freq(1).t_shift  |      0 |      1 |           30 |   0 |     0 |

#+BEGIN_EXAMPLE
isis

.source("1H0707-0511580301-fit-emcee.sl");

where

% Perform MCMC
emcee(500, 10000; output="1H0707_0511580301_fmax_chain.fits", serial);

% Read the chain-file
(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("1H0707_0511580301_fmax_chain.fits");
#+END_EXAMPLE


*Paths of the walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580301_fmax_walkers-1.png


*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580301_fmax_mass_accept_rate-1.png


Obtain the Norm pobability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580301_fmax_norm_prob-1.png


Obtain the Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580301_fmax_mass_prob-1.png

*Contours: paths in 2D*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580301_fmax_chain_hist2d-1.png

*Chain statistics*


#+BEGIN_EXAMPLE
s=300; % start at this iteration step
min(min_statistic[[s:]]);
0.6267800066993936


#+END_EXAMPLE


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580301_fmax_statistics-1.png


Error analysis

#+BEGIN_EXAMPLE
isis> conf_min;
6.212941596508026
isis> conf_max;
6.224281160831452
isis> conf_mean;
6.218611378669738

6.218611378669738-6.212941596508026 = 0.005669782161712433

#+END_EXAMPLE


#+CAPTION: The 68% confidence probability for 1H0707-495 Mass value where $\mu = 6.219\pm0.006$ (solid blue line) with the error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580301_fmax_logmass_conf68-1.png



#+CAPTION: The 90% confidence probability for 1H0707-495 Mass value where $\mu = 0\pm0$ (solid blue line) with the error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580301_fmax_logmass_conf90.gif

** OBS 0511580401 for $~f_{max}$

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_0511580401_segs.sl=


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0511580401_lagfreq_segs.gif

*ECM fit*

=1H0707-0511580401-fit-fmax.sl=

#+BEGIN_EXAMPLE

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.566978e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.191222           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               12           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1              120           0           0


Obsid 1H0707_0511580401_fmax
chi^2 = 1.216895e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.200000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.015631e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+0.000000e+00 -1.625051e+02)
Parameter t_shift = 1.200000e+02 (+0.000000e+00 -6.293366e+01)

lag_freq(1).log_mass,6.191222e+00,+1.119464e-02,-1.103352e-02
  Parameter 2 = 6.191222e+00 (6.180189e+00 - 6.202417e+00)


.........................................................


Submitted batch job 4098187



Copy to WWW: e.g

lyra:/home/WWW/steff/ecm> scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0511580401_fmax_best_fit.png .


#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580401_fmax_best_fit.png

** OBS 0511580401 for $~f_{max}$ isis emcee

PATH TO DATA = =/data/typhon1/reverb/1H0707-495/isis_emcee/=

Fit script = =1H0707-0511580401-fit-emcee.sl=

Fitting Parameter file =1H0707_0511580401_fmax_best_fit.par=

Make good image of the ECM Model fit

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0511580401_fmax_best fit.ps/cps");
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
plot_comps(1,popt,&plot_data);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgsci(1); % make line colour black
_pgdraw(1,0);
close_plot(pid);
#+END_EXAMPLE

Obtain par file from BC4

#+BEGIN_EXAMPLE
scp -r so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0148010301_fmax_best_fit.par .
#+END_EXAMPLE

This model fit with χ² = 1.22 and the parameters for this particular fit
are:

| lag_freq |                      |        |        |              |     |       |
|      idx | param                | tie-to | freeze |        value | min |   max |
|        1 | lag_freq(1).norm     |      0 |      0 | 1.566978e-05 |   0 | 0.001 |
|        2 | lag_freq(1).log_mass |      0 |      0 |     6.191222 |   5 |     7 |
|        3 | lag_freq(1).i        |      0 |      1 |           53 |   0 |     0 |
|        4 | lag_freq(1).a        |      0 |      1 |        0.998 |   0 |     0 |
|        5 | lag_freq(1).h1       |      0 |      1 |            2 |   0 |     0 |
|        6 | lag_freq(1).h2       |      0 |      1 |           12 |   0 |     0 |
|        7 | lag_freq(1).Gamma1   |      0 |      1 |          2.6 |   0 |     0 |
|        8 | lag_freq(1).Gamma2   |      0 |      1 |          2.4 |   0 |     0 |
|        9 | lag_freq(1).Fe       |      0 |      1 |            1 |   0 |     0 |
|       10 | lag_freq(1).xi       |      0 |      1 |            0 |   0 |     0 |
|       11 | lag_freq(1).p        |      0 |      1 |            0 |   0 |     0 |
|       12 | lag_freq(1).b        |      0 |      1 |            3 |   0 |     0 |
|       13 | lag_freq(1).q2       |      0 |      1 |          0.5 |   0 |     0 |
|       14 | lag_freq(1).t_max    |      0 |      1 |          400 |   0 |     0 |
|       15 | lag_freq(1).t_shift  |      0 |      1 |          120 |   0 |     0 |

#+BEGIN_EXAMPLE
isis

.source("1H0707-0511580401-fit-emcee.sl");

where

% Perform MCMC
emcee(500, 10000; output="1H0707_0511580401_fmax_chain.fits", serial);

% Read the chain-file
(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("1H0707_0511580401_fmax_chain.fits");
#+END_EXAMPLE


*Paths of the walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580401_fmax_walkers-1.png


*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580401_fmax_mass_accept_rate-1.png


Obtain the Norm pobability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580401_fmax_norm_prob-1.png


Obtain the Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580401_fmax_mass_prob-1.png

*Contours: paths in 2D*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580401_fmax_chain_hist2d-1.png

*Chain statistics*


#+BEGIN_EXAMPLE
s=1200; % start at this iteration step
min(min_statistic[[s:]]);
1.216894651825312


#+END_EXAMPLE


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580401_fmax_statistics-1.png


Error analysis

#+BEGIN_EXAMPLE
isis> conf_min;
6.183791947364807
isis> conf_max;
6.199637150764465
isis> conf_mean;
6.191714549064637

 6.191714549064637-6.183791947364807  = 0.00792260169982928

#+END_EXAMPLE


#+CAPTION: The 68% confidence probability for 1H0707-495 Mass value where $\mu = 6.192\pm0.008$ (solid blue line) with the error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580401_fmax_logmass_conf68-1.png



#+CAPTION: The 90% confidence probability for 1H0707-495 Mass value where $\mu = 0\pm0$ (solid blue line) with the error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0511580401_fmax_logmass_conf90.gif

** OBS 0554710801 for $~f_{max}$

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_0554710801_segs.sl=


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0554710801_lagfreq_segs.gif

*ECM fit*

=1H0707-0554710801-fit-fmax.sl=

#+BEGIN_EXAMPLE

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.733931e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.230631           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               15           0           0
  7  lag_freq(1).Gamma1     0     1              3.3           0           0
  8  lag_freq(1).Gamma2     0     1              2.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               40           0           0


Obsid 1H0707_0554710801_fmax
chi^2 = 3.835253e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.500000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 3.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.500000e+02 (+0.000000e+00 -2.133778e+02)
Parameter t_shift = 4.000000e+01 (+8.216862e+01 -0.000000e+00)


lag_freq(1).log_mass,6.233263e+00,+1.928017e-02,-2.309119e-02
  Parameter 2 = 6.233263e+00 (6.210172e+00 - 6.252543e+00)


...................................................................

Submitted batch job 4100154

No better fit found !

Copy to WWW: e.g

lyra:/home/WWW/steff/ecm> scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0554710801_fmax_best_fit.png .


#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0554710801_fmax_best_fit.png

** OBS 0554710801 for $~f_{max}$ isis emcee

PATH TO DATA = =/data/typhon1/reverb/1H0707-495/isis_emcee/=

Fit script = =1H0707-0554710801-fit-emcee.sl=

Fitting Parameter file =1H0707_0554710801_fmax_best_fit.par=

Make good image of the ECM Model fit

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0554710801_fmax_best fit.ps/cps");
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
plot_comps(1,popt,&plot_data);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgsci(1); % make line colour black
_pgdraw(1,0);
close_plot(pid);
#+END_EXAMPLE

Obtain par file from BC4

#+BEGIN_EXAMPLE
scp -r so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0148010301_fmax_best_fit.par .
#+END_EXAMPLE

This model fit with χ² = 3.84 and the parameters for this particular fit
are:

| lag_freq |                      |        |        |              |     |       |
|      idx | param                | tie-to | freeze |        value | min |   max |
|        1 | lag_freq(1).norm     |      0 |      0 | 1.733931e-05 |   0 | 0.001 |
|        2 | lag_freq(1).log_mass |      0 |      0 |     6.230631 |   5 |     7 |
|        3 | lag_freq(1).i        |      0 |      1 |           53 |   0 |     0 |
|        4 | lag_freq(1).a        |      0 |      1 |        0.998 |   0 |     0 |
|        5 | lag_freq(1).h1       |      0 |      1 |            2 |   0 |     0 |
|        6 | lag_freq(1).h2       |      0 |      1 |           15 |   0 |     0 |
|        7 | lag_freq(1).Gamma1   |      0 |      1 |          3.3 |   0 |     0 |
|        8 | lag_freq(1).Gamma2   |      0 |      1 |          2.8 |   0 |     0 |
|        9 | lag_freq(1).Fe       |      0 |      1 |            1 |   0 |     0 |
|       10 | lag_freq(1).xi       |      0 |      1 |            0 |   0 |     0 |
|       11 | lag_freq(1).p        |      0 |      1 |            0 |   0 |     0 |
|       12 | lag_freq(1).b        |      0 |      1 |            3 |   0 |     0 |
|       13 | lag_freq(1).q2       |      0 |      1 |          0.5 |   0 |     0 |
|       14 | lag_freq(1).t_max    |      0 |      1 |          250 |   0 |     0 |
|       15 | lag_freq(1).t_shift  |      0 |      1 |           40 |   0 |     0 |

#+BEGIN_EXAMPLE
isis

.source("1H0707-0554710801-fit-emcee.sl");

where

% Perform MCMC
emcee(500, 10000; output="1H0707_0554710801_fmax_chain.fits", serial);

% Read the chain-file
(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("1H0707_0554710801_fmax_chain.fits");
#+END_EXAMPLE


*Paths of the walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0554710801_fmax_walkers-1.png


*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0554710801_fmax_mass_accept_rate-1.png


Obtain the Norm pobability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0554710801_fmax_norm_prob-1.png


Obtain the Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0554710801_fmax_mass_prob-1.png

*Contours: paths in 2D*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0554710801_fmax_chain_hist2d-1.png

*Chain statistics*


#+BEGIN_EXAMPLE
s=200; % start at this iteration step
min(min_statistic[[s:]]);
3.8352487455199404

#+END_EXAMPLE


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0554710801_fmax_statistics-1.png


Error analysis

#+BEGIN_EXAMPLE
isis> conf_min;
6.215738296508789
isis> conf_max;
6.25668340921402
isis> conf_mean;
6.236210852861404

6.236210852861404-6.215738296508789 = 0.020472556352615356

#+END_EXAMPLE


#+CAPTION: The 68% confidence probability for 1H0707-495 Mass value where $\mu = 6.236\pm0.020$ (solid blue line) with the error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0554710801_fmax_logmass_conf68-1.png



#+CAPTION: The 90% confidence probability for 1H0707-495 Mass value where $\mu = 0\pm0$ (solid blue line) with the error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0554710801_fmax_logmass_conf90.gif

** OBS 0653510301 for $~f_{max}$

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_0653510301_segs.sl=


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0653510301_lagfreq_segs.gif

*ECM fit*

=1H0707-0653510301-fit-fmax.sl=

#+BEGIN_EXAMPLE

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     6.729542e-06           0       0.001
  2  lag_freq(1).log_mass   0     0         6.265146           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               13           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                1           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              350           0           0
 15  lag_freq(1).t_shift    0     1              110           0           0


Obsid 1H0707_0653510301_fmax
chi^2 = 1.004443e-02 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.300000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.500000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 1.100000e+02 (+1.315070e+01 -0.000000e+00)

lag_freq(1).log_mass,6.265146e+00,+6.429035e-02,-1.772666e-01
  Parameter 2 = 6.265146e+00 (6.087880e+00 - 6.329437e+00)


Copy to WWW: e.g

lyra:/home/WWW/steff/ecm> scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0653510301_fmax_best_fit.png .


#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510301_fmax_best_fit.png

** OBS 0653510301 for $~f_{max}$ isis emcee

PATH TO DATA = =/data/typhon1/reverb/1H0707-495/isis_emcee/=

Fit script = =1H0707-0653510301-fit-emcee.sl=

Fitting Parameter file =1H0707_0653510301_fmax_best_fit.par=

Make good image of the ECM Model fit

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0653510301_fmax_best fit.ps/cps");
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
plot_comps(1,popt,&plot_data);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgsci(1); % make line colour black
_pgdraw(1,0);
close_plot(pid);
#+END_EXAMPLE

Obtain par file from BC4

#+BEGIN_EXAMPLE
scp -r so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0148010301_fmax_best_fit.par .
#+END_EXAMPLE

This model fit with χ² = 0.01 and the parameters for this particular fit
are:

| lag_freq |                      |        |        |              |     |       |
|      idx | param                | tie-to | freeze |        value | min |   max |
|        1 | lag_freq(1).norm     |      0 |      0 | 6.729542e-06 |   0 | 0.001 |
|        2 | lag_freq(1).log_mass |      0 |      0 |     6.265146 |   5 |     7 |
|        3 | lag_freq(1).i        |      0 |      1 |           53 |   0 |     0 |
|        4 | lag_freq(1).a        |      0 |      1 |        0.998 |   0 |     0 |
|        5 | lag_freq(1).h1       |      0 |      1 |            2 |   0 |     0 |
|        6 | lag_freq(1).h2       |      0 |      1 |           13 |   0 |     0 |
|        7 | lag_freq(1).Gamma1   |      0 |      1 |          2.2 |   0 |     0 |
|        8 | lag_freq(1).Gamma2   |      0 |      1 |          1.9 |   0 |     0 |
|        9 | lag_freq(1).Fe       |      0 |      1 |            1 |   0 |     0 |
|       10 | lag_freq(1).xi       |      0 |      1 |            1 |   0 |     0 |
|       11 | lag_freq(1).p        |      0 |      1 |            0 |   0 |     0 |
|       12 | lag_freq(1).b        |      0 |      1 |            1 |   0 |     0 |
|       13 | lag_freq(1).q2       |      0 |      1 |          0.5 |   0 |     0 |
|       14 | lag_freq(1).t_max    |      0 |      1 |          350 |   0 |     0 |
|       15 | lag_freq(1).t_shift  |      0 |      1 |          110 |   0 |     0 |

#+BEGIN_EXAMPLE
isis

.source("1H0707-0653510301-fit-emcee.sl");

where

% Perform MCMC
emcee(500, 10000; output="1H0707_0653510301_fmax_chain.fits", serial);

% Read the chain-file
(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("1H0707_0653510301_fmax_chain.fits");
#+END_EXAMPLE


*Paths of the walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510301_fmax_walkers-1.png


*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510301_fmax_mass_accept_rate-1.png


Obtain the Norm pobability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510301_fmax_norm_prob-1.png


Obtain the Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510301_fmax_mass_prob-1.png

*Contours: paths in 2D*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510301_fmax_chain_hist2d-1.png

*Chain statistics*


#+BEGIN_EXAMPLE
s=200; % start at this iteration step
min(min_statistic[[s:]]);

0.010045182168998544

#+END_EXAMPLE


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510301_fmax_statistics-1.png


Error analysis

#+BEGIN_EXAMPLE

isis> % finally, normalize!
isis> newhist /= sum(newhist);
isis> variable li = [:nmax], ri = [nmax+1:];
isis> variable conf_min = lo[li][wherefirst(cumsum(newhist[li]) > .5 - .5*lvl)];
isis> variable conf_max = hi[ri][wherefirst(cumsum(newhist[ri]) > .5*lvl)];
Unable to typecast Null_Type to Integer_Type
<stdin>:43:<top-level>:Type Mismatch
isis> variable conf_mean = conf_min + ((conf_max - conf_min) / 2);
Undefined_Type - Double_Type is not possible
<stdin>:44:<top-level>:Type Mismatch
6.091213989257812
isis> conf_min;
6.091213989257812
isis> conf_max;
Undefined_Type
isis> conf_mean;
Undefined_Type

#+END_EXAMPLE


#+CAPTION: The 68% confidence probability for 1H0707-495 Mass value where $\mu = 6.\pm0.$ (solid blue line) with the error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510301_fmax_logmass_conf68-1.png


#+CAPTION: The 90% confidence probability for 1H0707-495 Mass value where $\mu = 0\pm0$ (solid blue line) with the error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510301_fmax_logmass_conf90.gif

** OBS 0653510401 for $~f_{max}$

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_0653510401_segs.sl=


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0653510401_lagfreq_segs.gif

*ECM fit*

=1H0707-0653510401-fit-fmax.sl=

#+BEGIN_EXAMPLE

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.540827e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.243213           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               16           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              350           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0

Obsid 1H0707_0653510401_fmax
chi^2 = 2.311488e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.600000e+01 (+0.000000e+00 -2.415102e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -2.918263e-01)
Parameter Gamma2 = 1.700000e+00 (+9.421168e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -1.517912e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.500000e+02 (+7.848532e+01 -7.589560e+00)
Parameter t_shift = 3.000000e+01 (+1.388563e+01 -6.063629e+00)

lag_freq(1).log_mass,6.243213e+00,+8.813331e-03,-1.004331e-02
  Parameter 2 = 6.243213e+00 (6.233170e+00 - 6.252027e+00)


......................................................................

Copy to WWW: e.g

lyra:/home/WWW/steff/ecm> scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0653510401_fmax_best_fit.png .


#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510401_fmax_best_fit.png

** OBS 0653510401 for $~f_{max}$ isis emcee

PATH TO DATA = =/data/typhon1/reverb/1H0707-495/isis_emcee/=

Fit script = =1H0707-0653510401-fit-emcee.sl=

Fitting Parameter file =1H0707_0653510401_fmax_best_fit.par=

Make good image of the ECM Model fit

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0653510401_fmax_best fit.ps/cps");
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
plot_comps(1,popt,&plot_data);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgsci(1); % make line colour black
_pgdraw(1,0);
close_plot(pid);
#+END_EXAMPLE

Obtain par file from BC4

#+BEGIN_EXAMPLE
scp -r so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0148010301_fmax_best_fit.par .
#+END_EXAMPLE

This model fit with χ² = 2.31 and the parameters for this particular fit
are:

| lag_freq |                      |        |        |              |     |       |
|      idx | param                | tie-to | freeze |        value | min |   max |
|        1 | lag_freq(1).norm     |      0 |      0 | 4.540827e-05 |   0 | 0.001 |
|        2 | lag_freq(1).log_mass |      0 |      0 |     6.243213 |   5 |     7 |
|        3 | lag_freq(1).i        |      0 |      1 |           53 |   0 |     0 |
|        4 | lag_freq(1).a        |      0 |      1 |        0.998 |   0 |     0 |
|        5 | lag_freq(1).h1       |      0 |      1 |            2 |   0 |     0 |
|        6 | lag_freq(1).h2       |      0 |      1 |           16 |   0 |     0 |
|        7 | lag_freq(1).Gamma1   |      0 |      1 |          2.3 |   0 |     0 |
|        8 | lag_freq(1).Gamma2   |      0 |      1 |          1.7 |   0 |     0 |
|        9 | lag_freq(1).Fe       |      0 |      1 |            1 |   0 |     0 |
|       10 | lag_freq(1).xi       |      0 |      1 |            2 |   0 |     0 |
|       11 | lag_freq(1).p        |      0 |      1 |            0 |   0 |     0 |
|       12 | lag_freq(1).b        |      0 |      1 |            2 |   0 |     0 |
|       13 | lag_freq(1).q2       |      0 |      1 |          0.5 |   0 |     0 |
|       14 | lag_freq(1).t_max    |      0 |      1 |          350 |   0 |     0 |
|       15 | lag_freq(1).t_shift  |      0 |      1 |           30 |   0 |     0 |

#+BEGIN_EXAMPLE
isis

.source("1H0707-0653510401-fit-emcee.sl");

where

% Perform MCMC
emcee(500, 10000; output="1H0707_0653510401_fmax_chain.fits", serial);

% Read the chain-file
(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("1H0707_0653510401_fmax_chain.fits");
#+END_EXAMPLE


*Paths of the walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510401_fmax_walkers-1.png


*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510401_fmax_mass_accept_rate-1.png


Obtain the Norm pobability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510401_fmax_norm_prob-1.png


Obtain the Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510401_fmax_mass_prob-1.png

*Contours: paths in 2D*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510401_fmax_chain_hist2d-1.png

*Chain statistics*


#+BEGIN_EXAMPLE
s=200; % start at this iteration step
min(min_statistic[[s:]]);

isis> min(min_statistic[[s:]]);
2.3114881537230945

#+END_EXAMPLE


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510401_fmax_statistics-1.png


Error analysis

#+BEGIN_EXAMPLE
isis> conf_min;
6.236367754936218
isis> conf_max;
6.249743666648865
isis> conf_mean;
6.243055710792541

 6.243055710792541-6.236367754936218 = 0.006687955856323313

#+END_EXAMPLE


#+CAPTION: The 68% confidence probability for 1H0707-495 Mass value where $\mu = 6.243\pm0.007$ (solid blue line) with the error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510401_fmax_logmass_conf68-1.png


#+CAPTION: The 90% confidence probability for 1H0707-495 Mass value where $\mu = 0\pm0$ (solid blue line) with the error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510401_fmax_logmass_conf90.gif

** OBS 0653510501 for $~f_{max}$

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_0653510501_segs.sl=


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0653510501_lagfreq_segs.gif

*ECM fit*

=1H0707-0653510501-fit-fmax.sl=

#+BEGIN_EXAMPLE
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     8.933005e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.155251           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               20           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              350           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0


Obsid 1H0707_0653510501_fmax
chi^2 = 1.322253e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 2.000000e+01 (+0.000000e+00 -9.093916e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -3.493341e-01)
Parameter Gamma2 = 1.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.675141e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.500000e+02 (+1.381505e+01 -1.538044e+01)
Parameter t_shift = 3.000000e+01 (+2.131460e+01 -1.668323e+01)

lag_freq(1).log_mass,6.155251e+00,+1.251477e-02,-1.578549e-02
  Parameter 2 = 6.155251e+00 (6.139465e+00 - 6.167766e+00)

.................................................................

Submitted batch job 4127242

No improvement


Copy to WWW: e.g

lyra:/home/WWW/steff/ecm> scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0653510501_fmax_best_fit.png .


#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510501_fmax_best_fit.png





** OBS 0653510501 for $~f_{max}$ isis emcee

PATH TO DATA = =/data/typhon1/reverb/1H0707-495/isis_emcee/=

Fit script = =1H0707-0653510501-fit-emcee.sl=

Fitting Parameter file =1H0707_0653510501_fmax_best_fit.par=

Make good image of the ECM Model fit

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0653510501_fmax_best fit.ps/cps");
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
plot_comps(1,popt,&plot_data);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgsci(1); % make line colour black
_pgdraw(1,0);
close_plot(pid);
#+END_EXAMPLE

Obtain par file from BC4

#+BEGIN_EXAMPLE
scp -r so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0148010301_fmax_best_fit.par .
#+END_EXAMPLE

This model fit with χ² = 1.32 and the parameters for this particular fit
are:

| lag_freq |                      |        |        |              |     |       |
|      idx | param                | tie-to | freeze |        value | min |   max |
|        1 | lag_freq(1).norm     |      0 |      0 | 8.933005e-05 |   0 | 0.001 |
|        2 | lag_freq(1).log_mass |      0 |      0 |     6.155251 |   5 |     7 |
|        3 | lag_freq(1).i        |      0 |      1 |           53 |   0 |     0 |
|        4 | lag_freq(1).a        |      0 |      1 |        0.998 |   0 |     0 |
|        5 | lag_freq(1).h1       |      0 |      1 |            2 |   0 |     0 |
|        6 | lag_freq(1).h2       |      0 |      1 |           20 |   0 |     0 |
|        7 | lag_freq(1).Gamma1   |      0 |      1 |          2.2 |   0 |     0 |
|        8 | lag_freq(1).Gamma2   |      0 |      1 |          1.9 |   0 |     0 |
|        9 | lag_freq(1).Fe       |      0 |      1 |            1 |   0 |     0 |
|       10 | lag_freq(1).xi       |      0 |      1 |            3 |   0 |     0 |
|       11 | lag_freq(1).p        |      0 |      1 |            0 |   0 |     0 |
|       12 | lag_freq(1).b        |      0 |      1 |            3 |   0 |     0 |
|       13 | lag_freq(1).q2       |      0 |      1 |          0.5 |   0 |     0 |
|       14 | lag_freq(1).t_max    |      0 |      1 |          350 |   0 |     0 |
|       15 | lag_freq(1).t_shift  |      0 |      1 |           30 |   0 |     0 |


#+BEGIN_EXAMPLE
isis

.source("1H0707-0653510501-fit-emcee.sl");

where

% Perform MCMC
emcee(500, 10000; output="1H0707_0653510501_fmax_chain.fits", serial);

% Read the chain-file
(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("1H0707_0653510501_fmax_chain.fits");
#+END_EXAMPLE


*Paths of the walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510501_fmax_walkers-1.png


*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510501_fmax_mass_accept_rate-1.png


Obtain the Norm pobability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510501_fmax_norm_prob-1.png


Obtain the Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510501_fmax_mass_prob-1.png

*Contours: paths in 2D*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510501_fmax_chain_hist2d-1.png

*Chain statistics*


#+BEGIN_EXAMPLE
s=2000; % start at this iteration step
min(min_statistic[[s:]]);

1.322252861026855

#+END_EXAMPLE


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510501_fmax_statistics-1.png


Error analysis

#+BEGIN_EXAMPLE
isis> conf_min;
6.140565376281739
isis> conf_max;
6.168820495605469
isis> conf_mean;
6.154692935943604
isis>

6.154692935943604-6.140565376281739 = 0.014127559661865519

#+END_EXAMPLE


#+CAPTION: The 68% confidence probability for 1H0707-495 Mass value where $\mu = 6.\pm0.00$ (solid blue line) with the error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510501_fmax_logmass_conf68-1.png


#+CAPTION: The 90% confidence probability for 1H0707-495 Mass value where $\mu = 0\pm0$ (solid blue line) with the error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510501_fmax_logmass_conf90.gif

** OBS 0653510601 for $~f_{max}$

PATH = =/home/steff075/phd_ecm/1h0707/lagfreq_0653510601_segs.sl=


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_0653510601_lagfreq_segs.gif

*ECM fit*

=1H0707-0653510601-fit-fmax.sl=

#+BEGIN_EXAMPLE

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     8.980126e-06           0       0.001
  2  lag_freq(1).log_mass   0     0         6.272224           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               15           0           0
  7  lag_freq(1).Gamma1     0     1              3.3           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               40           0           0



Obsid 1H0707_0653510601_fmax
chi^2 = 1.185906e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.500000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 3.300000e+00 (+0.000000e+00 -1.253242e+00)
Parameter Gamma2 = 1.800000e+00 (+1.307917e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.500000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 4.000000e+01 (+0.000000e+00 -2.138231e+01)


lag_freq(1).log_mass,6.272224e+00,+5.718911e-02,-5.184727e-02
  Parameter 2 = 6.272224e+00 (6.220377e+00 - 6.329413e+00)

Copy to WWW: e.g

lyra:/home/WWW/steff/ecm> scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0653510601_fmax_best_fit.png .


#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510601_fmax_best_fit.png


** OBS 0653510601 for $~f_{max}$ isis emcee

PATH TO DATA = =/data/typhon1/reverb/1H0707-495/isis_emcee/=

Fit script = =1H0707-0653510601-fit-emcee.sl=

Fitting Parameter file =1H0707_0653510601_fmax_best_fit.par=

Make good image of the ECM Model fit

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0653510601_fmax_best fit.ps/cps");
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
plot_comps(1,popt,&plot_data);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgsci(1); % make line colour black
_pgdraw(1,0);
close_plot(pid);
#+END_EXAMPLE

Obtain par file from BC4

#+BEGIN_EXAMPLE
scp -r so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0148010301_fmax_best_fit.par .
#+END_EXAMPLE

This model fit with χ² = 1.18 and the parameters for this particular fit
are:

| lag_freq |                      |        |        |              |     |       |
|      idx | param                | tie-to | freeze |        value | min |   max |
|        1 | lag_freq(1).norm     |      0 |      0 | 8.980126e-06 |   0 | 0.001 |
|        2 | lag_freq(1).log_mass |      0 |      0 |     6.272224 |   5 |     7 |
|        3 | lag_freq(1).i        |      0 |      1 |           53 |   0 |     0 |
|        4 | lag_freq(1).a        |      0 |      1 |        0.998 |   0 |     0 |
|        5 | lag_freq(1).h1       |      0 |      1 |            2 |   0 |     0 |
|        6 | lag_freq(1).h2       |      0 |      1 |           15 |   0 |     0 |
|        7 | lag_freq(1).Gamma1   |      0 |      1 |          3.3 |   0 |     0 |
|        8 | lag_freq(1).Gamma2   |      0 |      1 |          1.8 |   0 |     0 |
|        9 | lag_freq(1).Fe       |      0 |      1 |            1 |   0 |     0 |
|       10 | lag_freq(1).xi       |      0 |      1 |            0 |   0 |     0 |
|       11 | lag_freq(1).p        |      0 |      1 |            0 |   0 |     0 |
|       12 | lag_freq(1).b        |      0 |      1 |            1 |   0 |     0 |
|       13 | lag_freq(1).q2       |      0 |      1 |          0.5 |   0 |     0 |
|       14 | lag_freq(1).t_max    |      0 |      1 |          250 |   0 |     0 |
|       15 | lag_freq(1).t_shift  |      0 |      1 |           40 |   0 |     0 |



#+BEGIN_EXAMPLE
isis

.source("1H0707-0653510601-fit-emcee.sl");

where

% Perform MCMC
emcee(500, 50000; output="1H0707_0653510601_fmax_chain.fits", serial);

% Read the chain-file
(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("1H0707_0653510601_fmax_chain.fits");
#+END_EXAMPLE


*Paths of the walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510601_fmax_walkers-1.png


*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510601_fmax_mass_accept_rate-1.png


Obtain the Norm pobability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510601_fmax_norm_prob-1.png


Obtain the Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510601_fmax_mass_prob-1.png

*Contours: paths in 2D*


#+BEGIN_EXAMPLE
chain_hist2d(1, 0, chain; nbinx = 200, nbiny = 200, xlo = 5.8, xhi = 6.5, ylo =0, yhi = 1e-4);
#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510601_fmax_chain_hist2d-1.png

*Chain statistics*


#+BEGIN_EXAMPLE
s=1000; % start at this iteration step
min(min_statistic[[s:]]);

1.1859064997340065

#+END_EXAMPLE


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510601_fmax_statistics-1.png


Error analysis

#+BEGIN_EXAMPLE
isis> conf_min;
6.23512727022171
isis> conf_max;
6.306769859790802
isis> conf_mean;
6.270948565006256

>>> 6.270948565006256-6.23512727022171  = 0.03582129478454554

#+END_EXAMPLE


#+CAPTION: The 68% confidence probability for 1H0707-495 Mass value where $\mu = 6.271\pm0.036$ (solid blue line) with the error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510601_fmax_logmass_conf68-1.png


#+CAPTION: The 90% confidence probability for 1H0707-495 Mass value where $\mu = 0\pm0$ (solid blue line) with the error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0653510601_fmax_logmass_conf90.gif

** *Fmax results* (at a glance)

These results are recorded aong with the basic info and sepectral
analysis results at:

Individual obs PATH =
=/home/steff075/phd_ecm/results-for-all/1H0707-495_results_fmax.csv=

Download the single obs file [[http://www.star.bris.ac.uk/steff/ecm/1H0707-495_results_fmax.csv][here]]

Combined flux and Individual obs PATH =
=/home/steff075/phd_ecm/results-for-all/1H0707-495_results_All_for_ABS_fmax.csv=

Download the Full data file [[http://www.star.bris.ac.uk/steff/ecm/1H0707-495_results_All_for_ABS_fmax.csv][here]]


|      Data | ECM-Chi2 | ECM_logM |    + |    - | ECM-h2 |    + |    - | ECM-Gama1 |    + |    - | ECM-Gamma2 |    + |    - | Delta-G | ECM-xi | + | - | ECM-b | + |    - | tmax |      + |      - | tshift |      + |     - |
|  Combined |     2.31 | 6.222582 | 0.01 | 0.01 |     20 |    0 | 0.11 |       2.6 |    0 | 0.07 |        2.1 | 0.72 |    0 |     0.5 |      3 | 0 | 0 |     2 | 0 |    2 |  250 |  67.82 |      0 |     20 |  11.05 | 11.92 |
|   Hi-flux |     2.35 | 6.255366 | 0.01 | 0.01 |     11 | 1.83 | 3.79 |       2.5 |    0 | 0.26 |        1.7 | 0.83 |    0 |     0.8 |      3 | 0 | 0 |     1 | 0 |    0 |  200 | 125.32 |  90.09 |     20 |  11.75 | 14.48 |
| Hi-cts>20 |     1.01 | 6.330814 | 0.02 | 0.01 |     20 |    0 | 1.48 |       3.0 |    0 | 0.67 |        2.4 | 0.04 | 0.68 |     0.6 |      3 | 0 | 0 |     3 | 0 | 0.55 |  250 |   3.61 |  12.31 |     20 |   5.38 |  6.36 |
|  Med-flux |     1.19 | 5.839317 | 0.06 | 0.07 |      3 |    0 |    0 |       2.2 |    0 |    0 |        2.0 |    0 |    0 |     0.2 |      1 | 0 | 0 |     1 | 0 |    0 |  200 |      0 | 109.26 |    100 |      0 | 36.88 |
|   Lo-flux |     0.74 | 6.251642 | 0.05 | 0.10 |      8 |    0 |    0 |       2.8 |    0 |    0 |        2.3 |    0 |    0 |     0.5 |      1 | 0 | 0 |     1 | 0 |    0 |  220 |      0 |      0 |     50 |      0 |     0 |
| Lo-cts<20 |     0.21 | 6.147568 | 0.02 | 0.02 |     16 |    0 |    0 |       2.6 |    0 |    0 |        1.7 |    0 |    0 |     1.3 |      3 | 0 | 0 |     1 | 0 |    0 |  250 |      0 |      0 |     20 |   0.53 |     0 |
| 110890201 |     2.24 | 5.898900 | 0.14 | 0.06 |      4 |    0 |    0 |       2.6 |    0 |    0 |        2.5 |    0 |    0 |     0.1 |      0 | 0 | 0 |     2 | 0 |    0 |  600 |      0 |      0 |     50 |      0 |     0 |
| 148010301 |     1.52 | 6.315708 | 0.03 | 0.03 |     12 |    0 |    0 |       2.8 |    0 |    0 |        2.3 |    0 |    0 |     0.5 |      1 | 0 | 0 |     2 | 0 |    0 |  700 |   8.46 |      0 |     30 |      0 |     0 |
| 506200201 |     0.19 | 6.452342 | 0.05 | 0.03 |      5 |    0 |    0 |       2.7 |    0 |    0 |        2.5 |    0 |    0 |     0.2 |      1 | 0 | 0 |     3 | 0 |    0 |  400 |      0 |      0 |     60 |  12.28 | 22.54 |
| 506200301 |     0.47 | 6.168809 | 0.05 | 0.10 |      3 |    0 |    0 |       2.2 |    0 |    0 |        2.0 |    0 |    0 |     0.2 |      0 | 0 | 0 |     3 | 0 |    0 |  500 |      0 | 163.08 |     60 |  15.87 | 55.83 |
| 506200401 |     3.07 | 6.537801 | 0.01 | 0.01 |     15 | 4.68 | 5.32 |       2.8 |    0 | 0.03 |        1.8 | 0.84 |    0 |     1.0 |      1 | 0 | 0 |     3 | 0 |    0 |  400 |  23.81 |  33.84 |     20 |   9.77 | 18.96 |
| 506200501 |     1.30 | 6.492098 | 0.01 | 0.05 |     17 |    0 |    0 |       2.6 |    0 |    0 |        1.7 |    0 |    0 |     1.3 |      0 | 0 | 0 |     3 | 0 |    0 |  450 |      0 | 172.48 |     20 |      0 |     0 |
| 511580101 |     1.01 | 6.206829 | 0.01 | 0.02 |     19 |    0 |    0 |       2.5 |    0 |    0 |        2.0 |    0 |    0 |     0.5 |      3 | 0 | 0 |     2 | 0 |    0 |  400 |      0 | 221.33 |     30 |  84.41 |     0 |
| 511580201 |     0.48 |  6.19603 | 0.02 | 0.04 |     20 |    0 |    0 |       2.9 |    0 |    0 |        1.9 |    0 |    0 |     1.0 |      2 | 0 | 0 |     2 | 0 |    0 |  200 |      0 |      0 |     10 | 110.50 |     0 |
| 511580301 |     0.63 | 6.218546 | 0.01 | 0.01 |     19 |    0 | 6.46 |       2.4 | 0.09 | 0.28 |        1.7 | 1.01 |    0 |     0.7 |      2 | 0 | 0 |     2 | 0 | 0.61 |  350 |   9.39 |   6.10 |     30 |   1.58 |  3.60 |
| 511580401 |     1.22 | 6.191222 | 0.01 | 0.01 |     12 |    0 |    0 |       2.6 |    0 |    0 |        2.4 |    0 |    0 |     0.2 |      1 | 0 | 0 |     3 | 0 |    0 |  400 |      0 | 162.51 |    120 |      0 | 62.93 |
| 554710801 |     3.84 | 6.233263 | 0.02 | 0.02 |     15 |    0 |    0 |       3.3 |    0 |    0 |        2.8 |    0 |    0 |     0.5 |      1 | 0 | 0 |     3 | 0 |    0 |  250 |      0 | 213.38 |     40 |  82.16 |     0 |
| 653510301 |     0.01 | 6.265146 | 0.06 | 0.18 |     13 |    0 |    0 |       2.2 |    0 |    0 |        1.9 |    0 |    0 |     0.3 |      1 | 0 | 0 |     1 | 0 |    0 |  350 |      0 |      0 |    110 |  13.15 |     0 |
| 653510401 |     2.31 | 6.243213 | 0.01 | 0.01 |     16 |    0 | 2.42 |       2.3 |    0 | 0.29 |        1.7 | 0.94 |    0 |     0.6 |      2 | 0 | 0 |     2 | 0 |    0 |  350 |  78.49 |   7.59 |     30 |  13.88 |  6.06 |
| 653510501 |     1.32 | 6.155251 | 0.01 | 0.02 |     20 |    0 | 9.09 |       2.2 |    0 | 0.34 |        1.9 |    0 |    0 |     0.3 |      3 | 0 | 0 |     3 | 0 |    0 |  350 |  13.82 |  15.38 |     30 |  21.31 | 16.68 |
| 653510601 |     1.19 | 6.272224 | 0.06 | 0.05 |     15 |    0 |    0 |       3.3 |    0 | 1.25 |        1.8 | 1.31 |    0 |     1.5 |      1 | 0 | 0 |     1 | 0 |    0 |  250 |      0 |      0 |     40 |      0 | 21.38 |



Full range of results are:

#+BEGIN_EXAMPLE
|      Data | Lit-LogM |      z |    L_Edd | L2-10k/Ledd | LX L/L_Edd | L_bol/erg s-1 | Log_Lbol | Edd Ratio Lbol/Ledd | NED DL /cm | Soft_lag |       +- | Soft_lag_freq | total_counts | exp(ks) |       L(0.3-10k)model |         L(2-10k)model | 0.3-10k_spec_model_flux | 2-10k_spec-model_flux | Relxill_gamma |     + |     - | Relxill_ionise |     + |      - | Relxill_Afe |      + |    - | Relxill_RF |    + |      - | Relxill_incl |     + |     - | Cvr_Frac |      + |      - | fmax_ECM_Chi2 |     fmax_M_solar | fmax_ECM_logM |    + |    - | fmax_ECM_h2 |    + |    - | fmax_ECM_Gama1 |    + |    - | Fmax_ECM_Gamma2 |    + |    - | Fmax_Delta_G | Fmax_ECM_xi | + | - | Fmax_ECM_b | + |    - | fmax_tmax |      + |      - | Fmax_tshift |     + |     - |
|         1 |     6.31 | 0.0411 | 2.52E+44 |    1.54E-02 |  -1.81E+00 |      2.69E+44 |     44.4 |                1.05 |   5.77E+26 | 2.66E+01 | 2.85E+00 |      1.61E-03 |     4.10E+06 |    1160 | 1.21722068942198E+043 | 3.88334108005117E+042 |                2.91E-12 |              9.28E-13 |          3.38 |  0.02 |  0.01 |          2.367 |  0.05 |   0.05 |         0.5 |   0.05 |    0 |         10 |    0 |    0.1 |         75.9 |  0.99 |  1.52 |     0.65 |   0.02 |   0.02 |          2.31 | 1669482.99584048 |      6.222582 | 0.01 | 0.01 |          20 |    0 | 0.11 |            2.6 |    0 | 0.07 |             2.1 | 0.72 |    0 |          0.5 |           3 | 0 | 0 |          2 | 0 |    2 |       250 |  67.82 |      0 |          20 | 11.05 | 11.92 |
|         2 |     6.31 | 0.0411 | 2.72E+44 |    1.60E-02 |  -1.80E+00 |      2.69E+44 |     44.4 |                1.05 |   5.77E+26 | 2.66E+01 | 3.01E+00 |      1.61E-03 |     3.93E+06 |    1035 | 1.42246112877111E+043 | 4.35033564447878E+042 |                3.40E-12 |              1.04E-12 |           3.4 |     0 |  0.02 |           2.44 |  0.08 | 0.0341 |         0.5 | 0.0423 |    0 |         10 |    0 | 0.0916 |         76.1 |  1.09 | 0.747 |     0.65 | 0.0135 |  0.011 |          2.35 | 1800387.54563363 |      6.255366 | 0.01 | 0.01 |          11 | 1.83 | 3.79 |            2.5 |    0 | 0.26 |             1.7 | 0.83 |    0 |          0.8 |           3 | 0 | 0 |          1 | 0 |    0 |       200 | 125.32 |  90.09 |          20 | 11.75 | 14.48 |
|         3 |     6.31 | 0.0411 | 3.23E+44 |    1.22E-02 |  -1.92E+00 |      2.69E+44 |     44.4 |                1.05 |   5.77E+26 | 3.25E+01 | 3.93E+00 |      1.61E-03 |     1.85E+06 |     502 | 1.17249448090482E+043 | 3.93159284646912E+042 |                2.80E-12 |              9.40E-13 |           3.4 |     0 |  0.02 |           2.43 |  0.08 |   0.08 |         0.5 |    0.1 |    0 |         10 |    0 |   0.02 |        76.94 |  0.83 |  1.45 |     0.65 |   0.01 |   0.03 |          1.01 | 2141973.03866183 |      6.330814 | 0.02 | 0.01 |          20 |    0 | 1.48 |              3 |    0 | 0.67 |             2.4 | 0.04 | 0.68 |          0.6 |           3 | 0 | 0 |          3 | 0 | 0.55 |       250 |   3.61 |  12.31 |          20 |  5.38 |  6.36 |
|         4 |     6.31 | 0.0411 | 1.04E+44 |    2.24E-02 |  -1.65E+00 |      2.69E+44 |     44.4 |                1.05 |   5.77E+26 | 3.57E+01 | 9.63E+00 |      1.61E-03 |     1.13E+05 |    72.1 | 4.30922047833602E+042 |  2.3338618926589E+042 |                1.03E-12 |              5.58E-13 |           2.8 |  0.14 |  0.34 |           3.58 |  0.16 |   0.32 |          10 |      0 | 1.64 |         10 |    0 |   4.89 |        31.86 |  3.32 |  4.22 |     0.83 |   0.03 |   0.16 |          1.19 | 690743.807233695 |      5.839317 | 0.06 | 0.07 |           3 |    0 |    0 |            2.2 |    0 |    0 |               2 |    0 |    0 |          0.2 |           1 | 0 | 0 |          1 | 0 |    0 |       200 |      0 | 109.26 |         100 |     0 | 36.88 |
|         5 |     6.31 | 0.0411 | 2.70E+44 |    4.64E-03 |  -2.33E+00 |      2.69E+44 |     44.4 |                1.05 |   5.77E+26 | 2.87E+01 | 1.05E+01 |      1.61E-03 |     5.14E+04 |     124 | 1.70276964532307E+042 | 1.25013967561001E+042 |                4.07E-13 |              2.99E-13 |          2.73 |  0.12 | 0.158 |           2.85 | 0.177 |  0.147 |        9.59 |  0.411 |  4.9 |         10 |    0 |   1.17 |           80 |     0 |  2.99 |     0.95 |      0 | 0.0117 |          0.74 | 1785015.53445779 |      6.251642 | 0.05 |  0.1 |           8 |    0 |    0 |            2.8 |    0 |    0 |             2.3 |    0 |    0 |          0.5 |           1 | 0 | 0 |          1 | 0 |    0 |       220 |      0 |      0 |          50 |     0 |     0 |
|         6 |     6.31 | 0.0411 | 2.12E+44 |    1.81E-02 |  -1.74E+00 |      2.69E+44 |     44.4 |                1.05 |   5.77E+26 | 2.35E+01 | 1.17E+01 |      5.86E-04 |     2.14E+06 |     570 | 1.18721259109335E+043 | 3.83069677770194E+042 |                2.84E-12 |              9.16E-13 |          3.38 |  0.01 |  0.03 |           2.43 |  0.07 |   0.07 |         0.5 |   0.06 |    0 |         10 |    0 |   0.13 |         75.3 |  1.61 |  1.08 |     0.67 |   0.01 |   0.02 |          0.21 | 1404649.60047637 |      6.147568 | 0.02 | 0.02 |          16 |    0 |    0 |            2.6 |    0 |    0 |             1.7 |    0 |    0 |          1.3 |           3 | 0 | 0 |          1 | 0 |    0 |       250 |      0 |      0 |          20 |  0.53 |     0 |
| 110890201 |     6.31 | 0.0411 | 1.20E+44 |    1.53E-02 |  -1.82E+00 |      2.69E+44 |     44.4 |                1.05 |   5.77E+26 | 1.03E+02 | 6.70E+01 |      4.94E-04 |     4.22E+04 |  36.257 |   3.177230685156E+042 | 1.82734059904082E+042 |                7.59E-13 |              4.37E-13 |          2.64 |  0.01 |  0.02 |           0.76 |  0.31 |   0.34 |         0.5 |   1.94 |    0 |         10 |    0 |   2.43 |        77.95 |  2.04 |   0.3 |     0.74 |  0.005 |   0.11 |          2.24 | 792318.871312692 |        5.8989 | 0.14 | 0.06 |           4 |    0 |    0 |            2.6 |    0 |    0 |             2.5 |    0 |    0 |          0.1 |           0 | 0 | 0 |          2 | 0 |    0 |       600 |      0 |      0 |          50 |     0 |     0 |
| 148010301 |     6.31 | 0.0411 | 3.12E+44 |    1.46E-02 |  -1.84E+00 |      2.69E+44 |     44.4 |                1.05 |   5.77E+26 | 4.19E+01 | 1.31E+01 |      1.37E-03 |     2.66E+05 |  69.699 |  1.3096024231019E+043 |  4.5584983119076E+042 |                3.13E-12 |              1.09E-12 |          3.01 | 0.005 | 0.005 |           0.38 |  2.54 |   0.14 |         0.5 |   1.88 |    0 |         10 |    0 |   2.17 |           80 |     0 |  2.41 |      0.8 |   0.15 |   0.19 |          1.52 | 2068749.94703116 |      6.315708 | 0.03 | 0.03 |          12 |    0 |    0 |            2.8 |    0 |    0 |             2.3 |    0 |    0 |          0.5 |           1 | 0 | 0 |          2 | 0 |    0 |       700 |   8.46 |      0 |          30 |     0 |     0 |
| 506200201 |     6.31 | 0.0411 | 4.28E+44 |    2.41E-03 |  -2.62E+00 |      2.69E+44 |     44.4 |                1.05 |   5.77E+26 | 1.10E+02 | 3.93E+01 |      8.23E-04 |     3.58E+01 |  35.752 | 1.54348803267976E+042 | 1.02926325311698E+042 |                3.69E-13 |              2.46E-13 |           2.4 |  0.28 |  0.31 |           3.29 |  0.35 |   0.49 |        5.04 |   4.96 | 2.37 |         10 |    0 |   8.33 |        78.18 |  1.81 |    64 |      0.8 |   0.01 |   0.38 |          0.19 | 2833622.55012981 |      6.452342 | 0.05 | 0.03 |           5 |    0 |    0 |            2.7 |    0 |    0 |             2.5 |    0 |    0 |          0.2 |           1 | 0 | 0 |          3 | 0 |    0 |       400 |      0 |      0 |          60 | 12.28 | 22.54 |
| 506200301 |     6.31 | 0.0411 | 2.23E+44 |    1.28E-02 |  -1.89E+00 |      2.69E+44 |     44.4 |                1.05 |   5.77E+26 | 3.55E+01 | 1.45E+01 |      1.49E-03 |     7.12E+04 |  35.826 | 5.34067510134694E+042 | 2.85101254260494E+042 |                1.28E-12 |              6.81E-13 |          2.49 |  0.18 |  0.16 |           1.11 |  1.22 |  0.009 |       1.078 |   4.06 | 0.58 |         10 |    0 |   1.95 |        65.77 |  6.08 |  2.55 |     0.12 |   0.64 |  0.007 |          0.47 | 1475057.66945523 |      6.168809 | 0.05 |  0.1 |           3 |    0 |    0 |            2.2 |    0 |    0 |               2 |    0 |    0 |          0.2 |           0 | 0 | 0 |          3 | 0 |    0 |       500 |      0 | 163.08 |          60 | 15.87 | 55.83 |
| 506200401 |     6.31 | 0.0411 | 5.21E+44 |    8.58E-03 |  -2.07E+00 |      2.69E+44 |     44.4 |                1.05 |   5.77E+26 | 5.24E+01 | 2.37E+01 |      9.15E-04 |     1.63E+05 |  37.589 | 1.36117237206307E+043 | 4.46784206001578E+042 |                3.25E-12 |              1.07E-12 |          3.31 | 0.008 | 0.008 |           1.19 |  0.29 |  0.009 |         0.5 |   2.13 |    0 |         10 |    0 |   4.09 |        67.44 | 11.48 |  4.13 |     0.37 |   0.12 |    0.1 |          3.07 | 3449856.25720595 |      6.537801 | 0.01 | 0.01 |          15 | 4.68 | 5.32 |            2.8 |    0 | 0.03 |             1.8 | 0.84 |    0 |            1 |           1 | 0 | 0 |          3 | 0 |    0 |       400 |  23.81 |  33.84 |          20 |  9.77 | 18.96 |
| 506200501 |     6.31 | 0.0411 | 4.69E+44 |    1.32E-02 |  -1.88E+00 |      2.69E+44 |     44.4 |                1.05 |   5.77E+26 | 4.04E+01 | 2.43E+01 |      9.15E-04 |     2.02E+05 |  37.847 | 1.76747066270341E+043 | 6.18310663201114E+042 |                4.22E-12 |              1.48E-12 |          3.16 |  0.13 |  0.11 |           2.06 |  0.27 |   0.23 |         0.5 |   0.91 |    0 |       8.34 | 1.66 |   3.16 |        76.74 |  3.25 |  3.87 |     0.46 |   0.12 |   0.14 |           1.3 | 3105260.22141304 |      6.492098 | 0.01 | 0.05 |          17 |    0 |    0 |            2.6 |    0 |    0 |             1.7 |    0 |    0 |          1.3 |           0 | 0 | 0 |          3 | 0 |    0 |       450 |      0 | 172.48 |          20 |     0 |     0 |
| 511580101 |     6.31 | 0.0411 | 2.43E+44 |    1.76E-02 |  -1.75E+00 |      2.69E+44 |     44.4 |                1.05 |   5.77E+26 | 2.44E+01 | 1.75E+01 |      8.23E-04 |     3.48E+05 | 102.684 | 1.13810330556832E+043 | 4.27495768016068E+042 |                2.72E-12 |              1.02E-12 |          3.14 |  0.12 |  0.01 |           2.31 |  0.13 |   0.25 |        0.59 |   0.62 | 0.01 |         10 |    0 |   1.71 |         77.1 |  2.53 |  3.73 |     0.54 |   0.01 |   0.01 |          1.01 | 1610011.58109767 |      6.206829 | 0.01 | 0.02 |          19 |    0 |    0 |            2.5 |    0 |    0 |               2 |    0 |    0 |          0.5 |           3 | 0 | 0 |          2 | 0 |    0 |       400 |      0 | 221.33 |          30 | 84.41 |     0 |
| 511580201 |     6.31 | 0.0411 | 2.37E+44 |    2.57E-02 |  -1.59E+00 |      2.69E+44 |     44.4 |                1.05 |   5.77E+26 | 3.95E+01 | 1.76E+01 |      8.23E-04 |     8.60E+01 |  86.046 | 1.86952597899758E+043 | 6.09624079072352E+042 |                4.47E-12 |              1.46E-12 |          3.36 | 0.003 |  0.01 |           2.37 |  0.26 |   0.21 |         0.5 |   0.38 |    0 |         10 |    0 |   1.73 |        79.01 |  0.98 |  3.31 |     0.53 |   0.01 |   0.01 |          0.48 | 1570471.28489981 |       6.19603 | 0.02 | 0.04 |          20 |    0 |    0 |            2.9 |    0 |    0 |             1.9 |    0 |    0 |            1 |           2 | 0 | 0 |          2 | 0 |    0 |       200 |      0 |      0 |          10 | 110.5 |     0 |
| 511580301 |     6.31 | 0.0411 | 2.50E+44 |    1.78E-02 |  -1.75E+00 |      2.69E+44 |     44.4 |                1.05 |   5.77E+26 | 3.62E+01 | 1.04E+01 |      1.37E-03 |     3.46E+05 |  77.935 | 1.39433753147138E+043 | 4.45003039478029E+042 |                3.33E-12 |              1.06E-12 |          3.36 |  0.01 |  0.01 |           2.21 |  0.15 |   0.21 |         0.5 |   0.62 |    0 |         10 |    0 |   1.42 |        72.82 |  3.15 |  3.27 |     0.52 |   0.01 |   0.13 |          0.63 | 1654039.96961122 |      6.218546 | 0.01 | 0.01 |          19 |    0 | 6.46 |            2.4 | 0.09 | 0.28 |             1.7 | 1.01 |    0 |          0.7 |           2 | 0 | 0 |          2 | 0 | 0.61 |       350 |   9.39 |    6.1 |          30 |  1.58 |   3.6 |
| 511580401 |     6.31 | 0.0411 | 2.35E+44 |    1.52E-02 |  -1.82E+00 |      2.69E+44 |     44.4 |                1.05 |   5.77E+26 | 6.46E+01 | 2.17E+01 |      8.23E-04 |     7.54E+01 |   75.36 | 1.04181498791835E+043 | 3.55878688943105E+042 |                2.49E-12 |              8.51E-13 |           3.4 |     0 |  0.15 |           1.92 |  0.17 |   0.51 |         0.5 |   1.85 |    0 |         10 |    0 |   3.37 |        69.29 |  6.91 | 10.75 |     0.51 |  0.001 |   0.19 |          1.22 |  1553180.7525187 |      6.191222 | 0.01 | 0.01 |          12 |    0 |    0 |            2.6 |    0 |    0 |             2.4 |    0 |    0 |          0.2 |           1 | 0 | 0 |          3 | 0 |    0 |       400 |      0 | 162.51 |         120 |     0 | 62.93 |
| 653510301 |     6.31 | 0.0411 | 2.78E+44 |    1.17E-02 |  -1.93E+00 |      2.69E+44 |     44.4 |                1.05 |   5.77E+26 | 4.97E+01 | 4.54E+01 |      4.94E-04 |     4.06E+05 | 103.743 | 1.01957592260182E+043 |  3.2578475298322E+042 |                2.44E-12 |              7.79E-13 |           3.4 |     0 |  0.01 |           2.17 |  0.13 |   0.12 |         0.5 |   1.01 |    0 |         10 |    0 |   0.54 |        71.59 |  3.03 |  4.19 |     0.55 |   0.01 |   0.01 |          0.01 | 1841390.93148712 |      6.265146 | 0.06 | 0.18 |          13 |    0 |    0 |            2.2 |    0 |    0 |             1.9 |    0 |    0 |          0.3 |           1 | 0 | 0 |          1 | 0 |    0 |       350 |      0 |      0 |         110 | 13.15 |     0 |
| 653510401 |     6.31 | 0.0411 | 2.64E+44 |    1.58E-02 |  -1.80E+00 |      2.69E+44 |     44.4 |                1.05 |   5.77E+26 | 4.37E+01 | 3.01E+01 |      4.94E-04 |     5.55E+05 | 109.367 | 1.35319991375133E+043 | 4.17178177644837E+042 |                3.23E-12 |              9.97E-13 |          3.25 | 0.003 | 0.004 |           0.76 | 0.007 |  0.003 |        2.28 |   1.22 | 1.78 |         10 |    0 |   0.29 |           80 |     0 |   0.6 |     0.95 |      0 |   0.07 |          2.31 | 1750705.11251647 |      6.243213 | 0.01 | 0.01 |          16 |    0 | 2.42 |            2.3 |    0 | 0.29 |             1.7 | 0.94 |    0 |          0.6 |           2 | 0 | 0 |          2 | 0 |    0 |       350 |  78.49 |   7.59 |          30 | 13.88 |  6.06 |
| 653510501 |     6.31 | 0.0411 | 2.16E+44 |    1.47E-02 |  -1.83E+00 |      2.69E+44 |     44.4 |                1.05 |   5.77E+26 | 5.02E+01 | 3.29E+01 |      4.94E-04 |     3.46E+05 |  86.327 | 9.48972863906741E+042 | 3.17187523255407E+042 |                2.27E-12 |              7.58E-13 |          3.36 |  0.01 |  0.01 |           2.14 |  0.17 |   0.34 |         0.5 |   0.44 |    0 |         10 |    0 |   0.54 |        73.35 |  2.86 |  4.62 |     0.59 |   0.01 |   0.14 |          1.32 | 1429720.02483216 |      6.155251 | 0.01 | 0.02 |          20 |    0 | 9.09 |            2.2 |    0 | 0.34 |             1.9 |    0 |    0 |          0.3 |           3 | 0 | 0 |          3 | 0 |    0 |       350 |  13.82 |  15.38 |          30 | 21.31 | 16.68 |
| 653510601 |     6.31 | 0.0411 | 2.83E+44 |    1.17E-02 |  -1.93E+00 |      2.69E+44 |     44.4 |                1.05 |   5.77E+26 | 1.25E+01 | 1.25E+01 |      1.37E-03 |     4.59E+05 |  97.645 | 1.12778176268752E+043 | 3.29753975576878E+042 |                2.70E-12 |              7.88E-13 |           3.3 |     0 | 0.002 |           0.74 | 0.003 |  0.002 |         0.5 |   0.49 |    0 |         10 |    0 |   0.46 |           80 |     0 |  0.21 |     0.51 |   0.17 |      0 |          1.19 | 1871647.24791301 |      6.272224 | 0.06 | 0.05 |          15 |    0 |    0 |            3.3 |    0 | 1.25 |             1.8 | 1.31 |    0 |          1.5 |           1 | 0 | 0 |          1 | 0 |    0 |       250 |      0 |      0 |          40 |     0 | 21.38 |
| 554710801 |     6.31 | 0.0411 | 2.58E+44 |    4.98E-03 |  -2.30E+00 |      2.69E+44 |     44.4 |                1.05 |   5.77E+26 | 1.29E+01 | 1.64E+01 |      1.37E-03 |     2.68E+04 |  79.974 | 1.71710787802539E+042 | 1.28634094103793E+042 |                4.10E-13 |              3.07E-13 |          2.82 |  0.15 |  0.22 |           1.82 |  0.26 |   0.45 |         0.5 |   0.75 |    0 |         10 |    0 |   1.76 |           80 |     0 |  3.91 |     0.93 |   0.01 |   0.01 |          3.84 | 1711051.17957636 |      6.233263 | 0.02 | 0.02 |          15 |    0 |    0 |            3.3 |    0 |    0 |             2.8 |    0 |    0 |          0.5 |           1 | 0 | 0 |          3 | 0 |    0 |       250 |      0 | 213.38 |          40 | 82.16 |     0 |


#+END_EXAMPLE

** Fmax results plot for all free parameters


PATH =
=/home/steff075/phd_ecm/results-for-all/1H0707_Lum2-10_ecm_freepars.vsz=


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_Lum2-10_ecm_freepars.png

pdf at
http://www.star.bris.ac.uk/steff/ecm/1H0707_Lum2-10_ecm_freepars.pdf

** Fmax posterior density Mass

See "Combined: for $~f_{max}$ isis emcee" (above)

** Fmax ECM parameters against Luminosity (2-10 keV)

PATH  =
=/home/steff075/phd_ecm/results-for-all/1H0707_Lum2-10_ecm_correlated.vsz=

Importing =
=/home/steff075/phd_ecm/results-for-all/1H0707-495_results_All_for_ABS_fmax.ods=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_Lum2-10_ecm_correlated.png

** Testing other parameters aginst RELXILL
PATH  =
=/home/steff075/phd_ecm/results-for-all/1H0707_ecm_correlated.vsz=

*Ionisation*

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_ECM_vs_relxill_xi.png

*Inclination angle*

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_ECM_vs_relxill_incl.png

*Gamma*

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_ECM_vs_relxill_gamma.png

*Afe*

None found


*Cover Fraction*

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_ECM_vs_Cvr_Frac.png

*T-shift*

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707_ECM_vs_tshift.png

** Fmax Lum(2-10k) versus H2

PATH
=/home/steff075/phd_ecm/results-for-all/plot_1H0707_H2_lum2-10k.py=

#+BEGIN_EXAMPLE
import numpy as np
import matplotlib.pyplot as plt
import pandas as pd

#Import data
data = np.loadtxt('1H0707-495_results_fmax.csv', delimiter=',', skiprows=1)
#Where Row 1 = comb, Row 2 = Hi, Row3 = Hi-cts, Row4 = med, Row 5 = Lo, Row 6 = Lo-cts

# Define parameters
lum_03_10k_model = data[:,13]
lum_2_10k_model = data[:,14]
relx_g = data[:,17]
relx_g_err = np.flipud(data[:,18:20].T)
relx_xi = data[:,20]
relx_xi_err = np.flipud(data[:,21:23].T)
relx_Afe = data[:,23]
relx_Afe_err = np.flipud(data[:,24:26].T)
cvr_frac = data[:,32]
cvr_frac_err = np.flipud(data[: ,33:35].T)

### Fmax lags ECM Parameter values ###
fmax_lag = data[:,8]
fmax_lag_err = data[9]
fmax_freq = data[:,10]
fmax_mass = data[:,36]
fmax_mass_err = np.flipud(data[:, 37:39].T)
fmax_h2 = data[:,39]
fmax_h2_err = np.flipud(data[:, 40:42].T)
fmax_g1 = data[:,42]
fmax_g1_err = np.flipud(data[:, 43:45].T)
fmax_g2 = data[:,45]
fmax_g2_err = np.flipud(data[:, 46:48].T)
fmax_ecm_xi = data[:,49]
fmax_ecm_xi_err = np.flipud(data[:, 50:52].T)
fmax_b = data[:,52]
fmax_b_err = np.flipud(data[:, 53:55].T)
fmax_tmax = data[:,55]
fmax_tmax_err = np.flipud(data[:,56:58].T)
fmax_tshift = data[:,58]
fmax_tshift_err = np.flipud(data[:,59:61].T)


plt.errorbar(lum_2_10k_model, fmax_h2, fmax_h2_err, fmt='o', c='k')
plt.xlabel(r'Luminosity (2-10 keV)', fontsize=14)
plt.ylabel(r'H2', fontsize=14)
plt.xscale("log")
#labels = [r'$Legacy$', '$v_{max}$']
#plt.legend(labels, loc='best', frameon=True, fontsize='11')
plt.tight_layout()
plt.show(block=False)
plt.show()
plt.savefig('1H0707-H2-Luminos2-10.png')

#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707-H2-Luminos2-10.png

** Luminosity versus photon Index $\Gamma$

*L (2-10 keV) v Gamma*

PATH =
=/home/steff075/phd_ecm/results-for-all/1H0707_Lum2-10_ecm_gammaVL2-10.vsz=


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_Lum2-10_ecm_gammaVL2-10.png


*L_edd v Gamma*


PATH =
=/home/steff075/phd_ecm/results-for-all/1H0707_Lum2-10_ecm_gammaVLedd.vsz=


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_Lum2-10_ecm_gammaVLedd.png


*L_bol/L_edd v Gamma*


PATH =
=/home/steff075/phd_ecm/results-for-all/1H0707_Lum2-10_ecm_gammaVLbol_Ledd.vsz=

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_Lum2-10_ecm_gammaVLbol_Ledd.png







** Weighted least squares on H2 and Luminosity 2-10 keV

PATH =
=/home/steff075/phd_ecm/results-for-all/wls_ols_1H0708_example.py=


#+BEGIN_EXAMPLE
import pandas as pd
import numpy as np
import statsmodels.api as sm # for OLS and WLS
import seaborn as sns
import matplotlib.pyplot as plt
plt.style.use('classic')
plt.rcParams['font.family'] = 'serif'

# Import data
data = np.loadtxt('1H0707-495_results_fmax.csv', delimiter=',', skiprows=1)

# Define the columns required
lum_2_10k_model = data[:,14]
fmax_h2 = data[:,39]
fmax_h2_err = np.flipud(data[:, 40:42].T)


# Now let’s first use Ordinary Least Square method to predict the cost.
# OLS
Y = fmax_h2
X = lum_2_10k_model
height_ols = sm.OLS(Y,X).fit()

#cost Vs num.Response
Y_pred = height_ols.predict(X)
plt.scatter(X, Y, color='k')
plt.xlabel(r'L (2-10 keV) (10$^{42}$ erg s$^{-1}$)')
plt.ylabel(r'Height 2 ($r_g$)')
#plt.xscale('log')
plt.plot(X, Y_pred, color='steelblue')
#plt.show()
plt.savefig('1H0707-H2-Lum-OLS.png')

#+END_EXAMPLE


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707-H2-Lum-OLS.png

Residual plot

#+BEGIN_EXAMPLE
sns.residplot(X, Y)
#plt.show()
#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707-H2-Lum-OLS-residuals.png

The above residual plot shows that the number of responses seems to
decrease linearly with the standard deviation
of residuals, hence proving heteroscedasticity (non-constant variance).


#+BEGIN_EXAMPLE
print('R2_ols: ', height_ols.rsquared)
R2_ols:  0.3418050106333539
#+END_EXAMPLE

Now let’s use Weighted Least Square method to predict the cost and see
how the results vary.

#+BEGIN_EXAMPLE
#WLS
w = 1/(X**2)
height_wls = sm.WLS(Y,X, weights=w).fit()

#+END_EXAMPLE

Comparing the $R^2$  values:

$R^2$ evaluates the scatter of the data points around the fitted
regression line.
For the same data set, higher R-squared values represent smaller
differences between the observed data and the fitted values.
$R^2$ is the percentage of the dependent variable variation that a
linear model explains.

Technically,  $R^2$ = Variance explained by the model / Total variance

#+BEGIN_EXAMPLE
print('R2_ols: ', height_ols.rsquared)
print('R2_WLS: ', height_wls.rsquared)

R2_ols:  0.3418050106333539

R2_WLS:  0.11724903249056162
#+END_EXAMPLE


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/

* 1H0707-495 Results for all lags (1st fit, ABS and $f_{max}$)

The full results for the 1st lags, the ABS lags and the f_max lags
are recorded in


PATH =
=/home/steff075/phd_ecm/results-for-all/1H0707-495_results_single_obs.ods=
( and the .csv file)

and ths csv file which can be sourced from here:

http://www.star.bris.ac.uk/steff/ecm/1H0707-495_results_single_obs.csv


Lets look at these data:

PATH = =/home/steff075/phd_ecm/results-for-all/plot_ecm_pars.py=


#+BEGIN_EXAMPLE
import numpy as np
import matplotlib.pyplot as plt
import emcee
import corner

#Import data
data = np.loadtxt('1H0707-495_results_single_obs.csv', delimiter=',', skiprows=1)

# Define parameters
lum_03_10k_model = data[:,7]
lum_03_10k_data = data[:,8]
lum_2_10k_model = data[:,9]
lum_2_10k_data = data[:,10]
flux_03_10k_model = data[:,11]
flux_03_10k_data = data[:,12]
flux_2_10k_model = data[:,13]
flux_2_10k_data = data[:,14]
relx_g = data[:,15]
relx_g_err = np.flipud(data[:,15])
relx_xi = data[:,18]
relx_xi_err = np.flipud(data[:,18])
relx_fe = data[:,21]
relx_fe_err = np.flipud(data[:,21])
relx_inc = data[:,27]
relx_inc_err = np.flipud(data[:,27])
cvr_frac = data[:,30]
cvr_frac_err = np.flipud(data[: ,31:33].T)

#+END_EXAMPLE


*** Lags and Mass

#+BEGIN_EXAMPLE
plt.errorbar(abs_mass, abs_lag, fmt='o', c='k')
plt.errorbar(fmax_mass, fmax_lag, fmt='o', c = 'b')
plt.xlabel(r'Mass', fontsize=14)
plt.ylabel(r'Lag Amplitude', fontsize=14)
labels = [r'$Legacy$', '$v_{max}$']
plt.legend(labels, loc='upper right', frameon=True, fontsize='11')
#plt.show(block=False)
#plt.show()
plt.tight_layout()
plt.savefig('1H0707-ecm-lag-M.png')
#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-ecm-lag-M.png

*** Lags and H2

#+BEGIN_EXAMPLE
plt.errorbar(abs_h2, abs_lag, fmt='o', c='k')
plt.errorbar(fmax_h2, fmax_lag, fmt='o', c = 'b')
plt.xlabel(r'h2', fontsize=14)
plt.ylabel(r'Lag Amplitude', fontsize=14)
labels = [r'$Legacy$', '$v_{max}$']
plt.legend(labels, loc='upper right', frameon=True, fontsize='11')
#plt.show(block=False)
#plt.show()
plt.tight_layout()
plt.savefig('1H0707-ecm-lag-h2.png')
#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/1H0707-ecm-lag-h2.png

* 1H0707-495 Table Model fits

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/

** Combined ECM best fit

Test this model on the 1H0707-495 fmax best fit using:

#+BEGIN_EXAMPLE
isis fit-table-model-comb.sl

source("fit-table-model-comb.sl");



t_g = 6.327803e+00
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.5037519
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         5.761701           0         100
  2  lag_freq(1).log_mass   0     0         6.108667           5           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         3.494411           3          20
  7  lag_freq(1).Gamma1     0     0              2.4         2.4         2.8
  8  lag_freq(1).Gamma2     0     0         1.937485         1.9         2.6
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0       0.01237976           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0                3           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         370.8728         100         400
 15  lag_freq(1).t_shift    0     0         17.06472          10          80
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  2.5421e-03     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-comb-time-lags-fmax.fits

source("confidence.sl");

gedit conf_comb.csv

| lag_freq(1).norm     | 5.761701e+00 | +6.307279e-01 | -6.342441e-01 |
| lag_freq(1).log_mass | 6.108667e+00 | +1.008009e-02 | -3.308256e-02 |
| lag_freq(1).h2       | 3.494411e+00 | +3.502848e-01 | -3.551419e-01 |
| lag_freq(1).Gamma1   | 2.400000e+00 | +8.652397e-03 | -0.000000e+00 |
| lag_freq(1).Gamma2   | 1.937485e+00 | +1.042854e-02 | -1.043629e-02 |
| lag_freq(1).xi       | 1.237976e-02 | +1.087183e-01 | -1.237976e-02 |
| lag_freq(1).b        | 3.000000e+00 | +0.000000e+00 | -4.051949e-02 |
| lag_freq(1).t_max    | 3.708728e+02 | +1.312989e+01 | -1.327302e+01 |
| lag_freq(1).t_shift  | 1.706472e+01 | +2.033427e-01 | -2.008003e-01 |

#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 5.761701e+00 | +6.307279e-01 | -6.342441e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.108667e+00 | +1.008009e-02 | -3.308256e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 3.494411e+00 | +3.502848e-01 | -3.551419e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 2.400000e+00 | +8.652397e-03 | -0.000000e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 1.937485e+00 | +1.042854e-02 | -1.043629e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 1.237976e-02 | +1.087183e-01 | -1.237976e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 3.000000e+00 | +0.000000e+00 | -4.051949e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 3.708728e+02 | +1.312989e+01 | -1.327302e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 1.706472e+01 | +2.033427e-01 | -2.008003e-01 |
+----------------------+--------------+---------------+---------------+


#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_tm_comb.gif

pdf at

http://www.star.bris.ac.uk/steff/ecm/1H0707-495_tm_comb.pdf

** Combined ISIS EMCEE

PATH ==

Define Priors

#+BEGIN_EXAMPLE
variable prior_info = struct
{
    parlist, priorlist
};

variable norm = @prior_info; norm.parlist = 1;
variable mass = @prior_info; mass.parlist = 2;
variable h2 = @prior_info; h2.parlist = 3;
variable g1 = @prior_info; g1.parlist = 4;
variable g2 = @prior_info; g2.parlist = 5;
variable xi = @prior_info; xi.parlist = 6;
variable b = @prior_info; b.parlist = 7;
variable tmax = @prior_info; tmax.parlist = 8;
variable tshift = @prior_info; tshift.parlist = 9;

variable norm_prior = struct{mean=6, sigma=1.0};
variable mass_prior = struct{mean=6.2, sigma=0.5};
variable h2_prior = struct{mean=3, sigma=1.0};
variable g1_prior = struct{mean=2.4, sigma=0.5};
variable g2_prior = struct{mean=1.9, sigma=0.5};
variable xi_prior = struct{mean=0, sigma=0.5};
variable b_prior = struct{mean=3, sigma=0.5};
variable tmax_prior = struct{mean=370, sigma=20.0};
variable tshift_prior = struct{mean=10, sigma=0.5};

emcee(100, 1000; output="1H0707_test1.fits", priors=struct{parlist=[1-9], priorlist=[norm_prior, mass_prior, h2_prior, g1_prior, g2_prior, xi_prior, b_prior, tmax_prior, tshift_prior]}, serial);
#+END_EXAMPLE


#+BEGIN_EXAMPLE
isis
.source("combined-emcee.sl");

Running chain 1H0707_comb_tm_chain.fits
#+END_EXAMPLE

*Walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_comb_tm_walkers-1.png


*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_comb_tm_mass_accept_rate-1.png


Obtain the Norm pobability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_comb_tm_norm_prob-1.png


Obtain the Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_comb_tm_mass_prob-1.png

*Contours: paths in 2D*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_comb_tm_chain_hist2d-1.png

*Chain statistics*


#+BEGIN_EXAMPLE
isis> s=600; % start at this iteration step
isis> min(min_statistic[[s:]]);
1.700123241297263
isis> nmax;
105

#+END_EXAMPLE


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_comb_tm_statistics-1.png


Error analysis

conf90

#+BEGIN_EXAMPLE
isis> conf_min;
6.066052985191345
isis> conf_max;
6.312748816013336
isis> conf_mean;
6.18940090060234


#+END_EXAMPLE

#+CAPTION: The 90% confidence probability for 1H0707-495 Mass value where $\mu =\pm0.0$ (solid blue line) with the error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_comb_tm_logmass_conf90-1.png

** Combined EMCEE - large chain 200 walkers and 100k iterations

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/fit-tm-emcee-comb.sl=

PARFILE = =tm_comb.par=


#+BEGIN_EXAMPLE

% Run the chain

emcee(200, 100000; output="1H0707_tm_emcee_comb.fits", serial);

#####  Note this chain is 15Gb  ########

isis
source("fit-tm-emcee-comb.sl");

[detached from 83473.pts-28.hm00]

isis> list_free;
lag_freq

emcee_par  idx  param             tie-to  freeze         value         min         max
 0         1  lag_freq(1).norm       0     0         5.761701           0         100
 1         2  lag_freq(1).log_mass   0     0         6.108667           5           8
 2         6  lag_freq(1).h2         0     0         3.494411           3          20
 3         7  lag_freq(1).Gamma1     0     0              2.4         2.4         2.8
 4         8  lag_freq(1).Gamma2     0     0         1.937485         1.9         2.6
 5        10  lag_freq(1).xi         0     0       0.01237976           0           3
 6        12  lag_freq(1).b          0     0                3           1           3
 7        14  lag_freq(1).t_max      0     0         370.8728         100         400
 8        15  lag_freq(1).t_shift    0     0         17.06472          10          80

#+END_EXAMPLE


Walker Paths

#+BEGIN_EXAMPLE
close_plot; % start with a fresh plot window
_for i (0, nw-1, 1) { % loop over all walkers and plot their path
  chain_plot(1,i, nw, chain; oplot);
};

variable pid = open_plot("1H0707_tm_comb_walkers100k.ps/cps");
charsize(1.3); %good font size
_pgscf(2); %make font roman
chain_plot(1,i,nw,chain);
close_plot(pid);


pdftocairo -png 1H0707_tm_comb_walkers100k.pdf
cp 1H0707_tm_comb_walkers100k-1.png /home/WWW/steff/ecm
#+END_EXAMPLE


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_tm_comb_walkers100k-1.png

Acceptance rate


#+BEGIN_EXAMPLE
% Obtain acceptance Rate
frac_update = read_chain("1H0707_tm_emcee_comb.fits"; frac_update);
xlabel("Iteration Step");
ylabel("Acceptance Rate");
popt.dsym = [6];
popt.dcol = 4;
plot([0:length(frac_update)-1], frac_update);
plot(([0:length(frac_update)-1], frac_update); dsym=6, dcol=2);

% Make good image of the acceptance Rate
variable pid = open_plot("1H0707_tm_comb_mass_accept_rate100k.ps/cps");
charsize(1.4); %good font size
_pgscf(2); %make font roman
xlabel("Iteration Step");
ylabel("Acceptance Rate");
plot([0:length(frac_update)-1], frac_update);
close_plot(pid);

cp 1H0707_tm_comb_mass_accept_rate100k.pdf /home/WWW/steff/ecm
pdftocairo -png 1H0707_tm_comb_mass_accept_rate100k.pdf
cp 1H0707_tm_comb_mass_accept_rate100k.pdf /home/WWW/steff/ecm

#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_tm_comb_mass_accept_rate100k-1.png


Norm probability


#+BEGIN_EXAMPLE
% Norm probability
% Define range and bin size
pmin = 5.5, pmax = 7.0;
nbin = 300;

% Obtain the probability distributions of the norm
chain_hist(0, chain; fcut = 0.3, pmin = 0, pmax = 100, nbin = nbin); % norm

% Make good image of the Norm probability
variable pid = open_plot("1H0707_comb_tm_comb_norm_prob100k.ps/cps");
charsize(1.4); %good font size
_pgscf(2); %make font roman
chain_hist(0,chain; fcut = 0.3, min = 0, pmax = 100, nbin=nbin);
close_plot(pid);

ps2pdf 1H0707_tm_comb_norm_prob100k.ps
pdftocairo -png 1H0707_tm_comb_norm_prob100k.pdf
cp 1H0707_tm_comb_norm_prob100k-1.png /home/WWW/steff/ecm

#+END_EXAMPLE


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_tm_comb_norm_prob100k-1.png

Mass probability


#+BEGIN_EXAMPLE
chain_hist(1, chain; fcut = 0.3, pmin = 5.0, pmax = 8.0, nbin = nbin); % log_mass
variable pid = open_plot("1H0707_tm_comb_mass_prob100k.ps/cps");
charsize(1.35); %good font size
_pgscf(2); %make font roman
chain_hist(1,chain; fcut = .3);
close_plot(pid);

#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_tm_comb_mass_prob100k-1.png


Contour plot


#+BEGIN_EXAMPLE
chain_hist2d(1, 0, chain; nbinx = 200, nbiny = 200, xlo = 5.5, xhi = 7.0, ylo = 0, yhi = 100);

%Make good image of the Contours
variable pid = open_plot("1H0707_tm_comb_chain_hist2d.ps/cps");
charsize(1.3); %good font size
_pgscf(2); %make font roman
chain_hist2d(1,0,chain; nbinx = 300, nbiny = 300, xlo = 5.5, xhi = 7.0, ylo = 0, yhi = 100);
close_plot(pid);

h
#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_tm_comb_chain_hist2d-1.png

NOTES

The acceptence fraction is very low

It seems the normalisation may be causing issues

When run on BC4 the norm went from 0 - 0.001 and this converged well
in the fit - see Chp 23.3.

#####  Rerun this chain where the norm range is 0 - 10 ??? #####

But wait - see below (hiflux fit) - great fit where norm = 100 !! ??

########################






** Combined EMCEE - by just reading the lag-files and importing emcee

PATH =
=/data/typhon1/reverb/1H0707-495/isis_emcee/1H0707-comb-emcee-TM-fit.sl=


Run chain  200 walkers and 50,000 iterations =
=1H0707_comb_TM_fit_chain.fits=

Best file is parfile =conf_comb.par=

#+BEGIN_EXAMPLE
t_g = 6.327803e+00
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.5037519
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         5.761701           0         100
  2  lag_freq(1).log_mass   0     0         6.108667           5           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         3.494411           3          20
  7  lag_freq(1).Gamma1     0     0              2.4         2.4         2.8
  8  lag_freq(1).Gamma2     0     0         1.937485         1.9         2.6
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0       0.01237976           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0                3           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         370.8728         100         400
 15  lag_freq(1).t_shift    0     0         17.06472          10          80
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  2.5421e-03     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-comb-time-lags-fmax.fits
#+END_EXAMPLE

Dont start at the best fit - provide a rough parfile =conf_comb_test.par=

#+BEGIN_EXAMPLE
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0                2           0         100
  2  lag_freq(1).log_mass   0     0              6.2         5.5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0                5           3          20
  7  lag_freq(1).Gamma1     0     0              2.6         1.8         3.3
  8  lag_freq(1).Gamma2     0     0              2.0         1.4         3.2
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0                1           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0                2           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0              400         100         700
 15  lag_freq(1).t_shift    0     0               50          10         120
#+END_EXAMPLE

#+BEGIN_EXAMPLE
Run code:

source("1H0707-comb-emcee-TM-fit.sl");

[detached from 131020.pts-36.hm00]


(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("1H0707_comb_TM_fit_chain.fits");

close_plot; % start with a fresh plot window
_for i (0, nw-1, 1) { % loop over all walkers and plot their path
  chain_plot(1,i, nw, chain; oplot);
};


#+END_EXAMPLE

*This method did not converge* it seems to explore all parameter space
and cannot find a good fit ?!


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_comb_TM_fit_walkers-1.png

** Combined EMCEE - by reading the lag-files AND TM and importing emcee

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/fit-tm-emcee-comb.sl=


Run chain  200 walkers and 20,000 iterations =
=1H0707_comb_TM_fit_chain.fits=

Best file is parfile =conf_comb.par=

#+BEGIN_EXAMPLE
t_g = 6.327803e+00
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.5037519
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         5.761701           0         100
  2  lag_freq(1).log_mass   0     0         6.108667           5           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         3.494411           3          20
  7  lag_freq(1).Gamma1     0     0              2.4         2.4         2.8
  8  lag_freq(1).Gamma2     0     0         1.937485         1.9         2.6
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0       0.01237976           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0                3           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         370.8728         100         400
 15  lag_freq(1).t_shift    0     0         17.06472          10          80
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  2.5421e-03     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-comb-time-lags-fmax.fits
#+END_EXAMPLE

Dont start at the best fit - provide a rough parfile =conf_comb_test.par=

#+BEGIN_EXAMPLE
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0                2           0          10
  2  lag_freq(1).log_mass   0     0              6.2           5           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0                5           3          20
  7  lag_freq(1).Gamma1     0     0              2.6           2           3
  8  lag_freq(1).Gamma2     0     0              2.0         1.6         2.8
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0                1           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0                2           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0              400         100         800
 15  lag_freq(1).t_shift    0     0               50          10         120
#+END_EXAMPLE

#+BEGIN_EXAMPLE
Run code:

source("fit-tm-emcee-comb.sl");

emcee(200, 20000; output="1H0707_tm_emcee_comb.fits", serial);

#+END_EXAMPLE


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_tm_exp_comb_walkers-1.png


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_tm_exp_comb_mass_accept_rate-1.png


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_tm_exp_comb_norm_prob-1.png


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_tm_exp_comb_mass_prob-1.png


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_tm_exp_comb_chain_hist2d-1.png


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_tm_comb_statistics-1.png


*Statistics*

#+BEGIN_EXAMPLE
isis> s=1000; % start at this iteration step
isis> min(min_statistic[[s:]]);
2.388314970202768


isis> conf_min;
6.1636433601379395
isis> conf_max;
6.319866077105204
isis> conf_mean;
6.241754718621571


Result = 6.242 \pm 0.078

#+END_EXAMPLE



#+ATTR_HTML: :width 700
#+CAPTION: The 90% confidence probability for 1H0707-495 Mass value where $\mu = 6.242\pm0.078$ (solid blue line) with the error range between the black dashed lines.
http://www.star.bris.ac.uk/steff/ecm/1H0707_TM_comb_logmass_conf90-1.png


pdf at:


http://www.star.bris.ac.uk/steff/ecm/1H0707_TM_comb_logmass_conf90.pdf




** Combined EMCEE - TM_small (smaller table model for faster analysis)

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/TM_small=

For this table model use parfile  =conf_comb_test.par=
gedit
#+BEGIN_EXAMPLE
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0                2           0          10
  2  lag_freq(1).log_mass   0     0              6.2           5           8
  3  lag_freq(1).i          0     1               53          53          53
  4  lag_freq(1).a          0     1            0.998       0.998       0.998
  5  lag_freq(1).h1         0     1                2           2           2
  6  lag_freq(1).h2         0     0                5           3          20
  7  lag_freq(1).Gamma1     0     0              2.6           2         3.2
  8  lag_freq(1).Gamma2     0     0                2         1.6         2.9
  9  lag_freq(1).Fe         0     1                1           1           1
 10  lag_freq(1).xi         0     0                1           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0                2           1           3
 13  lag_freq(1).q2         0     1              0.5         0.5         0.5
 14  lag_freq(1).t_max      0     0              400          50         700
 15  lag_freq(1).t_shift    0     0               50          10         120

#+END_EXAMPLE

#+BEGIN_EXAMPLE
 source("fit-tm-emcee-comb.sl");

 --  Using 1H0707_tmsmall_emcee_comb.fits for output file --

emcee(200, 50000; output="1H0707_tmsmall_emcee_comb.fits", serial);

[detached from 11090.pts-32.hm00]




Fitting error - inconsistent array sizes - see TM_small directory



#+END_EXAMPLE



** Hi-flux ECM best fit

#+BEGIN_EXAMPLE
.source("fit-table-model-hiflux.sl");

t_g = 8.028958e+00
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.07241322
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         99.95332           0         100
  2  lag_freq(1).log_mass   0     0         6.212073           5           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         10.03655           3          20
  7  lag_freq(1).Gamma1     0     0         2.693973         2.4         2.8
  8  lag_freq(1).Gamma2     0     0         1.931118         1.9         2.6
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         2.006761           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.999273           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         308.2947         100         400
 15  lag_freq(1).t_shift    0     0         15.91065          10          80
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  2.5451e-03     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-hiflux-time-lags-fmax.fits

| lag_freq(1).norm     | 9.995332e+01 | +4.668005e-02 | -9.756115e+01 |
| lag_freq(1).log_mass | 6.212073e+00 | +2.054566e-04 | -1.664238e-01 |
| lag_freq(1).h2       | 1.003655e+01 | +7.165874e-01 | -7.036552e+00 |
| lag_freq(1).Gamma1   | 2.693973e+00 | +1.060272e-01 | -2.204792e-01 |
| lag_freq(1).Gamma2   | 1.931118e+00 | +4.252204e-01 | -3.111793e-02 |
| lag_freq(1).xi       | 2.006761e+00 | +9.932385e-01 | -2.006761e+00 |
| lag_freq(1).b        | 2.999273e+00 | +7.270395e-04 | -1.273441e-02 |
| lag_freq(1).t_max    | 3.082947e+02 | +1.839176e+01 | -2.767991e+01 |
| lag_freq(1).t_shift  | 1.591065e+01 | +4.956641e+00 | -2.492162e+00 |

#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 9.995332e+01 | +4.668005e-02 | -9.756115e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.212073e+00 | +2.054566e-04 | -1.664238e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 1.003655e+01 | +7.165874e-01 | -7.036552e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 2.693973e+00 | +1.060272e-01 | -2.204792e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 1.931118e+00 | +4.252204e-01 | -3.111793e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 2.006761e+00 | +9.932385e-01 | -2.006761e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 2.999273e+00 | +7.270395e-04 | -1.273441e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 3.082947e+02 | +1.839176e+01 | -2.767991e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 1.591065e+01 | +4.956641e+00 | -2.492162e+00 |
+----------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_tm_hiflux.gif

pdf at:
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_tm_hiflux.pdf

** Hi-cts ECM best fit

#+BEGIN_EXAMPLE
.source("fit-table-model-hicts-flux.sl");

t_g = 1.163753e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.001306738
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         6.508975           0         100
  2  lag_freq(1).log_mass   0     0         6.373275           5           8
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         15.14962           3          20
  7  lag_freq(1).Gamma1     0     0         2.659677         2.4         2.8
  8  lag_freq(1).Gamma2     0     0         1.900017         1.9         2.6
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         2.442386           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.514858           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         234.4178         100         400
 15  lag_freq(1).t_shift    0     0         21.03706          10          80
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  6.3396e-03     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-hi-cts-time-lags-fmax.fits
isis>

| lag_freq(1).norm     | 6.508975e+00 | +1.056057e+00 | -3.372630e+00 |
| lag_freq(1).log_mass | 6.373275e+00 | +6.259843e-02 | -1.250131e-01 |
| lag_freq(1).h2       | 1.514962e+01 | +4.850378e+00 | -5.127449e-09 |
| lag_freq(1).Gamma1   | 2.659677e+00 | +1.403228e-01 | -6.332382e-02 |
| lag_freq(1).Gamma2   | 1.900017e+00 | +1.473051e-01 | -1.672012e-05 |
| lag_freq(1).xi       | 2.442386e+00 | +5.576135e-01 | -2.442386e+00 |
| lag_freq(1).b        | 2.514858e+00 | +1.749260e-01 | -1.340822e-04 |
| lag_freq(1).t_max    | 2.344178e+02 | +4.475493e-03 | -2.580331e+00 |
| lag_freq(1).t_shift  | 2.103706e+01 | +1.581889e-04 | -7.831995e-02 |

#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 6.508975e+00 | +1.056057e+00 | -3.372630e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.373275e+00 | +6.259843e-02 | -1.250131e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 1.514962e+01 | +4.850378e+00 | -5.127449e-09 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 2.659677e+00 | +1.403228e-01 | -6.332382e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 1.900017e+00 | +1.473051e-01 | -1.672012e-05 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 2.442386e+00 | +5.576135e-01 | -2.442386e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 2.514858e+00 | +1.749260e-01 | -1.340822e-04 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 2.344178e+02 | +4.475493e-03 | -2.580331e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 2.103706e+01 | +1.581889e-04 | -7.831995e-02 |
+----------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_tm_hicts.gif

pdf at:
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_tm_hicts.pdf

** Med-flux

#+BEGIN_EXAMPLE
.source("fit-table-model-medflux.sl");

t_g = 9.982231e-01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 1.114879
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0           99.712           0         100
  2  lag_freq(1).log_mass   0     0         5.306642           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0          5.02973           3          20
  7  lag_freq(1).Gamma1     0     0          2.56599         2.4         3.3
  8  lag_freq(1).Gamma2     0     0          2.47266         1.9         2.8
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0       0.04536225           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         1.768971           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         667.1331         100         700
 15  lag_freq(1).t_shift    0     0         71.68336          10         120
Syntax Error
<stdin>:8:<top-level>:Syntax Error
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  2.4064e-02     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-med-time-lags-fmax.fits

| lag_freq(1).norm     | 9.971200e+01 | +2.879977e-01 | -8.383711e+01 |
| lag_freq(1).log_mass | 5.306642e+00 | +1.980057e-01 | -3.387836e-02 |
| lag_freq(1).h2       | 5.029730e+00 | +1.497027e+01 | -8.697062e-01 |
| lag_freq(1).Gamma1   | 2.565990e+00 | +2.429634e-01 | -5.196847e-02 |
| lag_freq(1).Gamma2   | 2.472660e+00 | +1.374272e-02 | -5.023125e-01 |
| lag_freq(1).xi       | 4.536225e-02 | +2.954638e+00 | -4.536225e-02 |
| lag_freq(1).b        | 1.768971e+00 | +1.231029e+00 | -7.659225e-01 |
| lag_freq(1).t_max    | 6.671331e+02 | +3.286687e+01 | -5.671331e+02 |
| lag_freq(1).t_shift  | 7.168336e+01 | +8.519385e+00 | -4.625302e+01 |

#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 9.971200e+01 | +2.879977e-01 | -8.383711e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 5.306642e+00 | +1.980057e-01 | -3.387836e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 5.029730e+00 | +1.497027e+01 | -8.697062e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 2.565990e+00 | +2.429634e-01 | -5.196847e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 2.472660e+00 | +1.374272e-02 | -5.023125e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 4.536225e-02 | +2.954638e+00 | -4.536225e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 1.768971e+00 | +1.231029e+00 | -7.659225e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 6.671331e+02 | +3.286687e+01 | -5.671331e+02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 7.168336e+01 | +8.519385e+00 | -4.625302e+01 |
+----------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_tm_medflux.gif


pdf at:
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_tm_medflux.pdf

** Lo-flux

#+BEGIN_EXAMPLE
.source("fit-table-model-loflux.sl");

t_g = 7.913759e+00
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 1.574947
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         7.265111           0         100
  2  lag_freq(1).log_mass   0     0         6.205797           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         3.000001           3          20
  7  lag_freq(1).Gamma1     0     0         3.089407         2.4         3.3
  8  lag_freq(1).Gamma2     0     0         1.900001         1.9         2.8
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0          2.99465           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         1.937204           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         615.5283         100         700
 15  lag_freq(1).t_shift    0     0         59.99995          10         120
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  1.3503e-02     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-loflux-time-lags-fmax.fits


| lag_freq(1).norm     | 7.265111e+00 | +1.381927e+01 | -6.915475e+00 |
| lag_freq(1).log_mass | 6.205797e+00 | +2.601148e-01 | -3.926078e-01 |
| lag_freq(1).h2       | 3.000001e+00 | +2.991093e+00 | -1.126426e-06 |
| lag_freq(1).Gamma1   | 3.089407e+00 | +8.801006e-03 | -2.833963e-02 |
| lag_freq(1).Gamma2   | 1.900001e+00 | +4.975118e-01 | -7.785259e-07 |
| lag_freq(1).xi       | 2.994650e+00 | +5.349897e-03 | -9.854972e-01 |
| lag_freq(1).b        | 1.937204e+00 | +1.062796e+00 | -9.372042e-01 |
| lag_freq(1).t_max    | 6.155283e+02 | +3.431380e+01 | -5.155283e+02 |
| lag_freq(1).t_shift  | 5.999995e+01 | +4.670664e+01 | -2.368348e+01 |

#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 7.265111e+00 | +1.381927e+01 | -6.915475e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.205797e+00 | +2.601148e-01 | -3.926078e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 3.000001e+00 | +2.991093e+00 | -1.126426e-06 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 3.089407e+00 | +8.801006e-03 | -2.833963e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 1.900001e+00 | +4.975118e-01 | -7.785259e-07 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 2.994650e+00 | +5.349897e-03 | -9.854972e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 1.937204e+00 | +1.062796e+00 | -9.372042e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 6.155283e+02 | +3.431380e+01 | -5.155283e+02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 5.999995e+01 | +4.670664e+01 | -2.368348e+01 |
+----------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_tm_loflux.gif


pdf at
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_tm_loflux.pdf

** Loflux ISIS_EMCEE

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495=

#+BEGIN_EXAMPLE
isis
.source("loflux-emcee.sl");

Running chain 1H0707_loflux_tm_chain.fits
#+END_EXAMPLE

*Walkers*


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_loflux_tm_walkers-1.png


*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_loflux_tm_mass_accept_rate-1.png


Obtain the Norm pobability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_loflux_tm_norm_prob-1.png


Obtain the Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_loflux_tm_mass_prob-1.png

*Contours: paths in 2D*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_loflux_tm_chain_hist2d-1.png

*Chain statistics*


#+BEGIN_EXAMPLE
s=600; % start at this iteration step
min(min_statistic[[s:]]);

2.2362697267688487
#+END_EXAMPLE


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_loflux_tm_statistics-1.png


Error analysis

conf90

#+BEGIN_EXAMPLE
isis> conf_min;


#+END_EXAMPLE



#+CAPTION: The 90% confidence probability for 1H0707-495 Mass value where $\mu =\pm0.0$ (solid blue line) with the error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_loflux_tm_logmass_conf90.gif

** Lo-cts

#+BEGIN_EXAMPLE
.source("fit-table-model-lo-cts-flux.sl");

t_g = 3.849133e+00
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.4601746
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         18.44222           0         100
  2  lag_freq(1).log_mass   0     0         5.892777           5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         3.000001           3          20
  7  lag_freq(1).Gamma1     0     0         2.408245         2.4         3.3
  8  lag_freq(1).Gamma2     0     0         2.250765         1.9         2.8
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0       0.02167869           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.125064           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0          616.614         100         700
 15  lag_freq(1).t_shift    0     0         45.16076          10         120
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  9.7771e-03     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-lo-cts-time-lags-fmax.fits

| lag_freq(1).norm     | 1.844222e+01 | +8.155778e+01 | -1.477749e+01 |
| lag_freq(1).log_mass | 5.892777e+00 | +1.770170e-01 | -1.067153e-01 |
| lag_freq(1).h2       | 3.000001e+00 | +1.700000e+01 | -1.460119e-06 |
| lag_freq(1).Gamma1   | 2.408245e+00 | +1.173301e-01 | -8.245348e-03 |
| lag_freq(1).Gamma2   | 2.250765e+00 | +1.858037e-01 | -4.661089e-02 |
| lag_freq(1).xi       | 2.167869e-02 | +2.073225e+00 | -2.167869e-02 |
| lag_freq(1).b        | 2.125064e+00 | +8.749362e-01 | -6.785878e-01 |
| lag_freq(1).t_max    | 6.166140e+02 | +8.338599e+01 | -1.013636e+02 |
| lag_freq(1).t_shift  | 4.516076e+01 | +1.332420e+01 | -1.972764e+00 |

#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 1.844222e+01 | +8.155778e+01 | -1.477749e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 5.892777e+00 | +1.770170e-01 | -1.067153e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 3.000001e+00 | +1.700000e+01 | -1.460119e-06 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 2.408245e+00 | +1.173301e-01 | -8.245348e-03 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 2.250765e+00 | +1.858037e-01 | -4.661089e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 2.167869e-02 | +2.073225e+00 | -2.167869e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 2.125064e+00 | +8.749362e-01 | -6.785878e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 6.166140e+02 | +8.338599e+01 | -1.013636e+02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 4.516076e+01 | +1.332420e+01 | -1.972764e+00 |
+----------------------+--------------+---------------+---------------+


#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_tm_locts.gif

pdf at
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_tm_locts.pdf

** OBS 0110890201 ECM best fit

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/fit-table-model-0110890201.sl=

#+BEGIN_EXAMPLE
isis

.source("fit-table-model-0110890201.sl");

t_g = 3.400399e+00
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 1.741573
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         5.555514           0         100
  2  lag_freq(1).log_mass   0     0         5.838944         5.5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0          19.3333           3          20
  7  lag_freq(1).Gamma1     0     0         2.131928           2           3
  8  lag_freq(1).Gamma2     0     0         1.700003         1.7         2.5
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0       0.01168316           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         1.871212           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         700.0754         100         800
 15  lag_freq(1).t_shift    0     0         43.72266          10         100
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -3.9595e-02     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-OBS-0110890201-time-lags-segs.fits

| lag_freq(1).norm     | 5.555514e+00 | +9.444449e+01 | -5.326682e+00 |
| lag_freq(1).log_mass | 5.838944e+00 | +3.848508e-01 | -2.159029e-01 |
| lag_freq(1).h2       | 1.933330e+01 | +6.667048e-01 | -1.633330e+01 |
| lag_freq(1).Gamma1   | 2.131928e+00 | +2.864319e-01 | -1.319285e-01 |
| lag_freq(1).Gamma2   | 1.700003e+00 | +7.999968e-01 | -3.238712e-06 |
| lag_freq(1).xi       | 1.168316e-02 | +2.988317e+00 | -1.168316e-02 |
| lag_freq(1).b        | 1.871212e+00 | +4.792144e-01 | -8.712120e-01 |
| lag_freq(1).t_max    | 7.000754e+02 | +4.981918e+01 | -2.972558e+02 |
| lag_freq(1).t_shift  | 4.372266e+01 | +5.627734e+01 | -3.372266e+01 |

#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 5.555514e+00 | +9.444449e+01 | -5.326682e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 5.838944e+00 | +3.848508e-01 | -2.159029e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 1.933330e+01 | +6.667048e-01 | -1.633330e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 2.131928e+00 | +2.864319e-01 | -1.319285e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 1.700003e+00 | +7.999968e-01 | -3.238712e-06 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 1.168316e-02 | +2.988317e+00 | -1.168316e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 1.871212e+00 | +4.792144e-01 | -8.712120e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 7.000754e+02 | +4.981918e+01 | -2.972558e+02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 4.372266e+01 | +5.627734e+01 | -3.372266e+01 |
+----------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_tm_0110890201.gif

** OBS ----||---- ISIS EMCEE

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495=

Define Priors

#+BEGIN_EXAMPLE


#+BEGIN_EXAMPLE
isis
.source("emcee_0110890201.sl");




#+END_EXAMPLE

*Walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_011089020_tm_walkers-1.png


*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_tm_mass_accept_rate-1.png


Obtain the Norm pobability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_tm_norm_prob-1.png


Obtain the Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_tm_mass_prob-1.png

*Contours: paths in 2D*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_tm_chain_hist2d-1.png

*Chain statistics*


#+BEGIN_EXAMPLE
isis> s=600; % start at this iteration step
isis> min(min_statistic[[s:]]);
1.700123241297263
isis> nmax;
105

#+END_EXAMPLE


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_tm_statistics-1.png


Error analysis

conf90

#+BEGIN_EXAMPLE



#+END_EXAMPLE

#+CAPTION: The 90% confidence probability for 1H0707-495 Mass value where $\mu =\pm0.0$ (solid blue line) with the error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_tm_logmass_conf90-1.png

** OBS 0148010301 ECM best fit

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/fit-table-model-0148010301.sl=

#+BEGIN_EXAMPLE
isis

.source("fit-table-model-0148010301.sl");

t_g = 1.583162e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.9190242
isis> list_par;
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0          2.92896           0         200
  2  lag_freq(1).log_mass   0     0          6.50694         5.5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0               16           3          20
  7  lag_freq(1).Gamma1     0     0         2.700606           2           3
  8  lag_freq(1).Gamma2     0     0         1.700001         1.7         2.5
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         2.489637           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0                3           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         349.9999         100         800
 15  lag_freq(1).t_shift    0     0          18.4713          10         100

Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  1.1840e-02     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-OBS-0148010301-time-lags-segs.fits

| lag_freq(1).norm     | 2.928960e+00 | +2.643658e+00 | -2.693544e+00 |
| lag_freq(1).log_mass | 6.506940e+00 | +5.030679e-02 | -1.367509e-02 |
| lag_freq(1).h2       | 1.600000e+01 | +4.000005e+00 | -1.116846e+01 |
| lag_freq(1).Gamma1   | 2.700606e+00 | +2.993938e-01 | -5.254546e-01 |
| lag_freq(1).Gamma2   | 1.700001e+00 | +7.999986e-01 | -1.371690e-06 |
| lag_freq(1).xi       | 2.489637e+00 | +5.103634e-01 | -2.489637e+00 |
| lag_freq(1).b        | 3.000000e+00 | +5.688320e-08 | -4.768562e-01 |
| lag_freq(1).t_max    | 3.499999e+02 | +3.449332e+02 | -2.165503e+02 |
| lag_freq(1).t_shift  | 1.847130e+01 | +1.619214e+01 | -8.471302e+00 |

#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 2.928960e+00 | +2.643658e+00 | -2.693544e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.506940e+00 | +5.030679e-02 | -1.367509e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 1.600000e+01 | +4.000005e+00 | -1.116846e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 2.700606e+00 | +2.993938e-01 | -5.254546e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 1.700001e+00 | +7.999986e-01 | -1.371690e-06 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 2.489637e+00 | +5.103634e-01 | -2.489637e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 3.000000e+00 | +5.688320e-08 | -4.768562e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 3.499999e+02 | +3.449332e+02 | -2.165503e+02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 1.847130e+01 | +1.619214e+01 | -8.471302e+00 |
+----------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_tm_0148010301.gif

** OBS ----||---- ISIS EMCEE

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495=

Define Priors

#+BEGIN_EXAMPLE


#+BEGIN_EXAMPLE
isis
.source("emcee_0110890201.sl");




#+END_EXAMPLE

*Walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_011089020_tm_walkers-1.png


*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_tm_mass_accept_rate-1.png


Obtain the Norm pobability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_tm_norm_prob-1.png


Obtain the Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_tm_mass_prob-1.png

*Contours: paths in 2D*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_tm_chain_hist2d-1.png

*Chain statistics*


#+BEGIN_EXAMPLE
isis> s=600; % start at this iteration step
isis> min(min_statistic[[s:]]);
1.700123241297263
isis> nmax;
105

#+END_EXAMPLE


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_tm_statistics-1.png


Error analysis

conf90

#+BEGIN_EXAMPLE



#+END_EXAMPLE

#+CAPTION: The 90% confidence probability for 1H0707-495 Mass value where $\mu =\pm0.0$ (solid blue line) with the error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_tm_logmass_conf90-1.png

** OBS 0506200201 ECM best fit

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/fit-table-model-0148010301.sl=

#+BEGIN_EXAMPLE
isis

.source("fit-table-model-0506200201.sl");

t_g = 1.708311e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.1206652
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         1.275074           0         100
  2  lag_freq(1).log_mass   0     0         6.539981         5.5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         3.579383           3          20
  7  lag_freq(1).Gamma1     0     0         2.526613           2           3
  8  lag_freq(1).Gamma2     0     0         1.700001         1.7         2.5
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         2.625148           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         1.949025           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         415.7962         100         800
 15  lag_freq(1).t_shift    0     0         50.00001          10         100
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -4.3213e-02     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-OBS-0506200201-time-lags-segs.fits


| lag_freq(1).norm     | 1.275074e+00 | +2.994479e+01 | -8.653421e-01 |
| lag_freq(1).log_mass | 6.539981e+00 | +1.010505e-01 | -5.385683e-01 |
| lag_freq(1).h2       | 3.579383e+00 | +7.670545e+00 | -5.793830e-01 |
| lag_freq(1).Gamma1   | 2.526613e+00 | +4.733868e-01 | -4.890869e-01 |
| lag_freq(1).Gamma2   | 1.700001e+00 | +7.999991e-01 | -8.800920e-07 |
| lag_freq(1).xi       | 2.625148e+00 | +3.748523e-01 | -2.625148e+00 |
| lag_freq(1).b        | 1.949025e+00 | +1.050975e+00 | -9.490254e-01 |
| lag_freq(1).t_max    | 4.157962e+02 | +2.804206e+02 | -3.157962e+02 |
| lag_freq(1).t_shift  | 5.000001e+01 | +3.514692e+01 | -1.427398e+01 |


#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 1.275074e+00 | +2.994479e+01 | -8.653421e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.539981e+00 | +1.010505e-01 | -5.385683e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 3.579383e+00 | +7.670545e+00 | -5.793830e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 2.526613e+00 | +4.733868e-01 | -4.890869e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 1.700001e+00 | +7.999991e-01 | -8.800920e-07 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 2.625148e+00 | +3.748523e-01 | -2.625148e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 1.949025e+00 | +1.050975e+00 | -9.490254e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 4.157962e+02 | +2.804206e+02 | -3.157962e+02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 5.000001e+01 | +3.514692e+01 | -1.427398e+01 |
+----------------------+--------------+---------------+---------------+


#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_tm_0506200201.gif

** OBS ----||---- ISIS EMCEE

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495=

Define Priors

#+BEGIN_EXAMPLE


#+BEGIN_EXAMPLE
isis
.source("emcee_0506200201.sl");




#+END_EXAMPLE

*Walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_tm_walkers-1.png


*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_tm_mass_accept_rate-1.png


Obtain the Norm pobability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_tm_norm_prob-1.png


Obtain the Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_tm_mass_prob-1.png

*Contours: paths in 2D*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_tm_chain_hist2d-1.png

*Chain statistics*


#+BEGIN_EXAMPLE
isis> s=600; % start at this iteration step
isis> min(min_statistic[[s:]]);
1.700123241297263
isis> nmax;
105

#+END_EXAMPLE


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_tm_statistics-1.png


Error analysis

conf90

#+BEGIN_EXAMPLE



#+END_EXAMPLE

#+CAPTION: The 90% confidence probability for 1H0707-495 Mass value where $\mu =\pm0.0$ (solid blue line) with the error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_tm_logmass_conf90-1.png

** OBS 0506200301 ECM best fit

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/=

#+BEGIN_EXAMPLE
isis

.source("fit-table-model-0506200301.sl");

t_g = 6.983437e+00
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.0008394782
isis> list_par;
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         2.550075           0         100
  2  lag_freq(1).log_mass   0     0         6.151483         5.5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         18.18005           3          20
  7  lag_freq(1).Gamma1     0     0         2.372397           2         3.3
  8  lag_freq(1).Gamma2     0     0         1.724731         1.7         2.6
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0       0.01409985           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.759548           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         518.4562         100         800
 15  lag_freq(1).t_shift    0     0         34.11047          10         100
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  1.4520e-02     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-OBS-0506200301-time-lags-segs.fits

| lag_freq(1).norm     | 2.550075e+00 | +9.533594e-01 | -9.533462e-01 |
| lag_freq(1).log_mass | 6.151483e+00 | +7.280885e-03 | -7.049386e-03 |
| lag_freq(1).h2       | 1.818005e+01 | +1.807874e+00 | -5.607077e-01 |
| lag_freq(1).Gamma1   | 2.372397e+00 | +7.351510e-02 | -7.324983e-02 |
| lag_freq(1).Gamma2   | 1.724731e+00 | +9.494341e-02 | -2.473100e-02 |
| lag_freq(1).xi       | 1.409985e-02 | +2.985900e+00 | -1.409985e-02 |
| lag_freq(1).b        | 2.759548e+00 | +8.922907e-02 | -8.921651e-02 |
| lag_freq(1).t_max    | 5.184562e+02 | +2.268509e+01 | -2.857195e+01 |
| lag_freq(1).t_shift  | 3.411047e+01 | +6.971244e-01 | -6.978263e-01 |

#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 2.550075e+00 | +9.533594e-01 | -9.533462e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.151483e+00 | +7.280885e-03 | -7.049386e-03 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 1.818005e+01 | +1.807874e+00 | -5.607077e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 2.372397e+00 | +7.351510e-02 | -7.324983e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 1.724731e+00 | +9.494341e-02 | -2.473100e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 1.409985e-02 | +2.985900e+00 | -1.409985e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 2.759548e+00 | +8.922907e-02 | -8.921651e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 5.184562e+02 | +2.268509e+01 | -2.857195e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 3.411047e+01 | +6.971244e-01 | -6.978263e-01 |
+----------------------+--------------+---------------+---------------+



#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_tm_0506200301.gif

** OBS ----||---- ISIS EMCEE

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495=

Define Priors

#+BEGIN_EXAMPLE


#+BEGIN_EXAMPLE
isis
.source("emcee_0506200201.sl");




#+END_EXAMPLE

*Walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_tm_walkers-1.png


*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_tm_mass_accept_rate-1.png


Obtain the Norm pobability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_tm_norm_prob-1.png


Obtain the Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_tm_mass_prob-1.png

*Contours: paths in 2D*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_tm_chain_hist2d-1.png

*Chain statistics*


#+BEGIN_EXAMPLE
isis> s=600; % start at this iteration step
isis> min(min_statistic[[s:]]);
1.700123241297263
isis> nmax;
105

#+END_EXAMPLE


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_tm_statistics-1.png


Error analysis

conf90

#+BEGIN_EXAMPLE



#+END_EXAMPLE

#+CAPTION: The 90% confidence probability for 1H0707-495 Mass value where $\mu =\pm0.0$ (solid blue line) with the error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_tm_logmass_conf90-1.png

** OBS 0506200401 ECM best fit

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/=

#+BEGIN_EXAMPLE
isis

.source("fit-table-model-0506200401.sl");

 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.8050358
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         3.751743           0         100
  2  lag_freq(1).log_mass   0     0         6.492614         5.5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         13.58616           3          20
  7  lag_freq(1).Gamma1     0     0         2.795972           2           3
  8  lag_freq(1).Gamma2     0     0         1.700001         1.7         2.5
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0       0.02779976           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.871148           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         440.2774         100         800
 15  lag_freq(1).t_shift    0     0         20.50875          10         100
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  6.6524e-02     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-OBS-0506200401-time-lags-segs.fits
1

| lag_freq(1).norm     | 3.751743e+00 | +1.183643e+00 | -1.185960e+00 |
| lag_freq(1).log_mass | 6.492614e+00 | +1.471749e-02 | -1.879086e-02 |
| lag_freq(1).h2       | 1.358616e+01 | +2.372914e-01 | -2.373953e-01 |
| lag_freq(1).Gamma1   | 2.795972e+00 | +1.247326e-01 | -2.233161e-02 |
| lag_freq(1).Gamma2   | 1.700001e+00 | +2.351429e-02 | -1.000000e-06 |
| lag_freq(1).xi       | 2.779976e-02 | +2.121890e+00 | -2.779976e-02 |
| lag_freq(1).b        | 2.871148e+00 | +1.288520e-01 | -1.500174e-01 |
| lag_freq(1).t_max    | 4.402774e+02 | +4.829676e+01 | -3.600198e+01 |
| lag_freq(1).t_shift  | 2.050875e+01 | +6.675601e-01 | -1.099409e+00 |

#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 3.751743e+00 | +1.183643e+00 | -1.185960e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.492614e+00 | +1.471749e-02 | -1.879086e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 1.358616e+01 | +2.372914e-01 | -2.373953e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 2.795972e+00 | +1.247326e-01 | -2.233161e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 1.700001e+00 | +2.351429e-02 | -1.000000e-06 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 2.779976e-02 | +2.121890e+00 | -2.779976e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 2.871148e+00 | +1.288520e-01 | -1.500174e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 4.402774e+02 | +4.829676e+01 | -3.600198e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 2.050875e+01 | +6.675601e-01 | -1.099409e+00 |
+----------------------+--------------+---------------+---------------+



#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_tm_0506200401.gif

** OBS ----||---- ISIS EMCEE

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495=

Define Priors

#+BEGIN_EXAMPLE


#+BEGIN_EXAMPLE
isis
.source("emcee_0506200401.sl");




#+END_EXAMPLE

*Walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_tm_walkers-1.png


*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_tm_mass_accept_rate-1.png


Obtain the Norm pobability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_tm_norm_prob-1.png


Obtain the Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_tm_mass_prob-1.png

*Contours: paths in 2D*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_tm_chain_hist2d-1.png

*Chain statistics*


#+BEGIN_EXAMPLE
isis> s=600; % start at this iteration step
isis> min(min_statistic[[s:]]);
1.700123241297263
isis> nmax;
105

#+END_EXAMPLE


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_tm_statistics-1.png


Error analysis

conf90

#+BEGIN_EXAMPLE



#+END_EXAMPLE

#+CAPTION: The 90% confidence probability for 1H0707-495 Mass value where $\mu =\pm0.0$ (solid blue line) with the error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0506200201_tm_logmass_conf90-1.png

** OBS 0506200501 ECM best fit

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/=

#+BEGIN_EXAMPLE
isis

.source("fit-table-model-0506200501.sl");

t_g = 1.295243e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 2.75151
isis> list_par;
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         2.302633           0         100
  2  lag_freq(1).log_mass   0     0         6.419765         5.5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         17.45405           3          20
  7  lag_freq(1).Gamma1     0     0          2.83615           2         3.3
  8  lag_freq(1).Gamma2     0     0              1.7         1.7         2.5
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0        0.7031193           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.633465           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         433.9872         100         800
 15  lag_freq(1).t_shift    0     0         21.10886          10         100
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  5.6388e-03     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-OBS-0506200501-time-lags-segs.fits

| lag_freq(1).norm     | 2.302633e+00 | +5.579762e-01 | -4.308147e-01 |
| lag_freq(1).log_mass | 6.419765e+00 | +2.384905e-02 | -2.944138e-02 |
| lag_freq(1).h2       | 1.745405e+01 | +2.545946e+00 | -7.288726e-01 |
| lag_freq(1).Gamma1   | 2.836150e+00 | +1.217825e-01 | -1.168382e-01 |
| lag_freq(1).Gamma2   | 1.700000e+00 | +1.311643e-01 | -2.220446e-16 |
| lag_freq(1).xi       | 7.031193e-01 | +2.296881e+00 | -7.031193e-01 |
| lag_freq(1).b        | 2.633465e+00 | +2.089449e-01 | -1.999511e-01 |
| lag_freq(1).t_max    | 4.339872e+02 | +3.640835e+01 | -1.049420e+02 |
| lag_freq(1).t_shift  | 2.110886e+01 | +1.381099e+00 | -2.130965e+00 |


#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 2.302633e+00 | +5.579762e-01 | -4.308147e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.419765e+00 | +2.384905e-02 | -2.944138e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 1.745405e+01 | +2.545946e+00 | -7.288726e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 2.836150e+00 | +1.217825e-01 | -1.168382e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 1.700000e+00 | +1.311643e-01 | -2.220446e-16 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 7.031193e-01 | +2.296881e+00 | -7.031193e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 2.633465e+00 | +2.089449e-01 | -1.999511e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 4.339872e+02 | +3.640835e+01 | -1.049420e+02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 2.110886e+01 | +1.381099e+00 | -2.130965e+00 |
+----------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_tm_0506200501.gif

** OBS 0511580101 ECM best fit

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/=

#+BEGIN_EXAMPLE
isis

.source("fit-table-model-0511580101.sl");

t_g = 1.490832e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.8103931
isis> list_par;
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0        0.3746649           0         100
  2  lag_freq(1).log_mass   0     0         6.480843         5.5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         4.068497           3          20
  7  lag_freq(1).Gamma1     0     0         2.985556           2           3
  8  lag_freq(1).Gamma2     0     0         2.699998         1.7         2.7
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         2.918008           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0                3           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         399.9997         100         800
 15  lag_freq(1).t_shift    0     0              120          10         120
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -1.4448e-02     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-OBS-0511580101-time-lags-segs.fits

| lag_freq(1).norm     | 3.746649e-01 | +4.996917e+00 | -1.889396e-01 |
| lag_freq(1).log_mass | 6.480843e+00 | +7.356581e-02 | -6.938561e-02 |
| lag_freq(1).h2       | 4.068497e+00 | +1.500938e+00 | -1.068497e+00 |
| lag_freq(1).Gamma1   | 2.985556e+00 | +1.444420e-02 | -3.592579e-01 |
| lag_freq(1).Gamma2   | 2.699998e+00 | +1.632278e-06 | -9.999984e-01 |
| lag_freq(1).xi       | 2.918008e+00 | +8.199244e-02 | -6.097285e-01 |
| lag_freq(1).b        | 3.000000e+00 | +2.113106e-07 | -1.629458e+00 |
| lag_freq(1).t_max    | 3.999997e+02 | +9.957019e+01 | -2.498879e+02 |
| lag_freq(1).t_shift  | 1.200000e+02 | +1.611510e-06 | -1.173684e+01 |


#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 3.746649e-01 | +4.996917e+00 | -1.889396e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.480843e+00 | +7.356581e-02 | -6.938561e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 4.068497e+00 | +1.500938e+00 | -1.068497e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 2.985556e+00 | +1.444420e-02 | -3.592579e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 2.699998e+00 | +1.632278e-06 | -9.999984e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 2.918008e+00 | +8.199244e-02 | -6.097285e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 3.000000e+00 | +2.113106e-07 | -1.629458e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 3.999997e+02 | +9.957019e+01 | -2.498879e+02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 1.200000e+02 | +1.611510e-06 | -1.173684e+01 |
+----------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_tm_0511580101.gif

** OBS 0511580201 ECM best fit

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/=

#+BEGIN_EXAMPLE
isis

.source("fit-table-model-0511580201.sl");

t_g = 5.242630e+00
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.3784366
isis> list_par;
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0        0.8492469           0         100
  2  lag_freq(1).log_mass   0     0         6.026963         5.5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         4.137254           3          20
  7  lag_freq(1).Gamma1     0     0         2.847234           2           3
  8  lag_freq(1).Gamma2     0     0         1.700001         1.7         2.5
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0       0.01103024           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         1.000001           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         489.1218         100         800
 15  lag_freq(1).t_shift    0     0              110          10         120
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  1.0693e-02     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-OBS-0511580201-time-lags-segs.fits

isis> save_par("tm_0511580201.par");

| lag_freq(1).norm     | 8.492469e-01 | +9.915075e+01 | -4.124690e-01 |
| lag_freq(1).log_mass | 6.026963e+00 | +2.594634e-01 | -6.750777e-02 |
| lag_freq(1).h2       | 4.137254e+00 | +1.586275e+01 | -1.137254e+00 |
| lag_freq(1).Gamma1   | 2.847234e+00 | +1.527664e-01 | -6.446485e-01 |
| lag_freq(1).Gamma2   | 1.700001e+00 | +7.999988e-01 | -1.186275e-06 |
| lag_freq(1).xi       | 1.103024e-02 | +1.143079e+00 | -1.103024e-02 |
| lag_freq(1).b        | 1.000001e+00 | +1.288520e+00 | -6.152944e-07 |
| lag_freq(1).t_max    | 4.891218e+02 | +4.603853e+01 | -2.857859e+02 |
| lag_freq(1).t_shift  | 1.100000e+02 | +1.000000e+01 | -4.995302e+01 |

#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 8.492469e-01 | +9.915075e+01 | -4.124690e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.026963e+00 | +2.594634e-01 | -6.750777e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 4.137254e+00 | +1.586275e+01 | -1.137254e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 2.847234e+00 | +1.527664e-01 | -6.446485e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 1.700001e+00 | +7.999988e-01 | -1.186275e-06 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 1.103024e-02 | +1.143079e+00 | -1.103024e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 1.000001e+00 | +1.288520e+00 | -6.152944e-07 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 4.891218e+02 | +4.603853e+01 | -2.857859e+02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 1.100000e+02 | +1.000000e+01 | -4.995302e+01 |
+----------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_tm_0511580201.gif

** OBS 0511580301 ECM best fit

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/=

#+BEGIN_EXAMPLE
isis

.source("fit-table-model-0511580301.sl");

t_g = 1.390512e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.0005190371
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         9.985188           0         100
  2  lag_freq(1).log_mass   0     0         6.450589         5.5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         16.49928           3          20
  7  lag_freq(1).Gamma1     0     0          2.58959           2         3.3
  8  lag_freq(1).Gamma2     0     0          1.73481         1.7         2.5
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0     0.0007196742           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.373329           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0           222.61         100         800
 15  lag_freq(1).t_shift    0     0         21.20217          10         120
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  4.3848e-02     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-OBS-0511580301-time-lags-segs.fits

| lag_freq(1).norm     | 9.985188e+00 | +9.001481e+01 | -5.667958e+00 |
| lag_freq(1).log_mass | 6.450589e+00 | +6.399102e-02 | -1.088450e-01 |
| lag_freq(1).h2       | 1.649928e+01 | +3.500721e+00 | -5.520004e+00 |
| lag_freq(1).Gamma1   | 2.589590e+00 | +6.172485e-10 | -7.005235e-02 |
| lag_freq(1).Gamma2   | 1.734810e+00 | +1.395746e-01 | -3.481002e-02 |
| lag_freq(1).xi       | 7.196742e-04 | +2.999280e+00 | -7.196742e-04 |
| lag_freq(1).b        | 2.373329e+00 | +2.350578e-01 | -3.848761e-01 |
| lag_freq(1).t_max    | 2.226100e+02 | +2.069530e+00 | -2.336712e+01 |
| lag_freq(1).t_shift  | 2.120217e+01 | +1.443525e-01 | -2.091263e+00 |

conf_0511580301.csv (END)

#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 9.985188e+00 | +9.001481e+01 | -5.667958e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.450589e+00 | +6.399102e-02 | -1.088450e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 1.649928e+01 | +3.500721e+00 | -5.520004e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 2.589590e+00 | +6.172485e-10 | -7.005235e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 1.734810e+00 | +1.395746e-01 | -3.481002e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 7.196742e-04 | +2.999280e+00 | -7.196742e-04 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 2.373329e+00 | +2.350578e-01 | -3.848761e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 2.226100e+02 | +2.069530e+00 | -2.336712e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 2.120217e+01 | +1.443525e-01 | -2.091263e+00 |
+----------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_tm_0511580301.gif

** OBS 0511580401 ECM bestfit

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/=

#+BEGIN_EXAMPLE
isis

.source("fit-table-model-0511580401.sl");

t_g = 2.096239e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 1.180767
isis> list_par;
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         2.921168           0         100
  2  lag_freq(1).log_mass   0     0         6.628855         5.5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         19.97723           3          20
  7  lag_freq(1).Gamma1     0     0         2.299331           2           3
  8  lag_freq(1).Gamma2     0     0         1.700005         1.7         2.5
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         2.990768           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.168022           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0              100         100         800
 15  lag_freq(1).t_shift    0     0         25.21477          10         120
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  4.7228e-03     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-OBS-0511580401-time-lags-segs.fits

| lag_freq(1).norm     | 2.921168e+00 | +2.902928e+00 | -1.657973e+00 |
| lag_freq(1).log_mass | 6.628855e+00 | +4.155252e-02 | -9.542623e-01 |
| lag_freq(1).h2       | 1.997723e+01 | +2.277480e-02 | -1.719596e+00 |
| lag_freq(1).Gamma1   | 2.299331e+00 | +7.006689e-01 | -1.959352e-01 |
| lag_freq(1).Gamma2   | 1.700005e+00 | +7.862319e-01 | -5.218373e-06 |
| lag_freq(1).xi       | 2.990768e+00 | +9.232162e-03 | -1.614239e+00 |
| lag_freq(1).b        | 2.168022e+00 | +5.233955e-01 | -4.368052e-01 |
| lag_freq(1).t_max    | 1.000000e+02 | +4.303491e+01 | -2.497029e-05 |
| lag_freq(1).t_shift  | 2.521477e+01 | +1.388605e+00 | -3.515290e+00 |


#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 2.921168e+00 | +2.902928e+00 | -1.657973e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.628855e+00 | +4.155252e-02 | -9.542623e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 1.997723e+01 | +2.277480e-02 | -1.719596e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 2.299331e+00 | +7.006689e-01 | -1.959352e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 1.700005e+00 | +7.862319e-01 | -5.218373e-06 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 2.990768e+00 | +9.232162e-03 | -1.614239e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 2.168022e+00 | +5.233955e-01 | -4.368052e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 1.000000e+02 | +4.303491e+01 | -2.497029e-05 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 2.521477e+01 | +1.388605e+00 | -3.515290e+00 |
+----------------------+--------------+---------------+---------------+


#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_tm_0511580401.gif

** OBS 0554710801 ECM best fit

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/=

#+BEGIN_EXAMPLE
isis

.source("fit-table-model-0554710801.sl");

t_g = 1.953559e+00
 Parameters[Variable] = 15[9]
            Data bins = 14
           Chi-square = 3.128667
   Reduced chi-square = 0.6257334
isis> list_par;
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         97.47113           0         100
  2  lag_freq(1).log_mass   0     0         5.598241         5.5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         6.775296           3          20
  7  lag_freq(1).Gamma1     0     0          2.42759           2         3.3
  8  lag_freq(1).Gamma2     0     0         2.045096         1.7           3
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         0.252692           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.766745           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         529.3124         100         800
 15  lag_freq(1).t_shift    0     0         27.40806          10         120


t_g = 1.974016e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.0001363509
isis> list_par;
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         7.452869           0         100
  2  lag_freq(1).log_mass   0     0         6.602765         5.5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0          19.6477           3          20
  7  lag_freq(1).Gamma1     0     0         2.897148           2         3.3
  8  lag_freq(1).Gamma2     0     0         2.452186         1.7           3
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         1.933627           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.999999           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         268.3689         100         800
 15  lag_freq(1).t_shift    0     0         25.75997          10         120
isis>  list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  6.1299e-02     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-OBS-0554710801-time-lags.fits


| lag_freq(1).norm     | 7.452869e+00 | +1.260301e+01 | -6.430387e+00 |
| lag_freq(1).log_mass | 6.602765e+00 | +4.129960e-02 | -8.914224e-04 |
| lag_freq(1).h2       | 1.964770e+01 | +3.523007e-01 | -9.644842e+00 |
| lag_freq(1).Gamma1   | 2.897148e+00 | +4.028518e-01 | -2.226926e-01 |
| lag_freq(1).Gamma2   | 2.452186e+00 | +1.938381e-02 | -3.188228e-04 |
| lag_freq(1).xi       | 1.933627e+00 | +1.066373e+00 | -1.933627e+00 |
| lag_freq(1).b        | 2.999999e+00 | +5.049455e-07 | -7.303933e-01 |
| lag_freq(1).t_max    | 2.683689e+02 | +2.013448e-07 | -5.467716e-01 |
| lag_freq(1).t_shift  | 2.575997e+01 | +1.911215e-02 | -1.968040e-02 |


#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 7.452869e+00 | +1.260301e+01 | -6.430387e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.602765e+00 | +4.129960e-02 | -8.914224e-04 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 1.964770e+01 | +3.523007e-01 | -9.644842e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 2.897148e+00 | +4.028518e-01 | -2.226926e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 2.452186e+00 | +1.938381e-02 | -3.188228e-04 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 1.933627e+00 | +1.066373e+00 | -1.933627e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 2.999999e+00 | +5.049455e-07 | -7.303933e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 2.683689e+02 | +2.013448e-07 | -5.467716e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 2.575997e+01 | +1.911215e-02 | -1.968040e-02 |
+----------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_tm_0554710801.gif

** OBS 0653510301 ECM best fit

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/=

#+BEGIN_EXAMPLE
isis

.source("fit-table-model-0653510301.sl");

t_g = 4.261982e+00
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.001318519
isis> list_par;
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         93.49027           0         100
  2  lag_freq(1).log_mass   0     0         5.937026         5.5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0           16.999           3          20
  7  lag_freq(1).Gamma1     0     0         2.596537           2         3.3
  8  lag_freq(1).Gamma2     0     0          2.10285         1.7           3
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0     2.127049e-08           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.997818           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0          649.485         100         800
 15  lag_freq(1).t_shift    0     0         29.16406          10         120

| lag_freq(1).norm     | 9.349027e+01 | +6.509733e+00 | -9.241332e+01 |
| lag_freq(1).log_mass | 5.937026e+00 | +2.484672e-08 | -2.054620e-01 |
| lag_freq(1).h2       | 1.699900e+01 | +3.001001e+00 | -3.221571e-01 |
| lag_freq(1).Gamma1   | 2.596537e+00 | +7.034626e-01 | -5.344737e-01 |
| lag_freq(1).Gamma2   | 2.102850e+00 | +2.335658e-02 | -4.028502e-01 |
| lag_freq(1).xi       | 2.127049e-08 | +3.000000e+00 | -2.127049e-08 |
| lag_freq(1).b        | 2.997818e+00 | +2.182357e-03 | -3.236377e-01 |
| lag_freq(1).t_max    | 6.494850e+02 | +9.996601e+01 | -1.308315e+02 |
| lag_freq(1).t_shift  | 2.916406e+01 | +7.115429e+00 | -9.206691e+00 |

#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 9.349027e+01 | +6.509733e+00 | -9.241332e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 5.937026e+00 | +2.484672e-08 | -2.054620e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 1.699900e+01 | +3.001001e+00 | -3.221571e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 2.596537e+00 | +7.034626e-01 | -5.344737e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 2.102850e+00 | +2.335658e-02 | -4.028502e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 2.127049e-08 | +3.000000e+00 | -2.127049e-08 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 2.997818e+00 | +2.182357e-03 | -3.236377e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 6.494850e+02 | +9.996601e+01 | -1.308315e+02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 2.916406e+01 | +7.115429e+00 | -9.206691e+00 |
+----------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_tm_0653510301.gif

** OBS 0653510401 ECM best fit

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/=

#+BEGIN_EXAMPLE
isis

.source("fit-table-model-0653510401.sl");

t_g = 1.761136e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.0002331559
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         10.94936           0         100
  2  lag_freq(1).log_mass   0     0         6.553207         5.5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         13.30648           3          20
  7  lag_freq(1).Gamma1     0     0         2.877282           2         3.3
  8  lag_freq(1).Gamma2     0     0         2.258596         1.7           3
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0        0.0354467           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.999995           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         182.1683         100         800
 15  lag_freq(1).t_shift    0     0         19.17693          10         120
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -2.6085e-02     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-OBS-0653510401-time-lags-segs.fits

| lag_freq(1).norm     | 1.094936e+01 | +8.329776e+00 | -6.527501e+00 |
| lag_freq(1).log_mass | 6.553207e+00 | +2.198657e-02 | -1.006403e-01 |
| lag_freq(1).h2       | 1.330648e+01 | +3.339214e+00 | -4.584817e-04 |
| lag_freq(1).Gamma1   | 2.877282e+00 | +1.765274e-02 | -8.163631e-05 |
| lag_freq(1).Gamma2   | 2.258596e+00 | +1.815788e-01 | -9.428911e-02 |
| lag_freq(1).xi       | 3.544670e-02 | +2.964553e+00 | -3.544670e-02 |
| lag_freq(1).b        | 2.999995e+00 | +5.039190e-06 | -4.794197e-02 |
| lag_freq(1).t_max    | 1.821683e+02 | +6.610519e-04 | -4.604487e-03 |
| lag_freq(1).t_shift  | 1.917693e+01 | +4.384295e+00 | -4.447998e-03 |


#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 1.094936e+01 | +8.329776e+00 | -6.527501e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.553207e+00 | +2.198657e-02 | -1.006403e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 1.330648e+01 | +3.339214e+00 | -4.584817e-04 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 2.877282e+00 | +1.765274e-02 | -8.163631e-05 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 2.258596e+00 | +1.815788e-01 | -9.428911e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 3.544670e-02 | +2.964553e+00 | -3.544670e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 2.999995e+00 | +5.039190e-06 | -4.794197e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 1.821683e+02 | +6.610519e-04 | -4.604487e-03 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 1.917693e+01 | +4.384295e+00 | -4.447998e-03 |
+----------------------+--------------+---------------+---------------+


#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_tm_0653510401.gif

** OBS 0653510501 ECM best fit

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/=

#+BEGIN_EXAMPLE
isis

.source("fit-table-model-0653510501.sl");

t_g = 2.514718e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.001023277
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         6.323382           0         100
  2  lag_freq(1).log_mass   0     0         6.707903         5.5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         17.30446           3          20
  7  lag_freq(1).Gamma1     0     0         2.819527           2         3.3
  8  lag_freq(1).Gamma2     0     0         1.853553         1.7           3
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0       0.03882407           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0          2.71491           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         105.3749         100         800
 15  lag_freq(1).t_shift    0     0         17.34834          10         120
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -1.3605e-02     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-OBS-0653510501-time-lags-segs.fits

| lag_freq(1).norm     | 6.323382e+00 | +9.367662e+01 | -4.243270e+00 |
| lag_freq(1).log_mass | 6.707903e+00 | +6.052429e-03 | -4.470220e-10 |
| lag_freq(1).h2       | 1.730446e+01 | +2.695540e+00 | -3.669803e+00 |
| lag_freq(1).Gamma1   | 2.819527e+00 | +3.499077e-01 | -1.820088e-01 |
| lag_freq(1).Gamma2   | 1.853553e+00 | +3.003230e-01 | -1.535528e-01 |
| lag_freq(1).xi       | 3.882407e-02 | +2.961176e+00 | -3.882407e-02 |
| lag_freq(1).b        | 2.714910e+00 | +2.009561e-01 | -3.410089e-02 |
| lag_freq(1).t_max    | 1.053749e+02 | +4.109144e+01 | -5.374922e+00 |
| lag_freq(1).t_shift  | 1.734834e+01 | +5.573883e-08 | -2.990696e-09 |


#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 6.323382e+00 | +9.367662e+01 | -4.243270e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.707903e+00 | +6.052429e-03 | -4.470220e-10 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 1.730446e+01 | +2.695540e+00 | -3.669803e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 2.819527e+00 | +3.499077e-01 | -1.820088e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 1.853553e+00 | +3.003230e-01 | -1.535528e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 3.882407e-02 | +2.961176e+00 | -3.882407e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 2.714910e+00 | +2.009561e-01 | -3.410089e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 1.053749e+02 | +4.109144e+01 | -5.374922e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 1.734834e+01 | +5.573883e-08 | -2.990696e-09 |
+----------------------+--------------+---------------+---------------+



#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_tm_0653510501.gif

** OBS 0653510601 ECM best fit

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/=

#+BEGIN_EXAMPLE
isis

.source("fit-table-model-0653510601.sl");

t_g = 1.490511e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.8400964
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         2.360015           0         100
  2  lag_freq(1).log_mass   0     0         6.480749         5.5           7
  3  lag_freq(1).i          0     1               53           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         3.315614           3          20
  7  lag_freq(1).Gamma1     0     0          2.94164           2         3.3
  8  lag_freq(1).Gamma2     0     0          1.82911         1.7           3
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         2.998333           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.999996           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         500.0004         100         800
 15  lag_freq(1).t_shift    0     0         10.00001          10         120
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  5.8671e-02     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-OBS-0653510601-time-lags-segs.fits

| lag_freq(1).norm     | 2.360015e+00 | +3.255013e+01 | -1.093631e+00 |
| lag_freq(1).log_mass | 6.480749e+00 | +2.011502e-02 | -1.080383e-01 |
| lag_freq(1).h2       | 3.315614e+00 | +1.452669e+01 | -3.156135e-01 |
| lag_freq(1).Gamma1   | 2.941640e+00 | +1.271003e-01 | -3.302151e-01 |
| lag_freq(1).Gamma2   | 1.829110e+00 | +3.807666e-01 | -1.291097e-01 |
| lag_freq(1).xi       | 2.998333e+00 | +1.667402e-03 | -9.892126e-01 |
| lag_freq(1).b        | 2.999996e+00 | +4.221615e-06 | -1.098420e+00 |
| lag_freq(1).t_max    | 5.000004e+02 | +1.292637e+02 | -2.310413e+02 |
| lag_freq(1).t_shift  | 1.000001e+01 | +4.317992e+00 | -7.670355e-06 |


#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 2.360015e+00 | +3.255013e+01 | -1.093631e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.480749e+00 | +2.011502e-02 | -1.080383e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 3.315614e+00 | +1.452669e+01 | -3.156135e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 2.941640e+00 | +1.271003e-01 | -3.302151e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 1.829110e+00 | +3.807666e-01 | -1.291097e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 2.998333e+00 | +1.667402e-03 | -9.892126e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 2.999996e+00 | +4.221615e-06 | -1.098420e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 5.000004e+02 | +1.292637e+02 | -2.310413e+02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 1.000001e+01 | +4.317992e+00 | -7.670355e-06 |
+----------------------+--------------+---------------+---------------+


#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_tm_0653510601.gif

* 1H0707-495 Table Model Results

PATH =
=/home/steff075/phd_ecm/results-for-all/1H0707-495_results_table_mod.ods=

You can download the csv file [[http://www.star.bris.ac.uk/steff/ecm/1H0707-495_results_table_mod.csv][here]]

|      Data |  tm_ECM_Chi2 |       tm_M_solar | tm_ECM_logM |        + |        - | tm_ECM_h2 |        + |        - | tm_ECM_Gama1 |        + |        - | tm_ECM_Gamma2 |        + |        - | tm_ECM_xi |        + |        - | tm_ECM_b |        + |        - |  tm_tmax |        + |        - | tm_tshift |        + |        - |
|   comined |    0.5037519 |  1284301.5301975 |    6.11E+00 | 1.01E-02 | 3.31E-02 |  3.49E+00 | 3.50E-01 | 3.55E-01 |     2.40E+00 | 8.65E-03 | 0.00E+00 |      1.94E+00 | 1.04E-02 | 1.04E-02 |  1.24E-02 | 1.09E-01 | 1.24E-02 | 3.00E+00 | 0.00E+00 | 4.05E-02 | 3.71E+02 | 1.31E+01 | 1.33E+01 |  1.71E+01 | 2.03E-01 | 2.01E-01 |
|   Hi-flux |   0.07241322 | 1629569.92192918 |    6.21E+00 | 2.05E-04 | 1.66E-01 |  1.00E+01 | 7.17E-01 | 7.04E+00 |     2.69E+00 | 1.06E-01 | 2.20E-01 |      1.93E+00 | 4.25E-01 | 3.11E-02 |  2.01E+00 | 9.93E-01 | 2.01E+00 | 3.00E+00 | 7.27E-04 | 1.27E-02 | 3.08E+02 | 1.84E+01 | 2.77E+01 |  5.91E+00 | 4.96E+00 | 2.49E+00 |
|    Hi-cts |  0.001306738 |  2361973.3870523 |    6.37E+00 | 6.26E-02 | 1.25E-01 |  1.51E+01 | 4.85E+00 | 5.13E-09 |     2.66E+00 | 1.40E-01 | 6.33E-02 |      1.90E+00 | 1.47E-01 | 1.67E-05 |  2.44E+00 | 5.58E-01 | 2.44E+00 | 2.51E+00 | 1.75E-01 | 1.34E-04 | 2.34E+02 | 4.48E-03 | 2.58E+00 |  2.10E+01 | 1.58E-04 | 7.83E-02 |
|  Med-flux |     1.114879 | 202601.193775269 |    5.31E+00 | 1.98E-01 | 3.39E-02 |  5.03E+00 | 1.50E+01 | 8.70E-01 |     2.57E+00 | 2.43E-01 | 5.20E-02 |      2.47E+00 | 1.37E-02 | 5.02E-01 |  4.54E-02 | 2.95E+00 | 4.54E-02 | 1.77E+00 | 1.23E+00 | 7.66E-01 | 6.67E+02 | 3.29E+01 | 5.67E+02 |  7.17E+01 | 8.52E+00 | 4.63E+01 |
|   Lo-flux |     1.574947 | 1606190.30438072 |    6.21E+00 | 2.60E-01 | 3.93E-01 |  3.00E+00 | 2.99E+00 | 1.13E-06 |     3.09E+00 | 8.80E-03 | 2.83E-02 |      1.90E+00 | 4.98E-01 | 7.79E-07 |  2.99E+00 | 5.35E-03 | 9.85E-01 | 1.94E+00 | 1.06E+00 | 9.37E-01 | 6.16E+02 | 3.43E+01 | 5.16E+02 |  6.00E+01 | 4.67E+01 | 2.37E+01 |
|    Lo-cts |    0.4601746 | 781226.560121504 |    5.89E+00 | 1.77E-01 | 1.07E-01 |  3.00E+00 | 1.70E+01 | 1.46E-06 |     2.41E+00 | 1.17E-01 | 8.25E-03 |      2.25E+00 | 1.86E-01 | 4.66E-02 |  2.17E-02 | 2.07E+00 | 2.17E-02 | 2.13E+00 | 8.75E-01 | 6.79E-01 | 6.17E+02 | 8.34E+01 | 1.01E+02 |  4.52E+01 | 1.33E+01 | 1.97E+00 |
| 110890201 |     1.741573 | 690150.806768775 |    5.84E+00 | 3.85E-01 | 2.16E-01 |  1.93E+01 | 6.67E-01 | 1.63E+01 |     2.13E+00 | 2.86E-01 | 1.32E-01 |      1.70E+00 | 8.00E-01 | 3.24E-06 |  1.17E-02 | 2.99E+00 | 1.17E-02 | 1.87E+00 | 4.79E-01 | 8.71E-01 | 7.00E+02 | 4.98E+01 | 2.97E+02 |  4.37E+01 | 5.63E+01 | 3.37E+01 |
| 148010301 |    0.9190242 | 3213216.58569719 |    6.51E+00 | 5.03E-02 | 1.37E-02 |  1.60E+01 | 4.00E+00 | 1.12E+01 |     2.70E+00 | 2.99E-01 | 5.25E-01 |      1.70E+00 | 8.00E-01 | 1.37E-06 |  2.49E+00 | 5.10E-01 | 2.49E+00 | 3.00E+00 | 5.69E-08 | 4.77E-01 | 3.50E+02 | 3.45E+02 | 2.17E+02 |  1.85E+01 | 1.62E+01 | 8.47E+00 |
| 506200201 |    0.1206652 | 3467216.81353394 |    6.54E+00 | 1.01E-01 | 5.39E-01 |  3.58E+00 | 7.67E+00 | 5.79E-01 |     2.53E+00 | 4.73E-01 | 4.89E-01 |      1.70E+00 | 8.00E-01 | 8.80E-07 |  2.63E+00 | 3.75E-01 | 2.63E+00 | 1.95E+00 | 1.05E+00 | 9.49E-01 | 4.16E+02 | 2.80E+02 | 3.16E+02 |  5.00E+01 | 3.51E+01 | 1.43E+01 |
| 506200301 | 0.0008394782 | 1417369.22893153 |    6.15E+00 | 7.28E-03 | 7.05E-03 |  1.82E+01 | 1.81E+00 | 5.61E-01 |     2.37E+00 | 7.35E-02 | 7.32E-02 |      1.72E+00 | 9.49E-02 | 2.47E-02 |  1.41E-02 | 2.99E+00 | 1.41E-02 | 2.76E+00 | 8.92E-02 | 8.92E-02 | 5.18E+02 | 2.27E+01 | 2.86E+01 |  3.41E+01 | 6.97E-01 | 6.98E-01 |
| 506200401 |    0.8050358 | 3108951.87903273 |    6.49E+00 | 1.47E-02 | 1.88E-02 |  1.36E+01 | 2.37E-01 | 2.37E-01 |     2.80E+00 | 1.25E-01 | 2.23E-02 |      1.70E+00 | 2.35E-02 | 1.00E-06 |  2.78E-02 | 2.12E+00 | 2.78E-02 | 2.87E+00 | 1.29E-01 | 1.50E-01 | 4.40E+02 | 4.83E+01 | 3.60E+01 |  2.05E+01 | 6.68E-01 | 1.10E+00 |
| 506200501 |      2.75151 |  2628845.1191645 |    6.42E+00 | 2.38E-02 | 2.94E-02 |  1.75E+01 | 2.55E+00 | 7.29E-01 |     2.84E+00 | 1.22E-01 | 1.17E-01 |      1.70E+00 | 1.31E-01 | 2.22E-16 |  7.03E-01 | 2.30E+00 | 7.03E-01 | 2.63E+00 | 2.09E-01 | 2.00E-01 | 4.34E+02 | 3.64E+01 | 1.05E+02 |  2.11E+01 | 1.38E+00 | 2.13E+00 |
| 511580101 |    0.8103931 | 3025819.37892505 |    6.48E+00 | 7.36E-02 | 6.94E-02 |  4.07E+00 | 1.50E+00 | 1.07E+00 |     2.99E+00 | 1.44E-02 | 3.59E-01 |      2.70E+00 | 1.63E-06 | 1.00E+00 |  2.92E+00 | 8.20E-02 | 6.10E-01 | 3.00E+00 | 2.11E-07 | 1.63E+00 | 4.00E+02 | 9.96E+01 | 2.50E+02 |  1.20E+02 | 1.61E-06 | 1.17E+01 |
| 511580201 |    0.3784366 | 1064052.36173167 |    6.03E+00 | 2.59E-01 | 6.75E-02 |  4.14E+00 | 1.59E+01 | 1.14E+00 |     2.85E+00 | 1.53E-01 | 6.45E-01 |      1.70E+00 | 8.00E-01 | 1.19E-06 |  1.10E-02 | 1.14E+00 | 1.10E-02 | 1.00E+00 | 1.29E+00 | 6.15E-07 | 4.89E+02 | 4.60E+01 | 2.86E+02 |  1.10E+02 | 1.00E+01 | 5.00E+01 |
| 511580301 |  0.000519037 | 2822207.87910112 |    6.45E+00 | 6.40E-02 | 1.09E-01 |  1.65E+01 | 3.50E+00 | 5.52E+00 |     2.59E+00 | 6.17E-10 | 7.01E-02 |      1.73E+00 | 1.40E-01 | 3.48E-02 |  7.20E-04 | 3.00E+00 | 7.20E-04 | 2.37E+00 | 2.35E-01 | 3.85E-01 | 2.23E+02 | 2.07E+00 | 2.34E+01 |  2.12E+01 | 1.44E-01 | 2.09E+00 |
| 511580401 |     1.180767 | 4254563.40250899 |    6.63E+00 | 4.16E-02 | 9.54E-01 |  2.00E+01 | 2.28E-02 | 1.72E+00 |     2.30E+00 | 7.01E-01 | 1.96E-01 |      1.70E+00 | 7.86E-01 | 5.22E-06 |  2.99E+00 | 9.23E-03 | 1.61E+00 | 2.17E+00 | 5.23E-01 | 4.37E-01 | 1.00E+02 | 4.30E+01 | 2.50E-05 |  2.52E+01 | 1.39E+00 | 3.52E+00 |
| 653510301 |  0.001318519 |  865019.70354391 |    5.94E+00 | 2.48E-08 | 2.05E-01 |  1.70E+01 | 3.00E+00 | 3.22E-01 |     2.60E+00 | 7.03E-01 | 5.34E-01 |      2.10E+00 | 2.34E-02 | 4.03E-01 |  2.13E-08 | 3.00E+00 | 2.13E-08 | 3.00E+00 | 2.18E-03 | 3.24E-01 | 6.49E+02 | 1.00E+02 | 1.31E+02 |  2.92E+01 | 7.12E+00 | 9.21E+00 |
| 653510401 | 0.0002331559 | 3574431.67521215 |    6.55E+00 | 2.20E-02 | 1.01E-01 |  1.33E+01 | 3.34E+00 | 4.58E-04 |     2.88E+00 | 1.77E-02 | 8.16E-05 |      2.26E+00 | 1.82E-01 | 9.43E-02 |  3.54E-02 | 2.96E+00 | 3.54E-02 | 3.00E+00 | 5.04E-06 | 4.79E-02 | 1.82E+02 | 6.61E-04 | 4.60E-03 |  1.92E+01 | 4.38E+00 | 4.45E-03 |
| 653510501 |  0.001023277 | 5103909.91031196 |    6.71E+00 | 6.05E-03 | 4.47E-10 |  1.73E+01 | 2.70E+00 | 3.67E+00 |     2.82E+00 | 3.50E-01 | 1.82E-01 |      1.85E+00 | 3.00E-01 | 1.54E-01 |  3.88E-02 | 2.96E+00 | 3.88E-02 | 2.71E+00 | 2.01E-01 | 3.41E-02 | 1.05E+02 | 4.11E+01 | 5.37E+00 |  1.73E+01 | 5.57E-08 | 2.99E-09 |
| 653510601 |    0.8400964 | 3025164.53237606 |    6.48E+00 | 2.01E-02 | 1.08E-01 |  3.32E+00 | 1.45E+01 | 3.16E-01 |     2.94E+00 | 1.27E-01 | 3.30E-01 |      1.83E+00 | 3.81E-01 | 1.29E-01 |  3.00E+00 | 1.67E-03 | 9.89E-01 | 3.00E+00 | 4.22E-06 | 1.10E+00 | 5.00E+02 | 1.29E+02 | 2.31E+02 |  1.00E+01 | 4.32E+00 | 7.67E-06 |
| 554710801 | 0.0001363509 | 4006498.64316923 |    6.60E+00 | 4.13E-02 | 8.91E-04 |  1.96E+01 | 3.52E-01 | 9.64E+00 |     2.90E+00 | 4.03E-01 | 2.23E-01 |      2.45E+00 | 1.94E-02 | 3.19E-04 |  1.93E+00 | 1.07E+00 | 1.93E+00 | 3.00E+00 | 5.05E-07 | 7.30E-01 | 2.68E+02 | 2.01E-07 | 5.47E-01 |  2.58E+01 | 1.91E-02 | 1.97E-02 |

** Table Model results V L(2-10keV)

PATH = =/home/steff075/phd_ecm/results-for-all/1H0707_Lum2-10_TM_ecm_freepars.vsz=

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707_Lum2-10_TM_ecm_freepars.png

** Table model Mass distribution in python emcee (1st results)

 PATH = =/home/steff075/phd_ecm/results-for-all/emcee=

script = =/home/steff075/phd_ecm/results-for-all/emcee/posterior_density.py=

#+BEGIN_EXAMPLE
import numpy as np
import matplotlib.pyplot as plt
from scipy import stats
plt.style.use('classic')
plt.rcParams['font.family'] = 'serif'
#Import data
#data = np.loadtxt('1H0707-495_Mass_combined.csv', delimiter=',', skiprows=1)
#data = np.loadtxt('/home/steff075/phd_ecm/results-for-all/1H0707-495_results_table_mod.csv', delimiter=',', skiprows=1)

# Define data
mass = np.array([5.84E+00,6.51E+00,6.54E+00,6.15E+00,6.49E+00,6.42E+00,6.48E+00,6.03E+00,6.45E+00,6.63E+00,5.94E+00,6.55E+00,6.71E+00,6.48E+00,6.60E+00])
mass_hi_err = np.array([3.85E-01,5.03E-02,1.01E-01,7.28E-03,1.47E-02,2.38E-02,7.36E-02,2.59E-01,6.40E-02,4.16E-02,2.48E-08,2.20E-02,6.05E-03,2.01E-02,4.13E-02])
mass_lo_err = np.array([2.16E-01,1.37E-02,5.39E-01,7.05E-03,1.88E-02,2.94E-02,6.94E-02,6.75E-02,1.09E-01,9.54E-01,2.05E-01,1.01E-01,4.47E-10,1.08E-01,8.91E-04])

mass_hi = (mass + mass_hi_err)
mass_lo = (mass - mass_lo_err)
#mass_err = [mass_lo, mass_hi]
#mass_err = np.reshape(mass_err, (15,2))

ndim = 15 # define number of dimensions of the data

cov = 0.5 - np.random.rand(ndim ** 2).reshape((ndim, ndim))
cov = np.triu(cov)
cov += cov.T - np.diag(cov.diagonal())
cov = np.dot(cov, cov)

nwalkers = 100

# Guess sarting point for each of the 100 walkers.
p0 = np.random.rand(nwalkers, ndim)

# Define function that returns the density p(x⃗ ) for specific values of x⃗ , μ⃗  and Σ−1. In fact, emcee actually requires the logarithm of p.

def log_prob(x, mu, cov):
    diff = x - mu
    return -0.5 * np.dot(diff, np.linalg.solve(cov, diff))

# Import EMCEE and define the Ensembler
import emcee

sampler = emcee.EnsembleSampler(nwalkers, ndim, log_prob, args=[mass, cov])

# Define the probability function (log_prob) for this data
log_prob(p0[0], mass, cov)

print("log_prob: {0:.3f}".format(log_prob(p0[0], mass, cov)))

# Setup some initial 'burn- in' steps for the MCMC chain to allow walkers to explore parameter space to settle into the maximum of the density
print("Running burn-in...")
state = sampler.run_mcmc(p0, 100) # Save the final position of the walkers after N steps as 'state'

sampler.reset() # Reset the sampler before running MCMC

# Run MCMC for N steps starting at the final 'burn-in' locations
print("Running MCMC chain...")
sampler.run_mcmc(state, 100000);

mass_mean = np.mean(mass)
mass_median = np.median(mass)
mass_sigma = np.std(mass)

print("Mean acceptance fraction: {0:.3f}".format(np.mean(sampler.acceptance_fraction)))
print("Mean autocorrelation time: {0:.3f}steps".format(np.mean(sampler.get_autocorr_time())))
print("Mass mean: {0:.3f}".format(np.mean(mass)))
print("Mass median: {0:.3f}".format(np.median(mass)))
print("Mass sigma: {0:.3f}".format(np.std(mass)))

# Obtain 68 and 95 confidence - Ref - https://stackoverflow.com/questions/50161140/how-to-plot-a-time-series-array-with-confidence-intervals-displayed-in-python
#The 68% confidence interval for the mean of N draws from a normal distribution with mean mu and std deviation sigma is
conf68 = stats.norm.interval(0.68, loc=mass_mean, scale=mass_sigma/np.sqrt(len(mass)))
conf95 = stats.norm.interval(0.95, loc=mass_mean, scale=mass_sigma/np.sqrt(len(mass)))

samples = sampler.get_chain(flat=True)
plt.hist(samples[:, 0], 100, color="k", histtype="step")
plt.axvline(mass_mean, lw =0.5, c="k") # Mean
plt.axvline(mass_mean - mass_sigma, lw =0.8, linestyle='dashed', c="grey") # sigma_lo
plt.axvline(mass_mean + mass_sigma, lw =0.8, linestyle='dashed', c="grey") # sigma_hi
plt.axvline(mass_median, lw =1.0, linestyle='dashed', c="red") # sigma_hi
plt.axvspan(mass_mean - mass_sigma, mass_mean + mass_sigma, alpha=0.2, color="b") # Fill sigma range
plt.xlim(1,10)
plt.xlabel(r"$M_{BH}~logM_{\odot}$", fontsize=16)
plt.ylabel(r"Posterior Density", fontsize=16)
plt.gca().set_yticks([]);
plt.show(block=False)
#plt.savefig('1H0707-mass-density-histogram-tm.png')
#plt.savefig('1H0707-mass-density-histogram-tm.pdf')
#plt.close()

Mean acceptance fraction: 0.345

Mean autocorrelation time: 198.163steps

Mass mean: 6.388

Mass median: 6.480

Mass sigma: 0.257

>>> conf68
(6.322053786002577, 6.453946213997423)

>>> conf95
(6.258027472722586, 6.517972527277414)

#+END_EXAMPLE

#+CAPTION: The probability for 1H0707-495 Mass value where $\mu = 6.388\pm0.257$ (solid blue line) with the error range in blue. The median at 6.48 is shown by the red dashed line.
#+ATTR_HTML::width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707-mass-density-histogram-tm.png

* 1H0707-495 Simultaneous Mass on grouped data fits where log M ranges 5.5 - 7.0

*Strategy*

Load one set at a time using all 15 main pars and run conf
until model converges and fits well.

Save the par file, e.g: =save_par("conf_mass_fit_1data");

Then add the next set of pars for the next observation and run conf
again on all pars using par3 as the main mass par tied to the other
mass values above then save those pars e.g: =save_par("conf_mass_fit_2data");

Continue buidling the full par file

** Combined data + hiflux

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/sim-fit-grouped.sl=

Importing =sim_fit_2group.par=

#+BEGIN_EXAMPLE
isis
source("sim-fit-grouped.sl");

[detached from 103845.pts-28.hm00]

isis> ()=eval_counts;
 Parameters[Variable] = 32[17]
            Data bins = 14
           Chi-square = 0.7154888
isis> list_par;
sds(1)*lag_freq(1) + sds(2)*lag_freq(2)
 idx  param             tie-to  freeze         value         min         max
  1  sds(1).dataset         0     1                1           0           0
  2  lag_freq(1).norm       0     0         15.76791           0         100
  3  lag_freq(1).log_mass   0     0         5.905638         5.5           7
  4  lag_freq(1).i          0     1               53          53          53
  5  lag_freq(1).a          0     1            0.998       0.998       0.998
  6  lag_freq(1).h1         0     1                2           2           2
  7  lag_freq(1).h2         0     0         4.575396           3          20
  8  lag_freq(1).Gamma1     0     0         2.299748         1.5       3.299
  9  lag_freq(1).Gamma2     0     0          2.04227         1.4         3.2
 10  lag_freq(1).Fe         0     1                1           1           1
 11  lag_freq(1).xi         0     0           2.9878           0           3
 12  lag_freq(1).p          0     1                0           0           0
 13  lag_freq(1).b          0     0         2.999848           1           3
 14  lag_freq(1).q2         0     1              0.5         0.5         0.5
 15  lag_freq(1).t_max      0     0         621.4779          50         800
 16  lag_freq(1).t_shift    0     0         25.58361           0         120
 17  sds(2).dataset         0     1                2           0           0
 18  lag_freq(2).norm       0     0         8.674319           0         100
 19  lag_freq(2).log_mass   3     0         5.905638         5.5           7
 20  lag_freq(2).i          4     1               53          53          53
 21  lag_freq(2).a          5     1            0.998       0.998       0.998
 22  lag_freq(2).h1         6     1                2           2           2
 23  lag_freq(2).h2         0     0         4.010776           3          20
 24  lag_freq(2).Gamma1     0     0         2.399908         1.5       3.299
 25  lag_freq(2).Gamma2     0     0         2.112672         1.4         3.2
 26  lag_freq(2).Fe        10     1                1           1           1
 27  lag_freq(2).xi         0     0      0.006210971           0           3
 28  lag_freq(2).p         12     1                0           0           0
 29  lag_freq(2).b          0     0                3           1           3
 30  lag_freq(2).q2        14     1              0.5         0.5         0.5
 31  lag_freq(2).t_max      0     0          600.705          50         800
 32  lag_freq(2).t_shift    0     0         25.00799           0         120

 list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  2.5421e-03     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-comb-time-lags-fmax.fits
  2       EPIC-PN          0       7/    7   -   2  2.5451e-03     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-hiflux-time-lags-fmax.fits
isis> close_plot;
#+END_EXAMPLE

| lag_freq(1).norm     | 1.576791e+01 | +8.423209e+01 | -9.105566e+00 |
| lag_freq(1).log_mass | 5.905638e+00 | +2.277849e-02 | -2.808139e-02 |
| lag_freq(1).h2       | 4.575396e+00 | +2.348060e+00 | -1.575396e+00 |
| lag_freq(1).Gamma1   | 2.299748e+00 | +2.452024e-01 | -3.994947e-01 |
| lag_freq(1).Gamma2   | 2.042270e+00 | +2.360223e-04 | -2.685859e-01 |
| lag_freq(1).xi       | 2.987800e+00 | +1.220012e-02 | -2.987800e+00 |
| lag_freq(1).b        | 2.999848e+00 | +1.523438e-04 | -4.779107e-01 |
| lag_freq(1).t_max    | 6.214779e+02 | +2.514942e+01 | -1.697356e+02 |
| lag_freq(1).t_shift  | 2.558361e+01 | +5.446777e+00 | -1.251802e+00 |
| lag_freq(2).norm     | 8.674319e+00 | +9.132568e+01 | -2.068929e+00 |
| lag_freq(2).h2       | 4.010776e+00 | +2.473717e+00 | -1.010776e+00 |
| lag_freq(2).Gamma1   | 2.399908e+00 | +1.321399e-01 | -6.789698e-01 |
| lag_freq(2).Gamma2   | 2.112672e+00 | +3.878053e-01 | -2.119945e-01 |
| lag_freq(2).xi       | 6.210971e-03 | +1.501853e+00 | -6.210971e-03 |
| lag_freq(2).b        | 3.000000e+00 | +4.915607e-07 | -5.992184e-01 |
| lag_freq(2).t_max    | 6.007050e+02 | +4.599133e+01 | -9.319082e+01 |
| lag_freq(2).t_shift  | 2.500799e+01 | +6.017584e+00 | -1.844765e+00 |

** Combined data + hiflux + hi-cts + medflux

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/sim-fit-grouped.sl=

Importing =sim_fit_4group.par=

#+BEGIN_EXAMPLE
isis
source("sim-fit-grouped.sl");



Run conf by:

source("conf_mass_fit_4group.sl");

[detached from 14820.pts-28.hm00]


#+END_EXAMPLE

| lag_freq(1).norm     | 1.428061e+01 | +2.261602e+00 | -1.276314e+00 |
| lag_freq(1).log_mass | 5.814050e+00 | +7.840497e-03 | -1.001899e-02 |
| lag_freq(1).h2       | 4.036540e+00 | +1.861139e-01 | -1.337588e-01 |
| lag_freq(1).Gamma1   | 2.277619e+00 | +4.115467e-03 | -6.222451e-03 |
| lag_freq(1).Gamma2   | 1.964646e+00 | +8.356881e-03 | -5.834365e-03 |
| lag_freq(1).xi       | 1.045847e+00 | +8.701424e-01 | -3.615121e-01 |
| lag_freq(1).b        | 2.999978e+00 | +2.248751e-05 | -6.062503e-02 |
| lag_freq(1).t_max    | 5.666910e+02 | +3.232290e+00 | -5.619964e+00 |
| lag_freq(1).t_shift  | 2.654818e+01 | +4.437176e-01 | -3.086526e-01 |
| lag_freq(2).norm     | 5.703300e+00 | +1.178742e+00 | -6.994545e-01 |
| lag_freq(2).h2       | 1.003655e+01 | +1.199962e-02 | -8.199802e-03 |
| lag_freq(2).Gamma1   | 2.413612e+00 | +2.688196e-02 | -4.579532e-02 |
| lag_freq(2).Gamma2   | 1.796975e+00 | +8.370610e-04 | -1.701393e-03 |
| lag_freq(2).xi       | 2.999954e+00 | +4.562162e-05 | -6.785916e-01 |
| lag_freq(2).b        | 2.999994e+00 | +5.679687e-06 | -5.367014e-01 |
| lag_freq(2).t_max    | 2.846531e+02 | +1.374717e+01 | -2.939848e+01 |
| lag_freq(2).t_shift  | 1.199999e+02 | +7.044740e-05 | -6.976949e+00 |
| lag_freq(3).norm     | 5.424522e-01 | +7.025586e-02 | -1.042160e-01 |
| lag_freq(3).h2       | 3.001153e+00 | +2.346076e+00 | -1.153308e-03 |
| lag_freq(3).Gamma1   | 2.443245e+00 | +1.078059e-01 | -1.708230e-01 |
| lag_freq(3).Gamma2   | 1.773919e+00 | +1.822642e-01 | -1.211680e-01 |
| lag_freq(3).xi       | 2.999430e+00 | +5.704153e-04 | -2.999430e+00 |
| lag_freq(3).b        | 3.000000e+00 | +4.626675e-07 | -5.987660e-01 |
| lag_freq(3).t_max    | 2.999699e+02 | +1.663018e+01 | -3.961211e+01 |
| lag_freq(3).t_shift  | 1.199992e+02 | +7.557119e-04 | -3.857960e+00 |
| lag_freq(4).norm     | 1.246400e+01 | +1.193218e+01 | -7.363668e+00 |
| lag_freq(4).h2       | 5.029730e+00 | +3.461352e-01 | -5.930440e-01 |
| lag_freq(4).Gamma1   | 2.005635e+00 | +6.877399e-02 | -7.249936e-02 |
| lag_freq(4).Gamma2   | 2.123216e+00 | +2.630440e-02 | -1.615994e-02 |
| lag_freq(4).xi       | 1.004161e+00 | +6.739438e-01 | -4.553223e-02 |
| lag_freq(4).b        | 2.346121e+00 | +6.538786e-01 | -1.346121e+00 |
| lag_freq(4).t_max    | 3.568161e+02 | +6.525238e+00 | -4.028242e+00 |
| lag_freq(4).t_shift  | 6.872335e+01 | +4.873890e+00 | -6.872335e+01 |


** Combined data + hiflux + hi-cts + medflux + loflux

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/sim-fit-grouped.sl=

Importing =sim_fit_5group.par=

#+BEGIN_EXAMPLE
isis
source("sim-fit-grouped.sl");


Run conf by:

source("conf_mass_fit_5group.sl");



#+END_EXAMPLE

** Combined data + hiflux + hi-cts + medflux + loflux + lo-cts

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/sim-fit-grouped.sl=

Importing =sim-fit-grouped-6.sloup.par=

#+BEGIN_EXAMPLE
isis
source("sim-fit-grouped-6.sl");


Run conf by:

source("conf_mass_fit_6group.sl");
Started 1200 15 July 21

[detached from 80634.pts-28.hm00]

 gedit conf_mass_fit_6group.par &

sds(1)*lag_freq(1) + sds(2)*lag_freq(2) + sds(3)*lag_freq(3) + sds(4)*lag_freq(4) + sds(5)*lag_freq(5) + sds(6)*lag_freq(6)
 idx  param             tie-to  freeze         value         min         max
  1  sds(1).dataset         0     1                1           0           0
  2  lag_freq(1).norm       0     0         56.97544           0         100
  3  lag_freq(1).log_mass   0     0         5.849217         5.5           7
  4  lag_freq(1).i          0     1               53          53          53
  5  lag_freq(1).a          0     1            0.998       0.998       0.998
  6  lag_freq(1).h1         0     1                2           2           2
  7  lag_freq(1).h2         0     0         11.77834           3          20
  8  lag_freq(1).Gamma1     0     0         2.381243         1.5       3.299
  9  lag_freq(1).Gamma2     0     0         1.889267         1.4         3.2
 10  lag_freq(1).Fe         0     1                1           1           1
 11  lag_freq(1).xi         0     0        0.9452375           0           3
 12  lag_freq(1).p          0     1                0           0           0
 13  lag_freq(1).b          0     0                3           1           3
 14  lag_freq(1).q2         0     1              0.5         0.5         0.5
 15  lag_freq(1).t_max      0     0         742.7079          50         800
 16  lag_freq(1).t_shift    0     0         25.28241           0         120
 17  sds(2).dataset         0     1                2           0           0
 18  lag_freq(2).norm       0     0         95.98746           0         100
 19  lag_freq(2).log_mass   3     0         5.849217         5.5           7
 20  lag_freq(2).i          4     1               53          53          53
 21  lag_freq(2).a          5     1            0.998       0.998       0.998
 22  lag_freq(2).h1         6     1                2           2           2
 23  lag_freq(2).h2         0     0         11.97755           3          20
 24  lag_freq(2).Gamma1     0     0         2.380176         1.5       3.299
 25  lag_freq(2).Gamma2     0     0         1.887241         1.4         3.2
 26  lag_freq(2).Fe        10     1                1           1           1
 27  lag_freq(2).xi         0     0        0.9546139           0           3
 28  lag_freq(2).p         12     1                0           0           0
 29  lag_freq(2).b          0     0                3           1           3
 30  lag_freq(2).q2        14     1              0.5         0.5         0.5
 31  lag_freq(2).t_max      0     0          746.559          50         800
 32  lag_freq(2).t_shift    0     0         25.27117           0         120
 33  sds(3).dataset         0     1                3           0           0
 34  lag_freq(3).norm       0     0         1.716895           0         100
 35  lag_freq(3).log_mass   3     0         5.849217         5.5           7
 36  lag_freq(3).i          4     1               53          53          53
 37  lag_freq(3).a          5     1            0.998       0.998       0.998
 38  lag_freq(3).h1         6     1                2           2           2
 39  lag_freq(3).h2         0     0         3.000001           3          20
 40  lag_freq(3).Gamma1     0     0         3.042589         1.5       3.299
 41  lag_freq(3).Gamma2     0     0         2.523158         1.4         3.2
 42  lag_freq(3).Fe        10     1                1           1           1
 43  lag_freq(3).xi         0     0       0.02411932           0           3
 44  lag_freq(3).p         12     1                0           0           0
 45  lag_freq(3).b          0     0                3           1           3
 46  lag_freq(3).q2        14     1              0.5         0.5         0.5
 47  lag_freq(3).t_max      0     0         249.9999          50         800
 48  lag_freq(3).t_shift    0     0              120           0         120
 49  sds(4).dataset         0     1                4           0           0
 50  lag_freq(4).norm       0     0         91.43762           0         100
 51  lag_freq(4).log_mass   3     0         5.849217         5.5           7
 52  lag_freq(4).i          4     1               53          53          53
 53  lag_freq(4).a          5     1            0.998       0.998       0.998
 54  lag_freq(4).h1         6     1                2           2           2
 55  lag_freq(4).h2         0     0         5.349603           3          20
 56  lag_freq(4).Gamma1     0     0         2.374879         1.5       3.299
 57  lag_freq(4).Gamma2     0     0         2.200295         1.4         3.2
 58  lag_freq(4).Fe        10     1                1           1           1
 59  lag_freq(4).xi         0     0                3           0           3
 60  lag_freq(4).p         12     1                0           0           0
 61  lag_freq(4).b          0     0                3           1           3
 62  lag_freq(4).q2        14     1              0.5         0.5         0.5
 63  lag_freq(4).t_max      0     0         750.4696          50         800
 64  lag_freq(4).t_shift    0     0              100           0         120
 65  sds(5).dataset         0     1                5           0           0
 66  lag_freq(5).norm       0     0         13.13891           0         100
 67  lag_freq(5).log_mass   3     0         5.849217         5.5           7
 68  lag_freq(5).i          4     1               53          53          53
 69  lag_freq(5).a          5     1            0.998       0.998       0.998
 70  lag_freq(5).h1         6     1                2           2           2
 71  lag_freq(5).h2         0     0         5.195399           3          20
 72  lag_freq(5).Gamma1     0     0            3.299         1.5       3.299
 73  lag_freq(5).Gamma2     0     0         2.094512         1.4         3.2
 74  lag_freq(5).Fe        10     1                1           1           1
 75  lag_freq(5).xi         0     0         1.999999           0           3
 76  lag_freq(5).p         12     1                0           0           0
 77  lag_freq(5).b          0     0         1.000001           1           3
 78  lag_freq(5).q2        14     1              0.5         0.5         0.5
 79  lag_freq(5).t_max      0     0         636.4436          50         800
 80  lag_freq(5).t_shift    0     0              120           0         120
 81  sds(6).dataset         0     1                6           0           0
 82  lag_freq(6).norm       0     0         99.88019           0         100
 83  lag_freq(6).log_mass   3     0         5.849217         5.5           7
 84  lag_freq(6).i          4     1               53          53          53
 85  lag_freq(6).a          5     1            0.998       0.998       0.998
 86  lag_freq(6).h1         6     1                2           2           2
 87  lag_freq(6).h2         0     0         4.472234           3          20
 88  lag_freq(6).Gamma1     0     0         2.132327         1.5       3.299
 89  lag_freq(6).Gamma2     0     0         1.938025         1.4         3.2
 90  lag_freq(6).Fe        10     1                1           1           1
 91  lag_freq(6).xi         0     0                3           0           3
 92  lag_freq(6).p         12     1                0           0           0
 93  lag_freq(6).b          0     0         2.007429           1           3
 94  lag_freq(6).q2        14     1              0.5         0.5         0.5
 95  lag_freq(6).t_max      0     0         708.7109          50         800
 96  lag_freq(6).t_shift    0     0         55.34384           0         120

#+END_EXAMPLE

| lag_freq(1).norm     | 5.697544e+01 | +4.302456e+01 | -5.193889e+01 |
| lag_freq(1).log_mass | 5.849217e+00 | +9.928054e-03 | -1.349302e-02 |
| lag_freq(1).h2       | 1.177834e+01 | +2.149560e+00 | -7.279277e-01 |
| lag_freq(1).Gamma1   | 2.381243e+00 | +3.070737e-01 | -1.537697e-01 |
| lag_freq(1).Gamma2   | 1.889267e+00 | +5.675692e-01 | -2.842316e-01 |
| lag_freq(1).xi       | 9.452375e-01 | +2.054762e+00 | -9.452375e-01 |
| lag_freq(1).b        | 3.000000e+00 | +8.119788e-08 | -3.061947e-01 |
| lag_freq(1).t_max    | 7.427079e+02 | +4.777200e+00 | -1.810020e+01 |
| lag_freq(1).t_shift  | 2.528241e+01 | +4.236602e+00 | -1.932357e+00 |
| lag_freq(2).norm     | 9.598746e+01 | +4.012540e+00 | -9.100272e+01 |
| lag_freq(2).h2       | 1.197755e+01 | +2.175566e+00 | -9.277212e-01 |
| lag_freq(2).Gamma1   | 2.380176e+00 | +1.819019e-01 | -6.169278e-02 |
| lag_freq(2).Gamma2   | 1.887241e+00 | +4.957671e-03 | -2.196069e-02 |
| lag_freq(2).xi       | 9.546139e-01 | +2.045386e+00 | -9.546139e-01 |
| lag_freq(2).b        | 3.000000e+00 | +5.951844e-08 | -1.366884e-01 |
| lag_freq(2).t_max    | 7.465590e+02 | +9.447153e-01 | -6.455854e+01 |
| lag_freq(2).t_shift  | 2.527117e+01 | +4.390088e+00 | -1.692013e+00 |
| lag_freq(3).norm     | 1.716895e+00 | +4.143695e+00 | -1.140422e+00 |
| lag_freq(3).h2       | 3.000001e+00 | +3.994752e+00 | -1.396313e-06 |
| lag_freq(3).Gamma1   | 3.042589e+00 | +5.703645e-02 | -1.109925e+00 |
| lag_freq(3).Gamma2   | 2.523158e+00 | +1.236196e-01 | -2.751527e-01 |
| lag_freq(3).xi       | 2.411932e-02 | +9.710095e-01 | -2.411932e-02 |
| lag_freq(3).b        | 3.000000e+00 | +8.746985e-08 | -5.917437e-01 |
| lag_freq(3).t_max    | 2.499999e+02 | +2.029403e+01 | -3.081869e+01 |
| lag_freq(3).t_shift  | 1.200000e+02 | +3.094395e-06 | -7.957607e+00 |
| lag_freq(4).norm     | 9.143762e+01 | +8.562384e+00 | -9.120010e+01 |
| lag_freq(4).h2       | 5.349603e+00 | +6.480223e-01 | -1.347227e+00 |
| lag_freq(4).Gamma1   | 2.374879e+00 | +5.248784e-01 | -3.740193e-01 |
| lag_freq(4).Gamma2   | 2.200295e+00 | +5.294038e-01 | -2.999830e-01 |
| lag_freq(4).xi       | 3.000000e+00 | +1.546682e-08 | -3.000000e+00 |
| lag_freq(4).b        | 3.000000e+00 | +1.007213e-07 | -8.531420e-01 |
| lag_freq(4).t_max    | 7.504696e+02 | +5.834110e+00 | -1.802600e+02 |
| lag_freq(4).t_shift  | 1.000000e+02 | +1.999995e+01 | -1.217982e+01 |
| lag_freq(5).norm     | 1.313891e+01 | +8.686109e+01 | -1.269223e+01 |
| lag_freq(5).h2       | 5.195399e+00 | +1.786710e+00 | -9.875047e-02 |
| lag_freq(5).Gamma1   | 3.299000e+00 | +3.979273e-08 | -8.814859e-01 |
| lag_freq(5).Gamma2   | 2.094512e+00 | +8.509358e-01 | -9.353925e-02 |
| lag_freq(5).xi       | 1.999999e+00 | +1.000001e+00 | -1.999999e+00 |
| lag_freq(5).b        | 1.000001e+00 | +5.293274e-01 | -5.223244e-07 |
| lag_freq(5).t_max    | 6.364436e+02 | +4.123882e+00 | -1.862021e+02 |
| lag_freq(5).t_shift  | 1.200000e+02 | +2.486814e-06 | -1.640982e+01 |
| lag_freq(6).norm     | 9.988019e+01 | +1.198067e-01 | -9.369410e+01 |
| lag_freq(6).h2       | 4.472234e+00 | +1.552777e+01 | -4.064546e-01 |
| lag_freq(6).Gamma1   | 2.132327e+00 | +1.655191e-01 | -1.653994e-02 |
| lag_freq(6).Gamma2   | 1.938025e+00 | +4.005590e-02 | -3.184091e-02 |
| lag_freq(6).xi       | 3.000000e+00 | +4.715211e-07 | -3.000000e+00 |
| lag_freq(6).b        | 2.007429e+00 | +1.613357e-01 | -2.904168e-01 |
| lag_freq(6).t_max    | 7.087109e+02 | +3.819609e+01 | -1.638871e+02 |
| lag_freq(6).t_shift  | 5.534384e+01 | +5.455026e+00 | -2.479961e+01 |



#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit_grouped.gif

* 1H0707-495 Simultaneous Mass on grouped data - Individual fits

** Combined

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/fit-table-model-comb.sl=

Loading PARFILE =sim_fit_comb.par=

Freeze all pars to see the fit

#+BEGIN_EXAMPLE
gedit sim_fit_comb.par

source("fit-table-model-comb.sl");

t_g = 3.481793e+00
 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 4.850685
   Reduced chi-square = 0.692955

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     1         56.97544           0         100
  2  lag_freq(1).log_mass   0     1         5.849217         5.5           7
  3  lag_freq(1).i          0     1               53          53          53
  4  lag_freq(1).a          0     1            0.998       0.998       0.998
  5  lag_freq(1).h1         0     1                2           2           2
  6  lag_freq(1).h2         0     1         11.77834           3          20
  7  lag_freq(1).Gamma1     0     1         2.381243         1.5       3.299
  8  lag_freq(1).Gamma2     0     1         1.889267         1.4         3.2
  9  lag_freq(1).Fe         0     1                1           1           1
 10  lag_freq(1).xi         0     1        0.9452375           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           1           3
 13  lag_freq(1).q2         0     1              0.5         0.5         0.5
 14  lag_freq(1).t_max      0     1         742.7079          50         800
 15  lag_freq(1).t_shift    0     1         25.28241           0         120


#+END_EXAMPLE

| lag_freq(1).norm     | 5.697544e+01 | +4.302456e+01 | -5.193889e+01 |
| lag_freq(1).log_mass | 5.849217e+00 | +9.928054e-03 | -1.349302e-02 |
| lag_freq(1).h2       | 1.177834e+01 | +2.149560e+00 | -7.279277e-01 |
| lag_freq(1).Gamma1   | 2.381243e+00 | +3.070737e-01 | -1.537697e-01 |
| lag_freq(1).Gamma2   | 1.889267e+00 | +5.675692e-01 | -2.842316e-01 |
| lag_freq(1).xi       | 9.452375e-01 | +2.054762e+00 | -9.452375e-01 |
| lag_freq(1).b        | 3.000000e+00 | +8.119788e-08 | -3.061947e-01 |
| lag_freq(1).t_max    | 7.427079e+02 | +4.777200e+00 | -1.810020e+01 |
| lag_freq(1).t_shift  | 2.528241e+01 | +4.236602e+00 | -1.932357e+00 |


#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit_comb.gif



pdf at:


#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit_comb.pdf

ps at:


#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit_comb.ps
** Hiflux

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/fit-table-model-hiflux.sl=

Loading PARFILE =sim_fit_hiflux.par=

Freeze all pars to see the fit

#+BEGIN_EXAMPLE

source("fit-table-model-hiflux.sl");

t_g = 3.481793e+00
 Parameters[Variable] = 15[0]
            Data bins = 14
           Chi-square = 8.696835
   Reduced chi-square = 0.6212025
lag_freq(2)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(2).norm       0     1         95.98746           0         100
  2  lag_freq(2).log_mass   0     1         5.849217         5.5           7
  3  lag_freq(2).i          0     1               53          53          53
  4  lag_freq(2).a          0     1            0.998       0.998       0.998
  5  lag_freq(2).h1         0     1                2           2           2
  6  lag_freq(2).h2         0     1         11.97755           3          20
  7  lag_freq(2).Gamma1     0     1         2.380176         1.5       3.299
  8  lag_freq(2).Gamma2     0     1         1.887241         1.4         3.2
  9  lag_freq(2).Fe         0     1                1           1           1
 10  lag_freq(2).xi         0     1        0.9546139           0           3
 11  lag_freq(2).p          0     1                0           0           0
 12  lag_freq(2).b          0     1                3           1           3
 13  lag_freq(2).q2         0     1              0.5         0.5         0.5
 14  lag_freq(2).t_max      0     1          746.559          50         800
 15  lag_freq(2).t_shift    0     1         25.27117           0         120


#+END_EXAMPLE



#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit_hiflux.gif



pdf at:


#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit_hiflux.pdf




** Hicts

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/fit-table-model-hi-cts-flux.sl=

Loading PARFILE =sim_fit_hicts.par=

Freeze all pars to see the fit

#+BEGIN_EXAMPLE

source("fit-table-model-hi-cts-flux.sl");

t_g = 3.481793e+00
 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 65.1873
   Reduced chi-square = 9.312471
lag_freq(3)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(3).norm       0     1         1.716895           0         100
  2  lag_freq(3).log_mass   0     1         5.849217         5.5           7
  3  lag_freq(3).i          0     1               53          53          53
  4  lag_freq(3).a          0     1            0.998       0.998       0.998
  5  lag_freq(3).h1         0     1                2           2           2
  6  lag_freq(3).h2         0     1         3.000001           3          20
  7  lag_freq(3).Gamma1     0     1         3.042589         1.5       3.299
  8  lag_freq(3).Gamma2     0     1         2.523158         1.4         3.2
  9  lag_freq(3).Fe         0     1                1           1           1
 10  lag_freq(3).xi         0     1       0.02411932           0           3
 11  lag_freq(3).p          0     1                0           0           0
 12  lag_freq(3).b          0     1                3           1           3
 13  lag_freq(3).q2         0     1              0.5         0.5         0.5
 14  lag_freq(3).t_max      0     1         249.9999          50         800
 15  lag_freq(3).t_shift    0     1              120           0         120

Poor fit - Can a better fit be found at this mass?

################ could not be fitted ##################
TableParamValueOutsideRange: Requested parameter value 3.15395 outside tabulated range (1.5, 3)


 XSPEC signal: segmentation fault (SIGSEGV) while in an XSPEC function.



Many work - arounds attempted but table model would not fit this
parfile!!!!!!

#+END_EXAMPLE



#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit_hicts.gif



pdf at:


#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit_hicts.pdf

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit_hicts.pdf

** Medflux

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/fit-table-model-medflux.sl=

Loading PARFILE =sim_fit_medflux.par=

Freeze all pars to see the fit

#+BEGIN_EXAMPLE

source("fit-table-model-medflux.sl");


t_g = 3.481793e+00
 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 1.570961
   Reduced chi-square = 0.224423
lag_freq(4)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(4).norm       0     1         91.43762           0         100
  2  lag_freq(4).log_mass   0     1         5.849217         5.5           7
  3  lag_freq(4).i          0     1               53          53          53
  4  lag_freq(4).a          0     1            0.998       0.998       0.998
  5  lag_freq(4).h1         0     1                2           2           2
  6  lag_freq(4).h2         0     1         5.349603           3          20
  7  lag_freq(4).Gamma1     0     1         2.374879         1.5       3.299
  8  lag_freq(4).Gamma2     0     1         2.200295         1.4         3.2
  9  lag_freq(4).Fe         0     1                1           1           1
 10  lag_freq(4).xi         0     1                3           0           3
 11  lag_freq(4).p          0     1                0           0           0
 12  lag_freq(4).b          0     1                3           1           3
 13  lag_freq(4).q2         0     1              0.5         0.5         0.5
 14  lag_freq(4).t_max      0     1         750.4696          50         800
 15  lag_freq(4).t_shift    0     1              100           0         120
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  2.4064e-02     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-med-time-lags-fmax.fits

#+END_EXAMPLE


| lag_freq(4).norm     | 9.143762e+01 | +8.562384e+00 | -9.120010e+01 |
| lag_freq(4).h2       | 5.349603e+00 | +6.480223e-01 | -1.347227e+00 |
| lag_freq(4).Gamma1   | 2.374879e+00 | +5.248784e-01 | -3.740193e-01 |
| lag_freq(4).Gamma2   | 2.200295e+00 | +5.294038e-01 | -2.999830e-01 |
| lag_freq(4).xi       | 3.000000e+00 | +1.546682e-08 | -3.000000e+00 |
| lag_freq(4).b        | 3.000000e+00 | +1.007213e-07 | -8.531420e-01 |
| lag_freq(4).t_max    | 7.504696e+02 | +5.834110e+00 | -1.802600e+02 |
| lag_freq(4).t_shift  | 1.000000e+02 | +1.999995e+01 | -1.217982e+01 |


#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit_medflux.gif


pdf at:


http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit_medflux.pdf


http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit_medflux.pdf

** Loflux

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/fit-table-model-loflux.sl=

Loading PARFILE =sim_fit_loflux.par=

Freeze all pars to see the fit

#+BEGIN_EXAMPLE

source("fit-table-model-loflux.sl");


t_g = 3.481793e+00
 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 2.844355
   Reduced chi-square = 0.4063365

lag_freq(5)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(5).norm       0     1         13.13891           0         100
  2  lag_freq(5).log_mass   0     1         5.849217         5.5           7
  3  lag_freq(5).i          0     1               53          53          53
  4  lag_freq(5).a          0     1            0.998       0.998       0.998
  5  lag_freq(5).h1         0     1                2           2           2
  6  lag_freq(5).h2         0     1         5.195399           3          20
  7  lag_freq(5).Gamma1     0     1            3.299         1.5       3.299
  8  lag_freq(5).Gamma2     0     1         2.094512         1.4         3.2
  9  lag_freq(5).Fe         0     1                1           1           1
 10  lag_freq(5).xi         0     1         1.999999           0           3
 11  lag_freq(5).p          0     1                0           0           0
 12  lag_freq(5).b          0     1         1.000001           1           3
 13  lag_freq(5).q2         0     1              0.5         0.5         0.5
 14  lag_freq(5).t_max      0     1         636.4436          50         800
 15  lag_freq(5).t_shift    0     1              120           0         120

#+END_EXAMPLE

*Note* The lag file for this deos not exist the re is a big gap in the
lag files with this fit where tmax = 600 - the tshift file directories
are empty !!!



#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit_loflux.gif



** Locts

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/fit-table-model-locts.sl=

Loading PARFILE =sim_fit_locts.par=

Freeze all pars to see the fit

#+BEGIN_EXAMPLE

source("fit-table-model-locts.sl");

isis> () = eval_counts;
t_g = 3.481793e+00
 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 0.8672572
   Reduced chi-square = 0.1238939
isis> list_par;
lag_freq(6)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(6).norm       0     1         99.88019           0         100
  2  lag_freq(6).log_mass   0     1         5.849217         5.5           7
  3  lag_freq(6).i          0     1               53          53          53
  4  lag_freq(6).a          0     1            0.998       0.998       0.998
  5  lag_freq(6).h1         0     1                2           2           2
  6  lag_freq(6).h2         0     1         4.472234           3          20
  7  lag_freq(6).Gamma1     0     1         2.132327         1.5       3.299
  8  lag_freq(6).Gamma2     0     1         1.938025         1.4         3.2
  9  lag_freq(6).Fe         0     1                1           1           1
 10  lag_freq(6).xi         0     1                3           0           3
 11  lag_freq(6).p          0     1                0           0           0
 12  lag_freq(6).b          0     1         2.007429           1           3
 13  lag_freq(6).q2         0     1              0.5         0.5         0.5
 14  lag_freq(6).t_max      0     1         708.7109          50         800
 15  lag_freq(6).t_shift    0     1         55.34384           0         120

Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  9.7771e-03     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-lo-cts-time-lags-fmax.fits


#############################################
Lag file does not exist - none above tmax = 580
#############################################

#+END_EXAMPLE


#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit_locts.gif

* 1H0707-495 Simultaneous Mass fits where log M ranges 6.0 - 8.0
** First 2 data sets as a test

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/mass-fit.sl=

Importing =conf_mass_fit_1data.par=

#+BEGIN_EXAMPLE
isis

source("mass-fit.sl");

source("conf_mass_fit_2data.sl");

gedit conf_mass_fit_2data.csv

| lag_freq(1).norm     | 9.999365e+00 | +6.346877e-04 | -9.251022e+00 |
| lag_freq(1).log_mass | 6.710821e+00 | +2.004626e-02 | -2.983140e-02 |
| lag_freq(1).h2       | 1.451429e+01 | +5.485710e+00 | -1.820864e+00 |
| lag_freq(1).Gamma1   | 2.442656e+00 | +4.547890e-01 | -2.973652e-01 |
| lag_freq(1).Gamma2   | 1.600000e+00 | +1.290903e+00 | -2.000000e-01 |
| lag_freq(1).xi       | 2.999999e+00 | +5.508162e-07 | -2.999999e+00 |
| lag_freq(1).b        | 2.240245e+00 | +7.166338e-01 | -8.027802e-01 |
| lag_freq(1).t_max    | 3.249890e+02 | +4.200314e+02 | -2.707977e+02 |
| lag_freq(1).t_shift  | 2.274412e+01 | +3.553509e+00 | -6.780519e+00 |
| lag_freq(2).norm     | 3.841639e+00 | +4.624339e+00 | -3.190693e+00 |
| lag_freq(2).h2       | 1.975024e+01 | +2.497628e-01 | -7.862779e+00 |
| lag_freq(2).Gamma1   | 2.654491e+00 | +6.445089e-01 | -5.772455e-01 |
| lag_freq(2).Gamma2   | 2.048937e+00 | +8.327521e-01 | -6.424277e-01 |
| lag_freq(2).xi       | 2.311975e+00 | +6.880251e-01 | -2.311975e+00 |
| lag_freq(2).b        | 2.812931e+00 | +1.870690e-01 | -3.500946e-01 |
| lag_freq(2).t_max    | 2.723954e+02 | +1.613511e+02 | -8.185210e+01 |
| lag_freq(2).t_shift  | 2.488957e+01 | +1.553832e+00 | -8.690082e+00 |

#+END_EXAMPLE

Copy This par file to add in the next observation

#+BEGIN_EXAMPLE
cp conf_mass_fit_2data.par conf_mass_fit_3data.par

sds(1)*lag_freq(1) + sds(2)*lag_freq(2) + sds(3)*lag_freq(3)
 idx  param             tie-to  freeze         value         min         max
  1  sds(1).dataset         0     1                1           0           0
  2  lag_freq(1).norm       0     0         9.999365           0          10
  3  lag_freq(1).log_mass   0     0         6.710821           6           8
  4  lag_freq(1).i          0     1               53          53          53
  5  lag_freq(1).a          0     1            0.998       0.998       0.998
  6  lag_freq(1).h1         0     1                2           2           2
  7  lag_freq(1).h2         0     0         14.51429           3          20
  8  lag_freq(1).Gamma1     0     0         2.442656         1.5       3.299
  9  lag_freq(1).Gamma2     0     0              1.6         1.4         3.2
 10  lag_freq(1).Fe         0     1                1           1           1
 11  lag_freq(1).xi         0     0         2.999999           0           3
 12  lag_freq(1).p          0     1                0           0           0
 13  lag_freq(1).b          0     0         2.240245           1           3
 14  lag_freq(1).q2         0     1              0.5         0.5         0.5
 15  lag_freq(1).t_max      0     0          324.989          50         800
 16  lag_freq(1).t_shift    0     0         22.74412           0         120
 17  sds(2).dataset         0     1                2           0           0
 18  lag_freq(2).norm       0     0         3.841639           0          10
 19  lag_freq(2).log_mass   3     0         6.710821           6           8
 20  lag_freq(2).i          4     1               53          53          53
 21  lag_freq(2).a          5     1            0.998       0.998       0.998
 22  lag_freq(2).h1         6     1                2           2           2
 23  lag_freq(2).h2         0     0         19.75024           3          20
 24  lag_freq(2).Gamma1     0     0         2.654491         1.5       3.299
 25  lag_freq(2).Gamma2     0     0         2.048937         1.4         3.2
 26  lag_freq(2).Fe        10     1                1           1           1
 27  lag_freq(2).xi         0     0         2.311975           0           3
 28  lag_freq(2).p         12     1                0           0           0
 29  lag_freq(2).b          0     0         2.812931           1           3
 30  lag_freq(2).q2        14     1              0.5         0.5         0.5
 31  lag_freq(2).t_max      0     0         272.3954          50         800
 32  lag_freq(2).t_shift    0     0         24.88957           0         120
 33  sds(3).dataset         0     1                2           0           0
 34  lag_freq(3).norm       0     0         3.841639           0          10
 35  lag_freq(3).log_mass   3     0         6.710821           6           8
 36  lag_freq(3).i          4     1               53          53          53
 37  lag_freq(3).a          5     1            0.998       0.998       0.998
 38  lag_freq(3).h1         6     1                2           2           2
 39  lag_freq(3).h2         0     0         19.75024           3          20
 40  lag_freq(3).Gamma1     0     0         2.654491         1.5       3.299
 41  lag_freq(3).Gamma2     0     0         2.048937         1.4         3.2
 42  lag_freq(3).Fe        10     1                1           1           1
 43  lag_freq(3).xi         0     0         2.311975           0           3
 44  lag_freq(3).p         12     1                0           0           0
 45  lag_freq(3).b          0     0         2.812931           1           3
 46  lag_freq(3).q2        14     1              0.5         0.5         0.5
 47  lag_freq(3).t_max      0     0         272.3954          50         800
 48  lag_freq(3).t_shift    0     0         24.88957           0         120

#+END_EXAMPLE


Run this and do conf(); to begin to converge model.


#+BEGIN_EXAMPLE

source("mass-fit.sl");

conf(34); etc

where freepars are:
variable p = [2,3,7,8,9,11,13,15,16,18,23,24,25,27,29,31,32,34,39,40,41,43,45,47,48];


FINALLY - run full conf in a 'screen' (may take a while)

source("conf_mass_fit_3data.sl");

[detached from 111038.pts-4.hm00]
#+END_EXAMPLE

** 3 data sets fit

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/mass-fit.sl=

Importing =conf_mass_fit_3data.par=


Parfile =conf_mass_fit_3data.par=

#+BEGIN_EXAMPLE
sds(1)*lag_freq(1) + sds(2)*lag_freq(2) + sds(3)*lag_freq(3)
 idx  param             tie-to  freeze         value         min         max
  1  sds(1).dataset         0     1                1           0           0
  2  lag_freq(1).norm       0     0         7.941131           0          10
  3  lag_freq(1).log_mass   0     0         6.746035           6           8
  4  lag_freq(1).i          0     1               53          53          53
  5  lag_freq(1).a          0     1            0.998       0.998       0.998
  6  lag_freq(1).h1         0     1                2           2           2
  7  lag_freq(1).h2         0     0         13.28722           3          20
  8  lag_freq(1).Gamma1     0     0         2.418271         1.5       3.299
  9  lag_freq(1).Gamma2     0     0         1.838331         1.4         3.2
 10  lag_freq(1).Fe         0     1                1           1           1
 11  lag_freq(1).xi         0     0         2.999984           0           3
 12  lag_freq(1).p          0     1                0           0           0
 13  lag_freq(1).b          0     0         2.808325           1           3
 14  lag_freq(1).q2         0     1              0.5         0.5         0.5
 15  lag_freq(1).t_max      0     0         305.5524          50         800
 16  lag_freq(1).t_shift    0     0         21.99062           0         120
 17  sds(2).dataset         0     1                2           0           0
 18  lag_freq(2).norm       0     0         6.481889           0          10
 19  lag_freq(2).log_mass   3     0         6.746035           6           8
 20  lag_freq(2).i          4     1               53          53          53
 21  lag_freq(2).a          5     1            0.998       0.998       0.998
 22  lag_freq(2).h1         6     1                2           2           2
 23  lag_freq(2).h2         0     0          14.0698           3          20
 24  lag_freq(2).Gamma1     0     0          2.49221         1.5       3.299
 25  lag_freq(2).Gamma2     0     0         1.819724         1.4         3.2
 26  lag_freq(2).Fe        10     1                1           1           1
 27  lag_freq(2).xi         0     0         2.030804           0           3
 28  lag_freq(2).p         12     1                0           0           0
 29  lag_freq(2).b          0     0         2.584878           1           3
 30  lag_freq(2).q2        14     1              0.5         0.5         0.5
 31  lag_freq(2).t_max      0     0         226.1851          50         800
 32  lag_freq(2).t_shift    0     0         30.13164           0         120
 33  sds(3).dataset         0     1                2           0           0
 34  lag_freq(3).norm       0     0         9.999994           0          10
 35  lag_freq(3).log_mass   3     0         6.746035           6           8
 36  lag_freq(3).i          4     1               53          53          53
 37  lag_freq(3).a          5     1            0.998       0.998       0.998
 38  lag_freq(3).h1         6     1                2           2           2
 39  lag_freq(3).h2         0     0         19.99999           3          20
 40  lag_freq(3).Gamma1     0     0         2.350624         1.5       3.299
 41  lag_freq(3).Gamma2     0     0         1.997652         1.4         3.2
 42  lag_freq(3).Fe        10     1                1           1           1
 43  lag_freq(3).xi         0     0         2.999857           0           3
 44  lag_freq(3).p         12     1                0           0           0
 45  lag_freq(3).b          0     0         2.956959           1           3
 46  lag_freq(3).q2        14     1              0.5         0.5         0.5
 47  lag_freq(3).t_max      0     0         449.4993          50         800
 48  lag_freq(3).t_shift    0     0         22.02826           0         120
#+END_EXAMPLE

Confidence file: =conf_mass_fit_3data.csv=

| lag_freq(1).norm     | 7.941131e+00 | +2.058869e+00 | -6.888794e+00 |
| lag_freq(1).log_mass | 6.746035e+00 | +1.205749e-02 | -6.878881e-02 |
| lag_freq(1).h2       | 1.328722e+01 | +3.245510e+00 | -1.914969e+00 |
| lag_freq(1).Gamma1   | 2.418271e+00 | +8.807289e-01 | -1.161872e-01 |
| lag_freq(1).Gamma2   | 1.838331e+00 | +1.046283e+00 | -2.191654e-01 |
| lag_freq(1).xi       | 2.999984e+00 | +1.561057e-05 | -2.999984e+00 |
| lag_freq(1).b        | 2.808325e+00 | +1.916752e-01 | -5.690914e-01 |
| lag_freq(1).t_max    | 3.055524e+02 | +3.683977e+02 | -1.211739e+02 |
| lag_freq(1).t_shift  | 2.199062e+01 | +1.200425e+00 | -4.739863e+00 |
| lag_freq(2).norm     | 6.481889e+00 | +3.518111e+00 | -6.481889e+00 |
| lag_freq(2).h2       | 1.406980e+01 | +5.930201e+00 | -5.534900e+00 |
| lag_freq(2).Gamma1   | 2.492210e+00 | +8.067898e-01 | -9.922102e-01 |
| lag_freq(2).Gamma2   | 1.819724e+00 | +1.077576e+00 | -4.197236e-01 |
| lag_freq(2).xi       | 2.030804e+00 | +9.691960e-01 | -2.030804e+00 |
| lag_freq(2).b        | 2.584878e+00 | +4.151221e-01 | -7.923954e-01 |
| lag_freq(2).t_max    | 2.261851e+02 | +1.761851e+02 | -8.809253e+01 |
| lag_freq(2).t_shift  | 3.013164e+01 | +4.953000e+01 | -3.013164e+01 |
| lag_freq(3).norm     | 9.999994e+00 | +5.834828e-06 | -9.999994e+00 |
| lag_freq(3).h2       | 1.999999e+01 | +1.283350e-05 | -1.699999e+01 |
| lag_freq(3).Gamma1   | 2.350624e+00 | +9.483762e-01 | -4.253119e-01 |
| lag_freq(3).Gamma2   | 1.997652e+00 | +1.202348e+00 | -5.976523e-01 |
| lag_freq(3).xi       | 2.999857e+00 | +1.426287e-04 | -2.999857e+00 |
| lag_freq(3).b        | 2.956959e+00 | +4.304086e-02 | -1.987415e-01 |
| lag_freq(3).t_max    | 4.494993e+02 | +3.505007e+02 | -3.994993e+02 |
| lag_freq(3).t_shift  | 2.202826e+01 | +4.405651e+01 | -2.202826e+01 |

** 6 data sets fit

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/mass-fit.sl=

Importing =conf_mass_fit_6data.par=

#+BEGIN_EXAMPLE
isis

source("mass-fit-6data.sl");

[detached from 92773.pts-12.hm00]

source(conf_mass_fit_6data.sl");

#+END_EXAMPLE

Confidence file: =conf_mass_fit_6data.csv=

| lag_freq(1).norm     | 3.970566e+00 | +1.051231e+00 | -2.912490e+00 |
| lag_freq(1).log_mass | 6.000000e+00 | +3.087840e-02 | -0.000000e+00 |
| lag_freq(1).h2       | 1.920475e+01 | +1.470448e-01 | -5.375402e+00 |
| lag_freq(1).Gamma1   | 2.418271e+00 | +6.110168e-02 | -1.042623e-01 |
| lag_freq(1).Gamma2   | 1.838331e+00 | +1.217123e-01 | -9.095575e-02 |
| lag_freq(1).xi       | 2.999984e+00 | +1.600000e-05 | -2.999984e+00 |
| lag_freq(1).b        | 2.404917e+00 | +5.213145e-01 | -2.020788e-01 |
| lag_freq(1).t_max    | 4.268313e+02 | +6.021997e+01 | -9.141763e+01 |
| lag_freq(1).t_shift  | 2.374046e+01 | +4.327633e+00 | -2.248066e+00 |
| lag_freq(2).norm     | 6.181611e-06 | +1.626098e-01 | -6.181611e-06 |
| lag_freq(2).h2       | 1.406980e+01 | +5.930200e+00 | -1.106980e+01 |
| lag_freq(2).Gamma1   | 2.492210e+00 | +8.067900e-01 | -9.922100e-01 |
| lag_freq(2).Gamma2   | 1.819724e+00 | +1.380276e+00 | -4.197240e-01 |
| lag_freq(2).xi       | 2.030804e+00 | +9.691960e-01 | -2.030804e+00 |
| lag_freq(2).b        | 2.584878e+00 | +4.151220e-01 | -1.584878e+00 |
| lag_freq(2).t_max    | 2.261851e+02 | +5.738149e+02 | -1.761851e+02 |
| lag_freq(2).t_shift  | 3.013164e+01 | +8.986836e+01 | -3.013164e+01 |
| lag_freq(3).norm     | 2.766441e+00 | +2.927917e+00 | -1.279725e+00 |
| lag_freq(3).h2       | 1.056730e+01 | +3.055260e+00 | -2.623373e-01 |
| lag_freq(3).Gamma1   | 2.575346e+00 | +3.354700e-01 | -2.517296e-01 |
| lag_freq(3).Gamma2   | 1.844523e+00 | +3.086727e-01 | -1.952719e-01 |
| lag_freq(3).xi       | 1.499929e+00 | +1.500071e+00 | -1.499929e+00 |
| lag_freq(3).b        | 1.978480e+00 | +1.021520e+00 | -8.427509e-01 |
| lag_freq(3).t_max    | 5.727486e+02 | +5.032405e+01 | -2.124358e+02 |
| lag_freq(3).t_shift  | 2.202826e+01 | +6.948905e+00 | -1.330211e+01 |
| lag_freq(4).norm     | 1.249999e+00 | +5.515320e-01 | -6.453110e-01 |
| lag_freq(4).h2       | 1.999999e+01 | +1.000000e-05 | -8.018767e+00 |
| lag_freq(4).Gamma1   | 2.551217e+00 | +1.712515e-01 | -2.086945e-01 |
| lag_freq(4).Gamma2   | 1.997652e+00 | +1.929979e-01 | -1.714188e-01 |
| lag_freq(4).xi       | 2.999857e+00 | +1.430000e-04 | -1.744050e+00 |
| lag_freq(4).b        | 2.853242e+00 | +1.467580e-01 | -1.091129e+00 |
| lag_freq(4).t_max    | 6.884528e+02 | +3.741652e+01 | -1.612376e+02 |
| lag_freq(4).t_shift  | 2.202826e+01 | +8.120659e+00 | -1.208147e+01 |
| lag_freq(5).norm     | 6.249996e-01 | +4.258183e-01 | -2.951669e-01 |
| lag_freq(5).h2       | 1.999999e+01 | +1.000000e-05 | -2.302798e+00 |
| lag_freq(5).Gamma1   | 3.298147e+00 | +8.530000e-04 | -8.581534e-01 |
| lag_freq(5).Gamma2   | 1.549413e+00 | +9.260926e-01 | -9.702137e-02 |
| lag_freq(5).xi       | 2.249964e+00 | +7.500360e-01 | -2.249964e+00 |
| lag_freq(5).b        | 2.956959e+00 | +4.304100e-02 | -1.265002e+00 |
| lag_freq(5).t_max    | 6.247496e+02 | +9.774551e+01 | -1.643313e+02 |
| lag_freq(5).t_shift  | 2.202826e+01 | +1.373425e+01 | -1.293512e+01 |
| lag_freq(6).norm     | 2.302600e+00 | +5.975129e-01 | -4.982644e-01 |
| lag_freq(6).h2       | 1.227589e+01 | +2.538004e+00 | -4.950110e-01 |
| lag_freq(6).Gamma1   | 2.830624e+00 | +3.192562e-01 | -1.492922e-01 |
| lag_freq(6).Gamma2   | 1.728567e+00 | +1.713827e-01 | -5.227118e-02 |
| lag_freq(6).xi       | 2.357100e+00 | +6.429000e-01 | -2.357100e+00 |
| lag_freq(6).b        | 1.818480e+00 | +8.874811e-01 | -3.320351e-01 |
| lag_freq(6).t_max    | 7.110987e+02 | +8.417889e+00 | -1.009506e+01 |
| lag_freq(6).t_shift  | 2.102826e+01 | +5.781282e+00 | -6.638493e+00 |

** 7 data sets fit

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/mass-fit.sl=

Importing =conf_mass_fit_7data.par=

#+BEGIN_EXAMPLE
isis

source("mass-fit-7data.sl");

source(conf_mass_fit_7data.sl");

#+END_EXAMPLE

Confidence file: =conf_mass_fit_7data.csv=

| lag_freq(1).norm     | 3.970566e+00 | +1.299952e+00 | -2.622329e+00 |
| lag_freq(1).log_mass | 6.014430e+00 | +3.019990e-02 | -1.443033e-02 |
| lag_freq(1).h2       | 1.907221e+01 | +2.087339e-01 | -5.135944e+00 |
| lag_freq(1).Gamma1   | 2.418271e+00 | +8.793734e-02 | -7.077170e-02 |
| lag_freq(1).Gamma2   | 1.838331e+00 | +8.870801e-02 | -1.735433e-01 |
| lag_freq(1).xi       | 2.999984e+00 | +1.600000e-05 | -2.999984e+00 |
| lag_freq(1).b        | 2.404917e+00 | +4.259738e-01 | -2.105586e-01 |
| lag_freq(1).t_max    | 4.268313e+02 | +6.471134e+01 | -7.242132e+01 |
| lag_freq(1).t_shift  | 2.374046e+01 | +4.498388e+00 | -1.948905e+00 |
| lag_freq(2).norm     | 6.181611e-06 | +1.545673e-01 | -6.181611e-06 |
| lag_freq(2).h2       | 1.406980e+01 | +5.930200e+00 | -1.106980e+01 |
| lag_freq(2).Gamma1   | 2.492210e+00 | +8.067900e-01 | -9.922100e-01 |
| lag_freq(2).Gamma2   | 1.819724e+00 | +1.380276e+00 | -4.197240e-01 |
| lag_freq(2).xi       | 2.030804e+00 | +9.691960e-01 | -2.030804e+00 |
| lag_freq(2).b        | 2.584878e+00 | +4.151220e-01 | -1.584878e+00 |
| lag_freq(2).t_max    | 2.261851e+02 | +5.738149e+02 | -1.761851e+02 |
| lag_freq(2).t_shift  | 3.013164e+01 | +8.986836e+01 | -3.013164e+01 |
| lag_freq(3).norm     | 2.766441e+00 | +2.653509e+00 | -1.341995e+00 |
| lag_freq(3).h2       | 1.056730e+01 | +2.135827e+00 | -2.751255e-01 |
| lag_freq(3).Gamma1   | 2.575346e+00 | +3.408234e-01 | -2.453432e-01 |
| lag_freq(3).Gamma2   | 1.844523e+00 | +2.965638e-01 | -1.974690e-01 |
| lag_freq(3).xi       | 1.499929e+00 | +1.500071e+00 | -1.499929e+00 |
| lag_freq(3).b        | 1.978480e+00 | +1.021520e+00 | -7.577739e-01 |
| lag_freq(3).t_max    | 5.727486e+02 | +5.118537e+01 | -2.279722e+02 |
| lag_freq(3).t_shift  | 2.202826e+01 | +6.876416e+00 | -1.252778e+01 |
| lag_freq(4).norm     | 1.249999e+00 | +5.293887e-01 | -6.649261e-01 |
| lag_freq(4).h2       | 1.999999e+01 | +1.000000e-05 | -7.917097e+00 |
| lag_freq(4).Gamma1   | 2.551217e+00 | +1.710762e-01 | -2.026959e-01 |
| lag_freq(4).Gamma2   | 1.997652e+00 | +1.882714e-01 | -1.715945e-01 |
| lag_freq(4).xi       | 2.999857e+00 | +1.430000e-04 | -1.693858e+00 |
| lag_freq(4).b        | 2.963310e+00 | +3.668950e-02 | -1.049829e+00 |
| lag_freq(4).t_max    | 6.884528e+02 | +3.784745e+01 | -1.826093e+02 |
| lag_freq(4).t_shift  | 2.202826e+01 | +7.651180e+00 | -1.156651e+01 |
| lag_freq(5).norm     | 6.249996e-01 | +4.395541e-01 | -2.909717e-01 |
| lag_freq(5).h2       | 1.999999e+01 | +1.000000e-05 | -2.315539e+00 |
| lag_freq(5).Gamma1   | 3.298147e+00 | +8.530000e-04 | -8.276028e-01 |
| lag_freq(5).Gamma2   | 1.549413e+00 | +8.713501e-01 | -9.638797e-02 |
| lag_freq(5).xi       | 2.249964e+00 | +7.500360e-01 | -2.249964e+00 |
| lag_freq(5).b        | 2.956959e+00 | +4.304100e-02 | -1.059209e+00 |
| lag_freq(5).t_max    | 6.932119e+02 | +3.024595e+01 | -2.357964e+02 |
| lag_freq(5).t_shift  | 2.202826e+01 | +1.214422e+01 | -1.113891e+01 |
| lag_freq(6).norm     | 2.302600e+00 | +6.772538e-01 | -4.493935e-01 |
| lag_freq(6).h2       | 1.329654e+01 | +5.771093e+00 | -1.494135e+00 |
| lag_freq(6).Gamma1   | 2.830624e+00 | +2.288702e-01 | -1.542561e-01 |
| lag_freq(6).Gamma2   | 1.723110e+00 | +1.786030e-01 | -4.427569e-02 |
| lag_freq(6).xi       | 5.892750e-01 | +2.327174e+00 | -5.892750e-01 |
| lag_freq(6).b        | 2.384039e+00 | +6.159609e-01 | -5.813790e-01 |
| lag_freq(6).t_max    | 7.110987e+02 | +7.593043e+00 | -2.017839e+01 |
| lag_freq(6).t_shift  | 2.102826e+01 | +4.160619e+00 | -6.622829e+00 |
| lag_freq(7).norm     | 1.797167e+00 | +1.453475e+00 | -5.136967e-01 |
| lag_freq(7).h2       | 1.326051e+01 | +6.354682e+00 | -1.443426e+00 |
| lag_freq(7).Gamma1   | 2.473077e+00 | +9.595287e-02 | -1.575461e-01 |
| lag_freq(7).Gamma2   | 1.797652e+00 | +1.971433e-01 | -1.156549e-01 |
| lag_freq(7).xi       | 7.857000e-01 | +1.817173e+00 | -7.857000e-01 |
| lag_freq(7).b        | 2.818480e+00 | +1.815205e-01 | -5.488483e-01 |
| lag_freq(7).t_max    | 6.932413e+02 | +2.146588e+01 | -1.404526e+02 |
| lag_freq(7).t_shift  | 2.102826e+01 | +2.033397e+00 | -4.315310e+00 |

** 8 data sets fit

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/mass-fit.sl=

Importing =conf_mass_fit_8data.par=

#+BEGIN_EXAMPLE
isis

source("mass-fit-8data.sl");

source(conf_mass_fit_8data.sl");

#+END_EXAMPLE

Confidence file: =conf_mass_fit_8data.csv=

| lag_freq(1).norm     | 3.970566e+00 | +1.899736e+00 | -2.282675e+00 |
| lag_freq(1).log_mass | 6.021645e+00 | +1.709976e-02 | -2.164500e-02 |
| lag_freq(1).h2       | 1.907221e+01 | +3.061131e-01 | -5.239438e+00 |
| lag_freq(1).Gamma1   | 2.418271e+00 | +1.044074e-01 | -5.305120e-02 |
| lag_freq(1).Gamma2   | 1.920554e+00 | +6.925314e-02 | -1.360558e-01 |
| lag_freq(1).xi       | 2.999984e+00 | +1.600000e-05 | -2.999984e+00 |
| lag_freq(1).b        | 2.404917e+00 | +2.549656e-01 | -2.274593e-01 |
| lag_freq(1).t_max    | 4.268313e+02 | +8.744101e+01 | -5.281737e+01 |
| lag_freq(1).t_shift  | 2.655619e+01 | +5.170760e+00 | -2.560687e+00 |
| lag_freq(2).norm     | 6.181611e-06 | +1.510027e-01 | -6.181611e-06 |
| lag_freq(2).h2       | 1.406980e+01 | +5.930200e+00 | -1.106980e+01 |
| lag_freq(2).Gamma1   | 2.492210e+00 | +8.067900e-01 | -9.922100e-01 |
| lag_freq(2).Gamma2   | 1.819724e+00 | +1.380276e+00 | -4.197240e-01 |
| lag_freq(2).xi       | 2.030804e+00 | +9.691960e-01 | -2.030804e+00 |
| lag_freq(2).b        | 2.584878e+00 | +4.151220e-01 | -1.584878e+00 |
| lag_freq(2).t_max    | 2.261851e+02 | +5.738149e+02 | -1.761851e+02 |
| lag_freq(2).t_shift  | 3.013164e+01 | +8.986836e+01 | -3.013164e+01 |
| lag_freq(3).norm     | 2.766441e+00 | +2.487124e+00 | -1.386021e+00 |
| lag_freq(3).h2       | 1.056730e+01 | +1.641257e+00 | -2.841070e-01 |
| lag_freq(3).Gamma1   | 2.575346e+00 | +3.434038e-01 | -2.422137e-01 |
| lag_freq(3).Gamma2   | 1.844523e+00 | +2.900367e-01 | -1.990053e-01 |
| lag_freq(3).xi       | 1.499929e+00 | +1.500071e+00 | -1.499929e+00 |
| lag_freq(3).b        | 1.978480e+00 | +1.021520e+00 | -7.171875e-01 |
| lag_freq(3).t_max    | 5.727486e+02 | +5.177865e+01 | -2.391237e+02 |
| lag_freq(3).t_shift  | 2.202826e+01 | +6.768497e+00 | -1.218174e+01 |
| lag_freq(4).norm     | 1.249999e+00 | +5.167459e-01 | -6.754690e-01 |
| lag_freq(4).h2       | 1.999999e+01 | +1.000000e-05 | -8.358283e-01 |
| lag_freq(4).Gamma1   | 2.551217e+00 | +1.726244e-01 | -1.989753e-01 |
| lag_freq(4).Gamma2   | 1.997652e+00 | +1.851816e-01 | -1.733737e-01 |
| lag_freq(4).xi       | 2.999857e+00 | +1.430000e-04 | -1.664706e+00 |
| lag_freq(4).b        | 2.997707e+00 | +2.293125e-03 | -1.010527e+00 |
| lag_freq(4).t_max    | 6.884528e+02 | +3.815747e+01 | -1.947035e+02 |
| lag_freq(4).t_shift  | 2.202826e+01 | +7.557136e+00 | -1.126895e+01 |
| lag_freq(5).norm     | 6.249996e-01 | +4.399995e-01 | -2.897249e-01 |
| lag_freq(5).h2       | 1.999999e+01 | +1.000000e-05 | -2.322101e+00 |
| lag_freq(5).Gamma1   | 3.298147e+00 | +8.530000e-04 | -8.215449e-01 |
| lag_freq(5).Gamma2   | 1.549413e+00 | +8.556022e-01 | -9.621343e-02 |
| lag_freq(5).xi       | 2.249964e+00 | +7.500360e-01 | -2.249964e+00 |
| lag_freq(5).b        | 2.956959e+00 | +4.304100e-02 | -9.988512e-01 |
| lag_freq(5).t_max    | 6.932119e+02 | +3.019312e+01 | -2.384414e+02 |
| lag_freq(5).t_shift  | 2.202826e+01 | +1.169920e+01 | -1.053118e+01 |
| lag_freq(6).norm     | 2.302600e+00 | +6.434946e-01 | -4.604343e-01 |
| lag_freq(6).h2       | 1.329654e+01 | +4.486525e+00 | -1.501561e+00 |
| lag_freq(6).Gamma1   | 2.830624e+00 | +2.236074e-01 | -1.550802e-01 |
| lag_freq(6).Gamma2   | 1.723110e+00 | +1.761333e-01 | -4.477135e-02 |
| lag_freq(6).xi       | 5.892750e-01 | +2.323203e+00 | -5.892750e-01 |
| lag_freq(6).b        | 2.384039e+00 | +6.159610e-01 | -5.365134e-01 |
| lag_freq(6).t_max    | 7.110987e+02 | +7.778579e+00 | -1.087349e+01 |
| lag_freq(6).t_shift  | 2.102826e+01 | +4.151310e+00 | -6.315515e+00 |
| lag_freq(7).norm     | 1.797167e+00 | +1.224593e+00 | -5.479465e-01 |
| lag_freq(7).h2       | 1.357490e+01 | +5.666248e+00 | -1.761933e+00 |
| lag_freq(7).Gamma1   | 2.473077e+00 | +1.079911e-01 | -1.412872e-01 |
| lag_freq(7).Gamma2   | 1.797652e+00 | +1.712533e-01 | -1.199247e-01 |
| lag_freq(7).xi       | 7.857000e-01 | +2.047917e+00 | -7.857000e-01 |
| lag_freq(7).b        | 2.818480e+00 | +1.815200e-01 | -4.488202e-01 |
| lag_freq(7).t_max    | 6.932413e+02 | +2.235992e+01 | -1.541319e+02 |
| lag_freq(7).t_shift  | 2.102826e+01 | +2.313402e+00 | -3.715868e+00 |
| lag_freq(8).norm     | 3.562369e+00 | +1.722750e+00 | -7.375460e-01 |
| lag_freq(8).h2       | 1.144562e+01 | +1.647670e+00 | -6.328998e-01 |
| lag_freq(8).Gamma1   | 2.473077e+00 | +5.864371e-02 | -7.167100e-02 |
| lag_freq(8).Gamma2   | 1.727017e+00 | +9.090342e-02 | -4.669433e-02 |
| lag_freq(8).xi       | 7.857000e-01 | +1.648633e+00 | -7.857000e-01 |
| lag_freq(8).b        | 2.999823e+00 | +1.772656e-04 | -2.301815e-01 |
| lag_freq(8).t_max    | 5.678101e+02 | +3.602607e+01 | -1.970767e+02 |
| lag_freq(8).t_shift  | 1.860273e+01 | +1.407120e+00 | -1.310980e+00 |

** 9 data sets fit

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/mass-fit-9data.sl=

Importing =conf_mass_fit_9data.par=

#+BEGIN_EXAMPLE
isis

source("mass-fit-9data.sl");

source(conf_mass_fit_9data.sl");

#+END_EXAMPLE

Confidence file: =conf_mass_fit_9data.csv=

| lag_freq(1).norm     | 3.970566e+00 | +2.355517e+00 | -2.180355e+00 |
| lag_freq(1).log_mass | 6.010822e+00 | +2.434243e-02 | -1.082250e-02 |
| lag_freq(1).h2       | 1.907221e+01 | +3.546291e-01 | -5.134020e+00 |
| lag_freq(1).Gamma1   | 2.418271e+00 | +1.029019e-01 | -5.554958e-02 |
| lag_freq(1).Gamma2   | 1.920554e+00 | +7.523316e-02 | -1.300722e-01 |
| lag_freq(1).xi       | 2.999984e+00 | +1.600000e-05 | -2.999984e+00 |
| lag_freq(1).b        | 2.404917e+00 | +2.340011e-01 | -2.885321e-01 |
| lag_freq(1).t_max    | 4.268313e+02 | +1.130637e+02 | -4.229520e+01 |
| lag_freq(1).t_shift  | 2.655619e+01 | +5.066416e+00 | -2.868867e+00 |
| lag_freq(2).norm     | 6.181611e-06 | +1.564471e-01 | -6.181611e-06 |
| lag_freq(2).h2       | 1.406980e+01 | +5.930200e+00 | -1.106980e+01 |
| lag_freq(2).Gamma1   | 2.492210e+00 | +8.067900e-01 | -9.922100e-01 |
| lag_freq(2).Gamma2   | 1.819724e+00 | +1.380276e+00 | -4.197240e-01 |
| lag_freq(2).xi       | 2.030804e+00 | +9.691960e-01 | -2.030804e+00 |
| lag_freq(2).b        | 2.584878e+00 | +4.151220e-01 | -1.584878e+00 |
| lag_freq(2).t_max    | 2.261851e+02 | +5.738149e+02 | -1.761851e+02 |
| lag_freq(2).t_shift  | 3.013164e+01 | +8.986836e+01 | -3.013164e+01 |
| lag_freq(3).norm     | 2.766441e+00 | +2.725728e+00 | -1.324125e+00 |
| lag_freq(3).h2       | 1.056730e+01 | +2.362458e+00 | -2.714844e-01 |
| lag_freq(3).Gamma1   | 2.575346e+00 | +3.395995e-01 | -2.469003e-01 |
| lag_freq(3).Gamma2   | 1.844523e+00 | +2.996797e-01 | -1.968421e-01 |
| lag_freq(3).xi       | 1.499929e+00 | +1.500071e+00 | -1.499929e+00 |
| lag_freq(3).b        | 1.978480e+00 | +1.021520e+00 | -7.786053e-01 |
| lag_freq(3).t_max    | 5.727486e+02 | +5.093231e+01 | -2.224135e+02 |
| lag_freq(3).t_shift  | 2.202826e+01 | +6.907115e+00 | -1.271416e+01 |
| lag_freq(4).norm     | 1.249999e+00 | +5.565118e-01 | -6.510745e-01 |
| lag_freq(4).h2       | 1.999999e+01 | +1.000000e-05 | -8.424597e-01 |
| lag_freq(4).Gamma1   | 2.551217e+00 | +1.658318e-01 | -2.073886e-01 |
| lag_freq(4).Gamma2   | 1.997652e+00 | +1.919269e-01 | -1.663291e-01 |
| lag_freq(4).xi       | 2.999857e+00 | +1.430000e-04 | -1.708424e+00 |
| lag_freq(4).b        | 2.997707e+00 | +2.293000e-03 | -1.122240e+00 |
| lag_freq(4).t_max    | 6.884528e+02 | +3.738171e+01 | -1.733427e+02 |
| lag_freq(4).t_shift  | 2.202826e+01 | +7.332468e+00 | -1.199021e+01 |
| lag_freq(5).norm     | 6.249996e-01 | +4.390562e-01 | -2.924072e-01 |
| lag_freq(5).h2       | 1.999999e+01 | +1.000000e-05 | -2.312812e+00 |
| lag_freq(5).Gamma1   | 3.298147e+00 | +8.530000e-04 | -8.317466e-01 |
| lag_freq(5).Gamma2   | 1.549413e+00 | +8.805670e-01 | -9.660262e-02 |
| lag_freq(5).xi       | 2.249964e+00 | +7.500360e-01 | -2.249964e+00 |
| lag_freq(5).b        | 2.956959e+00 | +4.304100e-02 | -1.093340e+00 |
| lag_freq(5).t_max    | 6.932119e+02 | +3.030492e+01 | -2.359449e+02 |
| lag_freq(5).t_shift  | 2.202826e+01 | +1.241994e+01 | -1.148972e+01 |
| lag_freq(6).norm     | 2.302600e+00 | +6.973883e-01 | -4.431495e-01 |
| lag_freq(6).h2       | 1.329654e+01 | +5.922096e+00 | -1.489833e+00 |
| lag_freq(6).Gamma1   | 2.830624e+00 | +2.318523e-01 | -1.538609e-01 |
| lag_freq(6).Gamma2   | 1.723110e+00 | +1.800515e-01 | -4.399333e-02 |
| lag_freq(6).xi       | 5.892750e-01 | +2.329166e+00 | -5.892750e-01 |
| lag_freq(6).b        | 2.384039e+00 | +5.943242e-01 | -6.067138e-01 |
| lag_freq(6).t_max    | 7.110987e+02 | +7.487772e+00 | -2.544110e+01 |
| lag_freq(6).t_shift  | 2.102826e+01 | +4.150216e+00 | -6.804342e+00 |
| lag_freq(7).norm     | 1.797167e+00 | +1.349773e+00 | -5.277235e-01 |
| lag_freq(7).h2       | 1.357490e+01 | +6.092022e+00 | -1.744260e+00 |
| lag_freq(7).Gamma1   | 2.473077e+00 | +1.033518e-01 | -1.479297e-01 |
| lag_freq(7).Gamma2   | 1.797652e+00 | +1.840997e-01 | -1.180715e-01 |
| lag_freq(7).xi       | 7.857000e-01 | +2.017054e+00 | -7.857000e-01 |
| lag_freq(7).b        | 2.818480e+00 | +1.815200e-01 | -5.166538e-01 |
| lag_freq(7).t_max    | 6.932413e+02 | +2.185178e+01 | -1.416856e+02 |
| lag_freq(7).t_shift  | 2.102826e+01 | +2.201793e+00 | -4.034642e+00 |
| lag_freq(8).norm     | 3.562369e+00 | +1.600133e+00 | -7.631857e-01 |
| lag_freq(8).h2       | 1.144562e+01 | +1.829570e+00 | -6.364686e-01 |
| lag_freq(8).Gamma1   | 2.473077e+00 | +5.309217e-02 | -7.766935e-02 |
| lag_freq(8).Gamma2   | 1.727017e+00 | +9.865944e-02 | -4.707443e-02 |
| lag_freq(8).xi       | 7.857000e-01 | +1.618913e+00 | -7.857000e-01 |
| lag_freq(8).b        | 2.999823e+00 | +1.770000e-04 | -2.512854e-01 |
| lag_freq(8).t_max    | 5.678101e+02 | +4.258999e+01 | -1.071359e+02 |
| lag_freq(8).t_shift  | 1.860273e+01 | +1.392192e+00 | -1.412116e+00 |
| lag_freq(9).norm     | 4.647981e+00 | +1.691070e+00 | -1.012670e+00 |
| lag_freq(9).h2       | 1.144562e+01 | +1.097902e+00 | -6.656735e-01 |
| lag_freq(9).Gamma1   | 2.473077e+00 | +7.621678e-02 | -4.044563e-02 |
| lag_freq(9).Gamma2   | 1.727017e+00 | +5.586911e-02 | -5.067451e-02 |
| lag_freq(9).xi       | 7.857000e-01 | +1.818245e+00 | -7.857000e-01 |
| lag_freq(9).b        | 2.999956e+00 | +4.425000e-05 | -1.901576e-01 |
| lag_freq(9).t_max    | 5.398716e+02 | +4.741971e+01 | -6.703924e+01 |
| lag_freq(9).t_shift  | 1.860273e+01 | +1.668049e+00 | -8.928274e-01 |

** 10 data sets fit

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/mass-fit-10data.sl=

Importing =conf_mass_fit_9data.par=

#+BEGIN_EXAMPLE
isis

source("mass-fit-10data.sl");

source(conf_mass_fit_10data.sl");

#+END_EXAMPLE

Confidence file: =conf_mass_fit_10data.csv=

| lag_freq(1).norm     | 3.970566e+00 | +2.746357e+00 | -1.960987e+00 |
| lag_freq(1).log_mass | 6.009131e+00 | +2.130879e-02 | -9.131484e-03 |
| lag_freq(1).h2       | 1.497875e+01 | +4.338919e+00 | -1.761029e+00 |
| lag_freq(1).Gamma1   | 2.350429e+00 | +6.471215e-02 | -6.732262e-02 |
| lag_freq(1).Gamma2   | 1.920554e+00 | +8.463218e-02 | -8.269293e-02 |
| lag_freq(1).xi       | 2.624994e+00 | +3.750060e-01 | -2.624994e+00 |
| lag_freq(1).b        | 2.404917e+00 | +2.067856e-01 | -2.467187e-01 |
| lag_freq(1).t_max    | 4.945709e+02 | +8.069687e+01 | -6.740971e+01 |
| lag_freq(1).t_shift  | 3.076710e+01 | +2.071506e+00 | -4.389827e+00 |
| lag_freq(2).norm     | 6.181611e-06 | +1.573510e-01 | -6.181611e-06 |
| lag_freq(2).h2       | 1.406980e+01 | +5.930200e+00 | -1.106980e+01 |
| lag_freq(2).Gamma1   | 2.492210e+00 | +8.067900e-01 | -9.922100e-01 |
| lag_freq(2).Gamma2   | 1.819724e+00 | +1.380276e+00 | -4.197240e-01 |
| lag_freq(2).xi       | 2.030804e+00 | +9.691960e-01 | -2.030804e+00 |
| lag_freq(2).b        | 2.584878e+00 | +4.151220e-01 | -1.584878e+00 |
| lag_freq(2).t_max    | 2.261851e+02 | +5.738149e+02 | -1.761851e+02 |
| lag_freq(2).t_shift  | 3.013164e+01 | +8.986836e+01 | -3.013164e+01 |
| lag_freq(3).norm     | 2.766441e+00 | +2.759525e+00 | -1.316223e+00 |
| lag_freq(3).h2       | 1.056730e+01 | +2.473293e+00 | -2.698745e-01 |
| lag_freq(3).Gamma1   | 2.575346e+00 | +3.389826e-01 | -2.476285e-01 |
| lag_freq(3).Gamma2   | 1.844523e+00 | +3.011534e-01 | -1.965643e-01 |
| lag_freq(3).xi       | 1.499929e+00 | +1.500071e+00 | -1.499929e+00 |
| lag_freq(3).b        | 1.978480e+00 | +1.021520e+00 | -7.887275e-01 |
| lag_freq(3).t_max    | 5.727486e+02 | +5.082730e+01 | -2.206292e+02 |
| lag_freq(3).t_shift  | 2.202826e+01 | +6.919225e+00 | -1.280417e+01 |
| lag_freq(4).norm     | 1.249999e+00 | +5.638819e-01 | -6.470316e-01 |
| lag_freq(4).h2       | 1.999999e+01 | +1.000000e-05 | -8.432016e-01 |
| lag_freq(4).Gamma1   | 2.551217e+00 | +1.648567e-01 | -2.087180e-01 |
| lag_freq(4).Gamma2   | 1.997652e+00 | +1.929687e-01 | -1.653240e-01 |
| lag_freq(4).xi       | 2.999857e+00 | +1.430000e-04 | -1.714689e+00 |
| lag_freq(4).b        | 2.997707e+00 | +2.293000e-03 | -1.139701e+00 |
| lag_freq(4).t_max    | 6.884528e+02 | +3.726087e+01 | -1.700660e+02 |
| lag_freq(4).t_shift  | 2.202826e+01 | +7.296561e+00 | -1.210659e+01 |
| lag_freq(5).norm     | 6.249996e-01 | +4.388407e-01 | -2.931739e-01 |
| lag_freq(5).h2       | 1.999999e+01 | +1.000000e-05 | -2.311449e+00 |
| lag_freq(5).Gamma1   | 3.298147e+00 | +8.530000e-04 | -8.337644e-01 |
| lag_freq(5).Gamma2   | 1.549413e+00 | +8.849837e-01 | -9.671784e-02 |
| lag_freq(5).xi       | 2.249964e+00 | +7.500360e-01 | -2.249964e+00 |
| lag_freq(5).b        | 2.956959e+00 | +4.304100e-02 | -1.109896e+00 |
| lag_freq(5).t_max    | 6.932119e+02 | +3.033940e+01 | -2.363539e+02 |
| lag_freq(5).t_shift  | 2.202826e+01 | +1.255818e+01 | -1.166166e+01 |
| lag_freq(6).norm     | 2.302600e+00 | +7.063285e-01 | -4.404847e-01 |
| lag_freq(6).h2       | 1.329654e+01 | +5.998943e+00 | -1.487894e+00 |
| lag_freq(6).Gamma1   | 2.830624e+00 | +2.329554e-01 | -1.537812e-01 |
| lag_freq(6).Gamma2   | 1.723110e+00 | +1.808833e-01 | -4.387127e-02 |
| lag_freq(6).xi       | 5.892750e-01 | +2.329327e+00 | -5.892750e-01 |
| lag_freq(6).b        | 2.384039e+00 | +5.827640e-01 | -6.189715e-01 |
| lag_freq(6).t_max    | 7.110987e+02 | +7.442688e+00 | -2.731723e+01 |
| lag_freq(6).t_shift  | 2.102826e+01 | +4.139344e+00 | -6.894182e+00 |
| lag_freq(7).norm     | 1.797167e+00 | +1.360826e+00 | -5.268062e-01 |
| lag_freq(7).h2       | 1.357490e+01 | +6.147553e+00 | -1.743181e+00 |
| lag_freq(7).Gamma1   | 2.473077e+00 | +1.027917e-01 | -1.487880e-01 |
| lag_freq(7).Gamma2   | 1.797652e+00 | +1.857364e-01 | -1.179448e-01 |
| lag_freq(7).xi       | 7.857000e-01 | +2.013027e+00 | -7.857000e-01 |
| lag_freq(7).b        | 2.818480e+00 | +1.815200e-01 | -5.262876e-01 |
| lag_freq(7).t_max    | 6.932413e+02 | +2.182473e+01 | -1.406804e+02 |
| lag_freq(7).t_shift  | 2.102826e+01 | +2.192002e+00 | -4.078397e+00 |
| lag_freq(8).norm     | 3.562369e+00 | +1.428848e+00 | -8.116974e-01 |
| lag_freq(8).h2       | 1.144562e+01 | +1.700785e+00 | -6.535678e-01 |
| lag_freq(8).Gamma1   | 2.473077e+00 | +5.615207e-02 | -7.280579e-02 |
| lag_freq(8).Gamma2   | 1.727017e+00 | +9.177436e-02 | -4.886215e-02 |
| lag_freq(8).xi       | 1.992127e+00 | +4.081066e-01 | -1.992127e+00 |
| lag_freq(8).b        | 2.999823e+00 | +1.770000e-04 | -2.295297e-01 |
| lag_freq(8).t_max    | 5.678101e+02 | +4.373694e+01 | -1.095649e+02 |
| lag_freq(8).t_shift  | 1.860273e+01 | +1.524884e+00 | -1.287281e+00 |
| lag_freq(9).norm     | 4.644211e+00 | +1.685832e+00 | -1.012708e+00 |
| lag_freq(9).h2       | 1.144562e+01 | +1.117045e+00 | -6.653125e-01 |
| lag_freq(9).Gamma1   | 2.473077e+00 | +7.533000e-02 | -4.095440e-02 |
| lag_freq(9).Gamma2   | 1.727017e+00 | +5.665730e-02 | -5.063673e-02 |
| lag_freq(9).xi       | 7.857000e-01 | +1.811780e+00 | -7.857000e-01 |
| lag_freq(9).b        | 2.999956e+00 | +4.425000e-05 | -1.942850e-01 |
| lag_freq(9).t_max    | 5.395535e+02 | +4.929969e+01 | -6.555221e+01 |
| lag_freq(9).t_shift  | 1.860273e+01 | +1.659725e+00 | -9.081143e-01 |
| lag_freq(10).norm    | 5.896890e+00 | +2.723111e+00 | -1.087993e+00 |
| lag_freq(10).h2      | 1.144562e+01 | +1.264318e+00 | -6.145316e-01 |
| lag_freq(10).Gamma1  | 2.486325e+00 | +5.114069e-02 | -4.096330e-02 |
| lag_freq(10).Gamma2  | 1.727017e+00 | +5.485243e-02 | -4.557353e-02 |
| lag_freq(10).xi      | 2.357100e+00 | +3.734701e-01 | -2.357100e+00 |
| lag_freq(10).b       | 2.999978e+00 | +2.212500e-05 | -1.977587e-01 |
| lag_freq(10).t_max   | 3.361253e+02 | +4.164771e+01 | -3.289276e+01 |
| lag_freq(10).t_shift | 1.673007e+01 | +1.082244e+00 | -7.366539e-01 |

** 11 data sets fit

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/mass-fit-11data.sl=

Importing =conf_mass_fit_11data.par=

#+BEGIN_EXAMPLE
isis

source("mass-fit-11data.sl");

source(conf_mass_fit_11data.sl");

#+END_EXAMPLE

Confidence file: =conf_mass_fit_11data.csv=

| lag_freq(1).norm     | 3.970566e+00 | +2.746438e+00 | -1.960972e+00 |
| lag_freq(1).log_mass | 6.009131e+00 | +1.967292e-02 | -9.131000e-03 |
| lag_freq(1).h2       | 1.497875e+01 | +4.338929e+00 | -1.761022e+00 |
| lag_freq(1).Gamma1   | 2.350429e+00 | +6.471184e-02 | -6.732295e-02 |
| lag_freq(1).Gamma2   | 1.920554e+00 | +8.463305e-02 | -8.269217e-02 |
| lag_freq(1).xi       | 2.624994e+00 | +3.750060e-01 | -2.624994e+00 |
| lag_freq(1).b        | 2.404917e+00 | +2.067818e-01 | -2.467239e-01 |
| lag_freq(1).t_max    | 4.945709e+02 | +8.069798e+01 | -6.740935e+01 |
| lag_freq(1).t_shift  | 3.076710e+01 | +2.071565e+00 | -4.389853e+00 |
| lag_freq(2).norm     | 6.181611e-06 | +1.573513e-01 | -6.181611e-06 |
| lag_freq(2).h2       | 1.406980e+01 | +5.930200e+00 | -1.106980e+01 |
| lag_freq(2).Gamma1   | 2.492210e+00 | +8.067900e-01 | -9.922100e-01 |
| lag_freq(2).Gamma2   | 1.819724e+00 | +1.380276e+00 | -4.197240e-01 |
| lag_freq(2).xi       | 2.030804e+00 | +9.691960e-01 | -2.030804e+00 |
| lag_freq(2).b        | 2.584878e+00 | +4.151220e-01 | -1.584878e+00 |
| lag_freq(2).t_max    | 2.261851e+02 | +5.738149e+02 | -1.761851e+02 |
| lag_freq(2).t_shift  | 3.013164e+01 | +8.986836e+01 | -3.013164e+01 |
| lag_freq(3).norm     | 2.766441e+00 | +2.759535e+00 | -1.316220e+00 |
| lag_freq(3).h2       | 1.056730e+01 | +2.473325e+00 | -2.698740e-01 |
| lag_freq(3).Gamma1   | 2.575346e+00 | +3.389823e-01 | -2.476288e-01 |
| lag_freq(3).Gamma2   | 1.844523e+00 | +3.011540e-01 | -1.965642e-01 |
| lag_freq(3).xi       | 1.499929e+00 | +1.500071e+00 | -1.499929e+00 |
| lag_freq(3).b        | 1.978480e+00 | +1.021520e+00 | -7.887304e-01 |
| lag_freq(3).t_max    | 5.727486e+02 | +5.082728e+01 | -2.206287e+02 |
| lag_freq(3).t_shift  | 2.202826e+01 | +6.919227e+00 | -1.280419e+01 |
| lag_freq(4).norm     | 1.249999e+00 | +5.638840e-01 | -6.470306e-01 |
| lag_freq(4).h2       | 1.999999e+01 | +1.000000e-05 | -8.432017e-01 |
| lag_freq(4).Gamma1   | 2.551217e+00 | +1.648563e-01 | -2.087184e-01 |
| lag_freq(4).Gamma2   | 1.997652e+00 | +1.929689e-01 | -1.653236e-01 |
| lag_freq(4).xi       | 2.999857e+00 | +1.430000e-04 | -1.714691e+00 |
| lag_freq(4).b        | 2.997707e+00 | +2.293000e-03 | -1.139706e+00 |
| lag_freq(4).t_max    | 6.884528e+02 | +3.726088e+01 | -1.700651e+02 |
| lag_freq(4).t_shift  | 2.202826e+01 | +7.296550e+00 | -1.210663e+01 |
| lag_freq(5).norm     | 6.249996e-01 | +4.388406e-01 | -2.931742e-01 |
| lag_freq(5).h2       | 1.999999e+01 | +1.000000e-05 | -2.311448e+00 |
| lag_freq(5).Gamma1   | 3.298147e+00 | +8.530000e-04 | -8.337650e-01 |
| lag_freq(5).Gamma2   | 1.549413e+00 | +8.849849e-01 | -9.671787e-02 |
| lag_freq(5).xi       | 2.249964e+00 | +7.500360e-01 | -2.249964e+00 |
| lag_freq(5).b        | 2.956959e+00 | +4.304100e-02 | -1.109901e+00 |
| lag_freq(5).t_max    | 6.932119e+02 | +3.033939e+01 | -2.363540e+02 |
| lag_freq(5).t_shift  | 2.202826e+01 | +1.255822e+01 | -1.166171e+01 |
| lag_freq(6).norm     | 2.302600e+00 | +7.063310e-01 | -4.404839e-01 |
| lag_freq(6).h2       | 1.329654e+01 | +5.998966e+00 | -1.487893e+00 |
| lag_freq(6).Gamma1   | 2.830624e+00 | +2.329558e-01 | -1.537812e-01 |
| lag_freq(6).Gamma2   | 1.723110e+00 | +1.808835e-01 | -4.387116e-02 |
| lag_freq(6).xi       | 5.892750e-01 | +2.329327e+00 | -5.892750e-01 |
| lag_freq(6).b        | 2.384039e+00 | +5.827607e-01 | -6.189749e-01 |
| lag_freq(6).t_max    | 7.110987e+02 | +7.442710e+00 | -2.731773e+01 |
| lag_freq(6).t_shift  | 2.102826e+01 | +4.139340e+00 | -6.894208e+00 |
| lag_freq(7).norm     | 1.797167e+00 | +1.360829e+00 | -5.268060e-01 |
| lag_freq(7).h2       | 1.357490e+01 | +6.147569e+00 | -1.743181e+00 |
| lag_freq(7).Gamma1   | 2.473077e+00 | +1.027916e-01 | -1.487882e-01 |
| lag_freq(7).Gamma2   | 1.797652e+00 | +1.857369e-01 | -1.179447e-01 |
| lag_freq(7).xi       | 7.857000e-01 | +2.013026e+00 | -7.857000e-01 |
| lag_freq(7).b        | 2.818480e+00 | +1.815200e-01 | -5.262902e-01 |
| lag_freq(7).t_max    | 6.932413e+02 | +2.182472e+01 | -1.406801e+02 |
| lag_freq(7).t_shift  | 2.102826e+01 | +2.191999e+00 | -4.078409e+00 |
| lag_freq(8).norm     | 3.562369e+00 | +1.428842e+00 | -8.116993e-01 |
| lag_freq(8).h2       | 1.144562e+01 | +1.700792e+00 | -6.535682e-01 |
| lag_freq(8).Gamma1   | 2.473077e+00 | +5.615184e-02 | -7.280592e-02 |
| lag_freq(8).Gamma2   | 1.727017e+00 | +9.177469e-02 | -4.886216e-02 |
| lag_freq(8).xi       | 1.992127e+00 | +4.081057e-01 | -1.992127e+00 |
| lag_freq(8).b        | 2.999823e+00 | +1.770000e-04 | -2.295307e-01 |
| lag_freq(8).t_max    | 5.678101e+02 | +4.373722e+01 | -1.095645e+02 |
| lag_freq(8).t_shift  | 1.860273e+01 | +1.524882e+00 | -1.287286e+00 |
| lag_freq(9).norm     | 4.644211e+00 | +1.685829e+00 | -1.012708e+00 |
| lag_freq(9).h2       | 1.144562e+01 | +1.117050e+00 | -6.653131e-01 |
| lag_freq(9).Gamma1   | 2.473077e+00 | +7.532968e-02 | -4.095470e-02 |
| lag_freq(9).Gamma2   | 1.727017e+00 | +5.665758e-02 | -5.063671e-02 |
| lag_freq(9).xi       | 7.857000e-01 | +1.811778e+00 | -7.857000e-01 |
| lag_freq(9).b        | 2.999956e+00 | +4.400000e-05 | -1.942862e-01 |
| lag_freq(9).t_max    | 5.395535e+02 | +4.930025e+01 | -6.555186e+01 |
| lag_freq(9).t_shift  | 1.860273e+01 | +1.659723e+00 | -9.081181e-01 |
| lag_freq(10).norm    | 5.896890e+00 | +2.723114e+00 | -1.087993e+00 |
| lag_freq(10).h2      | 1.144562e+01 | +1.264328e+00 | -6.145312e-01 |
| lag_freq(10).Gamma1  | 2.486325e+00 | +5.114042e-02 | -4.096346e-02 |
| lag_freq(10).Gamma2  | 1.727017e+00 | +5.485283e-02 | -4.557347e-02 |
| lag_freq(10).xi      | 2.357100e+00 | +3.734676e-01 | -2.357100e+00 |
| lag_freq(10).b       | 2.999978e+00 | +2.200000e-05 | -1.977601e-01 |
| lag_freq(10).t_max   | 3.361253e+02 | +4.164817e+01 | -3.289254e+01 |
| lag_freq(10).t_shift | 1.673007e+01 | +1.082239e+00 | -7.366588e-01 |
| lag_freq(11).norm    | 5.157551e+00 | +2.782995e+00 | -2.360677e+00 |
| lag_freq(11).h2      | 7.222810e+00 | +1.257230e+00 | -1.394807e+00 |
| lag_freq(11).Gamma1  | 2.602301e+00 | +7.065740e-02 | -8.058267e-02 |
| lag_freq(11).Gamma2  | 1.727017e+00 | +1.317571e-01 | -1.114819e-01 |
| lag_freq(11).xi      | 2.251726e+00 | +3.798363e-01 | -2.251726e+00 |
| lag_freq(11).b       | 2.887321e+00 | +1.126793e-01 | -5.912368e-01 |
| lag_freq(11).t_max   | 1.930626e+02 | +3.224851e+01 | -3.261650e+01 |
| lag_freq(11).t_shift | 1.417592e+01 | +1.056499e+00 | -1.239836e+00 |

** 12 data sets fit

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/mass-fit-12data.sl=

Importing =conf_mass_fit_12data.par=

#+BEGIN_EXAMPLE
isis

source("mass-fit-12data.sl");

source(conf_mass_fit_12data.sl");

#+END_EXAMPLE

Confidence file: =conf_mass_fit_12data.csv=

| lag_freq(1).norm     | 3.970566e+00 | +2.746438e+00 | -1.960972e+00 |
| lag_freq(1).log_mass | 6.009131e+00 | +1.987305e-02 | -9.131000e-03 |
| lag_freq(1).h2       | 1.497875e+01 | +4.338929e+00 | -1.761022e+00 |
| lag_freq(1).Gamma1   | 2.350429e+00 | +6.471184e-02 | -6.732295e-02 |
| lag_freq(1).Gamma2   | 1.920554e+00 | +8.463305e-02 | -8.269217e-02 |
| lag_freq(1).xi       | 2.624994e+00 | +3.750060e-01 | -2.624994e+00 |
| lag_freq(1).b        | 2.404917e+00 | +2.067818e-01 | -2.467239e-01 |
| lag_freq(1).t_max    | 4.945709e+02 | +8.069798e+01 | -6.740935e+01 |
| lag_freq(1).t_shift  | 3.076710e+01 | +2.071565e+00 | -4.389853e+00 |
| lag_freq(2).norm     | 6.181611e-06 | +1.573513e-01 | -6.181611e-06 |
| lag_freq(2).h2       | 1.406980e+01 | +5.930200e+00 | -1.106980e+01 |
| lag_freq(2).Gamma1   | 2.492210e+00 | +8.067900e-01 | -9.922100e-01 |
| lag_freq(2).Gamma2   | 1.819724e+00 | +1.380276e+00 | -4.197240e-01 |
| lag_freq(2).xi       | 2.030804e+00 | +9.691960e-01 | -2.030804e+00 |
| lag_freq(2).b        | 2.584878e+00 | +4.151220e-01 | -1.584878e+00 |
| lag_freq(2).t_max    | 2.261851e+02 | +5.738149e+02 | -1.761851e+02 |
| lag_freq(2).t_shift  | 3.013164e+01 | +8.986836e+01 | -3.013164e+01 |
| lag_freq(3).norm     | 2.766441e+00 | +2.759535e+00 | -1.316220e+00 |
| lag_freq(3).h2       | 1.056730e+01 | +2.473325e+00 | -2.698740e-01 |
| lag_freq(3).Gamma1   | 2.575346e+00 | +3.389823e-01 | -2.476288e-01 |
| lag_freq(3).Gamma2   | 1.844523e+00 | +3.011540e-01 | -1.965642e-01 |
| lag_freq(3).xi       | 1.499929e+00 | +1.500071e+00 | -1.499929e+00 |
| lag_freq(3).b        | 1.978480e+00 | +1.021520e+00 | -7.887304e-01 |
| lag_freq(3).t_max    | 5.727486e+02 | +5.082728e+01 | -2.206287e+02 |
| lag_freq(3).t_shift  | 2.202826e+01 | +6.919227e+00 | -1.280419e+01 |
| lag_freq(4).norm     | 1.249999e+00 | +5.638840e-01 | -6.470306e-01 |
| lag_freq(4).h2       | 1.999999e+01 | +1.000000e-05 | -8.432017e-01 |
| lag_freq(4).Gamma1   | 2.551217e+00 | +1.648563e-01 | -2.087184e-01 |
| lag_freq(4).Gamma2   | 1.997652e+00 | +1.929689e-01 | -1.653236e-01 |
| lag_freq(4).xi       | 2.999857e+00 | +1.430000e-04 | -1.714691e+00 |
| lag_freq(4).b        | 2.997707e+00 | +2.293000e-03 | -1.139706e+00 |
| lag_freq(4).t_max    | 6.884528e+02 | +3.726088e+01 | -1.700651e+02 |
| lag_freq(4).t_shift  | 2.202826e+01 | +7.296550e+00 | -1.210663e+01 |
| lag_freq(5).norm     | 6.249996e-01 | +4.388406e-01 | -2.931742e-01 |
| lag_freq(5).h2       | 1.999999e+01 | +1.000000e-05 | -2.311448e+00 |
| lag_freq(5).Gamma1   | 3.298147e+00 | +8.530000e-04 | -8.337650e-01 |
| lag_freq(5).Gamma2   | 1.549413e+00 | +8.849849e-01 | -9.671787e-02 |
| lag_freq(5).xi       | 2.249964e+00 | +7.500360e-01 | -2.249964e+00 |
| lag_freq(5).b        | 2.956959e+00 | +4.304100e-02 | -1.109901e+00 |
| lag_freq(5).t_max    | 6.932119e+02 | +3.033939e+01 | -2.363540e+02 |
| lag_freq(5).t_shift  | 2.202826e+01 | +1.255822e+01 | -1.166171e+01 |
| lag_freq(6).norm     | 2.302600e+00 | +7.063310e-01 | -4.404839e-01 |
| lag_freq(6).h2       | 1.329654e+01 | +5.998966e+00 | -1.487893e+00 |
| lag_freq(6).Gamma1   | 2.830624e+00 | +2.329558e-01 | -1.537812e-01 |
| lag_freq(6).Gamma2   | 1.723110e+00 | +1.808835e-01 | -4.387116e-02 |
| lag_freq(6).xi       | 5.892750e-01 | +2.329327e+00 | -5.892750e-01 |
| lag_freq(6).b        | 2.384039e+00 | +5.827607e-01 | -6.189749e-01 |
| lag_freq(6).t_max    | 7.110987e+02 | +7.442710e+00 | -2.731773e+01 |
| lag_freq(6).t_shift  | 2.102826e+01 | +4.139340e+00 | -6.894208e+00 |
| lag_freq(7).norm     | 1.797167e+00 | +1.360829e+00 | -5.268060e-01 |
| lag_freq(7).h2       | 1.357490e+01 | +6.147569e+00 | -1.743181e+00 |
| lag_freq(7).Gamma1   | 2.473077e+00 | +1.027916e-01 | -1.487882e-01 |
| lag_freq(7).Gamma2   | 1.797652e+00 | +1.857369e-01 | -1.179447e-01 |
| lag_freq(7).xi       | 7.857000e-01 | +2.013026e+00 | -7.857000e-01 |
| lag_freq(7).b        | 2.818480e+00 | +1.815200e-01 | -5.262902e-01 |
| lag_freq(7).t_max    | 6.932413e+02 | +2.182472e+01 | -1.406801e+02 |
| lag_freq(7).t_shift  | 2.102826e+01 | +2.191999e+00 | -4.078409e+00 |
| lag_freq(8).norm     | 3.562369e+00 | +1.428842e+00 | -8.116993e-01 |
| lag_freq(8).h2       | 1.144562e+01 | +1.700792e+00 | -6.535682e-01 |
| lag_freq(8).Gamma1   | 2.473077e+00 | +5.615184e-02 | -7.280592e-02 |
| lag_freq(8).Gamma2   | 1.727017e+00 | +9.177469e-02 | -4.886216e-02 |
| lag_freq(8).xi       | 1.992127e+00 | +4.081057e-01 | -1.992127e+00 |
| lag_freq(8).b        | 2.999823e+00 | +1.770000e-04 | -2.295307e-01 |
| lag_freq(8).t_max    | 5.678101e+02 | +4.373722e+01 | -1.095645e+02 |
| lag_freq(8).t_shift  | 1.860273e+01 | +1.524882e+00 | -1.287286e+00 |
| lag_freq(9).norm     | 4.644211e+00 | +1.685829e+00 | -1.012708e+00 |
| lag_freq(9).h2       | 1.144562e+01 | +1.117050e+00 | -6.653131e-01 |
| lag_freq(9).Gamma1   | 2.473077e+00 | +7.532968e-02 | -4.095470e-02 |
| lag_freq(9).Gamma2   | 1.727017e+00 | +5.665758e-02 | -5.063671e-02 |
| lag_freq(9).xi       | 7.857000e-01 | +1.811778e+00 | -7.857000e-01 |
| lag_freq(9).b        | 2.999956e+00 | +4.400000e-05 | -1.942862e-01 |
| lag_freq(9).t_max    | 5.395535e+02 | +4.930025e+01 | -6.555186e+01 |
| lag_freq(9).t_shift  | 1.860273e+01 | +1.659723e+00 | -9.081181e-01 |
| lag_freq(10).norm    | 5.896890e+00 | +2.723114e+00 | -1.087993e+00 |
| lag_freq(10).h2      | 1.144562e+01 | +1.264328e+00 | -6.145312e-01 |
| lag_freq(10).Gamma1  | 2.486325e+00 | +5.114042e-02 | -4.096346e-02 |
| lag_freq(10).Gamma2  | 1.727017e+00 | +5.485283e-02 | -4.557347e-02 |
| lag_freq(10).xi      | 2.357100e+00 | +3.734676e-01 | -2.357100e+00 |
| lag_freq(10).b       | 2.999978e+00 | +2.200000e-05 | -1.977601e-01 |
| lag_freq(10).t_max   | 3.361253e+02 | +4.164817e+01 | -3.289254e+01 |
| lag_freq(10).t_shift | 1.673007e+01 | +1.082239e+00 | -7.366588e-01 |
| lag_freq(11).norm    | 5.157551e+00 | +2.783007e+00 | -2.360673e+00 |
| lag_freq(11).h2      | 7.222810e+00 | +1.257227e+00 | -1.394813e+00 |
| lag_freq(11).Gamma1  | 2.602301e+00 | +7.065758e-02 | -8.058225e-02 |
| lag_freq(11).Gamma2  | 1.727017e+00 | +1.317564e-01 | -1.114824e-01 |
| lag_freq(11).xi      | 2.251726e+00 | +3.798380e-01 | -2.251726e+00 |
| lag_freq(11).b       | 2.887321e+00 | +1.126790e-01 | -5.912362e-01 |
| lag_freq(11).t_max   | 1.930626e+02 | +3.224858e+01 | -3.261651e+01 |
| lag_freq(11).t_shift | 1.417592e+01 | +1.056502e+00 | -1.239833e+00 |
| lag_freq(12).norm    | 8.605624e-02 | +1.358582e-01 | -7.259179e-02 |
| lag_freq(12).h2      | 1.999993e+01 | +6.609451e-05 | -5.811413e+00 |
| lag_freq(12).Gamma1  | 2.051151e+00 | +4.600832e-01 | -3.335324e-01 |
| lag_freq(12).Gamma2  | 1.563508e+00 | +1.502741e+00 | -1.475766e-01 |
| lag_freq(12).xi      | 3.518322e-02 | +2.964817e+00 | -3.518322e-02 |
| lag_freq(12).b       | 2.999560e+00 | +4.401523e-04 | -1.999560e+00 |
| lag_freq(12).t_max   | 1.930626e+02 | +2.349437e+02 | -1.279602e+02 |
| lag_freq(12).t_shift | 8.126388e+01 | +3.873612e+01 | -1.492186e+01 |

** 13 data sets fit

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/mass-fit-13data.sl=

Importing =conf_mass_fit_13data.par=

#+BEGIN_EXAMPLE
isis

source("mass-fit-13data.sl");

source(conf_mass_fit_13data.sl");

#+END_EXAMPLE

Confidence file: =conf_mass_fit_13data.csv=

| lag_freq(1).norm     | 3.970566e+00 | +2.746438e+00 | -1.960972e+00 |
| lag_freq(1).log_mass | 6.009131e+00 | +1.855783e-02 | -9.131000e-03 |
| lag_freq(1).h2       | 1.497875e+01 | +4.338929e+00 | -1.761022e+00 |
| lag_freq(1).Gamma1   | 2.350429e+00 | +6.471184e-02 | -6.732295e-02 |
| lag_freq(1).Gamma2   | 1.920554e+00 | +8.463305e-02 | -8.269217e-02 |
| lag_freq(1).xi       | 2.624994e+00 | +3.750060e-01 | -2.624994e+00 |
| lag_freq(1).b        | 2.404917e+00 | +2.067818e-01 | -2.467239e-01 |
| lag_freq(1).t_max    | 4.945709e+02 | +8.069798e+01 | -6.740935e+01 |
| lag_freq(1).t_shift  | 3.076710e+01 | +2.071565e+00 | -4.389853e+00 |
| lag_freq(2).norm     | 6.181611e-06 | +1.573513e-01 | -6.181611e-06 |
| lag_freq(2).h2       | 1.406980e+01 | +5.930200e+00 | -1.106980e+01 |
| lag_freq(2).Gamma1   | 2.492210e+00 | +8.067900e-01 | -9.922100e-01 |
| lag_freq(2).Gamma2   | 1.819724e+00 | +1.380276e+00 | -4.197240e-01 |
| lag_freq(2).xi       | 2.030804e+00 | +9.691960e-01 | -2.030804e+00 |
| lag_freq(2).b        | 2.584878e+00 | +4.151220e-01 | -1.584878e+00 |
| lag_freq(2).t_max    | 2.261851e+02 | +5.738149e+02 | -1.761851e+02 |
| lag_freq(2).t_shift  | 3.013164e+01 | +8.986836e+01 | -3.013164e+01 |
| lag_freq(3).norm     | 2.766441e+00 | +2.759535e+00 | -1.316220e+00 |
| lag_freq(3).h2       | 1.056730e+01 | +2.473325e+00 | -2.698740e-01 |
| lag_freq(3).Gamma1   | 2.575346e+00 | +3.389823e-01 | -2.476288e-01 |
| lag_freq(3).Gamma2   | 1.844523e+00 | +3.011540e-01 | -1.965642e-01 |
| lag_freq(3).xi       | 1.499929e+00 | +1.500071e+00 | -1.499929e+00 |
| lag_freq(3).b        | 1.978480e+00 | +1.021520e+00 | -7.887304e-01 |
| lag_freq(3).t_max    | 5.727486e+02 | +5.082728e+01 | -2.206287e+02 |
| lag_freq(3).t_shift  | 2.202826e+01 | +6.919227e+00 | -1.280419e+01 |
| lag_freq(4).norm     | 1.249999e+00 | +5.638840e-01 | -6.470306e-01 |
| lag_freq(4).h2       | 1.999999e+01 | +1.000000e-05 | -8.432017e-01 |
| lag_freq(4).Gamma1   | 2.551217e+00 | +1.648563e-01 | -2.087184e-01 |
| lag_freq(4).Gamma2   | 1.997652e+00 | +1.929689e-01 | -1.653236e-01 |
| lag_freq(4).xi       | 2.999857e+00 | +1.430000e-04 | -1.714691e+00 |
| lag_freq(4).b        | 2.997707e+00 | +2.293000e-03 | -1.139706e+00 |
| lag_freq(4).t_max    | 6.884528e+02 | +3.726088e+01 | -1.700651e+02 |
| lag_freq(4).t_shift  | 2.202826e+01 | +7.296550e+00 | -1.210663e+01 |
| lag_freq(5).norm     | 6.249996e-01 | +4.388406e-01 | -2.931742e-01 |
| lag_freq(5).h2       | 1.999999e+01 | +1.000000e-05 | -2.311448e+00 |
| lag_freq(5).Gamma1   | 3.298147e+00 | +8.530000e-04 | -8.337650e-01 |
| lag_freq(5).Gamma2   | 1.549413e+00 | +8.849849e-01 | -9.671787e-02 |
| lag_freq(5).xi       | 2.249964e+00 | +7.500360e-01 | -2.249964e+00 |
| lag_freq(5).b        | 2.956959e+00 | +4.304100e-02 | -1.109901e+00 |
| lag_freq(5).t_max    | 6.932119e+02 | +3.033939e+01 | -2.363540e+02 |
| lag_freq(5).t_shift  | 2.202826e+01 | +1.255822e+01 | -1.166171e+01 |
| lag_freq(6).norm     | 2.302600e+00 | +7.063310e-01 | -4.404839e-01 |
| lag_freq(6).h2       | 1.329654e+01 | +5.998966e+00 | -1.487893e+00 |
| lag_freq(6).Gamma1   | 2.830624e+00 | +2.329558e-01 | -1.537812e-01 |
| lag_freq(6).Gamma2   | 1.723110e+00 | +1.808835e-01 | -4.387116e-02 |
| lag_freq(6).xi       | 5.892750e-01 | +2.329327e+00 | -5.892750e-01 |
| lag_freq(6).b        | 2.384039e+00 | +5.827607e-01 | -6.189749e-01 |
| lag_freq(6).t_max    | 7.110987e+02 | +7.442710e+00 | -2.731773e+01 |
| lag_freq(6).t_shift  | 2.102826e+01 | +4.139340e+00 | -6.894208e+00 |
| lag_freq(7).norm     | 1.797167e+00 | +1.360829e+00 | -5.268060e-01 |
| lag_freq(7).h2       | 1.357490e+01 | +6.147569e+00 | -1.743181e+00 |
| lag_freq(7).Gamma1   | 2.473077e+00 | +1.027916e-01 | -1.487882e-01 |
| lag_freq(7).Gamma2   | 1.797652e+00 | +1.857369e-01 | -1.179447e-01 |
| lag_freq(7).xi       | 7.857000e-01 | +2.013026e+00 | -7.857000e-01 |
| lag_freq(7).b        | 2.818480e+00 | +1.815200e-01 | -5.262902e-01 |
| lag_freq(7).t_max    | 6.932413e+02 | +2.182472e+01 | -1.406801e+02 |
| lag_freq(7).t_shift  | 2.102826e+01 | +2.191999e+00 | -4.078409e+00 |
| lag_freq(8).norm     | 3.562369e+00 | +1.428842e+00 | -8.116993e-01 |
| lag_freq(8).h2       | 1.144562e+01 | +1.700792e+00 | -6.535682e-01 |
| lag_freq(8).Gamma1   | 2.473077e+00 | +5.615184e-02 | -7.280592e-02 |
| lag_freq(8).Gamma2   | 1.727017e+00 | +9.177469e-02 | -4.886216e-02 |
| lag_freq(8).xi       | 1.992127e+00 | +4.081057e-01 | -1.992127e+00 |
| lag_freq(8).b        | 2.999823e+00 | +1.770000e-04 | -2.295307e-01 |
| lag_freq(8).t_max    | 5.678101e+02 | +4.373722e+01 | -1.095645e+02 |
| lag_freq(8).t_shift  | 1.860273e+01 | +1.524882e+00 | -1.287286e+00 |
| lag_freq(9).norm     | 4.644211e+00 | +1.685829e+00 | -1.012708e+00 |
| lag_freq(9).h2       | 1.144562e+01 | +1.117050e+00 | -6.653131e-01 |
| lag_freq(9).Gamma1   | 2.473077e+00 | +7.532968e-02 | -4.095470e-02 |
| lag_freq(9).Gamma2   | 1.727017e+00 | +5.665758e-02 | -5.063671e-02 |
| lag_freq(9).xi       | 7.857000e-01 | +1.811778e+00 | -7.857000e-01 |
| lag_freq(9).b        | 2.999956e+00 | +4.400000e-05 | -1.942862e-01 |
| lag_freq(9).t_max    | 5.395535e+02 | +4.930025e+01 | -6.555186e+01 |
| lag_freq(9).t_shift  | 1.860273e+01 | +1.659723e+00 | -9.081181e-01 |
| lag_freq(10).norm    | 5.896890e+00 | +2.723114e+00 | -1.087993e+00 |
| lag_freq(10).h2      | 1.144562e+01 | +1.264328e+00 | -6.145312e-01 |
| lag_freq(10).Gamma1  | 2.486325e+00 | +5.114042e-02 | -4.096346e-02 |
| lag_freq(10).Gamma2  | 1.727017e+00 | +5.485283e-02 | -4.557347e-02 |
| lag_freq(10).xi      | 2.357100e+00 | +3.734676e-01 | -2.357100e+00 |
| lag_freq(10).b       | 2.999978e+00 | +2.200000e-05 | -1.977601e-01 |
| lag_freq(10).t_max   | 3.361253e+02 | +4.164817e+01 | -3.289254e+01 |
| lag_freq(10).t_shift | 1.673007e+01 | +1.082239e+00 | -7.366588e-01 |
| lag_freq(11).norm    | 5.157551e+00 | +2.783007e+00 | -2.360673e+00 |
| lag_freq(11).h2      | 7.222810e+00 | +1.257227e+00 | -1.394813e+00 |
| lag_freq(11).Gamma1  | 2.602301e+00 | +7.065758e-02 | -8.058225e-02 |
| lag_freq(11).Gamma2  | 1.727017e+00 | +1.317564e-01 | -1.114824e-01 |
| lag_freq(11).xi      | 2.251726e+00 | +3.798380e-01 | -2.251726e+00 |
| lag_freq(11).b       | 2.887321e+00 | +1.126790e-01 | -5.912362e-01 |
| lag_freq(11).t_max   | 1.930626e+02 | +3.224858e+01 | -3.261651e+01 |
| lag_freq(11).t_shift | 1.417592e+01 | +1.056502e+00 | -1.239833e+00 |
| lag_freq(12).norm    | 8.605624e-02 | +1.358591e-01 | -7.259185e-02 |
| lag_freq(12).h2      | 1.999993e+01 | +7.000000e-05 | -5.811411e+00 |
| lag_freq(12).Gamma1  | 2.051151e+00 | +4.600846e-01 | -3.335330e-01 |
| lag_freq(12).Gamma2  | 1.563508e+00 | +1.502748e+00 | -1.475762e-01 |
| lag_freq(12).xi      | 3.518322e-02 | +2.964817e+00 | -3.518322e-02 |
| lag_freq(12).b       | 2.999560e+00 | +4.400000e-04 | -1.999560e+00 |
| lag_freq(12).t_max   | 1.930626e+02 | +2.349441e+02 | -1.279603e+02 |
| lag_freq(12).t_shift | 8.126388e+01 | +3.873612e+01 | -1.492191e+01 |
| lag_freq(13).norm    | 2.776137e-01 | +9.039044e-02 | -9.463996e-02 |
| lag_freq(13).h2      | 1.999993e+01 | +7.000000e-05 | -3.409665e-01 |
| lag_freq(13).Gamma1  | 1.851051e+00 | +4.229479e-01 | -8.215571e-02 |
| lag_freq(13).Gamma2  | 1.538473e+00 | +2.919689e-01 | -7.510329e-02 |
| lag_freq(13).xi      | 2.999413e+00 | +5.865593e-04 | -1.167176e+00 |
| lag_freq(13).b       | 2.999560e+00 | +4.400000e-04 | -1.862257e+00 |
| lag_freq(13).t_max   | 1.930626e+02 | +5.158036e+01 | -7.073657e+01 |
| lag_freq(13).t_shift | 7.320621e+01 | +1.316513e+01 | -6.829060e+00 |

** 14 data sets fit

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/mass-fit-14data.sl=

Importing =conf_mass_fit_14data.par=

#+BEGIN_EXAMPLE
isis

source("mass-fit-14data.sl");

source(conf_mass_fit_14data.sl");

#+END_EXAMPLE

Confidence file: =conf_mass_fit_14data.csv=

| lag_freq(1).norm     | 3.970566e+00 | +2.746438e+00 | -1.960972e+00 |
| lag_freq(1).log_mass | 6.009131e+00 | +1.812219e-02 | -9.131000e-03 |
| lag_freq(1).h2       | 1.497875e+01 | +4.338929e+00 | -1.761022e+00 |
| lag_freq(1).Gamma1   | 2.350429e+00 | +6.471184e-02 | -6.732295e-02 |
| lag_freq(1).Gamma2   | 1.920554e+00 | +8.463305e-02 | -8.269217e-02 |
| lag_freq(1).xi       | 2.624994e+00 | +3.750060e-01 | -2.624994e+00 |
| lag_freq(1).b        | 2.404917e+00 | +2.067818e-01 | -2.467239e-01 |
| lag_freq(1).t_max    | 4.945709e+02 | +8.069798e+01 | -6.740935e+01 |
| lag_freq(1).t_shift  | 3.076710e+01 | +2.071565e+00 | -4.389853e+00 |
| lag_freq(2).norm     | 6.181611e-06 | +1.573513e-01 | -6.181611e-06 |
| lag_freq(2).h2       | 1.406980e+01 | +5.930200e+00 | -1.106980e+01 |
| lag_freq(2).Gamma1   | 2.492210e+00 | +8.067900e-01 | -9.922100e-01 |
| lag_freq(2).Gamma2   | 1.819724e+00 | +1.380276e+00 | -4.197240e-01 |
| lag_freq(2).xi       | 2.030804e+00 | +9.691960e-01 | -2.030804e+00 |
| lag_freq(2).b        | 2.584878e+00 | +4.151220e-01 | -1.584878e+00 |
| lag_freq(2).t_max    | 2.261851e+02 | +5.738149e+02 | -1.761851e+02 |
| lag_freq(2).t_shift  | 3.013164e+01 | +8.986836e+01 | -3.013164e+01 |
| lag_freq(3).norm     | 2.766441e+00 | +2.759535e+00 | -1.316220e+00 |
| lag_freq(3).h2       | 1.056730e+01 | +2.473325e+00 | -2.698740e-01 |
| lag_freq(3).Gamma1   | 2.575346e+00 | +3.389823e-01 | -2.476288e-01 |
| lag_freq(3).Gamma2   | 1.844523e+00 | +3.011540e-01 | -1.965642e-01 |
| lag_freq(3).xi       | 1.499929e+00 | +1.500071e+00 | -1.499929e+00 |
| lag_freq(3).b        | 1.978480e+00 | +1.021520e+00 | -7.887304e-01 |
| lag_freq(3).t_max    | 5.727486e+02 | +5.082728e+01 | -2.206287e+02 |
| lag_freq(3).t_shift  | 2.202826e+01 | +6.919227e+00 | -1.280419e+01 |
| lag_freq(4).norm     | 1.249999e+00 | +5.638840e-01 | -6.470306e-01 |
| lag_freq(4).h2       | 1.999999e+01 | +1.000000e-05 | -8.432017e-01 |
| lag_freq(4).Gamma1   | 2.551217e+00 | +1.648563e-01 | -2.087184e-01 |
| lag_freq(4).Gamma2   | 1.997652e+00 | +1.929689e-01 | -1.653236e-01 |
| lag_freq(4).xi       | 2.999857e+00 | +1.430000e-04 | -1.714691e+00 |
| lag_freq(4).b        | 2.997707e+00 | +2.293000e-03 | -1.139706e+00 |
| lag_freq(4).t_max    | 6.884528e+02 | +3.726088e+01 | -1.700651e+02 |
| lag_freq(4).t_shift  | 2.202826e+01 | +7.296550e+00 | -1.210663e+01 |
| lag_freq(5).norm     | 6.249996e-01 | +4.388406e-01 | -2.931742e-01 |
| lag_freq(5).h2       | 1.999999e+01 | +1.000000e-05 | -2.311448e+00 |
| lag_freq(5).Gamma1   | 3.298147e+00 | +8.530000e-04 | -8.337650e-01 |
| lag_freq(5).Gamma2   | 1.549413e+00 | +8.849849e-01 | -9.671787e-02 |
| lag_freq(5).xi       | 2.249964e+00 | +7.500360e-01 | -2.249964e+00 |
| lag_freq(5).b        | 2.956959e+00 | +4.304100e-02 | -1.109901e+00 |
| lag_freq(5).t_max    | 6.932119e+02 | +3.033939e+01 | -2.363540e+02 |
| lag_freq(5).t_shift  | 2.202826e+01 | +1.255822e+01 | -1.166171e+01 |
| lag_freq(6).norm     | 2.302600e+00 | +7.063310e-01 | -4.404839e-01 |
| lag_freq(6).h2       | 1.329654e+01 | +5.998966e+00 | -1.487893e+00 |
| lag_freq(6).Gamma1   | 2.830624e+00 | +2.329558e-01 | -1.537812e-01 |
| lag_freq(6).Gamma2   | 1.723110e+00 | +1.808835e-01 | -4.387116e-02 |
| lag_freq(6).xi       | 5.892750e-01 | +2.329327e+00 | -5.892750e-01 |
| lag_freq(6).b        | 2.384039e+00 | +5.827607e-01 | -6.189749e-01 |
| lag_freq(6).t_max    | 7.110987e+02 | +7.442710e+00 | -2.731773e+01 |
| lag_freq(6).t_shift  | 2.102826e+01 | +4.139340e+00 | -6.894208e+00 |
| lag_freq(7).norm     | 1.797167e+00 | +1.360829e+00 | -5.268060e-01 |
| lag_freq(7).h2       | 1.357490e+01 | +6.147569e+00 | -1.743181e+00 |
| lag_freq(7).Gamma1   | 2.473077e+00 | +1.027916e-01 | -1.487882e-01 |
| lag_freq(7).Gamma2   | 1.797652e+00 | +1.857369e-01 | -1.179447e-01 |
| lag_freq(7).xi       | 7.857000e-01 | +2.013026e+00 | -7.857000e-01 |
| lag_freq(7).b        | 2.818480e+00 | +1.815200e-01 | -5.262902e-01 |
| lag_freq(7).t_max    | 6.932413e+02 | +2.182472e+01 | -1.406801e+02 |
| lag_freq(7).t_shift  | 2.102826e+01 | +2.191999e+00 | -4.078409e+00 |
| lag_freq(8).norm     | 3.562369e+00 | +1.428842e+00 | -8.116993e-01 |
| lag_freq(8).h2       | 1.144562e+01 | +1.700792e+00 | -6.535682e-01 |
| lag_freq(8).Gamma1   | 2.473077e+00 | +5.615184e-02 | -7.280592e-02 |
| lag_freq(8).Gamma2   | 1.727017e+00 | +9.177469e-02 | -4.886216e-02 |
| lag_freq(8).xi       | 1.992127e+00 | +4.081057e-01 | -1.992127e+00 |
| lag_freq(8).b        | 2.999823e+00 | +1.770000e-04 | -2.295307e-01 |
| lag_freq(8).t_max    | 5.678101e+02 | +4.373722e+01 | -1.095645e+02 |
| lag_freq(8).t_shift  | 1.860273e+01 | +1.524882e+00 | -1.287286e+00 |
| lag_freq(9).norm     | 4.644211e+00 | +1.685829e+00 | -1.012708e+00 |
| lag_freq(9).h2       | 1.144562e+01 | +1.117050e+00 | -6.653131e-01 |
| lag_freq(9).Gamma1   | 2.473077e+00 | +7.532968e-02 | -4.095470e-02 |
| lag_freq(9).Gamma2   | 1.727017e+00 | +5.665758e-02 | -5.063671e-02 |
| lag_freq(9).xi       | 7.857000e-01 | +1.811778e+00 | -7.857000e-01 |
| lag_freq(9).b        | 2.999956e+00 | +4.400000e-05 | -1.942862e-01 |
| lag_freq(9).t_max    | 5.395535e+02 | +4.930025e+01 | -6.555186e+01 |
| lag_freq(9).t_shift  | 1.860273e+01 | +1.659723e+00 | -9.081181e-01 |
| lag_freq(10).norm    | 5.896890e+00 | +2.723114e+00 | -1.087993e+00 |
| lag_freq(10).h2      | 1.144562e+01 | +1.264328e+00 | -6.145312e-01 |
| lag_freq(10).Gamma1  | 2.486325e+00 | +5.114042e-02 | -4.096346e-02 |
| lag_freq(10).Gamma2  | 1.727017e+00 | +5.485283e-02 | -4.557347e-02 |
| lag_freq(10).xi      | 2.357100e+00 | +3.734676e-01 | -2.357100e+00 |
| lag_freq(10).b       | 2.999978e+00 | +2.200000e-05 | -1.977601e-01 |
| lag_freq(10).t_max   | 3.361253e+02 | +4.164817e+01 | -3.289254e+01 |
| lag_freq(10).t_shift | 1.673007e+01 | +1.082239e+00 | -7.366588e-01 |
| lag_freq(11).norm    | 5.157551e+00 | +2.783007e+00 | -2.360673e+00 |
| lag_freq(11).h2      | 7.222810e+00 | +1.257227e+00 | -1.394813e+00 |
| lag_freq(11).Gamma1  | 2.602301e+00 | +7.065758e-02 | -8.058225e-02 |
| lag_freq(11).Gamma2  | 1.727017e+00 | +1.317564e-01 | -1.114824e-01 |
| lag_freq(11).xi      | 2.251726e+00 | +3.798380e-01 | -2.251726e+00 |
| lag_freq(11).b       | 2.887321e+00 | +1.126790e-01 | -5.912362e-01 |
| lag_freq(11).t_max   | 1.930626e+02 | +3.224858e+01 | -3.261651e+01 |
| lag_freq(11).t_shift | 1.417592e+01 | +1.056502e+00 | -1.239833e+00 |
| lag_freq(12).norm    | 8.605624e-02 | +1.358591e-01 | -7.259185e-02 |
| lag_freq(12).h2      | 1.999993e+01 | +7.000000e-05 | -5.811411e+00 |
| lag_freq(12).Gamma1  | 2.051151e+00 | +4.600846e-01 | -3.335330e-01 |
| lag_freq(12).Gamma2  | 1.563508e+00 | +1.502748e+00 | -1.475762e-01 |
| lag_freq(12).xi      | 3.518322e-02 | +2.964817e+00 | -3.518322e-02 |
| lag_freq(12).b       | 2.999560e+00 | +4.400000e-04 | -1.999560e+00 |
| lag_freq(12).t_max   | 1.930626e+02 | +2.349441e+02 | -1.279603e+02 |
| lag_freq(12).t_shift | 8.126388e+01 | +3.873612e+01 | -1.492191e+01 |
| lag_freq(13).norm    | 2.776137e-01 | +9.039016e-02 | -9.464011e-02 |
| lag_freq(13).h2      | 1.999993e+01 | +7.000000e-05 | -3.409672e-01 |
| lag_freq(13).Gamma1  | 1.851051e+00 | +4.229471e-01 | -8.215599e-02 |
| lag_freq(13).Gamma2  | 1.538473e+00 | +2.919696e-01 | -7.510281e-02 |
| lag_freq(13).xi      | 2.999413e+00 | +5.870000e-04 | -1.167174e+00 |
| lag_freq(13).b       | 2.999560e+00 | +4.400000e-04 | -1.862257e+00 |
| lag_freq(13).t_max   | 1.930626e+02 | +5.158036e+01 | -7.073673e+01 |
| lag_freq(13).t_shift | 7.320621e+01 | +1.316515e+01 | -6.829068e+00 |
| lag_freq(14).norm    | 1.628152e-01 | +1.833087e-01 | -1.067484e-01 |
| lag_freq(14).h2      | 1.999993e+01 | +7.000000e-05 | -2.643475e+00 |
| lag_freq(14).Gamma1  | 2.775173e+00 | +5.238267e-01 | -1.035746e+00 |
| lag_freq(14).Gamma2  | 1.538473e+00 | +1.595188e+00 | -1.041389e-01 |
| lag_freq(14).xi      | 7.030791e-02 | +2.929692e+00 | -7.030791e-02 |
| lag_freq(14).b       | 1.499890e+00 | +1.500110e+00 | -4.998900e-01 |
| lag_freq(14).t_max   | 5.168848e+02 | +2.114014e+02 | -4.416626e+02 |
| lag_freq(14).t_shift | 7.320621e+01 | +4.329277e+01 | -7.320621e+01 |

** 15 data sets fit

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/mass-fit.sl=

Importing =conf_mass_fit_15data.par=

#+BEGIN_EXAMPLE
isis mass-fit-15data.sl


Running on:
14344.pts-1.hm00

#+END_EXAMPLE

Confidence file: =conf_mass_fit_15data.csv=

| lag_freq(1).norm     | 3.970566e+00 | +2.746438e+00 | -1.960972e+00 |
| lag_freq(1).log_mass | 6.009131e+00 | +1.676631e-02 | -9.131000e-03 |
| lag_freq(1).h2       | 1.497875e+01 | +4.338929e+00 | -1.761022e+00 |
| lag_freq(1).Gamma1   | 2.350429e+00 | +6.471184e-02 | -6.732295e-02 |
| lag_freq(1).Gamma2   | 1.920554e+00 | +8.463305e-02 | -8.269217e-02 |
| lag_freq(1).xi       | 2.624994e+00 | +3.750060e-01 | -2.624994e+00 |
| lag_freq(1).b        | 2.404917e+00 | +2.067818e-01 | -2.467239e-01 |
| lag_freq(1).t_max    | 4.945709e+02 | +8.069798e+01 | -6.740935e+01 |
| lag_freq(1).t_shift  | 3.076710e+01 | +2.071565e+00 | -4.389853e+00 |
| lag_freq(2).norm     | 6.181611e-06 | +1.573513e-01 | -6.181611e-06 |
| lag_freq(2).h2       | 1.406980e+01 | +5.930200e+00 | -1.106980e+01 |
| lag_freq(2).Gamma1   | 2.492210e+00 | +8.067900e-01 | -9.922100e-01 |
| lag_freq(2).Gamma2   | 1.819724e+00 | +1.380276e+00 | -4.197240e-01 |
| lag_freq(2).xi       | 2.030804e+00 | +9.691960e-01 | -2.030804e+00 |
| lag_freq(2).b        | 2.584878e+00 | +4.151220e-01 | -1.584878e+00 |
| lag_freq(2).t_max    | 2.261851e+02 | +5.738149e+02 | -1.761851e+02 |
| lag_freq(2).t_shift  | 3.013164e+01 | +8.986836e+01 | -3.013164e+01 |
| lag_freq(3).norm     | 2.766441e+00 | +2.759535e+00 | -1.316220e+00 |
| lag_freq(3).h2       | 1.056730e+01 | +2.473325e+00 | -2.698740e-01 |
| lag_freq(3).Gamma1   | 2.575346e+00 | +3.389823e-01 | -2.476288e-01 |
| lag_freq(3).Gamma2   | 1.844523e+00 | +3.011540e-01 | -1.965642e-01 |
| lag_freq(3).xi       | 1.499929e+00 | +1.500071e+00 | -1.499929e+00 |
| lag_freq(3).b        | 1.978480e+00 | +1.021520e+00 | -7.887304e-01 |
| lag_freq(3).t_max    | 5.727486e+02 | +5.082728e+01 | -2.206287e+02 |
| lag_freq(3).t_shift  | 2.202826e+01 | +6.919227e+00 | -1.280419e+01 |
| lag_freq(4).norm     | 1.249999e+00 | +5.638840e-01 | -6.470306e-01 |
| lag_freq(4).h2       | 1.999999e+01 | +1.000000e-05 | -8.432017e-01 |
| lag_freq(4).Gamma1   | 2.551217e+00 | +1.648563e-01 | -2.087184e-01 |
| lag_freq(4).Gamma2   | 1.997652e+00 | +1.929689e-01 | -1.653236e-01 |
| lag_freq(4).xi       | 2.999857e+00 | +1.430000e-04 | -1.714691e+00 |
| lag_freq(4).b        | 2.997707e+00 | +2.293000e-03 | -1.139706e+00 |
| lag_freq(4).t_max    | 6.884528e+02 | +3.726088e+01 | -1.700651e+02 |
| lag_freq(4).t_shift  | 2.202826e+01 | +7.296550e+00 | -1.210663e+01 |
| lag_freq(5).norm     | 6.249996e-01 | +4.388406e-01 | -2.931742e-01 |
| lag_freq(5).h2       | 1.999999e+01 | +1.000000e-05 | -2.311448e+00 |
| lag_freq(5).Gamma1   | 3.298147e+00 | +8.530000e-04 | -8.337650e-01 |
| lag_freq(5).Gamma2   | 1.549413e+00 | +8.849849e-01 | -9.671787e-02 |
| lag_freq(5).xi       | 2.249964e+00 | +7.500360e-01 | -2.249964e+00 |
| lag_freq(5).b        | 2.956959e+00 | +4.304100e-02 | -1.109901e+00 |
| lag_freq(5).t_max    | 6.932119e+02 | +3.033939e+01 | -2.363540e+02 |
| lag_freq(5).t_shift  | 2.202826e+01 | +1.255822e+01 | -1.166171e+01 |
| lag_freq(6).norm     | 2.302600e+00 | +7.063310e-01 | -4.404839e-01 |
| lag_freq(6).h2       | 1.329654e+01 | +5.998966e+00 | -1.487893e+00 |
| lag_freq(6).Gamma1   | 2.830624e+00 | +2.329558e-01 | -1.537812e-01 |
| lag_freq(6).Gamma2   | 1.723110e+00 | +1.808835e-01 | -4.387116e-02 |
| lag_freq(6).xi       | 5.892750e-01 | +2.329327e+00 | -5.892750e-01 |
| lag_freq(6).b        | 2.384039e+00 | +5.827607e-01 | -6.189749e-01 |
| lag_freq(6).t_max    | 7.110987e+02 | +7.442710e+00 | -2.731773e+01 |
| lag_freq(6).t_shift  | 2.102826e+01 | +4.139340e+00 | -6.894208e+00 |
| lag_freq(7).norm     | 1.797167e+00 | +1.360829e+00 | -5.268060e-01 |
| lag_freq(7).h2       | 1.357490e+01 | +6.147569e+00 | -1.743181e+00 |
| lag_freq(7).Gamma1   | 2.473077e+00 | +1.027916e-01 | -1.487882e-01 |
| lag_freq(7).Gamma2   | 1.797652e+00 | +1.857369e-01 | -1.179447e-01 |
| lag_freq(7).xi       | 7.857000e-01 | +2.013026e+00 | -7.857000e-01 |
| lag_freq(7).b        | 2.818480e+00 | +1.815200e-01 | -5.262902e-01 |
| lag_freq(7).t_max    | 6.932413e+02 | +2.182472e+01 | -1.406801e+02 |
| lag_freq(7).t_shift  | 2.102826e+01 | +2.191999e+00 | -4.078409e+00 |
| lag_freq(8).norm     | 3.562369e+00 | +1.428842e+00 | -8.116993e-01 |
| lag_freq(8).h2       | 1.144562e+01 | +1.700792e+00 | -6.535682e-01 |
| lag_freq(8).Gamma1   | 2.473077e+00 | +5.615184e-02 | -7.280592e-02 |
| lag_freq(8).Gamma2   | 1.727017e+00 | +9.177469e-02 | -4.886216e-02 |
| lag_freq(8).xi       | 1.992127e+00 | +4.081057e-01 | -1.992127e+00 |
| lag_freq(8).b        | 2.999823e+00 | +1.770000e-04 | -2.295307e-01 |
| lag_freq(8).t_max    | 5.678101e+02 | +4.373722e+01 | -1.095645e+02 |
| lag_freq(8).t_shift  | 1.860273e+01 | +1.524882e+00 | -1.287286e+00 |
| lag_freq(9).norm     | 4.644211e+00 | +1.685829e+00 | -1.012708e+00 |
| lag_freq(9).h2       | 1.144562e+01 | +1.117050e+00 | -6.653131e-01 |
| lag_freq(9).Gamma1   | 2.473077e+00 | +7.532968e-02 | -4.095470e-02 |
| lag_freq(9).Gamma2   | 1.727017e+00 | +5.665758e-02 | -5.063671e-02 |
| lag_freq(9).xi       | 7.857000e-01 | +1.811778e+00 | -7.857000e-01 |
| lag_freq(9).b        | 2.999956e+00 | +4.400000e-05 | -1.942862e-01 |
| lag_freq(9).t_max    | 5.395535e+02 | +4.930025e+01 | -6.555186e+01 |
| lag_freq(9).t_shift  | 1.860273e+01 | +1.659723e+00 | -9.081181e-01 |
| lag_freq(10).norm    | 5.896890e+00 | +2.723114e+00 | -1.087993e+00 |
| lag_freq(10).h2      | 1.144562e+01 | +1.264328e+00 | -6.145312e-01 |
| lag_freq(10).Gamma1  | 2.486325e+00 | +5.114042e-02 | -4.096346e-02 |
| lag_freq(10).Gamma2  | 1.727017e+00 | +5.485283e-02 | -4.557347e-02 |
| lag_freq(10).xi      | 2.357100e+00 | +3.734676e-01 | -2.357100e+00 |
| lag_freq(10).b       | 2.999978e+00 | +2.200000e-05 | -1.977601e-01 |
| lag_freq(10).t_max   | 3.361253e+02 | +4.164817e+01 | -3.289254e+01 |
| lag_freq(10).t_shift | 1.673007e+01 | +1.082239e+00 | -7.366588e-01 |
| lag_freq(11).norm    | 5.157551e+00 | +2.783007e+00 | -2.360673e+00 |
| lag_freq(11).h2      | 7.222810e+00 | +1.257227e+00 | -1.394813e+00 |
| lag_freq(11).Gamma1  | 2.602301e+00 | +7.065758e-02 | -8.058225e-02 |
| lag_freq(11).Gamma2  | 1.727017e+00 | +1.317564e-01 | -1.114824e-01 |
| lag_freq(11).xi      | 2.251726e+00 | +3.798380e-01 | -2.251726e+00 |
| lag_freq(11).b       | 2.887321e+00 | +1.126790e-01 | -5.912362e-01 |
| lag_freq(11).t_max   | 1.930626e+02 | +3.224858e+01 | -3.261651e+01 |
| lag_freq(11).t_shift | 1.417592e+01 | +1.056502e+00 | -1.239833e+00 |
| lag_freq(12).norm    | 8.605624e-02 | +1.358591e-01 | -7.259185e-02 |
| lag_freq(12).h2      | 1.999993e+01 | +7.000000e-05 | -5.811411e+00 |
| lag_freq(12).Gamma1  | 2.051151e+00 | +4.600846e-01 | -3.335330e-01 |
| lag_freq(12).Gamma2  | 1.563508e+00 | +1.502748e+00 | -1.475762e-01 |
| lag_freq(12).xi      | 3.518322e-02 | +2.964817e+00 | -3.518322e-02 |
| lag_freq(12).b       | 2.999560e+00 | +4.400000e-04 | -1.999560e+00 |
| lag_freq(12).t_max   | 1.930626e+02 | +2.349441e+02 | -1.279603e+02 |
| lag_freq(12).t_shift | 8.126388e+01 | +3.873612e+01 | -1.492191e+01 |
| lag_freq(13).norm    | 2.776137e-01 | +9.039016e-02 | -9.464011e-02 |
| lag_freq(13).h2      | 1.999993e+01 | +7.000000e-05 | -3.409672e-01 |
| lag_freq(13).Gamma1  | 1.851051e+00 | +4.229471e-01 | -8.215599e-02 |
| lag_freq(13).Gamma2  | 1.538473e+00 | +2.919696e-01 | -7.510281e-02 |
| lag_freq(13).xi      | 2.999413e+00 | +5.870000e-04 | -1.167174e+00 |
| lag_freq(13).b       | 2.999560e+00 | +4.400000e-04 | -1.862257e+00 |
| lag_freq(13).t_max   | 1.930626e+02 | +5.158036e+01 | -7.073673e+01 |
| lag_freq(13).t_shift | 7.320621e+01 | +1.316515e+01 | -6.829068e+00 |
| lag_freq(14).norm    | 1.628152e-01 | +1.833087e-01 | -1.067484e-01 |
| lag_freq(14).h2      | 1.999993e+01 | +7.000000e-05 | -2.643475e+00 |
| lag_freq(14).Gamma1  | 2.775173e+00 | +5.238267e-01 | -1.035746e+00 |
| lag_freq(14).Gamma2  | 1.538473e+00 | +1.595188e+00 | -1.041389e-01 |
| lag_freq(14).xi      | 7.030791e-02 | +2.929692e+00 | -7.030791e-02 |
| lag_freq(14).b       | 1.499890e+00 | +1.500110e+00 | -4.998900e-01 |
| lag_freq(14).t_max   | 5.168848e+02 | +2.114014e+02 | -4.416626e+02 |
| lag_freq(14).t_shift | 7.320621e+01 | +4.329277e+01 | -7.320621e+01 |
| lag_freq(15).norm    | 3.561122e-01 | +1.455527e-01 | -9.391242e-02 |
| lag_freq(15).h2      | 1.999993e+01 | +7.000000e-05 | -2.636953e-01 |
| lag_freq(15).Gamma1  | 3.298983e+00 | +1.736929e-05 | -5.276944e-01 |
| lag_freq(15).Gamma2  | 1.487196e+00 | +5.861663e-01 | -2.299501e-02 |
| lag_freq(15).xi      | 2.999991e+00 | +9.171875e-06 | -2.999991e+00 |
| lag_freq(15).b       | 1.999780e+00 | +1.000220e+00 | -7.253430e-01 |
| lag_freq(15).t_max   | 5.149456e+02 | +1.957994e+02 | -1.076493e+02 |
| lag_freq(15).t_shift | 9.409409e+01 | +1.445840e+01 | -1.070909e+01 |

* 1H0707-495 Simultaneous Mass fits individual fits (logM range = 6.0 - 8.0)

For this fit the mass was

$logM_{\odot} = 6.01^{+0.02}_{-0.01}$

Create indivual observation parameter files from the
=conf_mass_fit_15data.par= file and generate indivual par files, e.g:=tm_sim_0653510601.par=

** All data sim fit EMCEE

PATH TO DATA = =/data/typhon1/reverb/1H0707-495/isis_emcee/=

Fit script = =mass-fit-15data.sl=

Using parfile = =conf_mass_fit_15data.par= Edited for the imporoved fits of the lagfreq(3),(4) etc as detailed below
fitting regime:

Load the Saved  =sim_fit_15data_emcee.par=

Run the chain

#+BEGIN_EXAMPLE
isis mass-fit-15data-emcee.sl

Line 7 is too long or lacks a newline character
./mass-fit-15data-emcee.sl:7:<top-level>:Limit Exceeded
Failed loading file mass-fit-15data-emcee.sl


#+END_EXAMPLE



** 0110890201 lag_freq(1)

Use these fitting scripts (Do not run conf - already done in
=conf_mass_fit_15data.csv) :

PATH = =sim-fit-0110890201.sl=

PARFILE = =sim_fit_0110890201.par=

#+BEGIN_EXAMPLE

 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 2.031769
   Reduced chi-square = 0.2902527
lag_freq(1)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     1         3.970566           0          10
  2  lag_freq(1).log_mass   0     1         6.009131           6           8
  3  lag_freq(1).i          0     1               53          53          53
  4  lag_freq(1).a          0     1            0.998       0.998       0.998
  5  lag_freq(1).h1         0     1                2           2           2
  6  lag_freq(1).h2         0     1         14.97875           3          20
  7  lag_freq(1).Gamma1     0     1         2.350429         1.5       3.299
  8  lag_freq(1).Gamma2     0     1         1.920554         1.4         3.2
  9  lag_freq(1).Fe         0     1                1           1           1
 10  lag_freq(1).xi         0     1         2.624994           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1         2.404917           1           3
 13  lag_freq(1).q2         0     1              0.5         0.5         0.5
 14  lag_freq(1).t_max      0     1         494.5709          50         800
 15  lag_freq(1).t_shift    0     1          30.7671           0         120
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   2  -3.9595e-02     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-OBS-0110890201-time-lags-segs.fits


#+END_EXAMPLE


| lag_freq(1).norm     | 3.970566e+00 | +2.746438e+00 | -1.960972e+00 |
| lag_freq(1).log_mass | 6.009131e+00 | +1.676631e-02 | -9.131000e-03 |
| lag_freq(1).h2       | 1.497875e+01 | +4.338929e+00 | -1.761022e+00 |
| lag_freq(1).Gamma1   | 2.350429e+00 | +6.471184e-02 | -6.732295e-02 |
| lag_freq(1).Gamma2   | 1.920554e+00 | +8.463305e-02 | -8.269217e-02 |
| lag_freq(1).xi       | 2.624994e+00 | +3.750060e-01 | -2.624994e+00 |
| lag_freq(1).b        | 2.404917e+00 | +2.067818e-01 | -2.467239e-01 |
| lag_freq(1).t_max    | 4.945709e+02 | +8.069798e+01 | -6.740935e+01 |
| lag_freq(1).t_shift  | 3.076710e+01 | +2.071565e+00 | -4.389853e+00 |

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit_0110890201.gif

** 0110890201 isis emcee

PATH TO DATA = =/data/typhon1/reverb/1H0707-495/isis_emcee/=

Fit script = =1H0707-0110890201-fit-emcee.sl=

Fitting Parameter file =sim_fit_0110890201.par=

copied from =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495=

reformated as below with free pars:

#+BEGIN_EXAMPLE
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         3.970566           0          10
  2  lag_freq(1).log_mass   0     1         6.009131           6           8
  3  lag_freq(1).i          0     1               53          53          53
  4  lag_freq(1).a          0     1            0.998       0.998       0.998
  5  lag_freq(1).h1         0     1                2           2           2
  6  lag_freq(1).h2         0     0         14.97875           3          20
  7  lag_freq(1).Gamma1     0     0         2.350429         1.5       3.299
  8  lag_freq(1).Gamma2     0     0         1.920554         1.4         3.2
  9  lag_freq(1).Fe         0     1                1           1           1
 10  lag_freq(1).xi         0     0         2.624994           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.404917           1           3
 13  lag_freq(1).q2         0     1              0.5         0.5         0.5
 14  lag_freq(1).t_max      0     0         494.5709          50         800
 15  lag_freq(1).t_shift    0     0          30.7671           0         120

#+END_EXAMPLE


#+BEGIN_EXAMPLE
isis

.source("1H0707-0110890201-fit-emcee.sl");

where

% Perform MCMC
emcee(500, 10000; output="1H0707_0110890201_sim_fit_chain.fits", serial);

% Read the chain-file
(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("1H0707_0110890201_sim_fit_chain.fits");
#+END_EXAMPLE

Started at 1020 - 1620 (6 hours to run chain)

*Paths of the walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_sim_fit_walkers-1.png


*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_sim_fit_h2_accept_rate-1.png


Obtain the Norm pobability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_sim_fit_norm_probability-1.png


Obtain the h2 probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_sim_fit_h2_probability-1.png

*Contours: paths in 2D*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_sim_fit_chain_hist2d-1.png

*Chain statistics*


#+BEGIN_EXAMPLE
s=600; % start at this iteration step
min(min_statistic[[s:]]);


min(min_statistic[[s:]]);
0.08284946618179345
#+END_EXAMPLE

Here, this results in χ²=, which is identical after previously
fitting the data where χ²= as outlined above.

Plotting the statistic array is another diagnostic tool:

#+BEGIN_EXAMPLE

n=length(max_statistic)-1;
yrange(min(min_statistic[[s:]])*.9, max(max_statistic[[s:]])*1.1);
plot([s:n], min_statistic[[600:]]);
oplot([s:n], max_statistic[[600:]]);
oplot([s:n], med_statistic[[600:]]);

#+END_EXAMPLE

Make good image of the statistics

#+BEGIN_EXAMPLE
variable pid = open_plot("1H0707_0110890201_statistics.ps/cps");
charsize(1.3); %good font size
_pgscf(2); %make font roman
plot([s:n], min_statistic[[600:]]);
oplot([s:n], max_statistic[[600:]]);
oplot([s:n], med_statistic[[600:]]);
close_plot(pid);

Then:

ps2pdf 1H0707_0110890201_statistics.ps
pdftocairo -png 1H0707_0110890201_statistics.pdf
cp  1H0707_0110890201_statistics-1.png /home/WWW/steff/ecm

#+END_EXAMPLE


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_sim_fit_statistics-1.png


Error analysis

#+CAPTION: The 68% confidence probability for 1H0707-495 Mass value where $\mu = 6.05\pm0.03$ (solid blue line. Error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_sim_fit_h2_conf68.gif



#+CAPTION: The 90% confidence probability for 1H0707-495 Mass value where $\mu = 6.06\pm0.05$ (solid blue line) with the error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H0707_0110890201_sim_fit_h2_conf90.gif

** 0148010301 lag_freq(2)

Use these fitting scripts (Do not run conf - already done in
=conf_mass_fit_15data.csv) :

PATH = =sim-fit-0148010301.sl=

PARFILE = =sim_fit_0148010301.par=

#+BEGIN_EXAMPLE
source("sim-fit-0148010301.sl");


 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 17.49816
   Reduced chi-square = 2.499738
lag_freq(2)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(2).norm       0     1     6.181611e-06           0          10
  2  lag_freq(2).log_mass   0     1         6.009131           6           8
  3  lag_freq(2).i          0     1               53          53          53
  4  lag_freq(2).a          0     1            0.998       0.998       0.998
  5  lag_freq(2).h1         0     1                2           2           2
  6  lag_freq(2).h2         0     1          14.0698           3          20
  7  lag_freq(2).Gamma1     0     1          2.49221         1.5       3.299
  8  lag_freq(2).Gamma2     0     1         1.819724         1.4         3.2
  9  lag_freq(2).Fe         0     1                1           1           1
 10  lag_freq(2).xi         0     1         2.030804           0           3
 11  lag_freq(2).p          0     1                0           0           0
 12  lag_freq(2).b          0     1         2.584878           1           3
 13  lag_freq(2).q2         0     1              0.5         0.5         0.5
 14  lag_freq(2).t_max      0     1         226.1851          50         800
 15  lag_freq(2).t_shift    0     1         30.13164           0         120


SIM fit did not converge  - free pars except logM and  fit again


source("conf_sim_fit.sl");

 Parameters[Variable] = 15[8]
            Data bins = 7
           Chi-square = 1.918699
   Reduced chi-square = 0.2740998

isis> list_par;
lag_freq(2)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(2).norm       0     1         9.753346           0          10
  2  lag_freq(2).log_mass   0     1         6.009131           6           8
  3  lag_freq(2).i          0     1               53          53          53
  4  lag_freq(2).a          0     1            0.998       0.998       0.998
  5  lag_freq(2).h1         0     1                2           2           2
  6  lag_freq(2).h2         0     1         3.000007           3          20
  7  lag_freq(2).Gamma1     0     1         3.005344         1.5       3.299
  8  lag_freq(2).Gamma2     0     1         2.763301         1.4         3.2
  9  lag_freq(2).Fe         0     1                1           1           1
 10  lag_freq(2).xi         0     1     0.0002566343           0           3
 11  lag_freq(2).p          0     1                0           0           0
 12  lag_freq(2).b          0     1         2.696789           1           3
 13  lag_freq(2).q2         0     1              0.5         0.5         0.5
 14  lag_freq(2).t_max      0     1         406.5979          50         800
 15  lag_freq(2).t_shift    0     1         25.01251           0         120

#+END_EXAMPLE


| lag_freq(2).norm    | 9.904131e+00 | +9.586949e-02 | -5.853257e+00 |
| lag_freq(2).h2      | 3.000003e+00 | +1.226518e+01 | -2.976058e-06 |
| lag_freq(2).Gamma1  | 3.002124e+00 | +1.185313e-01 | -3.132205e-01 |
| lag_freq(2).Gamma2  | 2.756718e+00 | +6.528032e-02 | -1.591259e-01 |
| lag_freq(2).xi      | 5.740796e-02 | +1.528660e+00 | -5.740796e-02 |
| lag_freq(2).b       | 2.856714e+00 | +1.432861e-01 | -7.139468e-01 |
| lag_freq(2).t_max   | 4.089292e+02 | +2.107705e+02 | -5.184468e+01 |
| lag_freq(2).t_shift | 2.393104e+01 | +7.081315e+00 | -6.846000e+00 |


#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit_0148010301.gif

pdf at:

http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit_0148010301.pdf

** 0506200201 lag_freq(3)
Use these fitting scripts (Do not run conf - already done in
=conf_mass_fit_15data.csv) :

PATH = =sim-fit-0506200201.sl=

PARFILE = =sim_fit_0506200201.par=

#+BEGIN_EXAMPLE
 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 16.05663
   Reduced chi-square = 2.293804
lag_freq(3)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(3).norm       0     1         2.766441           0          10
  2  lag_freq(3).log_mass   0     1         6.009131           6           8
  3  lag_freq(3).i          0     1               53          53          53
  4  lag_freq(3).a          0     1            0.998       0.998       0.998
  5  lag_freq(3).h1         0     1                2           2           2
  6  lag_freq(3).h2         0     1          10.5673           3          20
  7  lag_freq(3).Gamma1     0     1         2.575346         1.5       3.299
  8  lag_freq(3).Gamma2     0     1         1.844523         1.4         3.2
  9  lag_freq(3).Fe         0     1                1           1           1
 10  lag_freq(3).xi         0     1         1.499929           0           3
 11  lag_freq(3).p          0     1                0           0           0
 12  lag_freq(3).b          0     1          1.97848           1           3
 13  lag_freq(3).q2         0     1              0.5         0.5         0.5
 14  lag_freq(3).t_max      0     1         572.7486          50         800
 15  lag_freq(3).t_shift    0     1         22.02826           0         120

Can a better fit be found at this mass?

 Parameters[Variable] = 15[9]
            Data bins = 28
           Chi-square = 8.838713
   Reduced chi-square = 0.4651954
lag_freq(3)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(3).norm       0     0         11.05081           0         100
  2  lag_freq(3).log_mass   0     1         6.009131           6           8
  3  lag_freq(3).i          0     1               53          53          53
  4  lag_freq(3).a          0     1            0.998       0.998       0.998
  5  lag_freq(3).h1         0     1                2           2           2
  6  lag_freq(3).h2         0     0               11           3          20
  7  lag_freq(3).Gamma1     0     0         2.290377         1.5       3.299
  8  lag_freq(3).Gamma2     0     0         1.781822         1.4         3.2
  9  lag_freq(3).Fe         0     0                1           1           1
 10  lag_freq(3).xi         0     0         0.812407           0           3
 11  lag_freq(3).p          0     1                0           0           0
 12  lag_freq(3).b          0     0          2.92838           1           3
 13  lag_freq(3).q2         0     1              0.5         0.5         0.5
 14  lag_freq(3).t_max      0     0         532.2337          50         800
 15  lag_freq(3).t_shift    0     0         23.77378           0         120


source("conf_sim_fit.sl");

 Parameters[Variable] = 15[9]
            Data bins = 28
           Chi-square = 5.349452
   Reduced chi-square = 0.2815501
lag_freq(3)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(3).norm       0     0         93.32665           0         100
  2  lag_freq(3).log_mass   0     1         6.009131           6           8
  3  lag_freq(3).i          0     1               53          53          53
  4  lag_freq(3).a          0     1            0.998       0.998       0.998
  5  lag_freq(3).h1         0     1                2           2           2
  6  lag_freq(3).h2         0     0         3.050758           3          20
  7  lag_freq(3).Gamma1     0     0         2.235451         1.5       3.299
  8  lag_freq(3).Gamma2     0     0         1.999997         1.4         3.2
  9  lag_freq(3).Fe         0     0                1           1           1
 10  lag_freq(3).xi         0     0        0.8236687           0           3
 11  lag_freq(3).p          0     1                0           0           0
 12  lag_freq(3).b          0     0         2.999997           1           3
 13  lag_freq(3).q2         0     1              0.5         0.5         0.5
 14  lag_freq(3).t_max      0     0         528.4503          50         800
 15  lag_freq(3).t_shift    0     0         31.40182           0         120

Now fix best fit and plot

 Parameters[Variable] = 15[0]
            Data bins = 56
           Chi-square = 10.6989
   Reduced chi-square = 0.1910519
lag_freq(3)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(3).norm       0     1         93.32665           0         100
  2  lag_freq(3).log_mass   0     1         6.009131           6           8
  3  lag_freq(3).i          0     1               53          53          53
  4  lag_freq(3).a          0     1            0.998       0.998       0.998
  5  lag_freq(3).h1         0     1                2           2           2
  6  lag_freq(3).h2         0     1         3.050758           3          20
  7  lag_freq(3).Gamma1     0     1         2.235451         1.5       3.299
  8  lag_freq(3).Gamma2     0     1         1.999997         1.4         3.2
  9  lag_freq(3).Fe         0     1                1           1           1
 10  lag_freq(3).xi         0     1        0.8236687           0           3
 11  lag_freq(3).p          0     1                0           0           0
 12  lag_freq(3).b          0     1         2.999997           1           3
 13  lag_freq(3).q2         0     1              0.5         0.5         0.5
 14  lag_freq(3).t_max      0     1         528.4503          50         800
 15  lag_freq(3).t_shift    0     1         31.40182           0         120

| lag_freq(3).norm    | 9.870229e+01 | +1.297710e+00 | -9.104758e+01 |
| lag_freq(3).h2      | 4.842007e+00 | +2.111122e+00 | -1.842007e+00 |
| lag_freq(3).Gamma1  | 1.697295e+00 | +8.131585e-01 | -1.574183e-02 |
| lag_freq(3).Gamma2  | 1.400505e+00 | +1.872896e-03 | -5.052922e-04 |
| lag_freq(3).xi      | 2.999996e+00 | +3.741643e-06 | -2.999996e+00 |
| lag_freq(3).b       | 2.998923e+00 | +1.076726e-03 | -7.206864e-01 |
| lag_freq(3).t_max   | 5.243160e+02 | +7.549658e+01 | -1.611787e+02 |
| lag_freq(3).t_shift | 3.172301e+01 | +4.648003e+00 | -5.906105e+00 |


#### Change Norm back to range 0 - 10 ###

source("sim-fit-0506200201.sl");

 Parameters[Variable] = 15[8]
            Data bins = 7
           Chi-square = 2.545626
lag_freq(3)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(3).norm       0     0         9.999993           0          10
  2  lag_freq(3).log_mass   0     1         6.009131           6           8
  3  lag_freq(3).i          0     1               53          53          53
  4  lag_freq(3).a          0     1            0.998       0.998       0.998
  5  lag_freq(3).h1         0     1                2           2           2
  6  lag_freq(3).h2         0     0         4.000001           3          20
  7  lag_freq(3).Gamma1     0     0         1.792826         1.5       3.299
  8  lag_freq(3).Gamma2     0     0         1.400003         1.4         3.2
  9  lag_freq(3).Fe         0     1                1           1           1
 10  lag_freq(3).xi         0     0      0.001292572           0           3
 11  lag_freq(3).p          0     1                0           0           0
 12  lag_freq(3).b          0     0         2.988887           1           3
 13  lag_freq(3).q2         0     1              0.5         0.5         0.5
 14  lag_freq(3).t_max      0     0         516.5661          50         800
 15  lag_freq(3).t_shift    0     0          24.3583           0         120

source("conf_sim_fit.sl");

 Parameters[Variable] = 15[8]
            Data bins = 7
           Chi-square = 2.3158
lag_freq(3)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(3).norm       0     0               10           0          10
  2  lag_freq(3).log_mass   0     1         6.009131           6           8
  3  lag_freq(3).i          0     1               53          53          53
  4  lag_freq(3).a          0     1            0.998       0.998       0.998
  5  lag_freq(3).h1         0     1                2           2           2
  6  lag_freq(3).h2         0     0         5.999998           3          20
  7  lag_freq(3).Gamma1     0     0         1.957253         1.5       3.299
  8  lag_freq(3).Gamma2     0     0         1.500001         1.4         3.2
  9  lag_freq(3).Fe         0     1                1           1           1
 10  lag_freq(3).xi         0     0       0.04997822           0           3
 11  lag_freq(3).p          0     1                0           0           0
 12  lag_freq(3).b          0     0         2.629823           1           3
 13  lag_freq(3).q2         0     1              0.5         0.5         0.5
 14  lag_freq(3).t_max      0     0         499.9998          50         800
 15  lag_freq(3).t_shift    0     0         26.51247           0         120


#+END_EXAMPLE

| lag_freq(3).norm    | 1.000000e+01 | +0.000000e+00 | -3.867077e+00 |
| lag_freq(3).h2      | 5.999998e+00 | +4.299796e-01 | -2.999998e+00 |
| lag_freq(3).Gamma1  | 1.957253e+00 | +7.730543e-01 | -2.766782e-01 |
| lag_freq(3).Gamma2  | 1.500001e+00 | +1.599150e-01 | -7.014028e-02 |
| lag_freq(3).xi      | 4.997822e-02 | +2.950022e+00 | -4.997822e-02 |
| lag_freq(3).b       | 2.629823e+00 | +3.701773e-01 | -3.884759e-01 |
| lag_freq(3).t_max   | 4.999998e+02 | +3.407029e+01 | -9.980044e+01 |
| lag_freq(3).t_shift | 2.651247e+01 | +3.598070e+00 | -4.942570e+00 |

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit_0506200201.gif

pdf at:

http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit_0506200201.pdf

** 0506200301 lag_freq(4)
Use these fitting scripts (Do not run conf - already done in
=conf_mass_fit_15data.csv) :

PATH = =sim-fit-0506200301.sl=

PARFILE = =sim_fit_0506200301.par=

#+BEGIN_EXAMPLE
 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 8.558279
   Reduced chi-square = 1.222611

 lag_freq(4)
  1  lag_freq(4).norm        0     1         1.249999           0          10
  2  lag_freq(4).log_mass    0     1         6.009131           6           8
  3  lag_freq(4).i           0     1               53          53          53
  4  lag_freq(4).a           0     1            0.998       0.998       0.998
  5  lag_freq(4).h1          0     1                2           2           2
  6  lag_freq(4).h2          0     1         19.99999           3          20
  7  lag_freq(4).Gamma1      0     1         2.551217         1.5       3.299
  8  lag_freq(4).Gamma2      0     1         1.997652         1.4         3.2
  9  lag_freq(4).Fe          0     1                1           1           1
 10  lag_freq(4).xi          0     1         2.999857           0           3
 11  lag_freq(4).p           0     1                0           0           0
 12  lag_freq(4).b           0     1         2.997707           1           3
 13  lag_freq(4).q2          0     1              0.5         0.5         0.5
 14  lag_freq(4).t_max       0     1         688.4528          50         800
 15  lag_freq(4).t_shift     0     1         22.02826           0         120

Can a better fit be found?


source("conf_sim_fit.sl");

 Parameters[Variable] = 15[8]
            Data bins = 14
           Chi-square = 7.174009
   Reduced chi-square = 1.195668
lag_freq(4)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(4).norm       0     0        0.3695687           0          10
  2  lag_freq(4).log_mass   0     1         6.009131           6           8
  3  lag_freq(4).i          0     1               53          53          53
  4  lag_freq(4).a          0     1            0.998       0.998       0.998
  5  lag_freq(4).h1         0     1                2           2           2
  6  lag_freq(4).h2         0     0           11.771           3          20
  7  lag_freq(4).Gamma1     0     0         3.269593         1.5       3.299
  8  lag_freq(4).Gamma2     0     0         2.455222         1.4         3.2
  9  lag_freq(4).Fe         0     1                1           1           1
 10  lag_freq(4).xi         0     0         2.000002           0           3
 11  lag_freq(4).p          0     1                0           0           0
 12  lag_freq(4).b          0     0                3           1           3
 13  lag_freq(4).q2         0     1              0.5         0.5         0.5
 14  lag_freq(4).t_max      0     0         650.0002          50         800
 15  lag_freq(4).t_shift    0     0         69.14934           0         120

And freezing pars:

 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 3.587005
   Reduced chi-square = 0.5124292
lag_freq(4)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(4).norm       0     1        0.3695687           0          10
  2  lag_freq(4).log_mass   0     1         6.009131           6           8
  3  lag_freq(4).i          0     1               53          53          53
  4  lag_freq(4).a          0     1            0.998       0.998       0.998
  5  lag_freq(4).h1         0     1                2           2           2
  6  lag_freq(4).h2         0     1           11.771           3          20
  7  lag_freq(4).Gamma1     0     1         3.269593         1.5       3.299
  8  lag_freq(4).Gamma2     0     1         2.455222         1.4         3.2
  9  lag_freq(4).Fe         0     1                1           1           1
 10  lag_freq(4).xi         0     1         2.000002           0           3
 11  lag_freq(4).p          0     1                0           0           0
 12  lag_freq(4).b          0     1                3           1           3
 13  lag_freq(4).q2         0     1              0.5         0.5         0.5
 14  lag_freq(4).t_max      0     1         650.0002          50         800
 15  lag_freq(4).t_shift    0     1         69.14934           0         120


#+END_EXAMPLE


| lag_freq(4).norm    | 3.695687e-01 | +9.630431e+00 | -2.046667e-01 |
| lag_freq(4).h2      | 1.177100e+01 | +8.228997e+00 | -4.383548e+00 |
| lag_freq(4).Gamma1  | 3.269593e+00 | +2.940661e-02 | -1.122103e+00 |
| lag_freq(4).Gamma2  | 2.455222e+00 | +6.492893e-01 | -8.535736e-01 |
| lag_freq(4).xi      | 2.000002e+00 | +9.999984e-01 | -2.000002e+00 |
| lag_freq(4).b       | 3.000000e+00 | +9.701524e-08 | -9.702635e-01 |
| lag_freq(4).t_max   | 6.500002e+02 | +9.900866e+01 | -8.519668e+01 |
| lag_freq(4).t_shift | 6.914934e+01 | +1.241533e+01 | -1.000968e+01 |

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit_0506200301.gif

** 0506200401 lag_freq(5)

Use these fitting scripts (Do not run conf - already done in
=conf_mass_fit_15data.csv) :

PATH = =sim-fit-0506200401.sl=

PARFILE = =sim_fit_0506200401.par=

#+BEGIN_EXAMPLE

 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 17.8013
   Reduced chi-square = 2.543043

lag_freq(5)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(5).norm       0     1        0.6249996           0          10
  2  lag_freq(5).log_mass   0     1         6.009131           6           8
  3  lag_freq(5).i          0     1               53          53          53
  4  lag_freq(5).a          0     1            0.998       0.998       0.998
  5  lag_freq(5).h1         0     1                2           2           2
  6  lag_freq(5).h2         0     1         19.99999           3          20
  7  lag_freq(5).Gamma1     0     1         3.298147         1.5       3.299
  8  lag_freq(5).Gamma2     0     1         1.549413         1.4         3.2
  9  lag_freq(5).Fe         0     1                1           1           1
 10  lag_freq(5).xi         0     1         2.249964           0           3
 11  lag_freq(5).p          0     1                0           0           0
 12  lag_freq(5).b          0     1         2.956959           1           3
 13  lag_freq(5).q2         0     1              0.5         0.5         0.5
 14  lag_freq(5).t_max      0     1         693.2119          50         800
 15  lag_freq(5).t_shift    0     1         22.02826           0         120


source("conf_sim_fit.sl");

No better fit found!


#+END_EXAMPLE

| lag_freq(5).norm     | 6.249996e-01 | +4.388406e-01 | -2.931742e-01 |
| lag_freq(5).h2       | 1.999999e+01 | +1.000000e-05 | -2.311448e+00 |
| lag_freq(5).Gamma1   | 3.298147e+00 | +8.530000e-04 | -8.337650e-01 |
| lag_freq(5).Gamma2   | 1.549413e+00 | +8.849849e-01 | -9.671787e-02 |
| lag_freq(5).xi       | 2.249964e+00 | +7.500360e-01 | -2.249964e+00 |
| lag_freq(5).b        | 2.956959e+00 | +4.304100e-02 | -1.109901e+00 |
| lag_freq(5).t_max    | 6.932119e+02 | +3.033939e+01 | -2.363540e+02 |
| lag_freq(5).t_shift  | 2.202826e+01 | +1.255822e+01 | -1.166171e+01 |


#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit_0506200401.gif

pdf at

http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit_0506200401.pdf

** 0506200501 lag_freq(6)

Use these fitting scripts (Do not run conf - already done in
=conf_mass_fit_15data.csv) :

PATH = =sim-fit-0506200501.sl=

PARFILE = =sim_fit_0506200501.par=

#+BEGIN_EXAMPLE

 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 14.3065
   Reduced chi-square = 2.043786
lag_freq(6)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(6).norm       0     1           2.3026           0          10
  2  lag_freq(6).log_mass   0     1         6.009131           6           8
  3  lag_freq(6).i          0     1               53          53          53
  4  lag_freq(6).a          0     1            0.998       0.998       0.998
  5  lag_freq(6).h1         0     1                2           2           2
  6  lag_freq(6).h2         0     1         13.29654           3          20
  7  lag_freq(6).Gamma1     0     1         2.830624         1.5       3.299
  8  lag_freq(6).Gamma2     0     1          1.72311         1.4         3.2
  9  lag_freq(6).Fe         0     1                1           1           1
 10  lag_freq(6).xi         0     1         0.589275           0           3
 11  lag_freq(6).p          0     1                0           0           0
 12  lag_freq(6).b          0     1         2.384039           1           3
 13  lag_freq(6).q2         0     1              0.5         0.5         0.5
 14  lag_freq(6).t_max      0     1         711.0987          50         800
 15  lag_freq(6).t_shift    0     1         21.02826           0         120

source("conf_sim_fit.sl");

No better fit found !



#+END_EXAMPLE

| lag_freq(6).norm     | 2.302600e+00 | +7.063310e-01 | -4.404839e-01 |
| lag_freq(6).h2       | 1.329654e+01 | +5.998966e+00 | -1.487893e+00 |
| lag_freq(6).Gamma1   | 2.830624e+00 | +2.329558e-01 | -1.537812e-01 |
| lag_freq(6).Gamma2   | 1.723110e+00 | +1.808835e-01 | -4.387116e-02 |
| lag_freq(6).xi       | 5.892750e-01 | +2.329327e+00 | -5.892750e-01 |
| lag_freq(6).b        | 2.384039e+00 | +5.827607e-01 | -6.189749e-01 |
| lag_freq(6).t_max    | 7.110987e+02 | +7.442710e+00 | -2.731773e+01 |
| lag_freq(6).t_shift  | 2.102826e+01 | +4.139340e+00 | -6.894208e+00 |

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit_0506200501.gif


pdf at

http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit_0506200501.pdf

** 0511580101 lag_freq(7)

Use these fitting scripts (Do not run conf - already done in
=conf_mass_fit_15data.csv) :

PATH = =sim-fit-0511580101.sl=

PARFILE = =sim_fit_0511580101.par=

#+BEGIN_EXAMPLE

 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 4.963253
   Reduced chi-square = 0.7090362
lag_freq(7)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(7).norm       0     1         1.797167           0          10
  2  lag_freq(7).log_mass   0     1         6.009131           6           8
  3  lag_freq(7).i          0     1               53          53          53
  4  lag_freq(7).a          0     1            0.998       0.998       0.998
  5  lag_freq(7).h1         0     1                2           2           2
  6  lag_freq(7).h2         0     1          13.5749           3          20
  7  lag_freq(7).Gamma1     0     1         2.473077         1.5       3.299
  8  lag_freq(7).Gamma2     0     1         1.797652         1.4         3.2
  9  lag_freq(7).Fe         0     1                1           1           1
 10  lag_freq(7).xi         0     1           0.7857           0           3
 11  lag_freq(7).p          0     1                0           0           0
 12  lag_freq(7).b          0     1          2.81848           1           3
 13  lag_freq(7).q2         0     1              0.5         0.5         0.5
 14  lag_freq(7).t_max      0     1         693.2413          50         800
 15  lag_freq(7).t_shift    0     1         21.02826           0         120


source("conf_sim_fit.sl");

No better fit found !

#+END_EXAMPLE

| lag_freq(7).norm     | 1.797167e+00 | +1.360829e+00 | -5.268060e-01 |
| lag_freq(7).h2       | 1.357490e+01 | +6.147569e+00 | -1.743181e+00 |
| lag_freq(7).Gamma1   | 2.473077e+00 | +1.027916e-01 | -1.487882e-01 |
| lag_freq(7).Gamma2   | 1.797652e+00 | +1.857369e-01 | -1.179447e-01 |
| lag_freq(7).xi       | 7.857000e-01 | +2.013026e+00 | -7.857000e-01 |
| lag_freq(7).b        | 2.818480e+00 | +1.815200e-01 | -5.262902e-01 |
| lag_freq(7).t_max    | 6.932413e+02 | +2.182472e+01 | -1.406801e+02 |
| lag_freq(7).t_shift  | 2.102826e+01 | +2.191999e+00 | -4.078409e+00 |

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit_0511580101.gif

pdf at

http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit_0511580101.pdf

** 0511580201 lag_freq(8)

Use these fitting scripts (Do not run conf - already done in
=conf_mass_fit_15data.csv) :

PATH = =sim-fit-0511580201.sl=

PARFILE = =sim_fit_0511580201.par=

#+BEGIN_EXAMPLE
source("sim-fit-0511580201.sl");

[detached from 70956.pts-14.hm00]

 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 9.647626
   Reduced chi-square = 1.378232
lag_freq(8)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(8).norm       0     1         3.562369           0          10
  2  lag_freq(8).log_mass   0     1         6.009131           6           8
  3  lag_freq(8).i          0     1               53          53          53
  4  lag_freq(8).a          0     1            0.998       0.998       0.998
  5  lag_freq(8).h1         0     1                2           2           2
  6  lag_freq(8).h2         0     1         11.44562           3          20
  7  lag_freq(8).Gamma1     0     1         2.473077         1.5       3.299
  8  lag_freq(8).Gamma2     0     1         1.727017         1.4         3.2
  9  lag_freq(8).Fe         0     1                1           1           1
 10  lag_freq(8).xi         0     1         1.992127           0           3
 11  lag_freq(8).p          0     1                0           0           0
 12  lag_freq(8).b          0     1         2.999823           1           3
 13  lag_freq(8).q2         0     1              0.5         0.5         0.5
 14  lag_freq(8).t_max      0     1         567.8101          50         800
 15  lag_freq(8).t_shift    0     1         18.60273           0         120

source("conf_sim_fit.sl");

No better fit found !


#+END_EXAMPLE

| lag_freq(8).norm     | 3.562369e+00 | +1.428842e+00 | -8.116993e-01 |
| lag_freq(8).h2       | 1.144562e+01 | +1.700792e+00 | -6.535682e-01 |
| lag_freq(8).Gamma1   | 2.473077e+00 | +5.615184e-02 | -7.280592e-02 |
| lag_freq(8).Gamma2   | 1.727017e+00 | +9.177469e-02 | -4.886216e-02 |
| lag_freq(8).xi       | 1.992127e+00 | +4.081057e-01 | -1.992127e+00 |
| lag_freq(8).b        | 2.999823e+00 | +1.770000e-04 | -2.295307e-01 |
| lag_freq(8).t_max    | 5.678101e+02 | +4.373722e+01 | -1.095645e+02 |
| lag_freq(8).t_shift  | 1.860273e+01 | +1.524882e+00 | -1.287286e+00 |

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit_0511580201.gif

** 0511580301 lag_freq(9)

Use these fitting scripts (Do not run conf - already done in
=conf_mass_fit_15data.csv) :

PATH = =sim-fit-0511580301.sl=

PARFILE = =sim_fit_0511580301.par=

#+BEGIN_EXAMPLE
 source("sim-fit-0511580301.sl");

[detached from 76405.pts-14.hm00]

 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 8.877827
   Reduced chi-square = 1.268261
lag_freq(9)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(9).norm       0     1         4.644211           0          10
  2  lag_freq(9).log_mass   0     1         6.009131           6           8
  3  lag_freq(9).i          0     1               53          53          53
  4  lag_freq(9).a          0     1            0.998       0.998       0.998
  5  lag_freq(9).h1         0     1                2           2           2
  6  lag_freq(9).h2         0     1         11.44562           3          20
  7  lag_freq(9).Gamma1     0     1         2.473077         1.5       3.299
  8  lag_freq(9).Gamma2     0     1         1.727017         1.4         3.2
  9  lag_freq(9).Fe         0     1                1           1           1
 10  lag_freq(9).xi         0     1           0.7857           0           3
 11  lag_freq(9).p          0     1                0           0           0
 12  lag_freq(9).b          0     1         2.999956           1           3
 13  lag_freq(9).q2         0     1              0.5         0.5         0.5
 14  lag_freq(9).t_max      0     1         539.5535          50         800
 15  lag_freq(9).t_shift    0     1         18.60273           0         120
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  4.3848e-02     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-OBS-0511580301-time-lags-segs.fits


source("conf_sim_fit.sl");

No better fit found !

#+END_EXAMPLE

| lag_freq(9).norm     | 4.644211e+00 | +1.685829e+00 | -1.012708e+00 |
| lag_freq(9).h2       | 1.144562e+01 | +1.117050e+00 | -6.653131e-01 |
| lag_freq(9).Gamma1   | 2.473077e+00 | +7.532968e-02 | -4.095470e-02 |
| lag_freq(9).Gamma2   | 1.727017e+00 | +5.665758e-02 | -5.063671e-02 |
| lag_freq(9).xi       | 7.857000e-01 | +1.811778e+00 | -7.857000e-01 |
| lag_freq(9).b        | 2.999956e+00 | +4.400000e-05 | -1.942862e-01 |
| lag_freq(9).t_max    | 5.395535e+02 | +4.930025e+01 | -6.555186e+01 |
| lag_freq(9).t_shift  | 1.860273e+01 | +1.659723e+00 | -9.081181e-01 |

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit_0511580301.gif

** 0511580401 lag_freq(10)

Use these fitting scripts (Do not run conf - already done in
=conf_mass_fit_15data.csv) :

PATH = =sim-fit-0511580401.sl=

PARFILE = =sim_fit_0511580401.par=

#+BEGIN_EXAMPLE
source("sim-fit-0511580401.sl");

[detached from 70956.pts-14.hm00]

 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 10.31122
   Reduced chi-square = 1.473031
isis> list_par;
lag_freq(10)
 idx  param              tie-to  freeze         value         min         max
  1  lag_freq(10).norm       0     1          5.89689           0          10
  2  lag_freq(10).log_mass   0     1         6.009131           6           8
  3  lag_freq(10).i          0     1               53          53          53
  4  lag_freq(10).a          0     1            0.998       0.998       0.998
  5  lag_freq(10).h1         0     1                2           2           2
  6  lag_freq(10).h2         0     1         11.44562           3          20
  7  lag_freq(10).Gamma1     0     1         2.486325         1.5       3.299
  8  lag_freq(10).Gamma2     0     1         1.727017         1.4         3.2
  9  lag_freq(10).Fe         0     1                1           1           1
 10  lag_freq(10).xi         0     1           2.3571           0           3
 11  lag_freq(10).p          0     1                0           0           0
 12  lag_freq(10).b          0     1         2.999978           1           3
 13  lag_freq(10).q2         0     1              0.5         0.5         0.5
 14  lag_freq(10).t_max      0     1         336.1253          50         800
 15  lag_freq(10).t_shift    0     1         16.73007           0         120

Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  4.7228e-03     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-OBS-0511580401-time-lags-segs.fits

source("conf_sim_fit.sl");

No better fit found!

#+END_EXAMPLE

| lag_freq(10).norm    | 5.896890e+00 | +2.723114e+00 | -1.087993e+00 |
| lag_freq(10).h2      | 1.144562e+01 | +1.264328e+00 | -6.145312e-01 |
| lag_freq(10).Gamma1  | 2.486325e+00 | +5.114042e-02 | -4.096346e-02 |
| lag_freq(10).Gamma2  | 1.727017e+00 | +5.485283e-02 | -4.557347e-02 |
| lag_freq(10).xi      | 2.357100e+00 | +3.734676e-01 | -2.357100e+00 |
| lag_freq(10).b       | 2.999978e+00 | +2.200000e-05 | -1.977601e-01 |
| lag_freq(10).t_max   | 3.361253e+02 | +4.164817e+01 | -3.289254e+01 |
| lag_freq(10).t_shift | 1.673007e+01 | +1.082239e+00 | -7.366588e-01 |

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit_0511580401.gif

pdf

http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit_0511580401.pdf

** 0554710801 lag_freq(11)

Use these fitting scripts (Do not run conf - already done in
=conf_mass_fit_15data.csv) :

PATH = =sim-fit-0554710801.sl=

PARFILE = =sim_fit_0554710801.par=

#+BEGIN_EXAMPLE
source("sim-fit-0554710801.sl");

[detached from 76405.pts-14.hm00]

 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 4.173689
   Reduced chi-square = 0.5962413
isis> list_par;
lag_freq(11)
 idx  param              tie-to  freeze         value         min         max
  1  lag_freq(11).norm       0     1         5.157551           0          10
  2  lag_freq(11).log_mass   0     1         6.009131           6           8
  3  lag_freq(11).i          0     1               53          53          53
  4  lag_freq(11).a          0     1            0.998       0.998       0.998
  5  lag_freq(11).h1         0     1                2           2           2
  6  lag_freq(11).h2         0     1          7.22281           3          20
  7  lag_freq(11).Gamma1     0     1         2.602301         1.5       3.299
  8  lag_freq(11).Gamma2     0     1         1.727017         1.4         3.2
  9  lag_freq(11).Fe         0     1                1           1           1
 10  lag_freq(11).xi         0     1         2.251726           0           3
 11  lag_freq(11).p          0     1                0           0           0
 12  lag_freq(11).b          0     1         2.887321           1           3
 13  lag_freq(11).q2         0     1              0.5         0.5         0.5
 14  lag_freq(11).t_max      0     1         193.0626          50         800
 15  lag_freq(11).t_shift    0     1         14.17592           0         120

Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  7.0846e-02     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-OBS-0554710801-time-lags-segs.fits


source("conf_sim_fit.sl");

No better fit found!

#+END_EXAMPLE

| lag_freq(11).norm    | 5.157551e+00 | +2.783007e+00 | -2.360673e+00 |
| lag_freq(11).h2      | 7.222810e+00 | +1.257227e+00 | -1.394813e+00 |
| lag_freq(11).Gamma1  | 2.602301e+00 | +7.065758e-02 | -8.058225e-02 |
| lag_freq(11).Gamma2  | 1.727017e+00 | +1.317564e-01 | -1.114824e-01 |
| lag_freq(11).xi      | 2.251726e+00 | +3.798380e-01 | -2.251726e+00 |
| lag_freq(11).b       | 2.887321e+00 | +1.126790e-01 | -5.912362e-01 |
| lag_freq(11).t_max   | 1.930626e+02 | +3.224858e+01 | -3.261651e+01 |
| lag_freq(11).t_shift | 1.417592e+01 | +1.056502e+00 | -1.239833e+00 |

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit_0554710801.gif

** 0653510301 lag_freq(12)

Use these fitting scripts (Do not run conf - already done in
=conf_mass_fit_15data.csv) :

PATH = =sim-fit-0653510301.sl=

PARFILE = =sim_fit_0653510301.par=

#+BEGIN_EXAMPLE
source("sim-fit-0653510301.sl");

[detached from 70956.pts-14.hm00]

 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 5.066435
   Reduced chi-square = 0.7237764
isis> list_par;
lag_freq(12)
 idx  param              tie-to  freeze         value         min         max
  1  lag_freq(12).norm       0     1       0.08605624           0          10
  2  lag_freq(12).log_mass   0     1         6.009131           6           8
  3  lag_freq(12).i          0     1               53          53          53
  4  lag_freq(12).a          0     1            0.998       0.998       0.998
  5  lag_freq(12).h1         0     1                2           2           2
  6  lag_freq(12).h2         0     1         19.99993           3          20
  7  lag_freq(12).Gamma1     0     1         2.051151         1.5       3.299
  8  lag_freq(12).Gamma2     0     1         1.563508         1.4         3.2
  9  lag_freq(12).Fe         0     1                1           1           1
 10  lag_freq(12).xi         0     1       0.03518322           0           3
 11  lag_freq(12).p          0     1                0           0           0
 12  lag_freq(12).b          0     1          2.99956           1           3
 13  lag_freq(12).q2         0     1              0.5         0.5         0.5
 14  lag_freq(12).t_max      0     1         193.0626          50         800
 15  lag_freq(12).t_shift    0     1         81.26388           0         120
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -2.3266e-02     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-OBS-0653510301-time-lags-segs.fits

source("conf_sim_fit.sl");

#+END_EXAMPLE

| lag_freq(12).norm    | 8.605624e-02 | +1.358591e-01 | -7.259185e-02 |
| lag_freq(12).h2      | 1.999993e+01 | +7.000000e-05 | -5.811411e+00 |
| lag_freq(12).Gamma1  | 2.051151e+00 | +4.600846e-01 | -3.335330e-01 |
| lag_freq(12).Gamma2  | 1.563508e+00 | +1.502748e+00 | -1.475762e-01 |
| lag_freq(12).xi      | 3.518322e-02 | +2.964817e+00 | -3.518322e-02 |
| lag_freq(12).b       | 2.999560e+00 | +4.400000e-04 | -1.999560e+00 |
| lag_freq(12).t_max   | 1.930626e+02 | +2.349441e+02 | -1.279603e+02 |
| lag_freq(12).t_shift | 8.126388e+01 | +3.873612e+01 | -1.492191e+01 |

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit_0653510301.gif

** 0653510401 lag_freq(13)

Use these fitting scripts (Do not run conf - already done in
=conf_mass_fit_15data.csv) :

PATH = =sim-fit-0653510401.sl=

PARFILE = =sim_fit_0653510401.par=

#+BEGIN_EXAMPLE
 source("sim-fit-0653510401.sl");

[detached from 76405.pts-14.hm00]


 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 19.97358
   Reduced chi-square = 2.853369
isis> list_par;
lag_freq(13)
 idx  param              tie-to  freeze         value         min         max
  1  lag_freq(13).norm       0     1        0.2776137           0          10
  2  lag_freq(13).log_mass   0     1         6.009131           6           8
  3  lag_freq(13).i          0     1               53          53          53
  4  lag_freq(13).a          0     1            0.998       0.998       0.998
  5  lag_freq(13).h1         0     1                2           2           2
  6  lag_freq(13).h2         0     1         19.99993           3          20
  7  lag_freq(13).Gamma1     0     1         1.851051         1.5       3.299
  8  lag_freq(13).Gamma2     0     1         1.538473         1.4         3.2
  9  lag_freq(13).Fe         0     1                1           1           1
 10  lag_freq(13).xi         0     1         2.999413           0           3
 11  lag_freq(13).p          0     1                0           0           0
 12  lag_freq(13).b          0     1          2.99956           1           3
 13  lag_freq(13).q2         0     1              0.5         0.5         0.5
 14  lag_freq(13).t_max      0     1         193.0626          50         800
 15  lag_freq(13).t_shift    0     1         73.20621           0         120
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -2.6085e-02     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-OBS-0653510401-time-lags-segs.fits

source("conf_sim_fit.sl");

No better fit found!

#+END_EXAMPLE

| lag_freq(13).norm    | 2.776137e-01 | +9.039016e-02 | -9.464011e-02 |
| lag_freq(13).h2      | 1.999993e+01 | +7.000000e-05 | -3.409672e-01 |
| lag_freq(13).Gamma1  | 1.851051e+00 | +4.229471e-01 | -8.215599e-02 |
| lag_freq(13).Gamma2  | 1.538473e+00 | +2.919696e-01 | -7.510281e-02 |
| lag_freq(13).xi      | 2.999413e+00 | +5.870000e-04 | -1.167174e+00 |
| lag_freq(13).b       | 2.999560e+00 | +4.400000e-04 | -1.862257e+00 |
| lag_freq(13).t_max   | 1.930626e+02 | +5.158036e+01 | -7.073673e+01 |
| lag_freq(13).t_shift | 7.320621e+01 | +1.316515e+01 | -6.829068e+00 |

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit_0653510401.gif

pdf

http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit_0653510401.pdf

** 0653510501 lag_freq(14)

Use these fitting scripts (Do not run conf - already done in
=conf_mass_fit_15data.csv) :

PATH = =sim-fit-0653510501.sl=

PARFILE = =sim_fit_0653510501.par=

#+BEGIN_EXAMPLE
source("sim-fit-0653510501.sl");

[detached from 70956.pts-14.hm00]

Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 16.83527
   Reduced chi-square = 2.405039
lag_freq(14)
 idx  param              tie-to  freeze         value         min         max
  1  lag_freq(14).norm       0     1        0.1628152           0          10
  2  lag_freq(14).log_mass   0     1         6.009131           6           8
  3  lag_freq(14).i          0     1               53          53          53
  4  lag_freq(14).a          0     1            0.998       0.998       0.998
  5  lag_freq(14).h1         0     1                2           2           2
  6  lag_freq(14).h2         0     1         19.99993           3          20
  7  lag_freq(14).Gamma1     0     1         2.775173         1.5       3.299
  8  lag_freq(14).Gamma2     0     1         1.538473         1.4         3.2
  9  lag_freq(14).Fe         0     1                1           1           1
 10  lag_freq(14).xi         0     1       0.07030791           0           3
 11  lag_freq(14).p          0     1                0           0           0
 12  lag_freq(14).b          0     1          1.49989           1           3
 13  lag_freq(14).q2         0     1              0.5         0.5         0.5
 14  lag_freq(14).t_max      0     1         516.8848          50         800
 15  lag_freq(14).t_shift    0     1         73.20621           0         120
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -1.3605e-02     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-OBS-0653510501-time-lags-segs.fits


| lag_freq(14).norm    | 1.628152e-01 | +1.833087e-01 | -1.067484e-01 |
| lag_freq(14).h2      | 1.999993e+01 | +7.000000e-05 | -2.643475e+00 |
| lag_freq(14).Gamma1  | 2.775173e+00 | +5.238267e-01 | -1.035746e+00 |
| lag_freq(14).Gamma2  | 1.538473e+00 | +1.595188e+00 | -1.041389e-01 |
| lag_freq(14).xi      | 7.030791e-02 | +2.929692e+00 | -7.030791e-02 |
| lag_freq(14).b       | 1.499890e+00 | +1.500110e+00 | -4.998900e-01 |
| lag_freq(14).t_max   | 5.168848e+02 | +2.114014e+02 | -4.416626e+02 |
| lag_freq(14).t_shift | 7.320621e+01 | +4.329277e+01 | -7.320621e+01 |


source("conf_sim_fit.sl");

###  Found a better fit:  ######

Parameter 15 = 2.585342e+01 (2.065886e+01 - 2.958837e+01)
 Parameters[Variable] = 15[8]
            Data bins = 7
           Chi-square = 2.107307
lag_freq(14)
 idx  param              tie-to  freeze         value         min         max
  1  lag_freq(14).norm       0     0               10           0          10
  2  lag_freq(14).log_mass   0     1         6.009131           6           8
  3  lag_freq(14).i          0     1               53          53          53
  4  lag_freq(14).a          0     1            0.998       0.998       0.998
  5  lag_freq(14).h1         0     1                2           2           2
  6  lag_freq(14).h2         0     0               20           3          20
  7  lag_freq(14).Gamma1     0     0         2.303189         1.5       3.299
  8  lag_freq(14).Gamma2     0     0              1.6         1.4         3.2
  9  lag_freq(14).Fe         0     1                1           1           1
 10  lag_freq(14).xi         0     0         1.124741           0           3
 11  lag_freq(14).p          0     1                0           0           0
 12  lag_freq(14).b          0     0         2.509718           1           3
 13  lag_freq(14).q2         0     1              0.5         0.5         0.5
 14  lag_freq(14).t_max      0     0         400.0002          50         800
 15  lag_freq(14).t_shift    0     0         25.85342           0         120

Frezee pars and fit again


 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 2.107307
   Reduced chi-square = 0.3010439
isis> plot_data({1}, popt);
isis> list_par;
lag_freq(14)
 idx  param              tie-to  freeze         value         min         max
  1  lag_freq(14).norm       0     1               10           0          10
  2  lag_freq(14).log_mass   0     1         6.009131           6           8
  3  lag_freq(14).i          0     1               53          53          53
  4  lag_freq(14).a          0     1            0.998       0.998       0.998
  5  lag_freq(14).h1         0     1                2           2           2
  6  lag_freq(14).h2         0     1               20           3          20
  7  lag_freq(14).Gamma1     0     1         2.303189         1.5       3.299
  8  lag_freq(14).Gamma2     0     1              1.6         1.4         3.2
  9  lag_freq(14).Fe         0     1                1           1           1
 10  lag_freq(14).xi         0     1         1.124741           0           3
 11  lag_freq(14).p          0     1                0           0           0
 12  lag_freq(14).b          0     1         2.509718           1           3
 13  lag_freq(14).q2         0     1              0.5         0.5         0.5
 14  lag_freq(14).t_max      0     1         400.0002          50         800
 15  lag_freq(14).t_shift    0     1         25.85342           0         120
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -1.3605e-02     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-OBS-0653510501-time-lags-segs.fits

#+END_EXAMPLE

| lag_freq(14).norm    | 1.000000e+01 | +1.007113e-08 | -4.185108e+00 |
| lag_freq(14).h2      | 2.000000e+01 | +4.434645e-07 | -7.618226e+00 |
| lag_freq(14).Gamma1  | 2.303189e+00 | +2.861453e-01 | -4.281699e-02 |
| lag_freq(14).Gamma2  | 1.600000e+00 | +1.274656e+00 | -1.418462e-01 |
| lag_freq(14).xi      | 1.124741e+00 | +1.875259e+00 | -1.124741e+00 |
| lag_freq(14).b       | 2.509718e+00 | +4.902820e-01 | -2.953292e-01 |
| lag_freq(14).t_max   | 4.000002e+02 | +3.506403e+01 | -1.726176e+01 |
| lag_freq(14).t_shift | 2.585342e+01 | +3.734949e+00 | -5.194565e+00 |


#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit_0653510501.gif

pdf

http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit_0653510501.pdf

** 0653510601 lag_freq(15)

Use these fitting scripts (Do not run conf - already done in
=conf_mass_fit_15data.csv) :

PATH = =sim-fit-0653510601.sl=

PARFILE = =sim_fit_0653510601.par=

#+BEGIN_EXAMPLE
source("sim-fit-0653510601.sl");

[detached from 76405.pts-14.hm00]

Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 17.32783
   Reduced chi-square = 2.475405
lag_freq(15)
 idx  param              tie-to  freeze         value         min         max
  1  lag_freq(15).norm       0     1        0.3561122           0          10
  2  lag_freq(15).log_mass   0     1         6.009131           6           8
  3  lag_freq(15).i          0     1               53          53          53
  4  lag_freq(15).a          0     1            0.998       0.998       0.998
  5  lag_freq(15).h1         0     1                2           2           2
  6  lag_freq(15).h2         0     1         19.99993           3          20
  7  lag_freq(15).Gamma1     0     1         3.298983         1.5       3.299
  8  lag_freq(15).Gamma2     0     1         1.487196         1.4         3.2
  9  lag_freq(15).Fe         0     1                1           1           1
 10  lag_freq(15).xi         0     1         2.999991           0           3
 11  lag_freq(15).p          0     1                0           0           0
 12  lag_freq(15).b          0     1          1.99978           1           3
 13  lag_freq(15).q2         0     1              0.5         0.5         0.5
 14  lag_freq(15).t_max      0     1         514.9456          50         800
 15  lag_freq(15).t_shift    0     1         94.09409           0         120
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  5.8671e-02     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-OBS-0653510601-time-lags-segs.fits


source("conf_sim_fit.sl");

No better fit found !

#+END_EXAMPLE

| lag_freq(15).norm    | 3.561122e-01 | +1.455527e-01 | -9.391242e-02 |
| lag_freq(15).h2      | 1.999993e+01 | +7.000000e-05 | -2.636953e-01 |
| lag_freq(15).Gamma1  | 3.298983e+00 | +1.736929e-05 | -5.276944e-01 |
| lag_freq(15).Gamma2  | 1.487196e+00 | +5.861663e-01 | -2.299501e-02 |
| lag_freq(15).xi      | 2.999991e+00 | +9.171875e-06 | -2.999991e+00 |
| lag_freq(15).b       | 1.999780e+00 | +1.000220e+00 | -7.253430e-01 |
| lag_freq(15).t_max   | 5.149456e+02 | +1.957994e+02 | -1.076493e+02 |
| lag_freq(15).t_shift | 9.409409e+01 | +1.445840e+01 | -1.070909e+01 |


#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit_0653510601.gif

pdf

http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit_0653510601.pdf

** *Resultant simultaneous fits (at a glance)*

PATH =
=/home/steff075/phd_ecm/results-spectral1H0707_flux_lag_relxill_indobs.ods=

| 1H0707_obs | 1H_h2 |    + |    - | 1H_g1 |    + |    - | 1H_g2 |    + |    - | 1H_xi |    + |    - | 1H_b |    + |    - | 1H_tmax |      + |      - | 1H_tshift |     + |     - |  Chi |
|  110890201 | 14.98 | 4.34 | 1.76 |  2.35 | 0.06 | 0.07 |  1.92 | 0.08 | 0.08 |  2.62 | 0.38 | 2.62 | 2.40 | 0.21 | 0.25 |  494.57 |  80.70 |  67.41 |     30.77 |  2.07 |  4.39 | 0.29 |
|  148010301 |       |      |      |       |      |      |       |      |      |       |      |      |      |      |      |         |        |        |           |       |       |      |
|  506200201 |  4.84 | 2.11 | 1.84 |  1.70 | 0.81 | 0.02 |  1.40 | 0.00 | 0.00 |  1.40 | 0.00 | 0.00 | 3.00 | 0.00 | 0.72 |  524.32 |  75.50 | 161.18 |     31.72 |  4.65 |  5.91 | 0.19 |
|  506200301 | 11.77 | 8.23 | 4.38 |  3.27 | 0.03 | 1.12 |  2.46 | 0.65 | 0.85 |  2.00 | 1.00 | 2.00 | 3.00 | 0.00 | 0.97 |  650.00 |  99.01 |  85.20 |     69.15 | 12.42 | 10.01 | 0.51 |
|  506200401 | 20.00 | 0.00 | 2.31 |  3.30 | 0.00 | 0.83 |  1.55 | 0.88 | 0.10 |  2.25 | 0.75 | 2.25 | 2.96 | 0.04 | 1.11 |  693.21 |  30.34 | 236.35 |     22.03 | 12.56 | 11.66 | 2.54 |
|  506200501 | 13.30 | 6.00 | 1.49 |  2.83 | 0.23 | 0.15 |  1.72 | 0.18 | 0.04 |  0.59 | 2.33 | 0.59 | 2.38 | 0.58 | 0.62 |  711.10 |   7.44 |  27.32 |     21.03 |  4.14 |  6.89 | 2.04 |
|  511580101 | 13.57 | 6.15 | 1.74 |  2.47 | 0.10 | 0.15 |  1.80 | 0.19 | 0.12 |  0.79 | 2.01 | 0.79 | 2.82 | 0.18 | 0.53 |  693.24 |  21.82 | 140.68 |     21.03 |  2.19 |  4.08 | 0.71 |
|  511580201 | 11.45 | 1.70 | 0.65 |  2.47 | 0.06 | 0.07 |  1.73 | 0.09 | 0.05 |  1.99 | 0.41 | 1.99 | 3.00 | 0.00 | 0.23 |  567.81 |  43.74 | 109.56 |     18.60 |  1.52 |  1.29 | 1.38 |
|  511580301 | 11.45 | 1.12 | 0.67 |  2.47 | 0.08 | 0.04 |  1.73 | 0.06 | 0.05 |  0.79 | 1.81 | 0.79 | 3.00 | 0.00 | 0.19 |  539.55 |  49.30 |  65.55 |     18.60 |  1.66 |  0.91 | 1.27 |
|  511580401 | 11.45 | 1.26 | 0.61 |  2.49 | 0.05 | 0.04 |  1.73 | 0.05 | 0.05 |  2.36 | 0.37 | 2.36 | 3.00 | 0.00 | 0.20 |  336.13 |  41.65 |  32.89 |     16.73 |  1.08 |  0.74 | 1.47 |
|  554710801 |  7.22 | 1.26 | 1.39 |  2.60 | 0.07 | 0.08 |  1.73 | 0.13 | 0.11 |  2.25 | 0.38 | 2.25 | 2.89 | 0.11 | 0.59 |  193.06 |  32.25 |  32.62 |     14.18 |  1.06 |  1.24 | 0.59 |
|  653510301 | 20.00 | 0.00 | 5.81 |  2.05 | 0.46 | 0.33 |  1.56 | 1.50 | 0.15 |  0.04 | 2.96 | 0.04 | 3.00 | 0.00 | 2.00 |  193.06 | 234.94 | 127.96 |     81.26 | 38.74 | 14.92 | 0.72 |
|  653510401 | 20.00 | 0.00 | 0.34 |  1.85 | 0.42 | 0.08 |  1.54 | 0.29 | 0.08 |  3.00 | 0.00 | 1.17 | 3.00 | 0.00 | 1.86 |  193.06 |  51.58 |  70.74 |     73.21 | 13.17 |  6.83 | 2.85 |
|  653510501 | 20.00 | 0.00 | 7.62 |  2.30 | 0.29 | 0.04 |  1.60 | 1.27 | 0.14 |  1.12 | 1.88 | 1.12 | 2.51 | 0.49 | 0.30 |  400.00 |  35.06 |  17.26 |     25.85 |  3.73 |  5.19 | 0.30 |
|  653510601 | 20.00 | 0.00 | 0.26 |  3.30 | 0.00 | 0.53 |  1.49 | 0.59 | 0.02 |  3.00 | 0.00 | 2.99 | 2.00 | 1.00 | 0.73 |  514.95 | 195.80 | 107.65 |     94.09 | 14.46 | 10.71 | 2.45 |

** Quick ECM overview

VEUSZ =
=/home/steff075/phd_ecm/results-spectral/1H0707_L2-10_V_ECM_indobs.vsz=


WAIT !! Plot both IRAS and 1H0707 together....


VEUSZ =
=/home/steff075/phd_ecm/results-spectral/1H0707_AND_IRAS_L2-10_V_ECM_indobs.vsz=

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H_AND_IRAS_L2-10_V_ECM_indobs.png

pdf at:

http://www.star.bris.ac.uk/steff/ecm/1H_AND_IRAS_L2-10_V_ECM_indobs.pdf

** Explore 1H0707 ECM simultaneous individual fits Correlations

PATH =
=/home/steff075/phd_ecm/results-spectral/spearman_1H0707_ECM.py=

| Lag - Edd_frac          | SpearmanrResult(correlation= | -0.38214285714285706 | pvalue=0.1598236299869673)    |
| Lag - Ref_F             | SpearmanrResult(correlation= |  -0.2785714285714285 | pvalue=0.3147094732307908)    |
| Lag - Plaw_F            | SpearmanrResult(correlation= |  -0.3142857142857143 | pvalue=0.2539400163236714)    |
| Lag - Gamma_Plaw        | SpearmanrResult(correlation= | -0.21805191906310872 | pvalue=0.43497209127042924)   |
| Lag - nH                | SpearmanrResult(correlation= |  0.05714285714285713 | pvalue=0.8396998687415758)    |
| Lag - Cvr               | SpearmanrResult(correlation= |   0.5652960744757709 | pvalue=0.028087859798934123)  |
| Lag - h2_ecm            | SpearmanrResult(correlation= | 0.051107145278399796 | pvalue=0.8564601672671224)    |
| Lag - g2_ecm            | SpearmanrResult(correlation= |  -0.3279412364211835 | pvalue=0.2327596701043642)    |
| Lag - h2_ecm            | SpearmanrResult(correlation= | 0.051107145278399796 | pvalue=0.8564601672671224)    |
| Lag - g1_ecm            | SpearmanrResult(correlation= | -0.49865972231725175 | pvalue=0.05847998810109107)   |
| Lag - xi_ecm            | SpearmanrResult(correlation= |  0.23276717792189358 | pvalue=0.4038007012851381)    |
| Lag - b_ecm             | SpearmanrResult(correlation= |  0.03388154635894692 | pvalue=0.9045847559573208)    |
| Lag - tmax_ecm          | SpearmanrResult(correlation= |  -0.5591433765314701 | pvalue=0.030236477702548285)  |
| Lag - tshift_ecm        | SpearmanrResult(correlation= | -0.04830061395837283 | pvalue=0.864273352639302)     |

| Edd_frac - nH           | SpearmanrResult(correlation= | -0.03214285714285714 | pvalue=0.9094621170945906)    |
| Edd_frac - Cvr          | SpearmanrResult(correlation= | -0.35957123724566437 | pvalue=0.18805683979330176)   |
| Edd_frac - Ref_F        | SpearmanrResult(correlation= |   0.9464285714285712 | pvalue=9.447938510352392e-08) |
| Edd_frac - Plaw_F       | SpearmanrResult(correlation= |   0.9464285714285712 | pvalue=9.447938510352392e-08) |
| Edd_frac - Gamma_Plaw   | SpearmanrResult(correlation= |   0.5111708922299105 | pvalue=0.05148146272291397)   |
| Edd_frac - xi           | SpearmanrResult(correlation= | 0.010723864871956167 | pvalue=0.9697428601602291)    |
| Edd_frac - Fe           | SpearmanrResult(correlation= |   -0.325427966445015 | pvalue=0.23657236139486468)   |
| Edd_frac - RF           | SpearmanrResult(correlation= | -0.43301270189221924 | pvalue=0.1069075395762958)    |
| Edd_frac - h2_ecm       | SpearmanrResult(correlation= | 0.003650510377028557 | pvalue=0.9896982483317276)    |
| Edd_frac - g1_ecm       | SpearmanrResult(correlation= |   0.3497793016254103 | pvalue=0.2012490451214099)    |
| Edd_frac - g2_ecm       | SpearmanrResult(correlation= |  0.13514061940433383 | pvalue=0.6310826593309268)    |
| Edd_frac - xi_ecm       | SpearmanrResult(correlation= | -0.32050249883091503 | pvalue=0.2441562603895384)    |
| Edd_frac - b_ecm        | SpearmanrResult(correlation= | -0.07529232524210426 | pvalue=0.7897111297450292)    |
| Edd_frac - tmax_ecm     | SpearmanrResult(correlation= |   0.4587843089488985 | pvalue=0.08540883778954539)   |
| Edd_frac - tshift_ecm   | SpearmanrResult(correlation= |  -0.3184262697996431 | pvalue=0.24739749375293127)   |

| L2_10 - h2_ecm     | SpearmanrResult(correlation= | 0.003650510377028557 | pvalue=0.9896982483317276)    |
| L2_10 - g1_ecm     | SpearmanrResult(correlation= |   0.3497793016254103 | pvalue=0.2012490451214099)    |
| L2_10 - g2_ecm     | SpearmanrResult(correlation= |  0.13514061940433383 | pvalue=0.6310826593309268)    |
| L2_10 - xi_ecm     | SpearmanrResult(correlation= | -0.32050249883091503 | pvalue=0.2441562603895384)    |
| L2_10 - b_ecm      | SpearmanrResult(correlation= | -0.07529232524210426 | pvalue=0.7897111297450292)    |
| L2_10 - tmax_ecm   | SpearmanrResult(correlation= |   0.4587843089488985 | pvalue=0.08540883778954539)   |
| L2_10 - tshift_ecm | SpearmanrResult(correlation= |  -0.3184262697996431 | pvalue=0.24739749375293127)   |
| L2_10 - nH         | SpearmanrResult(correlation= | -0.03214285714285714 | pvalue=0.9094621170945906)    |
| L2_10 - Cvr        | SpearmanrResult(correlation= | -0.35957123724566437 | pvalue=0.18805683979330176)   |
| L2_10 - Ref_F      | SpearmanrResult(correlation= |   0.9464285714285712 | pvalue=9.447938510352392e-08) |
| L2_10 - Plaw_F     | SpearmanrResult(correlation= |   0.9464285714285712 | pvalue=9.447938510352392e-08) |
| L2_10 - Gamma_Plaw | SpearmanrResult(correlation= |   0.5111708922299105 | pvalue=0.05148146272291397)   |
| L2_10 - xi         | SpearmanrResult(correlation= | 0.010723864871956167 | pvalue=0.9697428601602291)    |
| L2_10 - Fe         | SpearmanrResult(correlation= |   -0.325427966445015 | pvalue=0.23657236139486468)   |
| L2_10 - inc        | SpearmanrResult(correlation= | -0.01621687432852006 | pvalue=0.954256869509938)     |

| h2_ecm - Gamma_Relx | SpearmanrResult(correlation= |    0.3703586420386163 | pvalue=0.17418765586680757) |
| h2_ecm - xi         | SpearmanrResult(correlation= |   -0.2064382385171337 | pvalue=0.4604064240057816)  |
| h2_ecm - Fe         | SpearmanrResult(correlation= |  -0.07027476489616731 | pvalue=0.8034632193398138)  |
| h2_ecm - RF         | SpearmanrResult(correlation= |                   0.0 | pvalue=1.0)                 |
| h2_ecm - inc        | SpearmanrResult(correlation= |  -0.21732929326170844 | pvalue=0.4365335005586244)  |
| h2_ecm - g1_ecm     | SpearmanrResult(correlation= | -0.055003758718606376 | pvalue=0.8456328887385912)  |
| h2_ecm - g2_ecm     | SpearmanrResult(correlation= |  -0.44202568121025443 | pvalue=0.09900209011877752) |
| h2_ecm - Lag        | SpearmanrResult(correlation= |  0.051107145278399796 | pvalue=0.8564601672671224)  |
| h2_ecm - L2_10      | SpearmanrResult(correlation= | 0.0036505103770285564 | pvalue=0.9896982483317276)  |
| h2_ecm - xi_ecm     | SpearmanrResult(correlation= |   0.26354361551477207 | pvalue=0.3425816920797683)  |
| h2_ecm - b_ecm      | SpearmanrResult(correlation= |   -0.2809022337282629 | pvalue=0.310507637065949)   |
| h2_ecm - tmax_ecm   | SpearmanrResult(correlation= |  -0.05495427264586317 | pvalue=0.8457702360278675)  |
| h2_ecm - tshift_ecm | SpearmanrResult(correlation= |    0.5467284754720987 | pvalue=0.03494647312286854) |

| g1_ecm - Gamma_Plaw     | SpearmanrResult(correlation= |  0.16696696503455744 | pvalue=0.5520040938013593)    |
| g1_ecm - g2_ecm         | SpearmanrResult(correlation= |   0.2696860187895337 | pvalue=0.3310265381647831)    |
| g1_ecm - Gamma_Relx     | SpearmanrResult(correlation= | -0.06306306306306306 | pvalue=0.8233221296249045)    |
| g1_ecm - xi             | SpearmanrResult(correlation= |  -0.5044915825237702 | pvalue=0.05513650531678795)   |
| g1_ecm - Fe             | SpearmanrResult(correlation= | -0.37753558952322724 | pvalue=0.16534242660568432)   |
| g1_ecm - RF             | SpearmanrResult(correlation= | -0.18641092980035998 | pvalue=0.505921312215124)     |
| g1_ecm - inc            | SpearmanrResult(correlation= |  -0.1276031162729002 | pvalue=0.6504113253163583)    |
| g1_ecm - b_ecm          | SpearmanrResult(correlation= |  -0.3611366852310984 | pvalue=0.18600113401933824)   |
| g1_ecm - tmax_ecm       | SpearmanrResult(correlation= |    0.405040668124722 | pvalue=0.1342144353126159)    |
| g1_ecm - tshift_ecm     | SpearmanrResult(correlation= | -0.17250736520251428 | pvalue=0.5386910917704228)    |

| g2_ecm - Gamma_Relx     | SpearmanrResult(correlation= |  -0.23801148638136702 | pvalue=0.3929839538146608)  |
| g2_ecm - xi             | SpearmanrResult(correlation= |   -0.1893660195173924 | pvalue=0.4990776282435846)  |
| g2_ecm - Fe             | SpearmanrResult(correlation= |  -0.17112399732326572 | pvalue=0.5420018708257945)  |
| g2_ecm - RF             | SpearmanrResult(correlation= |  0.062418778393235924 | pvalue=0.8251013291125464)  |
| g2_ecm - inc            | SpearmanrResult(correlation= |  -0.11363636363636367 | pvalue=0.6867711491457411)  |
| g2_ecm - b_ecm          | SpearmanrResult(correlation= | -0.05508094528882501, | pvalue=0.8454186676850455)  |
| g2_ecm - tmax_ecm       | SpearmanrResult(correlation= |   0.15009262455251468 | pvalue=0.593399579816293)   |
| g2_ecm - tshift_ecm     | SpearmanrResult(correlation= |  -0.3989273659910934, | pvalue=0.1407586520553698)  |

| xi_ecm - Gamma_Relx | SpearmanrResult(correlation= |   -0.1223023560867304 | pvalue=0.664130033463775)   |
| xi_ecm - xi         | SpearmanrResult(correlation= |   -0.4578860399506809 | pvalue=0.08610179866288811) |
| xi_ecm - Fe         | SpearmanrResult(correlation= |   0.13327875814823112 | pvalue=0.6358370869092)     |
| xi_ecm - RF         | SpearmanrResult(correlation= |    0.3101265988424187 | pvalue=0.2606173168185147)  |
| xi_ecm - inc        | SpearmanrResult(correlation= |    0.2195165838888997 | pvalue=0.4318160393777327)  |
| xi_ecm - b_ecm      | SpearmanrResult(correlation= | -0.047184259407874525 | pvalue=0.8673844909005564)  |
| xi_ecm - tmax_ecm   | SpearmanrResult(correlation= |  -0.22461823980834403 | pvalue=0.42091468237337293) |
| xi_ecm - tshift_ecm | SpearmanrResult(correlation= |   0.13632292478149657 | pvalue=0.6280704766555646)  |
| xi_ecm - L2_10      | SpearmanrResult(correlation= |  -0.32050249883091503 | pvalue=0.2441562603895384)  |
| xi_ecm - h2_ecm     | SpearmanrResult(correlation= |   0.26354361551477207 | pvalue=0.3425816920797683)  |
| xi_ecm - Edd_frac   | SpearmanrResult(correlation= |  -0.32050249883091503 | pvalue=0.2441562603895384)  |
| xi_ecm - Lag        | SpearmanrResult(correlation= |   0.23276717792189358 | pvalue=0.4038007012851381)  |
| xi_ecm - nH         | SpearmanrResult(correlation= |  -0.22381459415566693 | pvalue=0.42262243884985606) |
| xi_ecm - Cvr        | SpearmanrResult(correlation= |    0.0224215336811672 | pvalue=0.9367830949759269)  |



| b_ecm- Gamma_Relx       | SpearmanrResult(correlation= |    0.2117660143763509 | pvalue=0.4486488091763484)  |
| b_ecm - xi              | SpearmanrResult(correlation= |   0.37868219452030755 | pvalue=0.16395736071413872) |
| b_ecm - Fe              | SpearmanrResult(correlation= |    0.3768511731740915 | pvalue=0.16617285718321234) |
| b_ecm - RF              | SpearmanrResult(correlation= |    0.3912303982179758 | pvalue=0.14930013667916112) |
| b_ecm - inc             | SpearmanrResult(correlation= |   -0.3038948705590345 | pvalue=0.27081983100053697) |

| tmax_ecm - Gamma_Relx | SpearmanrResult(correlation= | -0.22322241265540235 | pvalue=0.42388311049988403)  |
| tmax_ecm - xi         | SpearmanrResult(correlation= |  0.27085299832347187 | pvalue=0.3288565754481012)   |
| tmax_ecm - Fe         | SpearmanrResult(correlation= |  0.11499875802012004 | pvalue=0.6831947238197353)   |
| tmax_ecm - RF         | SpearmanrResult(correlation= |  -0.4345675101331315 | pvalue=0.10551344492896547)  |
| tmax_ecm - inc        | SpearmanrResult(correlation= |  -0.3182686978462962 | pvalue=0.2476445570148352)   |
| tmax_ecm- b_ecm       | SpearmanrResult(correlation= |  -0.2153536253865071 | pvalue=0.44081686156994404)  |
| tmax_ecm- tshift_ecm  | SpearmanrResult(correlation= | -0.16517082274391834 | pvalue=0.5563502712845182)   |
| tmax_ecm - L2_10      | SpearmanrResult(correlation= |   0.4587843089488985 | pvalue=0.08540883778954539)  |
| tmax_ecm - h2_ecm     | SpearmanrResult(correlation= | -0.05495427264586316 | pvalue=0.8457702360278676)   |
| tmax_ecm - Edd_frac   | SpearmanrResult(correlation= |   0.4587843089488985 | pvalue=0.08540883778954539)  |
| tmax_ecm - Lag        | SpearmanrResult(correlation= |  -0.5591433765314701 | pvalue=0.030236477702548285) |
| tmax_ecm - nH         | SpearmanrResult(correlation= | -0.13978584413286751 | pvalue=0.6192793544842077)   |
| tmax_ecm - Cvr        | SpearmanrResult(correlation= |  -0.6588879559458481 | pvalue=0.007552897444385716) |

| tshift_ecm - Gamma_Relx | SpearmanrResult(correlation= |   -0.1671165100399357 | pvalue=0.5516428977723569)  |
| tshift_ecm - xi         | SpearmanrResult(correlation= |  -0.34198760347637597 | pvalue=0.21215961718518178) |
| tshift_ecm - Fe         | SpearmanrResult(correlation= |   0.36733594257571733 | pvalue=0.17800407379273772) |
| tshift_ecm - RF         | SpearmanrResult(correlation= |    0.1549242915049486 | pvalue=0.5814198073693431)  |
| tshift_ecm - inc        | SpearmanrResult(correlation= |   0.07220404814318432 | pvalue=0.7981688998498444)  |
| tshift_ecm- b_ecm       | SpearmanrResult(correlation= |  -0.08108417231108783 | pvalue=0.773908424921767)   |
| tshift_ecm - L2_10      | SpearmanrResult(correlation= |   -0.3184262697996431 | pvalue=0.24739749375293127) |
| tshift_ecm - h2_ecm     | SpearmanrResult(correlation= |    0.5467284754720987 | pvalue=0.03494647312286854) |
| tshift_ecm - Edd_frac   | SpearmanrResult(correlation= |   -0.3184262697996431 | pvalue=0.24739749375293127) |
| tshift_ecm - Lag        | SpearmanrResult(correlation= | -0.048300613958372825 | pvalue=0.864273352639302)   |
| tshift_ecm - nH         | SpearmanrResult(correlation= |   0.14847966513129424 | pvalue=0.5974207767660411)  |
| tshift_ecm - Cvr        | SpearmanrResult(correlation= |   0.07526881720430109 | pvalue=0.7897754294939221)  |

* 1H0707-495 Simultaneous Mass fits where log M ranges 5.5 - 8.0 with confloop and subplex

** First data set

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/mass-fit-1data.sl=

Code:
#+BEGIN_EXAMPLE
variable p = [2,3,7,8,9,11,13,15,16];

variable all_good, good, i, pmin, pmax;

do {
	vmessage("\n\n--Starting to determine confidence intervals--\n");
	all_good = 1;
	fp = fopen("conf_mass2_fit_1data_subloop.csv","w");% Create the file
        for (i=0; i<length(p); i++) {
		do {
			good = 1;
			(pmin, pmax) = conf_loop(p[i]; num_slaves=16);
			vmessage("  Parameter %i = %e (%e - %e)", p[i], get_par(p[i]), pmin, pmax);
			() = fprintf(fp, "%s,%e,+%e,-%e\n", get_par_info(p[i]).name, get_par(p[i]), pmax-get_par(p[i]), get_par(p[i])-pmin);
                        if (pmin == pmax) {
				% this means that a better fit was found
				vmessage("Found a better fit!");
				() = fit_counts;
				good = 0;
				all_good = 0;
			}
		} while (good == 0);
		%vmessage("Parameter %i = %e (%e - %e)", p[i], get_par(p[i]), pmin, pmax);
	}
        () = fclose(fp);
} while (all_good == 0);

save_par("conf_mass2_fit_1data_subloop.par");
()=eval_counts;
list_par;
#+END_EXAMPLE

gedit =confloop_1data.csv=

| lag_freq(1).norm     | 9.999881e+00 | +1.192508e-04 | -9.374888e+00 |
| lag_freq(1).log_mass | 6.711052e+00 | +3.502788e-02 | -5.772462e-01 |
| lag_freq(1).h2       | 1.261491e+01 | +7.385085e+00 | -9.897291e-01 |
| lag_freq(1).Gamma1   | 2.340262e+00 | +9.587384e-01 | -8.735255e-02 |
| lag_freq(1).Gamma2   | 1.732820e+00 | +1.153184e+00 | -1.396740e-01 |
| lag_freq(1).xi       | 2.999988e+00 | +1.246673e-05 | -2.999988e+00 |
| lag_freq(1).b        | 2.874912e+00 | +1.250883e-01 | -5.433732e-01 |
| lag_freq(1).t_max    | 3.080663e+02 | +4.373662e+02 | -1.228907e+02 |
| lag_freq(1).t_shift  | 2.132153e+01 | +5.542917e+00 | -5.684087e+00 |

** First 2 data sets

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/mass-fit.sl=

[detached from 56100.pts-7.hm00]

gedit =confloop_2data.csv=

| lag_freq(1).norm     | 9.999983e+00 | +1.745850e-05 | -9.487456e+00 |
| lag_freq(1).log_mass | 6.883014e+00 | +7.337083e-02 | -1.037260e+00 |
| lag_freq(1).h2       | 1.446818e+01 | +5.531823e+00 | -2.491052e+00 |
| lag_freq(1).Gamma1   | 2.544451e+00 | +2.806462e-01 | -6.794959e-02 |
| lag_freq(1).Gamma2   | 1.667398e+00 | +5.504175e-01 | -2.673975e-01 |
| lag_freq(1).xi       | 9.705646e-01 | +2.029435e+00 | -9.705646e-01 |
| lag_freq(1).b        | 2.993494e+00 | +6.506199e-03 | -1.322751e+00 |
| lag_freq(1).t_max    | 2.250501e+02 | +1.218030e+02 | -1.008330e+02 |
| lag_freq(1).t_shift  | 1.841538e+01 | +6.570254e+00 | -6.424045e+00 |
| lag_freq(2).norm     | 4.103445e+00 | +5.896555e+00 | -3.590515e+00 |
| lag_freq(2).h2       | 1.889143e+01 | +1.108573e+00 | -5.822337e+00 |
| lag_freq(2).Gamma1   | 3.299000e+00 | +2.556185e-08 | -8.867413e-01 |
| lag_freq(2).Gamma2   | 1.500001e+00 | +1.111282e+00 | -9.502609e-02 |
| lag_freq(2).xi       | 2.360341e-01 | +2.763966e+00 | -2.360341e-01 |
| lag_freq(2).b        | 1.683701e+00 | +1.053286e+00 | -2.118836e-01 |
| lag_freq(2).t_max    | 2.967640e+02 | +2.795966e+02 | -1.023986e+02 |
| lag_freq(2).t_shift  | 2.553528e+01 | +9.536668e-01 | -9.339069e+00 |

** 3 data sets fit

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/mass-fit-3data.sl=


Confidence file: =confloop_3data.csv=

| lag_freq(1).norm     | 7.950255e+00 | +2.049745e+00 | -6.875689e+00 |
| lag_freq(1).log_mass | 6.746222e+00 | +1.428992e-01 | -7.207762e-02 |
| lag_freq(1).h2       | 1.325843e+01 | +2.260375e+00 | -1.630875e+00 |
| lag_freq(1).Gamma1   | 2.410911e+00 | +8.880890e-01 | -1.121340e-01 |
| lag_freq(1).Gamma2   | 1.832790e+00 | +1.055161e+00 | -2.163940e-01 |
| lag_freq(1).xi       | 2.999999e+00 | +9.204102e-07 | -2.999999e+00 |
| lag_freq(1).b        | 2.817244e+00 | +1.827560e-01 | -5.675700e-01 |
| lag_freq(1).t_max    | 3.052294e+02 | +2.405460e+02 | -1.202730e+02 |
| lag_freq(1).t_shift  | 2.197425e+01 | +2.353943e+00 | -5.650804e+00 |
| lag_freq(2).norm     | 6.486153e+00 | +3.513847e+00 | -6.486153e+00 |
| lag_freq(2).h2       | 1.401579e+01 | +5.984210e+00 | -5.505272e+00 |
| lag_freq(2).Gamma1   | 2.493190e+00 | +8.058101e-01 | -9.931899e-01 |
| lag_freq(2).Gamma2   | 1.823426e+00 | +1.376574e+00 | -1.241411e-01 |
| lag_freq(2).xi       | 2.038969e+00 | +9.610313e-01 | -2.038969e+00 |
| lag_freq(2).b        | 2.583714e+00 | +4.162860e-01 | -7.513999e-01 |
| lag_freq(2).t_max    | 2.263012e+02 | +5.234389e+02 | -8.815060e+01 |
| lag_freq(2).t_shift  | 3.012444e+01 | +8.987556e+01 | -3.012444e+01 |
| lag_freq(3).norm     | 9.999980e+00 | +2.038086e-05 | -9.999980e+00 |
| lag_freq(3).h2       | 2.000000e+01 | +0.000000e+00 | -1.700000e+01 |
| lag_freq(3).Gamma1   | 2.351220e+00 | +9.477800e-01 | -4.256100e-01 |
| lag_freq(3).Gamma2   | 1.997031e+00 | +1.014399e+00 | -5.970310e-01 |
| lag_freq(3).xi       | 3.000000e+00 | +0.000000e+00 | -3.000000e+00 |
| lag_freq(3).b        | 2.956492e+00 | +4.350800e-02 | -1.956492e+00 |
| lag_freq(3).t_max    | 4.484367e+02 | +3.515633e+02 | -3.984367e+02 |
| lag_freq(3).t_shift  | 2.200633e+01 | +2.453943e+00 | -2.200633e+01 |

** 4 data sets fit

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/mass-fit-4data.sl=

Confidence file: =confloop_4data.csv=

| lag_freq(1).norm     | 9.193337e+00 | +8.066627e-01 | -9.126261e+00 |
| lag_freq(1).log_mass | 5.906657e+00 | +9.152052e-02 | -7.575386e-02 |
| lag_freq(1).h2       | 1.983442e+01 | +1.655781e-01 | -6.998491e+00 |
| lag_freq(1).Gamma1   | 1.702065e+00 | +1.596935e+00 | -1.269997e-03 |
| lag_freq(1).Gamma2   | 1.600000e+00 | +1.078360e+00 | -1.991488e-01 |
| lag_freq(1).xi       | 3.000000e+00 | +6.098784e-08 | -3.000000e+00 |
| lag_freq(1).b        | 3.000000e+00 | +9.790924e-08 | -2.000000e+00 |
| lag_freq(1).t_max    | 5.999999e+02 | +1.485831e+02 | -1.545320e+02 |
| lag_freq(1).t_shift  | 3.852586e+01 | +3.394172e+01 | -3.852586e+01 |
| lag_freq(2).norm     | 1.673133e+00 | +8.326867e+00 | -1.547611e+00 |
| lag_freq(2).h2       | 4.009320e+00 | +2.976881e+00 | -1.009320e+00 |
| lag_freq(2).Gamma1   | 3.000100e+00 | +2.049550e-01 | -1.500100e+00 |
| lag_freq(2).Gamma2   | 2.600001e+00 | +2.730592e-01 | -7.265944e-01 |
| lag_freq(2).xi       | 2.634318e+00 | +3.656823e-01 | -2.634318e+00 |
| lag_freq(2).b        | 2.999999e+00 | +5.701603e-07 | -1.999999e+00 |
| lag_freq(2).t_max    | 1.785574e+02 | +6.214426e+02 | -2.755838e+01 |
| lag_freq(2).t_shift  | 1.200000e+02 | +1.278977e-13 | -2.593534e+01 |
| lag_freq(3).norm     | 1.000000e+01 | +9.941334e-08 | -3.770142e+00 |
| lag_freq(3).h2       | 1.100000e+01 | +8.821730e+00 | -3.732082e-01 |
| lag_freq(3).Gamma1   | 2.226914e+00 | +4.571639e-01 | -1.263160e-01 |
| lag_freq(3).Gamma2   | 1.700001e+00 | +5.262303e-01 | -3.672577e-02 |
| lag_freq(3).xi       | 1.999972e+00 | +1.000028e+00 | -1.999972e+00 |
| lag_freq(3).b        | 3.000000e+00 | +1.283696e-07 | -7.429608e-01 |
| lag_freq(3).t_max    | 5.709139e+02 | +1.397682e+02 | -1.129562e+02 |
| lag_freq(3).t_shift  | 2.399648e+01 | +6.418008e+00 | -3.248637e+00 |
| lag_freq(4).norm     | 6.441607e+00 | +3.558393e+00 | -6.173428e+00 |
| lag_freq(4).h2       | 2.000000e+01 | +4.743389e-07 | -8.964429e+00 |
| lag_freq(4).Gamma1   | 3.063196e+00 | +2.358043e-01 | -7.815936e-01 |
| lag_freq(4).Gamma2   | 2.500001e+00 | +4.273615e-01 | -1.097250e+00 |
| lag_freq(4).xi       | 3.000000e+00 | +8.556040e-08 | -3.000000e+00 |
| lag_freq(4).b        | 3.000000e+00 | +4.959435e-07 | -2.000000e+00 |
| lag_freq(4).t_max    | 7.385092e+02 | +1.011340e+01 | -2.520571e+02 |
| lag_freq(4).t_shift  | 7.000006e+01 | +3.598852e+01 | -1.108127e+01 |

** 5 data sets fit

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/mass-fit-5data.sl=

Confidence file: =confloop_5data.csv=

| lag_freq(1).norm     | 7.275017e+00 | +2.724983e+00 | -7.040025e+00 |
| lag_freq(1).log_mass | 5.913228e+00 | +6.956349e-02 | -1.510705e-01 |
| lag_freq(1).h2       | 1.519238e+01 | +4.807621e+00 | -1.160550e+00 |
| lag_freq(1).Gamma1   | 1.926714e+00 | +1.017623e+00 | -4.267139e-01 |
| lag_freq(1).Gamma2   | 1.462022e+00 | +1.440516e+00 | -6.202161e-02 |
| lag_freq(1).xi       | 1.484424e+00 | +1.515576e+00 | -1.484424e+00 |
| lag_freq(1).b        | 2.060420e+00 | +9.395803e-01 | -1.060420e+00 |
| lag_freq(1).t_max    | 6.210203e+02 | +1.273919e+02 | -2.770788e+02 |
| lag_freq(1).t_shift  | 3.919216e+01 | +4.212690e+01 | -3.919216e+01 |
| lag_freq(2).norm     | 4.326627e+00 | +5.673373e+00 | -4.183235e+00 |
| lag_freq(2).h2       | 4.054154e+00 | +1.594585e+01 | -1.054154e+00 |
| lag_freq(2).Gamma1   | 2.900002e+00 | +3.989975e-01 | -1.359391e+00 |
| lag_freq(2).Gamma2   | 1.800002e+00 | +1.198014e+00 | -4.000015e-01 |
| lag_freq(2).xi       | 3.000000e+00 | +4.072654e-08 | -3.000000e+00 |
| lag_freq(2).b        | 3.000000e+00 | +2.580648e-07 | -2.000000e+00 |
| lag_freq(2).t_max    | 2.000002e+02 | +4.749972e+02 | -4.999701e+01 |
| lag_freq(2).t_shift  | 1.200000e+02 | +8.551970e-07 | -6.696161e+01 |
| lag_freq(3).norm     | 1.000000e+01 | +2.164619e-07 | -3.360722e+00 |
| lag_freq(3).h2       | 1.199999e+01 | +8.000012e+00 | -1.354637e+00 |
| lag_freq(3).Gamma1   | 2.216230e+00 | +2.465312e-06 | -1.608134e-01 |
| lag_freq(3).Gamma2   | 1.700000e+00 | +8.999740e-01 | -1.499740e-01 |
| lag_freq(3).xi       | 1.692152e+00 | +1.307848e+00 | -1.692152e+00 |
| lag_freq(3).b        | 3.000000e+00 | +2.120143e-07 | -8.116060e-01 |
| lag_freq(3).t_max    | 6.340335e+02 | +8.066749e+01 | -1.345443e+02 |
| lag_freq(3).t_shift  | 2.586530e+01 | +6.444681e+00 | -3.283686e+00 |
| lag_freq(4).norm     | 9.535818e+00 | +4.641821e-01 | -9.411597e+00 |
| lag_freq(4).h2       | 1.999997e+01 | +2.512951e-05 | -6.803951e-09 |
| lag_freq(4).Gamma1   | 2.252918e+00 | +1.046082e+00 | -5.496803e-01 |
| lag_freq(4).Gamma2   | 2.615211e+00 | +2.339546e-10 | -1.004473e+00 |
| lag_freq(4).xi       | 4.001033e-01 | +2.599897e+00 | -4.001033e-01 |
| lag_freq(4).b        | 2.999998e+00 | +1.852055e-06 | -1.858474e+00 |
| lag_freq(4).t_max    | 7.481543e+02 | +9.941752e-01 | -1.835250e+01 |
| lag_freq(4).t_shift  | 8.000003e+01 | +3.044751e+01 | -1.169521e+01 |
| lag_freq(5).norm     | 9.983767e+00 | +1.623340e-02 | -5.872383e+00 |
| lag_freq(5).h2       | 1.996043e+01 | +3.957163e-02 | -2.541487e+00 |
| lag_freq(5).Gamma1   | 2.012764e+00 | +2.194998e-01 | -1.713512e-01 |
| lag_freq(5).Gamma2   | 1.992479e+00 | +5.632852e-01 | -5.509929e-01 |
| lag_freq(5).xi       | 3.362339e-02 | +2.966377e+00 | -3.362339e-02 |
| lag_freq(5).b        | 3.000000e+00 | +1.555445e-07 | -2.773890e-05 |
| lag_freq(5).t_max    | 6.999998e+02 | +2.231353e+01 | -1.555369e+02 |
| lag_freq(5).t_shift  | 3.392504e+01 | +6.733387e+00 | -3.034880e+00 |

** 6 data sets fit

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/mass-fit-6data.sl=


Confidence file: =confloop_6data.csv=

| lag_freq(1).norm     | 3.569427e+00 | +6.430573e+00 | -3.436873e+00 |
| lag_freq(1).log_mass | 6.019508e+00 | +3.002521e-02 | -4.553212e-02 |
| lag_freq(1).h2       | 1.499999e+01 | +9.867583e-01 | -9.867252e-01 |
| lag_freq(1).Gamma1   | 2.040773e+00 | +1.258227e+00 | -5.407730e-01 |
| lag_freq(1).Gamma2   | 1.650663e+00 | +1.127123e+00 | -5.733554e-02 |
| lag_freq(1).xi       | 6.545777e-01 | +2.345422e+00 | -6.545777e-01 |
| lag_freq(1).b        | 2.181027e+00 | +8.189728e-01 | -1.181027e+00 |
| lag_freq(1).t_max    | 4.499999e+02 | +2.990103e+02 | -1.991678e+02 |
| lag_freq(1).t_shift  | 3.054949e+01 | +3.144505e+01 | -3.054949e+01 |
| lag_freq(2).norm     | 3.170947e+00 | +6.829053e+00 | -3.039288e+00 |
| lag_freq(2).h2       | 3.020085e+00 | +3.967189e+00 | -2.008467e-02 |
| lag_freq(2).Gamma1   | 2.862846e+00 | +2.375191e-01 | -1.259520e+00 |
| lag_freq(2).Gamma2   | 2.394975e+00 | +4.267698e-01 | -9.949753e-01 |
| lag_freq(2).xi       | 3.000000e+00 | +1.516545e-08 | -3.000000e+00 |
| lag_freq(2).b        | 3.000000e+00 | +2.427311e-07 | -2.000000e+00 |
| lag_freq(2).t_max    | 4.750001e+02 | +1.017196e+02 | -1.852206e+02 |
| lag_freq(2).t_shift  | 9.432383e+01 | +1.568496e+01 | -2.412914e+01 |
| lag_freq(3).norm     | 1.000000e+01 | +4.440892e-14 | -3.981643e+00 |
| lag_freq(3).h2       | 1.099999e+01 | +5.234722e+00 | -3.980995e-01 |
| lag_freq(3).Gamma1   | 2.269680e+00 | +1.378629e-01 | -1.040054e-01 |
| lag_freq(3).Gamma2   | 1.700000e+00 | +5.697178e-10 | -3.981569e-02 |
| lag_freq(3).xi       | 2.000000e+00 | +1.000000e+00 | -2.000000e+00 |
| lag_freq(3).b        | 3.000000e+00 | +2.438494e-12 | -5.774496e-01 |
| lag_freq(3).t_max    | 4.881279e+02 | +7.394618e+01 | -5.917513e+01 |
| lag_freq(3).t_shift  | 2.212509e+01 | +5.441406e+00 | -2.527330e+00 |
| lag_freq(4).norm     | 5.339547e+00 | +4.660453e+00 | -5.205931e+00 |
| lag_freq(4).h2       | 1.091956e+01 | +6.073370e+00 | -9.054069e-01 |
| lag_freq(4).Gamma1   | 2.683268e+00 | +6.157322e-01 | -6.250243e-01 |
| lag_freq(4).Gamma2   | 2.699852e+00 | +4.674652e-01 | -1.007145e-01 |
| lag_freq(4).xi       | 2.999959e+00 | +4.106781e-05 | -2.999959e+00 |
| lag_freq(4).b        | 2.769491e+00 | +2.305093e-01 | -1.648689e+00 |
| lag_freq(4).t_max    | 6.457958e+02 | +4.225638e+00 | -9.500922e+01 |
| lag_freq(4).t_shift  | 5.963298e+01 | +2.123776e+01 | -7.484516e+00 |
| lag_freq(5).norm     | 9.999971e+00 | +2.906453e-05 | -4.939360e+00 |
| lag_freq(5).h2       | 1.092977e+01 | +8.137496e+00 | -4.525206e-01 |
| lag_freq(5).Gamma1   | 2.552861e+00 | +2.808803e-01 | -3.242300e-01 |
| lag_freq(5).Gamma2   | 2.164084e+00 | +3.223946e-01 | -3.820384e-01 |
| lag_freq(5).xi       | 9.468633e-01 | +2.053137e+00 | -9.468633e-01 |
| lag_freq(5).b        | 3.000000e+00 | +1.049943e-07 | -4.420906e-01 |
| lag_freq(5).t_max    | 5.409002e+02 | +1.851361e+02 | -6.279754e+01 |
| lag_freq(5).t_shift  | 2.790918e+01 | +2.827545e+00 | -3.067688e+00 |
| lag_freq(6).norm     | 9.718526e+00 | +2.814735e-01 | -7.288895e+00 |
| lag_freq(6).h2       | 1.189030e+01 | +3.863073e+00 | -6.266299e-01 |
| lag_freq(6).Gamma1   | 2.303117e+00 | +2.695931e-01 | -6.836805e-02 |
| lag_freq(6).Gamma2   | 1.679383e+00 | +1.622689e-01 | -5.302996e-02 |
| lag_freq(6).xi       | 9.095167e-01 | +1.804903e+00 | -9.095167e-01 |
| lag_freq(6).b        | 3.000000e+00 | +8.120251e-08 | -1.828653e-01 |
| lag_freq(6).t_max    | 7.033298e+02 | +2.020640e+01 | -3.597223e+01 |
| lag_freq(6).t_shift  | 2.532227e+01 | +3.166262e+00 | -6.504500e+00 |

** 7 data sets fit

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/mass-fit.sl=

Confidence file: =confloop_7data.csv=

| lag_freq(1).norm     | 6.385579e+00 | +3.614421e+00 | -6.173462e+00 |
| lag_freq(1).log_mass | 6.042802e+00 | +1.604534e-02 | -3.135829e-02 |
| lag_freq(1).h2       | 1.349267e+01 | +6.507327e+00 | -1.049267e+01 |
| lag_freq(1).Gamma1   | 3.103528e+00 | +1.954724e-01 | -1.108059e+00 |
| lag_freq(1).Gamma2   | 2.818775e+00 | +1.010141e-01 | -3.002226e-01 |
| lag_freq(1).xi       | 9.999731e-01 | +2.000027e+00 | -9.999731e-01 |
| lag_freq(1).b        | 2.774672e+00 | +2.253281e-01 | -7.103504e-01 |
| lag_freq(1).t_max    | 4.500000e+02 | +2.990394e+02 | -1.419319e+02 |
| lag_freq(1).t_shift  | 3.011989e+01 | +2.853912e+01 | -1.115730e+01 |
| lag_freq(2).norm     | 4.890924e+00 | +5.109076e+00 | -4.603012e+00 |
| lag_freq(2).h2       | 7.001104e+00 | +1.299890e+01 | -4.001104e+00 |
| lag_freq(2).Gamma1   | 2.599988e+00 | +4.974029e-01 | -9.230085e-01 |
| lag_freq(2).Gamma2   | 1.457405e+00 | +8.470345e-01 | -5.740490e-02 |
| lag_freq(2).xi       | 1.149351e-02 | +9.939380e-01 | -1.149351e-02 |
| lag_freq(2).b        | 1.000001e+00 | +9.718789e-01 | -9.336291e-07 |
| lag_freq(2).t_max    | 4.500002e+02 | +1.983905e+02 | -1.546910e+02 |
| lag_freq(2).t_shift  | 1.088578e+02 | +8.543702e-01 | -3.325205e+01 |
| lag_freq(3).norm     | 1.000000e+01 | +5.859411e-08 | -3.981372e+00 |
| lag_freq(3).h2       | 1.100001e+01 | +5.271599e+00 | -3.980823e-01 |
| lag_freq(3).Gamma1   | 2.269679e+00 | +4.731714e-01 | -1.271867e-01 |
| lag_freq(3).Gamma2   | 1.700000e+00 | +3.722373e-01 | -3.981373e-02 |
| lag_freq(3).xi       | 2.000000e+00 | +1.000000e+00 | -2.000000e+00 |
| lag_freq(3).b        | 3.000000e+00 | +7.833861e-08 | -5.772264e-01 |
| lag_freq(3).t_max    | 4.881291e+02 | +7.261559e+01 | -7.567079e+01 |
| lag_freq(3).t_shift  | 2.212516e+01 | +4.793042e+00 | -2.526647e+00 |
| lag_freq(4).norm     | 9.976291e+00 | +2.370866e-02 | -9.759453e+00 |
| lag_freq(4).h2       | 4.068553e+00 | +1.593145e+01 | -4.686932e-02 |
| lag_freq(4).Gamma1   | 2.502235e+00 | +3.955912e-01 | -2.258032e-01 |
| lag_freq(4).Gamma2   | 1.988453e+00 | +7.073999e-01 | -8.628420e-02 |
| lag_freq(4).xi       | 3.000000e+00 | +1.113558e-07 | -3.000000e+00 |
| lag_freq(4).b        | 3.000000e+00 | +7.708992e-08 | -1.438933e+00 |
| lag_freq(4).t_max    | 7.101997e+02 | +6.652218e+01 | -3.300999e+02 |
| lag_freq(4).t_shift  | 6.522775e+01 | +1.699513e+01 | -1.090269e+01 |
| lag_freq(5).norm     | 9.820726e+00 | +1.792744e-01 | -4.814689e+00 |
| lag_freq(5).h2       | 1.094682e+01 | +8.117278e+00 | -3.550062e-01 |
| lag_freq(5).Gamma1   | 2.552876e+00 | +2.350162e-01 | -1.769663e-01 |
| lag_freq(5).Gamma2   | 2.164098e+00 | +2.805845e-01 | -5.161393e-01 |
| lag_freq(5).xi       | 9.544673e-01 | +2.045533e+00 | -9.544673e-01 |
| lag_freq(5).b        | 3.000000e+00 | +7.305721e-08 | -5.730227e-01 |
| lag_freq(5).t_max    | 5.408793e+02 | +1.851476e+02 | -6.229715e+01 |
| lag_freq(5).t_shift  | 2.790874e+01 | +2.979065e+00 | -2.981185e+00 |
| lag_freq(6).norm     | 9.950253e+00 | +4.974682e-02 | -6.914943e+00 |
| lag_freq(6).h2       | 1.188340e+01 | +3.870218e+00 | -5.797968e-01 |
| lag_freq(6).Gamma1   | 2.303076e+00 | +2.241388e-01 | -6.832917e-02 |
| lag_freq(6).Gamma2   | 1.680101e+00 | +1.731828e-01 | -4.974747e-02 |
| lag_freq(6).xi       | 9.476401e-01 | +1.766712e+00 | -9.476401e-01 |
| lag_freq(6).b        | 3.000000e+00 | +9.403446e-08 | -2.090823e-01 |
| lag_freq(6).t_max    | 7.044646e+02 | +3.035480e+01 | -3.786098e+01 |
| lag_freq(6).t_shift  | 2.532356e+01 | +3.083869e+00 | -5.826882e+00 |
| lag_freq(7).norm     | 1.000000e+01 | +6.004086e-13 | -8.331028e+00 |
| lag_freq(7).h2       | 1.129660e+01 | +7.531806e+00 | -1.110524e+00 |
| lag_freq(7).Gamma1   | 2.315618e+00 | +2.380972e-01 | -9.257508e-02 |
| lag_freq(7).Gamma2   | 1.699999e+00 | +5.530802e-01 | -8.152732e-02 |
| lag_freq(7).xi       | 9.405404e-01 | +2.059460e+00 | -9.405404e-01 |
| lag_freq(7).b        | 3.000000e+00 | +9.416649e-08 | -4.811551e-01 |
| lag_freq(7).t_max    | 6.434873e+02 | +9.714955e+01 | -1.475397e+02 |
| lag_freq(7).t_shift  | 2.192330e+01 | +5.031487e+00 | -5.408695e+00 |

** 8 data sets fit

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/mass-fit-8data.sl=

Confidence file: =confloop_8data.csv=

| lag_freq(1).norm     | 4.770675e+00 | +5.229325e+00 | -4.589480e+00 |
| lag_freq(1).log_mass | 6.042802e+00 | +4.370131e-02 | -2.524951e-02 |
| lag_freq(1).h2       | 1.146579e+01 | +8.534215e+00 | -8.465785e+00 |
| lag_freq(1).Gamma1   | 2.173245e+00 | +6.246753e-01 | -3.123377e-01 |
| lag_freq(1).Gamma2   | 1.710741e+00 | +8.615567e-01 | -1.349108e-01 |
| lag_freq(1).xi       | 9.405531e-01 | +2.059447e+00 | -9.405531e-01 |
| lag_freq(1).b        | 2.187969e+00 | +8.120310e-01 | -1.187969e+00 |
| lag_freq(1).t_max    | 4.500004e+02 | +2.987350e+02 | -3.530216e+02 |
| lag_freq(1).t_shift  | 3.046272e+01 | +2.944658e+01 | -3.046272e+01 |
| lag_freq(2).norm     | 9.999739e+00 | +2.612735e-04 | -9.711472e+00 |
| lag_freq(2).h2       | 7.099832e+00 | +1.290017e+01 | -4.099832e+00 |
| lag_freq(2).Gamma1   | 2.601685e+00 | +4.961363e-01 | -9.143049e-01 |
| lag_freq(2).Gamma2   | 1.442359e+00 | +9.211793e-01 | -4.235856e-02 |
| lag_freq(2).xi       | 1.345913e-01 | +2.865409e+00 | -1.345913e-01 |
| lag_freq(2).b        | 1.000001e+00 | +1.767380e+00 | -7.596620e-07 |
| lag_freq(2).t_max    | 4.495678e+02 | +1.988217e+02 | -1.571934e+02 |
| lag_freq(2).t_shift  | 9.067747e+01 | +1.907435e+01 | -2.040225e+01 |
| lag_freq(3).norm     | 1.000000e+01 | +1.140063e-08 | -3.981333e+00 |
| lag_freq(3).h2       | 1.100000e+01 | +5.272169e+00 | -3.980964e-01 |
| lag_freq(3).Gamma1   | 2.269679e+00 | +1.362675e-01 | -1.019584e-01 |
| lag_freq(3).Gamma2   | 1.699999e+00 | +2.092085e-01 | -3.981498e-02 |
| lag_freq(3).xi       | 2.000000e+00 | +1.000000e+00 | -2.000000e+00 |
| lag_freq(3).b        | 3.000000e+00 | +6.998154e-08 | -5.647541e-01 |
| lag_freq(3).t_max    | 4.881309e+02 | +6.822162e+01 | -5.917071e+01 |
| lag_freq(3).t_shift  | 2.212525e+01 | +4.807826e+00 | -2.529150e+00 |
| lag_freq(4).norm     | 3.673872e+00 | +6.326128e+00 | -3.515221e+00 |
| lag_freq(4).h2       | 3.007242e+00 | +3.984761e+00 | -7.241573e-03 |
| lag_freq(4).Gamma1   | 1.999999e+00 | +1.104163e+00 | -3.494966e-01 |
| lag_freq(4).Gamma2   | 1.400001e+00 | +1.765403e+00 | -1.056911e-06 |
| lag_freq(4).xi       | 2.132258e+00 | +8.207063e-02 | -2.132258e+00 |
| lag_freq(4).b        | 2.757228e+00 | +2.427723e-01 | -1.623248e+00 |
| lag_freq(4).t_max    | 6.004052e+02 | +4.877903e+01 | -1.038776e+02 |
| lag_freq(4).t_shift  | 6.678098e+01 | +1.188949e+01 | -1.442206e+01 |
| lag_freq(5).norm     | 9.456053e+00 | +5.439470e-01 | -4.539729e+00 |
| lag_freq(5).h2       | 1.098351e+01 | +8.086675e+00 | -4.998175e-01 |
| lag_freq(5).Gamma1   | 2.552964e+00 | +3.863801e-01 | -2.000394e-01 |
| lag_freq(5).Gamma2   | 2.164217e+00 | +2.816172e-01 | -5.166982e-01 |
| lag_freq(5).xi       | 9.698233e-01 | +2.030177e+00 | -9.698233e-01 |
| lag_freq(5).b        | 3.000000e+00 | +6.437932e-08 | -2.444231e-01 |
| lag_freq(5).t_max    | 5.408194e+02 | +1.851485e+02 | -6.261753e+01 |
| lag_freq(5).t_shift  | 2.790880e+01 | +1.692978e+00 | -3.056752e+00 |
| lag_freq(6).norm     | 9.841500e+00 | +1.584997e-01 | -7.087520e+00 |
| lag_freq(6).h2       | 1.186074e+01 | +3.892397e+00 | -5.845600e-01 |
| lag_freq(6).Gamma1   | 2.303149e+00 | +2.596380e-01 | -6.840465e-02 |
| lag_freq(6).Gamma2   | 1.686580e+00 | +1.579004e-01 | -5.908947e-02 |
| lag_freq(6).xi       | 3.361034e-01 | +2.379315e+00 | -3.361034e-01 |
| lag_freq(6).b        | 3.000000e+00 | +9.696962e-08 | -1.857744e-01 |
| lag_freq(6).t_max    | 7.062986e+02 | +2.989898e+01 | -3.897399e+01 |
| lag_freq(6).t_shift  | 2.532136e+01 | +3.038493e+00 | -6.023207e+00 |
| lag_freq(7).norm     | 1.000000e+01 | +1.243450e-14 | -8.331602e+00 |
| lag_freq(7).h2       | 1.129715e+01 | +7.522191e+00 | -1.111119e+00 |
| lag_freq(7).Gamma1   | 2.315587e+00 | +2.381056e-01 | -9.254869e-02 |
| lag_freq(7).Gamma2   | 1.699999e+00 | +4.851648e-01 | -8.141125e-02 |
| lag_freq(7).xi       | 9.402380e-01 | +2.059762e+00 | -9.402380e-01 |
| lag_freq(7).b        | 3.000000e+00 | +9.540019e-08 | -4.232955e-01 |
| lag_freq(7).t_max    | 6.435202e+02 | +9.692869e+01 | -1.476357e+02 |
| lag_freq(7).t_shift  | 2.192577e+01 | +2.795566e+00 | -5.404754e+00 |
| lag_freq(8).norm     | 1.000000e+01 | +9.947598e-14 | -3.953126e+00 |
| lag_freq(8).h2       | 3.786879e+00 | +4.559424e+00 | -7.868786e-01 |
| lag_freq(8).Gamma1   | 1.802479e+00 | +1.572229e-01 | -7.861949e-02 |
| lag_freq(8).Gamma2   | 1.400001e+00 | +5.928879e-01 | -6.825893e-07 |
| lag_freq(8).xi       | 3.000000e+00 | +1.796975e-07 | -3.000000e+00 |
| lag_freq(8).b        | 2.139856e+00 | +8.601438e-01 | -2.305402e-01 |
| lag_freq(8).t_max    | 3.267815e+02 | +2.426815e+02 | -4.326377e+01 |
| lag_freq(8).t_shift  | 2.576586e+01 | +5.132081e+00 | -3.854936e+00 |

** 9 data sets fit

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/mass-fit-9data.sl=

Confidence file: =confloop_9data.csv=

| lag_freq(1).norm     | 7.391117e+00 | +2.608883e+00 | -7.213490e+00 |
| lag_freq(1).log_mass | 6.042802e+00 | +3.107646e-02 | -2.517493e-02 |
| lag_freq(1).h2       | 1.109708e+01 | +8.902916e+00 | -8.097084e+00 |
| lag_freq(1).Gamma1   | 2.158333e+00 | +1.140667e+00 | -2.779466e-01 |
| lag_freq(1).Gamma2   | 1.665053e+00 | +1.163950e+00 | -6.738636e-02 |
| lag_freq(1).xi       | 4.975207e-02 | +2.950248e+00 | -4.975207e-02 |
| lag_freq(1).b        | 2.180972e+00 | +8.190278e-01 | -1.180972e+00 |
| lag_freq(1).t_max    | 4.500000e+02 | +2.988152e+02 | -1.794777e+02 |
| lag_freq(1).t_shift  | 3.052710e+01 | +2.936386e+01 | -3.052710e+01 |
| lag_freq(2).norm     | 3.809085e+00 | +6.190915e+00 | -3.521300e+00 |
| lag_freq(2).h2       | 7.375426e+00 | +3.957933e+00 | -4.375426e+00 |
| lag_freq(2).Gamma1   | 2.604196e+00 | +4.931943e-01 | -9.043758e-01 |
| lag_freq(2).Gamma2   | 1.457413e+00 | +8.276801e-01 | -5.741293e-02 |
| lag_freq(2).xi       | 3.817421e-01 | +6.284826e-01 | -3.817421e-01 |
| lag_freq(2).b        | 1.000000e+00 | +9.524900e-01 | -4.702749e-07 |
| lag_freq(2).t_max    | 4.499998e+02 | +1.983895e+02 | -1.546873e+02 |
| lag_freq(2).t_shift  | 1.060859e+02 | +3.626123e+00 | -3.284867e+01 |
| lag_freq(3).norm     | 1.000000e+01 | +9.903553e-08 | -3.981334e+00 |
| lag_freq(3).h2       | 1.100000e+01 | +5.271723e+00 | -3.980368e-01 |
| lag_freq(3).Gamma1   | 2.269686e+00 | +4.640071e-01 | -1.016270e-01 |
| lag_freq(3).Gamma2   | 1.700000e+00 | +4.371839e-01 | -3.981406e-02 |
| lag_freq(3).xi       | 2.000000e+00 | +1.000000e+00 | -2.000000e+00 |
| lag_freq(3).b        | 3.000000e+00 | +6.500896e-08 | -5.645893e-01 |
| lag_freq(3).t_max    | 4.881274e+02 | +6.788584e+01 | -7.583428e+01 |
| lag_freq(3).t_shift  | 2.212493e+01 | +4.397265e+00 | -2.527115e+00 |
| lag_freq(4).norm     | 1.249014e+00 | +8.750986e+00 | -1.086034e+00 |
| lag_freq(4).h2       | 3.000001e+00 | +3.992009e+00 | -7.220067e-07 |
| lag_freq(4).Gamma1   | 2.000001e+00 | +1.098486e+00 | -3.495155e-01 |
| lag_freq(4).Gamma2   | 1.400001e+00 | +6.645795e-01 | -5.007311e-07 |
| lag_freq(4).xi       | 2.405426e+00 | +5.945744e-01 | -2.405426e+00 |
| lag_freq(4).b        | 2.753889e+00 | +2.461113e-01 | -1.619857e+00 |
| lag_freq(4).t_max    | 6.000538e+02 | +4.898313e+01 | -5.000516e+02 |
| lag_freq(4).t_shift  | 6.676552e+01 | +1.190602e+01 | -1.440197e+01 |
| lag_freq(5).norm     | 9.295433e+00 | +7.045675e-01 | -4.284375e+00 |
| lag_freq(5).h2       | 1.099996e+01 | +7.740869e+00 | -5.246270e-01 |
| lag_freq(5).Gamma1   | 2.552774e+00 | +5.823566e-01 | -7.416248e-02 |
| lag_freq(5).Gamma2   | 2.163997e+00 | +3.013680e-01 | -5.727205e-01 |
| lag_freq(5).xi       | 9.517529e-01 | +2.048247e+00 | -9.517529e-01 |
| lag_freq(5).b        | 3.000000e+00 | +1.015502e-07 | -1.343044e-01 |
| lag_freq(5).t_max    | 5.409933e+02 | +1.860843e+02 | -6.272769e+01 |
| lag_freq(5).t_shift  | 2.791104e+01 | +2.767328e+00 | -3.063634e+00 |
| lag_freq(6).norm     | 9.963242e+00 | +3.675780e-02 | -7.002489e+00 |
| lag_freq(6).h2       | 1.199730e+01 | +3.755638e+00 | -7.013379e-01 |
| lag_freq(6).Gamma1   | 2.303145e+00 | +2.413627e-01 | -6.839548e-02 |
| lag_freq(6).Gamma2   | 1.698795e+00 | +1.457902e-01 | -6.899685e-02 |
| lag_freq(6).xi       | 7.603871e-01 | +1.954177e+00 | -7.603871e-01 |
| lag_freq(6).b        | 3.000000e+00 | +6.935481e-08 | -1.857656e-01 |
| lag_freq(6).t_max    | 7.173494e+02 | +1.783989e+01 | -4.992678e+01 |
| lag_freq(6).t_shift  | 2.532125e+01 | +3.166271e+00 | -6.011610e+00 |
| lag_freq(7).norm     | 1.000000e+01 | +8.260059e-13 | -8.330459e+00 |
| lag_freq(7).h2       | 1.129721e+01 | +7.522020e+00 | -1.111082e+00 |
| lag_freq(7).Gamma1   | 2.315592e+00 | +2.377460e-01 | -9.254358e-02 |
| lag_freq(7).Gamma2   | 1.700000e+00 | +2.996304e-01 | -8.152633e-02 |
| lag_freq(7).xi       | 9.161822e-01 | +2.083818e+00 | -9.161822e-01 |
| lag_freq(7).b        | 3.000000e+00 | +8.378788e-08 | -4.228318e-01 |
| lag_freq(7).t_max    | 6.435238e+02 | +9.705089e+01 | -1.476099e+02 |
| lag_freq(7).t_shift  | 2.192584e+01 | +2.827456e+00 | -5.439813e+00 |
| lag_freq(8).norm     | 1.000000e+01 | +5.329071e-13 | -3.951922e+00 |
| lag_freq(8).h2       | 3.760985e+00 | +4.585078e+00 | -7.609848e-01 |
| lag_freq(8).Gamma1   | 1.801877e+00 | +1.555602e-01 | -7.778010e-02 |
| lag_freq(8).Gamma2   | 1.400001e+00 | +8.829544e-01 | -1.189420e-06 |
| lag_freq(8).xi       | 3.000000e+00 | +1.144555e-07 | -3.000000e+00 |
| lag_freq(8).b        | 2.140189e+00 | +8.598111e-01 | -2.310346e-01 |
| lag_freq(8).t_max    | 3.267970e+02 | +2.432437e+02 | -4.324228e+01 |
| lag_freq(8).t_shift  | 2.577718e+01 | +5.129603e+00 | -2.871308e+00 |
| lag_freq(9).norm     | 9.194061e+00 | +8.059390e-01 | -3.926504e+00 |
| lag_freq(9).h2       | 3.000001e+00 | +3.523888e+00 | -1.273958e-06 |
| lag_freq(9).Gamma1   | 1.904305e+00 | +3.193650e-01 | -1.596825e-01 |
| lag_freq(9).Gamma2   | 1.499481e+00 | +2.597421e-01 | -9.948121e-02 |
| lag_freq(9).xi       | 2.991642e+00 | +8.358376e-03 | -2.991642e+00 |
| lag_freq(9).b        | 3.000000e+00 | +3.003371e-08 | -7.297543e-01 |
| lag_freq(9).t_max    | 5.011032e+02 | +6.600568e+01 | -8.322772e+01 |
| lag_freq(9).t_shift  | 2.192024e+01 | +8.399124e+00 | -4.964315e+00 |

** 10 data sets fit

Confidence file: =confloop_10data.csv=

screen -r 64405.pts-30.hm00

As at 1200 2 July

| Parameter | 2 | = | 9.933953e+00 | (2.230597e-01 | - | 1.000000e+01) |
| Parameter | 3 | = | 6.044447e+00 | (6.031278e+00 | - | 6.091039e+00) |
| Parameter | 7 | = | 1.099616e+01 | (3.999522e+00 | - | 2.000000e+01) |
| Parameter | 8 | = | 2.156569e+00 | (1.828286e+00 | - | 3.299000e+00) |

1200 3 July

| Parameter |  9 | = | 1.648795e+00 | (1.592306e+00 | - | 3.200000e+00) |
| Parameter | 11 | = | 9.466546e-01 | (0.000000e+00 | - | 3.000000e+00) |
| Parameter | 13 | = | 2.187665e+00 | (1.000000e+00 | - | 3.000000e+00) |
| Parameter | 15 | = | 4.500001e+02 | (1.504775e+02 | - | 7.488193e+02) |
| Parameter | 16 | = | 3.051660e+01 | (0.000000e+00 | - | 5.972538e+01) |
| Parameter | 18 | = | 4.359260e+00 | (2.871719e-01 | - | 1.000000e+01) |

1000 4 July

| Parameter | 23 | = | 7.643192e+00 | (3.000000e+00 | - | 1.598351e+01) |
| Parameter | 24 | = | 2.593525e+00 | (1.701542e+00 | - | 3.098233e+00) |
| Parameter | 25 | = | 1.460587e+00 | (1.400000e+00 | - | 2.284181e+00) |
| Parameter | 27 | = | 7.892371e-03 | (0.000000e+00 | - | 9.823191e-01) |

1000 5 July

| Parameter | 29 | = | 1.000000e+00 | (1.000000e+00 | - | 1.986726e+00) |
| Parameter | 31 | = | 4.500001e+02 | (2.919081e+02 | - | 6.484000e+02) |
| Parameter | 32 | = | 1.061854e+02 | (7.572325e+01 | - | 1.097534e+02) |
| Parameter | 34 | = | 1.000000e+01 | (5.990576e+00 | - | 1.000000e+01) |
| Parameter | 39 | = | 1.100001e+01 | (1.059914e+01 | - | 1.631843e+01) |
| Parameter | 40 | = | 2.270898e+00 | (2.150273e+00 | - | 2.720276e+00) |
| Parameter | 41 | = | 1.700001e+00 | (1.659906e+00 | - | 2.315817e+00) |
| Parameter | 43 | = | 1.999997e+00 | (0.000000e+00 | - | 3.000000e+00) |
| Parameter | 45 | = | 3.000000e+00 | (2.436694e+00 | - | 3.000000e+00) |

1000 6 July

| Parameter | 47 | = | 4.869089e+02 | (4.123884e+02 | - | 5.487391e+02) |
| Parameter | 48 | = | 2.206448e+01 | (1.953893e+01 | - | 2.656824e+01) |
| Parameter | 50 | = | 1.261415e+00 | (1.841380e-01 | - | 1.000000e+01) |
| Parameter | 55 | = | 3.000002e+00 | (3.000000e+00 | - | 6.812350e+00) |

1000 7 July

| Parameter | 56 | = | 1.999999e+00 | (1.650110e+00 | - | 3.100188e+00) |
| Parameter | 57 | = | 1.400000e+00 | (1.400000e+00 | - | 3.164675e+00) |
| Parameter | 59 | = | 2.403454e+00 | (0.000000e+00 | - | 3.000000e+00) |
| Parameter | 61 | = | 2.780175e+00 | (1.135580e+00 | - | 3.000000e+00) |
| Parameter | 63 | = | 6.002436e+02 | (1.000027e+02 | - | 6.491812e+02) |
| Parameter | 64 | = | 6.648278e+01 | (5.158499e+01 | - | 7.849158e+01) |
| Parameter | 66 | = | 9.372258e+00 | (4.905506e+00 | - | 1.000000e+01) |
| Parameter | 71 | = | 1.099780e+01 | (1.048849e+01 | - | 1.942619e+01) |

1000 7 July

| Parameter | 72 = | 2.537409e+00 | (2.186251e+00 | - | 2.758937e+00) |

1000 11 July

| Parameter | 73 | = | 2.137990e+00 | (1.646932e+00 | - | 2.430017e+00) |
| Parameter | 75 | = | 6.529485e-01 | (0.000000e+00 | - | 3.000000e+00) |
| Parameter | 77 | = | 3.000000e+00 | (2.922080e+00 | - | 3.000000e+00) |
| Parameter | 79 | = | 5.331267e+02 | (4.745765e+02 | - | 5.944682e+02) |
| Parameter | 80 | = | 2.757217e+01 | (2.358488e+01 | - | 2.839073e+01) |
| Parameter | 82 | = | 9.954298e+00 | (2.202053e+00 | - | 1.000000e+01) |
| Parameter | 87 | = | 1.198463e+01 | (1.122816e+01 | - | 1.574728e+01) |
| Parameter | 88 | = | 2.307419e+00 | (2.234958e+00 | - | 2.667468e+00) |

1000 12 July


| Parameter | 89 | = | 1.696762e+00 | (1.654716e+00 | - | 1.839330e+00) |

#################################################################

Killed around mid afternoon 12 July after running for 6 weeks

#################################################################


** 11 data sets fit

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/mass-fit-11data.sl=

Importing =conf_mass_fit_11data.par=

#+BEGIN_EXAMPLE
isis

source("mass-fit-11data.sl");

source(conf_mass2_fit_11data.sl");

#+END_EXAMPLE

Confidence file: =conf_mass2_fit_11data.csv=

|

** 12 data sets fit

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/mass-fit-12data.sl=

Importing =conf_mass_fit_12data.par=

#+BEGIN_EXAMPLE
isis

source("mass-fit-12data.sl");

source(conf_mass2_fit_12data.sl");

#+END_EXAMPLE

Confidence file: =conf_mass2_fit_12data.csv=

** 13 data sets fit

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/mass-fit-13data.sl=

Importing =conf_mass_fit_13data.par=

#+BEGIN_EXAMPLE
isis

source("mass-fit-13data.sl");

source(conf_mass2_fit_13data.sl");

#+END_EXAMPLE

Confidence file: =conf_mass2_fit_13data.csv=

** 14 data sets fit

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/mass-fit-14data.sl=

Importing =conf_mass_fit_14data.par=

#+BEGIN_EXAMPLE
isis

source("mass-fit-14data.sl");

source(conf2_mass_fit_14data.sl");

#+END_EXAMPLE

Confidence file: =conf_mass2_fit_14data.csv=

** 15 data sets fit

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495/mass-fit-15data.sl=

Importing =conf_mass_fit_15data.par=

#+BEGIN_EXAMPLE

conf_mass_fit_15data.sl

14820.pts-28.hm00

#+END_EXAMPLE

* 1H0707-495 Simultaneous Mass fits individual fits (logM range = 5.5 - 8.0)
** Full 15 data sim fit

PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495=

For this fit the mass was
 6.0428e+00   (6.0358e+00 - 6.0463e+00)

$logM_{\odot} = 6.04^{+0.01}_{-0.01}$

Create indivual observation parameter files from the
=ajy-conf.par= file and generate indivual par files,
e.g:=tm_sim2_0653510601.par=

#+BEGIN_EXAMPLE
sds(1)*lag_freq(1) + sds(2)*lag_freq(2) + sds(3)*lag_freq(3) + sds(4)*lag_freq(4) + sds(5)*lag_freq(5) + sds(6)*lag_freq(6) + sds(7)*lag_freq(7) + sds(8)*lag_freq(8) + sds(9)*lag_freq(9) + sds(10)*lag_freq(10) + sds(11)*lag_freq(11) + sds(12)*lag_freq(12) + sds(13)*lag_freq(13) + sds(14)*lag_freq(14) + sds(15)*lag_freq(15)
 idx  param              tie-to  freeze         value         min         max
  1  sds(1).dataset          0     1                1           0           0
  2  lag_freq(1).norm        0     0         7.391117           0          10
  3  lag_freq(1).log_mass    0     0         6.042802         5.5           8
  4  lag_freq(1).i           0     1               53          53          53
  5  lag_freq(1).a           0     1            0.998       0.998       0.998
  6  lag_freq(1).h1          0     1                2           2           2
  7  lag_freq(1).h2          0     0         11.09708           3          20
  8  lag_freq(1).Gamma1      0     0         2.158333         1.5       3.299
  9  lag_freq(1).Gamma2      0     0         1.665053         1.4         3.2
 10  lag_freq(1).Fe          0     1                1           1           1
 11  lag_freq(1).xi          0     0       0.04975207           0           3
 12  lag_freq(1).p           0     1                0           0           0
 13  lag_freq(1).b           0     0         2.180972           1           3
 14  lag_freq(1).q2          0     1              0.5         0.5         0.5
 15  lag_freq(1).t_max       0     0              450          50         800
 16  lag_freq(1).t_shift     0     0          30.5271           0         120
 17  sds(2).dataset          0     1                2           0           0
 18  lag_freq(2).norm        0     0         3.809085           0          10
 19  lag_freq(2).log_mass    3     0         6.042802         5.5           8
 20  lag_freq(2).i           4     1               53          53          53
 21  lag_freq(2).a           5     1            0.998       0.998       0.998
 22  lag_freq(2).h1          6     1                2           2           2
 23  lag_freq(2).h2          0     0         7.375426           3          20
 24  lag_freq(2).Gamma1      0     0         2.604196         1.5       3.299
 25  lag_freq(2).Gamma2      0     0         1.457413         1.4         3.2
 26  lag_freq(2).Fe         10     1                1           1           1
 27  lag_freq(2).xi          0     0        0.3817421           0           3
 28  lag_freq(2).p          12     1                0           0           0
 29  lag_freq(2).b           0     0                1           1           3
 30  lag_freq(2).q2         14     1              0.5         0.5         0.5
 31  lag_freq(2).t_max       0     0         449.9998          50         800
 32  lag_freq(2).t_shift     0     0         106.0859           0         120
 33  sds(3).dataset          0     1                3           0           0
 34  lag_freq(3).norm        0     0               10           0          10
 35  lag_freq(3).log_mass    3     0         6.042802         5.5           8
 36  lag_freq(3).i           4     1               53          53          53
 37  lag_freq(3).a           5     1            0.998       0.998       0.998
 38  lag_freq(3).h1          6     1                2           2           2
 39  lag_freq(3).h2          0     0               11           3          20
 40  lag_freq(3).Gamma1      0     0         2.269686         1.5       3.299
 41  lag_freq(3).Gamma2      0     0              1.7         1.4         3.2
 42  lag_freq(3).Fe         10     1                1           1           1
 43  lag_freq(3).xi          0     0                2           0           3
 44  lag_freq(3).p          12     1                0           0           0
 45  lag_freq(3).b           0     0                3           1           3
 46  lag_freq(3).q2         14     1              0.5         0.5         0.5
 47  lag_freq(3).t_max       0     0         488.1274          50         800
 48  lag_freq(3).t_shift     0     0         22.12493           0         120
 49  sds(4).dataset          0     1                4           0           0
 50  lag_freq(4).norm        0     0         1.249014           0          10
 51  lag_freq(4).log_mass    3     0         6.042802         5.5           8
 52  lag_freq(4).i           4     1               53          53          53
 53  lag_freq(4).a           5     1            0.998       0.998       0.998
 54  lag_freq(4).h1          6     1                2           2           2
 55  lag_freq(4).h2          0     0         3.000001           3          20
 56  lag_freq(4).Gamma1      0     0         2.000001         1.5       3.299
 57  lag_freq(4).Gamma2      0     0         1.400001         1.4         3.2
 58  lag_freq(4).Fe         10     1                1           1           1
 59  lag_freq(4).xi          0     0         2.405426           0           3
 60  lag_freq(4).p          12     1                0           0           0
 61  lag_freq(4).b           0     0         2.753889           1           3
 62  lag_freq(4).q2         14     1              0.5         0.5         0.5
 63  lag_freq(4).t_max       0     0         600.0538          50         800
 64  lag_freq(4).t_shift     0     0         66.76552           0         120
 65  sds(5).dataset          0     1                5           0           0
 66  lag_freq(5).norm        0     0         9.295433           0          10
 67  lag_freq(5).log_mass    3     0         6.042802         5.5           8
 68  lag_freq(5).i           4     1               53          53          53
 69  lag_freq(5).a           5     1            0.998       0.998       0.998
 70  lag_freq(5).h1          6     1                2           2           2
 71  lag_freq(5).h2          0     0         10.99996           3          20
 72  lag_freq(5).Gamma1      0     0         2.552774         1.5       3.299
 73  lag_freq(5).Gamma2      0     0         2.163997         1.4         3.2
 74  lag_freq(5).Fe         10     1                1           1           1
 75  lag_freq(5).xi          0     0        0.9517529           0           3
 76  lag_freq(5).p          12     1                0           0           0
 77  lag_freq(5).b           0     0                3           1           3
 78  lag_freq(5).q2         14     1              0.5         0.5         0.5
 79  lag_freq(5).t_max       0     0         540.9933          50         800
 80  lag_freq(5).t_shift     0     0         27.91104           0         120
 81  sds(6).dataset          0     1                6           0           0
 82  lag_freq(6).norm        0     0         4.981621           0          10
 83  lag_freq(6).log_mass    3     0         6.042802         5.5           8
 84  lag_freq(6).i           4     1               53          53          53
 85  lag_freq(6).a           5     1            0.998       0.998       0.998
 86  lag_freq(6).h1          6     1                2           2           2
 87  lag_freq(6).h2          0     0          11.9973           3          20
 88  lag_freq(6).Gamma1      0     0         2.303145         1.5       3.299
 89  lag_freq(6).Gamma2      0     0         1.698795         1.4         3.2
 90  lag_freq(6).Fe         10     1                1           1           1
 91  lag_freq(6).xi          0     0        0.7603871           0           3
 92  lag_freq(6).p          12     1                0           0           0
 93  lag_freq(6).b           0     0                3           1           3
 94  lag_freq(6).q2         14     1              0.5         0.5         0.5
 95  lag_freq(6).t_max       0     0         717.3494          50         800
 96  lag_freq(6).t_shift     0     0         25.32125           0         120
 97  sds(7).dataset          0     1                7           0           0
 98  lag_freq(7).norm        0     0               10           0          10
 99  lag_freq(7).log_mass    3     0         6.042802         5.5           8
100  lag_freq(7).i           4     1               53          53          53
101  lag_freq(7).a           5     1            0.998       0.998       0.998
102  lag_freq(7).h1          6     1                2           2           2
103  lag_freq(7).h2          0     0         11.29721           3          20
104  lag_freq(7).Gamma1      0     0         2.315592         1.5       3.299
105  lag_freq(7).Gamma2      0     0              1.7         1.4         3.2
106  lag_freq(7).Fe         10     1                1           1           1
107  lag_freq(7).xi          0     0        0.9161822           0           3
108  lag_freq(7).p          12     1                0           0           0
109  lag_freq(7).b           0     0                3           1           3
110  lag_freq(7).q2         14     1              0.5         0.5         0.5
111  lag_freq(7).t_max       0     0         643.5238          50         800
112  lag_freq(7).t_shift     0     0         21.92584           0         120
113  sds(8).dataset          0     1                8           0           0
114  lag_freq(8).norm        0     0               10           0          10
115  lag_freq(8).log_mass    3     0         6.042802         5.5           8
116  lag_freq(8).i           4     1               53          53          53
117  lag_freq(8).a           5     1            0.998       0.998       0.998
118  lag_freq(8).h1          6     1                2           2           2
119  lag_freq(8).h2          0     0         3.760985           3          20
120  lag_freq(8).Gamma1      0     0         1.801877         1.5       3.299
121  lag_freq(8).Gamma2      0     0         1.400001         1.4         3.2
122  lag_freq(8).Fe         10     1                1           1           1
123  lag_freq(8).xi          0     0                3           0           3
124  lag_freq(8).p          12     1                0           0           0
125  lag_freq(8).b           0     0         2.140189           1           3
126  lag_freq(8).q2         14     1              0.5         0.5         0.5
127  lag_freq(8).t_max       0     0          326.797          50         800
128  lag_freq(8).t_shift     0     0         25.77718           0         120
129  sds(9).dataset          0     1                9           0           0
130  lag_freq(9).norm        0     0          9.59703           0          10
131  lag_freq(9).log_mass    3     0         6.042802         5.5           8
132  lag_freq(9).i           4     1               53          53          53
133  lag_freq(9).a           5     1            0.998       0.998       0.998
134  lag_freq(9).h1          6     1                2           2           2
135  lag_freq(9).h2          0     0         3.000001           3          20
136  lag_freq(9).Gamma1      0     0         1.904305         1.5       3.299
137  lag_freq(9).Gamma2      0     0         1.499481         1.4         3.2
138  lag_freq(9).Fe         10     1                1           1           1
139  lag_freq(9).xi          0     0         2.999478           0           3
140  lag_freq(9).p          12     1                0           0           0
141  lag_freq(9).b           0     0                3           1           3
142  lag_freq(9).q2         14     1              0.5         0.5         0.5
143  lag_freq(9).t_max       0     0         501.1032          50         800
144  lag_freq(9).t_shift     0     0         21.92024           0         120
145  sds(10).dataset         0     1               10           0           0
146  lag_freq(10).norm       0     0         7.916341           0          10
147  lag_freq(10).log_mass   3     0         6.042802         5.5           8
148  lag_freq(10).i          4     1               53          53          53
149  lag_freq(10).a          5     1            0.998       0.998       0.998
150  lag_freq(10).h1         6     1                2           2           2
151  lag_freq(10).h2         0     0         11.44562           3          20
152  lag_freq(10).Gamma1     0     0         2.484206         1.5       3.299
153  lag_freq(10).Gamma2     0     0         1.711119         1.4         3.2
154  lag_freq(10).Fe        10     1                1           1           1
155  lag_freq(10).xi         0     0           2.3571           0           3
156  lag_freq(10).p         12     1                0           0           0
157  lag_freq(10).b          0     0         2.999978           1           3
158  lag_freq(10).q2        14     1              0.5         0.5         0.5
159  lag_freq(10).t_max      0     0         306.3338          50         800
160  lag_freq(10).t_shift    0     0         16.73007           0         120
161  sds(11).dataset         0     1               11           0           0
162  lag_freq(11).norm       0     0         5.157551           0          10
163  lag_freq(11).log_mass   3     0         6.042802         5.5           8
164  lag_freq(11).i          4     1               53          53          53
165  lag_freq(11).a          5     1            0.998       0.998       0.998
166  lag_freq(11).h1         6     1                2           2           2
167  lag_freq(11).h2         0     0          7.22281           3          20
168  lag_freq(11).Gamma1     0     0         2.602301         1.5       3.299
169  lag_freq(11).Gamma2     0     0         1.727017         1.4         3.2
170  lag_freq(11).Fe        10     1                1           1           1
171  lag_freq(11).xi         0     0         2.251726           0           3
172  lag_freq(11).p         12     1                0           0           0
173  lag_freq(11).b          0     0          2.97183           1           3
174  lag_freq(11).q2        14     1              0.5         0.5         0.5
175  lag_freq(11).t_max      0     0         193.0626          50         800
176  lag_freq(11).t_shift    0     0         14.17592           0         120
177  sds(12).dataset         0     1               12           0           0
178  lag_freq(12).norm       0     0       0.08605624           0          10
179  lag_freq(12).log_mass   3     0         6.042802         5.5           8
180  lag_freq(12).i          4     1               53          53          53
181  lag_freq(12).a          5     1            0.998       0.998       0.998
182  lag_freq(12).h1         6     1                2           2           2
183  lag_freq(12).h2         0     0         19.99993           3          20
184  lag_freq(12).Gamma1     0     0         2.051151         1.5       3.299
185  lag_freq(12).Gamma2     0     0         1.563508         1.4         3.2
186  lag_freq(12).Fe        10     1                1           1           1
187  lag_freq(12).xi         0     0       0.03518322           0           3
188  lag_freq(12).p         12     1                0           0           0
189  lag_freq(12).b          0     0          2.99956           1           3
190  lag_freq(12).q2        14     1              0.5         0.5         0.5
191  lag_freq(12).t_max      0     0         193.0626          50         800
192  lag_freq(12).t_shift    0     0         81.26388           0         120
193  sds(13).dataset         0     1               13           0           0
194  lag_freq(13).norm       0     0        0.3896797           0          10
195  lag_freq(13).log_mass   3     0         6.042802         5.5           8
196  lag_freq(13).i          4     1               53          53          53
197  lag_freq(13).a          5     1            0.998       0.998       0.998
198  lag_freq(13).h1         6     1                2           2           2
199  lag_freq(13).h2         0     0         19.99993           3          20
200  lag_freq(13).Gamma1     0     0          3.29895         1.5       3.299
201  lag_freq(13).Gamma2     0     0         1.510915         1.4         3.2
202  lag_freq(13).Fe        10     1                1           1           1
203  lag_freq(13).xi         0     0         2.249853           0           3
204  lag_freq(13).p         12     1                0           0           0
205  lag_freq(13).b          0     0         1.000046           1           3
206  lag_freq(13).q2        14     1              0.5         0.5         0.5
207  lag_freq(13).t_max      0     0         697.6993          50         800
208  lag_freq(13).t_shift    0     0         103.0311           0         120
209  sds(14).dataset         0     1               14           0           0
210  lag_freq(14).norm       0     0        0.1628152           0          10
211  lag_freq(14).log_mass   3     0         6.042802         5.5           8
212  lag_freq(14).i          4     1               53          53          53
213  lag_freq(14).a          5     1            0.998       0.998       0.998
214  lag_freq(14).h1         6     1                2           2           2
215  lag_freq(14).h2         0     0         19.99993           3          20
216  lag_freq(14).Gamma1     0     0         3.298872         1.5       3.299
217  lag_freq(14).Gamma2     0     0         1.578084         1.4         3.2
218  lag_freq(14).Fe        10     1                1           1           1
219  lag_freq(14).xi         0     0       0.07030791           0           3
220  lag_freq(14).p         12     1                0           0           0
221  lag_freq(14).b          0     0         1.249945           1           3
222  lag_freq(14).q2        14     1              0.5         0.5         0.5
223  lag_freq(14).t_max      0     0         516.8848          50         800
224  lag_freq(14).t_shift    0     0         73.20621           0         120
225  sds(15).dataset         0     1               15           0           0
226  lag_freq(15).norm       0     0        0.3561122           0          10
227  lag_freq(15).log_mass   3     0         6.042802         5.5           8
228  lag_freq(15).i          4     1               53          53          53
229  lag_freq(15).a          5     1            0.998       0.998       0.998
230  lag_freq(15).h1         6     1                2           2           2
231  lag_freq(15).h2         0     0         19.99993           3          20
232  lag_freq(15).Gamma1     0     0         3.298983         1.5       3.299
233  lag_freq(15).Gamma2     0     0         1.487196         1.4         3.2
234  lag_freq(15).Fe        10     1                1           1           1
235  lag_freq(15).xi         0     0        0.5624994           0           3
236  lag_freq(15).p         12     1                0           0           0
237  lag_freq(15).b          0     0          2.49989           1           3
238  lag_freq(15).q2        14     1              0.5         0.5         0.5
239  lag_freq(15).t_max      0     0         505.4393          50         800
240  lag_freq(15).t_shift    0     0         94.09409           0         120


Errors contained in  ajy-conf.csv

#+END_EXAMPLE

** Errors on 15 data


PATH = =/data/typhon1/reverb/table-model-ecm-fits/1H0707-495=

gedit =ajy-conf.csv=


| 1 | 237 | 2.4999e+00 | 1.5242e+00 | 3.0000e+00 | Thu | Jul | 22 | 15:28:11 | 2021 |
| 1 | 235 | 5.6250e-01 | 0.0000e+00 | 2.3699e+00 | Thu | Jul | 22 | 15:28:13 | 2021 |
| 1 | 216 | 3.2989e+00 | 1.7456e+00 | 3.2990e+00 | Thu | Jul | 22 | 15:28:15 | 2021 |
| 1 | 203 | 2.2499e+00 | 0.0000e+00 | 3.0000e+00 | Thu | Jul | 22 | 15:28:18 | 2021 |
| 1 | 208 | 1.0303e+02 | 6.5564e+01 | 1.2000e+02 | Thu | Jul | 22 | 15:28:19 | 2021 |
| 1 | 200 | 3.2989e+00 | 2.3683e+00 | 3.2990e+00 | Thu | Jul | 22 | 15:28:21 | 2021 |
| 1 | 205 | 1.0000e+00 | 1.0000e+00 | 1.3179e+00 | Thu | Jul | 22 | 15:28:23 | 2021 |
| 1 | 201 | 1.5109e+00 | 1.4780e+00 | 2.6226e+00 | Thu | Jul | 22 | 15:28:23 | 2021 |
| 1 | 194 | 3.8968e-01 | 3.0404e-01 | 5.8070e-01 | Thu | Jul | 22 | 15:28:24 | 2021 |
| 1 | 207 | 6.9770e+02 | 3.9951e+02 | 7.1096e+02 | Thu | Jul | 22 | 15:28:25 | 2021 |
| 1 | 173 | 2.9718e+00 | 2.4624e+00 | 3.0000e+00 | Thu | Jul | 22 | 15:28:27 | 2021 |
| 1 | 139 | 2.9995e+00 | 2.7552e+00 | 3.0000e+00 | Thu | Jul | 22 | 15:28:29 | 2021 |
| 1 | 130 | 9.5970e+00 | 7.2510e+00 | 1.0000e+01 | Thu | Jul | 22 | 15:28:30 | 2021 |
| 1 |  82 | 4.9816e+00 | 0.0000e+00 | 9.9002e+00 | Thu | Jul | 22 | 15:28:32 | 2021 |
| 1 |   2 | 7.3911e+00 | 3.6336e+00 | 1.0000e+01 | Thu | Jul | 22 | 15:28:34 | 2021 |
| 1 |   3 | 6.0428e+00 | 6.0358e+00 | 6.0463e+00 | Thu | Jul | 22 | 15:28:35 | 2021 |
| 1 |   7 | 1.1097e+01 | 1.0502e+01 | 1.3115e+01 | Thu | Jul | 22 | 15:28:36 | 2021 |
| 1 |   8 | 2.1583e+00 | 2.0976e+00 | 2.2082e+00 | Thu | Jul | 22 | 15:28:36 | 2021 |
| 1 |   9 | 1.6651e+00 | 1.6320e+00 | 1.7029e+00 | Thu | Jul | 22 | 15:28:37 | 2021 |
| 1 |  11 | 4.9752e-02 | 0.0000e+00 | 2.7300e+00 | Thu | Jul | 22 | 15:28:39 | 2021 |
| 1 |  13 | 2.1810e+00 | 2.0439e+00 | 2.3232e+00 | Thu | Jul | 22 | 15:28:39 | 2021 |
| 1 |  15 | 4.5000e+02 | 3.7647e+02 | 4.9395e+02 | Thu | Jul | 22 | 15:28:40 | 2021 |
| 1 |  16 | 3.0527e+01 | 2.6821e+01 | 3.1514e+01 | Thu | Jul | 22 | 15:28:41 | 2021 |
| 1 |  18 | 3.8091e+00 | 1.9716e+00 | 5.4749e+00 | Thu | Jul | 22 | 15:28:41 | 2021 |
| 1 |  23 | 7.3754e+00 | 7.1023e+00 | 7.6766e+00 | Thu | Jul | 22 | 15:28:42 | 2021 |
| 1 |  24 | 2.6042e+00 | 2.1572e+00 | 2.8530e+00 | Thu | Jul | 22 | 15:28:43 | 2021 |
| 1 |  25 | 1.4574e+00 | 1.4000e+00 | 2.3256e+00 | Thu | Jul | 22 | 15:28:44 | 2021 |
| 1 |  27 | 3.8174e-01 | 1.1129e-01 | 6.7989e-01 | Thu | Jul | 22 | 15:28:45 | 2021 |
| 1 |  29 | 1.0000e+00 | 1.0000e+00 | 1.6163e+00 | Thu | Jul | 22 | 15:28:45 | 2021 |
| 1 |  31 | 4.5000e+02 | 3.6894e+02 | 6.2087e+02 | Thu | Jul | 22 | 15:28:47 | 2021 |
| 1 |  32 | 1.0609e+02 | 1.0437e+02 | 1.0797e+02 | Thu | Jul | 22 | 15:28:47 | 2021 |
| 1 |  34 | 1.0000e+01 | 6.5513e+00 | 1.0000e+01 | Thu | Jul | 22 | 15:28:48 | 2021 |
| 1 |  39 | 1.1000e+01 | 1.0655e+01 | 1.2464e+01 | Thu | Jul | 22 | 15:28:48 | 2021 |
| 1 |  40 | 2.2697e+00 | 2.2332e+00 | 2.2981e+00 | Thu | Jul | 22 | 15:28:49 | 2021 |
| 1 |  41 | 1.7000e+00 | 1.6655e+00 | 1.7473e+00 | Thu | Jul | 22 | 15:28:50 | 2021 |
| 1 |  43 | 2.0000e+00 | 0.0000e+00 | 2.3338e+00 | Thu | Jul | 22 | 15:28:52 | 2021 |
| 1 |  45 | 3.0000e+00 | 2.8593e+00 | 3.0000e+00 | Thu | Jul | 22 | 15:28:52 | 2021 |
| 1 |  47 | 4.8813e+02 | 4.5504e+02 | 5.2512e+02 | Thu | Jul | 22 | 15:28:52 | 2021 |
| 1 |  48 | 2.2125e+01 | 2.1347e+01 | 2.2892e+01 | Thu | Jul | 22 | 15:28:53 | 2021 |
| 1 |  50 | 1.2490e+00 | 7.3373e-01 | 1.7636e+00 | Thu | Jul | 22 | 15:28:53 | 2021 |
| 1 |  55 | 3.0000e+00 | 3.0000e+00 | 6.4830e+00 | Thu | Jul | 22 | 15:28:55 | 2021 |
| 1 |  56 | 2.0000e+00 | 1.7447e+00 | 2.3469e+00 | Thu | Jul | 22 | 15:28:56 | 2021 |
| 1 |  57 | 1.4000e+00 | 1.4000e+00 | 1.6953e+00 | Thu | Jul | 22 | 15:28:58 | 2021 |
| 1 |  59 | 2.4054e+00 | 2.2382e+00 | 2.5725e+00 | Thu | Jul | 22 | 15:28:58 | 2021 |
| 1 |  61 | 2.7539e+00 | 1.7360e+00 | 3.0000e+00 | Thu | Jul | 22 | 15:29:00 | 2021 |
| 1 |  63 | 6.0005e+02 | 4.4952e+02 | 6.2067e+02 | Thu | Jul | 22 | 15:29:01 | 2021 |
| 1 |  64 | 6.6766e+01 | 5.5851e+01 | 7.7710e+01 | Thu | Jul | 22 | 15:29:01 | 2021 |
| 1 |  66 | 9.2954e+00 | 5.6843e+00 | 1.0000e+01 | Thu | Jul | 22 | 15:29:03 | 2021 |
| 1 |  71 | 1.1000e+01 | 1.0612e+01 | 1.1695e+01 | Thu | Jul | 22 | 15:29:04 | 2021 |
| 1 |  72 | 2.5528e+00 | 2.5276e+00 | 2.5740e+00 | Thu | Jul | 22 | 15:29:05 | 2021 |
| 1 |  73 | 2.1640e+00 | 2.1420e+00 | 2.1890e+00 | Thu | Jul | 22 | 15:29:05 | 2021 |
| 1 |  75 | 9.5175e-01 | 0.0000e+00 | 2.6915e+00 | Thu | Jul | 22 | 15:29:07 | 2021 |
| 1 |  77 | 3.0000e+00 | 2.9414e+00 | 3.0000e+00 | Thu | Jul | 22 | 15:29:07 | 2021 |
| 1 |  79 | 5.4099e+02 | 5.0733e+02 | 5.5914e+02 | Thu | Jul | 22 | 15:29:08 | 2021 |
| 1 |  80 | 2.7911e+01 | 2.7057e+01 | 2.8755e+01 | Thu | Jul | 22 | 15:29:09 | 2021 |
| 1 |  87 | 1.1997e+01 | 3.0000e+00 | 1.6758e+01 | Thu | Jul | 22 | 15:29:11 | 2021 |
| 1 |  88 | 2.3031e+00 | 2.1659e+00 | 2.3695e+00 | Thu | Jul | 22 | 15:29:12 | 2021 |
| 1 |  89 | 1.6988e+00 | 1.4000e+00 | 1.8615e+00 | Thu | Jul | 22 | 15:29:14 | 2021 |
| 1 |  91 | 7.6039e-01 | 0.0000e+00 | 2.8150e+00 | Thu | Jul | 22 | 15:29:15 | 2021 |
| 1 |  93 | 3.0000e+00 | 2.6793e+00 | 3.0000e+00 | Thu | Jul | 22 | 15:29:16 | 2021 |
| 1 |  95 | 7.1735e+02 | 6.1781e+02 | 8.0000e+02 | Thu | Jul | 22 | 15:29:18 | 2021 |
| 1 |  96 | 2.5321e+01 | 2.1084e+01 | 2.7644e+01 | Thu | Jul | 22 | 15:29:19 | 2021 |
| 1 |  98 | 1.0000e+01 | 6.7410e+00 | 1.0000e+01 | Thu | Jul | 22 | 15:29:19 | 2021 |
| 1 | 103 | 1.1297e+01 | 1.1164e+01 | 1.1460e+01 | Thu | Jul | 22 | 15:29:20 | 2021 |
| 1 | 104 | 2.3156e+00 | 2.2715e+00 | 2.3719e+00 | Thu | Jul | 22 | 15:29:21 | 2021 |
| 1 | 105 | 1.7000e+00 | 1.6674e+00 | 1.7574e+00 | Thu | Jul | 22 | 15:29:22 | 2021 |
| 1 | 107 | 9.1618e-01 | 0.0000e+00 | 2.6129e+00 | Thu | Jul | 22 | 15:29:23 | 2021 |
| 1 | 109 | 3.0000e+00 | 2.8241e+00 | 3.0000e+00 | Thu | Jul | 22 | 15:29:24 | 2021 |
| 1 | 111 | 6.4352e+02 | 6.2924e+02 | 7.0976e+02 | Thu | Jul | 22 | 15:29:25 | 2021 |
| 1 | 112 | 2.1926e+01 | 2.0763e+01 | 2.3100e+01 | Thu | Jul | 22 | 15:29:25 | 2021 |
| 1 | 114 | 1.0000e+01 | 7.5464e+00 | 1.0000e+01 | Thu | Jul | 22 | 15:29:26 | 2021 |
| 1 | 119 | 3.7610e+00 | 3.0000e+00 | 4.2438e+00 | Thu | Jul | 22 | 15:29:27 | 2021 |
| 1 | 120 | 1.8019e+00 | 1.7891e+00 | 1.8164e+00 | Thu | Jul | 22 | 15:29:28 | 2021 |
| 1 | 121 | 1.4000e+00 | 1.4000e+00 | 1.4180e+00 | Thu | Jul | 22 | 15:29:30 | 2021 |
| 1 | 123 | 3.0000e+00 | 2.6340e+00 | 3.0000e+00 | Thu | Jul | 22 | 15:29:31 | 2021 |
| 1 | 125 | 2.1402e+00 | 2.0825e+00 | 2.1978e+00 | Thu | Jul | 22 | 15:29:31 | 2021 |
| 1 | 127 | 3.2680e+02 | 3.1260e+02 | 3.4112e+02 | Thu | Jul | 22 | 15:29:32 | 2021 |
| 1 | 128 | 2.5777e+01 | 2.5158e+01 | 2.6397e+01 | Thu | Jul | 22 | 15:29:32 | 2021 |
| 1 | 135 | 3.0000e+00 | 3.0000e+00 | 3.9145e+00 | Thu | Jul | 22 | 15:29:34 | 2021 |
| 1 | 136 | 1.9043e+00 | 1.8896e+00 | 1.9238e+00 | Thu | Jul | 22 | 15:29:34 | 2021 |
| 1 | 137 | 1.4995e+00 | 1.4702e+00 | 1.5202e+00 | Thu | Jul | 22 | 15:29:35 | 2021 |
| 1 | 141 | 3.0000e+00 | 2.8489e+00 | 3.0000e+00 | Thu | Jul | 22 | 15:29:35 | 2021 |
| 1 | 143 | 5.0110e+02 | 4.7343e+02 | 5.6425e+02 | Thu | Jul | 22 | 15:29:36 | 2021 |
| 1 | 144 | 2.1920e+01 | 2.1406e+01 | 2.2520e+01 | Thu | Jul | 22 | 15:29:37 | 2021 |
| 1 | 146 | 7.9163e+00 | 6.0893e+00 | 1.0000e+01 | Thu | Jul | 22 | 15:29:39 | 2021 |
| 1 | 151 | 1.1446e+01 | 1.0825e+01 | 1.2524e+01 | Thu | Jul | 22 | 15:29:39 | 2021 |
| 1 | 152 | 2.4842e+00 | 2.4384e+00 | 2.5089e+00 | Thu | Jul | 22 | 15:29:40 | 2021 |
| 1 | 153 | 1.7111e+00 | 1.6783e+00 | 1.7708e+00 | Thu | Jul | 22 | 15:29:41 | 2021 |
| 1 | 155 | 2.3571e+00 | 0.0000e+00 | 2.5605e+00 | Thu | Jul | 22 | 15:29:42 | 2021 |
| 1 | 157 | 3.0000e+00 | 2.8543e+00 | 3.0000e+00 | Thu | Jul | 22 | 15:29:44 | 2021 |
| 1 | 159 | 3.0633e+02 | 2.8999e+02 | 3.3327e+02 | Thu | Jul | 22 | 15:29:45 | 2021 |
| 1 | 160 | 1.6730e+01 | 1.6124e+01 | 1.7269e+01 | Thu | Jul | 22 | 15:29:45 | 2021 |
| 1 | 162 | 5.1576e+00 | 2.6927e+00 | 8.3214e+00 | Thu | Jul | 22 | 15:29:46 | 2021 |
| 1 | 167 | 7.2228e+00 | 5.9544e+00 | 8.5071e+00 | Thu | Jul | 22 | 15:29:47 | 2021 |
| 1 | 168 | 2.6023e+00 | 2.5196e+00 | 2.6657e+00 | Thu | Jul | 22 | 15:29:47 | 2021 |
| 1 | 169 | 1.7270e+00 | 1.6286e+00 | 1.8577e+00 | Thu | Jul | 22 | 15:29:48 | 2021 |
| 1 | 171 | 2.2517e+00 | 0.0000e+00 | 2.5981e+00 | Thu | Jul | 22 | 15:29:50 | 2021 |
| 1 | 175 | 1.9306e+02 | 1.6987e+02 | 2.1601e+02 | Thu | Jul | 22 | 15:29:50 | 2021 |
| 1 | 176 | 1.4176e+01 | 1.3052e+01 | 1.5101e+01 | Thu | Jul | 22 | 15:29:51 | 2021 |
| 1 | 178 | 8.6056e-02 | 1.5929e-02 | 2.4670e-01 | Thu | Jul | 22 | 15:29:52 | 2021 |
| 1 | 183 | 2.0000e+01 | 1.4220e+01 | 2.0000e+01 | Thu | Jul | 22 | 15:29:54 | 2021 |
| 1 | 184 | 2.0512e+00 | 1.7211e+00 | 2.7662e+00 | Thu | Jul | 22 | 15:29:55 | 2021 |
| 1 | 185 | 1.5635e+00 | 1.4188e+00 | 2.8976e+00 | Thu | Jul | 22 | 15:29:55 | 2021 |
| 1 | 187 | 3.5183e-02 | 0.0000e+00 | 3.0000e+00 | Thu | Jul | 22 | 15:29:58 | 2021 |
| 1 | 189 | 2.9996e+00 | 1.0000e+00 | 3.0000e+00 | Thu | Jul | 22 | 15:30:01 | 2021 |
| 1 | 191 | 1.9306e+02 | 6.9328e+01 | 4.2660e+02 | Thu | Jul | 22 | 15:30:02 | 2021 |
| 1 | 192 | 8.1264e+01 | 6.6168e+01 | 1.1396e+02 | Thu | Jul | 22 | 15:30:02 | 2021 |
| 1 | 199 | 2.0000e+01 | 1.9780e+01 | 2.0000e+01 | Thu | Jul | 22 | 15:30:04 | 2021 |
| 1 | 210 | 1.6282e-01 | 5.6427e-02 | 3.3534e-01 | Thu | Jul | 22 | 15:30:05 | 2021 |
| 1 | 215 | 2.0000e+01 | 1.7358e+01 | 2.0000e+01 | Thu | Jul | 22 | 15:30:07 | 2021 |
| 1 | 217 | 1.5781e+00 | 1.4345e+00 | 3.2000e+00 | Thu | Jul | 22 | 15:30:08 | 2021 |
| 1 | 219 | 7.0308e-02 | 0.0000e+00 | 3.0000e+00 | Thu | Jul | 22 | 15:30:11 | 2021 |
| 1 | 221 | 1.2499e+00 | 1.0000e+00 | 2.8246e+00 | Thu | Jul | 22 | 15:30:13 | 2021 |
| 1 | 223 | 5.1688e+02 | 1.7557e+02 | 7.3012e+02 | Thu | Jul | 22 | 15:30:14 | 2021 |
| 1 | 224 | 7.3206e+01 | 0.0000e+00 | 1.2000e+02 | Thu | Jul | 22 | 15:30:16 | 2021 |
| 1 | 226 | 3.5611e-01 | 2.1573e-01 | 4.6533e-01 | Thu | Jul | 22 | 15:30:17 | 2021 |
| 1 | 231 | 2.0000e+01 | 1.9606e+01 | 2.0000e+01 | Thu | Jul | 22 | 15:30:19 | 2021 |
| 1 | 232 | 3.2990e+00 | 2.5672e+00 | 3.2990e+00 | Thu | Jul | 22 | 15:30:21 | 2021 |
| 1 | 233 | 1.4872e+00 | 1.4528e+00 | 2.1607e+00 | Thu | Jul | 22 | 15:30:21 | 2021 |
| 1 | 239 | 5.0544e+02 | 3.6240e+02 | 7.0507e+02 | Thu | Jul | 22 | 15:30:22 | 2021 |
| 1 | 240 | 9.4094e+01 | 8.6859e+01 | 1.0393e+02 | Thu | Jul | 22 | 15:30:23 | 2021 |

** 0110890201 lag_freq(1)

Use these fitting scripts (Do not run conf - already done in
=conf_mass_fit_15data.csv) :

PATH = =sim-fit-0110890201.sl=

PARFILE = =sim_fit_0110890201.par=

#+BEGIN_EXAMPLE
lag_freq(1)
 idx  param              tie-to  freeze         value         min         max
  1  lag_freq(1).norm        0     1         7.391117           0          10
  2  lag_freq(1).log_mass    0     1         6.042802         5.5           8
  3  lag_freq(1).i           0     1               53          53          53
  4  lag_freq(1).a           0     1            0.998       0.998       0.998
  5  lag_freq(1).h1          0     1                2           2           2
  6  lag_freq(1).h2          0     1         11.09708           3          20
  7  lag_freq(1).Gamma1      0     1         2.158333         1.5       3.299
  8  lag_freq(1).Gamma2      0     1         1.665053         1.4         3.2
  9  lag_freq(1).Fe          0     1                1           1           1
 10  lag_freq(1).xi          0     1       0.04975207           0           3
 11  lag_freq(1).p           0     1                0           0           0
 12  lag_freq(1).b           0     1         2.180972           1           3
 13  lag_freq(1).q2          0     1              0.5         0.5         0.5
 14  lag_freq(1).t_max       0     1              450          50         800
 15  lag_freq(1).t_shift     0     1          30.5271           0         120

source("sim-fit-0110890201.sl");

 Parameters[Variable] = 15[0]
            Data bins = 14
           Chi-square = 3.70766
   Reduced chi-square = 0.2648328
lag_freq(1)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     1         7.391117           0          10
  2  lag_freq(1).log_mass   0     1         6.042802         5.5           8
  3  lag_freq(1).i          0     1               53          53          53
  4  lag_freq(1).a          0     1            0.998       0.998       0.998
  5  lag_freq(1).h1         0     1                2           2           2
  6  lag_freq(1).h2         0     1         11.09708           3          20
  7  lag_freq(1).Gamma1     0     1         2.158333         1.5       3.299
  8  lag_freq(1).Gamma2     0     1         1.665053         1.4         3.2
  9  lag_freq(1).Fe         0     1                1           1           1
 10  lag_freq(1).xi         0     1       0.04975207           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1         2.180972           1           3
 13  lag_freq(1).q2         0     1              0.5         0.5         0.5
 14  lag_freq(1).t_max      0     1              450          50         800
 15  lag_freq(1).t_shift    0     1          30.5271           0         120

#+END_EXAMPLE

|  1 | 7.3911e+00 | 3.6336e+00 | 1.0000e+01 |
|  2 | 6.0428e+00 | 6.0358e+00 | 6.0463e+00 |
|  6 | 1.1097e+01 | 1.0502e+01 | 1.3115e+01 |
|  7 | 2.1583e+00 | 2.0976e+00 | 2.2082e+00 |
|  8 | 1.6651e+00 | 1.6320e+00 | 1.7029e+00 |
| 10 | 4.9752e-02 | 0.0000e+00 | 2.7300e+00 |
| 12 | 2.1810e+00 | 2.0439e+00 | 2.3232e+00 |
| 14 | 4.5000e+02 | 3.7647e+02 | 4.9395e+02 |
| 15 | 3.0527e+01 | 2.6821e+01 | 3.1514e+01 |

| Par |        val |           + |          - |
|   1 |     7.3911 |      2.6089 |     3.7575 |
|   2 |     6.0428 |      0.0069 |    0.00349 |
|   6 | 1.1097e+01 |      2.0180 |  0.5949999 |
|   7 |     2.1583 |      0.0607 |     0.0499 |
|   8 | 1.6651e+00 |      0.0378 |    0.03310 |
|  10 | 4.9752e-02 |    2.680248 | 4.9752e-02 |
|  12 | 2.1810e+00 |    0.142199 |    0.13710 |
|  14 | 4.5000e+02 |   43.949999 | 73.5299999 |
|  15 | 3.0527e+01 | 0.986999999 |    3.70599 |


#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit2_0110890201.gif

pdf at:


#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit2_0110890201.pdf

** 0148010301 lag_freq(2)

Use these fitting scripts (Do not run conf - already done in
=conf_mass_fit_15data.csv) :

PATH = =sim-fit-0148010301.sl=

PARFILE = =sim_fit_0148010301.par=

#+BEGIN_EXAMPLE
lag_freq(2)
  1  lag_freq(2).norm       0     1         3.809085          0          10
  2  lag_freq(2).log_mass   0     1         6.042802        5.5           8
  3  lag_freq(2).i          0     1               53         53          53
  4  lag_freq(2).a          0     1            0.998      0.998       0.998
  5  lag_freq(2).h1         0     1                2          2           2
  6  lag_freq(2).h2         0     1         7.375426          3          20
  7  lag_freq(2).Gamma1     0     1         2.604196        1.5       3.299
  8  lag_freq(2).Gamma2     0     1         1.457413        1.4         3.2
  9  lag_freq(2).Fe         0     1                1          1           1
 10  lag_freq(2).xi         0     1        0.3817421          0           3
 11  lag_freq(2).p          0     1                0          0           0
 12  lag_freq(2).b          0     1                1          1           3
 13  lag_freq(2).q2         0     1              0.5        0.5         0.5
 14  lag_freq(2).t_max      0     1         449.9998         50         800
 15  lag_freq(2).t_shift    0     1         106.0859          0         120


source("sim-fit-0148010301.sl");

 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 4.589045
   Reduced chi-square = 0.6555779
isis> list_par;
lag_freq(2)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(2).norm       0     1         3.809085           0          10
  2  lag_freq(2).log_mass   0     1         6.042802         5.5           8
  3  lag_freq(2).i          0     1               53          53          53
  4  lag_freq(2).a          0     1            0.998       0.998       0.998
  5  lag_freq(2).h1         0     1                2           2           2
  6  lag_freq(2).h2         0     1         7.375426           3          20
  7  lag_freq(2).Gamma1     0     1         2.604196         1.5       3.299
  8  lag_freq(2).Gamma2     0     1         1.457413         1.4         3.2
  9  lag_freq(2).Fe         0     1                1           1           1
 10  lag_freq(2).xi         0     1        0.3817421           0           3
 11  lag_freq(2).p          0     1                0           0           0
 12  lag_freq(2).b          0     1                1           1           3
 13  lag_freq(2).q2         0     1              0.5         0.5         0.5
 14  lag_freq(2).t_max      0     1         449.9998          50         800
 15  lag_freq(2).t_shift    0     1         106.0859           0         120

#+END_EXAMPLE

| par                 | no |        val |         lo |         hi |
| lag_freq(2).norm    | 18 | 3.8091e+00 | 1.9716e+00 | 5.4749e+00 |
| lag_freq(2).h2      | 23 | 7.3754e+00 | 7.1023e+00 | 7.6766e+00 |
| lag_freq(2).Gamma1  | 24 | 2.6042e+00 | 2.1572e+00 | 2.8530e+00 |
| lag_freq(2).Gamma2  | 25 | 1.4574e+00 | 1.4000e+00 | 2.3256e+00 |
| lag_freq(2).xi      | 27 | 3.8174e-01 | 1.1129e-01 | 6.7989e-01 |
| lag_freq(2).b       | 29 | 1.0000e+00 | 1.0000e+00 | 1.6163e+00 |
| lag_freq(2).t_max   | 31 | 4.5000e+02 | 3.6894e+02 | 6.2087e+02 |
| lag_freq(2).t_shift | 32 | 1.0609e+02 | 1.0437e+02 | 1.0797e+02 |



#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit2_0148010301.gif

pdf at:

http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit2_0148010301.pdf

** 0506200201 lag_freq(3)
Use these fitting scripts (Do not run conf - already done in
=conf_mass_fit_15data.csv) :

PATH = =sim-fit-0506200201.sl=

PARFILE = =sim_fit_0506200201.par=

#+BEGIN_EXAMPLE
source("sim-fit-0506200201.sl");

 34  lag_freq(3).norm        0     0               10           0          10
 35  lag_freq(3).log_mass    3     0         6.042802         5.5           8
 36  lag_freq(3).i           4     1               53          53          53
 37  lag_freq(3).a           5     1            0.998       0.998       0.998
 38  lag_freq(3).h1          6     1                2           2           2
 39  lag_freq(3).h2          0     0               11           3          20
 40  lag_freq(3).Gamma1      0     0         2.269686         1.5       3.299
 41  lag_freq(3).Gamma2      0     0              1.7         1.4         3.2
 42  lag_freq(3).Fe         10     1                1           1           1
 43  lag_freq(3).xi          0     0                2           0           3
 44  lag_freq(3).p          12     1                0           0           0
 45  lag_freq(3).b           0     0                3           1           3
 46  lag_freq(3).q2         14     1              0.5         0.5         0.5
 47  lag_freq(3).t_max       0     0         488.1274          50         800
 48  lag_freq(3).t_shift     0     0         22.12493           0         120

source("sim-fit-0506200201.sl");

chi-squared = 2.387644
reduced ch-squared = 0.3410949

[detached from 53720.pts-17.hm00]

 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 2.387664
   Reduced chi-square = 0.3410949
isis> list_par;
lag_freq(3)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(3).norm       0     1               10           0          10
  2  lag_freq(3).log_mass   0     1         6.042802           6           8
  3  lag_freq(3).i          0     1               53          53          53
  4  lag_freq(3).a          0     1            0.998       0.998       0.998
  5  lag_freq(3).h1         0     1                2           2           2
  6  lag_freq(3).h2         0     1               11           3          20
  7  lag_freq(3).Gamma1     0     1         2.269686         1.5       3.299
  8  lag_freq(3).Gamma2     0     1              1.7         1.4         3.2
  9  lag_freq(3).Fe         0     1                1           1           1
 10  lag_freq(3).xi         0     1                2           0           3
 11  lag_freq(3).p          0     1                0           0           0
 12  lag_freq(3).b          0     1                3           1           3
 13  lag_freq(3).q2         0     1              0.5         0.5         0.5
 14  lag_freq(3).t_max      0     1         488.1274          50         800
 15  lag_freq(3).t_shift    0     1         22.12493           0         120


#+END_EXAMPLE

| par                 | no |        val |         lo |         hi |
| lag_freq(3).norm    | 34 | 1.0000e+01 | 6.5513e+00 | 1.0000e+01 |
| lag_freq(3).h2      | 39 | 1.1000e+01 | 1.0655e+01 | 1.2464e+01 |
| lag_freq(3).Gamma1  | 40 | 2.2697e+00 | 2.2332e+00 | 2.2981e+00 |
| lag_freq(3).Gamma2  | 41 | 1.7000e+00 | 1.6655e+00 | 1.7473e+00 |
| lag_freq(3).xi      | 43 | 2.0000e+00 | 0.0000e+00 | 2.3338e+00 |
| lag_freq(3).b       | 45 | 3.0000e+00 | 2.8593e+00 | 3.0000e+00 |
| lag_freq(3).t_max   | 47 | 4.8813e+02 | 4.5504e+02 | 5.2512e+02 |
| lag_freq(3).t_shift | 48 | 2.2125e+01 | 2.1347e+01 | 2.2892e+01 |

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit2_0506200201.gif

pdf at:

http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit2_0506200201.pdf

** 0506200301 lag_freq(4)
Use these fitting scripts (Do not run conf - already done in
=conf_mass_fit_15data.csv) :

PATH = =sim-fit-0506200301.sl=

PARFILE = =sim_fit_0506200301.par=

#+BEGIN_EXAMPLE
lag_freq(4)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(4).norm       0     1         1.249014           0          10
  2  lag_freq(4).log_mass   0     1         6.042802         5.5           8
  3  lag_freq(4).i          0     1               53          53          53
  4  lag_freq(4).a          0     1            0.998       0.998       0.998
  5  lag_freq(4).h1         0     1                2           2           2
  6  lag_freq(4).h2         0     1         3.000001           3          20
  7  lag_freq(4).Gamma1     0     1         2.000001         1.5       3.299
  8  lag_freq(4).Gamma2     0     1         1.400001         1.4         3.2
  9  lag_freq(4).Fe         0     1                1           1           1
 10  lag_freq(4).xi         0     1         2.405426           0           3
 11  lag_freq(4).p          0     1                0           0           0
 12  lag_freq(4).b          0     1         2.753889           1           3
 13  lag_freq(4).q2         0     1              0.5         0.5         0.5
 14  lag_freq(4).t_max      0     1         600.0538          50         800
 15  lag_freq(4).t_shift    0     1         66.76552           0         120

source("sim-fit-0506200301.sl");


[detached from 55207.pts-17.hm00]

 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 3.436859
   Reduced chi-square = 0.4909799
isis> list_par;
lag_freq(4)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(4).norm       0     1         1.249014           0          10
  2  lag_freq(4).log_mass   0     1         6.042802         5.5           8
  3  lag_freq(4).i          0     1               53          53          53
  4  lag_freq(4).a          0     1            0.998       0.998       0.998
  5  lag_freq(4).h1         0     1                2           2           2
  6  lag_freq(4).h2         0     1         3.000001           3          20
  7  lag_freq(4).Gamma1     0     1         2.000001         1.5       3.299
  8  lag_freq(4).Gamma2     0     1         1.400001         1.4         3.2
  9  lag_freq(4).Fe         0     1                1           1           1
 10  lag_freq(4).xi         0     1         2.405426           0           3
 11  lag_freq(4).p          0     1                0           0           0
 12  lag_freq(4).b          0     1         2.753889           1           3
 13  lag_freq(4).q2         0     1              0.5         0.5         0.5
 14  lag_freq(4).t_max      0     1         600.0538          50         800
 15  lag_freq(4).t_shift    0     1         66.76552           0         120


#+END_EXAMPLE

| par                 | no |        val |         lo |         hi |
| lag_freq(4).norm    | 50 | 1.2490e+00 | 7.3373e-01 | 1.7636e+00 |
| lag_freq(4).h2      | 55 | 3.0000e+00 | 3.0000e+00 | 6.4830e+00 |
| lag_freq(4).Gamma1  | 56 | 2.0000e+00 | 1.7447e+00 | 2.3469e+00 |
| lag_freq(4).Gamma2  | 57 | 1.4000e+00 | 1.4000e+00 | 1.6953e+00 |
| lag_freq(4).xi      | 59 | 2.4054e+00 | 2.2382e+00 | 2.5725e+00 |
| lag_freq(4).b       | 61 | 2.7539e+00 | 1.7360e+00 | 3.0000e+00 |
| lag_freq(4).t_max   | 63 | 6.0005e+02 | 4.4952e+02 | 6.2067e+02 |
| lag_freq(4).t_shift | 64 | 6.6766e+01 | 5.5851e+01 | 7.7710e+01 |


#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit2_0506200301.gif


pdf at


#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit2_0506200301.pdf

** 0506200401 lag_freq(5)

Use these fitting scripts (Do not run conf - already done in
=conf_mass_fit_15data.csv) :

PATH = =sim-fit-0506200401.sl=

PARFILE = =sim_fit_0506200401.par=

#+BEGIN_EXAMPLE

 66  lag_freq(5).norm        0     0         9.295433           0          10
 67  lag_freq(5).log_mass    3     0         6.042802         5.5           8
 68  lag_freq(5).i           4     1               53          53          53
 69  lag_freq(5).a           5     1            0.998       0.998       0.998
 70  lag_freq(5).h1          6     1                2           2           2
 71  lag_freq(5).h2          0     0         10.99996           3          20
 72  lag_freq(5).Gamma1      0     0         2.552774         1.5       3.299
 73  lag_freq(5).Gamma2      0     0         2.163997         1.4         3.2
 74  lag_freq(5).Fe         10     1                1           1           1
 75  lag_freq(5).xi          0     0        0.9517529           0           3
 76  lag_freq(5).p          12     1                0           0           0
 77  lag_freq(5).b           0     0                3           1           3
 78  lag_freq(5).q2         14     1              0.5         0.5         0.5
 79  lag_freq(5).t_max       0     0         540.9933          50         800
 80  lag_freq(5).t_shift     0     0         27.91104           0         120


source("sim-fit-0506200401.sl");

[detached from 55207.pts-17.hm00]

 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 5.339883
   Reduced chi-square = 0.7628405
lag_freq(5)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(5).norm       0     1         9.295433           0          10
  2  lag_freq(5).log_mass   0     1         6.042802         5.5           8
  3  lag_freq(5).i          0     1               53          53          53
  4  lag_freq(5).a          0     1            0.998       0.998       0.998
  5  lag_freq(5).h1         0     1                2           2           2
  6  lag_freq(5).h2         0     1         10.99996           3          20
  7  lag_freq(5).Gamma1     0     1         2.552774         1.5       3.299
  8  lag_freq(5).Gamma2     0     1         2.163997         1.4         3.2
  9  lag_freq(5).Fe         0     1                1           1           1
 10  lag_freq(5).xi         0     1        0.9517529           0           3
 11  lag_freq(5).p          0     1                0           0           0
 12  lag_freq(5).b          0     1                3           1           3
 13  lag_freq(5).q2         0     1              0.5         0.5         0.5
 14  lag_freq(5).t_max      0     1         540.9933          50         800
 15  lag_freq(5).t_shift    0     1         27.91104           0         120

isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  6.6524e-02     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-OBS-0506200401-time-lags-segs.fits



#+END_EXAMPLE

| par                 |        val |         lo |         hi |
| lag_freq(5).h2      | 1.1000e+01 | 1.0612e+01 | 1.1695e+01 |
| lag_freq(5).Gamma1  | 2.5528e+00 | 2.5276e+00 | 2.5740e+00 |
| lag_freq(5).Gamma2  | 2.1640e+00 | 2.1420e+00 | 2.1890e+00 |
| lag_freq(5).xi      | 9.5175e-01 | 0.0000e+00 | 2.6915e+00 |
| lag_freq(5).b       | 3.0000e+00 | 2.9414e+00 | 3.0000e+00 |
| lag_freq(5).t_max   | 5.4099e+02 | 5.0733e+02 | 5.5914e+02 |
| lag_freq(5).t_shift | 2.7911e+01 | 2.7057e+01 | 2.8755e+01 |

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit2_0506200401.gif

pdf at

http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit2_0506200401.pdf

** 0506200501 lag_freq(6)

Use these fitting scripts (Do not run conf - already done in
=conf_mass_fit_15data.csv) :

PATH = =sim-fit-0506200501.sl=

PARFILE = =sim_fit_0506200501.par=

#+BEGIN_EXAMPLE

 82  lag_freq(6).norm        0     0         4.981621           0          10
 83  lag_freq(6).log_mass    3     0         6.042802         5.5           8
 84  lag_freq(6).i           4     1               53          53          53
 85  lag_freq(6).a           5     1            0.998       0.998       0.998
 86  lag_freq(6).h1          6     1                2           2           2
 87  lag_freq(6).h2          0     0          11.9973           3          20
 88  lag_freq(6).Gamma1      0     0         2.303145         1.5       3.299
 89  lag_freq(6).Gamma2      0     0         1.698795         1.4         3.2
 90  lag_freq(6).Fe         10     1                1           1           1
 91  lag_freq(6).xi          0     0        0.7603871           0           3
 92  lag_freq(6).p          12     1                0           0           0
 93  lag_freq(6).b           0     0                3           1           3
 94  lag_freq(6).q2         14     1              0.5         0.5         0.5
 95  lag_freq(6).t_max       0     0         717.3494          50         800
 96  lag_freq(6).t_shift     0     0         25.32125           0         120


source("sim-fit-0506200501.sl");

screen -r 93341.pts-7.hm00

isis> ()=eval_counts;
 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 20.86134
   Reduced chi-square = 2.980191
isis> list_par;
lag_freq(6)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(6).norm       0     1         4.981621           0          10
  2  lag_freq(6).log_mass   0     1         6.042802         5.5           8
  3  lag_freq(6).i          0     1               53          53          53
  4  lag_freq(6).a          0     1            0.998       0.998       0.998
  5  lag_freq(6).h1         0     1                2           2           2
  6  lag_freq(6).h2         0     1          11.9973           3          20
  7  lag_freq(6).Gamma1     0     1         2.303145         1.5       3.299
  8  lag_freq(6).Gamma2     0     1         1.698795         1.4         3.2
  9  lag_freq(6).Fe         0     1                1           1           1
 10  lag_freq(6).xi         0     1        0.7603871           0           3
 11  lag_freq(6).p          0     1                0           0           0
 12  lag_freq(6).b          0     1                3           1           3
 13  lag_freq(6).q2         0     1              0.5         0.5         0.5
 14  lag_freq(6).t_max      0     1         717.3494          50         800
 15  lag_freq(6).t_shift    0     1         25.32125           0         120


can a better fit be found????? Free-pars and run again --->


No --- Best was

isis> ()=eval_counts;
 Parameters[Variable] = 15[8]
            Data bins = 7
           Chi-square = 5.880418


#+END_EXAMPLE

| par                 |        val |         lo |         hi |
| lag_freq(6).norm    | 4.9816e+00 | 0.0000e+00 | 9.9002e+00 |
| lag_freq(6).h2      | 1.1997e+01 | 3.0000e+00 | 1.6758e+01 |
| lag_freq(6).Gamma1  | 2.3031e+00 | 2.1659e+00 | 2.3695e+00 |
| lag_freq(6).Gamma2  | 1.6988e+00 | 1.4000e+00 | 1.8615e+00 |
| lag_freq(6).xi      | 7.6039e-01 | 0.0000e+00 | 2.8150e+00 |
| lag_freq(6).b       | 3.0000e+00 | 2.6793e+00 | 3.0000e+00 |
| lag_freq(6).t_max   | 7.1735e+02 | 6.1781e+02 | 8.0000e+02 |
| lag_freq(6).t_shift | 2.5321e+01 | 2.1084e+01 | 2.7644e+01 |



#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit2_0506200501.gif


pdf at

http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit2_0506200501.pdf

** 0511580101 lag_freq(7)

Use these fitting scripts (Do not run conf - already done in
=conf_mass_fit_15data.csv) :

PATH = =sim-fit-0511580101.sl=

PARFILE = =sim_fit_0511580101.par=

#+BEGIN_EXAMPLE

 98  lag_freq(7).norm        0     0               10           0          10
 99  lag_freq(7).log_mass    3     0         6.042802         5.5           8
100  lag_freq(7).i           4     1               53          53          53
101  lag_freq(7).a           5     1            0.998       0.998       0.998
102  lag_freq(7).h1          6     1                2           2           2
103  lag_freq(7).h2          0     0         11.29721           3          20
104  lag_freq(7).Gamma1      0     0         2.315592         1.5       3.299
105  lag_freq(7).Gamma2      0     0              1.7         1.4         3.2
106  lag_freq(7).Fe         10     1                1           1           1
107  lag_freq(7).xi          0     0        0.9161822           0           3
108  lag_freq(7).p          12     1                0           0           0
109  lag_freq(7).b           0     0                3           1           3
110  lag_freq(7).q2         14     1              0.5         0.5         0.5
111  lag_freq(7).t_max       0     0         643.5238          50         800
112  lag_freq(7).t_shift     0     0         21.92584           0         120


 source("sim-fit-0511580101.sl");

[detached from 55207.pts-17.hm00]

screen -r 55207.pts-17.hm00

 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 1.489986
   Reduced chi-square = 0.2128551
lag_freq(7)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(7).norm       0     1               10           0          10
  2  lag_freq(7).log_mass   0     1         6.042802         5.5           8
  3  lag_freq(7).i          0     1               53          53          53
  4  lag_freq(7).a          0     1            0.998       0.998       0.998
  5  lag_freq(7).h1         0     1                2           2           2
  6  lag_freq(7).h2         0     1         11.29721           3          20
  7  lag_freq(7).Gamma1     0     1         2.315592         1.5       3.299
  8  lag_freq(7).Gamma2     0     1              1.7         1.4         3.2
  9  lag_freq(7).Fe         0     1                1           1           1
 10  lag_freq(7).xi         0     1        0.9161822           0           3
 11  lag_freq(7).p          0     1                0           0           0
 12  lag_freq(7).b          0     1                3           1           3
 13  lag_freq(7).q2         0     1              0.5         0.5         0.5
 14  lag_freq(7).t_max      0     1         643.5238          50         800
 15  lag_freq(7).t_shift    0     1         21.92584           0         120

Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -1.4448e-02     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-OBS-0511580101-time-lags-segs.fits

#+END_EXAMPLE

| par                 |        val |         lo |         hi |
| lag_freq(7).norm    | 1.0000e+01 | 6.7410e+00 | 1.0000e+01 |
| lag_freq(7).h2      | 1.1297e+01 | 1.1164e+01 | 1.1460e+01 |
| lag_freq(7).Gamma1  | 2.3156e+00 | 2.2715e+00 | 2.3719e+00 |
| lag_freq(7).Gamma2  | 1.7000e+00 | 1.6674e+00 | 1.7574e+00 |
| lag_freq(7).xi      | 9.1618e-01 | 0.0000e+00 | 2.6129e+00 |
| lag_freq(7).b       | 3.0000e+00 | 2.8241e+00 | 3.0000e+00 |
| lag_freq(7).t_max   | 6.4352e+02 | 6.2924e+02 | 7.0976e+02 |
| lag_freq(7).t_shift | 2.1926e+01 | 2.0763e+01 | 2.3100e+01 |


#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit2_0511580101.gif

pdf at

http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit2_0511580101.pdf

** 0511580201 lag_freq(8)

Use these fitting scripts (Do not run conf - already done in
=conf_mass_fit_15data.csv) :

PATH = =sim-fit-0511580201.sl=

PARFILE = =sim_fit_0511580201.par=

#+BEGIN_EXAMPLE
source("sim-fit-0511580201.sl");

114  lag_freq(8).norm        0     0               10           0          10
115  lag_freq(8).log_mass    3     0         6.042802         5.5           8
116  lag_freq(8).i           4     1               53          53          53
117  lag_freq(8).a           5     1            0.998       0.998       0.998
118  lag_freq(8).h1          6     1                2           2           2
119  lag_freq(8).h2          0     0         3.760985           3          20
120  lag_freq(8).Gamma1      0     0         1.801877         1.5       3.299
121  lag_freq(8).Gamma2      0     0         1.400001         1.4         3.2
122  lag_freq(8).Fe         10     1                1           1           1
123  lag_freq(8).xi          0     0                3           0           3
124  lag_freq(8).p          12     1                0           0           0
125  lag_freq(8).b           0     0         2.140189           1           3
126  lag_freq(8).q2         14     1              0.5         0.5         0.5
127  lag_freq(8).t_max       0     0          326.797          50         800
128  lag_freq(8).t_shift     0     0         25.77718           0         120

source("sim-fit-0511580201.sl");

[detached from 77607.pts-58.hm00]

 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 1.299636
   Reduced chi-square = 0.1856622
lag_freq(8)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(8).norm       0     1               10           0          10
  2  lag_freq(8).log_mass   0     1         6.042802         5.5           8
  3  lag_freq(8).i          0     1               53          53          53
  4  lag_freq(8).a          0     1            0.998       0.998       0.998
  5  lag_freq(8).h1         0     1                2           2           2
  6  lag_freq(8).h2         0     1         3.760985           3          20
  7  lag_freq(8).Gamma1     0     1         1.801877         1.5       3.299
  8  lag_freq(8).Gamma2     0     1         1.400001         1.4         3.2
  9  lag_freq(8).Fe         0     1                1           1           1
 10  lag_freq(8).xi         0     1                3           0           3
 11  lag_freq(8).p          0     1                0           0           0
 12  lag_freq(8).b          0     1         2.140189           1           3
 13  lag_freq(8).q2         0     1              0.5         0.5         0.5
 14  lag_freq(8).t_max      0     1          326.797          50         800
 15  lag_freq(8).t_shift    0     1         25.77718           0         120
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  1.0693e-02     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-OBS-0511580201-time-lags-segs.fits

#+END_EXAMPLE

| par                 |        val |         lo |         hi |
| lag_freq(8).norm    | 1.0000e+01 | 7.5464e+00 | 1.0000e+01 |
| lag_freq(8).h2      | 3.7610e+00 | 3.0000e+00 | 4.2438e+00 |
| lag_freq(8).Gamma1  | 1.8019e+00 | 1.7891e+00 | 1.8164e+00 |
| lag_freq(8).Gamma2  | 1.4000e+00 | 1.4000e+00 | 1.4180e+00 |
| lag_freq(8).xi      | 3.0000e+00 | 2.6340e+00 | 3.0000e+00 |
| lag_freq(8).b       | 2.1402e+00 | 2.0825e+00 | 2.1978e+00 |
| lag_freq(8).t_max   | 3.2680e+02 | 3.1260e+02 | 3.4112e+02 |
| lag_freq(8).t_shift | 2.5777e+01 | 2.5158e+01 | 2.6397e+01 |

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit2_0511580201.gif


pdf at

http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit2_0511580201.pdf

** 0511580301 lag_freq(9)

Use these fitting scripts (Do not run conf - already done in
=conf_mass_fit_15data.csv) :

PATH = =sim-fit-0511580301.sl=

PARFILE = =sim_fit_0511580301.par=

#+BEGIN_EXAMPLE


130  lag_freq(9).norm        0     0          9.59703           0          10
131  lag_freq(9).log_mass    3     0         6.042802         5.5           8
132  lag_freq(9).i           4     1               53          53          53
133  lag_freq(9).a           5     1            0.998       0.998       0.998
134  lag_freq(9).h1          6     1                2           2           2
135  lag_freq(9).h2          0     0         3.000001           3          20
136  lag_freq(9).Gamma1      0     0         1.904305         1.5       3.299
137  lag_freq(9).Gamma2      0     0         1.499481         1.4         3.2
138  lag_freq(9).Fe         10     1                1           1           1
139  lag_freq(9).xi          0     0         2.999478           0           3
140  lag_freq(9).p          12     1                0           0           0
141  lag_freq(9).b           0     0                3           1           3
142  lag_freq(9).q2         14     1              0.5         0.5         0.5
143  lag_freq(9).t_max       0     0         501.1032          50         800
144  lag_freq(9).t_shift     0     0         21.92024           0         120


source("sim-fit-0511580301.sl");

screen -r 93341.pts-7.hm00

 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 6.028467
   Reduced chi-square = 0.8612095
isis> list_par;
lag_freq(9)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(9).norm       0     1          9.59703           0          10
  2  lag_freq(9).log_mass   0     1         6.042802         5.5           8
  3  lag_freq(9).i          0     1               53          53          53
  4  lag_freq(9).a          0     1            0.998       0.998       0.998
  5  lag_freq(9).h1         0     1                2           2           2
  6  lag_freq(9).h2         0     1         3.000001           3          20
  7  lag_freq(9).Gamma1     0     1         1.904305         1.5       3.299
  8  lag_freq(9).Gamma2     0     1         1.499481         1.4         3.2
  9  lag_freq(9).Fe         0     1                1           1           1
 10  lag_freq(9).xi         0     1         2.999478           0           3
 11  lag_freq(9).p          0     1                0           0           0
 12  lag_freq(9).b          0     1                3           1           3
 13  lag_freq(9).q2         0     1              0.5         0.5         0.5
 14  lag_freq(9).t_max      0     1         501.1032          50         800
 15  lag_freq(9).t_shift    0     1         21.92024           0         120
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  4.3848e-02     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-OBS-0511580301-time-lags-segs.fits

#+END_EXAMPLE

| par                 |        val |         lo |         hi |
| lag_freq(9).norm    | 9.5970e+00 | 7.2510e+00 | 1.0000e+01 |
| lag_freq(9).h2      | 3.0000e+00 | 3.0000e+00 | 3.9145e+00 |
| lag_freq(9).Gamma1  | 1.9043e+00 | 1.8896e+00 | 1.9238e+00 |
| lag_freq(9).Gamma2  | 1.4995e+00 | 1.4702e+00 | 1.5202e+00 |
| lag_freq(9).xi      | 2.9995e+00 | 2.7552e+00 | 3.0000e+00 |
| lag_freq(9).b       | 3.0000e+00 | 2.8489e+00 | 3.0000e+00 |
| lag_freq(9).t_max   | 5.0110e+02 | 4.7343e+02 | 5.6425e+02 |
| lag_freq(9).t_shift | 2.1920e+01 | 2.1406e+01 | 2.2520e+01 |

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit2_0511580301.gif


pdf at


http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit2_0511580301.pdf

** 0511580401 lag_freq(10)

Use these fitting scripts (Do not run conf - already done in
=conf_mass_fit_15data.csv) :

PATH = =sim-fit-0511580401.sl=

PARFILE = =sim_fit_0511580401.par=

#+BEGIN_EXAMPLE

146  lag_freq(10).norm       0     0         7.916341           0          10
147  lag_freq(10).log_mass   3     0         6.042802         5.5           8
148  lag_freq(10).i          4     1               53          53          53
149  lag_freq(10).a          5     1            0.998       0.998       0.998
150  lag_freq(10).h1         6     1                2           2           2
151  lag_freq(10).h2         0     0         11.44562           3          20
152  lag_freq(10).Gamma1     0     0         2.484206         1.5       3.299
153  lag_freq(10).Gamma2     0     0         1.711119         1.4         3.2
154  lag_freq(10).Fe        10     1                1           1           1
155  lag_freq(10).xi         0     0           2.3571           0           3
156  lag_freq(10).p         12     1                0           0           0
157  lag_freq(10).b          0     0         2.999978           1           3
158  lag_freq(10).q2        14     1              0.5         0.5         0.5
159  lag_freq(10).t_max      0     0         306.3338          50         800
160  lag_freq(10).t_shift    0     0         16.73007           0         120


source("sim-fit-0511580401.sl");


screen -r 54291.pts-58.hm00

Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 6.679465
   Reduced chi-square = 0.9542093
lag_freq(10)
 idx  param              tie-to  freeze         value         min         max
  1  lag_freq(10).norm       0     1         7.916341           0          10
  2  lag_freq(10).log_mass   0     1         6.042802         5.5           8
  3  lag_freq(10).i          0     1               53          53          53
  4  lag_freq(10).a          0     1            0.998       0.998       0.998
  5  lag_freq(10).h1         0     1                2           2           2
  6  lag_freq(10).h2         0     1         11.44562           3          20
  7  lag_freq(10).Gamma1     0     1         2.484206         1.5       3.299
  8  lag_freq(10).Gamma2     0     1         1.711119         1.4         3.2
  9  lag_freq(10).Fe         0     1                1           1           1
 10  lag_freq(10).xi         0     1           2.3571           0           3
 11  lag_freq(10).p          0     1                0           0           0
 12  lag_freq(10).b          0     1         2.999978           1           3
 13  lag_freq(10).q2         0     1              0.5         0.5         0.5
 14  lag_freq(10).t_max      0     1         306.3338          50         800
 15  lag_freq(10).t_shift    0     1         16.73007           0         120


Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  4.7228e-03     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-OBS-0511580401-time-lags-segs.fits

#+END_EXAMPLE

| par                  |        val |         lo |         hi |
| lag_freq(10).norm    | 7.9163e+00 | 6.0893e+00 | 1.0000e+01 |
| lag_freq(10).h2      | 1.1446e+01 | 1.0825e+01 | 1.2524e+01 |
| lag_freq(10).Gamma1  | 2.4842e+00 | 2.4384e+00 | 2.5089e+00 |
| lag_freq(10).Gamma2  | 1.7111e+00 | 1.6783e+00 | 1.7708e+00 |
| lag_freq(10).xi      | 2.3571e+00 | 0.0000e+00 | 2.5605e+00 |
| lag_freq(10).b       | 3.0000e+00 | 2.8543e+00 | 3.0000e+00 |
| lag_freq(10).t_max   | 3.0633e+02 | 2.8999e+02 | 3.3327e+02 |
| lag_freq(10).t_shift | 1.6730e+01 | 1.6124e+01 | 1.7269e+01 |


#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit2_0511580401.gif

pdf

http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit2_0511580401.pdf

** 0554710801 lag_freq(11)

Use these fitting scripts (Do not run conf - already done in
=conf_mass_fit_15data.csv) :

PATH = =sim-fit-0554710801.sl=

PARFILE = =sim_fit_0554710801.par=

#+BEGIN_EXAMPLE

162  lag_freq(11).norm       0     0         5.157551           0          10
163  lag_freq(11).log_mass   3     0         6.042802         5.5           8
164  lag_freq(11).i          4     1               53          53          53
165  lag_freq(11).a          5     1            0.998       0.998       0.998
166  lag_freq(11).h1         6     1                2           2           2
167  lag_freq(11).h2         0     0          7.22281           3          20
168  lag_freq(11).Gamma1     0     0         2.602301         1.5       3.299
169  lag_freq(11).Gamma2     0     0         1.727017         1.4         3.2
170  lag_freq(11).Fe        10     1                1           1           1
171  lag_freq(11).xi         0     0         2.251726           0           3
172  lag_freq(11).p         12     1                0           0           0
173  lag_freq(11).b          0     0          2.97183           1           3
174  lag_freq(11).q2        14     1              0.5         0.5         0.5
175  lag_freq(11).t_max      0     0         193.0626          50         800
176  lag_freq(11).t_shift    0     0         14.17592           0         120

source("sim-fit-0554710801.sl");

screen -r 54291.pts-58.hm00

   Reduced chi-square = 0.7765235
 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 5.435664
   Reduced chi-square = 0.7765235
lag_freq(11)
 idx  param              tie-to  freeze         value         min         max
  1  lag_freq(11).norm       0     1         5.157551           0          10
  2  lag_freq(11).log_mass   0     1         6.042802         5.5           8
  3  lag_freq(11).i          0     1               53          53          53
  4  lag_freq(11).a          0     1            0.998       0.998       0.998
  5  lag_freq(11).h1         0     1                2           2           2
  6  lag_freq(11).h2         0     1          7.22281           3          20
  7  lag_freq(11).Gamma1     0     1         2.602301         1.5       3.299
  8  lag_freq(11).Gamma2     0     1         1.727017         1.4         3.2
  9  lag_freq(11).Fe         0     1                1           1           1
 10  lag_freq(11).xi         0     1         2.251726           0           3
 11  lag_freq(11).p          0     1                0           0           0
 12  lag_freq(11).b          0     1          2.97183           1           3
 13  lag_freq(11).q2         0     1              0.5         0.5         0.5
 14  lag_freq(11).t_max      0     1         193.0626          50         800
 15  lag_freq(11).t_shift    0     1         14.17592           0         120

isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  7.0846e-02     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-OBS-0554710801-time-lags-segs.fits
#+END_EXAMPLE

| par                  |        val |         lo |         hi |
| lag_freq(11).norm    | 5.1576e+00 | 2.6927e+00 | 8.3214e+00 |
| lag_freq(11).h2      | 7.2228e+00 | 5.9544e+00 | 8.5071e+00 |
| lag_freq(11).Gamma1  | 2.6023e+00 | 2.5196e+00 | 2.6657e+00 |
| lag_freq(11).Gamma2  | 1.7270e+00 | 1.6286e+00 | 1.8577e+00 |
| lag_freq(11).xi      | 2.2517e+00 | 0.0000e+00 | 2.5981e+00 |
| lag_freq(11).b       | 2.9718e+00 | 2.4624e+00 | 3.0000e+00 |
| lag_freq(11).t_max   | 1.9306e+02 | 1.6987e+02 | 2.1601e+02 |
| lag_freq(11).t_shift | 1.4176e+01 | 1.3052e+01 | 1.5101e+01 |


#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit2_0554710801.gif

pdf at


http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit2_0554710801.pdf

** 0653510301 lag_freq(12)

Use these fitting scripts (Do not run conf - already done in
=conf_mass_fit_15data.csv) :

PATH = =sim-fit-0653510301.sl=

PARFILE = =sim_fit_0653510301.par=

#+BEGIN_EXAMPLE

178  lag_freq(12).norm       0     0       0.08605624           0          10
179  lag_freq(12).log_mass   3     0         6.042802         5.5           8
180  lag_freq(12).i          4     1               53          53          53
181  lag_freq(12).a          5     1            0.998       0.998       0.998
182  lag_freq(12).h1         6     1                2           2           2
183  lag_freq(12).h2         0     0         19.99993           3          20
184  lag_freq(12).Gamma1     0     0         2.051151         1.5       3.299
185  lag_freq(12).Gamma2     0     0         1.563508         1.4         3.2
186  lag_freq(12).Fe        10     1                1           1           1
187  lag_freq(12).xi         0     0       0.03518322           0           3
188  lag_freq(12).p         12     1                0           0           0
189  lag_freq(12).b          0     0          2.99956           1           3
190  lag_freq(12).q2        14     1              0.5         0.5         0.5
191  lag_freq(12).t_max      0     0         193.0626          50         800
192  lag_freq(12).t_shift    0     0         81.26388           0         120

source("sim-fit-0653510301.sl");

screen -r 12823.pts-58.hm00

 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 4.964808
   Reduced chi-square = 0.7092583
lag_freq(12)
 idx  param              tie-to  freeze         value         min         max
  1  lag_freq(12).norm       0     1       0.08605624           0          10
  2  lag_freq(12).log_mass   0     1         6.042802         5.5           8
  3  lag_freq(12).i          0     1               53          53          53
  4  lag_freq(12).a          0     1            0.998       0.998       0.998
  5  lag_freq(12).h1         0     1                2           2           2
  6  lag_freq(12).h2         0     1         19.99993           3          20
  7  lag_freq(12).Gamma1     0     1         2.051151         1.5       3.299
  8  lag_freq(12).Gamma2     0     1         1.563508         1.4         3.2
  9  lag_freq(12).Fe         0     1                1           1           1
 10  lag_freq(12).xi         0     1       0.03518322           0           3
 11  lag_freq(12).p          0     1                0           0           0
 12  lag_freq(12).b          0     1          2.99956           1           3
 13  lag_freq(12).q2         0     1              0.5         0.5         0.5
 14  lag_freq(12).t_max      0     1         193.0626          50         800
 15  lag_freq(12).t_shift    0     1         81.26388           0         120
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -2.3266e-02     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-OBS-0653510301-time-lags-segs.fits


#+END_EXAMPLE

| par                  |        val |         lo |         hi |
| lag_freq(12).norm    | 8.6056e-02 | 1.5929e-02 | 2.4670e-01 |
| lag_freq(12).h2      | 2.0000e+01 | 1.4220e+01 | 2.0000e+01 |
| lag_freq(12).Gamma1  | 2.0512e+00 | 1.7211e+00 | 2.7662e+00 |
| lag_freq(12).Gamma2  | 1.5635e+00 | 1.4188e+00 | 2.8976e+00 |
| lag_freq(12).xi      | 3.5183e-02 | 0.0000e+00 | 3.0000e+00 |
| lag_freq(12).b       | 2.9996e+00 | 1.0000e+00 | 3.0000e+00 |
| lag_freq(12).t_max   | 1.9306e+02 | 6.9328e+01 | 4.2660e+02 |
| lag_freq(12).t_shift | 8.1264e+01 | 6.6168e+01 | 1.1396e+02 |



#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit2_0653510301.gif


pdf at


http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit2_0653510301.pdf

** 0653510401 lag_freq(13)

Use these fitting scripts (Do not run conf - already done in
=conf_mass_fit_15data.csv) :

PATH = =sim-fit-0653510401.sl=

PARFILE = =sim_fit_0653510401.par=

#+BEGIN_EXAMPLE

194  lag_freq(13).norm       0     0        0.3896797           0          10
195  lag_freq(13).log_mass   3     0         6.042802         5.5           8
196  lag_freq(13).i          4     1               53          53          53
197  lag_freq(13).a          5     1            0.998       0.998       0.998
198  lag_freq(13).h1         6     1                2           2           2
199  lag_freq(13).h2         0     0         19.99993           3          20
200  lag_freq(13).Gamma1     0     0          3.29895         1.5       3.299
201  lag_freq(13).Gamma2     0     0         1.510915         1.4         3.2
202  lag_freq(13).Fe        10     1                1           1           1
203  lag_freq(13).xi         0     0         2.249853           0           3
204  lag_freq(13).p         12     1                0           0           0
205  lag_freq(13).b          0     0         1.000046           1           3
206  lag_freq(13).q2        14     1              0.5         0.5         0.5
207  lag_freq(13).t_max      0     0         697.6993          50         800
208  lag_freq(13).t_shift    0     0         103.0311           0         120


 source("sim-fit-0653510401.sl");

screen -r 54291.pts-58.hm00
 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 14.48823
   Reduced chi-square = 2.069747
lag_freq(13)
 idx  param              tie-to  freeze         value         min         max
  1  lag_freq(13).norm       0     1        0.3896797           0          10
  2  lag_freq(13).log_mass   0     1         6.042802         5.5           8
  3  lag_freq(13).i          0     1               53          53          53
  4  lag_freq(13).a          0     1            0.998       0.998       0.998
  5  lag_freq(13).h1         0     1                2           2           2
  6  lag_freq(13).h2         0     1         19.99993           3          20
  7  lag_freq(13).Gamma1     0     1          3.29895         1.5       3.299
  8  lag_freq(13).Gamma2     0     1         1.510915         1.4         3.2
  9  lag_freq(13).Fe         0     1                1           1           1
 10  lag_freq(13).xi         0     1         2.249853           0           3
 11  lag_freq(13).p          0     1                0           0           0
 12  lag_freq(13).b          0     1         1.000046           1           3
 13  lag_freq(13).q2         0     1              0.5         0.5         0.5
 14  lag_freq(13).t_max      0     1         697.6993          50         800
 15  lag_freq(13).t_shift    0     1         103.0311           0         120

isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -2.6085e-02     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-OBS-0653510401-time-lags-segs.fits
isis>


#+END_EXAMPLE

| par                  |        val |         lo |         hi |
| lag_freq(13).norm    | 3.8968e-01 | 3.0404e-01 | 5.8070e-01 |
| lag_freq(13).h2      | 2.0000e+01 | 1.9780e+01 | 2.0000e+01 |
| lag_freq(13).Gamma1  | 3.2989e+00 | 2.3683e+00 | 3.2990e+00 |
| lag_freq(13).Gamma2  | 1.5109e+00 | 1.4780e+00 | 2.6226e+00 |
| lag_freq(13).xi      | 2.2499e+00 | 0.0000e+00 | 3.0000e+00 |
| lag_freq(13).b       | 1.0000e+00 | 1.0000e+00 | 1.3179e+00 |
| lag_freq(13).t_max   | 6.9770e+02 | 3.9951e+02 | 7.1096e+02 |
| lag_freq(13).t_shift | 1.0303e+02 | 6.5564e+01 | 1.2000e+02 |



#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit2_0653510401.gif

pdf

http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit2_0653510401.pdf

** 0653510501 lag_freq(14)

Use these fitting scripts (Do not run conf - already done in
=conf_mass_fit_15data.csv) :

PATH = =sim-fit-0653510501.sl=

PARFILE = =sim_fit_0653510501.par=

#+BEGIN_EXAMPLE

210  lag_freq(14).norm       0     0        0.1628152           0          10
211  lag_freq(14).log_mass   3     0         6.042802         5.5           8
212  lag_freq(14).i          4     1               53          53          53
213  lag_freq(14).a          5     1            0.998       0.998       0.998
214  lag_freq(14).h1         6     1                2           2           2
215  lag_freq(14).h2         0     0         19.99993           3          20
216  lag_freq(14).Gamma1     0     0         3.298872         1.5       3.299
217  lag_freq(14).Gamma2     0     0         1.578084         1.4         3.2
218  lag_freq(14).Fe        10     1                1           1           1
219  lag_freq(14).xi         0     0       0.07030791           0           3
220  lag_freq(14).p         12     1                0           0           0
221  lag_freq(14).b          0     0         1.249945           1           3
222  lag_freq(14).q2        14     1              0.5         0.5         0.5
223  lag_freq(14).t_max      0     0         516.8848          50         800
224  lag_freq(14).t_shift    0     0         73.20621           0         120

source("sim-fit-0653510501.sl");

screen -r 12823.pts-58.hm00

 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 17.21333
   Reduced chi-square = 2.459047
lag_freq(14)
 idx  param              tie-to  freeze         value         min         max
  1  lag_freq(14).norm       0     1        0.1628152           0          10
  2  lag_freq(14).log_mass   0     1         6.042802         5.5           8
  3  lag_freq(14).i          0     1               53          53          53
  4  lag_freq(14).a          0     1            0.998       0.998       0.998
  5  lag_freq(14).h1         0     1                2           2           2
  6  lag_freq(14).h2         0     1               20           3          20
  7  lag_freq(14).Gamma1     0     1         3.298872         1.5       3.299
  8  lag_freq(14).Gamma2     0     1         1.578084         1.4         3.2
  9  lag_freq(14).Fe         0     1                1           1           1
 10  lag_freq(14).xi         0     1        0.0703079           0           3
 11  lag_freq(14).p          0     1                0           0           0
 12  lag_freq(14).b          0     1         1.249945           1           3
 13  lag_freq(14).q2         0     1              0.5         0.5         0.5
 14  lag_freq(14).t_max      0     1         516.8848          50         800
 15  lag_freq(14).t_shift    0     1         73.20621           0         120

Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -1.3605e-02     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-OBS-0653510501-time-lags-segs.fits


#+END_EXAMPLE

| par                  |        val |         lo |         hi |
| lag_freq(14).norm    | 1.6282e-01 | 5.6427e-02 | 3.3534e-01 |
| lag_freq(14).h2      | 2.0000e+01 | 1.7358e+01 | 2.0000e+01 |
| lag_freq(14).Gamma1  | 3.2989e+00 | 1.7456e+00 | 3.2990e+00 |
| lag_freq(14).Gamma2  | 1.5781e+00 | 1.4345e+00 | 3.2000e+00 |
| lag_freq(14).xi      | 7.0308e-02 | 0.0000e+00 | 3.0000e+00 |
| lag_freq(14).b       | 1.2499e+00 | 1.0000e+00 | 2.8246e+00 |
| lag_freq(14).t_max   | 5.1688e+02 | 1.7557e+02 | 7.3012e+02 |
| lag_freq(14).t_shift | 7.3206e+01 | 0.0000e+00 | 1.2000e+02 |



#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit2_0653510501.gif

pdf

http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit2_0653510501.pdf

** 0653510601 lag_freq(15)

Use these fitting scripts (Do not run conf - already done in
=conf_mass_fit_15data.csv) :

PATH = =sim-fit-0653510601.sl=

PARFILE = =sim_fit_0653510601.par=

#+BEGIN_EXAMPLE

226  lag_freq(15).norm       0     0        0.3561122           0          10
227  lag_freq(15).log_mass   3     0         6.042802         5.5           8
228  lag_freq(15).i          4     1               53          53          53
229  lag_freq(15).a          5     1            0.998       0.998       0.998
230  lag_freq(15).h1         6     1                2           2           2
231  lag_freq(15).h2         0     0         19.99993           3          20
232  lag_freq(15).Gamma1     0     0         3.298983         1.5       3.299
233  lag_freq(15).Gamma2     0     0         1.487196         1.4         3.2
234  lag_freq(15).Fe        10     1                1           1           1
235  lag_freq(15).xi         0     0        0.5624994           0           3
236  lag_freq(15).p         12     1                0           0           0
237  lag_freq(15).b          0     0          2.49989           1           3
238  lag_freq(15).q2        14     1              0.5         0.5         0.5
239  lag_freq(15).t_max      0     0         505.4393          50         800
240  lag_freq(15).t_shift    0     0         94.09409           0         120


source("sim-fit-0653510601.sl");

 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 18.3255
   Reduced chi-square = 2.617928
isis> list_par;
lag_freq(15)
 idx  param              tie-to  freeze         value         min         max
  1  lag_freq(15).norm       0     1        0.3561122           0          10
  2  lag_freq(15).log_mass   0     1         6.042802         5.5           8
  3  lag_freq(15).i          0     1               53          53          53
  4  lag_freq(15).a          0     1            0.998       0.998       0.998
  5  lag_freq(15).h1         0     1                2           2           2
  6  lag_freq(15).h2         0     1         19.99993           3          20
  7  lag_freq(15).Gamma1     0     1         3.298983         1.5       3.299
  8  lag_freq(15).Gamma2     0     1         1.487196         1.4         3.2
  9  lag_freq(15).Fe         0     1                1           1           1
 10  lag_freq(15).xi         0     1        0.5624994           0           3
 11  lag_freq(15).p          0     1                0           0           0
 12  lag_freq(15).b          0     1          2.49989           1           3
 13  lag_freq(15).q2         0     1              0.5         0.5         0.5
 14  lag_freq(15).t_max      0     1         505.4393          50         800
 15  lag_freq(15).t_shift    0     1         94.09409           0         120
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  5.8671e-02     0.001
file:  /data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-OBS-0653510601-time-lags-segs.fits

#+END_EXAMPLE

| par                  |        val |         lo |         hi |
| lag_freq(15).norm    | 3.5611e-01 | 2.1573e-01 | 4.6533e-01 |
| lag_freq(15).h2      | 2.0000e+01 | 1.9606e+01 | 2.0000e+01 |
| lag_freq(15).Gamma1  | 3.2990e+00 | 2.5672e+00 | 3.2990e+00 |
| lag_freq(15).Gamma2  | 1.4872e+00 | 1.4528e+00 | 2.1607e+00 |
| lag_freq(15).xi      | 5.6250e-01 | 0.0000e+00 | 2.3699e+00 |
| lag_freq(15).b       | 2.4999e+00 | 1.5242e+00 | 3.0000e+00 |
| lag_freq(15).t_max   | 5.0544e+02 | 3.6240e+02 | 7.0507e+02 |
| lag_freq(15).t_shift | 9.4094e+01 | 8.6859e+01 | 1.0393e+02 |



#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit2_0653510601.gif

pdf

http://www.star.bris.ac.uk/steff/ecm/1H0707-495_sim_fit2_0653510601.pdf

** *Resultant simultaneous fits (5.5 - 8.0 log M) at a glance*

PATH =
=/home/steff075/phd_ecm/results-spectral/1H0707_flux_lag_relxill_indobs2.ods=

| 1H0707_obs |  Chi | 1H_h2 |    + |    - | 1H_g1 |    + |    - | 1H_g2 |    + |    - | 1H_xi |    + |    - | 1H_b |    + |    - | 1H_tmax |      + |      - | 1H_tshift |     + |     - |
|  110890201 | 0.26 | 11.10 | 2.02 | 0.59 |  2.16 | 0.06 | 0.05 |  1.67 | 0.04 | 0.03 |  0.05 | 2.68 | 0.05 | 2.18 | 0.14 | 0.14 |  450.00 |  43.95 |  73.53 |     30.53 |  0.99 |  3.71 |
|  148010301 | 0.66 |  7.38 | 0.30 | 0.27 |  2.60 | 0.25 | 0.45 |  1.46 | 0.87 | 0.06 |  0.38 | 0.30 | 0.27 | 1.00 | 0.62 | 0.00 |  450.00 | 170.87 |  81.06 |    106.09 |  1.88 |  1.72 |
|  506200201 | 0.34 | 11.00 | 1.46 | 0.35 |  2.27 | 0.03 | 0.00 |  1.70 | 0.05 | 0.03 |  2.00 | 0.33 | 2.00 | 3.00 | 0.00 | 0.14 |  488.13 |  30.99 |  33.09 |     22.13 |  0.77 |  0.78 |
|  506200301 | 0.49 |  3.00 | 3.48 | 0.00 |  2.00 | 0.35 | 0.04 |  1.40 | 0.03 | 0.00 |  2.41 | 0.17 | 0.17 | 2.75 | 0.25 | 1.02 |  600.05 |  20.62 | 150.53 |     66.77 | 10.94 | 10.92 |
|  506200401 | 0.76 | 11.00 | 0.70 | 0.39 |  2.55 | 0.02 | 0.03 |  2.16 | 0.02 | 0.02 |  0.95 | 1.74 | 0.95 | 3.00 | 0.00 | 0.06 |  540.99 |  18.15 |  33.66 |     27.91 |  0.84 |  0.85 |
|  506200501 | 2.98 | 12.00 | 4.76 | 9.00 |  2.30 | 0.07 | 0.14 |  1.70 | 0.16 | 0.30 |  0.76 | 2.05 | 0.76 | 3.00 | 0.00 | 0.32 |  717.35 |  82.65 |  99.54 |     25.32 |  2.32 |  4.24 |
|  511580101 | 0.21 | 11.30 | 0.16 | 0.13 |  2.32 | 0.06 | 0.04 |  1.70 | 0.06 | 0.03 |  0.92 | 1.70 | 0.92 | 3.00 | 0.00 | 0.18 |  643.52 |  66.24 |  14.28 |     21.93 |  1.17 |  1.16 |
|  511580201 | 0.19 |  3.76 | 0.48 | 0.76 |  1.80 | 0.01 | 0.01 |  1.40 | 0.02 | 0.00 |  3.00 | 0.00 | 0.37 | 2.14 | 0.06 | 0.06 |  326.80 |  14.32 |  14.20 |     25.78 |  0.62 |  0.62 |
|  511580301 | 0.86 |  3.00 | 0.91 | 0.00 |  1.90 | 0.02 | 0.01 |  1.50 | 0.02 | 0.03 |  3.00 | 0.00 | 0.24 | 3.00 | 0.00 | 0.15 |  501.10 |  63.15 |  17.67 |     21.92 |  0.60 |  0.51 |
|  511580401 | 0.95 | 11.45 | 1.08 | 0.62 |  2.48 | 0.02 | 0.05 |  1.71 | 0.06 | 0.03 |  2.36 | 0.20 | 2.36 | 3.00 | 0.00 | 0.15 |  306.33 |  26.94 |  16.34 |     16.73 |  0.54 |  0.61 |
|  554710801 | 0.78 |  7.22 | 1.28 | 1.27 |  2.60 | 0.06 | 0.08 |  1.73 | 0.13 | 0.10 |  2.25 | 0.35 | 2.25 | 2.97 | 0.03 | 0.51 |  193.06 |  22.95 |  23.19 |     14.18 |  0.93 |  1.12 |
|  653510301 | 0.71 | 20.00 | 0.00 | 5.87 |  2.05 | 0.72 | 0.33 |  1.56 | 1.33 | 0.14 |  0.04 | 2.96 | 0.04 | 3.00 | 0.00 | 2.00 |  193.06 | 233.54 | 123.73 |     81.26 | 32.70 | 15.10 |
|  653510401 | 2.07 | 20.00 | 0.00 | 0.22 |  3.30 | 0.00 | 0.93 |  1.51 | 1.11 | 0.03 |  2.25 | 0.75 | 2.25 | 1.00 | 0.32 | 0.00 |  697.70 |  13.26 | 289.19 |    103.03 | 16.97 | 37.43 |
|  653510501 | 2.46 | 20.00 | 0.00 | 2.64 |  3.30 | 0.00 | 1.55 |  1.58 | 1.62 | 0.14 |  0.07 | 2.93 | 0.07 | 1.25 | 1.57 | 0.25 |  516.88 | 213.24 | 341.43 |     73.21 | 46.79 | 73.21 |
|  653510601 | 2.62 | 20.00 | 0.00 | 0.39 |  3.30 | 0.00 | 0.73 |  1.49 | 0.67 | 0.03 |  0.56 | 1.81 | 0.56 | 2.50 | 0.50 | 0.98 |  505.44 | 199.63 | 143.04 |     94.09 |  9.84 |  7.24 |


** Quick ECM 5.5 - 8 logM overview

VEUSZ =
=/home/steff075/phd_ecm/results-spectral/1H0707_L2-10_V_ECM_indobs.vsz=


WAIT !! Plot both IRAS and 1H0707 together....


VEUSZ =
=/home/steff075/phd_ecm/results-spectral/1H0707_AND_IRAS_L2-10_V_ECM_indobs2.vsz=

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H_AND_IRAS_L2-10_V_ECM_indobs2.png

pdf at:

http://www.star.bris.ac.uk/steff/ecm/1H_AND_IRAS_L2-10_V_ECM_indobs2.pdf

* 1H0707-495 Simultaneous fits (5.5-8.0) correlations
** Explore 1H0707 ECM simultaneous individual fits Correlations

PATH =
=/home/steff075/phd_ecm/results-spectral/spearman_1H0707_ECM.py=

Null hypothesis - There is no associations between the two variables
(e.g. lag and h2)

If the p value is > 0.05 then a correlation does not exist










Correlations > 0.40

#+BEGIN_EXAMPLE

Lag - Cvr SpearmanrResult(correlation=0.5652960744757709, pvalue=0.028087859798934123)
Edd_frac - Ref_F SpearmanrResult(correlation=0.9464285714285712, pvalue=9.447938510352392e-08)
Edd_frac - Plaw_F SpearmanrResult(correlation=0.9464285714285712, pvalue=9.447938510352392e-08)
Edd_frac - Gamma_Plaw SpearmanrResult(correlation=0.5111708922299105, pvalue=0.05148146272291)

L2_10 - h2_ecm SpearmanrResult(correlation=-0.05234964068724273, pvalue=0.8530050523786419)
L2_10 - g1_ecm SpearmanrResult(correlation=-0.08430578039176558, pvalue=0.7651535837961108)
L2_10 - g2_ecm SpearmanrResult(correlation=-0.17937400083354377, pvalue=0.5223907543669071)
L2_10 - xi_ecm SpearmanrResult(correlation=0.16100204652790942, pvalue=0.5664936651664358)
L2_10 - b_ecm SpearmanrResult(correlation=0.0037683565673120507, pvalue=0.9893657030602976)
L2_10 - tmax_ecm SpearmanrResult(correlation=0.3184262697996431, pvalue=0.24739749375293127)
L2_10 - tshift_ecm SpearmanrResult(correlation=0.09285714285714285, pvalue=0.742045009907367)
L2_10 - Ref_F, SpearmanrResult(correlation=0.9464285714285712, pvalue=9.447938510352392e-08)
L2_10 - Plaw_F, SpearmanrResult(correlation=0.9464285714285712, pvalue=9.447938510352392e-08)
L2_10 - Gamma_Plaw, SpearmanrResult(correlation=0.5111708922299105, pvalue=0.05148146272291397)

L2_10 - Cvr, SpearmanrResult(correlation=-0.35957123724566437, pvalue=0.18805683979330176)
L2_10 - nH, SpearmanrResult(correlation=-0.03214285714285714, pvalue=0.9094621170945906)
L2_10 - xi, SpearmanrResult(correlation=0.010723864871956167, pvalue=0.9697428601602291)
L2_10 - Fe, SpearmanrResult(correlation=-0.325427966445015, pvalue=0.23657236139486468)
L2_10 - inc, SpearmanrResult(correlation=-0.01621687432852006, pvalue=0.954256869509938)

h2_ecm - g1_ecm SpearmanrResult(correlation=0.5729943132937783, pvalue=0.025564468123757317)
h2_ecm - Lag SpearmanrResult(correlation=0.31229268409975836, pvalue=0.25712656338672923)
g1_ecm - xi SpearmanrResult(correlation=-0.5296263944644564, pvalue=0.04230828094043704)
g2_ecm - b_ecm SpearmanrResult(correlation=0.5715792560854008, pvalue=0.02601487860246739)
g2_ecm - tshift_ecm SpearmanrResult(correlation=-0.5757905426756755, pvalue=0.024691855030886896)
xi_ecm - h2_ecm, SpearmanrResult(correlation=-0.6311288721788543, pvalue=0.011631543649550748)
xi_ecm - tshift_ecm, SpearmanrResult(correlation=-0.5098398140050466, pvalue=0.052195233724087346)
b_ecm - xi SpearmanrResult(correlation=0.53275625290346, pvalue=0.040881892734421166)
tmax_ecm - Fe SpearmanrResult(correlation=0.44539483037305727, pvalue=0.0961550882344713)
tmax_ecm - RF SpearmanrResult(correlation=-0.4337880162138561, pvalue=0.10621077351772729)
tshift_ecm - h2_ecm, SpearmanrResult(correlation=0.4079661653557537, pvalue=0.1311570937067081)
tshift_ecm- b_ecm, SpearmanrResult(correlation=-0.6575782209959529, pvalue=0.007715572441600899)

#+END_EXAMPLE


** H2 - Lag


PATH = =/home/steff075/phd_ecm/results-spectral/plot_1H_ECM_h2_lag.py=

Importing =1H0707_flux_lag_relxill_indobs2.csv=

#+BEGIN_EXAMPLE
python plot_1H_ECM_h2_lag.py

mean_h2: 11.477
sigma_h2: 5.942
mean_Lag: 93.507
sigma_Lag: 93.372
h2_ecm1 - Lag SpearmanrResult(correlation=0.3044414081368358, pvalue=0.26991556426957436)
m (slope) =  0.02857808552608316
b (intercept) =  8.805091816074382

#+END_EXAMPLE

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H_ECM_h2_lag.png

pdf

http://www.star.bris.ac.uk/steff/ecm/1H_ECM_h2_lag.pdf

** H2 - g1


PATH = =/home/steff075/phd_ecm/results-spectral/plot_1H_ECM_h2_g1.py=

Importing =1H0707_flux_lag_relxill_indobs2.csv=

#+BEGIN_EXAMPLE
python plot_1H_ECM_h2_g1.py

mean_h2: 11.481
sigma_h2: 5.942
mean_g1: 2.462
sigma_g1: 0.481

h2_ecm1 - g1_ecm1 SpearmanrResult(correlation=0.5729943132937783, pvalue=0.025564468123757317)

m (slope) =  8.847955343123678
b (intercept) =  -10.30299938810381

#+END_EXAMPLE

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H_ECM_h2_g1.png

pdf

http://www.star.bris.ac.uk/steff/ecm/1H_ECM_h2_g1.pdf

** H2 - xi


PATH = =/home/steff075/phd_ecm/results-spectral/plot_1H_ECM_h2_xi.py=

Importing =1H0707_flux_lag_relxill_indobs2.csv=

#+BEGIN_EXAMPLE
python plot_1H_ECM_h2_xi.py


mean_h2: 11.481
sigma_h2: 5.942
mean_xi: 1.400
sigma_xi: 1.061

h2_ecm1 - xi_ecm1 SpearmanrResult(correlation=-0.6311288721788543, pvalue=0.011631543649550748)

m (slope) =  -3.3493684970585096
b (intercept) =  16.16978256254858

#+END_EXAMPLE

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H_ECM_h2_xi.png

pdf

http://www.star.bris.ac.uk/steff/ecm/1H_ECM_h2_xi.pdf



** g1_ecm - xi


PATH = =/home/steff075/phd_ecm/results-spectral/plot_ECM_g1_xi.py=

Importing =1H0707_flux_lag_relxill_indobs2.csv=

#+BEGIN_EXAMPLE
python plot_1H_ECM_g1_xi.py

mean_g1: 2.462
sigma_g1: 0.481
mean_xi: 1.682
sigma_xi: 0.785
g1_ecm1 - xi SpearmanrResult(correlation=-0.5296263944644564, pvalue=0.04230828094043704)
m (slope) =  -0.24296264907076656
b (intercept) =  2.87066317573703

#+END_EXAMPLE

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H_ECM_g1_xi.png

pdf

http://www.star.bris.ac.uk/steff/ecm/1H_ECM_g1_xi.pdf


** g2_ecm - b

PATH = =/home/steff075/phd_ecm/results-spectral/plot_1H_ECM_g1_xi.py=

Importing =1H0707_flux_lag_relxill_indobs2.csv=

#+BEGIN_EXAMPLE
python plot_1H_ECM_g1_xi.py

mean_g2: 1.618
sigma_g2: 0.183
mean_b: 2.453
sigma_b: 0.744
g1_ecm1 - b SpearmanrResult(correlation=0.5715792560854008, pvalue=0.02601487860246739)
m (slope) =  0.1035024884579278
b (intercept) =  1.3641428966421887

#+END_EXAMPLE

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H_ECM_g2_b.png

pdf

http://www.star.bris.ac.uk/steff/ecm/1H_ECM_g2_b.pdf


** g2_ecm - tshift

PATH = =/home/steff075/phd_ecm/results-spectral/plot_ECM_g2_tshift.py=

Importing =1H0707_flux_lag_relxill_indobs2.csv=

#+BEGIN_EXAMPLE
python plot_1H_ECM_g2_tshift.py

mean_g2: 1.618
sigma_g2: 0.183
mean_tshift: 48.725
sigma_tshift: 33.147
g2_ecm1 - tshift SpearmanrResult(correlation=-0.5757905426756755, pvalue=0.024691855030886896)
m (slope) =  -0.0027097699543495272
b (intercept) =  1.750034444282332


#+END_EXAMPLE

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H_ECM_g2_tshift.png

pdf

http://www.star.bris.ac.uk/steff/ecm/1H_ECM_g2_tshift.pdf

** xi - b

PATH = =/home/steff075/phd_ecm/results-spectral/plot_ECM_b_xi.py=

Importing =1H0707_flux_lag_relxill_indobs2.csv=

#+BEGIN_EXAMPLE
python plot_1H_ECM_b_xi.py

mean_b: 2.453
sigma_b: 0.744
mean_xi: 1.682
sigma_xi: 0.785
b_ecm1 - xi SpearmanrResult(correlation=0.53275625290346, pvalue=0.040881892734421166)
m (slope) =  0.4778826113652676
b (intercept) =  1.6488681143502864
#+END_EXAMPLE

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H_ECM_b_xi.png


pdf

http://www.star.bris.ac.uk/steff/ecm/1H_ECM_b_xi.pdf

** tshift - b

PATH = =/home/steff075/phd_ecm/results-spectral/plot_1H_ECM_tshift_b.py=

Importing =1H0707_flux_lag_relxill_indobs2.csv=

#+BEGIN_EXAMPLE
python plot_1H_ECM_shift_b.py

mean_g2: 1.618
sigma_g2: 0.183
mean_tshift: 48.725
sigma_tshift: 33.147
g2_ecm1 - tshift SpearmanrResult(correlation=-0.5757905426756755, pvalue=0.024691855030886896)
m (slope) =  -0.0027097699543495272
b (intercept) =  1.750034444282332


#+END_EXAMPLE

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/1H_ECM_tshift_b.png

pdf

http://www.star.bris.ac.uk/steff/ecm/1H_ECM_tshift_b.pdf






* *Ark 564*
** *Ark564 Initial fits*

Mass is logM 6.27

*** Run codes for $i = 58^\circ$

These files have been copied to =/homeb/steff075/phd_ecm/ecm-files=

#+BEGIN_EXAMPLE
For a whole directory:

scp -r so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/code-s-files .

For a single new file:

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/code-s-files/s-x0-h11-a0p998-i58.fits .
#+END_EXAMPLE

Note this was conducted in the *GPU partition of BC4*

Load modules

#+BEGIN_EXAMPLE
module load CUDA
module load cURL
#+END_EXAMPLE

*Run code-img*

#+BEGIN_EXAMPLE
./code-img -i58 -a0.998 -r400 -s8192

Output file = img-files/img-i58-a0p998-r400-8192.fits
2 platforms
Platform 0 has 1 devices
Platform: 0 Device: 0 --- [Tesla P100-PCIE-16GB] [*]
Platform 1 has 1 devices
Platform: 1 Device: 0 --- [Intel(R) Xeon(R) CPU E5-2680 v4 @ 2.40GHz]
Using platform 0 device 0
Tesla P100-PCIE-16GB
About to build...
Reached Kernel execution
Waiting for all kernels to finish
Finished command Queue
#+END_EXAMPLE

All img codes copied to =lyra:/homeb/steff075/phd_ecm/ecm-files/code-img-files=

-----------------------------------------------------------------------------------------------

*Run code-s*

#+BEGIN_EXAMPLE
./code-s -a0.998 -h2.0 -i58 -p1

Output file=code-s-files/s-x0-h2-a0p998-i58.fits
2 platforms
Platform 0 has 1 devices
Platform: 0 Device: 0 --- [Tesla P100-PCIE-16GB] [*]
Platform 1 has 1 devices
Platform: 1 Device: 0 --- [Intel(R) Xeon(R) CPU E5-2680 v4 @ 2.40GHz]
Using platform 0 device 0
Tesla P100-PCIE-16GB
About to build...
Reached Kernel execution
Waiting for all kernels to finish
Finished command Queue
#+END_EXAMPLE

Now set up to run for all other source heights

#+BEGIN_EXAMPLE
emacs submit-code-s.sh

#!/bin/bash -login
#SBATCH --nodes=1
#SBATCH --gres=gpu:2
#SBATCH --partition gpu
#SBATCH --mem=16GB
#SBATCH --time=8:00:00
#SBATCH --job-name=code-s

module load CUDA
module load cURL

cd $SLURM_SUBMIT_DIR

# Source do disk runs for 1H 0707-495
# Maximally spinning BH
# Height from 2, 3 r_g (two can run simultaneously)
# Inclination angle 53 degrees
# The -p option lets you specify which platform (GPU) -- either 1 or 2 for Bluecrystal
date
./code-s -a0.998 -h3.0 -i58 -p1 &
./code-s -a0.998 -h4.0 -i58 -p2
# Wait for the first job to finish
wait
date
./code-s -a0.998 -h5.0 -i58 -p1 &
./code-s -a0.998 -h6.0 -i58 -p2
wait
date
./code-s -a0.998 -h7.0 -i58 -p1 &
./code-s -a0.998 -h8.0 -i58 -p2
wait
date
./code-s -a0.998 -h9.0 -i58 -p1 &
./code-s -a0.998 -h10.0 -i58 -p2
wait
date
#+END_EXAMPLE

Submit code

Note this code falied due to CL_MEM_ALLOCATION error.

This is very temperemental !!!!

I tried running just one height, i.e.:

#+BEGIN_EXAMPLE
[so14935@bc4gpulogin1 x-ray-reverberation]$ ./code-s -a0.998 -h7.0 -i58 -p1.
#+END_EXAMPLE

But this ame up with the same error !!

However, the next day I ran the same code:

#+BEGIN_EXAMPLE
[so14935@bc4gpulogin1 x-ray-reverberation]$ ./code-s -a0.998 -h7.0 -i58 -p1.
Output file=code-s-files/s-x0-h7-a0p998-i58.fits
2 platforms
Platform 0 has 1 devices
Platform: 0 Device: 0 --- [Tesla P100-PCIE-16GB] [*]
Platform 1 has 1 devices
Platform: 1 Device: 0 --- [Intel(R) Xeon(R) CPU E5-2680 v4 @ 2.40GHz]
Using platform 0 device 0
Tesla P100-PCIE-16GB
About to build...
Reached Kernel execution
Waiting for all kernels to finish
Finished command Queue
#+END_EXAMPLE

/Conclusion/
It appears that there may not be the required 16GB available every time I submit
the script !! Furthermore there may not be 64GB available when
submitting the =submit-code-s.sh= code. This failed on many occasions
and may take up to a week in the gpu queue.

/Solution/
Run code-s individually in your terminal for each required source height .ie:

#+BEGIN_EXAMPLE
./code-s -a0.998 -h9.0 -i58 -p1.
#+END_EXAMPLE

Each run will take 30-45 mins so do this in the backgound during a
working day.

Completed Running code-s for Ark564 all files copied to =lyra:/homeb/steff075/phd_ecm/ecm-files/code-s-files=

-------------------------------------------------------------------------------------------------------------

*Run code-x*

Edit =submit-code-x.pl= for h = 2- 9

#+BEGIN_EXAMPLE
#! /usr/bin/perl -w

use strict;

# Parameters for Ark654
my $epsilon = 0.001;
# Inclination angle of disk ("i")
my $inclination_low = 58.0;
my $inclination_high = 58.0;
my $inclination_delta = 1.0;
# Source height ("h")
my $source_height_low = 2.0;
my $source_height_high = 9.0;
my $source_height_delta = 1.0;
# Photon index ("g")
my $photon_index_low = 1.4;
my $photon_index_high = 3.1;
my $photon_index_delta = 0.2;
# Ionization parameter ("x");
my $ionization_low = 1.0;
my $ionization_high = 3.0;
my $ionization_delta = 0.5;

# For testing this code set do_not_submit to 1. This will produce the submit scripts but not actually submit \
them. Set this to 0 to actually submit the jobs.
my $do_not_submit = 1;

my $i;
my $h;
my $g;
my $x;

my $n = 0;

for ($i=$inclination_low; $i <= $inclination_high + $epsilon; $i += $inclination_delta)
{
        for ($h = $source_height_low; $h <= $source_height_high + $epsilon; $h += $source_height_delta)
        {
                for ($g = $photon_index_low; $g <= $photon_index_high + $epsilon; $g += $photon_index_delta)
                {
                        for ($x = $ionization_low; $x <= $ionization_high + $epsilon; $x += $ionization_delta\
)
                        {
                                my $submit_file = sprintf("submit-scripts/code-x-%04i.csh", $n);
                                open FP, ">$submit_file";
                                printf FP "#! /bin/tcsh\n";
                                printf FP "#\n";
                                printf FP "#SBATCH --partition=serial\n";
                                printf FP "#SBATCH --nodes=1\n";
                                printf FP "#SBATCH --ntasks-per-node=1\n";
                                printf FP "#SBATCH --mem=64GB\n";
                                printf FP "#SBATCH --time=4:00:00\n";
                                printf FP "#SBATCH --job-name=code-x\n";
                                printf FP "\n";
                                printf FP "module load CUDA\n";
                                printf FP "module load cURL\n";
                                printf FP "\n";
                                printf FP "cd /mnt/storage/scratch/\$\{LOGNAME\}/x-ray-rev2/x-ray-reverberati\
on\n";
                                printf FP "/mnt/storage/scratch/\$\{LOGNAME\}/x-ray-rev2/x-ray-reverberation/\
code-x -i%04.1f -a0.998 -h%3.1f -g%3.1f -A1.0 -x%3.1f -p0.0\n", $i, $h, $g, $x;
                                close FP;

                                printf "sbatch $submit_file (code-x -i%04.1f -a0.998 -h%3.1f -g%3.1f -A1.0 -x\
%3.1f -p0.0)\n", $i, $h, $g, $x;
                                if ($do_not_submit==0) {
                                        `sbatch $submit_file`;
                                }

                                `sleep 4`;
                                $n = $n+1;
                        }
                }
        }
}
#+END_EXAMPLE

Run a test for one par range, e.g:

#+BEGIN_EXAMPLE
./code-x -i58.0 -h2.0 -g2.0 -A1.0 -x0.0 -p0.0 <<<<<<<< 1150 21 Aug >>>>>>>

h=2 i=58 g=2 A=1 x=0 p = 0
Reading img file (img-files/img-i58-a0p998-r400-8192.fits)
Reading s file (code-s-files/s-x0-h2-a0p998-i58.fits)
  ... read keys
  ... read in a bunch of disk info
Reading reflionx
k = 89400
rh=1.063214 rms= 1.236971
nd/nod= 11099713/30068827 missing=18969114

code took 10 mins to run
#+END_EXAMPLE

Ok! Now submit test =submit-code-x.pl= where =my $do_not_submit = 1;=
/change to 0 to actually submit the scripts

#+BEGIN_EXAMPLE
./submit-code-x.pl <<<<<<< 1205 21 Aug 19 >>>>>>>>

Running ....

sbatch submit-scripts/code-x-0000.csh (code-x -i58.0 -a0.998 -h2.0 -g1.4 -A1.0 -x1.0 -p0.0)
sbatch submit-scripts/code-x-0001.csh (code-x -i58.0 -a0.998 -h2.0 -g1.4 -A1.0 -x1.5 -p0.0)
sbatch submit-scripts/code-x-0002.csh (code-x -i58.0 -a0.998 -h2.0 -g1.4 -A1.0 -x2.0 -p0.0)
sbatch submit-scripts/code-x-0003.csh (code-x -i58.0 -a0.998 -h2.0 -g1.4 -A1.0 -x2.5 -p0.0)
....etc up to
sbatch submit-scripts/code-x-0359.csh (code-x -i58.0 -a0.998 -h9.0 -g3.0 -A1.0 -x3.0 -p0.0)
#+END_EXAMPLE

Test code ok, now submit where =my $do_not_submit = 0;=

Do this in batches of 3 source heights (to minimise serial queue) first for $h = 2-4$
#+BEGIN_EXAMPLE
./submit-code-x.pl <<<<<<< 1235 21 Aug 19 >>>>>>

And for  H = 5-7
./submit-code-x.pl <<<<<<<  1515 21 Aug >>>>>>>> --- I think h5 and h6 failed !!!!

>>>> First failed script:
emacs slurm-2294013.out
FITSIO status = 107: tried to move past end of file
h=5 i=58 g=1p4 A=1 x=1 p = 0
Reading img file (img-files/img-i58-a0p998-r400-8192.fits)
Reading s file (code-s-files/s-x0-h5-a0p998-i58.fits)

>>>>  Last Failed Script:
emacs slurm-2294111.out
FITSIO status = 107: tried to move past end of file
h=6 i=58 g=3 A=1 x=3 p = 0
Reading img file (img-files/img-i58-a0p998-r400-8192.fits)
Reading s file (code-s-files/s-x0-h6-a0p998-i58.fits)

------> Run H 5 and 6 again!

And for  H = 8-10
./submit-code-x.pl <<<<<<<  0930 22 Aug >>>>>>>>




And for  H = 11-13
./submit-code-x.pl <<<<<<<   Aug >>>>>>>>


#+END_EXAMPLE

*Run blob.c*

#+BEGIN_EXAMPLE


#+END_EXAMPLE

*** Lo - Flux

USE =Ark564-lo-flux-lag-freq-fits.sl=

=Ark564_lo_flux_best_fit.par=

#+BEGIN_EXAMPLE
sbatch Ark564-submit-lag-freq.sh
Submitted batch job 2567985

sacct -j 2567985

python find-best-fit-Ark564-lo-flux.py
Best fit is 6.121793 in file Ark564_lo_flux_best_fit_21.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001610119           0           1
  2  lag_freq(1).log_mass   0     0                6           6           8
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.1           0           0
  8  lag_freq(1).Gamma2     0     1              1.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              150           0           0
 15  lag_freq(1).t_shift    0     1               25           0           0


sbatch Ark564-submit-lag-freq.sh
Submitted batch job 2605728

sacct -j 2605728

python find-best-fit-Ark564-lo-flux.py
Best fit is 20.68088 in file Ark564_lo_flux_best_fit_46.txt


This is not fitting well at all - see timing analysis - you may need to rethink and replot the lo-flux lags !!!!

>>>>>>>>>>>>>>>>> Ark564-time-lags-lo-flux.rsp and Ark564-time-lags-lo-flux.rsp updated on 25 Oct 2019 - ready to fit again!

sbatch Ark564-submit-lag-freq.sh
Submitted batch job 2616401

python find-best-fit-Ark564-lo-flux.py
Best fit is 27.12566 in file Ark564_lo_flux_best_fit_29.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     8.983722e-05           0           1
  2  lag_freq(1).log_mass   0     0                6           6           8
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.9           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0


THis file is not fitting well

#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Ark564-lo-flux-ecm.PNG


Try again:

#+BEGIN_EXAMPLE
sbatch Ark564-submit-lag-freq.sh
Submitted batch job 2775523


python find-Ark564-best-fit.py
Best fit is 29.97118 in file Ark564_lo_flux_best_fit_14.txt

python find-Ark564-best-fit.py
Best fit is 24.42666 in file Ark564_lo_flux_best_fit_18.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001114847           0           1
  2  lag_freq(1).log_mass   0     0                6           6           8
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0

at 1500 18 November



#+END_EXAMPLE


Now fix the Mass to 6.27 in the par file:

#+BEGIN_EXAMPLE

#+END_EXAMPLE

*** Hi - Flux

USE =Ark564-hi-flux-lag-freq-fits.sl=

#+BEGIN_EXAMPLE
sbatch Ark564-submit-lag-freq.sh
Submitted batch job 2616302

python find-best-fit-Ark564-hi-flux.py
Best fit is 1.33476 in file Ark564_hi_flux_best_fit_63.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.790664e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.031151           6           8
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.9           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1                5           0           0

#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Ark564-hi-flux-ecm.PNG


<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<

Now fix the Mass to 6.27 in the par file:

#+BEGIN_EXAMPLE
python find-best-fit-Ark564-hi-flux.py
Best fit is 5.384314 in file Ark564_hi_flux_best_fit_14.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.147414e-05           0           1
  2  lag_freq(1).log_mass   0     1             6.27           6           8
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               15           0           0

save to Ark564-hi-flux-ecm-FM.par


 Parameters[Variable] = 15[1]
            Data bins = 7
           Chi-square = 5.384314
   Reduced chi-square = 0.8973857
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.147414e-05           0           1
  2  lag_freq(1).log_mass   0     1             6.27           6           8
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               15           0           0

#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Ark564-hi-flux-ecm-FM.PNG

Now try fixing t-shift = 0 with a fixed mass
#+BEGIN_EXAMPLE

sbatch Ark564-submit-lag-freq.sh
Submitted batch job 2776379


python find-Ark564-hi-flux-best-fit.py
Best fit is 7.597443 in file Ark564_hi_flux_best_fit_10.txt




#+END_EXAMPLE

*** Combined Lags

USE =Ark564-combined-lag-fits.sl=

#+BEGIN_EXAMPLE
python find-best-fit-Ark564-combined.py
Best fit is 2.931221 in file Ark564_combined_best_fit_08.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.669721e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.048856           6           8
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.1           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               15           0           0
#+END_EXAMPLE


#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Ark564_combined_ecm_fit_2pt93.png

Close in on tmax and tshift :

use =Ark564-combined-lag-freq-fits2.sl=

#+BEGIN_EXAMPLE

python find-Ark564-best-fit.py
Best fit is 2.601414 in file Ark564_combined_best_fit_20.txt

lag_freq(1)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.531708e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.051067           6           8
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.9           0           0
  8  lag_freq(1).Gamma2     0     1              1.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


sbatch  Ark564-submit-lag-freq.sh
Submitted batch job 2808699

sacct -j 2808699

python find-Ark564-best-fit.py
Best fit is 2.25957 in file Ark564_combined_best_fit_31.txt

lag_freq(1)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.903446e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.041316           6           8
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.9           0           0
  8  lag_freq(1).Gamma2     0     1              1.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              420           0           0
 15  lag_freq(1).t_shift    0     1               12           0           0


 python find-Ark564-best-fit.py
Best fit is 1.796664 in file Ark564_combined_best_fit_31.txt

lag_freq(1)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.957405e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.124798           6           8
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.1           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              370           0           0
 15  lag_freq(1).t_shift    0     1               15           0           0

#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Ark564_comb_ecm_improving.PNG

Now get in closer on t-max and t-shift:


Note that I still used:

=Ark564-combined-time-lags.fits=

=Ark564-combined-time-lags.rsp=

#+BEGIN_EXAMPLE
sbatch Ark564-submit-lag-freq.sh

python find-Ark564-best-fit.py
Best fit is 1.245319 in file Ark564_combined_best_fit.par

isis replot_Ark564_combined_best_fit.sl

 Parameters[Variable] = 15[2]
            Data bins = 7
           Chi-square = 1.245319
   Reduced chi-square = 0.2490637
lag_freq(1)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.254807e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.109502           6           8
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.9           0           0
  8  lag_freq(1).Gamma2     0     1              1.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              375           0           0
 15  lag_freq(1).t_shift    0     1               18           0           0

#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Ark564-combined-ecm.PNG

*** Results

Fitting procedure
#+BEGIN_EXAMPLE


#+END_EXAMPLE

*Ark564 Results in full*
#+ATTR_HTML: :border 2 :rules all :frame border :class striped table-striped
| Observations | $\chi^2$ | $\text{h}_1$ | $\text{h}_2$ | $\Gamma_1$ | $\Gamma_2$ | Fe | $\xi$ | p | b | $q_2$ | $t_\text{max}$ | $t_\text{shift}$ | Log M |
| Comined      |          |              |              |            |            |    |       |   |   |       |                |                  |       |
| 2000         |          |              |              |            |            |    |       |   |   |       |                |                  |       |
| 2005         |          |              |              |            |            |    |       |   |   |       |                |                  |       |
| 2011         |          |              |              |            |            |    |       |   |   |       |                |                  |       |
| Grp1         |          |              |              |            |            |    |       |   |   |       |                |                  |       |
| Grp2         |          |              |              |            |            |    |       |   |   |       |                |                  |       |
| Grp3         |          |              |              |            |            |    |       |   |   |       |                |                  |       |

** *Ark564 New model fits (since June 2020)*
*** Combined variable mass fits

use =Ark564-comb-fit-error.sl=

#+BEGIN_EXAMPLE

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.781804e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.241314           6         6.5
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0



Obsid Ark564_comb
chi^2 = 4.191252e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+2.256010e-02 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+0.000000e+00 -1.809758e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+9.656196e-02 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+2.771898e+01 -6.835679e+01)
Parameter t_shift = 1.000000e+01 (+2.672974e+00 -4.887200e+00)
.........................................................................


Ark564-comb-fit-error.sl fit
Submitted batch job 3903620

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.115277e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.248829           6         6.5
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1              100           0           0


Obsid Ark564_comb
chi^2 = 2.405371e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.018709e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.500000e+00 (+0.000000e+00 -5.056771e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.000000e+02 (+2.222913e+00 -3.302121e+02)
Parameter t_shift = 1.000000e+02 (+0.000000e+00 -2.460616e+00)



...............................................................................
Ark564-comb-fit-error2.sl
Submitted batch job 3903621

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.139113e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.249056           6         6.5
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1              100           0           0

Obsid Ark564_comb2
chi^2 = 2.549289e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.021172e+00 -0.000000e+00)
Parameter Gamma1 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+0.000000e+00 -7.983017e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.000000e+02 (+2.225544e+00 -3.481942e+02)
Parameter t_shift = 1.000000e+02 (+1.367714e+00 -9.338685e+00)

...............................................................
Ark564-comb-fit-error.sl

Submitted batch job 3903627


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     6.516181e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.031018           6         6.5
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               15           0           0


Obsid Ark564_comb
chi^2 = 2.464153e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+2.223987e-02 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+0.000000e+00 -5.987632e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+5.110323e+01 -2.960897e+02)
Parameter t_shift = 1.500000e+01 (+1.113766e+01 -9.904269e+00)

..................................................................

Ark564-comb-fit-error2.sl
Submitted batch job 3903629

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.210718e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.290034           6         6.5
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               15           0           0


Obsid Ark564_comb2
chi^2 = 2.142134e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+2.218116e-02 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+0.000000e+00 -2.694409e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+2.218116e-02 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.500000e+02 (+2.005168e+02 -5.366373e+00)
Parameter t_shift = 1.500000e+01 (+1.055192e+01 -9.898281e+00)

......................................................................................

Ark564-comb-fit-error.sl
Submitted batch job 3908735

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     6.607062e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.031474           6         6.5
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.1           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Obsid Ark564_comb2
chi^2 = 1.475401e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.017569e+00 -0.000000e+00)
Parameter Gamma1 = 2.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+1.576930e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+4.412119e-01 -2.959152e+02)
Parameter t_shift = 2.000000e+01 (+7.337098e+00 -1.492520e+01)


......................................................................................

Ark564-comb-fit-error2.sl
Submitted batch job 3908779

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     6.516473e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.035358           6         6.5
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid Ark564_comb
chi^2 = 1.320143e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+2.203271e-02 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.900000e+00 (+1.665104e-01 -4.845566e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+4.406542e-01 -7.960034e+01)
Parameter t_shift = 2.000000e+01 (+5.470637e+00 -1.492828e+01)

........................................................................


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     7.287274e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         5.979409           0           0
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Obsid Ark564_comb_FM
chi^2 = 2.262262e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+2.220303e-02 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+0.000000e+00 -4.100340e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.000000e+02 (+4.440605e-01 -1.955594e+01)
Parameter t_shift = 2.000000e+01 (+7.548820e+00 -7.937002e+00)

.............................................................


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.210718e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.290034           0           0
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               15           0           0

Obsid Ark564_comb_FM2
chi^2 = 2.142134e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+2.218116e-02 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+0.000000e+00 -2.694409e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+2.218116e-02 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.500000e+02 (+1.504109e+02 -5.366373e+00)
Parameter t_shift = 1.500000e+01 (+1.419787e+01 -2.933457e+00)

.................................................................

Ark564-comb-fit-error.sl
Submitted batch job 3910781

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     6.516473e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.035358           6         6.5
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Obsid Ark564_comb
chi^2 = 1.320143e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+2.203271e-02 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.900000e+00 (+1.066510e-01 -4.845566e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+0.000000e+00 -1.955935e+01)
Parameter t_shift = 2.000000e+01 (+4.406542e-02 -1.492828e+01)

..................................................................


Ark564-comb-fit-error2.sl
Submitted batch job 3910877

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     6.516473e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.035358           6         6.5
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Obsid Ark564_comb2
chi^2 = 1.320143e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+2.203271e-02 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.900000e+00 (+0.000000e+00 -4.845566e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+0.000000e+00 -4.889836e+00)
Parameter t_shift = 2.000000e+01 (+2.203271e-02 -1.492828e+01)

...................................................................

Ark564-comb-fit-error2.sl
Submitted batch job 3925845

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.311923e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.163834           6         6.5
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1                2           0           0
  8  lag_freq(1).Gamma2     0     1              1.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              350           0           0
 15  lag_freq(1).t_shift    0     1               15           0           0


Obsid Ark564_comb2
chi^2 = 1.607083e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+2.208431e-02 -0.000000e+00)
Parameter Gamma1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.500000e+00 (+3.078770e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+1.863117e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.500000e+02 (+1.509076e+02 -1.998179e+02)
Parameter t_shift = 1.500000e+01 (+1.289685e+01 -9.926157e+00)

..........................................................


Ark564-comb-fit-error3.sl
Submitted batch job 3925846


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.252352e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.271336           6         6.5
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              1.9           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               15           0           0



Obsid Ark564_comb3
chi^2 = 1.535344e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+2.207138e-02 -0.000000e+00)
Parameter Gamma1 = 1.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.400000e+00 (+3.086611e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -9.246568e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.500000e+02 (+2.509686e+02 -9.731970e+00)
Parameter t_shift = 1.500000e+01 (+1.356691e+01 -9.924229e+00)

.......................................................

Ark564-comb-fit-error4.sl
Submitted batch job 3925854




...................................................

Ark564-comb-fit-error5.sl
Submitted batch job 3925848

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.239873e-05           0       0.001
  2  lag_freq(1).log_mass   0     0                6           6         6.5
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.7           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               15           0           0

Obsid Ark564_comb5
chi^2 = 2.124696e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.020099e+00 -0.000000e+00)
Parameter Gamma1 = 1.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.400000e+00 (+7.802759e-02 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -9.778220e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+7.692828e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+5.100496e+01 -1.592101e+00)
Parameter t_shift = 2.000000e+01 (+9.701392e+00 -6.579447e+00)




.................................................

Ark564-comb-fit-error3.sl
Submitted batch job 3925859

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [1.9]; % Gamma1
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.0, 100.0, 150.0, 200.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 300.0, 350.0, 380.\
0, 400.0, 450.0, 500.0, 550.0, 600.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10.0, 15.0, 20.0, 25.0, 30.0, 35.0, 40.0, 45.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0, 110\
.0, 120.0]; % t_shift



lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.252352e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.271336           6         6.5
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              1.9           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               15           0           0


Obsid Ark564_comb3
chi^2 = 1.535344e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+2.207138e-02 -0.000000e+00)
Parameter Gamma1 = 1.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.400000e+00 (+3.086611e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -9.246568e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.500000e+02 (+2.207138e-01 -9.779286e+00)
Parameter t_shift = 1.500000e+01 (+1.356691e+01 -9.924229e+00)

........................................................................

Ark564_comb3_best_fit.par
Submitted batch job 3925862

Now trying to fit finer par range :

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [1.9]; % Gamma1
vals_to_fit[3] = [1.4]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [150.0, 200.0, 220.0, 230.0, 240.0, 245.0, 248.0, 250.0, 252.0, 255.0, 260.0, 270.0, 280.0]; % \
t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10.0, 15.0, 18.0, 20.0, 22.0, 25.0, 30.0, 35.0, 40.0, 45.0 100.0, 110.0, 120.0]; % t_shi\
ft

Obsid Ark564_comb3
chi^2 = 1.535344e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+2.207138e-02 -0.000000e+00)
Parameter Gamma1 = 1.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.400000e+00 (+3.086611e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -9.246568e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.500000e+02 (+2.207138e-01 -9.779286e+00)
Parameter t_shift = 1.500000e+01 (+1.356691e+01 -9.924229e+00)

............................................................................

Ark564-comb-fit-error5.sl
Submitted batch job 3925863


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.974581e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.036316           6         6.5
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              1.8           0           0
  8  lag_freq(1).Gamma2     0     1              1.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0



Obsid Ark564_comb5
chi^2 = 1.513709e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+2.206749e-02 -0.000000e+00)
Parameter Gamma1 = 1.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.500000e+00 (+1.031370e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -7.290558e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+5.088157e+01 -1.945864e+02)
Parameter t_shift = 2.000000e+01 (+8.112905e+00 -1.493642e+01)

...........................................................

Ark564-comb-fit-error2.sl
Submitted batch job 3925867


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     7.158496e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.096462           6         6.5
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.9           0           0
  8  lag_freq(1).Gamma2     0     1              2.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               15           0           0

Obsid Ark564_comb2
chi^2 = 2.802025e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.021915e+00 -0.000000e+00)
Parameter Gamma1 = 2.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.700000e+00 (+4.482459e-02 -2.429177e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+1.010957e+02 -2.471294e+02)
Parameter t_shift = 1.500000e+01 (+7.273772e+00 -9.890427e+00)

....................................................

Ark564-comb-fit-error5.sl
Submitted batch job 3925877

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0            4e-05           0       0.001
  2  lag_freq(1).log_mass   0     0             6.27           6         6.5
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1               50           0           0
 15  lag_freq(1).t_shift    0     1                5           0           0


Obsid Ark564_comb5
chi^2 = 1.241375e+02 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.000000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 1.200000e+02 (+0.000000e+00 -0.000000e+00)


check lag-files:

cd /mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/lag-files/i58/a0.998/h02.0+03.0

Failed !!!  - No blob code ran for gamma 2.8

#+END_EXAMPLE


Create image

#+BEGIN_EXAMPLE

##### Convert ps to png and rotate #######

convert -rotate "90" Ark564_comb_FM_best_fit.ps  Ark564_combined_ECM_best_fit.png


##### Pull into Lyra WWW (from Lyra) #####

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/Ark564_combined_ECM_best_fit.png /home/WWW/steff/ecm
#+END_EXAMPLE

*** Results

PATH =/home/steff075/phd_ecm/ecm_model/Ark564-comb.csv=

PATH =/home/steff075/phd_ecm/ecm_model/Ark564-comb-Vari-M.vsz=

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/Ark564-comb-Vari-M.png

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/Ark564-model-pars-V-chi-sq.png

#+BEGIN_EXAMPLE
Best fit overall was:

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     6.516473e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.035358           6         6.5
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Obsid Ark564_comb2
chi^2 = 1.320143e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+2.203271e-02 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.900000e+00 (+0.000000e+00 -4.845566e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+0.000000e+00 -4.889836e+00)
Parameter t_shift = 2.000000e+01 (+2.203271e-02 -1.492828e+01)

##########################################################################

Best fit with a similar mass was:

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.252352e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.271336           6         6.5
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              1.9           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               15           0           0

Obsid Ark564_comb3
chi^2 = 1.535344e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+2.207138e-02 -0.000000e+00)
Parameter Gamma1 = 1.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.400000e+00 (+3.086611e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -9.246568e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.500000e+02 (+2.207138e-01 -9.779286e+00)
Parameter t_shift = 1.500000e+01 (+1.356691e+01 -9.924229e+00)

This fit is located at:

/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/Ark564/Ark564-comb-fit-error.sl

check it runs ok

#+END_EXAMPLE


./Ark564-comb-fit-error.sl:336: Expecting ')': found '/'^M
./Ark564-comb-fit-error.sl:336:<top-level>:Syntax Error

./Ark564-comb-fit-error.sl:340: Expecting ')': found '/'^M
./Ark564-comb-fit-error.sl:340:<top-level>:Syntax Error





#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/Ark564_combined_ECM_best_fit.png

*** Fixed mass fits

#+BEGIN_EXAMPLE
Ark564-comb-FM-fit-error.sl

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.552535e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.27           0           0
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0


Obsid Ark564_comb_FM
chi^2 = 3.690948e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.021766e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.900000e+00 (+0.000000e+00 -1.319184e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+8.826662e-02 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.500000e+02 (+1.500800e+02 -9.742683e+01)
Parameter t_shift = 1.000000e+01 (+4.493278e-02 -1.955067e+00)

...................................................................

Ark564-comb-FM-fit-error2.sl

Submitted batch job 3910670

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.373976e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.27           0           0
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               15           0           0

Obsid Ark564_comb_FM2
chi^2 = 3.313709e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.021130e+00 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.900000e+00 (+0.000000e+00 -2.130523e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+2.239624e-02 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+1.001996e+02 -1.499925e+02)
Parameter t_shift = 1.500000e+01 (+2.035798e+00 -2.932811e+00)

...............................................................

#######################
#####################

Now check by fixing the mass as found in the vari-M results at 6.27

##########################


Ark564-comb-FM-fit-error.sl

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [1.9]; % Gamma1
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.0, 100.0, 150.0, 200.0, 250.0, 300.0, 350.0, 380.0, 400.0, 450.0, 500.0, 550.0, 600.0]; % t\
_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10.0, 15.0, 20.0, 25.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0, 110.0, 120.0]; \
% t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.264664e-05           0       0.001
  2  lag_freq(1).log_mass   0     1             6.27           0           0
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              1.9           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              250           0           0
 15  lag_freq(1).t_shift    0     1               15           0           0

Obsid Ark564_comb_FM
chi^2 = 1.543471e+00 / dof = 2
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+2.207285e-02 -0.000000e+00)
Parameter Gamma1 = 1.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.400000e+00 (+1.459266e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -9.513738e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+7.861134e-01 -1.905515e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.500000e+02 (+7.502777e+01 -1.849735e+01)
Parameter t_shift = 1.500000e+01 (+2.065456e+00 -2.940492e+00)

#+END_EXAMPLE

*** Results

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/Ark564-comb-FM.png

*** Lo flux variable mass fits

PATH
=/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/Ark564/Ark564-time-lag-fits/Ark564-time-lags-lo-flux.fits=

PATH
=/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/Ark564/Ark564-time-lag-fits/Ark564-time-lags-lo-flux.rsp=

PATH
=/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/Ark564/Ark564-loflux-fit-error.sl=


#+BEGIN_EXAMPLE
Ark564-loflux-fit-error.sl
Submitted batch job 3926107

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.418913e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.185331           6         6.5
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              1.9           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               25           0           0


Obsid Ark564_loflux1
chi^2 = 7.242191e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+6.496400e-02 -0.000000e+00)
Parameter Gamma1 = 1.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.400000e+00 (+2.040959e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+6.496400e-02 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.924184e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+1.012580e+02 -3.829632e+01)
Parameter t_shift = 2.500000e+01 (+1.028076e+01 -8.788250e+00)


......................................

Ark564-loflux-fit-error.sl
Submitted batch job 3926116

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.163604e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.139416           6         6.5
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.9           0           0
  8  lag_freq(1).Gamma2     0     1              2.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               25           0           0

Obsid Ark564_loflux1
chi^2 = 9.110404e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.067660e+00 -0.000000e+00)
Parameter Gamma1 = 2.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.700000e+00 (+9.548098e-03 -1.472084e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -5.801399e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.559927e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.000000e+02 (+6.801451e+00 -1.758404e+02)
Parameter t_shift = 2.500000e+01 (+1.497590e+01 -5.793362e+00)

.......................................

Ark564-loflux-fit-error2.sl
Submitted batch job 3926120

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0            4e-05           0       0.001
  2  lag_freq(1).log_mass   0     0             6.27           6         6.5
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1               50           0           0
 15  lag_freq(1).t_shift    0     1                5           0           0

Obsid Ark564_loflux2
chi^2 = 4.889603e+01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.000000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 1.200000e+02 (+0.000000e+00 -0.000000e+00)


.....................................

Ark564-loflux-fit-error3.sl
Submitted batch job 3926124

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      3.17584e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.156009           6         6.5
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               25           0           0

Obsid Ark564_loflux3
chi^2 = 8.800093e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+6.748813e-02 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+1.192890e-01 -3.373998e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+2.642986e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.643822e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+5.613821e+01 -1.257190e+02)
Parameter t_shift = 2.500000e+01 (+1.348751e+01 -6.235391e+00)

.....................................

Ark564-loflux-fit-error2.sl
Submitted batch job 3926128

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.371015e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.158657           6         6.5
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               25           0           0

Obsid Ark564_loflux2
chi^2 = 8.349586e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+6.673828e-02 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+1.136547e-01 -1.952120e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+4.013914e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.799097e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+5.439330e+01 -1.292487e+02)
Parameter t_shift = 2.500000e+01 (+1.206020e+01 -6.889108e+00)

.....................................

Ark564-loflux-fit-error.sl
Submitted batch job 3926140

File Edit Options Buffers Tools Help
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.163604e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.139416           6         6.5
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.9           0           0
  8  lag_freq(1).Gamma2     0     1              2.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               25           0           0

Obsid Ark564_loflux1
chi^2 = 9.110404e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.067660e+00 -0.000000e+00)
Parameter Gamma1 = 2.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.700000e+00 (+9.548098e-03 -1.472084e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -5.801399e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.559927e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.000000e+02 (+6.801451e+00 -1.758404e+02)
Parameter t_shift = 2.500000e+01 (+1.497590e+01 -5.793362e+00)

.....................................

Ark564-loflux-fit-error2.sl
Submitted batch job 3926141

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.252447e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.177869           6         6.5
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               25           0           0


Obsid Ark564_loflux2
chi^2 = 9.120337e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+6.803150e-02 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+2.101306e-01 -2.330588e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+4.517997e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.537056e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+1.037748e+02 -5.147998e+01)
Parameter t_shift = 2.500000e+01 (+1.654060e+01 -6.636550e+00)


.....................................

Ark564-loflux-fit-error3.sl
Submitted batch job 3926143

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      3.27736e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.172633           6         6.5
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               25           0           0

Obsid Ark564_loflux3
chi^2 = 7.869592e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+6.595747e-02 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.900000e+00 (+1.259990e-01 -1.873440e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+6.595747e-02 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.761520e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+5.352267e+01 -1.302174e+02)
Parameter t_shift = 2.500000e+01 (+1.275522e+01 -7.564834e+00)

.....................................

Ark564-loflux-fit-error.sl
Submitted batch job 3926154

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.751962e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.175654           6         6.5
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               25           0           0

Obsid Ark564_loflux1
chi^2 = 7.141385e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+6.480716e-02 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+1.692587e-01 -1.581865e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+3.226467e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.981516e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+5.310514e+01 -1.202569e+02)
Parameter t_shift = 2.500000e+01 (+9.971779e+00 -8.326278e+00)

.....................................

Ark564-loflux-fit-error2.sl
Submitted batch job 3926156

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.463299e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.188449           6         6.5
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.1           0           0
  8  lag_freq(1).Gamma2     0     1              1.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               25           0           0

Obsid Ark564_loflux2
chi^2 = 7.398299e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+6.520838e-02 -0.000000e+00)
Parameter Gamma1 = 2.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.600000e+00 (+2.451456e-01 -3.034034e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+3.719421e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.849892e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+1.040643e+02 -1.198336e+02)
Parameter t_shift = 2.500000e+01 (+1.182880e+01 -8.193152e+00)


.....................................

Ark564-loflux-fit-error3.sl
Submitted batch job 3926157

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      3.58306e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.187921           6         6.5
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1                2           0           0
  8  lag_freq(1).Gamma2     0     1              1.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               25           0           0

Obsid Ark564_loflux3
chi^2 = 7.065872e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+6.469017e-02 -0.000000e+00)
Parameter Gamma1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.500000e+00 (+2.204568e-01 -3.685107e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+1.822665e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.835062e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+1.019828e+02 -1.199221e+02)
Parameter t_shift = 2.500000e+01 (+1.213407e+01 -8.716030e+00)



......................................

Ark564-loflux-fit-error4.sl
Submitted batch job 3926158

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.418913e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.185331           6         6.5
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              1.9           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               25           0           0

Obsid Ark564_loflux4
chi^2 = 7.242191e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+6.496400e-02 -0.000000e+00)
Parameter Gamma1 = 1.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.400000e+00 (+2.097440e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+6.496400e-02 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.798981e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+1.021225e+02 -7.553390e+01)
Parameter t_shift = 2.500000e+01 (+1.279408e+01 -8.626936e+00)


#+END_EXAMPLE

*** Hi Flux

#+BEGIN_EXAMPLE

Ark564-hiflux-fit-error.sl
Submitted batch job 3926169

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.294665e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.220285           6         6.5
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              2.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1              100           0           0

Obsid Ark564_hiflux1
chi^2 = 5.649012e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+4.798955e-02 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.100000e+00 (+0.000000e+00 -5.334728e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+5.379063e+01 -1.693279e+02)
Parameter t_shift = 1.000000e+02 (+1.321338e+00 -8.466755e+00)

...................................

Ark564-hiflux-fit-error.sl
Submitted batch job 3926176

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.523112e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.271273           6         6.5
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               15           0           0

Obsid Ark564_hiflux1
chi^2 = 5.545528e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+4.790164e-02 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+0.000000e+00 -3.792415e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -9.520984e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+1.008712e+02 -1.904197e+01)
Parameter t_shift = 1.500000e+01 (+2.974424e+00 -9.811555e+00)

...................................
Ark564-hiflux-fit-error.sl
Submitted batch job 3926183

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.294665e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.220285           6         6.5
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              2.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1              100           0           0

Obsid Ark564_hiflux1
chi^2 = 5.649012e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+4.798955e-02 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.100000e+00 (+0.000000e+00 -5.334728e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+4.798955e-01 -2.856031e+01)
Parameter t_shift = 1.000000e+02 (+1.321338e+00 -8.466755e+00)

...................................
Ark564-hiflux-fit-error.sl
Submitted batch job 3926205


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.013779e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.268083           6         6.5
  3  lag_freq(1).i          0     1               58           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.1           0           0
  8  lag_freq(1).Gamma2     0     1              1.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               15           0           0

Obsid Ark564_hiflux1
chi^2 = 5.656969e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+4.799632e-02 -0.000000e+00)
Parameter Gamma1 = 2.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.600000e+00 (+0.000000e+00 -1.161614e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+1.009584e+02 -1.904007e+01)
Parameter t_shift = 1.500000e+01 (+3.563200e+00 -9.766276e+00)

...................................


...................................


...................................


...................................


...................................



#+END_EXAMPLE

*** Common fit commands

#+BEGIN_EXAMPLE

cd /mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/

 #########   Combined

emacs Ark564-comb-fit-error.sl &
sbatch Ark564-submit-fit-error.sh

emacs Ark564_comb_best_fit.par -nw


emacs Ark564_comb2_best_fit.par -nw
emacs Ark564_comb2_fit_info.txt -nw


#+END_EXAMPLE

* *IRAS 13224-3809*
** *IRAS 13224-3809 Initial fits*

Mass is logM 6.80

*** Run codes for $i = 64^\circ$

These files have been copied to =/homeb/steff075/phd_ecm/ecm-files=

#+BEGIN_EXAMPLE
For a whole directory:

scp -r so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/code-s-files .

For a single new file:

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/code-s-files/s-x0-h11-a0p998-i58.fits .
#+END_EXAMPLE
Note this was conducted in the *GPU partition of BC4*

Load modules

#+BEGIN_EXAMPLE
module load CUDA
module load cURL
#+END_EXAMPLE

*Run code-img*

#+BEGIN_EXAMPLE
./code-img -i64 -a0.998 -r400 -s8192

Output file = img-files/img-i64-a0p998-r400-8192.fits
2 platforms
Platform 0 has 1 devices
Platform: 0 Device: 0 --- [Tesla P100-PCIE-16GB] [*]
Platform 1 has 1 devices
Platform: 1 Device: 0 --- [Intel(R) Xeon(R) CPU E5-2680 v4 @ 2.40GHz]
Using platform 0 device 0
Tesla P100-PCIE-16GB
About to build...
Reached Kernel execution
Waiting for all kernels to finish
Finished command Queue
#+END_EXAMPLE

*Run code-s*

#+BEGIN_EXAMPLE
./code-s -a0.998 -h2.0 -i64 -p1

Output file=code-s-files/s-x0-h2-a0p998-i64.fits
2 platforms
Platform 0 has 1 devices
Platform: 0 Device: 0 --- [Tesla P100-PCIE-16GB] [*]
Platform 1 has 1 devices
Platform: 1 Device: 0 --- [Intel(R) Xeon(R) CPU E5-2680 v4 @ 2.40GHz]
Using platform 0 device 0
Tesla P100-PCIE-16GB
About to build...
Reached Kernel execution
Waiting for all kernels to finish
Finished command Queue
#+END_EXAMPLE

Now for all other source heights, i.e:

#+BEGIN_EXAMPLE
./code-s -a0.998 -h3.0 -i64 -p1
#+END_EXAMPLE

Copy to Lyra i.e:
#+BEGIN_EXAMPLE
scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/code-s-files/s-x0-h3-a0p998-i64.fits .
#+END_EXAMPLE

*** Lo - Flux

USE =IRAS-lo-flux-lag-freq-fits.sl=

=IRAS_lo_flux_best_fit.par=

#+BEGIN_EXAMPLE

sbatch IRAS-submit-lag-freq.sh
Submitted batch job 2571616

sacct -j 2571616

 python find-best-fit-IRAS13224-lo-flux.py
Best fit is 2.352898 in file IRAS_lo_flux_best_fit_19.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     9.332416e-06           0           1
  2  lag_freq(1).log_mass   0     0         6.609329           6           8
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.6           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0+
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1              110           0           0

Replot IRAS_lo_flux_best_fit.par

isis replot-best-lag-freq-fits.sl fit plot

 Parameters[Variable] = 15[2]
            Data bins = 7
           Chi-square = 2.352898
   Reduced chi-square = 0.4705796
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     9.332416e-06           0           1
  2  lag_freq(1).log_mass   0     0         6.609329           6           8
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.6           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1              110           0           0

#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809-lo-flux-ecm.PNG



Now fix the Mass to 6.27 in the par file:

#+BEGIN_EXAMPLE



#+END_EXAMPLE

#+ATTR_HTML: :width 600

*** Hi - Flux

USE =IRAS-hi-flux-lag-freq-fits.sl=

=IRAS_hi_flux_best_fit.par=

=find-best-fit-IRAS13224-hi-flux.py=

#+BEGIN_EXAMPLE

sbatch IRAS-submit-lag-freq.sh
Submitted batch job 2623328

python find-best-fit-IRAS13224-hi-flux.py
Best fit is 0.3320678 in file IRAS_hi_flux_best_fit_01.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.208976e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.021306           6           8
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.7           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              600           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0
#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809-hi-flux-ecm.PNG


Now fix the Mass to 6.80 in the par file:

#+BEGIN_EXAMPLE
sbatch IRAS-submit-lag-freq.sh
Submitted batch job 2623412

python find-best-fit-IRAS13224-hi-flux.py
Best fit is 4.614405 in file IRAS_hi_flux_best_fit_75.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      2.57963e-06           0           1
  2  lag_freq(1).log_mass   0     1              6.8           6           8
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              100           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0

#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809-hi-fluxFM-ecm.PNG

*** Joint fit

use:

=IRAS-joint-lag-freq-fits.sl=

=replot_IRAS_best_joint_flux.sl=

=IRAS-submit-lag-freq.sh=

=IRAS_best_joint_fit.par=

#+BEGIN_EXAMPLE
isis replot_IRAS_best_joint_flux.sl

 Parameters[Variable] = 32[2]
            Data bins = 14
           Chi-square = 2.684966
   Reduced chi-square = 0.2237472
sds(1)*lag_freq(1) + sds(2)*lag_freq(2)
 idx  param             tie-to  freeze         value         min         max
  1  sds(1).dataset         0     1                1           0           0
  2  lag_freq(1).norm       0     0     9.332416e-06           0           1
  3  lag_freq(1).log_mass   0     1         6.609329           5           8
  4  lag_freq(1).i          0     1               64           0           0
  5  lag_freq(1).a          0     1            0.998           0           0
  6  lag_freq(1).h1         0     1                2           0           0
  7  lag_freq(1).h2         0     1                3           0           0
  8  lag_freq(1).Gamma1     0     1              1.6           0           0
  9  lag_freq(1).Gamma2     0     1              1.4           0           0
 10  lag_freq(1).Fe         0     1                1           0           0
 11  lag_freq(1).xi         0     1                0           0           0
 12  lag_freq(1).p          0     1                0           0           0
 13  lag_freq(1).b          0     1                1           0           0
 14  lag_freq(1).q2         0     1              0.5           0           0
 15  lag_freq(1).t_max      0     1              450           0           0
 16  lag_freq(1).t_shift    0     1              110           0           0
 17  sds(2).dataset         0     1                2           0           0
 18  lag_freq(2).norm       0     0     3.208976e-05           0           1
 19  lag_freq(2).log_mass   0     1         6.021306           5           8
 20  lag_freq(2).i          4     0               64           0           0
 21  lag_freq(2).a          5     0            0.998           0           0
 22  lag_freq(2).h1         0     1                2           0           0
 23  lag_freq(2).h2         0     1                3           0           0
 24  lag_freq(2).Gamma1     0     1              1.7           0           0
 25  lag_freq(2).Gamma2     0     1              1.4           0           0
 26  lag_freq(2).Fe        10     0                1           0           0
 27  lag_freq(2).xi         0     1                0           0           0
 28  lag_freq(2).p         12     0                0           0           0
 29  lag_freq(2).b          0     1                1           0           0
 30  lag_freq(2).q2        14     0              0.5           0           0
 31  lag_freq(2).t_max      0     1              600           0           0
 32  lag_freq(2).t_shift    0     1               50           0           0
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -9.7671e-02     0.001
file:  IRAS13224-3809-time-lag-fits/IRAS13224-3809-time-lags-lo-flux.fits
  2       EPIC-PN          0       7/    7   -   2  -4.2733e-02     0.001
file:  IRAS13224-3809-time-lag-fits/IRAS13224-3809-time-lags-hi-flux.fits

#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809-joint-fit-ecm.PNG

*** Combined Lags

Create the following files for ease:

=IRAS-combined-lag-freq-fits.sl=

=IRAS-submit-lag-freq.sh=

=find-best-fit-IRAS13224-combined.py=

=IRAS_combined_best_fit.par=

Change the parameter file to read 64 deg

OK but change the mass to 6.8 logM !!!

Try now:

#+BEGIN_EXAMPLE
sbatch IRAS-submit-lag-freq.sh
Submitted batch job 2424550

sacct -j 2424550

python find-best-fit-IRAS13224-combined.py
Best fit is 0.519457 in file IRAS_combined_best_fit_22.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.141255e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.325656           6           8
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                1           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1               15           0           0

#+END_EXAMPLE


#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224_comb_ecm.png

*** Combined Lags 50 bins for P. Chainakun

PATH =/home/steff075/phd_ecm/IRAS13224-3809=

USE =lagfreq_comb_forPC.sl=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_lagfreq_comb_50bins.gif

+--------------+--------------+---------------+--------------+
|         Freq |           +- |           Lag |           +- |
+--------------+--------------+---------------+--------------+
| 1.081967e-04 | 8.196721e-06 |  4.164650e+02 | 1.980629e+02 |
+--------------+--------------+---------------+--------------+
| 1.259339e-04 | 9.540446e-06 |  3.228804e+02 | 1.067240e+02 |
+--------------+--------------+---------------+--------------+
| 1.465788e-04 | 1.110445e-05 |  1.372027e+02 | 2.273665e+02 |
+--------------+--------------+---------------+--------------+
| 1.706081e-04 | 1.292486e-05 | -5.253477e+00 | 1.495715e+02 |
+--------------+--------------+---------------+--------------+
| 1.985766e-04 | 1.504368e-05 | -3.330846e+01 | 2.062889e+02 |
+--------------+--------------+---------------+--------------+
| 2.311302e-04 | 1.750986e-05 | -1.083858e+02 | 1.033262e+02 |
+--------------+--------------+---------------+--------------+
| 2.690204e-04 | 2.038033e-05 | -8.884463e+01 | 7.422730e+01 |
+--------------+--------------+---------------+--------------+
| 3.131221e-04 | 2.372137e-05 | -8.427945e+01 | 6.316300e+01 |
+--------------+--------------+---------------+--------------+
| 3.644536e-04 | 2.761012e-05 | -4.302731e+01 | 7.824747e+01 |
+--------------+--------------+---------------+--------------+
| 4.242001e-04 | 3.213637e-05 | -9.262267e+01 | 6.434468e+01 |
+--------------+--------------+---------------+--------------+
| 4.937411e-04 | 3.740463e-05 |  8.493921e+00 | 4.757191e+01 |
+--------------+--------------+---------------+--------------+
| 5.746822e-04 | 4.353653e-05 | -4.411158e+01 | 3.495400e+01 |
+--------------+--------------+---------------+--------------+
| 6.688924e-04 | 5.067367e-05 | -4.772135e+01 | 2.777542e+01 |
+--------------+--------------+---------------+--------------+
| 7.785469e-04 | 5.898083e-05 | -4.101562e+01 | 2.064131e+01 |
+--------------+--------------+---------------+--------------+
| 9.061775e-04 | 6.864981e-05 | -2.416302e+01 | 2.600613e+01 |
+--------------+--------------+---------------+--------------+
| 1.054731e-03 | 7.990388e-05 | -7.391469e+00 | 3.420050e+01 |
+--------------+--------------+---------------+--------------+
| 1.227638e-03 | 9.300288e-05 | -1.714937e+01 | 1.654488e+01 |
+--------------+--------------+---------------+--------------+
| 1.428890e-03 | 1.082493e-04 | -6.362679e+00 | 1.741816e+01 |
+--------------+--------------+---------------+--------------+
| 1.663134e-03 | 1.259950e-04 | -3.629012e+01 | 1.405162e+01 |
+--------------+--------------+---------------+--------------+
| 1.935779e-03 | 1.466500e-04 | -5.090301e+00 | 1.638618e+01 |
+--------------+--------------+---------------+--------------+
| 2.253120e-03 | 1.706909e-04 | -2.502359e+01 | 1.230813e+01 |
+--------------+--------------+---------------+--------------+
| 2.622484e-03 | 1.986730e-04 | -3.596042e+01 | 3.650567e+01 |
+--------------+--------------+---------------+--------------+
| 3.052400e-03 | 2.312424e-04 |  5.072932e+00 | 1.451251e+01 |
+--------------+--------------+---------------+--------------+
| 3.552793e-03 | 2.691510e-04 |  3.499017e+01 | 2.151260e+01 |
+--------------+--------------+---------------+--------------+
| 4.135218e-03 | 3.132741e-04 | -6.209144e+01 | 1.804674e+01 |
+--------------+--------------+---------------+--------------+
| 4.813123e-03 | 3.646305e-04 | -3.554221e+01 | 1.717742e+01 |
+--------------+--------------+---------------+--------------+
| 5.602159e-03 | 4.244060e-04 |  3.918623e+01 | 5.380556e+01 |
+--------------+--------------+---------------+--------------+
| 6.520546e-03 | 4.939808e-04 |  2.668784e+01 | 1.560014e+01 |
+--------------+--------------+---------------+--------------+
| 7.589488e-03 | 5.749612e-04 | -6.279805e+01 | 3.290111e+01 |
+--------------+--------------+---------------+--------------+
| 8.833666e-03 | 6.692172e-04 |  1.794968e+00 | 1.082963e+01 |
+--------------+--------------+---------------+--------------+
| 1.028181e-02 | 7.789249e-04 | -8.286994e+00 | 2.254348e+01 |
+--------------+--------------+---------------+--------------+
| 1.196735e-02 | 9.066175e-04 | -2.101229e+01 | 2.254077e+01 |
+--------------+--------------+---------------+--------------+
| 1.392921e-02 | 1.055243e-03 |  2.641706e+01 | 4.688919e+00 |
+--------------+--------------+---------------+--------------+
| 1.621269e-02 | 1.228234e-03 |  1.206515e+01 | 5.183509e+00 |
+--------------+--------------+---------------+--------------+
| 1.887051e-02 | 1.429584e-03 | -1.748872e+01 | 3.585196e+00 |
+--------------+--------------+---------------+--------------+
| 2.196403e-02 | 1.663942e-03 | -2.132392e+01 | 5.631698e+00 |
+--------------+--------------+---------------+--------------+
| 2.556469e-02 | 1.936719e-03 | -1.194222e+01 | 5.651017e+00 |
+--------------+--------------+---------------+--------------+
| 2.975563e-02 | 2.254214e-03 | -1.587688e+01 | 4.323902e+00 |
+--------------+--------------+---------------+--------------+
| 3.463360e-02 | 2.623757e-03 |  1.353197e+01 | 3.983477e+00 |
+--------------+--------------+---------------+--------------+
| 4.031124e-02 | 3.053882e-03 | -1.109179e+01 | 4.191196e+00 |
+--------------+--------------+---------------+--------------+
| 4.691964e-02 | 3.554518e-03 | -8.228267e+00 | 1.677895e+00 |
+--------------+--------------+---------------+--------------+
| 5.461138e-02 | 4.137226e-03 |  7.289620e+00 | 1.607993e+00 |
+--------------+--------------+---------------+--------------+
| 6.356407e-02 | 4.815460e-03 |  7.431359e+00 | 2.779909e+00 |
+--------------+--------------+---------------+--------------+
| 7.398441e-02 | 5.604879e-03 |  5.852067e+00 | 1.037565e+00 |
+--------------+--------------+---------------+--------------+
| 8.611300e-02 | 6.523712e-03 | -5.351074e+00 | 8.070385e+00 |
+--------------+--------------+---------------+--------------+
| 1.002299e-01 | 7.593173e-03 | -8.643541e-02 | 1.194401e-02 |
+--------------+--------------+---------------+--------------+
| 1.166610e-01 | 8.837955e-03 |          -nan |         -nan |
+--------------+--------------+---------------+--------------+
| 1.357858e-01 | 1.028680e-02 |          -nan |         -nan |
+--------------+--------------+---------------+--------------+
| 1.580457e-01 | 1.197316e-02 |          -nan |         -nan |
+--------------+--------------+---------------+--------------+
| 1.839549e-01 | 1.393597e-02 |          -nan |         -nan |
+--------------+--------------+---------------+--------------+

saved to =IRAS13224-3809-comb_50_2.csv=

** *IRAS 13224-3809 New model fits (since June 20)*

PATH
=/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/IRAS13224-3809=

*** Combined variable mass fit

#+BEGIN_EXAMPLE
IRAS-comb-fit-error.sl
Submitted batch job 3932216

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.746662e-06           0       0.001
  2  lag_freq(1).log_mass   0     0         6.688247         6.6           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               70           0           0

Obsid IRAS_comb2
chi^2 = 1.163965e+01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+1.034014e-01 -8.965986e-01)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+2.056595e-01 -9.726390e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.034014e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+1.045215e+02 -2.374481e+02)
Parameter t_shift = 7.000000e+01 (+0.000000e+00 -2.055512e+01)
....................

IRAS-comb-fit-error2.sl
Submitted batch job 3932221

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     7.604439e-06           0       0.001
  2  lag_freq(1).log_mass   0     0              6.6         6.6           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              350           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0

Obsid IRAS_comb1
chi^2 = 8.731942e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+9.306142e-02 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+7.153453e-02 -3.320714e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+9.306142e-02 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.500000e+02 (+5.431451e+01 -1.436152e+02)
Parameter t_shift = 8.000000e+01 (+0.000000e+00 -2.775169e+01)
------------------------

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     7.604439e-06           0       0.001
  2  lag_freq(1).log_mass   0     0              6.6         6.6           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              350           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0

Obsid IRAS_comb2
chi^2 = 8.731942e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+9.306142e-02 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+7.153453e-02 -2.249427e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+9.306142e-02 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.500000e+02 (+5.431451e+01 -1.436152e+02)
Parameter t_shift = 8.000000e+01 (+0.000000e+00 -2.775169e+01)
..............................

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.488874e-06           0       0.001
  2  lag_freq(1).log_mass   0     0              6.6         6.6           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.1           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              350           0           0
 15  lag_freq(1).t_shift    0     1               90           0           0

Obsid IRAS_comb2
chi^2 = 9.650622e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+9.609754e-02 -9.039025e-01)
Parameter Gamma1 = 2.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.700000e+00 (+2.057882e-01 -2.924272e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+9.609754e-02 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.500000e+02 (+5.418547e+01 -2.389979e+02)
Parameter t_shift = 9.000000e+01 (+0.000000e+00 -3.253248e+01)
..................

##################
Needs a lower mass range ??

set_par("lag_freq(1).log_mass", 6.8, 0, 6.0, 7.0); Line 192

#################



lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.806853e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.287518           6           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                8           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0

Obsid IRAS_comb1
chi^2 = 2.609879e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 8.000000e+00 (+7.687580e-02 -9.231242e-01)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+1.357577e-01 -9.231242e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+6.200467e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+7.687580e-02 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+3.843790e+00 -9.475072e+01)
Parameter t_shift = 1.000000e+01 (+3.021929e+00 -4.615621e+00)
.................................

IRAS-comb-fit-error1.sl
Submitted batch job 3932306

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.383635e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.295198           6           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                8           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                1           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0

Obsid IRAS_comb1
chi^2 = 4.088605e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 8.000000e+00 (+8.024695e-02 -9.197530e-01)
Parameter Gamma1 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.700000e+00 (+8.024695e-03 -6.198769e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+3.920876e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+8.024695e-02 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+4.012348e+00 -3.399556e+01)
Parameter t_shift = 1.000000e+01 (+3.936379e+00 -4.598765e+00)
.................................

IRAS-comb-fit-error3.sl
Submitted batch job 3932309

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.992786e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.352163           6           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0

Obsid IRAS_comb3
chi^2 = 1.699866e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+7.493842e-02 -9.250616e-01)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+7.015948e-02 -9.250616e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -2.585712e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+7.493842e-02 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+1.498768e+00 -1.850123e+01)
Parameter t_shift = 1.000000e+01 (+3.746921e-01 -1.850123e+00)
.................................

IRAS-comb-fit-error2.sl
Submitted batch job 3932308

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.164685e-05           0       0.001
  2  lag_freq(1).log_mass   0     0          6.34662           6           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0

Obsid IRAS_comb2
chi^2 = 9.187045e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+7.335161e-02 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+1.464053e-01 -3.683668e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+7.335161e-02 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+1.467032e+00 -1.853297e+01)
Parameter t_shift = 1.000000e+01 (+3.667580e-01 -1.853297e+00)
................................


##### Convert ps to png and rotate #######

convert -rotate "90"

display 1

##### Pull into Lyra WWW (from Lyra) #####

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/IRAS13224-3809/IRAS_ECM_Good_fit_0pt92.png /home/WWW/steff/ecm

########

#+END_EXAMPLE


#+BEGIN_EXAMPLE

####################
###################

STOP!!!   Run blob code to finer pars for above --->


############

# First source height ("o")
my $first_source_height_low = 2.0;      # low value
my $first_source_height_high = 2.0;     # high value
my $source_height_delta = 1.0;                  # step size (same for both sources)
# First source height ("d")
my $second_source_height_low = 3.0;     # $first_source_height_low + $source_height_delta;
my $second_source_height_high = 5.0; # $first_source_height_high;
# Inclination angle of disk ("i")
my $inclination_low = 64.0;
my $inclination_high = 64.0;
my $inclination_delta = 1.0;
# Photon index of first source ("g")
my $first_source_photon_index_low = 2.6;
my $first_source_photon_index_high = 2.6;
my $first_source_photon_index_delta = 0.1;
# Photon index of second source ("e")
my $second_source_photon_index_low = 2.3;
my $second_source_photon_index_high = 2.3;
my $second_source_photon_index_delta = 0.1;
# Iron abundance ("A")
my $iron_abund_low = 1.0;
my $iron_abund_high = 1.0;
my $iron_abund_delta = 0.1;
# Ionization parameter ("x")
my $xi_low = 0.0;
my $xi_high = 3.0;
my $xi_delta = 1.0;
# Density profile index ("p") - density goes as r^-p
my $density_low = 0.0;
my $density_high = 0.0;
my $density_delta = 0.1;
# We're setting "y" and "l" to 1.0 which are the RRF for sources 1 and 2, respectively
# Brightness parameter is ratio of brightness of 2nd source compared to 1st
my $brightness_low = 1.0;
my $brightness_high = 3.0;
my $brightness_delta = 1.0;
# "q2" (q1 is fixed at 1)
my $q2_low = 0.5;
my $q2_high = 0.5;
my $q2_delta = 0.1;
# "v" is tmax;
my $tmax_low = 300.0;
my $tmax_high = 500.0;
my $tmax_delta = 2.0;
# "q" is the time shift between first and second source
my $tshift_low = 0.0;
my $tshift_high = 20.0;
my $tshift_delta = 1.0;


##############

Run the code (output to submit-scripts-i64-2)

./submit-blob-delta-i64-2.pl

sbatch submit-scripts-i64-2/blob-0000.csh
sbatch submit-scripts-i64-2/blob-0001.csh
sbatch submit-scripts-i64-2/blob-0002.csh
sbatch submit-scripts-i64-2/blob-0003.csh
sbatch submit-scripts-i64-2/blob-0004.csh
sbatch submit-scripts-i64-2/blob-0005.csh
sbatch submit-scripts-i64-2/blob-0006.csh
sbatch submit-scripts-i64-2/blob-0007.csh

##################

These codes are running

[so14935@bc4gpulogin1 x-ray-reverberation]$ squeue | grep so14935
           3932330    serial   reverb  so14935  R       4:24      1 compute077
           3932329    serial   reverb  so14935  R       4:28      1 compute077
           3932328    serial   reverb  so14935  R       4:33      1 compute077
           3932327    serial   reverb  so14935  R       4:37      1 compute075
           3932326    serial   reverb  so14935  R       4:41      1 compute075
           3932325    serial   reverb  so14935  R       4:46      1 compute075
           3932324    serial   reverb  so14935  R       4:50      1 compute071
           3932323    serial   reverb  so14935  R       4:54      1 compute069


Once complete - Refit IRAS-comb-fit-error2.sl with a finer par range
emacs

#+END_EXAMPLE

#+BEGIN_EXAMPLE

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.146291e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.316522           6           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              450           0           0
 15  lag_freq(1).t_shift    0     1                6           0           0

Obsid IRAS_comb2
chi^2 = 6.194329e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+7.276134e-02 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.500000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 6.000000e+00 (+0.000000e+00 -0.000000e+00)

.................................

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.142943e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.315859           6           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              452           0           0
 15  lag_freq(1).t_shift    0     1                6           0           0


Obsid IRAS_comb2
chi^2 = 6.181910e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+7.275891e-02 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+4.378110e-02 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.520000e+02 (+0.000000e+00 -9.272411e-01)
Parameter t_shift = 6.000000e+00 (+0.000000e+00 -0.000000e+00)
...................................................................................


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.141033e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.293451           6           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              468           0           0
 15  lag_freq(1).t_shift    0     1                0           0           0



Obsid IRAS_comb1
chi^2 = 5.930349e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+1.072060e+00 -1.854581e-01)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.680000e+02 (+3.560300e+01 -0.000000e+00)
Parameter t_shift = 0.000000e+00 (+2.022867e+01 -0.000000e+00)
...............................................................

##### Convert ps to png and rotate #######

convert -rotate "90" 1 2

display 2

##### Pull into Lyra WWW (from Lyra) #####

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/IRAS13224-3809/IRAS_comb1_best_fit.ps .

#+END_EXAMPLE


#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS_comb_best_fit.png

*** Lo flux

#+BEGIN_EXAMPLE

IRAS-loflux-fit-error1.sl
Submitted batch job 3935415

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     8.348195e-06           0       0.001
  2  lag_freq(1).log_mass   0     0         6.878171           6           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               60           0           0

Obsid IRAS_loflux1
chi^2 = 5.618596e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+2.095708e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+1.025029e+02 -3.481162e+02)
Parameter t_shift = 6.000000e+01 (+0.000000e+00 -1.222111e+01)

.................................

IRAS-loflux-fit-error1.sl
Submitted batch job 3935422

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.197619e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.605644           6           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1              110           0           0

Obsid IRAS_loflux1
chi^2 = 2.931978e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+6.120664e-01 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.500000e+00 (+0.000000e+00 -1.816899e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+6.645022e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+1.287748e+01 -6.193335e-01)
Parameter t_shift = 1.100000e+02 (+0.000000e+00 -3.442856e+01)

.................................

IRAS-loflux-fit-error2.sl
Submitted batch job 3935434

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.113267e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.618192           6           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.9           0           0
  8  lag_freq(1).Gamma2     0     1              2.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              600           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0

Obsid IRAS_loflux2
chi^2 = 1.949852e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+8.745394e-02 -0.000000e+00)
Parameter Gamma1 = 2.900000e+00 (+0.000000e+00 -3.702080e-02)
Parameter Gamma2 = 2.800000e+00 (+0.000000e+00 -3.767883e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.901319e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.000000e+02 (+0.000000e+00 -1.189778e+02)
Parameter t_shift = 8.000000e+01 (+2.510590e+01 -1.483049e+01)

##########################################################
This par file was fit on multiple efforts !!!!!

check pwd:

/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/lag-files/i64/a0.998/h02.0+03.0/g2.9+2.8/A01.0/x3.0/p00.0/b03.0/q0.5/tmax0600

[so14935@bc4gpulogin1 q0.5]$ ls
tmax0000  tmax0100  tmax0200  tmax0300  tmax0400  tmax0500  tmax0600
tmax0050  tmax0150  tmax0250  tmax0350  tmax0450  tmax0550

[so14935@bc4gpulogin1 q0.5]$ cd tmax0600
[so14935@bc4gpulogin1 tmax0600]$ ls
tshift0010  tshift0025  tshift0040  tshift0055  tshift0070  tshift0085  tshift0100
tshift0015  tshift0030  tshift0045  tshift0060  tshift0075  tshift0090
tshift0020  tshift0035  tshift0050  tshift0065  tshift0080  tshift0095

May need to run tmax > 600

###########################################################################

##### Convert ps to png and rotate #######

convert -rotate "90" 1 2

display 2

##### Pull into Lyra WWW (from Lyra) #####

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/IRAS13224-3809/IRAS_loflux_best_fit.png /home/WWW/steff/ecm

#+END_EXAMPLE

#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/

*** Hi flux

#+BEGIN_EXAMPLE
IRAS-hiflux-fit-error1.sl
Submitted batch job 3935518

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.7, 2.8, 2.9, 3.0]; % Gamma1
vals_to_fit[3] = [2.2, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.0, 100.0, 200.0, 250.0, 300.0, 350.0, 380.0, 400.0, 420.0, 450.0, 480.0, 500.0, 550.0, 600.0]\
; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 8.0, 10.0, 15.0,  20.0, 25.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0, 110.0, 120.\
0]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.770169e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.220414           6           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              350           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Obsid IRAS_hiflux1
chi^2 = 1.698676e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+2.227153e-01 -7.772847e-01)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.500000e+00 (+3.371940e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.500000e+02 (+6.681460e+00 -1.600650e+02)
Parameter t_shift = 2.000000e+01 (+3.361554e+00 -3.886423e+00)

.....................................................................

##### Convert ps to png and rotate #######

convert -rotate "90" IRAS_hiflux1_best_fit.ps IRAS_hiflux_ECM.png

display IRAS_hiflux_ECM.png

##### Pull into Lyra WWW (from Lyra) #####

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/IRAS13224-3809/IRAS_hiflux1_best_fit.ps .

#+END_EXAMPLE


#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS_hiflux_best_fit.png

*** IRAS13224-3809 ECM Results
+----------------+----------+----------+---+---+--------+------+------+-----------+---+------+------------+------+------+--------+---+---+-------+---+------+------+------+--------+--------+-------+-------+
| Data           | ECM-Chi2 | ECM_logM | + | - | ECM-h2 |    + |    - | ECM-Gama1 | + |    - | ECM-Gamma2 |    + |    - | ECM-xi | + | - | ECM-b | + |    - | tmax |    + |      - | tshift |     + |     - |
+----------------+----------+----------+---+---+--------+------+------+-----------+---+------+------------+------+------+--------+---+---+-------+---+------+------+------+--------+--------+-------+-------+
| IRAS13224-comb |     0.59 | 6.293451 |   |   |      4 | 1.07 | 0.19 |       2.6 | 0 |    0 |        2.3 |    0 |    0 |      3 | 0 | 0 |     1 | 0 |    0 |  468 | 35.6 |      0 |      0 | 20.23 |     0 |
+----------------+----------+----------+---+---+--------+------+------+-----------+---+------+------------+------+------+--------+---+---+-------+---+------+------+------+--------+--------+-------+-------+
| IRAS13224-hi   |     0.17 | 6.220414 |   |   |      5 | 0.22 | 0.78 |       2.8 | 0 |    0 |        2.5 | 0.34 |    0 |      3 | 0 | 0 |     1 | 0 |    0 |  350 | 6.68 | 160.07 |     20 |  3.36 |  3.88 |
+----------------+----------+----------+---+---+--------+------+------+-----------+---+------+------------+------+------+--------+---+---+-------+---+------+------+------+--------+--------+-------+-------+
| IRAS13224-lo*  |     1.94 | 6.618192 |   |   |      3 | 0.08 |    0 |       2.9 | 0 | 0.03 |        2.8 |    0 | 0.03 |      3 | 0 | 0 |     3 | 0 | 0.19 |  600 |    0 | 118.97 |     80 | 25.11 | 14.83 |
+----------------+----------+----------+---+---+--------+------+------+-----------+---+------+------------+------+------+--------+---+---+-------+---+------+------+------+--------+--------+-------+-------+

*May need fitting where tmax > 600 - see below

*Combined*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/IRAS_comb_best_fit.png

*Hi flux*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/IRAS_hiflux_best_fit.png

*Lo flux*

Needs fitting tmax > 600 - running (see below)

** *IRAS 13224-3809 + Observations from 2016*
*** Combined (old and containing blank & corrupt files)

PATH =IRAS13224-3809-time-lag-fits/IRAS13224-3809-comb-time-lags-add2016.fits=

#+BEGIN_EXAMPLE
IRAS-comb-fit-error1.sl
Submitted batch job 3947848

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.578267e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.124337           6           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              470           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0

Obsid IRAS_comb1_add2016
chi^2 = 1.125711e+01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+1.099243e-01 -1.197802e+00)
Parameter Gamma1 = 2.600000e+00 (+2.341405e-01 -9.849397e-02)
Parameter Gamma2 = 2.300000e+00 (+2.351368e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.362267e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.700000e+02 (+4.367182e+01 -1.645497e+02)
Parameter t_shift = 1.000000e+01 (+1.212905e+01 -0.000000e+00)

........................................................................


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.819987e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.209192           6           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                1           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              720           0           0
 15  lag_freq(1).t_shift    0     1               15           0           0


Obsid IRAS_comb1_add2016
chi^2 = 8.589555e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+1.731832e+00 -1.975530e-01)
Parameter Gamma1 = 2.600000e+00 (+9.773310e-02 -1.726096e-01)
Parameter Gamma2 = 2.400000e+00 (+4.133735e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 7.200000e+02 (+0.000000e+00 -1.672085e+02)
Parameter t_shift = 1.500000e+01 (+7.565847e+00 -5.757756e+00)

....................................................................

IRAS-comb-fit-error1.sl
Submitted batch job 3952447


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.012089e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.146991           6           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              900           0           0
 15  lag_freq(1).t_shift    0     1              100           0           0


Obsid IRAS_comb1_add2016
chi^2 = 8.231408e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+2.008628e+00 -1.975570e-01)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 9.000000e+02 (+0.000000e+00 -2.445215e+02)
Parameter t_shift = 1.000000e+02 (+0.000000e+00 -5.718454e+01)

##########################
#########################
#######################
####################

Run./submit-blob-delta-i64-1.pl for tmax 1000 - 1300 (step 20)

############################

....................................................................

IRAS-comb-fit-error1.sl
Submitted batch job 3958461

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 8.0, 10.0]; % h2
vals_to_fit[2] = [2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9]; % Gamma1
vals_to_fit[3] = [1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 200.0, 300.0, 400.0, 450.0, 500.0, 550.0, 600.0, 650.0, 700.0, 800.0, 900.0, 1000.0\
, 1100.0, 1200.0, 1300.0, 1400.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [0.0, 5.0, 10.0, 15.0, 20.0, 25.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0, 110.0,\
 120.0, 130.0, 140.0]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.012089e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.146991         5.9           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              900           0           0
 15  lag_freq(1).t_shift    0     1              100           0           0


Obsid IRAS_comb1_add2016
chi^2 = 8.231408e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+2.027354e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 9.000000e+02 (+0.000000e+00 -2.495075e+02)
Parameter t_shift = 1.000000e+02 (+0.000000e+00 -5.417187e+01)

....................................................................
##########################


Note: I have:

[so14935@bc4gpulogin1 x-ray-reverberation]$ cd lag-files/i64/a0.998/h02.0+04.0
[so14935@bc4gpulogin1 h02.0+04.0]$ ls
g1.4+1.5  g1.5+2.2  g1.6+2.9  g1.9+2.2  g2.1+1.9  g2.2+2.6  g2.4+1.8  g2.5+2.5  g2.7+1.7  g2.8+2.8
g1.4+1.6  g1.5+2.3  g1.7+1.5  g1.9+2.3  g2.1+2.0  g2.2+2.7  g2.4+1.9  g2.5+2.6  g2.7+1.8  g2.9+1.9
g1.4+1.7  g1.5+2.4  g1.7+1.6  g1.9+2.4  g2.1+2.1  g2.2+2.8  g2.4+2.0  g2.5+2.7  g2.7+1.9  g2.9+2.0
g1.4+1.8  g1.5+2.5  g1.7+1.7  g1.9+2.5  g2.1+2.2  g2.2+2.9  g2.4+2.1  g2.5+2.8  g2.7+2.0  g2.9+2.1
g1.4+1.9  g1.5+2.6  g1.7+1.8  g1.9+2.6  g2.1+2.3  g2.3+1.5  g2.4+2.2  g2.5+2.9  g2.7+2.1  g2.9+2.2
g1.4+2.0  g1.5+2.7  g1.7+1.9  g1.9+2.7  g2.1+2.4  g2.3+1.6  g2.4+2.3  g2.6+1.5  g2.7+2.2  g2.9+2.3
g1.4+2.1  g1.5+2.8  g1.7+2.0  g2.0+1.8  g2.1+2.5  g2.3+1.7  g2.4+2.4  g2.6+1.6  g2.7+2.3  g2.9+2.4
g1.4+2.2  g1.5+2.9  g1.7+2.1  g2.0+1.9  g2.1+2.6  g2.3+1.8  g2.4+2.5  g2.6+1.7  g2.7+2.4  g2.9+2.5
g1.4+2.3  g1.6+1.5  g1.7+2.2  g2.0+2.0  g2.1+2.7  g2.3+1.9  g2.4+2.6  g2.6+1.8  g2.7+2.5  g2.9+2.6
g1.4+2.4  g1.6+1.6  g1.7+2.3  g2.0+2.1  g2.1+2.8  g2.3+2.0  g2.4+2.7  g2.6+1.9  g2.7+2.6  g2.9+2.7
g1.4+2.5  g1.6+1.7  g1.7+2.4  g2.0+2.2  g2.1+2.9  g2.3+2.1  g2.4+2.8  g2.6+2.0  g2.7+2.7  g2.9+2.8
g1.4+2.6  g1.6+1.8  g1.7+2.5  g2.0+2.3  g2.2+1.5  g2.3+2.2  g2.4+2.9  g2.6+2.1  g2.7+2.8  g3.0+3.1
g1.4+2.7  g1.6+1.9  g1.7+2.6  g2.0+2.4  g2.2+1.6  g2.3+2.3  g2.5+1.5  g2.6+2.2  g2.8+1.8  g3.0+3.2
g1.4+2.8  g1.6+2.0  g1.7+2.7  g2.0+2.5  g2.2+1.7  g2.3+2.4  g2.5+1.6  g2.6+2.3  g2.8+1.9  g3.1+2.8
g1.4+2.9  g1.6+2.1  g1.7+2.8  g2.0+2.6  g2.2+1.8  g2.3+2.5  g2.5+1.7  g2.6+2.4  g2.8+2.0  g3.1+2.9
g1.5+1.5  g1.6+2.2  g1.7+2.9  g2.0+2.7  g2.2+1.9  g2.3+2.6  g2.5+1.8  g2.6+2.5  g2.8+2.1
g1.5+1.6  g1.6+2.3  g1.8+1.5  g2.0+2.8  g2.2+2.0  g2.3+2.7  g2.5+1.9  g2.6+2.6  g2.8+2.2
g1.5+1.7  g1.6+2.4  g1.8+1.6  g2.0+2.9  g2.2+2.1  g2.3+2.8  g2.5+2.0  g2.6+2.7  g2.8+2.3
g1.5+1.8  g1.6+2.5  g1.9+1.8  g2.1+1.5  g2.2+2.2  g2.3+2.9  g2.5+2.1  g2.6+2.8  g2.8+2.4
g1.5+1.9  g1.6+2.6  g1.9+1.9  g2.1+1.6  g2.2+2.3  g2.4+1.5  g2.5+2.2  g2.6+2.9  g2.8+2.5
g1.5+2.0  g1.6+2.7  g1.9+2.0  g2.1+1.7  g2.2+2.4  g2.4+1.6  g2.5+2.3  g2.7+1.5  g2.8+2.6
g1.5+2.1  g1.6+2.8  g1.9+2.1  g2.1+1.8  g2.2+2.5  g2.4+1.7  g2.5+2.4  g2.7+1.6  g2.8+2.7
[so14935@bc4gpulogin1 h02.0+04.0]$ g2.4+2.3

[so14935@bc4gpulogin1 h02.0+04.0]$ cd g2.4+2.3/A01.0/x1.0/p00.0/b03.0/q0.5/
[so14935@bc4gpulogin1 q0.5]$ ls
tmax0100  tmax0220  tmax0340  tmax0460  tmax0580  tmax0850  tmax0970  tmax1180  tmax1360  tmax1480
tmax0110  tmax0230  tmax0350  tmax0470  tmax0590  tmax0860  tmax0980  tmax1200  tmax1370  tmax1490
tmax0120  tmax0240  tmax0360  tmax0480  tmax0600  tmax0870  tmax0990  tmax1220  tmax1380  tmax1500
tmax0130  tmax0250  tmax0370  tmax0490  tmax0760  tmax0880  tmax1000  tmax1240  tmax1390
tmax0140  tmax0260  tmax0380  tmax0500  tmax0770  tmax0890  tmax1020  tmax1260  tmax1400
tmax0150  tmax0270  tmax0390  tmax0510  tmax0780  tmax0900  tmax1040  tmax1280  tmax1410
tmax0160  tmax0280  tmax0400  tmax0520  tmax0790  tmax0910  tmax1060  tmax1300  tmax1420
tmax0170  tmax0290  tmax0410  tmax0530  tmax0800  tmax0920  tmax1080  tmax1310  tmax1430
tmax0180  tmax0300  tmax0420  tmax0540  tmax0810  tmax0930  tmax1100  tmax1320  tmax1440
tmax0190  tmax0310  tmax0430  tmax0550  tmax0820  tmax0940  tmax1120  tmax1330  tmax1450
tmax0200  tmax0320  tmax0440  tmax0560  tmax0830  tmax0950  tmax1140  tmax1340  tmax1460
tmax0210  tmax0330  tmax0450  tmax0570  tmax0840  tmax0960  tmax1160  tmax1350  tmax1470



[so14935@bc4gpulogin1 q0.5]$ cd tmax0810/
[so14935@bc4gpulogin1 tmax0810]$ ls
tshift0000  tshift0025  tshift0050  tshift0075  tshift0100  tshift0125  tshift0150
tshift0005  tshift0030  tshift0055  tshift0080  tshift0105  tshift0130  tshift0155
tshift0010  tshift0035  tshift0060  tshift0085  tshift0110  tshift0135  tshift0160
tshift0015  tshift0040  tshift0065  tshift0090  tshift0115  tshift0140
tshift0020  tshift0045  tshift0070  tshift0095  tshift0120  tshift0145


....................................................................

IRAS-comb-fit-error1.sl
Submitted batch job 3961337


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7]; % Gamma1
vals_to_fit[3] = [2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 200.0, 300.0, 400.0, 450.0, 500.0, 600.0, 800.0, 900.0, 1000.0, 1200.0, 1400.0\
, 1500.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [10.0, 20.0, 25.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0, 110.0, 120.0, 130\
.0, 140.0]; % t_shift

SAme fit above - run fewer pars:

....................................................................

IRAS-comb-fit-error1.sl
Submitted batch job 3961797


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.3, 2.4, 2.5, 2.6, 2.7]; % Gamma1
vals_to_fit[3] = [2.2, 2.3, 2.4, 2.5, 2.6]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 200.0, 300.0, 400.0, 450.0, 500.0, 600.0, 800.0, 900.0, 1000.0, 1200.0, 1400.0\
, 1500.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [10.0, 20.0, 25.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0, 110.0, 120.0, 130\
.0, 140.0]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.012089e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.146991         6.1           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              900           0           0
 15  lag_freq(1).t_shift    0     1              100           0           0


Obsid IRAS_comb1_add2016
chi^2 = 8.231408e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+1.006612e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 9.000000e+02 (+2.332164e+02 -1.759164e+02)
Parameter t_shift = 1.000000e+02 (+2.603238e+01 -5.218520e+01)

....................................................................

IRAS-comb-fit-error1.sl
Submitted batch job 3961866


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.2, 2.3, 2.4, 2.5, 2.6, 2.7]; % Gamma1
vals_to_fit[3] = [2.1, 2.2, 2.3, 2.4, 2.5, 2.6]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 200.0, 300.0, 400.0, 450.0, 500.0, 600.0, 760.0, 800.0, 860.0, 880.0, 900.0, 950.0, 980.0, 1000.0, 1200.0,\
 1400.0, 1500.0, 1550.0, 1600.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [10.0, 20.0, 25.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0, 110.0, 120.0, 130.0, 140.0]; % t_shift


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.150142e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.196441         6.1           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              2.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1600           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid IRAS_comb1_add2016
chi^2 = 7.685650e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+1.017865e+00 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.600000e+03 (+0.000000e+00 -2.996381e+02)
Parameter t_shift = 2.000000e+01 (+1.363892e+01 -0.000000e+00)


....................................................................

IRAS-comb-fit-error1.sl

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.689459e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.165002         6.1           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                1           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1820           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Obsid IRAS_comb1_add2016
chi^2 = 4.775470e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.045565e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -1.249406e-01)
Parameter Gamma2 = 2.200000e+00 (+3.561294e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.820000e+03 (+0.000000e+00 -2.026297e+02)
Parameter t_shift = 2.000000e+01 (+2.544829e+00 -0.000000e+00)

....................................................................

IRAS-comb-fit-error1.sl
Submitted batch job 3968415

emacs slurm-3968415.out

ffopen could not interpret primary array header of file:
/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/lag-files/i64/a0.998
/h02.0+06.0/g2.5+2.4/A01.0/x0.0/p00.0/b01.0/q0.5/tmax1640/tshift0010/lag.fits
tried to move past end of file: /mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/lag-files/i64/a0.998/h02.0+06.\
0/g2.5+2.4/A01.0/x0.0/p00.0/b01.0/q0.5/tmax1640/tshift0010/lag.fits^M
/mnt/storage/scratch/so14935/isis/1.6.2/share/fits.sl:123:fits_check_error:Fits Error
Error: function evaluation failed^M
Traceback: _mode_switch
Traceback: _fit

##############################
whats going on  - this is a blank fits file:

[so14935@bc4gpulogin1 tshift0010]$ pwd
/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/lag-files/i64/a0.998/h02.0+06.0/g2.5+2.4/A01.0/x0.0/p00.0/b01.0/q0.5/tmax1640/tshift0010
[so14935@bc4gpulogin1 tshift0010]$ ls
lag.fits
[so14935@bc4gpulogin1 tshift0010]$ ls -l
total 0
-rw-r--r-- 1 so14935 phys17r 0 Aug 23 19:05 lag.fits

#######################
#####################

Look at a more recently created lag file:

e.g:
h1=2 h2=3 i=64 g1=2p5 g2=2p1 A=1 x=2 p=0 rs1=1 rs2=1 b=3 w=0p5 v=200 q=5

cd /mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/lag-files/i64/a0.998/h02.0+03.0/g2.5+2.1/A01.0/x2.0/p00.0/b03.0/q0.5/tmax0200/tshift0005

[so14935@bc4gpulogin1 tshift0005]$ ls -l -h
total 256K
-rw-r--r-- 1 so14935 phys17r 15K Aug 25 10:39 lag.fits


emacs lag.fits -nw

SIMPLE  =                    T / file does conform to FITS standard             BITPIX  =                   16 / number of bits per data pixel                  \
NAXIS   =                    0 / number of data axes                            EXTEND  =                    T / FITS dataset may contain extensions            \
COMMENT   FITS (Flexible Image Transport System) format is defined in 'AstronomyCOMMENT   and Astrophysics', volume 376, page 359; bibcode: 2001A&A...376..359H \
END                                                                                                                                                             \
                                                                                                                                                                \
                                                                                                                                                                \
                                                                                                                                                                \
XTENSION= 'BINTABLE'           / binary table extension                         BITPIX  =                    8 / 8-bit bytes                                    \
NAXIS   =                    2 / 2-dimensional binary table                     NAXIS1  =                   16 / width of table in bytes                        \
NAXIS2  =                  491 / number of rows in table                        PCOUNT  =                    0 / size of special data area                      \
GCOUNT  =                    1 / one data group (required keyword)              TFIELDS =                    2 / number of fields in each row                   \
TTYPE1  = 'fq      '           / label for field   1                            TFORM1  = '1D      '           / data format of field: 8-byte DOUBLE            \
TTYPE2  = 'lag     '           / label for field   2                            TFORM2  = '1D      '           / data format of field: 8-byte DOUBLE            \
EXTNAME = 'Lag_coh '           / name of this binary table extension            END                                                                             \


############
##########

Recent files seem ok but note below:

#######

Note there are a huge batch of files that were created but the lag.fits files are empty

e.g:
/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/lag-files/i64/a0.998/h02.0+06.0/g2.5+2.4/A01.0/x0.0/p00.0/b01.0/q0.5


drwxr-xr-x 22 so14935 phys17r 4.0K Jun  7 13:54 tmax0100
drwxr-xr-x 22 so14935 phys17r 4.0K Jun  7 13:54 tmax0150
drwxr-xr-x 22 so14935 phys17r 4.0K Jun  7 13:54 tmax0200
drwxr-xr-x 22 so14935 phys17r 4.0K Jun  7 13:54 tmax0250
drwxr-xr-x 22 so14935 phys17r 4.0K Jun  7 13:54 tmax0300
drwxr-xr-x 22 so14935 phys17r 4.0K Jun  7 13:54 tmax0350
drwxr-xr-x 22 so14935 phys17r 4.0K Jun  7 13:54 tmax0400
drwxr-xr-x 16 so14935 phys17r 4.0K Aug 23 19:03 tmax1620
drwxr-xr-x 16 so14935 phys17r 4.0K Aug 23 19:09 tmax1640
drwxr-xr-x 16 so14935 phys17r 4.0K Aug 23 19:15 tmax1660
drwxr-xr-x 16 so14935 phys17r 4.0K Aug 23 19:20 tmax1680
drwxr-xr-x 16 so14935 phys17r 4.0K Aug 23 19:26 tmax1700
drwxr-xr-x 16 so14935 phys17r 4.0K Aug 23 19:32 tmax1720
drwxr-xr-x 16 so14935 phys17r 4.0K Aug 23 19:37 tmax1740
drwxr-xr-x 16 so14935 phys17r 4.0K Aug 23 19:43 tmax1760
drwxr-xr-x 16 so14935 phys17r 4.0K Aug 23 19:48 tmax1780
drwxr-xr-x 16 so14935 phys17r 4.0K Aug 23 19:54 tmax1800
drwxr-xr-x 16 so14935 phys17r 4.0K Aug 23 20:00 tmax1820


[so14935@bc4gpulogin1 tmax0200]$ ls
tshift0010  tshift0030  tshift0050  tshift0070  tshift0090  tshift0110  tshift0130  tshift0150  tshift0170  tshift0190
tshift0020  tshift0040  tshift0060  tshift0080  tshift0100  tshift0120  tshift0140  tshift0160  tshift0180  tshift0200
[so14935@bc4gpulogin1 tmax0200]$ cd tshift0040
[so14935@bc4gpulogin1 tshift0040]$ ls -l
total 0
[so14935@bc4gpulogin1 tshift0040]$ cd ..
[so14935@bc4gpulogin1 tmax0200]$ cd tshift0050
[so14935@bc4gpulogin1 tshift0050]$ ls -l
total 0
[so14935@bc4gpulogin1 tshift0050]$

[so14935@bc4gpulogin1 tmax0200]$ cd tshift0120
[so14935@bc4gpulogin1 tshift0120]$ ls
[so14935@bc4gpulogin1 tshift0120]$ ls -l
total 0
[so14935@bc4gpulogin1 tshift0120]$

#############
#############


Must randomly check the output slurm files for errors!!!!!


################
#############
....................................................................


IRAS-comb-fit-error1.sl
Submitted batch job 3971618

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.2, 2.3, 2.4, 2.5, 2.6, 2.7]; % Gamma1
vals_to_fit[3] = [2.1, 2.2, 2.3, 2.4, 2.5, 2.6]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 150.0, 200.0, 250.0, 300.0, 350.0, 400.0, 450.0, 500.0, 550.0, 600.0]; % t_max (ze\
ro doesn't seem to work)
vals_to_fit[10] = [10.0, 20.0, 25.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0, 110.0, 120.0, 130.0, \
140.0]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.122305e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.108322         6.1           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid IRAS_comb1_add2016
chi^2 = 1.050730e+01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+2.080561e+00 -0.000000e+00)
Parameter Gamma1 = 2.500000e+00 (+0.000000e+00 -2.798550e-01)
Parameter Gamma2 = 2.300000e+00 (+2.363587e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.000000e+02 (+0.000000e+00 -1.932649e+02)
Parameter t_shift = 2.000000e+01 (+4.638536e-01 -0.000000e+00)

....................................................................

IRAS-comb-fit-error1.sl
Submitted batch job 3971874

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7]; % Gamma1
vals_to_fit[3] = [2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 300.0, 500.0, 600.0, 800.0, 1200.0, 1600.0, 1800.0, 1820.0]; % t_max (zero doesn't seem \
to work)
vals_to_fit[10] = [10.0, 15.0, 20.0, 25.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0, 110.0, 120.0, 130.0, \
140.0]; % t_shift

But wait - Try again to fit:

IRAS-comb-fit-error1.sl
Submitted batch job 3972779

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7]; % Gamma1
vals_to_fit[3] = [1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 150.0, 200.0, 250.0, 300.0, 350.0, 400.0, 450.0, 500.0, 600.0, 800.0, 1200.0, 1800.0]; %\
 t_max (zero doesn't seem to work)
vals_to_fit[10] = [0.0, 10.0, 20.0, 20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0, 110.0, 120.0]; % t_shift

ffopen could not interpret primary array header of file:
/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/lag-files/i64/a0.998
/h02.0+07.0/g2.1+2.3/A01.0/x0.0/p00.0/b01.0/q0.5/tmax1800/tshift0000/lag.fits
tried to move past end of file: /mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/lag-files/i\
64/a0.998/h02.0+07.0/g2.1+2.3/A01.0/x0.0/p00.0/b01.0/q0.5/tmax1800/tshift0000/lag.fits^M
/mnt/storage/scratch/so14935/isis/1.6.2/share/fits.sl:123:fits_check_error:Fits Error
Error: function evaluation failed^M
Traceback: _mode_switch
Traceback: _fit
lag_freq

But, the best fit so far here was:

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.640065e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.078833           6           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1                0           0           0


Tmax needs to run much > 500

....................................................................

IRAS-comb-fit-error1.sl
Submitted batch job 3979651

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7]; % Gamma1
vals_to_fit[3] = [2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [1000.0, 1600.0, 1700.0, 1800.0, 1900.0, 2000.0, 2100.0, 2200.0]; % t_max (zero doesn't s\
eem to work)
vals_to_fit[10] = [0.0, 10.0, 20.0, 20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0, 110.0, 120.0]; \
% t_shift

warning: minimization failed
warning: minimization failed
ffopen could not interpret primary array header of file:
/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/lag-files/i64/a0.998
/h02.0+06.0/g2.5+2.4/A01.0/x1.0/p00.0/b01.0/q0.5/tmax1700/tshift0090/lag.fits
tried to move past end of file: /mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/lag-files/\
i64/a0.998/h02.0+06.0/g2.5+2.4/A01.0/x1.0/p00.0/b01.0/q0.5/tmax1700/tshift0090/lag.fits^M
/mnt/storage/scratch/so14935/isis/1.6.2/share/fits.sl:123:fits_check_error:Fits Error
Error: function evaluation failed^M
Traceback: _mode_switch
Traceback: _fit



Failed at tmax 1700 but the best fit was fairly good at:

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.429125e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.083576           6           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             2200           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

....................................................................

IRAS-comb-fit-error1.sl
Submitted batch job 3980206

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.429125e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.083576           6           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             2200           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Improved fit...
warning: minimization failed
ffopen could not interpret primary array header of file:
/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/lag-files/i64/a0.998
/h02.0+06.0/g2.5+2.4/A01.0/x0.0/p00.0/b01.0/q0.5/tmax1800/tshift0090/lag.fits
tried to move past end of file: /mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/lag-files/i64/a0.998/h0\
2.0+06.0/g2.5+2.4/A01.0/x0.0/p00.0/b01.0/q0.5/tmax1800/tshift0090/lag.fits^M
/mnt/storage/scratch/so14935/isis/1.6.2/share/fits.sl:123:fits_check_error:Fits Error
Error: function evaluation failed^M
Traceback: _mode_switch
Traceback: _fit


Obsid IRAS_comb1_add2016
chi^2 = 4.633807e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+3.520223e+00 -0.000000e+00)
Parameter Gamma1 = 2.500000e+00 (+0.000000e+00 -2.265668e-01)
Parameter Gamma2 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.200000e+03 (+0.000000e+00 -8.761952e+02)
Parameter t_shift = 2.000000e+01 (+1.322523e+01 -1.481413e+01)

THis is still failing at tmax = maximum and tshift 90
#############################
#######################

This is a decent fit! Lets look at the data fit image:

Pull image into: /home/steff075/phd_ecm/results-ecm

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/IRAS13224-3809/IRAS_comb1_add2016_best_fit.ps .

ps2pdf IRAS_comb1_add2016_best_fit.ps

mv IRAS_comb1_add2016_best_fit.pdf IRAS_comb1_best_hightmax1.pdf

pdftocairo -png IRAS_comb1_best_hightmax1.pdf

cp IRAS_comb1_best_hightmax1-1.png /home/WWW/steff/ecm

#+END_EXAMPLE


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/IRAS_comb1_best_hightmax1-1.png


What is wrong with this - Try fitting coarse tmax grid:

#+BEGIN_EXAMPLE
IRAS-comb-fit-error1.sl
Submitted batch job 3980489

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.2, 2.3, 2.4, 2.5, 2.6, 2.7]; % Gamma1
vals_to_fit[3] = [2.1, 2.2, 2.3, 2.4, 2.5, 2.6]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [200.0, 300.0, 400.0, 500.0, 600.0, 700.0, 800.0, 900.0, 1000.0, 1600.0, 1900.0, 2000.0, 2100.0, 2\
200.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [0.0, 10.0, 20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0, 110.0, 120.0]; % t_shift

Improved fit...
ffopen could not interpret primary array header of file:
/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/lag-files/i64/a0.998
/h02.0+08.0/g2.7+2.2/A01.0/x3.0/p00.0/b02.0/q0.5/tmax0400/tshift0000/lag.fits
tried to move past end of file: /mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/
lag-files/i64/a0.998/h02.0+08.0/g2.7+2.2/A01.0/x3.0/p00.0/b02.0/q0.5/tmax0400/tshift0000/lag.fits^M
/mnt/storage/scratch/so14935/isis/1.6.2/share/fits.sl:123:fits_check_error:Fits Error
Error: function evaluation failed^M
Traceback: _mode_switch
Traceback: _fit

....................................................................

IRAS-comb-fit-error1.sl
Submitted batch job 3982608

ffopen could not interpret primary array header of file:
/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/lag-files/i64/a0.998
/h02.0+07.0/g2.6+2.5/A01.0/x0.0/p00.0/b01.0/q0.5/tmax0400/tshift0010/lag.fits
tried to move past end of file: /mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/lag-files/i64/a0.998/h02.0+0\
7.0/g2.6+2.5/A01.0/x0.0/p00.0/b01.0/q0.5/tmax0400/tshift0010/lag.fits^M
/mnt/storage/scratch/so14935/isis/1.6.2/share/fits.sl:123:fits_check_error:Fits Error
Error: function evaluation failed^M
Traceback: _mode_switch
Traceback: _fit

#+END_EXAMPLE

*** BC4 lag file problems

*Conclusion*

After many attempts to fit IRAS there wer just too manty blank and
corrupted lag.fits files. This has become impossible to fit where
there are in excess of 58M files.

*Solution*

Delete lag-files/i64 directory and run again but must
ensure the batch size is reduced enough for all code to fit
comfortably (e.g. try ~ 6000 and ensure all code completes)

*** Combined lags as of 20 Sep 2020

#+BEGIN_EXAMPLE
IRAS-comb-fit-error1.sl

FOR H2 = 3 - 4 only

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.012089e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.146991         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              900           0           0
 15  lag_freq(1).t_shift    0     1              100           0           0


Obsid IRAS_comb1_add2016
chi^2 = 8.231408e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 9.000000e+02 (+0.000000e+00 -2.234511e+02)
Parameter t_shift = 1.000000e+02 (+0.000000e+00 -9.512062e+01)

.......................................................................

IRAS-comb-fit-error1.sl
Submitted batch job 3992904


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.937056e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.104757         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1000           0           0
 15  lag_freq(1).t_shift    0     1              110           0           0


Obsid IRAS_comb1_add2016
chi^2 = 7.852626e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.000000e+03 (+0.000000e+00 -3.210181e+02)
Parameter t_shift = 1.100000e+02 (+0.000000e+00 -6.451043e+01)

.......................................................................

Submitted batch job 4038667




#+END_EXAMPLE

*** Low Flux

PATH =IRAS13224-3809-time-lag-fits/IRAS13224-3809-loflux-time-lags-add2016.fits=

#+BEGIN_EXAMPLE
IRAS-loflux-fit-error1.sl fit
Submitted batch job 3947863


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.546779e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.011293           6           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              600           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid IRAS_loflux1-add2016
chi^2 = 1.568549e+01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.995989e+00 -0.000000e+00)
Parameter Gamma1 = 2.900000e+00 (+5.062247e-03 -7.582912e-02)
Parameter Gamma2 = 2.800000e+00 (+9.531252e-03 -7.552366e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+7.292119e-01 -2.343825e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.000000e+02 (+0.000000e+00 -5.056314e+01)
Parameter t_shift = 2.000000e+01 (+1.811769e+01 -1.022327e+00)

.....................................................................

IRAS-loflux-fit-error1.sl
Submitted batch job 3950515

Obsid IRAS_loflux1_add2016
chi^2 = 9.882275e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+5.801415e-01 -7.834050e-01)
Parameter Gamma1 = 2.600000e+00 (+5.801415e-02 -0.000000e+00)
Parameter Gamma2 = 2.500000e+00 (+5.801415e-02 -7.621490e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -3.388893e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -3.724795e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.400000e+02 (+1.255041e+01 -9.606277e+00)
Parameter t_shift = 3.000000e+01 (+4.726442e+00 -4.884615e+00)

.....................................................................

IRAS-loflux-fit-error1.sl
Submitted batch job

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001859751           0       0.001
  2  lag_freq(1).log_mass   0     0                6           6           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              700           0           0
 15  lag_freq(1).t_shift    0     1               35           0           0


Obsid IRAS_loflux1_add2016
chi^2 = 1.398279e+01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+1.363237e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+1.242372e-01 -0.000000e+00)
Parameter Gamma2 = 2.500000e+00 (+1.111561e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.553053e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 7.000000e+02 (+1.896125e+02 -1.885262e+02)
Parameter t_shift = 3.500000e+01 (+2.789775e+00 -1.915047e+01)


.....................................................................

IRAS-loflux-fit-error1.sl
Submitted batch job 3958488


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [1.9, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8]; % Gamma1
vals_to_fit[3] = [2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [150.0, 200.0, 300.0, 400.0, 500.0, 600.0, 700.0, 800.0, 900.0, 1000.0, 1100.0, 1200.0]; % \
t_max (zero doesn't seem to work)
vals_to_fit[10] = [0.0, 10.0, 15.0, 20.0, 25.0, 30.0, 35.0, 40.0, 50.0, 60.0, 70.0, 75.0, 80.0, 85.0, 90.0, \
95.0, 100.0, 110.0, 120.0, 130.0, 140.0]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0002140562           0       0.001
  2  lag_freq(1).log_mass   0     0         5.911627         5.9           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                1           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              800           0           0
 15  lag_freq(1).t_shift    0     1               35           0           0

Obsid IRAS_loflux1_add2016
chi^2 = 7.979335e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+4.729378e-01 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+1.853255e-01 -1.663944e-01)
Parameter Gamma2 = 2.300000e+00 (+1.853255e-01 -1.663944e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -5.270622e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 8.000000e+02 (+1.172927e+02 -2.614998e+01)
Parameter t_shift = 3.500000e+01 (+5.563482e+00 -9.453216e+00)


.....................................................................

IRAS-loflux-fit-error1.sl
Submitted batch job 3959434

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [1.9, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8]; % Gamma1
vals_to_fit[3] = [2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [800.0, 820.0, 840.0, 860.0, 900.0, 920.0, 940.0, 960.0, 1000.0, 1120.0, 1160.0, 120\
0.0, 1260.0]% t_max (zero doesn't seem to work)
vals_to_fit[10] = [0.0, 10.0, 15.0, 20.0, 25.0, 30.0, 35.0, 40.0, 50.0, 60.0, 70.0, 75.0, 80.0, 85.0,\
 90.0, 95.0, 100.0, 110.0, 120.0, 130.0, 140.0]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0002079318           0       0.001
  2  lag_freq(1).log_mass   0     0         5.903747         5.9           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                1           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              840           0           0
 15  lag_freq(1).t_shift    0     1               35           0           0


Obsid IRAS_loflux1_add2016
chi^2 = 7.486476e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+4.354304e-01 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+1.676895e-01 -1.839394e-01)
Parameter Gamma2 = 2.300000e+00 (+1.676895e-01 -1.839394e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+1.881966e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -5.645696e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 8.400000e+02 (+8.069419e+01 -0.000000e+00)
Parameter t_shift = 3.500000e+01 (+5.094134e+00 -9.977830e+00)


##########
########

Run much higher tmax - note we have:


tmax0100  tmax0210  tmax0320  tmax0430  tmax0540  tmax0800  tmax1120  tmax1320  tmax1430
tmax0110  tmax0220  tmax0330  tmax0440  tmax0550  tmax0810  tmax1140  tmax1330  tmax1440
tmax0120  tmax0230  tmax0340  tmax0450  tmax0560  tmax0820  tmax1160  tmax1340  tmax1450
tmax0130  tmax0240  tmax0350  tmax0460  tmax0570  tmax0830  tmax1180  tmax1350  tmax1460
tmax0140  tmax0250  tmax0360  tmax0470  tmax0580  tmax0840  tmax1200  tmax1360  tmax1470
tmax0150  tmax0260  tmax0370  tmax0480  tmax0590  tmax1000  tmax1220  tmax1370  tmax1480
tmax0160  tmax0270  tmax0380  tmax0490  tmax0600  tmax1020  tmax1240  tmax1380  tmax1490
tmax0170  tmax0280  tmax0390  tmax0500  tmax0760  tmax1040  tmax1260  tmax1390  tmax1500
tmax0180  tmax0290  tmax0400  tmax0510  tmax0770  tmax1060  tmax1280  tmax1400
tmax0190  tmax0300  tmax0410  tmax0520  tmax0780  tmax1080  tmax1300  tmax1410
tmax0200  tmax0310  tmax0420  tmax0530  tmax0790  tmax1100  tmax1310  tmax1420


.....................................................................

IRAS-loflux-fit-error1.sl
Submitted batch job 3960257

vals_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [1.9, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8]; % Gamma1
vals_to_fit[3] = [2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [800.0, 820.0, 840.0, 920.0, 940.0, 960.0, 1000.0, 1020.0, 1040.0, 1080.0\
, 1100.0, 1120.0, 1160.0, 1200.0, 1260.0, 1400.0, 1420.0, 1450.0, 1500.0];% t_max (zero do\
esn't seem to work)
vals_to_fit[10] = [0.0, 10.0, 15.0, 20.0, 25.0, 30.0, 35.0, 40.0, 50.0, 60.0, 70.0, 75.0, \
80.0, 85.0, 90.0, 95.0, 100.0, 110.0, 120.0, 130.0, 140.0]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0002079318           0       0.001
  2  lag_freq(1).log_mass   0     0         5.903747         5.9           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                1           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              840           0           0
 15  lag_freq(1).t_shift    0     1               35           0           0



Obsid IRAS_loflux1_add2016
chi^2 = 7.486476e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+4.354304e-01 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+1.676895e-01 -1.163684e-02)
Parameter Gamma2 = 2.300000e+00 (+1.676895e-01 -1.163684e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+1.881966e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -5.645696e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 8.400000e+02 (+8.069419e+01 -0.000000e+00)
Parameter t_shift = 3.500000e+01 (+4.652567e+00 -9.977830e+00)


.....................................................................

IRAS-loflux-fit-error1.sl
Submitted batch job 3961802

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7]; % Gamma1
vals_to_fit[3] = [2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 200.0, 300.0, 400.0, 500.0, 600.0, 760.0, 800.0, 840.0, 1000.0, 1100.0\
, 1200.0, 1300.0, 1400.0, 1500.0, 1600.0];% t_max (zero doesn't seem to work)
vals_to_fit[10] = [10.0, 15.0, 20.0, 25.0, 30.0, 35.0, 40.0, 50.0, 60.0, 70.0, 75.0, 80.0, 85.0\
, 90.0, 95.0, 100.0, 110.0, 120.0, 130.0, 140.0]; % t_shift

No improvement
.....................................................................

########
#######

Before running higher t-max, try lower t-max range again first:

########################



IRAS-loflux-fit-error1.sl
Submitted batch job 3971622

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7]; % Gamma1
vals_to_fit[3] = [2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 200.0, 250.0, 300.0, 350.0, 400.0, 450.0, 500.0, 550.0, 600.0, 700.0, 800.0];% t_m\
ax (zero doesn't seem to work)
vals_to_fit[10] = [10.0, 15.0, 20.0, 25.0, 30.0, 35.0, 40.0, 50.0, 60.0, 70.0, 75.0, 80.0, 85.0, 90.0, 95.0\
, 100.0, 110.0, 120.0, 130.0, 140.0]; % t_shift

Obsid IRAS_loflux1_add2016
chi^2 = 1.366909e+01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.382019e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+1.339601e-01 -7.055370e-02)
Parameter Gamma2 = 2.000000e+00 (+1.299013e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+9.022906e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.700314e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.000000e+02 (+3.751877e+01 -1.383996e+02)
Parameter t_shift = 2.000000e+01 (+1.612437e+00 -3.779399e+00)

.....................................................................

IRAS-loflux-fit-error1.sl
Submitted batch job 3972786


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.0, 2.1, 2.2, 2.3, 2.4]; % Gamma1
vals_to_fit[3] = [1.4, 1.6, 1.8, 1.9, 2.0, 2.1, 2.2]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 150.0, 200.0, 250.0, 300.0, 350.0, 400.0, 450.0, 500.0, 550.0, 600.0, 700.0, 800.0];% t_\
max (zero doesn't seem to work)
vals_to_fit[10] = [10.0, 15.0, 20.0, 25.0, 30.0, 35.0, 40.0, 50.0, 60.0, 70.0, 75.0, 80.0, 85.0, 90.0, 95.0, 100.\
0, 110.0, 120.0, 130.0, 140.0]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001108605           0       0.001
  2  lag_freq(1).log_mass   0     0         6.120183         6.1           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.1           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Obsid IRAS_loflux1_add2016
chi^2 = 1.074631e+01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+1.044931e+00 -7.416917e-02)
Parameter Gamma1 = 2.100000e+00 (+1.264317e-01 -4.908580e-02)
Parameter Gamma2 = 1.800000e+00 (+1.685535e-01 -1.653958e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+6.248403e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -3.270926e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.000000e+02 (+3.649157e+01 -2.308606e+01)
Parameter t_shift = 2.000000e+01 (+1.073482e+00 -4.125473e+00)

.....................................................................

IRAS-loflux-fit-error1.sl
Submitted batch job 3979624

ffopen could not interpret primary array header of file:
/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/lag-files/i64/a0.998
/h02.0+09.0/g2.2+2.2/A01.0/x0.0/p00.0/b01.0/q0.5/tmax0500/tshift0000/lag.fits
tried to move past end of file: /mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/lag-files/i64/\
a0.998/h02.0+09.0/g2.2+2.2/A01.0/x0.0/p00.0/b01.0/q0.5/tmax0500/tshift0000/lag.fits^M
/mnt/storage/scratch/so14935/isis/1.6.2/share/fits.sl:123:fits_check_error:Fits Error
Error: function evaluation failed^M
Traceback: _mode_switch
Traceback: _fit
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.515194e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.070459           6           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1                0           0           0

.....................................................................

IRAS-loflux-fit-error1.sl
Submitted batch job 3979656

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.0, 2.1, 2.2, 2.3, 2.4, 2.6, 2.8, 2.9]; % Gamma1
vals_to_fit[3] = [1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [800.0, 840.0, 900.0, 1000.0, 1200.0, 1400.0, 1600.0, 1700.0, 1900.0, 2000.\
0, 2100.0, 2200.0];% t_max (zero doesn't seem to work)
vals_to_fit[10] = [10.0, 15.0, 20.0, 25.0, 30.0, 35.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0, 110.0, 1\
20.0, 130.0, 140.0]; % t_shift


This is not working out at all -- too many corrupt files

.......................................................................................

##################################################################
##################################################################
####                                                         #####
####  New fits after lag.fits file deletion and re-creation  #####
####                                                         #####
##################################################################
##################################################################


IRAS-loflux-fit-error1.sl

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0002192109           0       0.001
  2  lag_freq(1).log_mass   0     0         5.963534         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              700           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0

Obsid IRAS_loflux1_add2016
chi^2 = 8.555762e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+5.191999e-01 -2.621985e-01)
Parameter Gamma2 = 2.200000e+00 (+1.487698e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -4.291393e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 7.000000e+02 (+1.969664e+02 -2.563217e+02)
Parameter t_shift = 3.000000e+01 (+1.199039e+01 -1.784661e+01)

.......................................................................................
IRAS-loflux-fit-error1.sl
Submitted batch job 3992905

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0002180823           0       0.001
  2  lag_freq(1).log_mass   0     0         5.831087         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1000           0           0
 15  lag_freq(1).t_shift    0     1               40           0           0

Obsid IRAS_loflux1_add2016
chi^2 = 7.745702e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+5.107662e-01 -2.778508e-01)
Parameter Gamma2 = 2.200000e+00 (+1.335947e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -5.124562e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.000000e+03 (+3.778244e+01 -2.429171e+01)
Parameter t_shift = 4.000000e+01 (+4.385086e+00 -2.868972e+01)

.......................................................................................
IRAS-loflux-fit-error1.sl

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      0.000210521           0       0.001
  2  lag_freq(1).log_mass   0     0         5.831152         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1000           0           0
 15  lag_freq(1).t_shift    0     1               40           0           0



bsid IRAS_loflux1_add2016
chi^2 = 6.450514e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+5.979529e-01 -1.025074e+00)
Parameter Gamma1 = 2.400000e+00 (+1.984050e-01 -1.148189e-01)
Parameter Gamma2 = 2.300000e+00 (+3.586025e-02 -1.148189e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -5.457000e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.000000e+03 (+3.986622e+01 -4.442885e+01)
Parameter t_shift = 4.000000e+01 (+3.986622e+00 -1.056958e+01)

.......................................................................................
IRAS-loflux-fit-error1.sl

Submitted batch job 4038655



#+END_EXAMPLE



#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/

*** Med Flux

PATH =IRAS13224-3809-time-lag-fits/IRAS13224-3809-medflux-time-lags-add2016.fits=

#+BEGIN_EXAMPLE

IRAS-medflux-fit-error1.sl fit
Submitted batch job 3947865

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      2.84302e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.168997           6           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              600           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid IRAS_medflux1-add2016
chi^2 = 7.980111e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+1.523584e-01 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+9.969234e-02 -1.982012e-01)
Parameter Gamma2 = 2.500000e+00 (+4.388358e-02 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.000000e+02 (+0.000000e+00 -2.732997e+01)
Parameter t_shift = 2.000000e+01 (+2.089828e+01 -0.000000e+00)

.................................................................

IRAS-medflux-fit-error1.sl
Submitted batch job 3950521

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.265865e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.168977           6           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              800           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0


Obsid IRAS_medflux1_add2016
chi^2 = 3.290244e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+2.010749e+00 -5.689493e-01)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.500000e+00 (+1.153207e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 8.000000e+02 (+0.000000e+00 -1.839910e+02)
Parameter t_shift = 5.000000e+01 (+1.457914e+01 -4.240049e+01)

................................................................

IRAS-medflux-fit-error1.sl
Submitted batch job 3952449


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.306365e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.158839           6           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              850           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0

Obsid IRAS_medflux1_add2016
chi^2 = 2.709447e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+2.047991e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -2.644950e-01)
Parameter Gamma2 = 2.500000e+00 (+1.091736e-01 -3.478270e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 8.500000e+02 (+0.000000e+00 -2.115056e+02)
Parameter t_shift = 5.000000e+01 (+1.644751e+01 -4.926209e+01)




.................................................................

IRAS-medflux-fit-error1.sl
Submitted batch job 3955751

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.306365e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.158839           6           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              850           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0

Obsid IRAS_medflux1_add2016
chi^2 = 2.709447e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+2.047991e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -2.644950e-01)
Parameter Gamma2 = 2.500000e+00 (+1.091736e-01 -3.478270e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 8.500000e+02 (+0.000000e+00 -2.115056e+02)
Parameter t_shift = 5.000000e+01 (+1.644751e+01 -4.926209e+01)

.................................................................

IRAS-medflux-fit-error1.sl
Submitted batch job 3955927


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8]; % Gamma1
vals_to_fit[3] = [2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [200.0, 400.0, 500.0, 600.0, 700.0, 800.0, 900.0, 1000.0, 1060.0, 1100.0, 1180.0, 1200.0, 1220.0, 1300.0, \
1360.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [0.0, 10.0, 20.0, 25.0, 30.0, 35.0, 40.0, 50.0, 60.0, 70.0, 75.0, 80.0, 85.0, 90.0, 95.0, 100.0, 110.0, 1\
20.0, 130.0, 140.0]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.506126e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.139945           6           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              900           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0


Obsid IRAS_medflux1_add2016
chi^2 = 2.653955e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+2.044994e+00 -0.000000e+00)
Parameter Gamma1 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 9.000000e+02 (+0.000000e+00 -2.288492e+02)
Parameter t_shift = 5.000000e+01 (+3.428075e+01 -4.096033e+01)

.................................................................

IRAS-medflux-fit-error1.sl
Submitted batch job 3958483

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.3, 2.4, 2.5, 2.6]; % Gamma1
vals_to_fit[3] = [2.2, 2.3, 2.4, 2.5]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [700.0, 850.0, 860.0, 870.0, 880.0, 890.0, 900.0, 910.0, 920.0, 930.0, 940.0, 950.0,\
 970.0, 1000.0, 1100.0, 1200.0, 1300.0, 1400.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [0.0, 10.0, 20.0, 25.0, 30.0, 35.0, 40.0, 50.0, 55.0, 60.0, 70.0, 75.0, 80.0, 85.0,\
 90.0, 95.0, 100.0, 110.0, 120.0, 140.0]; % t_shift


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      3.46791e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.231455         5.9           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1400           0           0
 15  lag_freq(1).t_shift    0     1               20           0


Obsid IRAS_medflux1_add2016
chi^2 = 2.308624e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+9.727687e-01 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.400000e+03 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 2.000000e+01 (+6.343272e+01 -1.333264e+01)

.................................................................

IRAS-medflux-fit-error1.sl
Submitted batch job 3959392


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.3, 2.4, 2.5, 2.6]; % Gamma1
vals_to_fit[3] = [2.0, 2.1, 2.2, 2.3, 2.4, 2.5]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [1200.0, 1240.0, 1260.0, 1300.0, 1320.0, 1340.0, 1360.0, 1380.0, 1400.0, 1420.0, 143\
0.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [0.0, 5.0, 10.0, 15.0, 20.0, 25.0, 30.0, 35.0, 40.0, 50.0, 55.0, 60.0, 70.0, 75.0, \
80.0, 85.0, 90.0, 95.0, 100.0, 110.0, 120.0, 140.0]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.524074e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.227185         5.9           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1430           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid IRAS_medflux1_add2016
chi^2 = 1.938965e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+2.002600e-02 -9.799740e-01)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.430000e+03 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 2.000000e+01 (+5.006157e+01 -1.008097e+01)


.................................................................

IRAS-medflux-fit-error1.sl
Submitted batch job 3959585

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.2, 2.3, 2.4, 2.5, 2.6]; % Gamma1
vals_to_fit[3] = [1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [1400.0, 1420.0, 1430.0, 1440.0, 1450.0, 1460.0, 1470.0, 1480.0, 1490.0, 1500.0]; % t_max (ze\
ro doesn't seem to work)
vals_to_fit[10] = [0.0, 5.0, 10.0, 15.0, 20.0, 25.0, 30.0, 35.0, 40.0, 50.0, 55.0, 60.0, 70.0, 75.0, 80.0, 85.\
0, 90.0, 95.0, 100.0, 110.0, 120.0, 140.0]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.639248e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.216179         5.9           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1500           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid IRAS_medflux1_add2016
chi^2 = 1.439791e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+1.995229e-02 -9.800477e-01)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.500000e+03 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 2.000000e+01 (+5.000430e+01 -1.879800e+01)

##############################
#######################

This is a decent fit! Lets look at the data fit image:

Pull image into: /home/steff075/phd_ecm/results-ecm

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/IRAS13224-3809/IRAS_medflux1_add2016_best_fit.ps .

ps2pdf IRAS_medflux1_add2016_best_fit.ps

pdftocairo -png IRAS_medflux1_add2016_best_fit.pdf

cp IRAS_medflux1_add2016_best_fit-1.png /home/WWW/steff/ecm
#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_medflux1_add2016_best_fit-1.png


Can we improve on this fit?

#+BEGIN_EXAMPLE
Run submit-blob-delta-i64-1.pl for

cd h02.0+04.0/g2.4+2.2/A01.0/x2.0/p00.0/b03.0/q0.5/


my $tmax_low = 1495.0;
my $tmax_high = 1600.0;
my $tmax_delta = 5.0;
# "q" is the time shift between first and second source
my $tshift_low = 0.0;
my $tshift_high = 40.0;
my $tshift_delta = 2.0;

./submit-blob-delta-i64-1.pl started 1000hrs 17 Aug

           3960471    serial   reverb  so14935  R       0:26      1 compute077
           3960470    serial   reverb  so14935  R       0:31      1 compute077
           3960469    serial   reverb  so14935  R       0:35      1 compute076
           3960468    serial   reverb  so14935  R       0:39      1 compute076
           3960467    serial   reverb  so14935  R       0:44      1 compute076
           3960473    serial   reverb  so14935 PD       0:00      1 (Priority)
           3960472    serial   reverb  so14935 PD       0:00      1 (Resources)
           3960474    serial   reverb  so14935 PD       0:00      1 (Priority)
           3960475    serial   reverb  so14935 PD       0:00      1 (Priority)

.................................................................

IRAS-medflux-fit-error1.sl
Submitted batch job 3961906


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.1, 2.2, 2.3, 2.4]; % Gamma1
vals_to_fit[3] = [1.9, 2.0, 2.1, 2.2, 2.3, 2.4]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [1430.0, 1440.0, 1450.0, 1470.0, 1480.0, 1490.0, 1495.0, 1500.0, 1520.0, 1550.\
0, 1580.0, 1600.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [0.0, 5.0, 10.0, 15.0, 20.0, 25.0, 30.0, 35.0, 40.0, 50.0, 55.0, 60.0, 70.0, \
75.0, 80.0, 85.0, 90.0, 95.0, 100.0, 110.0, 120.0, 140.0]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.359004e-05           0       0.001
  2  lag_freq(1).log_mass   0     0          6.18213         5.9           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1600           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid IRAS_medflux1_add2016
chi^2 = 1.402463e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+1.994680e-02 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+9.617431e-02 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.600000e+03 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 2.000000e+01 (+5.000520e+01 -1.056762e+01)

############################


Run tmax > 1600

submit-blob-delta-i64-4.pl

.................................................................

IRAS-medflux-fit-error1.sl

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.549668e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.187158         5.9           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                1           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1620           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Obsid IRAS_medflux1_add2016
chi^2 = 1.287850e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+2.832312e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.620000e+03 (+0.000000e+00 -1.165080e+03)
Parameter t_shift = 2.000000e+01 (+5.323113e+01 -0.000000e+00)


############
#########

/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/lag-files/i64/a0.998/h02.0+03.0/g2.4+2.2/A01.0/x1.0/p00.0/b02.0/q0.5
[so14935@bc4gpulogin1 q0.5]$ ls
tmax0100  tmax0180  tmax0260  tmax0450  tmax0640  tmax0720  tmax0820  tmax0950  tmax1200  tmax1450  tmax1700  tmax1800
tmax0120  tmax0200  tmax0280  tmax0500  tmax0650  tmax0740  tmax0840  tmax1000  tmax1250  tmax1620  tmax1720  tmax1820
tmax0140  tmax0220  tmax0300  tmax0550  tmax0660  tmax0760  tmax0860  tmax1050  tmax1300  tmax1640  tmax1740
tmax0150  tmax0240  tmax0350  tmax0600  tmax0680  tmax0780  tmax0880  tmax1100  tmax1350  tmax1660  tmax1760
tmax0160  tmax0250  tmax0400  tmax0620  tmax0700  tmax0800  tmax0900  tmax1150  tmax1400  tmax1680  tmax1780

Next job - run tmax between 1450 - 1660 at this height then run finer tshift within this range....

###########################
#################



................................................................
##########################
But first - Try lower Tmax range:
#################

IRAS-medflux-fit-error1.sl
Submitted batch job 3972789

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.0, 2.1, 2.2, 2.3, 2.4, 2.5]; % Gamma1
vals_to_fit[3] = [1.4, 1.6, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 150.0, 200.0, 250.0, 300.0, 350.0, 400.0, 450.0, 500.0, 550.0, 600.0, 700.0, 800.0];% t_max (zero doesn't seem to work)
vals_to_fit[10] = [10.0, 15.0, 20.0, 25.0, 30.0, 35.0, 40.0, 50.0, 60.0, 70.0, 75.0, 80.0, 85.0, 90.0, 95.0, 100.0, 110.0, 120.0, 130.0, 140.0]; % t_s\
hift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.868511e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.175732         5.9           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.1           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              800           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0

Obsid IRAS_medflux1_add2016
chi^2 = 3.115807e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+3.262138e+00 -0.000000e+00)
Parameter Gamma1 = 2.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.900000e+00 (+0.000000e+00 -2.493463e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 8.000000e+02 (+0.000000e+00 -2.372373e+02)
Parameter t_shift = 5.000000e+01 (+1.820181e+01 -0.000000e+00)

------> so the fits are much better at a higher t-max value!!  <-----------------



.......................................................................................

##################################################################
##################################################################
####                                                         #####
####  New fits after lag.fits file deletion and re-creation  #####
####                                                         #####
##################################################################
##################################################################

IRAS-medflux-fit-error1.sl


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.094455e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.087415         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              2.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1000           0           0
 15  lag_freq(1).t_shift    0     1               60           0           0


Obsid IRAS_medflux1_add2016
chi^2 = 2.680294e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.100000e+00 (+0.000000e+00 -4.967973e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.000000e+03 (+0.000000e+00 -3.001525e+02)
Parameter t_shift = 6.000000e+01 (+2.572494e+01 -5.257216e+01)

.......................................................................................

IRAS-medflux-fit-error1.sl
Submitted batch job 3992906

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.482663e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.088717         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1000           0           0
 15  lag_freq(1).t_shift    0     1               60           0           0

Obsid IRAS_medflux1_add2016
chi^2 = 2.607167e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+0.000000e+00 -6.968135e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.000000e+03 (+0.000000e+00 -3.038598e+02)
Parameter t_shift = 6.000000e+01 (+2.956983e+01 -5.303178e+01)



......................................................................................

IRAS-medflux-fit-error1.sl

Submitted batch job 4038658


......................................................................................

IRAS-medflux-fit-error1.sl



#+END_EXAMPLE


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/

*** Hi Flux

PATH =IRAS13224-3809-time-lag-fits/IRAS13224-3809-hiflux-time-lags-add2016.fits=

#+BEGIN_EXAMPLE
IRAS-hiflux-fit-error1.sl
Submitted batch job 3947867

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.546779e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.011293           6           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              600           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Obsid IRAS_hiflux1_add2016
chi^2 = 6.492882e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+6.892668e-01 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -1.691479e-01)
Parameter Gamma2 = 2.500000e+00 (+1.057112e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.000000e+02 (+0.000000e+00 -5.980985e+01)
Parameter t_shift = 2.000000e+01 (+9.658982e-02 -9.517051e-01)

...................................................................

IRAS-hiflux-fit-error1.sl
Submitted batch job 3950517

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.543074e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.211983           6           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              800           0           0
 15  lag_freq(1).t_shift    0     1               90           0           0


Obsid IRAS_hiflux1_add2016
chi^2 = 3.547772e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+3.431580e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+5.723102e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 8.000000e+02 (+0.000000e+00 -1.857826e+02)
Parameter t_shift = 9.000000e+01 (+2.793428e+01 -4.394249e+01)

...................................................................

IRAS-hiflux-fit-error1.sl
Submitted batch job 3956508

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.738432e-05           0       0.001
  2  lag_freq(1).log_mass   0     0          6.17276           6           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              2.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              900           0           0
 15  lag_freq(1).t_shift    0     1              100           0           0


Obsid IRAS_hiflux1_add2016
chi^2 = 3.323613e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+2.014806e+00 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 9.000000e+02 (+0.000000e+00 -2.341813e+02)
Parameter t_shift = 1.000000e+02 (+3.171486e+01 -5.518533e+01)



...................................................................

IRAS-hiflux-fit-error1.sl
Submitted batch job 3958470

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.738432e-05           0       0.001
  2  lag_freq(1).log_mass   0     0          6.17276           6           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              2.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              900           0           0
 15  lag_freq(1).t_shift    0     1              100           0           0

Obsid IRAS_hiflux1_add2016
chi^2 = 3.323613e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+3.239494e+00 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 9.000000e+02 (+0.000000e+00 -2.339626e+02)
Parameter t_shift = 1.000000e+02 (+3.171486e+01 -5.516153e+01)

###################################
###########################


Note: at h3 and g2.4+2.3 I only have:

[so14935@bc4gpulogin1 a0.998]$ cd h02.0+03.0/g2.3+2.1/A01.0/x3.0/p00.0/b02.0/q0.5/
[so14935@bc4gpulogin1 q0.5]$ ls
tmax0700  tmax0740  tmax0780  tmax0820  tmax0860  tmax0900
tmax0720  tmax0760  tmax0800  tmax0840  tmax0880

[so14935@bc4gpulogin1 q0.5]$ cd tmax0900
[so14935@bc4gpulogin1 tmax0900]$ ls
tshift0000  tshift0020  tshift0040  tshift0060  tshift0080  tshift0100  tshift0120
tshift0010  tshift0030  tshift0050  tshift0070  tshift0090  tshift0110

Run blob code for much more at h3 !!!!

----> Run h3 and tmax 100-650 on submit-blob-delta-i64-2.pl submitted 1200hrs 16 Aug

           3959414    serial   reverb  so14935  R       0:27      1 compute079
           3959413    serial   reverb  so14935  R       0:31      1 compute079
           3959412    serial   reverb  so14935  R       0:36      1 compute079
           3959411    serial   reverb  so14935  R       0:41      1 compute079
           3959410    serial   reverb  so14935  R       0:45      1 compute079
           3959409    serial   reverb  so14935  R       0:49      1 compute079
           3959408    serial   reverb  so14935  R       0:53      1 compute078
           3959407    serial   reverb  so14935  R       0:58      1 compute078
           3959406    serial   reverb  so14935  R       1:02      1 compute078
           3959405    serial   reverb  so14935  R       1:06      1 compute077
           3959404    serial   reverb  so14935  R       1:10      1 compute076
           3959403    serial   reverb  so14935  R       1:16      1 compute075
           3959402    serial   reverb  so14935  R       1:21      1 compute073
           3959401    serial   reverb  so14935  R       1:26      1 compute072
           3959400    serial   reverb  so14935  R       1:31      1 compute072
           3959399    serial   reverb  so14935  R       1:34      1 compute071
           3959398    serial   reverb  so14935  R       1:37      1 compute070
           3959397    serial   reverb  so14935  R       1:43      1 compute070
           3959396    serial   reverb  so14935  R       1:48      1 compute068

---> AND h3 and tmax 900 - 1400 on submit-blob-delta-i64-3.pl

           3959425    serial   reverb  so14935 PD       0:00      1 (Priority)
           3959426    serial   reverb  so14935 PD       0:00      1 (Priority)
           3959427    serial   reverb  so14935 PD       0:00      1 (Priority)
           3959428    serial   reverb  so14935 PD       0:00      1 (Priority)
           3959429    serial   reverb  so14935 PD       0:00      1 (Priority)
           3959423    serial   reverb  so14935 PD       0:00      1 (Priority)
           3959424    serial   reverb  so14935 PD       0:00      1 (Priority)
           3959422    serial   reverb  so14935 PD       0:00      1 (Priority)
           3959420    serial   reverb  so14935 PD       0:00      1 (Priority)
           3959421    serial   reverb  so14935 PD       0:00      1 (Priority)
           3959419    serial   reverb  so14935 PD       0:00      1 (Priority)
           3959418    serial   reverb  so14935 PD       0:00      1 (Priority)
           3959417    serial   reverb  so14935 PD       0:00      1 (Resources)
           3959430    serial   reverb  so14935 PD       0:00      1 (Priority)
           3959431    serial   reverb  so14935 PD       0:00      1 (Priority)
           3959432    serial   reverb  so14935 PD       0:00      1 (Priority)
           3959433    serial   reverb  so14935 PD       0:00      1 (Priority)

...................................................................

IRAS-hiflux-fit-error1.sl

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.924183e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.163043         5.9           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1400           0           0
 15  lag_freq(1).t_shift    0     1              100           0           0

Obsid IRAS_hiflux1_add2016
chi^2 = 3.179561e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+2.165662e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.400000e+03 (+0.000000e+00 -7.112583e+02)
Parameter t_shift = 1.000000e+02 (+0.000000e+00 -0.000000e+00)

...................................................................

IRAS-hiflux-fit-error1.sl

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.0, 2.1, 2.2, 2.3, 2.4, 2.6, 2.7, 2.8]; % Gamma1
vals_to_fit[3] = [1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 200.0, 300.0, 400.0, 500.0, 600.0, 700.0, 800.0, 900.0, 1000.0, 1100.0, 1200.0, 13\
00.0, 1400.0, 1500.0, 1600.0, 1640.0, 1700.0, 1740.0, 1780.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [0.0, 5.0, 10.0, 20.0, 25.0, 30.0, 35.0, 40.0, 50.0, 60.0, 70.0, 75.0, 80.0, 85.0, 90.0, \
95.0, 100.0, 110.0, 120.0, 130.0, 140.0]; % t_shift


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.341256e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.158492         5.9           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1740           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid IRAS_hiflux1_add2016
chi^2 = 2.799255e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+1.928132e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.740000e+03 (+0.000000e+00 -1.069471e+03)
Parameter t_shift = 2.000000e+01 (+0.000000e+00 -0.000000e+00)


...................................................................

IRAS-hiflux-fit-error1.sl
Submitted batch job


Note: Many lag.fits files above tmax = 1700 are blank files !!!!

Code will need to be run again to re-create these files once we have the code that will overwite blank files....



##########################
But first - Try lower Tmax range:
#################

IRAS-hiflux-fit-error1.sl
Submitted batch job 3972790

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.0, 2.1, 2.2, 2.3, 2.4, 2.5]; % Gamma1
vals_to_fit[3] = [1.4, 1.6, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 150.0, 200.0, 250.0, 300.0, 350.0, 400.0, 450.0, 500.0, 550.0, 600.0, 700.0, 800.0];% t_max (zero doesn't seem to work)
vals_to_fit[10] = [10.0, 15.0, 20.0, 25.0, 30.0, 35.0, 40.0, 50.0, 60.0, 70.0, 75.0, 80.0, 85.0, 90.0, 95.0, 100.0, 110.0, 120.0, 130.0, 140.0]; % t_shift

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.775364e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.210684           6           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.1           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              800           0           0
 15  lag_freq(1).t_shift    0     1               90           0           0

Obsid IRAS_hiflux1_add2016
chi^2 = 3.504402e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+3.651057e+00 -0.000000e+00)
Parameter Gamma1 = 2.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.900000e+00 (+0.000000e+00 -1.266160e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 8.000000e+02 (+0.000000e+00 -2.205265e+02)
Parameter t_shift = 9.000000e+01 (+3.216960e+01 -4.417070e+01)



This is not working out at all -- too many corrupt files

.......................................................................................

##################################################################
##################################################################
####                                                         #####
####  New fits after lag.fits file deletion and re-creation  #####
####                                                         #####
##################################################################
##################################################################


IRAS-hiflux-fit-error1.sl

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.858543e-05           0       0.001
  2  lag_freq(1).log_mass   0     0          6.17846         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1                2           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              900           0           0
 15  lag_freq(1).t_shift    0     1              100           0           0


Obsid IRAS_hiflux1_add2016
chi^2 = 3.253188e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+0.000000e+00 -1.908690e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 9.000000e+02 (+0.000000e+00 -3.998217e+02)
Parameter t_shift = 1.000000e+02 (+0.000000e+00 -5.280093e+01)

......................................................................................

IRAS-hiflux-fit-error1.sl
Submitted batch job 3992907

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.683048e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.129197         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1                2           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1000           0           0
 15  lag_freq(1).t_shift    0     1              110           0           0


Obsid IRAS_hiflux1_add2016
chi^2 = 3.234967e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+0.000000e+00 -1.908718e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.000000e+03 (+0.000000e+00 -3.010637e+02)
Parameter t_shift = 1.100000e+02 (+0.000000e+00 -0.000000e+00)


......................................................................................

IRAS-hiflux-fit-error1.sl

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.776655e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.094376         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1                2           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1100           0           0
 15  lag_freq(1).t_shift    0     1              120           0           0



Obsid IRAS_hiflux1_add2016
chi^2 = 3.165336e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+0.000000e+00 -1.908825e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.100000e+03 (+0.000000e+00 -4.052923e+02)
Parameter t_shift = 1.200000e+02 (+0.000000e+00 -0.000000e+00)


......................................................................................

IRAS-hiflux-fit-error1.sl

Submitted batch job 4038662

......................................................................................

IRAS-hiflux-fit-error1.sl



#+END_EXAMPLE



#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/

*** Lo counts lc <20 cts $s^{-1}$

PATH = =IRAS-lo-cts-lc-data.sl=

#+BEGIN_EXAMPLE
job 3971783

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.305769e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.149353         6.1           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1000           0           0
 15  lag_freq(1).t_shift    0     1               60           0           0

Obsid IRAS_lo_cts_lc_data
chi^2 = 4.819637e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+8.745760e-01 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.000000e+03 (+0.000000e+00 -3.623248e+02)
Parameter t_shift = 6.000000e+01 (+5.141428e+01 -4.536378e+01)

......................................

IRAS-lo-cts-lc-data.sl
Submitted batch job 3972029

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.294549e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.148917         6.1           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1020           0           0
 15  lag_freq(1).t_shift    0     1               60           0           0


Obsid IRAS_lo_cts_lc_data
chi^2 = 4.810649e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+2.760364e-02 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.020000e+03 (+2.760364e-01 -0.000000e+00)
Parameter t_shift = 6.000000e+01 (+5.520728e-02 -1.944793e+00)

.....................................

IRAS-lo-cts-lc-data.sl
Submitted batch job 3991111

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0]; % h2
vals_to_fit[2] = [2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7]; % Gamma1
vals_to_fit[3] = [1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 200.0, 300.0, 400.0, 500.0, 600.0, 700.0, 800.0, 900.0, 1000.0];% t_max (zero doesn't seem t\
o work)
vals_to_fit[10] = [0.0, 10.0, 20.0, 30.0, 40.0, 50.0, 55.0, 60.0, 70.0, 75.0, 80.0, 85.0, 90.0, 100.0]; % t_shift
variable fit_stats;


.......................................................................................

##################################################################
##################################################################
####                                                         #####
####  New fits after lag.fits file deletion and re-creation  #####
####                                                         #####
##################################################################
##################################################################



IRAS-lo-cts-lc-data.sl

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.650466e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.179877         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              900           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid IRAS_lo_cts_lc_data
chi^2 = 4.575417e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 9.000000e+02 (+0.000000e+00 -2.679079e+02)
Parameter t_shift = 2.000000e+01 (+5.010337e+01 -8.417094e-01)


......................................

IRAS-lo-cts-lc-data.sl
4015737

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.039325e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.073369         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                8           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1200           0           0
 15  lag_freq(1).t_shift    0     1               70           0           0



 Obsid IRAS_lo_cts_lc_data
chi^2 = 4.237508e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 8.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.200000e+03 (+0.000000e+00 -4.064296e+02)
Parameter t_shift = 7.000000e+01 (+1.372160e-01 -5.198534e+01)


......................................

IRAS-lo-cts-lc-data.sl
Submitted batch job 4038663



......................................

IRAS-lo-cts-lc-data.sl


#+END_EXAMPLE

*** Hi counts lc >20 cts $s^{-1}$

PATH = =IRAS-hi-cts-lc-data.sl=

#+BEGIN_EXAMPLE
IRAS-hi-cts-lc-data.sl

vals_to_fit[0] = [2.0]; % h1
%vals_to_fit[1] = [3.0, 4.0, 5.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[1] = [3.0, 4.0]; % h2
vals_to_fit[2] = [2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8]; % Gamma1
vals_to_fit[3] = [2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 200.0, 300.0, 400.0, 500.0, 600.0, 700.0, 800.0, 900.0, 1000.0];% t_max (zero doesn't seem t\
o work)
vals_to_fit[10] = [10.0, 20.0, 25.0, 30.0, 40.0, 50.0, 55.0, 60.0, 65.0, 70.0, 75.0, 80.0, 85.0, 90.0, 100.0, 110.0];\
 % t_shift


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.722251e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.149228         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              900           0           0
 15  lag_freq(1).t_shift    0     1              100           0           0


Obsid IRAS_hi_cts_lc_data
chi^2 = 2.696067e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -2.781393e-02)
Parameter Gamma2 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+6.103044e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 9.000000e+02 (+0.000000e+00 -2.141339e+02)
Parameter t_shift = 1.000000e+02 (+2.104947e-01 -1.489729e+01)

.....................................................................

IRAS-hi-cts-lc-data.sl
Submitted batch job


###############################################
Copy fit to Lyra and WWW:

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/IRAS13224-3809/IRAS_hi_cts_lc_data_best_fit.ps .

ps2pdf IRAS_hi_cts_lc_data_best_fit.ps
pdftocairo -png IRAS_hi_cts_lc_data_best_fit.pdf
cp IRAS_hi_cts_lc_data_best_fit-1.png /home/WWW/steff/ecm


.......................................................................................

##################################################################
##################################################################
####                                                         #####
####  New fits after lag.fits file deletion and re-creation  #####
####                                                         #####
##################################################################
##################################################################


IRAS-hi-cts-lc-data.sl

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.722251e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.149228         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              900           0           0
 15  lag_freq(1).t_shift    0     1              100           0           0



Obsid IRAS_hi_cts_lc_data
chi^2 = 2.696067e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -2.781393e-02)
Parameter Gamma2 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+6.103044e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 9.000000e+02 (+0.000000e+00 -2.141339e+02)
Parameter t_shift = 1.000000e+02 (+2.104947e-01 -1.489729e+01)


.................................................................................................

IRAS-hi-cts-lc-data.sl
Submitted batch job 3992910


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.448434e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.109287         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              2.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1000           0           0
 15  lag_freq(1).t_shift    0     1              110           0           0


Obsid IRAS_hi_cts_lc_data
chi^2 = 2.613074e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -1.252637e-01)
Parameter Gamma2 = 2.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+5.990906e-01 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.000000e+03 (+0.000000e+00 -3.177291e+02)
Parameter t_shift = 1.100000e+02 (+0.000000e+00 -2.490052e+01)

.................................................................................................

IRAS-hi-cts-lc-data.sl
Submitted batch job 4038664


.................................................................................................

IRAS-hi-cts-lc-data.sl


#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_hi_cts_lc_data_best_fit-1.png


*** OBS 0110890101 (2002) 61 ks

Use script =/homeb/steff075/phd_ecm/IRAS13224-3809/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
Freq,+-,Lag,+-
7.272727e-05,2.272727e-05,1.029471e+03,3.654683e+02
1.388430e-04,4.338843e-05,1.820973e+02,2.614657e+02
2.650639e-04,8.283246e-05,-5.302168e+01,8.644067e+01
5.060310e-04,1.581347e-04,9.587622e+01,6.301444e+01
9.660592e-04,3.018935e-04,-1.811446e+01,2.483539e+01
1.844295e-03,5.763421e-04,-8.880375e+00,1.143634e+01
3.520927e-03,1.100290e-03,9.500845e+00,4.779324e+00
#+END_EXAMPLE

saved in =lagvalues_0110890101.csv=

saved in =lagvalues_0110890101_2.csv=

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0110890101_lagfreq.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0110890101-time-lags.fits");
r=load_rmf("IRAS13224-3809-0110890101-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

*ECM Fits*

#+BEGIN_EXAMPLE
IRAS-0110890101-fit-error.sl
Submitted batch job 3975972

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7]; % Gamma1
vals_to_fit[3] = [1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 150.0, 200.0, 250.0, 300.0, 350.0, 400.0, 450.0, 500.0, 600.0, 800.0, 1200.0, \
1800.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [0.0, 10.0, 20.0, 20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0, 110.0, 120.0\
]; % t_shift

Improved fit...
ffopen could not interpret primary array header of file:
/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/lag-files/i64/a0.998
/h02.0+09.0/g2.2+2.2/A01.0/x0.0/p00.0/b01.0/q0.5/tmax0350/tshift0000/lag.fits
tried to move past end of file: /mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/lag-files/i\
64/a0.998/h02.0+09.0/g2.2+2.2/A01.0/x0.0/p00.0/b01.0/q0.5/tmax0350/tshift0000/lag.fits^M
/mnt/storage/scratch/so14935/isis/1.6.2/share/fits.sl:123:fits_check_error:Fits Error
Error: function evaluation failed^M
Traceback: _mode_switch
Traceback: _fit
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.308524e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.438704           6           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              350           0           0
 15  lag_freq(1).t_shift    0     1                0           0           0


.......................................................................................

##################################################################
##################################################################
####                                                         #####
####  New fits after lag.fits file deletion and re-creation  #####
####                                                         #####
##################################################################
##################################################################

IRAS-0110890101-fit-error.sl

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     9.397232e-05           0       0.001
  2  lag_freq(1).log_mass   0     0          6.35405         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              100           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0


Obsid IRAS_0110890101
chi^2 = 7.944319e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+7.432785e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.000000e+02 (+5.992862e+01 -0.000000e+00)
Parameter t_shift = 1.000000e+01 (+3.961240e+01 -0.000000e+00)

.......................................................................................


IRAS-0110890101-fit-error.sl
job 3993134

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.316313e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.434732         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              700           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0


Obsid IRAS_0110890101
chi^2 = 3.562258e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -2.062128e-01)
Parameter Gamma2 = 1.800000e+00 (+7.420906e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 7.000000e+02 (+0.000000e+00 -4.668073e+02)
Parameter t_shift = 3.000000e+01 (+3.769677e+01 -0.000000e+00)

.......................................................................................

IRAS-0110890101-fit-error.sl
Submitted batch job 3998622


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.170085e-05           0       0.001
  2  lag_freq(1).log_mass   0     0          6.42163         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                8           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                1           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0


Obsid IRAS_0110890101
chi^2 = 3.066014e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 8.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -2.172230e-01)
Parameter Gamma2 = 1.800000e+00 (+7.300053e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.000000e+02 (+0.000000e+00 -2.871777e+02)
Parameter t_shift = 3.000000e+01 (+3.960207e+01 -0.000000e+00)
.......................................................................................

IRAS-0110890101-fit-error.sl


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.041027e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.381783         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               11           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              600           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0

Obsid IRAS_0110890101
chi^2 = 2.457313e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.100000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -1.110534e-01)
Parameter Gamma2 = 1.800000e+00 (+7.155110e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.000000e+02 (+0.000000e+00 -2.251288e+02)
Parameter t_shift = 3.000000e+01 (+5.315154e+01 -0.000000e+00)

.............................................................................

Submitted batch job 4030236

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.697497e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.284216           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               18           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              700           0           0
 15  lag_freq(1).t_shift    0     1               40           0           0

Obsid IRAS_0110890101
chi^2 = 1.044330e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.800000e+01 (+0.000000e+00 -1.425645e+01)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.716024e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 7.000000e+02 (+0.000000e+00 -2.281689e+02)
Parameter t_shift = 4.000000e+01 (+2.545147e+01 -3.945973e+01)

source("confidence.sl");

lag_freq(1).log_mass,6.284216e+00,+1.830577e-02,-1.843474e-02

#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0110890101_best_fit-1.png

*** OBS 0673580101 (2011) 49 ks

Use script =/homeb/steff075/phd_ecm/IRAS13224-3809/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
Freq,+-,Lag,+-
1.163636e-04,3.636364e-05,3.562002e+02,1.323744e+02
2.221488e-04,6.942149e-05,-1.266549e+02,2.022130e+02
4.241022e-04,1.325319e-04,-1.651821e+02,6.190456e+01
8.096496e-04,2.530155e-04,2.932161e+00,3.715238e+01
1.545695e-03,4.830296e-04,4.810878e+00,1.303665e+01
2.950872e-03,9.221474e-04,-2.248954e+00,6.717099e+00
5.633482e-03,1.760463e-03,-2.286225e+00,2.979585e+00
#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0673580101_lagfreq.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0673580101-time-lags.fits");
r=load_rmf("IRAS13224-3809-0673580101-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

*ECM Fits*

#+BEGIN_EXAMPLE
IRAS-0673580101-fit-error.sl
Submitted batch job 3975975


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7]; % Gamma1
vals_to_fit[3] = [1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 150.0, 200.0, 250.0, 300.0, 350.0, 400.0, 450.0, 500.0, 600.0, 800.0, 1200.0, \
1800.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [0.0, 10.0, 20.0, 20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0, 110.0, 120.0\
]; % t_shift

ffopen could not interpret primary array header of file:
/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/lag-files/i64/a0.998
/h02.0+09.0/g2.2+2.2/A01.0/x0.0/p00.0/b01.0/q0.5/tmax0350/tshift0000/lag.fits
tried to move past end of file: /mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/lag-files/i\
64/a0.998/h02.0+09.0/g2.2+2.2/A01.0/x0.0/p00.0/b01.0/q0.5/tmax0350/tshift0000/lag.fits^M
/mnt/storage/scratch/so14935/isis/1.6.2/share/fits.sl:123:fits_check_error:Fits Error
Error: function evaluation failed^M
Traceback: _mode_switch
Traceback: _fit
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.408452e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.741268           6           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               10           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1                0           0           0



.......................................................................................

##################################################################
##################################################################
####                                                         #####
####  New fits after lag.fits file deletion and re-creation  #####
####                                                         #####
##################################################################
##################################################################

IRAS-0673580101-fit-error.sl

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.483704e-06           0       0.001
  2  lag_freq(1).log_mass   0     0         6.489944         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1              100           0           0

Obsid IRAS_0673580101
chi^2 = 2.201101e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+0.000000e+00 -1.295778e+02)
Parameter t_shift = 1.000000e+02 (+0.000000e+00 -3.560765e+01)

.......................................................................................

IRAS-0673580101-fit-error.sl
job 3993137

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.615637e-06           0       0.001
  2  lag_freq(1).log_mass   0     0         6.444454         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1              110           0           0


Obsid IRAS_0673580101
chi^2 = 1.757639e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+4.905366e+02 -1.568000e+02)
Parameter t_shift = 1.100000e+02 (+0.000000e+00 -3.339040e+01)


........................................................................
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     8.536919e-06           0       0.001
  2  lag_freq(1).log_mass   0     0         6.415502         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                9           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1              120           0           0


Obsid IRAS_0673580101
chi^2 = 6.904432e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 9.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+0.000000e+00 -1.315994e+02)
Parameter t_shift = 1.200000e+02 (+0.000000e+00 -4.785236e+01)

.............................................................


ag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.069013e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.840598           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0


Obsid IRAS_0673580101
chi^2 = 2.209015e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 1.000000e+01 (+0.000000e+00 -0.000000e+00)

lag_freq(1).log_mass,6.840598e+00,+2.847301e-02,-3.370104e-02

#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0673580101_best_fit-1.png

*** OBS 0673580201 (2011) 99 ks

Use script =/homeb/steff075/phd_ecm/IRAS13224-3809/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
Freq,+-,Lag,+-
7.272727e-05,2.272727e-05,6.116706e+02,3.001014e+02
1.388430e-04,4.338843e-05,4.067131e+02,1.492622e+02
2.650639e-04,8.283246e-05,6.201421e+01,1.091642e+02
5.060310e-04,1.581347e-04,1.210218e+01,4.559140e+01
9.660592e-04,3.018935e-04,-6.288922e+00,2.003334e+01
1.844295e-03,5.763421e-04,-6.077008e+01,3.192267e+01
3.520927e-03,1.100290e-03,-7.994944e+00,1.434831e+01
#+END_EXAMPLE

saved =lagvalues_0673580201.csv=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0673580201_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0673580201-time-lags.fits");
r=load_rmf("IRAS13224-3809-0673580201-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

*ECM Fits*

#+BEGIN_EXAMPLE
IRAS-0673580201-fit-error.sl
Submitted batch job 3975978

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7]; % Gamma1
vals_to_fit[3] = [1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 150.0, 200.0, 250.0, 300.0, 350.0, 400.0, 450.0, 500.0, 600.0, 800.0, 1200.0, \
1800.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [0.0, 10.0, 20.0, 20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0, 110.0, 120.0\
]; % t_shift

ffopen could not interpret primary array header of file:
/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/lag-files/i64/a0.998
/h02.0+09.0/g2.2+2.2/A01.0/x0.0/p00.0/b01.0/q0.5/tmax0350/tshift0000/lag.fits
tried to move past end of file: /mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/lag-files/i\
64/a0.998/h02.0+09.0/g2.2+2.2/A01.0/x0.0/p00.0/b01.0/q0.5/tmax0350/tshift0000/lag.fits^M
/mnt/storage/scratch/so14935/isis/1.6.2/share/fits.sl:123:fits_check_error:Fits Error
Error: function evaluation failed^M
Traceback: _mode_switch
Traceback: _fit
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      1.71355e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.309443           6           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1                0           0           0

.......................................................................................

##################################################################
##################################################################
####                                                         #####
####  New fits after lag.fits file deletion and re-creation  #####
####                                                         #####
##################################################################
##################################################################

IRAS-0673580201-fit-error.sl


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      4.43717e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.282197         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0


Obsid IRAS_0673580201
chi^2 = 1.402831e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+0.000000e+00 -2.965200e+02)
Parameter t_shift = 3.000000e+01 (+0.000000e+00 -0.000000e+00)

lag_freq(1).log_mass,6.282197e+00,+7.725447e-02,-9.917199e-02

#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0673580201_best_fit-1.png

*** OBS 0673580301 (2011) 82 ks

Use script =/homeb/steff075/phd_ecm/IRAS13224-3809/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
Freq,+-,Lag,+-
7.272727e-05,2.272727e-05,3.648642e+02,4.066856e+02
1.388430e-04,4.338843e-05,2.799550e+02,1.756290e+02
2.650639e-04,8.283246e-05,8.226428e+01,8.336178e+01
5.060310e-04,1.581347e-04,-7.741598e+00,4.434704e+01
9.660592e-04,3.018935e-04,-7.135680e+01,2.055614e+01
1.844295e-03,5.763421e-04,-1.585661e+01,9.490610e+00
3.520927e-03,1.100290e-03,3.828762e+00,4.281605e+00
#+END_EXAMPLE


saved =lagvalues_0673580301.csv=

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0673580301_lagfreq.gif


Note - may need to recalculate lags in scratch3 to obtain hugh freq
lags at 0

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0673580301-time-lags.fits");
r=load_rmf("IRAS13224-3809-0673580301-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

*ECM Fits*

#+BEGIN_EXAMPLE
IRAS-0673580301-fit-error.sl
Submitted batch job 3975979
vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7]; % Gamma1
vals_to_fit[3] = [1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 150.0, 200.0, 250.0, 300.0, 350.0, 400.0, 450.0, 500.0, 600.0, 800.0, 1200.0, \
1800.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [0.0, 10.0, 20.0, 20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0, 110.0, 120.0\
]; % t_shift

Improved fit...
ffopen could not interpret primary array header of file:
/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/lag-files/i64/a0.998
/h02.0+09.0/g2.2+2.2/A01.0/x0.0/p00.0/b01.0/q0.5/tmax0350/tshift0000/lag.fits
tried to move past end of file: /mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/lag-files/i\
64/a0.998/h02.0+09.0/g2.2+2.2/A01.0/x0.0/p00.0/b01.0/q0.5/tmax0350/tshift0000/lag.fits^M
/mnt/storage/scratch/so14935/isis/1.6.2/share/fits.sl:123:fits_check_error:Fits Error
Error: function evaluation failed^M
Traceback: _mode_switch
Traceback: _fit
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.957242e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.321108           6           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                8           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              150           0           0
 15  lag_freq(1).t_shift    0     1                0           0           0



.......................................................................................

##################################################################
##################################################################
####                                                         #####
####  New fits after lag.fits file deletion and re-creation  #####
####                                                         #####
##################################################################
##################################################################

IRAS-0673580301-fit-error.sl


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     7.354208e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.463992         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              100           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0


Obsid IRAS_0673580301
chi^2 = 6.854710e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 1.000000e+01 (+7.843930e+01 -0.000000e+00)

--------------------------------------------------------------------------------
IRAS-0673580301-fit-error.sl
job 3993140

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.339392e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.496701         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0


Obsid IRAS_0673580301
chi^2 = 2.082676e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 3.000000e+01 (+7.077584e+01 -1.520621e+01)

--------------------------------------------------------------------------------
IRAS-0673580301-fit-error.sl


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      1.86604e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.360978         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                8           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               60           0           0



Obsid IRAS_0673580301
chi^2 = 2.051518e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 8.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 6.000000e+01 (+0.000000e+00 -4.402512e+01)


--------------------------------------------------------------------------------
IRAS-0673580301-fit-error.sl

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.302851e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.512912           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0


Obsid IRAS_0673580301
chi^2 = 1.599501e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 3.000000e+01 (+0.000000e+00 -1.364387e+01)

lag_freq(1).log_mass,6.512912e+00,+6.316255e-02,-6.450951e-02

#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0673580301_best_fit-1.png

*** OBS 0673580401 (2011) 113 ks

Use script =/homeb/steff075/phd_ecm/IRAS13224-3809/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
Freq,+-,Lag,+-



#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0673580401_lag-freq.PNG

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0673580401-time-lags.fits");
r=load_rmf("IRAS13224-3809-0673580401-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

*ECM Fits*

#+BEGIN_EXAMPLE
IRAS-0673580401-fit-error.sl
Submitted batch job 3975980


vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7]; % Gamma1
vals_to_fit[3] = [1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [100.0, 150.0, 200.0, 250.0, 300.0, 350.0, 400.0, 450.0, 500.0, 600.0, 800.0, 1200.0, \
1800.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [0.0, 10.0, 20.0, 20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0, 110.0, 120.0\
]; % t_shift

Improved fit...
ffopen could not interpret primary array header of file:
/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/lag-files/i64/a0.998
/h02.0+09.0/g2.2+2.2/A01.0/x0.0/p00.0/b01.0/q0.5/tmax0350/tshift0000/lag.fits
tried to move past end of file: /mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/lag-files/i\
64/a0.998/h02.0+09.0/g2.2+2.2/A01.0/x0.0/p00.0/b01.0/q0.5/tmax0350/tshift0000/lag.fits^M
/mnt/storage/scratch/so14935/isis/1.6.2/share/fits.sl:123:fits_check_error:Fits Error
Error: function evaluation failed^M
Traceback: _mode_switch
Traceback: _fit
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.995382e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.497553           6           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              350           0           0
 15  lag_freq(1).t_shift    0     1                0           0           0



.......................................................................................

##################################################################
##################################################################
####                                                         #####
####  New fits after lag.fits file deletion and re-creation  #####
####                                                         #####
##################################################################
##################################################################

IRAS-0673580401-fit-error.sl


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      1.14348e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.417218         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1              100           0           0

Obsid IRAS_0673580401
chi^2 = 5.357437e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+8.985962e+01 -1.910354e+02)
Parameter t_shift = 1.000000e+02 (+0.000000e+00 -3.559102e-01)

................................................................


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.017792e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.407924         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               13           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0



Obsid IRAS_0673580401
chi^2 = 2.516717e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.300000e+01 (+0.000000e+00 -2.222798e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -2.346833e-02)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.000000e+02 (+2.922565e+02 -1.174403e+02)
Parameter t_shift = 2.000000e+01 (+2.081521e+01 -4.046694e-02)

lag_freq(1).log_mass,6.407924e+00,+3.843723e-02,-6.110201e-02


..................................................................


job 4069745


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.811289e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.410157           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               13           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0



Obsid IRAS_0673580401
chi^2 = 2.199627e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.300000e+01 (+0.000000e+00 -3.516606e-01)
Parameter Gamma1 = 2.300000e+00 (+2.206560e-01 -1.404983e-01)
Parameter Gamma2 = 1.800000e+00 (+3.135116e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -5.273151e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.000000e+02 (+2.502657e+02 -2.840495e+01)
Parameter t_shift = 2.000000e+01 (+2.620513e+00 -5.122515e+00)

lag_freq(1).log_mass,6.410157e+00,+3.099686e-02,-4.283500e-02


..........................................................................


#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0673580401_best_fit-1.png

*** OBS 0780560101 (2016) 141.3 ks

Use script =/homeb/steff075/phd_ecm/IRAS13224-3809/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
Freq,+-,Lag,+-
7.272727e-05,2.272727e-05,1.269423e+03,1.627447e+02
1.388430e-04,4.338843e-05,2.427442e+02,1.643634e+02
2.650639e-04,8.283246e-05,1.156089e+02,1.623174e+02
5.060310e-04,1.581347e-04,4.325295e+01,8.552045e+01
9.660592e-04,3.018935e-04,-3.279382e+01,4.673915e+01
1.844295e-03,5.763421e-04,8.677422e+00,2.766049e+01
3.520927e-03,1.100290e-03,-1.231555e+01,1.275736e+01
#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0780560101_lagfreq.gif


*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0780560101-time-lags.fits");
r=load_rmf("IRAS13224-3809-0780560101-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

*ECM Fits*

#+BEGIN_EXAMPLE
IRAS-0780560101-fit-error.sl
job 3992001


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.379365e-05           0       0.001
  2  lag_freq(1).log_mass   0     0          6.21875         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1000           0           0
 15  lag_freq(1).t_shift    0     1               70           0           0

Obsid IRAS_0780560101
chi^2 = 7.490916e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.000000e+03 (+0.000000e+00 -6.702333e+02)
Parameter t_shift = 7.000000e+01 (+0.000000e+00 -0.000000e+00)

................................................................

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.126821e-05           0       0.001
  2  lag_freq(1).log_mass   0     0              6.5         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               13           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0



Obsid IRAS_0780560101
chi^2 = 6.680066e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.300000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.000000e+02 (+0.000000e+00 -1.438770e+02)
Parameter t_shift = 3.000000e+01 (+0.000000e+00 -0.000000e+00)

.............................................................


Obsid IRAS_0780560101
chi^2 = 6.510386e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.400000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 7.000000e+02 (+0.000000e+00 -3.444331e+02)
Parameter t_shift = 3.000000e+01 (+0.000000e+00 -0.000000e+00)


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.581511e-05           0       0.001
  2  lag_freq(1).log_mass   0     0              6.5         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               14           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              700           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0


.............................................................

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.537168e-05           0       0.001
  2  lag_freq(1).log_mass   0     0              6.5         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               14           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              700           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0


Obsid IRAS_0780560101
chi^2 = 6.422634e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.400000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 7.000000e+02 (+0.000000e+00 -3.371059e+02)
Parameter t_shift = 3.000000e+01 (+0.000000e+00 -0.000000e+00)
.....................................................................

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.326137e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.448589           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               20           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              600           0           0
 15  lag_freq(1).t_shift    0     1               40           0           0


Obsid IRAS_0780560101
chi^2 = 4.884470e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 2.000000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.000000e+02 (+0.000000e+00 -4.782918e+02)
Parameter t_shift = 4.000000e+01 (+0.000000e+00 -0.000000e+00)

lag_freq(1).log_mass,6.448589e+00,+1.016101e-01,-9.522081e-02


#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0780560101_best_fit-1.png

*** OBS 0780561301 (2016) 141.0 ks

Use script =/homeb/steff075/phd_ecm/IRAS13224-3809/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
Freq,+-,Lag,+-
7.272727e-05,2.272727e-05,1.638784e+03,4.524682e+02
1.388430e-04,4.338843e-05,1.794741e+02,2.517742e+02
2.650639e-04,8.283246e-05,1.167942e+02,6.919995e+01
5.060310e-04,1.581347e-04,6.795602e+00,2.561006e+01
9.660592e-04,3.018935e-04,-1.248903e+01,1.418590e+01
1.844295e-03,5.763421e-04,-5.354604e+01,1.592970e+01
3.520927e-03,1.100290e-03,7.612012e+00,4.102625e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0780561301_lagfreq.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0780561301-time-lags.fits");
r=load_rmf("IRAS13224-3809-0780561301-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

*ECM Fits*

#+BEGIN_EXAMPLE
IRAS-0780561301-fit-error.sl
job 3992004

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.031108e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.354846         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              700           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0


Obsid IRAS_0780561301
chi^2 = 5.494634e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.559343e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 7.000000e+02 (+0.000000e+00 -2.136871e+02)
Parameter t_shift = 3.000000e+01 (+2.590758e+01 -1.758912e+01)

lag_freq(1).log_mass,6.354846e+00,+3.685646e-02,-5.047479e-02

...................................................................



#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0780561301_best_fit-1.png

*** OBS 0780561401 (2016) 138 ks

Use script =/homeb/steff075/phd_ecm/IRAS13224-3809/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
Freq,+-,Lag,+-
7.272727e-05,2.272727e-05,1.841604e+02,3.565511e+02
1.388430e-04,4.338843e-05,-5.700524e+02,2.312511e+02
2.650639e-04,8.283246e-05,-1.268680e+02,5.724855e+01
5.060310e-04,1.581347e-04,-7.506918e+01,5.446237e+01
9.660592e-04,3.018935e-04,-6.857855e+01,1.875087e+01
1.844295e-03,5.763421e-04,-8.338293e+00,1.747171e+01
3.520927e-03,1.100290e-03,-1.881241e+01,1.127924e+01
#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_lagfreq_0780561401.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0780561401-time-lags.fits");
r=load_rmf("IRAS13224-3809-0780561401-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

*ECM Fits*

#+BEGIN_EXAMPLE
IRAS-0780561401-fit-error.sl

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.822659e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.188848         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.1           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1000           0           0
 15  lag_freq(1).t_shift    0     1                0           0           0



Obsid IRAS_0780561401
chi^2 = 4.620757e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.000000e+03 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 0.000000e+00 (+0.000000e+00 -0.000000e+00)

................................................................................

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      2.73584e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.446197         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               13           0           0
  7  lag_freq(1).Gamma1     0     1              2.1           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              600           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid IRAS_0780561401
chi^2 = 3.924172e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.300000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 2.000000e+01 (+0.000000e+00 -0.000000e+00)



................................................................

Submitted batch job 4027920

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.312569e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.475376         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               14           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              600           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid IRAS_0780561401
chi^2 = 3.252289e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.400000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.000000e+02 (+0.000000e+00 -1.108572e+02)
Parameter t_shift = 2.000000e+01 (+0.000000e+00 -0.000000e+00)


................................................................


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      2.67638e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.728856           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               16           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Obsid IRAS_0780561401
chi^2 = 2.015880e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.600000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+0.000000e+00 -2.341753e+01)
Parameter t_shift = 2.000000e+01 (+1.776573e+01 -0.000000e+00)

lag_freq(1).log_mass,6.728856e+00,+4.478873e-02,-4.323738e-02

...............................................................

Submitted batch job 4076138


#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0780561401_best_fit-1.png

*** OBS 0780561501 (2016) 140.8 ks

Use script =/homeb/steff075/phd_ecm/IRAS13224-3809/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
Freq,+-,Lag,+-
7.272727e-05,2.272727e-05,7.088167e+02,3.041683e+02
1.388430e-04,4.338843e-05,-8.908887e+01,2.219214e+02
2.650639e-04,8.283246e-05,2.566073e+02,8.289773e+01
5.060310e-04,1.581347e-04,-1.195614e+01,4.033574e+01
9.660592e-04,3.018935e-04,-2.387348e+01,1.758976e+01
1.844295e-03,5.763421e-04,-1.937254e+01,8.444724e+00
3.520927e-03,1.100290e-03,-7.344632e+00,3.362258e+00
#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0780561501_lagfreq.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0780561501-time-lags.fits");
r=load_rmf("IRAS13224-3809-0780561501-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

*ECM Fits*

#+BEGIN_EXAMPLE
IRAS-0780561501-fit-error.sl
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001551146           0       0.001
  2  lag_freq(1).log_mass   0     0         6.111687         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid IRAS_0780561501
chi^2 = 4.240106e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+0.000000e+00 -1.535021e+02)
Parameter t_shift = 2.000000e+01 (+0.000000e+00 -0.000000e+00)

..............................................................



lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001750514           0       0.001
  2  lag_freq(1).log_mass   0     0              5.8         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               11           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              600           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0

Obsid IRAS_0780561501
chi^2 = 4.194955e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.100000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.000000e+02 (+0.000000e+00 -4.546022e+02)
Parameter t_shift = 5.000000e+01 (+0.000000e+00 -0.000000e+00)

................................................................................

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0002322504           0       0.001
  2  lag_freq(1).log_mass   0     0         5.618182         5.5         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               12           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              900           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0



Obsid IRAS_0780561501
chi^2 = 4.104117e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.200000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 9.000000e+02 (+0.000000e+00 -7.568155e+02)
Parameter t_shift = 8.000000e+01 (+0.000000e+00 -0.000000e+00)

.............................................................

Submitted batch job 4030235

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0003100277           0       0.001
  2  lag_freq(1).log_mass   0     0         5.481277           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               16           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1200           0           0
 15  lag_freq(1).t_shift    0     1              100           0           0


Obsid IRAS_0780561501
chi^2 = 4.093118e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.600000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.200000e+03 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 1.000000e+02 (+0.000000e+00 -0.000000e+00)

refit Tmax > 1200 for this par range????????

..........................................................................

job 4069731

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     0.0001930105           0       0.001
  2  lag_freq(1).log_mass   0     0         5.486272           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               14           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1300           0           0
 15  lag_freq(1).t_shift    0     1               40           0           0


Obsid IRAS_0780561501
chi^2 = 4.016239e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.400000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -5.447261e-01)
Parameter Gamma2 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.300000e+03 (+0.000000e+00 -1.170744e+03)
Parameter t_shift = 4.000000e+01 (+0.000000e+00 -0.000000e+00)

....................................................................................

Submitted batch job 4076128


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.081378e-05           0       0.001
  2  lag_freq(1).log_mass   0     0          6.18254           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1100           0           0
 15  lag_freq(1).t_shift    0     1              120           0           0


Obsid IRAS_0780561501
chi^2 = 2.597843e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -8.961119e-01)
Parameter Gamma2 = 2.500000e+00 (+0.000000e+00 -8.912938e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.100000e+03 (+0.000000e+00 -9.786856e+02)
Parameter t_shift = 1.200000e+02 (+0.000000e+00 -2.056132e+01)

Running blob for higher t-shift and finer tmax

my $tmax_low = 1000.0;
my $tmax_high = 1200.0;
my $tmax_delta = 50.0;
# "q" is the time shift between first and second source
my $tshift_low = 120.0;
my $tshift_high = 150.0;
my $tshift_delta = 10.0;


IRAS-0780561501-fit-error.sl

ag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      1.88582e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.169053           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1200           0           0
 15  lag_freq(1).t_shift    0     1              140           0           0

Obsid IRAS_0780561501
chi^2 = 1.606650e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -2.108686e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.200000e+03 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 1.400000e+02 (+0.000000e+00 -0.000000e+00)


Interesting that tshift is highest yet !!!!

So just for intereset -

now running  submit-blob-delta.pl

for tmax 1200 - 1600 (50)
  tshift 120 -170 (5)


Submitted batch job 4089719




#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0780561501_best_fit-1.png

*** OBS 0780561601 (2016) 140.8 ks

Use script =/homeb/steff075/phd_ecm/IRAS13224-3809/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
Freq,+-,Lag,+-

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0780561601_lagfreq.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0780561601-time-lags.fits");
r=load_rmf("IRAS13224-3809-0780561601-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

*ECM Fits*

#+BEGIN_EXAMPLE
IRAS-0780561601-fit-error.sl

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      5.08006e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.159285         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1000           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Obsid IRAS_0780561601
chi^2 = 4.387551e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.546031e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.000000e+03 (+0.000000e+00 -3.289169e+02)
Parameter t_shift = 2.000000e+01 (+1.730534e+01 -1.380260e+00)


.................................................................



Obsid IRAS_0780561601
chi^2 = 3.829838e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+2.409717e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.563017e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.000000e+03 (+0.000000e+00 -2.113488e+02)
Parameter t_shift = 2.000000e+01 (+1.765634e+01 -2.680590e+00)

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.708365e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.139041         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1000           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

............................................................................

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.865604e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.042163           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                8           0           0
  7  lag_freq(1).Gamma1     0     1                2           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1300           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0

Obsid IRAS_0780561601
chi^2 = 2.223936e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 8.000000e+00 (+1.245323e+00 -4.378713e+00)
Parameter Gamma1 = 2.000000e+00 (+5.688804e-01 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+6.688804e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.908034e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.300000e+03 (+0.000000e+00 -4.409461e+02)
Parameter t_shift = 3.000000e+01 (+1.673206e+01 -1.681853e+01)


............................................................................

job 4069749

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.803574e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.174293           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              1.9           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1100           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Obsid IRAS_0780561601
chi^2 = 1.111046e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+5.674933e+00 -0.000000e+00)
Parameter Gamma1 = 1.900000e+00 (+8.880340e-01 -0.000000e+00)
Parameter Gamma2 = 1.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.100000e+03 (+0.000000e+00 -4.252148e+02)
Parameter t_shift = 2.000000e+01 (+0.000000e+00 -0.000000e+00)

lag_freq(1).log_mass,6.174293e+00,+3.579274e-02,-1.479738e-01

#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0780561601_best_fit-1.png

*** OBS 0780561701 (2016) 140.8 ks

Use script =/homeb/steff075/phd_ecm/IRAS13224-3809/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
Freq,+-,Lag,+-
7.272727e-05,2.272727e-05,8.660578e+02,4.587348e+02
1.388430e-04,4.338843e-05,2.819827e+02,1.493386e+02
2.650639e-04,8.283246e-05,2.961837e+01,8.731451e+01
5.060310e-04,1.581347e-04,-6.000435e+01,3.856932e+01
9.660592e-04,3.018935e-04,-2.932089e+01,1.677540e+01
1.844295e-03,5.763421e-04,-2.408420e+01,1.468242e+01
3.520927e-03,1.100290e-03,1.349688e+00,2.367979e+01
#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0780561701_lagfreq.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0780561701-time-lags.fits");
r=load_rmf("IRAS13224-3809-0780561701-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

*ECM Fits*

#+BEGIN_EXAMPLE
IRAS-0780561701-fit-error.sl

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.648398e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.366366         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1000           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0

Obsid IRAS_0780561701
chi^2 = 2.555253e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.000000e+03 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 8.000000e+01 (+0.000000e+00 -0.000000e+00)

.....................................................................

Submitted batch job 4029124

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.535727e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.279398           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1200           0           0
 15  lag_freq(1).t_shift    0     1              100           0           0


Obsid IRAS_0780561701
chi^2 = 2.262985e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.200000e+03 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 1.000000e+02 (+0.000000e+00 -0.000000e+00)

lag_freq(1).log_mass,6.279398e+00,+1.307276e-01,-1.449302e-01

#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0780561701_best_fit-1.png

*** OBS 0792180101 (2016) 141 ks

Use script =/homeb/steff075/phd_ecm/IRAS13224-3809/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
Freq,+-,Lag,+-
7.272727e-05,2.272727e-05,1.027500e+03,1.622266e+02
1.388430e-04,4.338843e-05,3.737064e+02,2.515778e+02
2.650639e-04,8.283246e-05,-1.446689e+02,1.255379e+02
5.060310e-04,1.581347e-04,-2.779651e+01,3.216269e+01
9.660592e-04,3.018935e-04,-1.850106e+01,1.693082e+01
1.844295e-03,5.763421e-04,-2.081422e+01,1.261599e+01
3.520927e-03,1.100290e-03,-8.323909e+00,2.294984e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0792180101_lagfreq.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0792180101-time-lags.fits");
r=load_rmf("IRAS13224-3809-0792180101-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

*ECM Fits*

#+BEGIN_EXAMPLE
IRAS-0792180101-fit-error.sl

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.076096e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.297835         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              600           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid IRAS_0792180101
chi^2 = 1.141801e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.000000e+02 (+0.000000e+00 -3.578212e+02)
Parameter t_shift = 2.000000e+01 (+0.000000e+00 -0.000000e+00)

.....................................................................


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.347961e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.105848         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               11           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              900           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0


Obsid IRAS_0792180101
chi^2 = 1.058413e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.100000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 9.000000e+02 (+0.000000e+00 -6.598421e+02)
Parameter t_shift = 3.000000e+01 (+0.000000e+00 -0.000000e+00)

.................................................................................

Submitted batch job 4029112

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.182643e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.469356         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               13           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0



Obsid IRAS_0792180101
chi^2 = 6.253278e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.300000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+0.000000e+00 -1.814011e+02)
Parameter t_shift = 2.000000e+01 (+6.530977e+01 -0.000000e+00)

....................................................................


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.015668e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.375701           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               17           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Obsid IRAS_0792180101
chi^2 = 5.383106e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.700000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.000000e+02 (+0.000000e+00 -2.125203e+02)
Parameter t_shift = 2.000000e+01 (+0.000000e+00 -0.000000e+00)

lag_freq(1).log_mass,6.375701e+00,+6.502381e-02,-7.291630e-02

#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180101_best_fit-1.png

*** OBS 0792180201 (2016) 141 ks

Use script =/homeb/steff075/phd_ecm/IRAS13224-3809/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
Freq,+-,Lag,+-
7.272727e-05,2.272727e-05,7.138208e+02,2.314783e+02
1.388430e-04,4.338843e-05,8.389110e+02,1.985373e+02
2.650639e-04,8.283246e-05,2.932034e+02,1.220624e+02
5.060310e-04,1.581347e-04,3.251637e+01,3.570282e+01
9.660592e-04,3.018935e-04,-2.745113e+01,1.700379e+01
1.844295e-03,5.763421e-04,-1.822651e+01,1.081399e+01
3.520927e-03,1.100290e-03,-1.252802e+01,3.781839e+01

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0792180201_lagfreq.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0792180201-time-lags.fits");
r=load_rmf("IRAS13224-3809-0792180201-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

*ECM Fits*

#+BEGIN_EXAMPLE
IRAS-0792180201-fit-error.sl

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.552629e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.320733         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               90           0           0

Obsid IRAS_0792180201
chi^2 = 1.443606e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.000000e+02 (+4.813721e+02 -0.000000e+00)
Parameter t_shift = 9.000000e+01 (+0.000000e+00 -0.000000e+00)

..............................................................


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.211102e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.355128         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               13           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0


Obsid IRAS_0792180201
chi^2 = 8.887047e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.300000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+5.982592e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+7.250626e+02 -0.000000e+00)
Parameter t_shift = 3.000000e+01 (+0.000000e+00 -0.000000e+00)


.........................................................................

Submitted batch job 4029113

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.654817e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.361474         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               14           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0


Obsid IRAS_0792180201
chi^2 = 8.417774e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.400000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+7.187677e+02 -0.000000e+00)
Parameter t_shift = 3.000000e+01 (+0.000000e+00 -0.000000e+00)

..................................................................


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.190538e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.222793           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               20           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0

Obsid IRAS_0792180201
chi^2 = 5.195536e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 2.000000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+0.000000e+00 -2.002111e+02)
Parameter t_shift = 3.000000e+01 (+0.000000e+00 -0.000000e+00)

lag_freq(1).log_mass,6.222793e+00,+4.734344e-02,-4.767957e-02
#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180201_best_fit-1.png

*** OBS 0792180301 (2016) 140.5 ks

Use script =/homeb/steff075/phd_ecm/IRAS13224-3809/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
Freq,+-,Lag,+-
7.272727e-05,2.272727e-05,2.485232e+02,2.476823e+02
1.388430e-04,4.338843e-05,4.384834e+02,2.696165e+02
2.650639e-04,8.283246e-05,-1.280628e+02,1.336400e+02
5.060310e-04,1.581347e-04,-2.307562e+01,3.553803e+01
9.660592e-04,3.018935e-04,-6.492892e+01,1.323058e+01
1.844295e-03,5.763421e-04,-1.714226e+01,7.156019e+00
3.520927e-03,1.100290e-03,-3.914374e+00,3.731415e+00
#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0792180301_lagfreq.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0792180301-time-lags.fits");
r=load_rmf("IRAS13224-3809-0792180301-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

*ECM Fits*

#+BEGIN_EXAMPLE
IRAS-0792180301-fit-error.sl

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.033937e-05           0       0.001
  2  lag_freq(1).log_mass   0     0          6.31347         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              600           0           0
 15  lag_freq(1).t_shift    0     1               60           0           0


Obsid IRAS_0792180301
chi^2 = 3.016944e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 6.000000e+01 (+0.000000e+00 -2.792178e+01)

......................................................................


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.455703e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.499852         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               13           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0



Obsid IRAS_0792180301
chi^2 = 6.043134e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.300000e+01 (+0.000000e+00 -3.443715e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.053549e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+5.279373e+02 -2.047686e+01)
Parameter t_shift = 2.000000e+01 (+4.356828e+00 -4.740212e+00)


......................................................................

Submitted batch job 4029116


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.656166e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.495783         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               16           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid IRAS_0792180301
chi^2 = 3.286339e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.600000e+01 (+0.000000e+00 -6.605521e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -5.894793e-01)
Parameter Gamma2 = 2.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.169133e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+3.106170e+02 -2.643666e+01)
Parameter t_shift = 2.000000e+01 (+4.504287e+00 -5.007724e+00)

lag_freq(1).log_mass,6.495783e+00,+3.197226e-02,-1.725456e-02


#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180301_best_fit-1.png

*** OBS 0792180401 (2016) 140.8 ks

Use script =/homeb/steff075/phd_ecm/IRAS13224-3809/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
Freq,+-,Lag,+-
7.272727e-05,2.272727e-05,1.644746e+03,4.565775e+02
1.388430e-04,4.338843e-05,3.264246e+02,1.289573e+02
2.650639e-04,8.283246e-05,9.645928e+01,8.277428e+01
5.060310e-04,1.581347e-04,-4.253958e+01,2.811902e+01
9.660592e-04,3.018935e-04,-5.080477e+01,1.265498e+01
1.844295e-03,5.763421e-04,-3.772181e+00,8.372901e+00
3.520927e-03,1.100290e-03,-7.726913e+00,3.793736e+00
#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0792180401_lagfreq.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0792180401-time-lags.fits");
r=load_rmf("IRAS13224-3809-0792180401-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

*ECM Fits*

#+BEGIN_EXAMPLE
IRAS-0792180401-fit-error.sl

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.925252e-05           0       0.001
  2  lag_freq(1).log_mass   0     0          6.26023         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              900           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0


Obsid IRAS_0792180401
chi^2 = 3.293406e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+7.605893e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+1.966022e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 9.000000e+02 (+0.000000e+00 -3.849862e+02)
Parameter t_shift = 8.000000e+01 (+0.000000e+00 -2.163340e+01)
.....................................................................


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.652481e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.424619         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               13           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                1           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              900           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Obsid IRAS_0792180401
chi^2 = 2.571954e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.300000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -6.021122e-01)
Parameter Gamma2 = 2.100000e+00 (+4.420648e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 9.000000e+02 (+0.000000e+00 -5.827503e+02)
Parameter t_shift = 2.000000e+01 (+8.750130e+00 -4.136357e+00)

...................................................................

Submitted batch job 4027927

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.977164e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.416459         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               16           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              900           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0



Obsid IRAS_0792180401
chi^2 = 1.753503e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.600000e+01 (+0.000000e+00 -6.696953e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -6.490728e-01)
Parameter Gamma2 = 2.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 9.000000e+02 (+0.000000e+00 -5.889380e+02)
Parameter t_shift = 2.000000e+01 (+9.562483e+00 -5.019628e+00)

.............................................................................

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.458236e-05           0       0.001
  2  lag_freq(1).log_mass   0     0          6.36408           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               20           0           0
  7  lag_freq(1).Gamma1     0     1              2.9           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1000           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Obsid IRAS_0792180401
chi^2 = 1.259374e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 2.000000e+01 (+0.000000e+00 -8.384343e+00)
Parameter Gamma1 = 2.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.000000e+03 (+0.000000e+00 -7.671545e+02)
Parameter t_shift = 2.000000e+01 (+9.842864e+00 -5.434806e+00)

lag_freq(1).log_mass,6.364080e+00,+3.803679e-02,-4.653577e-02


#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180401_best_fit-1.png

*** OBS 0792180501 (2016) 138.0 ks

Use script =/homeb/steff075/phd_ecm/IRAS13224-3809/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
Freq,+-,Lag,+-
7.272727e-05,2.272727e-05,8.628996e+02,1.937145e+02
1.388430e-04,4.338843e-05,4.710424e+02,1.719597e+02
2.650639e-04,8.283246e-05,1.768856e+01,5.865968e+01
5.060310e-04,1.581347e-04,-4.952279e+01,2.730034e+01
9.660592e-04,3.018935e-04,-3.225176e+01,1.365069e+01
1.844295e-03,5.763421e-04,-1.215546e+01,7.571327e+00
3.520927e-03,1.100290e-03,-2.266461e+00,3.550570e+00
#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0792180501_lagfreq.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0792180501-time-lags.fits");
r=load_rmf("IRAS13224-3809-0792180501-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

*ECM Fits*

#+BEGIN_EXAMPLE
IRAS-0792180501-fit-error.sl

ag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.753934e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.274433         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0

Obsid IRAS_0792180501
chi^2 = 1.174318e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+7.497263e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.000000e+02 (+0.000000e+00 -2.558775e+02)
Parameter t_shift = 1.000000e+01 (+1.499566e+01 -0.000000e+00)
.........................................................................

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.745721e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.238476         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1                0           0           0


Obsid IRAS_0792180501
chi^2 = 1.161471e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+7.555377e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+0.000000e+00 -2.914394e+02)
Parameter t_shift = 0.000000e+00 (+3.806213e+01 -0.000000e+00)

.........................................................................


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.550265e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.334933           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               16           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid IRAS_0792180501
chi^2 = 7.494179e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.600000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 2.000000e+01 (+1.625343e+01 -0.000000e+00)

lag_freq(1).log_mass,6.334933e+00,+7.058143e-02,-6.964914e-02


#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180501_best_fit-1.png

*** OBS 0792180601 (2016) 136.0 ks

Use script =/homeb/steff075/phd_ecm/IRAS13224-3809/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
Freq,+-,Lag,+-
7.272727e-05,2.272727e-05,9.222345e+02,5.160489e+02
1.388430e-04,4.338843e-05,3.745462e+02,1.030778e+02
2.650639e-04,8.283246e-05,2.395394e+01,6.813510e+01
5.060310e-04,1.581347e-04,-3.975562e+01,3.091363e+01
9.660592e-04,3.018935e-04,-3.038154e+01,1.283480e+01
1.844295e-03,5.763421e-04,-1.307925e+01,7.016920e+00
3.520927e-03,1.100290e-03,-6.502376e+00,3.146797e+00
#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_0792180601_lagfreq.gif

*Regenerate fits and response*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0792180601-time-lags.fits");
r=load_rmf("IRAS13224-3809-0792180601-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

*ECM Fits*

#+BEGIN_EXAMPLE
IRAS-0792180601-fit-error.sl

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.514929e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.266541         5.8         6.5
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              600           0           0
 15  lag_freq(1).t_shift    0     1               90           0           0

Obsid IRAS_0792180601
chi^2 = 6.209876e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.000000e+02 (+0.000000e+00 -3.395651e+02)
Parameter t_shift = 9.000000e+01 (+0.000000e+00 -0.000000e+00)

lag_freq(1).log_mass,6.266541e+00,+6.111860e-02,-1.220167e-01


#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180601_best_fit-1.png

** Current blob codes running:
Deleteing the old i64 lag-files

Due to many corrupt files the lag files for  i64 were totally deleted
on 19 Sep 2020

#+BEGIN_EXAMPLE
Start at: 5.61T, 58970491 Files

Ended at: 4.186T, 46201823

Total i64 lag files deleted approx 13M (1.5T)
#+END_EXAMPLE

7 Dec 20

#+BEGIN_EXAMPLE

./submit-blob-delta.pl

my $first_source_height_low = 2.0;      # low value
my $first_source_height_high = 2.0;     # high value
my $source_height_delta = 6.0;                  # step size (same for both sources)
# First source height ("d")
my $second_source_height_low = 8.0;     # $first_source_height_low + $source_height_delta;
my $second_source_height_high = 8.0; # $first_source_height_high;
# Inclination angle of disk ("i")
my $inclination_low = 64.0;
my $inclination_high = 64.0;
my $inclination_delta = 1.0;
# Photon index of first source ("g")
my $first_source_photon_index_low = 1.8;
my $first_source_photon_index_high = 2.8;
my $first_source_photon_index_delta = 0.1;
# Photon index of second source ("e")
my $second_source_photon_index_low = 1.6;
my $second_source_photon_index_high = 2.7;
my $second_source_photon_index_delta = 0.1;
....

my $tmax_low = 1900.0;
my $tmax_high = 2500.0;
my $tmax_delta = 100.0;
# "q" is the time shift between first and second source
my $tshift_low = 0.0;
my $tshift_high = 120.0;
my $tshift_delta = 10.0;


This will generate 25 scripts

           4069301    serial   reverb  so14935 PD       0:00      1 (Priority)
           4069302    serial   reverb  so14935 PD       0:00      1 (Priority)
           4069300    serial   reverb  so14935 PD       0:00      1 (Priority)
           4069299    serial   reverb  so14935 PD       0:00      1 (Resources)
           4069298    serial   reverb  so14935  R       2:47      1 compute078
           4069295    serial   reverb  so14935  R       3:21      1 compute078
           4069296    serial   reverb  so14935  R       3:21      1 compute078
           4069297    serial   reverb  so14935  R       3:21      1 compute078
           4069290    serial   reverb  so14935  R       3:36      1 compute076
           4069291    serial   reverb  so14935  R       3:36      1 compute076
           4069292    serial   reverb  so14935  R       3:36      1 compute077
           4069293    serial   reverb  so14935  R       3:36      1 compute078
           4069294    serial   reverb  so14935  R       3:36      1 compute078
           4069282    serial   reverb  so14935  R       3:57      1 compute070
           4069283    serial   reverb  so14935  R       3:57      1 compute071
           4069284    serial   reverb  so14935  R       3:57      1 compute071
           4069285    serial   reverb  so14935  R       3:57      1 compute072
           4069286    serial   reverb  so14935  R       3:57      1 compute076
           4069287    serial   reverb  so14935  R       3:57      1 compute076
           4069288    serial   reverb  so14935  R       3:57      1 compute076
           4069289    serial   reverb  so14935  R       3:57      1 compute076
           4069281    serial   reverb  so14935  R       4:31      1 compute069
           4069278    serial   reverb  so14935  R       4:37      1 compute068
           4069279    serial   reverb  so14935  R       4:37      1 compute068
           4069280    serial   reverb  so14935  R       4:37      1 compute068
#+END_EXAMPLE


#+BEGIN_EXAMPLE
as above but H2 = 9

submit-blob-delta-2.pl

           4069301    serial   reverb  so14935 PD       0:00      1 (Priority)
           4069302    serial   reverb  so14935 PD       0:00      1 (Priority)
           4069304    serial   reverb  so14935 PD       0:00      1 (Priority)
           4069307    serial   reverb  so14935 PD       0:00      1 (Priority)
           4069308    serial   reverb  so14935 PD       0:00      1 (Priority)
           4069309    serial   reverb  so14935 PD       0:00      1 (Priority)
           4069310    serial   reverb  so14935 PD       0:00      1 (Priority)
           4069311    serial   reverb  so14935 PD       0:00      1 (Priority)
           4069312    serial   reverb  so14935 PD       0:00      1 (Priority)
           4069313    serial   reverb  so14935 PD       0:00      1 (Priority)
           4069314    serial   reverb  so14935 PD       0:00      1 (Priority)
           4069315    serial   reverb  so14935 PD       0:00      1 (Priority)
           4069316    serial   reverb  so14935 PD       0:00      1 (Priority)
           4069317    serial   reverb  so14935 PD       0:00      1 (Priority)
           4069300    serial   reverb  so14935 PD       0:00      1 (Priority)
           4069299    serial   reverb  so14935 PD       0:00      1 (Resources)
           4069318    serial   reverb  so14935 PD       0:00      1 (Priority)
           4069319    serial   reverb  so14935 PD       0:00      1 (Priority)
           4069320    serial   reverb  so14935 PD       0:00      1 (Priority)
           4069321    serial   reverb  so14935 PD       0:00      1 (Priority)
           4069322    serial   reverb  so14935 PD       0:00      1 (Priority)
           4069323    serial   reverb  so14935 PD       0:00      1 (Priority)
           4069325    serial   reverb  so14935 PD       0:00      1 (Priority)
           4069326    serial   reverb  so14935 PD       0:00      1 (Priority)




#+END_EXAMPLE

** *IRAS13224-3809 Resultant ECM fits* (at a glance)

Literature $logM_{\odot} = 6.30$

*Old fits*

Fits from the original lag.fits files which contained many empty &

corrupt files

| *IRAS 13224-3809 Data* | $\chi^2$ | $logM_{\odot}$ | + | - | $h_2$ | + | - | $\Gamma_1$ | + | - | $\Gamma_2$ | + | - | $\xi$ | + | - | $b$ | + | - | $T_\text{max}$ | + | - | $T_\text{shift}$ | + | - |
| Combined               |      4.7 |       6.165002 |   |   |     3 |   |   |        2.4 |   |   |        2.2 |   |   |       |   |   |     |   |   |           1820 |   |   |               20 |   |   |
| Lo-flux                |      7.5 |       5.903747 |   |   |     4 |   |   |        2.4 |   |   |        2.3 |   |   |       |   |   |     |   |   |            840 |   |   |               35 |   |   |
| Medium-flux            |      1.3 |       6.187158 |   |   |     3 |   |   |        2.4 |   |   |        2.2 |   |   |       |   |   |     |   |   |           1620 |   |   |               20 |   |   |
| Hi-flux                |      2.8 |       6.158492 |   |   |     4 |   |   |        2.2 |   |   |        1.9 |   |   |       |   |   |     |   |   |           1740 |   |   |               20 |   |   |
| Lo-cts<20              |      4.8 |       6.148917 |   |   |     4 |   |   |        2.3 |   |   |        2.2 |   |   |       |   |   |     |   |   |           1020 |   |   |               60 |   |   |
| Hi-cts>20              |   FAILED |       6.201957 |   |   |     4 |   |   |        2.5 |   |   |        2.2 |   |   |       |   |   |     |   |   |           1600 |   |   |               10 |   |   |

FAILING - Too many blank & corrupt lag.fits files present - Deleted
lag-file directroy at i=64 and re-run blob code with lower batch size ~ 6000. See
below for new fits. After recreating the lag.fits files (as of 20 Sep 2020). Note - This fitting has been done on H2 = 3-4 only and where t-max
runs 100 - 1000 (delta 100) - lag files still in creation....

| *IRAS 13224-3809 Data* | $\chi^2$ | $logM_{\odot}$ |    + |    - | $h_2$ |    + |     - | $\Gamma_1$ |    + |    - | $\Gamma_2$ |    + |    - | $\xi$ | + | - | $b$ |   + |    - | $T_\text{max}$ |      + |      - | $T_\text{shift}$ |     + |     - |
|               Combined |     7.85 |       6.104757 |      |      |     5 | 6.19 |     0 |        2.4 |    0 |    0 |        2.3 | 0.32 |    0 |     3 | 0 | 0 |   1 |   0 |    0 |           1000 |      0 | 319.21 |              110 |     0 | 64.51 |
|                Lo-flux |     6.45 |       5.831152 |      |      |     6 | 0.59 |  1.02 |        2.4 | 0.19 | 0.11 |        2.3 | 0.04 | 0.11 |     1 | 0 | 0 |   3 |   0 |    0 |           1000 |  39.87 |  44.43 |               40 |  3.98 | 10.57 |
|            Medium-flux |     2.61 |       6.088717 |      |      |     5 |    0 |     0 |        2.4 |    0 |    0 |        2.3 |    0 | 0.69 |     3 | 0 | 0 |   1 |   0 |    0 |           1000 |      0 | 303.86 |               60 | 29.57 | 53.03 |
|                Hi-flux |     3.16 |       6.094376 |      |      |     6 |    0 |     0 |          2 |    0 |    0 |        1.8 |    0 | 0.19 |     3 | 0 | 0 |   1 |   0 |    0 |           1100 |      0 | 405.29 |              120 |     0 |     0 |
|              Lo-cts<20 |     4.24 |       6.073369 |      |      |     8 |    0 |     0 |        2.7 |    0 |    0 |        2.6 |    0 |    0 |     3 | 0 | 0 |   1 |   0 |    0 |           1200 |      0 | 406.42 |               70 |  0.14 | 51.99 |
|              Hi-cts>20 |     2.61 |       6.109287 |      |      |     5 |    0 |     0 |        2.3 |    0 | 0.12 |        2.1 |    0 |    0 |     0 | 0 | 0 |   1 | 0.6 |    0 |           1000 |      0 | 317.73 |              110 |     0 |  24.9 |
|             0110890101 |     1.04 |       6.284216 | 0.02 | 0.02 |    18 |    0 | 14.26 |        2.3 |    0 |    0 |        1.8 |    0 |    0 |     3 | 0 | 0 |   3 |   0 |    0 |            700 |      0 | 228.16 |               40 | 25.45 | 39.46 |
|             0673580101 |     0.22 |       6.840598 | 0.03 | 0.03 |     3 |    0 |     0 |        2.6 |    0 |    0 |        1.8 |    0 |    0 |     1 | 0 | 0 |   3 |   0 |    0 |            500 |      0 |      0 |               10 |     0 |     0 |
|             0673580201 |     0.14 |       6.282197 | 0.08 | 0.10 |     4 |    0 |     0 |        2.6 |    0 |    0 |        2.4 |    0 |    0 |     3 | 0 | 0 |   2 |   0 |    0 |            400 |      0 | 296.52 |               30 |     0 |     0 |
|             0673580301 |     0.16 |       6.512912 | 0.06 | 0.06 |     3 |    0 |     0 |        2.7 |    0 |    0 |        2.4 |    0 |    0 |     3 | 0 | 0 |   1 |   0 |    0 |            200 |      0 |      0 |               30 |     0 | 13.64 |
|             0673580401 |     2.20 |       6.410157 | 0.03 | 0.04 |    13 |    0 |  0.35 |        2.3 | 0.22 | 0.14 |        1.8 | 0.31 |    0 |     2 | 0 | 0 |   3 |   0 | 0.53 |            500 | 250.27 |  28.40 |               20 |  2.62 |  5.12 |
|             0780560101 |     0.49 |       6.448589 | 0.10 | 0.10 |    20 |    0 |     0 |        2.4 |    0 |    0 |        1.9 |    0 |    0 |     3 | 0 | 0 |   3 |   0 |    0 |            600 |      0 | 478.29 |               40 |     0 |     0 |
|             0780561301 |     0.55 |       6.354846 | 0.04 | 0.05 |     3 |    0 |     0 |        2.7 |    0 |    0 |        2.5 |    0 |    0 |     3 | 0 | 0 |   3 |   0 | 1.56 |            700 |      0 | 213.69 |               30 | 25.91 | 17.59 |
|             0780561401 |     2.01 |       6.728856 | 0.04 | 0.04 |    16 |    0 |     0 |        2.4 |    0 |    0 |        1.8 |    0 |    0 |     2 | 0 | 0 |   3 |   0 |    0 |            300 |      0 |  23.42 |               20 | 17.77 |     0 |
|             0780561501 |     1.61 |       6.169053 |      |      |     6 |    0 |     0 |        2.4 |    0 |    0 |        2.3 |    0 |    0 |     2 | 0 | 0 |   3 |   0 |    0 |           1200 |      0 |      0 |              140 |     0 |     0 |
|             0780561601 |     1.11 |       6.174293 | 0.04 | 0.15 |     5 | 5.67 |     0 |        1.9 | 0.88 |    0 |        1.7 |    0 |    0 |     2 | 0 | 0 |   3 |   0 |    0 |           1100 |      0 | 425.21 |               20 |     0 |     0 |
|             0780561701 |     0.26 |       6.279398 | 0.13 | 0.14 |     6 |    0 |     0 |        2.2 |    0 |    0 |        1.9 |    0 |    0 |     3 | 0 | 0 |   1 |   0 |    0 |           1200 |      0 |      0 |              100 |     0 |     0 |
|             0792180101 |     0.54 |       6.375701 | 0.07 | 0.07 |    17 |    0 |     0 |        2.4 |    0 |    0 |        1.7 |    0 |    0 |     3 | 0 | 0 |   3 |   0 |    0 |            500 |      0 | 212.52 |               20 |     0 |     0 |
|             0792180201 |     0.52 |       6.222793 | 0.05 | 0.05 |    20 |    0 |     0 |        2.4 |    0 |    0 |        1.9 |    0 |    0 |     2 | 0 | 0 |   2 |   0 |    0 |            400 |      0 | 200.21 |               30 |     0 |     0 |
|             0792180301 |     0.33 |       6.495783 | 0.03 | 0.02 |    16 |    0 |  6.61 |        2.7 |    0 | 0.59 |        2.1 |    0 |    0 |     1 | 0 | 0 |   3 |   0 | 1.17 |            300 | 310.62 |  26.44 |               20 |  4.50 |  5.01 |
|             0792180401 |     1.26 |       6.364080 | 0.04 | 0.05 |    20 |    0 |  8.38 |        2.9 |    0 |    0 |        2.4 |    0 |    0 |     3 | 0 | 0 |   3 |   0 |    0 |           1000 |      0 | 767.15 |               20 |  9.84 |  5.43 |
|             0792180501 |     0.75 |       6.334933 | 0.07 | 0.07 |    16 |    0 |     0 |        2.8 |    0 |    0 |        2.3 |    0 |    0 |     1 | 0 | 0 |   3 |   0 |    0 |            500 |      0 |      0 |               20 | 16.25 |     0 |
|             0792180601 |     0.62 |       6.266541 | 0.06 | 0.12 |     3 |    0 |     0 |        2.2 |    0 |    0 |        1.9 |    0 |    0 |     2 | 0 | 0 |   1 |   0 |    0 |            600 |      0 | 339.56 |               90 |     0 |     0 |
|                        |          |                |      |      |       |      |       |            |      |      |            |      |      |       |   |   |     |     |      |                |        |        |                  |       |       |


-----------------------------------------------------------------------------------------
*Combined*

#+ATTR_HTML: :width 600
#+CAPTION: IRAS 13224-3809 Combined best fit
http://www.star.bris.ac.uk/steff/ecm/
-----------------------------------------------------------------------------------------
*Hi flux*

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/

-----------------------------------------------------------------------------------------
*Hi flux >20 cts $s^{-1}$*

These  lags were taken from the low counts (>20) light curves as seen
in the fill light curve plot graph below (as generated during the
timing analysis for this AGN):


#+ATTR_HTML: :width 1000
#+CAPTION: IRAS 13224-3809 light curves (0.3 - 10 keV)
http://www.star.bris.ac.uk/steff/ecm/IRAS_multi_lc_plots_ALL.png



#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/
-----------------------------------------------------------------------------------------
*Lo flux*

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/
-----------------------------------------------------------------------------------------
*Lo flux <20 cts $s^{-1}$*

These  lags were taken from the low counts (<20) light curves as seen
in the fill light curve plot graph above:


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/
-----------------------------------------------------------------------------------------
*Medium Flux*

#+ATTR_HTML: :width 600

* *IRAS 13224-3809 segmented lags below $f_{max}$*

** *Segmented Analysis* for $~f_{max}$

PATH =
=/data/scratch3/steff/IRAS13224-3809/combined/lagfreq_segs_ECM.sl=

=/data/scratch3/steff/IRAS13224-3809/combined/coh_segs_ECM.sl=

All observations were split into 84 segments of between 18 - 25 ks
 totalling XXXX ks of effective observation time.
 The combined lag-frequency of these observations is shown below.

Coherence = 0.0674


drops below this line between :

x=  2.260967e-03  y=  7.131404e-02  ch=A
x=  3.702703e-03  y=  7.131404e-02  ch=A

3.702 - 2.261 = 1.4409999999999998 and 2.261 + 1.441

%Max frequency is the vertical line x=  x=  2.861610e-03 Hz%

#+BEGIN_EXAMPLE
1.454545e-04,2.014736e+02,3.282029e+01, total_segment=8.400000e+01
2.776860e-04,7.938896e+01,2.118112e+01, total_segment=8.400000e+01
5.301277e-04,-2.718185e+01,7.665374e+00, total_segment=8.400000e+01
1.012062e-03,-2.527058e+01,3.664825e+00, total_segment=8.400000e+01
1.932118e-03,-9.066008e+00,1.930193e+00, total_segment=8.400000e+01
3.688590e-03,-3.670053e+00,9.116588e-01, total_segment=8.400000e+01
7.041853e-03,-1.401952e-01,3.592274e-01, total_segment=8.400000e+01
1.344354e-02,-2.626091e-01,4.702364e-01, total_segment=8.400000e+01
2.566494e-02,-nan,-nan, total_segment=8.400000e+01
4.899669e-02,-nan,-nan, total_segment=8.400000e+01
9.353914e-02,-nan,-nan, total_segment=8.400000e+01
1.785747e-01,-nan,-nan, total_segment=8.400000e+01
3.409154e-01,-nan,-nan, total_segment=8.400000e+01
6.508385e-01,-nan,-nan, total_segment=8.400000e+01
#+END_EXAMPLE

PATH = =/data/scratch3/steff/IRAS13224-3809/combined/lagfreq_segs_ECM.sl=
#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS_comb_segs_lagfreq.gif


PATH =
=/data/scratch3/steff/IRAS13224-3809/combined/lagfreq_coh_segs_ECM.sl=

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS_comb_segs_coh.gif

** Combined $~f_{max}$

#+BEGIN_EXAMPLE

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.480212e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.338148           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1300           0           0
 15  lag_freq(1).t_shift    0     1                0           0           0


Obsid IRAS_comb_fmax
chi^2 = 1.471622e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+5.518354e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -5.914613e-01)
Parameter Gamma2 = 1.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.300000e+03 (+0.000000e+00 -3.043567e+02)
Parameter t_shift = 0.000000e+00 (+1.928077e+01 -0.000000e+00)

lag_freq(1).log_mass,6.338148e+00,+1.291249e-02,-1.439892e-02

...........................................................


#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_comb_fmax_best_fit.png

** Combined $~f_{max}$ isis emcee

PATH =/data/typhon1/reverb/IRAS13224-3809=

#+BEGIN_EXAMPLE

.source("IRAS-comb-fit-emcee.sl");

### this doesnt seem to exist  ####

try:

combined-emcee.sl

#+END_EXAMPLE


Obtain par file from BC4, e.g:

#+BEGIN_EXAMPLE
scp -r so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/1H0707-495/1H0707_0110890201_fmax_best_fit.par .
#+END_EXAMPLE


Use parfile and Chain:


#+BEGIN_EXAMPLE
IRAS_comb_fmax_best_fit.par

IRAS_comb_fmax_chain.fits

#+END_EXAMPLE


*Paths of the walkers*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/IRAS_comb_fmax_walkers-1.png


*The Acceptance rate*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/IRAS_comb_fmax_mass_accept_rate-1.png


Obtain the Norm pobability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/IRAS_comb_fmax_norm_prob-1.png


Obtain the Mass probability

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/IRAS_comb_fmax_mass_prob-1.png

*Contours: paths in 2D*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/IRAS_comb_fmax_chain_hist2d-1.png

*Chain statistics*


#+BEGIN_EXAMPLE
 min(min_statistic[[s:]]);
n=length(max_statistic)-1;
1.4716217928016013

#+END_EXAMPLE


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/IRAS_comb_fmax_statistics-1.png


Error analysis


Conf68
#+BEGIN_EXAMPLE
isis> conf_min;
6.329022800922393
isis> conf_max;
6.346958208084106
isis> conf_mean;
6.337990504503249

6.337990504503249-6.329022800922393 = 0.008967703580855968
#+END_EXAMPLE


#+CAPTION: The 68% confidence probability for IRAS13224-3809 Mass value where $\mu = 6.338\pm0.008$ (solid blue line), error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/IRAS_comb_fmax_logmass_conf68-1.png


Conf90
#+BEGIN_EXAMPLE
isis> conf_min;
6.322659168243408
isis> conf_max;
6.353600177764893
isis> conf_mean;
6.3381296730041505

6.3381296730041505-6.322659168243408  = 0.015470504760742188
#+END_EXAMPLE

#+CAPTION: The 90% confidence probability for IRAS13224-3809 Mass value where $\mu = 6.338\pm0.015$ (solid blue line) with the error range between the black dashed lines.
#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/IRAS_comb_fmax_logmass_conf90-1.png

** Hi-flux $~f_{max}$

#+BEGIN_EXAMPLE

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      1.14672e-05           0       0.001
  2  lag_freq(1).log_mass   0     0          6.32115           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1100           0           0
 15  lag_freq(1).t_shift    0     1              110           0           0


Obsid IRAS_hiflux1_fmax
chi^2 = 7.160168e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.100000e+03 (+0.000000e+00 -8.716553e+02)
Parameter t_shift = 1.100000e+02 (+0.000000e+00 -4.646526e+01)

lag_freq(1).log_mass,6.321150e+00,+3.912800e-02,-5.962378e-02


#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_hiflux1_fmax_best_fit.png

** Hi-cts>20 $~f_{max}$

#+BEGIN_EXAMPLE
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      2.22202e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.332588           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1300           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0



Obsid IRAS_hi_cts_fmax
chi^2 = 1.959371e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -3.729145e-01)
Parameter Gamma2 = 1.800000e+00 (+9.992979e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.300000e+03 (+0.000000e+00 -1.087572e+03)
Parameter t_shift = 1.000000e+01 (+1.003552e+01 -0.000000e+00)

lag_freq(1).log_mass,6.332588e+00,+1.226786e-02,-1.483794e-02

......................................................................

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_hi_cts_fmax_best_fit.png

** Med flux $~f_{max}$

#+BEGIN_EXAMPLE

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.217618e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.241613           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                9           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              2.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1000           0           0
 15  lag_freq(1).t_shift    0     1              100           0           0


Obsid IRAS_medflux_fmax
chi^2 = 2.388363e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 9.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+7.017343e-01 -0.000000e+00)
Parameter Gamma2 = 2.100000e+00 (+7.654006e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.000000e+03 (+0.000000e+00 -5.988144e+02)
Parameter t_shift = 1.000000e+02 (+0.000000e+00 -0.000000e+00)

lag_freq(1).log_mass,6.241613e+00,+1.606013e-02,-1.643908e-02

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_medflux_fmax_best_fit.png

** Lo-flux $~f_{max}$


#+BEGIN_EXAMPLE

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.581113e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.198171           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               15           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              400           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0

Obsid IRAS_loflux_fmax
chi^2 = 1.161211e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.500000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 4.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 1.000000e+01 (+2.188397e+01 -0.000000e+00)

lag_freq(1).log_mass,6.198171e+00,+1.823449e-02,-1.505960e-02

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_loflux_fmax_best_fit.png

** Lo-cts<20 $~f_{max}$

#+BEGIN_EXAMPLE

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.313271e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.187264           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               13           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1100           0           0
 15  lag_freq(1).t_shift    0     1              120           0           0


Obsid IRAS_lo_cts_fmax
chi^2 = 3.522290e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.300000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.100000e+03 (+0.000000e+00 -5.727242e+02)
Parameter t_shift = 1.200000e+02 (+0.000000e+00 -3.490418e+01)

lag_freq(1).log_mass,6.187264e+00,+1.881686e-02,-1.771475e-02

...............................................


Try again - no better fit found

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_lo_cts_fmax_best_fit.png

** OBS: 0110890101 $~f_{max} = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/lagfreq_0110890101_segs.sl=

Lags found

#+BEGIN_EXAMPLE
1.085714e-04,2.857143e-05,5.653414e+02,4.192824e+02
1.861224e-04,4.897959e-05,-2.729925e+01,2.105225e+02
3.190671e-04,8.396501e-05,2.261247e+01,1.003749e+02
5.469721e-04,1.439400e-04,8.773214e+01,5.805564e+01
9.376664e-04,2.467543e-04,-6.179177e+00,2.730958e+01
1.607428e-03,4.230074e-04,-1.220468e+01,1.436716e+01
2.755591e-03,7.251556e-04,1.695148e+00,6.930887e+00
#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0110890101_lagfreq_segs.gif

Create fits & respones files

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0110890101-time-lags-fmax.fits");
r=load_rmf("IRAS13224-3809-0110890101-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

Fit ECM

#+BEGIN_EXAMPLE
Submitted batch job 4113830

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.321617e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.756216           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               11           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Obsid IRAS_0110890101_fmax
chi^2 = 7.718520e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.100000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 2.000000e+01 (+0.000000e+00 -0.000000e+00)

lag_freq(1).log_mass,6.756216e+00,+4.054512e-02,-9.282813e-01



Copy to WWW:

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/IRAS13224-3809/IRAS_0110890101_fmax_best_fit.png .
#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0110890101_fmax_best_fit.png


** OBS: 0673580101 $~f_{max} = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/lagfreq_0110890101_segs.sl=

Lags found

#+BEGIN_EXAMPLE
7.083333e-05,2.083333e-05,4.047179e+02,1.602366e+02
1.298611e-04,3.819444e-05,4.966788e-01,3.118986e+02
2.380787e-04,7.002315e-05,2.164247e+02,2.470414e+02
4.364776e-04,1.283758e-04,-1.506122e+02,6.063845e+01
8.002090e-04,2.353556e-04,3.152865e+00,3.756237e+01
1.467050e-03,4.314852e-04,1.924323e+00,1.428588e+01
2.689591e-03,7.910563e-04,1.815148e+00,8.014087e+00

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0673580101_lagfreq_segs.gif

Create fits & respones files

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0673580101-time-lags-fmax.fits");
r=load_rmf("IRAS13224-3809-0673580101-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

Fit ECM

#+BEGIN_EXAMPLE
Submitted batch job 4113832

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.662686e-06           0       0.001
  2  lag_freq(1).log_mass   0     0           6.8359           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               40           0           0


Obsid IRAS_0673580101_fmax
chi^2 = 2.061814e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 4.000000e+01 (+0.000000e+00 -0.000000e+00)

lag_freq(1).log_mass,6.835900e+00,+1.350472e-01,-7.944795e-02

Copy to WWW:

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/IRAS13224-3809/IRAS_0673580101_fmax_best_fit.png .
#+END_EXAMPLE


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0673580101_fmax_best_fit.png

** OBS: 0673580201 $~f_{max} = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/lagfreq_0110890201_segs.sl=

Lags found

#+BEGIN_EXAMPLE
7.083333e-05,2.083333e-05,6.247906e+02,3.061137e+02
1.298611e-04,3.819444e-05,5.575001e+02,1.753896e+02
2.380787e-04,7.002315e-05,-3.938316e+00,8.379908e+01
4.364776e-04,1.283758e-04,7.081461e+01,5.821883e+01
8.002090e-04,2.353556e-04,1.244237e+00,1.952472e+01
1.467050e-03,4.314852e-04,-2.712603e+01,1.272134e+01
2.689591e-03,7.910563e-04,-6.734292e+00,5.821462e+00
#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0673580201_lagfreq_segs.gif

Fit ECM

#+BEGIN_EXAMPLE
Submitted batch job 4113837

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.422352e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.512885           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               17           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid IRAS_0673580201_fmax
chi^2 = 9.956103e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.700000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+0.000000e+00 -3.547567e+01)
Parameter t_shift = 2.000000e+01 (+0.000000e+00 -1.330689e+01)

lag_freq(1).log_mass,6.512885e+00,+6.337181e-02,-8.672870e-02


Copy to WWW:

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/IRAS13224-3809/IRAS_0673580201_fmax_best_fit.png .
#+END_EXAMPLE


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0673580201_fmax_best_fit.png

** OBS: 0673580301 $~f_{max} = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/lagfreq_0110890301_segs.sl=

Lags found

#+BEGIN_EXAMPLE
7.083333e-05,2.083333e-05,3.719778e+02,4.150101e+02
1.298611e-04,3.819444e-05,3.842502e+02,1.772887e+02
2.380787e-04,7.002315e-05,1.319902e+01,1.059566e+02
4.364776e-04,1.283758e-04,3.584630e+01,4.926134e+01
8.002090e-04,2.353556e-04,-1.203126e+02,2.172508e+01
1.467050e-03,4.314852e-04,-2.841632e+01,1.251139e+01
2.689591e-03,7.910563e-04,4.563036e+00,6.655548e+00
#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0673580301_lagfreq_segs.gif

Create fits & respones files

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0673580301-time-lags-fmax.fits");
r=load_rmf("IRAS13224-3809-0673580301-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

Fit ECM

#+BEGIN_EXAMPLE
Submitted batch job 4113841

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      1.89071e-05           0       0.001
  2  lag_freq(1).log_mass   0     0          6.56877           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               40           0           0

File Edit Options Buffers Tools Help
Obsid IRAS_0673580301_fmax
chi^2 = 4.918958e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 4.000000e+01 (+0.000000e+00 -2.924814e+01)

lag_freq(1).log_mass,6.568770e+00,+5.314766e-02,-6.872542e-02


Copy to WWW:

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/IRAS13224-3809/IRAS_0673580201_fmax_best_fit.png .
#+END_EXAMPLE


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0673580301_fmax_best_fit.png

** OBS: 0673580401 $~f_{max} = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/lagfreq_0110890401_segs.sl=

Lags found

#+BEGIN_EXAMPLE
7.083333e-05,2.083333e-05,5.266090e+02,2.726993e+02
1.298611e-04,3.819444e-05,-9.462809e+01,1.778824e+02
2.380787e-04,7.002315e-05,-2.265662e+02,4.836129e+01
4.364776e-04,1.283758e-04,-7.685915e+01,4.220672e+01
8.002090e-04,2.353556e-04,-4.913205e+01,1.689221e+01
1.467050e-03,4.314852e-04,-1.724365e+01,8.779869e+00
2.689591e-03,7.910563e-04,-6.502086e+00,4.877373e+00

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0673580401_lagfreq_segs.gif

Create fits & respones files

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0673580401-time-lags-fmax.fits");
r=load_rmf("IRAS13224-3809-0673580401-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

Fit ECM

#+BEGIN_EXAMPLE
Submitted batch job 4113849

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.873916e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.449305           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               17           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid IRAS_0673580401_fmax
chi^2 = 3.882647e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.700000e+01 (+0.000000e+00 -6.292825e+00)
Parameter Gamma1 = 2.300000e+00 (+3.085690e-01 -2.398871e-01)
Parameter Gamma2 = 1.700000e+00 (+5.085690e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -3.032240e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.000000e+02 (+5.107184e+02 -1.711742e+02)
Parameter t_shift = 2.000000e+01 (+2.883189e+00 -2.059040e+00)

lag_freq(1).log_mass,6.449305e+00,+5.019010e-02,-4.616013e-02

Copy to WWW:

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/IRAS13224-3809/IRAS_0673580201_fmax_best_fit.png .
#+END_EXAMPLE


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0673580401_fmax_best_fit.png

** OBS: 0780560101 $~f_{max} = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/lagfreq_0780560101_segs.sl=

Lags found

#+BEGIN_EXAMPLE
1.085714e-04,2.857143e-05,4.830241e+02,2.648113e+02
1.861224e-04,4.897959e-05,1.841068e+02,1.608516e+02
3.190671e-04,8.396501e-05,2.946652e+02,1.455711e+02
5.469721e-04,1.439400e-04,4.566903e+01,5.330852e+01
9.376664e-04,2.467543e-04,-3.788366e+01,4.128970e+01
1.607428e-03,4.230074e-04,2.246132e+01,2.103022e+01
2.755591e-03,7.251556e-04,-1.473685e+01,8.081820e+00

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0780560101_lagfreq_segs.gif

Create fits & respones files

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0780560101-time-lags-fmax.fits");
r=load_rmf("IRAS13224-3809-0780560101-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

Fit ECM

#+BEGIN_EXAMPLE
Submitted batch job 4113851

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.283073e-05           0       0.001
  2  lag_freq(1).log_mass   0     0          6.55034           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               20           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                1           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1               40           0           0


Obsid IRAS_0780560101_fmax
chi^2 = 1.169636e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 2.000000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 4.000000e+01 (+0.000000e+00 -2.257683e+01)

lag_freq(1).log_mass,6.550340e+00,+1.413595e-02,-2.396833e-02


Copy to WWW:

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/IRAS13224-3809/IRAS_0780560101_fmax_best_fit.png .
#+END_EXAMPLE


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0780560101_fmax_best_fit.png

** OBS: 0780561301 $~f_{max} = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/lagfreq_0780561301_segs.sl=

Lags found

#+BEGIN_EXAMPLE
7.083333e-05,2.083333e-05,1.542441e+03,2.676531e+02
1.298611e-04,3.819444e-05,1.239141e+02,2.608332e+02
2.380787e-04,7.002315e-05,1.959086e+02,8.339507e+01
4.364776e-04,1.283758e-04,3.342337e+01,2.582444e+01
8.002090e-04,2.353556e-04,-1.358860e+01,1.599928e+01
1.467050e-03,4.314852e-04,-4.234219e+01,9.993571e+00
2.689591e-03,7.910563e-04,-6.196642e-01,5.684037e+00

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0780561301_lagfreq_segs.gif

Create fits & respones files

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0780561301-time-lags-fmax.fits");
r=load_rmf("IRAS13224-3809-0780561301-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

Fit ECM

#+BEGIN_EXAMPLE
Submitted batch job 4113854

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.774876e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.159038           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               19           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1200           0           0
 15  lag_freq(1).t_shift    0     1               60           0           0


Obsid IRAS_0780561301_fmax
chi^2 = 1.219760e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.900000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -6.150507e-01)
Parameter Gamma2 = 2.300000e+00 (+3.914210e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -2.811266e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.200000e+03 (+0.000000e+00 -7.402535e+02)
Parameter t_shift = 6.000000e+01 (+1.603501e+01 -4.941988e+01)

lag_freq(1).log_mass,6.159038e+00,+3.380630e-02,-3.528157e-02

................................................................



Copy to WWW:

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/IRAS13224-3809/IRAS_0780561301_fmax_best_fit.png .
#+END_EXAMPLE


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0780561301_fmax_best_fit.png

** OBS: 0780561401 $~f_{max} = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/lagfreq_0780561401_segs.sl=

Lags found

#+BEGIN_EXAMPLE
7.083333e-05,2.083333e-05,1.864317e+02,3.401785e+02
1.298611e-04,3.819444e-05,-6.026426e+02,2.103469e+02
2.380787e-04,7.002315e-05,-8.055291e+01,8.071130e+01
4.364776e-04,1.283758e-04,-9.788466e+01,4.711209e+01
8.002090e-04,2.353556e-04,-7.560154e+01,2.579713e+01
1.467050e-03,4.314852e-04,-2.761608e+01,1.159356e+01
2.689591e-03,7.910563e-04,1.872222e+00,6.203546e+00

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0780561401_lagfreq_segs.gif


Create fits & respones files

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0780561401-time-lags-fmax.fits");
r=load_rmf("IRAS13224-3809-0780561401-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

Fit ECM

#+BEGIN_EXAMPLE
Submitted batch job 4114580

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.315394e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.370353           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               20           0           0
  7  lag_freq(1).Gamma1     0     1              2.9           0           0
  8  lag_freq(1).Gamma2     0     1              2.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              800           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0



Obsid IRAS_0780561401_fmax
chi^2 = 2.946217e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 2.000000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.700000e+00 (+0.000000e+00 -1.059054e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 8.000000e+02 (+0.000000e+00 -4.599112e+02)
Parameter t_shift = 2.000000e+01 (+0.000000e+00 -0.000000e+00)

....................................................................

Submitted batch job 4118337

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.287806e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.372866           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               20           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              800           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid IRAS_0780561401_fmax
chi^2 = 2.917649e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 2.000000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 3.000000e+00 (+0.000000e+00 -7.255062e-01)
Parameter Gamma2 = 2.800000e+00 (+1.042945e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 8.000000e+02 (+0.000000e+00 -4.803733e+02)
Parameter t_shift = 2.000000e+01 (+6.879250e+01 -0.000000e+00)

lag_freq(1).log_mass,6.372866e+00,+6.788857e-02,-5.214607e-02


...................................................................


Copy to WWW:

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/IRAS13224-3809/IRAS_0780561401_fmax_best_fit.png .
#+END_EXAMPLE


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0780561401_fmax_best_fit.png

** OBS: 0780561501 $~f_{max} = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/lagfreq_0780561501_segs.sl=

Lags found

#+BEGIN_EXAMPLE
7.083333e-05,2.083333e-05,6.022653e+02,3.226929e+02
1.298611e-04,3.819444e-05,2.423351e+02,2.434007e+02
2.380787e-04,7.002315e-05,1.614389e+02,9.852909e+01
4.364776e-04,1.283758e-04,1.947468e+01,6.095783e+01
8.002090e-04,2.353556e-04,-5.779660e+00,2.240028e+01
1.467050e-03,4.314852e-04,-2.567552e+01,9.837219e+00
2.689591e-03,7.910563e-04,-1.415230e+01,5.190195e+00

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0780561501_lagfreq_segs.gif


Create fits & respones files

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0780561501-time-lags-fmax.fits");
r=load_rmf("IRAS13224-3809-0780561501-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

Fit ECM

#+BEGIN_EXAMPLE
Submitted batch job 4113904

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.628549e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         5.698078           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1200           0           0
 15  lag_freq(1).t_shift    0     1              140           0           0


Obsid IRAS_0780561501_fmax
chi^2 = 2.185588e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -5.873371e-01)
Parameter Gamma2 = 2.200000e+00 (+0.000000e+00 -6.873663e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.200000e+03 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 1.400000e+02 (+0.000000e+00 -0.000000e+00)

lag_freq(1).log_mass,5.698078e+00,+1.601745e-01,-1.540153e-01


Copy to WWW:

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/IRAS13224-3809/IRAS_0780561501_fmax_best_fit.png .
#+END_EXAMPLE


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0780561501_fmax_best_fit.png

** OBS: 0780561601 $~f_{max} = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/lagfreq_0780561601_segs.sl=

Lags found

#+BEGIN_EXAMPLE
7.083333e-05,2.083333e-05,4.450236e+02,2.355980e+02
1.298611e-04,3.819444e-05,-2.566982e+02,1.738044e+02
2.380787e-04,7.002315e-05,-1.511810e+02,7.497958e+01
4.364776e-04,1.283758e-04,-4.730672e+01,3.573024e+01
8.002090e-04,2.353556e-04,-5.184986e+01,1.383522e+01
1.467050e-03,4.314852e-04,-2.699276e+01,9.006343e+00
2.689591e-03,7.910563e-04,-1.972536e+01,4.742840e+00
#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0780561601_lagfreq_segs.gif

Create fits & respones files

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0780561601-time-lags-fmax.fits");
r=load_rmf("IRAS13224-3809-0780561601-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE


Fit ECM

#+BEGIN_EXAMPLE
Submitted batch job 4113908

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.895308e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.186507           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               14           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1300           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0



Obsid IRAS_0780561601_fmax
chi^2 = 1.279459e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.400000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.300000e+03 (+0.000000e+00 -8.894681e+02)
Parameter t_shift = 2.000000e+01 (+0.000000e+00 -0.000000e+00)

lag_freq(1).log_mass,6.186507e+00,+2.108527e-02,-1.297337e-01

................................................................

Submitted batch job 4116705




Copy to WWW:

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/IRAS13224-3809/IRAS_0780561601_fmax_best_fit.png .
#+END_EXAMPLE


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0780561601_fmax_best_fit.png

** OBS: 0780561701 $~f_{max} = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/lagfreq_0780561701_segs.sl=

Lags found

#+BEGIN_EXAMPLE
7.083333e-05,2.083333e-05,5.071765e+02,4.812368e+02
1.298611e-04,3.819444e-05,4.503260e+02,1.767015e+02
2.380787e-04,7.002315e-05,1.077899e+02,1.020269e+02
4.364776e-04,1.283758e-04,-3.573063e+01,3.629432e+01
8.002090e-04,2.353556e-04,-2.110914e+01,1.619940e+01
1.467050e-03,4.314852e-04,-1.365392e+01,9.484278e+00
2.689591e-03,7.910563e-04,-3.005858e+00,4.767679e+00
#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0780561701_lagfreq_segs.gif

Create fits & respones files

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0780561701-time-lags-fmax.fits");
r=load_rmf("IRAS13224-3809-0780561701-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

Fit ECM

#+BEGIN_EXAMPLE
Submitted batch job 4113912

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     6.967396e-06           0       0.001
  2  lag_freq(1).log_mass   0     0         6.258395           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                9           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              500           0           0
 15  lag_freq(1).t_shift    0     1              120           0           0

Obsid IRAS_0780561701_fmax
chi^2 = 1.164716e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 9.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.900000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 5.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 1.200000e+02 (+0.000000e+00 -0.000000e+00)

lag_freq(1).log_mass,6.258395e+00,+8.609914e-02,-1.082262e-01

Copy to WWW:

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/IRAS13224-3809/IRAS_0780561701_fmax_best_fit.png .
#+END_EXAMPLE


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0780561701_fmax_best_fit.png

** OBS: 0792180101 $~f_{max} = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/lagfreq_0792180101_segs.sl=

Lags found

#+BEGIN_EXAMPLE
7.083333e-05,2.083333e-05,1.048514e+03,1.655445e+02
1.298611e-04,3.819444e-05,3.236687e+02,2.975471e+02
2.380787e-04,7.002315e-05,2.844080e+01,1.144854e+02
4.364776e-04,1.283758e-04,-5.139056e+01,4.116507e+01
8.002090e-04,2.353556e-04,-2.648884e+01,1.666900e+01
1.467050e-03,4.314852e-04,-9.337301e+00,1.062999e+01
2.689591e-03,7.910563e-04,5.704731e+00,4.336145e+00

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180101_lagfreq_segs.gif


Create fits & respones files

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0792180101-time-lags-fmax.fits");
r=load_rmf("IRAS13224-3809-0792180101-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

Fit ECM

#+BEGIN_EXAMPLE
Submitted batch job 4113913

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      5.73278e-06           0       0.001
  2  lag_freq(1).log_mass   0     0         6.280131           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               18           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1100           0           0
 15  lag_freq(1).t_shift    0     1              120           0           0


Obsid IRAS_0792180101_fmax
chi^2 = 1.270508e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.800000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.100000e+03 (+0.000000e+00 -9.057128e+02)
Parameter t_shift = 1.200000e+02 (+0.000000e+00 -0.000000e+00)

lag_freq(1).log_mass,6.280131e+00,+9.517576e-02,-1.167335e-01


Copy to WWW:

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/IRAS13224-3809/IRAS_0792180101_fmax_best_fit.png .
#+END_EXAMPLE


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180101_fmax_best_fit.png

** OBS: 0792180201 $~f_{max} = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/lagfreq_0792180201_segs.sl=

Lags found

#+BEGIN_EXAMPLE
7.083333e-05,2.083333e-05,7.119606e+02,2.553545e+02
1.298611e-04,3.819444e-05,8.418171e+02,2.343215e+02
2.380787e-04,7.002315e-05,4.394161e+02,1.075792e+02
4.364776e-04,1.283758e-04,-8.142641e+00,3.569433e+01
8.002090e-04,2.353556e-04,-7.992184e+00,1.921710e+01
1.467050e-03,4.314852e-04,-1.115233e+01,8.883178e+00
2.689591e-03,7.910563e-04,-3.604234e+00,4.587467e+00
#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180201_lagfreq_segs.gif


Create fits & respones files

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0792180201-time-lags-fmax.fits");
r=load_rmf("IRAS13224-3809-0792180201-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

Fit ECM

#+BEGIN_EXAMPLE
Submitted batch job 411398

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     6.171501e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.367792           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               12           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Obsid IRAS_0792180201_fmax
chi^2 = 7.512706e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.200000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 2.000000e+01 (+4.751087e+01 -1.317742e+01)

lag_freq(1).log_mass,6.367792e+00,+4.137664e-02,-3.084094e-02


Copy to WWW:

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/IRAS13224-3809/IRAS_0792180201_fmax_best_fit.png .
#+END_EXAMPLE


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180201_fmax_best_fit.png

** OBS: 0792180301 $~f_{max} = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/lagfreq_0792180301_segs.sl=

Lags found

#+BEGIN_EXAMPLE
7.083333e-05,2.083333e-05,2.722178e+02,2.716429e+02
1.298611e-04,3.819444e-05,3.415825e+02,2.798957e+02
2.380787e-04,7.002315e-05,2.538013e+02,1.835712e+02
4.364776e-04,1.283758e-04,-1.410011e+02,4.184583e+01
8.002090e-04,2.353556e-04,-2.955988e+01,1.855373e+01
1.467050e-03,4.314852e-04,-4.514723e+01,9.601746e+00
2.689591e-03,7.910563e-04,4.614665e+00,5.225292e+00

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180301_lagfreq_segs.gif


Create fits & respones files

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0792180301-time-lags-fmax.fits");
r=load_rmf("IRAS13224-3809-0792180301-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

Fit ECM

#+BEGIN_EXAMPLE
Submitted batch job 4113927

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.864824e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.372171           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1              110           0           0


Obsid IRAS_0792180301_fmax
chi^2 = 1.532958e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+1.055961e+01 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 1.100000e+02 (+0.000000e+00 -4.554611e+01)

lag_freq(1).log_mass,6.372171e+00,+3.901378e-02,-2.481017e-02
................................................................

Submitted batch job 4116703

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.801253e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.376667           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                6           0           0
  7  lag_freq(1).Gamma1     0     1                3           0           0
  8  lag_freq(1).Gamma2     0     1              2.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1              110           0           0


Obsid IRAS_0792180301_fmax
chi^2 = 1.327453e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 6.000000e+00 (+1.031131e+01 -0.000000e+00)
Parameter Gamma1 = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.000000e+02 (+7.724292e+00 -0.000000e+00)
Parameter t_shift = 1.100000e+02 (+3.394525e-01 -4.660548e+00)

lag_freq(1).log_mass,6.376667e+00,+3.596110e-02,-2.755044e-02


Copy to WWW:

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/IRAS13224-3809/IRAS_0792180301_fmax_best_fit.png .
#+END_EXAMPLE


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180301_fmax_best_fit.png

** OBS: 0792180401 $~f_{max} = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/lagfreq_0792180401_segs.sl=

Lags found

#+BEGIN_EXAMPLE
7.083333e-05,2.083333e-05,1.698732e+03,4.929555e+02
1.298611e-04,3.819444e-05,4.402195e+02,1.268831e+02
2.380787e-04,7.002315e-05,9.275365e+00,9.239616e+01
4.364776e-04,1.283758e-04,-8.291837e+01,3.573280e+01
8.002090e-04,2.353556e-04,-3.078729e+01,1.922469e+01
1.467050e-03,4.314852e-04,-2.176589e+01,9.295332e+00
2.689591e-03,7.910563e-04,-1.074312e+01,5.231860e+00

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180401_lagfreq_segs.gif


Create fits & respones files

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0792180101-time-lags-fmax.fits");
r=load_rmf("IRAS13224-3809-0792180101-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

Fit ECM

#+BEGIN_EXAMPLE
Submitted batch job 4113930

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.241681e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.312419           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1             1000           0           0
 15  lag_freq(1).t_shift    0     1              120           0           0


Obsid IRAS_0792180401_fmax
chi^2 = 6.629386e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.000000e+03 (+0.000000e+00 -6.396678e+02)
Parameter t_shift = 1.200000e+02 (+0.000000e+00 -4.110522e+01)

lag_freq(1).log_mass,6.312419e+00,+5.112657e-02,-8.564684e-02

Copy to WWW:

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/IRAS13224-3809/IRAS_0792180401_fmax_best_fit.png .
#+END_EXAMPLE


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180401_fmax_best_fit.png

** OBS: 0792180501 $~f_{max} = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/lagfreq_0792180501_segs.sl=

Lags found

#+BEGIN_EXAMPLE
7.083333e-05,2.083333e-05,8.805477e+02,1.976764e+02
1.298611e-04,3.819444e-05,4.776428e+02,1.836624e+02
2.380787e-04,7.002315e-05,1.181588e+02,7.727528e+01
4.364776e-04,1.283758e-04,-6.169803e+01,3.156024e+01
8.002090e-04,2.353556e-04,-5.285256e+01,1.890197e+01
1.467050e-03,4.314852e-04,-2.544754e+01,8.330762e+00
2.689591e-03,7.910563e-04,-2.674773e+00,5.099174e+00

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180501_lagfreq_segs.gif


Create fits & respones files

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0792180501-time-lags-fmax.fits");
r=load_rmf("IRAS13224-3809-0792180501-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

Fit ECM

#+BEGIN_EXAMPLE
Submitted batch job 4113932

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.395574e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.231842           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1               12           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              700           0           0
 15  lag_freq(1).t_shift    0     1              110           0           0


Obsid IRAS_0792180501_fmax
chi^2 = 1.862585e-02 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 1.200000e+01 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 7.000000e+02 (+0.000000e+00 -5.277117e+02)
Parameter t_shift = 1.100000e+02 (+0.000000e+00 -6.068135e+01)

lag_freq(1).log_mass,6.231842e+00,+4.827969e-02,-3.644344e-02

Copy to WWW:

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/IRAS13224-3809/IRAS_0792180501_fmax_best_fit.png .
#+END_EXAMPLE


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180501_fmax_best_fit.png

** OBS: 0792180601 $~f_{max} = 2.9 \times 10 ^{-3}$ Hz

PATH = =/home/steff075/phd_ecm/IRAS/lagfreq_0792180601_segs.sl=

Lags found

#+BEGIN_EXAMPLE
7.083333e-05,2.083333e-05,7.307548e+02,7.093214e+02
1.298611e-04,3.819444e-05,4.643938e+02,1.048797e+02
2.380787e-04,7.002315e-05,9.553984e+01,8.152410e+01
4.364776e-04,1.283758e-04,-5.323358e+01,3.713090e+01
8.002090e-04,2.353556e-04,-3.444072e+01,1.554056e+01
1.467050e-03,4.314852e-04,-2.214600e+01,9.941035e+00
2.689591e-03,7.910563e-04,-6.228050e+00,4.354478e+00

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180601_lagfreq_segs.gif


Create fits & respones files

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("IRAS13224-3809-0792180601-time-lags-fmax.fits");
r=load_rmf("IRAS13224-3809-0792180601-time-lags-fmax.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

#+END_EXAMPLE

Fit ECM

#+BEGIN_EXAMPLE
Submitted batch job 4113934

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0       1.1926e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.259303           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                8           0           0
  7  lag_freq(1).Gamma1     0     1              2.1           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              600           0           0
 15  lag_freq(1).t_shift    0     1              110           0           0


Obsid IRAS_0792180601_fmax
chi^2 = 1.870392e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 8.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 6.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 1.100000e+02 (+0.000000e+00 -0.000000e+00)

lag_freq(1).log_mass,6.259303e+00,+5.036860e-02,-5.671181e-02


Copy to WWW:

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/IRAS13224-3809/IRAS_0792180601_fmax_best_fit.png .
#+END_EXAMPLE


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180601_fmax_best_fit.png

** *Fmax results* (at a glance)

All results including the fmax lags and RELXILL modelling are recorded
in:

PATH
=/home/steff075/phd_ecm/results-for-all/IRAS_results_All_for_fmax.csv=

Download this file [[http://www.star.bris.ac.uk/steff/ecm/IRAS_results_All_for_fmax.csv][here]]

| *IRAS 13224-3809* | $\chi^2$ | $logM_{\odot}$ |    + |    - | $h_2$ |     + |    - | $\Gamma_1$ |    + |    - | $\Gamma_2$ |    + |    - | $\xi$ | + | - | $b$ | + |    - | $T_\text{max}$ |      + |       - | $T_\text{shift}$ |     + |     - |   |
|          Combined |     1.47 |       6.338148 | 0.01 | 0.01 |     5 |  5.52 |    0 |        2.6 |    0 | 0.59 |        1.9 |    0 |    0 |     1 | 0 | 0 |   3 | 0 |    0 |           1300 |      0 |  304.36 |                0 | 19.28 |     0 |   |
|           Hi-spec |     0.72 |        6.32115 | 0.04 | 0.06 |     5 |     0 |    0 |        2.3 |    0 |    0 |        1.7 |    0 |    0 |     1 | 0 | 0 |   1 | 0 |    0 |           1100 |      0 |  871.65 |              110 |     0 | 46.47 |   |
|         Hi-cts>20 |     1.96 |       6.332588 | 0.01 | 0.01 |     5 |     0 |    0 |        2.4 |    0 |    0 |        1.8 |    0 |    0 |     2 | 0 | 0 |   3 | 0 |    0 |           1300 |      0 | 1077.04 |               10 | 10.04 |     0 |   |
|          Med-spec |     2.39 |       6.241613 | 0.02 | 0.02 |     9 |     0 |    0 |        2.3 | 0.70 |    0 |        2.1 | 0.77 |    0 |     3 | 0 | 0 |   1 | 0 |    0 |           1000 |      0 |  598.81 |              100 |     0 |     0 |   |
|           Lo-spec |     0.12 |       6.198171 | 0.02 | 0.02 |    15 |     0 |    0 |        2.5 |    0 |    0 |        1.9 |    0 |    0 |     3 | 0 | 0 |   2 | 0 |    0 |            400 |      0 |       0 |               10 | 21.88 |     0 |   |
|         Lo-cts<20 |     3.52 |       6.187264 | 0.02 | 0.02 |    13 |     0 |    0 |        2.2 |    0 |    0 |        2.0 |    0 |    0 |     3 | 0 | 0 |   1 | 0 |    0 |           1100 |      0 |  571.14 |              120 |  2.99 | 34.90 |   |
|        0110890101 |     0.77 |       6.756216 | 0.04 | 0.93 |    11 |     0 |    0 |        2.5 |    0 |    0 |        1.7 |    0 |    0 |     0 | 0 | 0 |   3 | 0 |    0 |            300 |      0 |       0 |               20 |     0 |     0 |   |
|        0673580101 |     0.21 |         6.8359 | 0.14 | 0.08 |     6 |     0 |    0 |        2.3 |    0 |    0 |        1.8 |    0 |    0 |     1 | 0 | 0 |   3 | 0 |    0 |            300 |      0 |       0 |               40 |     0 |     0 |   |
|        0673580201 |     0.99 |       6.512885 | 0.06 | 0.09 |    17 |     0 |    0 |        2.7 |    0 |    0 |        1.8 |    0 |    0 |     3 | 0 | 0 |   3 | 0 |    0 |            300 |      0 |       0 |               20 |     0 |     0 |   |
|        0673580301 |     0.49 |        6.56877 | 0.05 | 0.07 |     3 |     0 |    0 |        2.2 |    0 |    0 |        1.9 |    0 |    0 |     2 | 0 | 0 |   2 | 0 |    0 |            300 |      0 |       0 |               40 |     0 | 29.25 |   |
|        0673580401 |     0.39 |       6.449305 | 0.05 | 0.05 |    17 |     0 | 6.29 |        2.3 | 0.31 | 0.23 |        1.7 | 0.51 |    0 |     1 | 0 | 0 |   3 | 0 |  0.3 |            500 | 510.72 |  171.17 |               20 |  2.88 |  2.05 |   |
|        0780560101 |     1.17 |        6.55034 | 0.01 | 0.02 |    20 |     0 |    0 |        2.4 |    0 |    0 |        1.8 |    0 |    0 |     1 | 0 | 0 |   3 | 0 |    0 |            500 |      0 |       0 |               40 |     0 | 22.58 |   |
|        0780561301 |     1.22 |       6.159038 | 0.03 | 0.04 |    19 |     0 |    0 |        2.7 |    0 | 0.62 |        2.3 | 0.39 |    0 |     3 | 0 | 0 |   2 | 0 | 0.28 |           1200 |      0 |  740.25 |               60 | 16.04 | 49.42 |   |
|        0780561401 |     2.92 |       6.372866 | 0.07 | 0.05 |    20 |     0 |    0 |        3.0 |    0 | 0.73 |        2.8 | 0.10 |    0 |     3 | 0 | 0 |   3 | 0 |    0 |            800 |      0 |  480.37 |               20 | 68.79 |     0 |   |
|        0780561501 |     0.22 |       5.698078 | 0.16 | 0.15 |     6 |     0 |    0 |        2.3 |    0 | 0.59 |        2.2 |    0 | 0.69 |     1 | 0 | 0 |   1 | 0 |    0 |           1200 |      0 |       0 |              140 |     0 |     0 |   |
|        0780561601 |     1.28 |       6.186507 | 0.02 | 0.13 |    14 |     0 |    0 |        2.7 |    0 |    0 |        2.5 |    0 |    0 |     3 | 0 | 0 |   3 | 0 |    0 |           1300 |      0 |  886.47 |               20 |     0 |     0 |   |
|        0780561701 |     0.12 |       6.258395 | 0.09 | 0.11 |     9 |     0 |    0 |        2.4 |    0 |    0 |        1.9 |    0 |    0 |     2 | 0 | 0 |   1 | 0 |    0 |            500 |      0 |       0 |              120 |     0 |     0 |   |
|        0792180101 |     0.13 |       6.280131 | 0.10 | 0.12 |    18 |     0 |    0 |        2.6 |    0 |    0 |        1.7 |    0 |    0 |     1 | 0 | 0 |   1 | 0 |    0 |           1100 |      0 |  905.71 |              120 |     0 |     0 |   |
|        0792180201 |     0.75 |       6.367792 | 0.04 | 0.03 |    12 |     0 |    0 |        2.5 |    0 |    0 |        1.7 |    0 |    0 |     1 | 0 | 0 |   3 | 0 |    0 |            300 |      0 |       0 |               20 | 47.51 | 13.17 |   |
|        0792180301 |     1.33 |       6.376667 | 0.04 | 0.03 |     6 | 10.31 |    0 |        3.0 |    0 |    0 |        2.8 |    0 |    0 |     3 | 0 | 0 |   2 | 0 |    0 |            200 |   7.72 |       0 |              110 |  0.34 |  4.66 |   |
|        0792180401 |     0.66 |       6.312419 | 0.05 | 0.09 |     5 |     0 |    0 |        2.3 |    0 |    0 |        1.8 |    0 |    0 |     1 | 0 | 0 |   1 | 0 |    0 |           1000 |      0 |  639.66 |              120 |     0 | 41.11 |   |
|        0792180501 |     0.19 |       6.231842 | 0.05 | 0.04 |    12 |     0 |    0 |        2.5 |    0 |    0 |        2.2 |    0 |    0 |     1 | 0 | 0 |   1 | 0 |    0 |            700 |      0 |  527.71 |              110 |     0 | 60.68 |   |
|        0792180601 |     0.19 |       6.259303 | 0.05 | 0.06 |     8 |     0 |    0 |        2.1 |    0 |    0 |        1.8 |    0 |    0 |     3 | 0 | 0 |   1 | 0 |    0 |            600 |      0 |       0 |              110 |     0 |     0 |   |


File reads:



|               Data | Lit-LogM |      z |    L_Edd | L2-10k/Ledd | LX L/L_Edd | L_bol/erg s-1 | Log_Lbol | Edd Ratio Lbol/Ledd | NED DL /cm | Soft-lag |       +- | Soft-lag-freq | total_counts |  exp/ks |            L(0.3-10k) | L(2-10k)spec-model | 0.3-10k-spec-model-flux | 2-10k-spec-model-flux | Relxill-flux |        + |        - | Reflection-flux |        + |        - | Plaw-Flux |        + |        - | Relxill-gamma |     + |     - | Relxill-ionise |        + |     - | Relxill-Afe |     + |     - | Relxill-RF |        + |        - | Relxill-incl |     + |     - | Cvr-Frac |     + |        - |           Abs-Data | fmax-ECM-Chi2 |     fmax_M-solar | fmax-ECM_logM |    + |    - | fmax-ECM-h2 |     + |    - | fmax-ECM-Gama1 |    + |    - | fmax-ECM-Gamma2 |    + |    - | Fmax-ECM-xi | + | - | fmax-ECM-b | + |    - | fmax-tmax |      + |       - | fmax-tshift |     + |     - |
| IRAS-comb+2016-obs |      6.3 | 0.0406 | 3.29E+44 |    4.29E-02 |  -1.37E+00 |      5.50E+45 |     45.7 |    16.7200565592298 |   9.57E+26 | 4.97E+01 | 1.05E+01 |      4.36E-04 |     2.21E+06 |    1650 | 2.04687169013596E+043 |           1.41E+43 |                1.78E-12 |              1.23E-12 |     1.79E-12 | 2.57E-14 | 2.57E-14 |        1.70E-12 | 6.11E-14 | 4.72E-14 |  1.39E-12 | 5.23E-15 | 5.19E-15 |          3.25 |  0.04 |  0.02 |           2.13 |     0.06 |  0.06 |         0.5 |  0.11 |     0 |         10 |        0 |     0.18 |        77.51 |  1.39 |  1.18 |      0.6 |  0.02 |     0.02 | IRAS-comb+2016-obs |          1.47 | 2178452.02440395 |      6.338148 | 0.01 | 0.01 |           5 |  5.52 |    0 |            2.6 |    0 | 0.59 |             1.9 |    0 |    0 |           1 | 0 | 0 |          3 | 0 |    0 |      1300 |      0 |  304.36 |           0 | 19.28 |     0 |
|   IRAS-hi+2016+obs |      6.3 | 0.0406 | 3.16E+44 |    4.46E-02 |  -1.35E+00 |      5.50E+45 |     45.7 |    17.3874439174227 |   9.57E+26 | 6.73E+01 | 2.60E+01 |      4.36E-04 |     5.38E+05 |     228 | 3.97875058869124E+043 |           1.41E+43 |                3.46E-12 |              1.23E-12 |     3.10E-12 | 2.46E-13 | 1.41E-13 |        3.41E-12 | 2.40E-13 | 2.40E-13 |  2.95E-12 | 1.88E-14 | 1.87E-14 |          3.17 |  0.09 |  0.08 |           1.41 |     0.39 |   0.1 |        2.79 |   1.4 |  2.02 |       9.08 |     0.92 |      3.1 |        77.82 |  2.18 |  2.19 |     0.29 |  0.15 |     0.09 |   IRAS-hi+2016+obs |          0.72 | 2094835.86159003 |       6.32115 | 0.04 | 0.06 |           5 |     0 |    0 |            2.3 |    0 |    0 |             1.7 |    0 |    0 |           1 | 0 | 0 |          1 | 0 |    0 |      1100 |      0 |  871.65 |         110 |     0 | 46.47 |
|     IRAS-hi-cts>20 |      6.3 | 0.0406 | 3.25E+44 |    2.30E-02 |  -1.64E+00 |      5.50E+45 |     45.7 |    16.9354890429037 |   9.57E+26 | 5.08E+01 | 1.59E+01 |      4.36E-04 |     1.72E+06 | 674.946 | 2.08498490331487E+043 |           7.48E+42 |                1.81E-12 |              6.51E-13 |     1.84E-12 | 4.07E-14 | 4.04E-14 |        1.84E-12 | 1.32E-13 | 7.64E-14 |  1.32E-13 | 1.32E-13 | 1.32E-13 |      3.06E+00 |  0.05 |  0.04 |           1.46 |     0.17 |  0.08 |         0.5 |  0.41 |     0 |         10 |        0 |     0.61 |        79.91 |   0.1 |  2.82 |     0.42 |  0.05 |     0.03 |     IRAS-hi-cts>20 |          1.96 | 2150740.43432274 |      6.332588 | 0.01 | 0.01 |           5 |     0 |    0 |            2.4 |    0 |    0 |             1.8 |    0 |    0 |           2 | 0 | 0 |          3 | 0 |    0 |      1300 |      0 | 1077.04 |          10 | 10.04 |     0 |
|  IRAS-med+2016+obs |      6.3 | 0.0406 | 2.63E+44 |    2.31E-02 |  -1.64E+00 |      5.50E+45 |     45.7 |    20.8820312909518 |   9.57E+26 | 3.52E+01 | 1.22E+01 |      4.36E-04 |     1.47E+06 |    1230 | 1.62139836128747E+043 |           6.09E+42 |                1.41E-12 |              5.30E-13 |     1.35E-12 | 4.25E-14 | 3.54E-14 |        1.33E-12 | 1.02E-13 | 9.38E-14 |  1.06E-12 | 5.44E-15 | 5.44E-15 |          3.27 |     0 |     0 |           2.12 |    0.005 | 0.004 |        0.86 | 0.002 | 0.004 |         10 |        0 |     0.03 |         72.3 |  0.35 |   0.4 |     0.63 | 0.001 |    0.001 |  IRAS-med+2016+obs |          2.39 | 1744267.14298552 |      6.241613 | 0.02 | 0.02 |           9 |     0 |    0 |            2.3 |  0.7 |    0 |             2.1 | 0.77 |    0 |           3 | 0 | 0 |          1 | 0 |    0 |      1000 |      0 |  598.81 |         100 |     0 |     0 |
|   IRAS-lo+2016+obs |      6.3 | 0.0406 | 2.38E+44 |    1.24E-02 |  -1.91E+00 |      5.50E+45 |     45.7 |    23.0788807002725 |   9.57E+26 | 7.64E+01 | 3.42E+01 |      4.36E-04 |     1.96E+05 |     196 |  5.9566266038788E+042 |           2.95E+42 |                5.18E-13 |              2.57E-13 |     4.92E-13 | 3.34E-14 | 2.45E-14 |        4.56E-13 | 6.73E-14 | 3.60E-14 |  3.92E-13 | 9.50E-15 | 9.36E-15 |          3.14 |  0.06 |  0.21 |           1.87 |     0.16 |  0.13 |         0.5 |  0.71 |     0 |         10 |        0 |     0.76 |        65.46 |  3.35 |  2.32 |     0.74 |  0.03 |     0.11 |   IRAS-lo+2016+obs |          0.12 | 1578232.56390301 |      6.198171 | 0.02 | 0.02 |          15 |     0 |    0 |            2.5 |    0 |    0 |             1.9 |    0 |    0 |           3 | 0 | 0 |          2 | 0 |    0 |       400 |      0 |       0 |          10 | 21.88 |     0 |
|     IRAS-lo-cts<20 |      6.3 | 0.0406 | 2.32E+44 |    2.66E-02 |  -1.58E+00 |      5.50E+45 |     45.7 |    23.6658300926653 |   9.57E+26 | 4.17E+01 | 1.44E+01 |      4.36E-04 |     1.84E+06 | 818.259 | 1.66596466420167E+043 |           6.17E+42 |                1.45E-12 |              5.37E-13 |          nan |      nan |      nan |             nan |      nan |      nan |       nan |      nan |      nan |           3.2 | 0.003 | 0.004 |           1.83 |    0.006 | 0.008 |         0.5 |  0.01 |     0 |         10 |        0 |     0.22 |        74.68 |  1.09 |  1.41 |     0.64 | 0.002 |    0.004 |     IRAS-lo-cts<20 |          3.52 | 1539089.94178453 |      6.187264 | 0.02 | 0.02 |          13 |     0 |    0 |            2.2 |    0 |    0 |               2 |    0 |    0 |           3 | 0 | 0 |          1 | 0 |    0 |      1100 |      0 |  571.14 |         120 |  2.99 |  34.9 |
|          110890101 |      6.3 | 0.0406 | 8.61E+44 |    6.26E-03 |  -2.20E+00 |      5.50E+45 |     45.7 |    6.38512997589966 |   9.57E+26 | 1.22E+01 | 1.44E+01 |      1.61E-03 |     1.01E+05 |   54.76 | 1.39474337202327E+043 |           5.39E+42 |                1.21E-12 |              4.69E-13 |          nan |      nan |      nan |             nan |      nan |      nan |       nan |      nan |      nan |          3.21 |  0.17 |  0.22 |           2.26 |     0.24 |  0.27 |         0.5 |  0.39 |     0 |         10 |        0 |     2.07 |        67.55 |   6.6 |  3.12 |      0.7 |  0.07 |     0.18 |          110890101 |          0.77 |  5704479.1879073 |      6.756216 | 0.04 | 0.93 |          11 |     0 |    0 |            2.5 |    0 |    0 |             1.7 |    0 |    0 |           0 | 0 | 0 |          3 | 0 |    0 |       300 |      0 |       0 |          20 |     0 |     0 |
|          673580101 |      6.3 | 0.0406 | 1.03E+45 |    6.95E-03 |  -2.16E+00 |      5.50E+45 |     45.7 |    5.31478550888218 |   9.57E+26 | 1.51E+02 | 6.06E+01 |      4.36E-04 |     1.09E+05 |  42.958 | 2.10685687651793E+043 |           7.19E+42 |                1.83E-12 |              6.26E-13 |          nan |      nan |      nan |             nan |      nan |      nan |       nan |      nan |      nan |          3.23 |  0.12 |  0.09 |           1.93 |     0.17 |   0.4 |        6.93 |  3.07 |  2.55 |         10 |        0 |     2.58 |        64.92 |  9.72 |  5.23 |      0.4 |  0.15 |     0.14 |          673580101 |          0.21 | 6853304.05126046 |        6.8359 | 0.14 | 0.08 |           6 |     0 |    0 |            2.3 |    0 |    0 |             1.8 |    0 |    0 |           1 | 0 | 0 |          3 | 0 |    0 |       300 |      0 |       0 |          40 |     0 |     0 |
|          673580201 |      6.3 | 0.0406 | 4.92E+44 |    1.19E-02 |  -1.92E+00 |      5.50E+45 |     45.7 |     11.181517354828 |   9.57E+26 | 2.71E+01 | 1.27E+01 |      1.47E-03 |     1.74E+05 |  91.945 | 1.42685066193321E+043 |           5.86E+42 |                1.24E-12 |              5.10E-13 |          nan |      nan |      nan |             nan |      nan |      nan |       nan |      nan |      nan |          3.11 |  0.18 |  0.16 |           1.77 |     0.42 |  0.38 |         0.5 |  2.97 |     0 |        9.3 |     0.69 |     2.95 |           80 |     0 | 12.69 |      0.6 |  0.15 |     0.14 |          673580201 |          0.99 |  3257504.3175044 |      6.512885 | 0.06 | 0.09 |          17 |     0 |    0 |            2.7 |    0 |    0 |             1.8 |    0 |    0 |           3 | 0 | 0 |          3 | 0 |    0 |       300 |      0 |       0 |          20 |     0 |     0 |
|          673580301 |      6.3 | 0.0406 | 5.59E+44 |    5.57E-03 |  -2.25E+00 |      5.50E+45 |     45.7 |    9.83140851287093 |   9.57E+26 | 1.20E+02 | 2.17E+01 |      8.00E-04 |     8.89E+04 |  76.187 |   6.776968650707E+042 |           3.12E+42 |                5.89E-13 |              2.71E-13 |          nan |      nan |      nan |             nan |      nan |      nan |       nan |      nan |      nan |          3.14 |  0.19 |  0.12 |           1.46 |     0.72 |  0.34 |         0.5 |  0.41 |     0 |         10 |        0 |     3.42 |        63.96 | 12.39 |  4.38 |     0.64 |  0.18 |     0.11 |          673580301 |          0.49 | 3704844.63257913 |       6.56877 | 0.05 | 0.07 |           3 |     0 |    0 |            2.2 |    0 |    0 |             1.9 |    0 |    0 |           2 | 0 | 0 |          2 | 0 |    0 |       300 |      0 |       0 |          40 |     0 | 29.25 |
|          673580401 |      6.3 | 0.0406 | 4.25E+44 |    1.45E-02 |  -1.84E+00 |      5.50E+45 |     45.7 |    12.9443647525853 |   9.57E+26 | 2.27E+02 | 4.84E+01 |      2.38E-04 |     2.17E+05 | 104.938 | 1.53512089791705E+043 |           6.15E+42 |                1.33E-12 |              5.34E-13 |          nan |      nan |      nan |             nan |      nan |      nan |       nan |      nan |      nan |          3.14 |  0.16 |  0.15 |           1.45 |     0.39 |  0.15 |         0.5 |  2.91 |     0 |         10 |        0 |     3.45 |        79.07 |  0.93 |   9.9 |     0.57 |  0.09 |      0.1 |          673580401 |          0.39 | 2813876.28947399 |      6.449305 | 0.05 | 0.05 |          17 |     0 | 6.29 |            2.3 | 0.31 | 0.23 |             1.7 | 0.51 |    0 |           1 | 0 | 0 |          3 | 0 |  0.3 |       500 | 510.72 |  171.17 |          20 |  2.88 |  2.05 |
|          780560101 |      6.3 | 0.0406 | 5.36E+44 |    8.20E-03 |  -2.09E+00 |      5.50E+45 |     45.7 |    10.2575995904801 |   9.57E+26 | 3.79E+01 | 4.13E+01 |      9.38E-04 |     6.83E+04 |  31.859 | 1.11441843574543E+043 |           4.39E+42 |                9.69E-13 |              3.82E-13 |          nan |      nan |      nan |             nan |      nan |      nan |       nan |      nan |      nan |           3.4 |     0 |  0.06 |           2.14 |     0.22 |  0.14 |         0.5 |   1.5 |     0 |         10 |        0 |     1.11 |        67.41 |   3.7 |  2.26 |     0.83 |  0.03 |     0.03 |          780560101 |          1.17 | 3550912.73921503 |       6.55034 | 0.01 | 0.02 |          20 |     0 |    0 |            2.4 |    0 |    0 |             1.8 |    0 |    0 |           1 | 0 | 0 |          3 | 0 |    0 |       500 |      0 |       0 |          40 |     0 | 22.58 |
|          780561301 |      6.3 | 0.0406 | 2.18E+44 |    2.83E-02 |  -1.55E+00 |      5.50E+45 |     45.7 |    25.2550214785289 |   9.57E+26 | 4.23E+01 | 9.99E+00 |      1.47E-03 |     2.81E+05 | 117.957 | 1.73540819722049E+043 |           6.17E+42 |                1.51E-12 |              5.37E-13 |          nan |      nan |      nan |             nan |      nan |      nan |       nan |      nan |      nan |          3.32 |  0.07 |  0.07 |           2.17 | 2.00E-01 |  0.13 |         0.5 |  0.28 |     0 |         10 |        0 |     0.83 |        75.91 |  3.31 |  2.98 |     0.62 |  0.07 |     0.04 |          780561301 |          1.22 | 1442241.53959121 |      6.159038 | 0.03 | 0.04 |          19 |     0 |    0 |            2.7 |    0 | 0.62 |             2.3 | 0.39 |    0 |           3 | 0 | 0 |          2 | 0 | 0.28 |      1200 |      0 |  740.25 |          60 | 16.04 | 49.42 |
|          780561401 |      6.3 | 0.0406 | 3.56E+44 |    2.00E-02 |  -1.70E+00 |      5.50E+45 |     45.7 |    15.4354658842166 |   9.57E+26 | 9.79E+01 | 4.71E+01 |      4.36E-04 |     2.11E+05 |   76.21 | 1.90945666875047E+043 |           7.11E+42 |                1.66E-12 |              6.19E-13 |          nan |      nan |      nan |             nan |      nan |      nan |       nan |      nan |      nan |          3.26 |  0.14 |  0.15 |           2.03 |     0.29 |  0.26 |         0.5 |  1.37 |     0 |         10 |        0 |     1.74 |         73.7 |  3.61 |  3.12 |     0.65 |  0.05 | 1.30E-01 |          780561401 |          2.92 | 2359750.02846189 |      6.372866 | 0.07 | 0.05 |          20 |     0 |    0 |              3 |    0 | 0.73 |             2.8 |  0.1 |    0 |           3 | 0 | 0 |          3 | 0 |    0 |       800 |      0 |  480.37 |          20 | 68.79 |     0 |
|          780561501 |      6.3 | 0.0406 | 7.53E+43 |    5.03E-02 |  -1.30E+00 |      5.50E+45 |     45.7 |    72.9974588926349 |   9.57E+26 | 2.57E+01 | 9.84E+00 |      1.47E-03 |     1.76E+05 | 117.074 |  8.4485464766244E+042 |           3.79E+42 |                7.35E-13 |              3.29E-13 |          nan |      nan |      nan |             nan |      nan |      nan |       nan |      nan |      nan |          3.36 |  0.04 |  0.12 |           1.91 |     0.16 |  0.19 |        0.96 |  1.71 |  0.46 |         10 |        0 |     1.56 |        66.95 |  6.15 |  4.11 |     0.78 |  0.04 |     0.05 |          780561501 |          0.22 | 498974.095977438 |      5.698078 | 0.16 | 0.15 |           6 |     0 |    0 |            2.3 |    0 | 0.59 |             2.2 |    0 | 0.69 |           1 | 0 | 0 |          1 | 0 |    0 |      1200 |      0 |       0 |         140 |     0 |     0 |
|          780561601 |      6.3 | 0.0406 | 2.32E+44 |    3.76E-02 |  -1.42E+00 |      5.50E+45 |     45.7 |    23.7071169536879 |   9.57E+26 | 5.18E+01 | 1.38E+01 |      8.00E-04 |     4.08E+05 | 117.954 | 2.46839951180331E+043 |           8.72E+42 |                2.15E-12 |              7.59E-13 |          nan |      nan |      nan |             nan |      nan |      nan |       nan |      nan |      nan |           3.3 |  0.07 |  0.09 |           2.18 |     0.21 |  0.14 |         0.5 |  0.26 |     0 |         10 |        0 |     1.13 |        77.41 |  2.58 |  2.54 |      0.6 |  0.07 |     0.07 |          780561601 |          1.28 | 1536409.55712822 |      6.186507 | 0.02 | 0.13 |          14 |     0 |    0 |            2.7 |    0 |    0 |             2.5 |    0 |    0 |           3 | 0 | 0 |          3 | 0 |    0 |      1300 |      0 |  886.47 |          20 |     0 |     0 |
|          780561701 |      6.3 | 0.0406 | 2.74E+44 |    1.67E-02 |  -1.78E+00 |      5.50E+45 |     45.7 |     20.090499854953 |   9.57E+26 | 3.57E+01 | 3.63E+01 |      4.36E-04 |     2.23E+05 | 127.117 | 1.13826189123344E+043 |           4.57E+42 |                9.90E-13 |              3.97E-13 |          nan |      nan |      nan |             nan |      nan |      nan |       nan |      nan |      nan |          3.32 |  0.08 |  0.15 |            2.1 |     0.22 |  0.31 |         0.5 |  2.79 |     0 |         10 |        0 |      1.3 |        70.19 |  4.91 |  3.86 |     0.66 |  0.07 |     0.15 |          780561701 |          0.12 | 1812988.29409777 |      6.258395 | 0.09 | 0.11 |           9 |     0 |    0 |            2.4 |    0 |    0 |             1.9 |    0 |    0 |           2 | 0 | 0 |          1 | 0 |    0 |       500 |      0 |       0 |         120 |     0 |     0 |
|          792180101 |      6.3 | 0.0406 | 2.88E+44 |    1.51E-02 |  -1.82E+00 |      5.50E+45 |     45.7 |    19.1097384139427 |   9.57E+26 | 5.14E+01 | 4.12E+01 |      4.36E-04 |     1.83E+05 | 114.179 |  9.7551554312406E+042 |           4.36E+42 |                8.48E-13 |              3.79E-13 |          nan |      nan |      nan |             nan |      nan |      nan |       nan |      nan |      nan |          3.19 |  0.09 |  0.13 |           1.92 |     0.13 |  0.21 |        0.99 |  2.11 |  0.49 |         10 |        0 |     1.32 |        69.02 |   4.2 |  2.33 |     0.76 |  0.04 |     0.07 |          792180101 |          0.13 | 1906035.56525019 |      6.280131 |  0.1 | 0.12 |          18 |     0 |    0 |            2.6 |    0 |    0 |             1.7 |    0 |    0 |           1 | 0 | 0 |          1 | 0 |    0 |      1100 |      0 |  905.71 |         120 |     0 |     0 |
|          792180201 |      6.3 | 0.0406 | 3.52E+44 |    1.35E-02 |  -1.87E+00 |      5.50E+45 |     45.7 |    15.6168609058953 |   9.57E+26 | 1.12E+01 | 8.88E+00 |      1.47E-03 |     1.20E+02 |  119.63 | 1.21020898155548E+043 |           4.74E+42 |                1.05E-12 |              4.12E-13 |          nan |      nan |      nan |             nan |      nan |      nan |       nan |      nan |      nan |           3.3 |  0.07 |  0.17 |           2.11 |     0.19 |   0.1 |         0.5 |  0.22 |     0 |         10 |        0 |     0.62 |        69.15 |  2.82 |  1.97 |     0.67 |  0.04 |     0.12 |          792180201 |          0.75 | 2332340.74882826 |      6.367792 | 0.04 | 0.03 |          12 |     0 |    0 |            2.5 |    0 |    0 |             1.7 |    0 |    0 |           1 | 0 | 0 |          3 | 0 |    0 |       300 |      0 |       0 |          20 | 47.51 | 13.17 |
|          792180301 |      6.3 | 0.0406 | 3.59E+44 |    7.88E-03 |  -2.10E+00 |      5.50E+45 |     45.7 |    15.3009621980567 |   9.57E+26 | 1.41E+02 | 4.18E+01 |      4.36E-04 |     1.08E+05 | 119.508 |  5.8037950631359E+042 |           2.83E+42 |                5.05E-13 |              2.46E-13 |          nan |      nan |      nan |             nan |      nan |      nan |       nan |      nan |      nan |          3.33 |  0.07 |  0.17 |           1.84 |     0.54 |  0.71 |         2.8 |  3.91 |   2.3 |         10 |        0 |     3.64 |        58.47 | 12.91 |  9.32 |     0.76 |  0.08 |     0.07 |          792180301 |          1.33 |  2380493.5002211 |      6.376667 | 0.04 | 0.03 |           6 | 10.31 |    0 |              3 |    0 |    0 |             2.8 |    0 |    0 |           3 | 0 | 0 |          2 | 0 |    0 |       200 |   7.72 |       0 |         110 |  0.34 |  4.66 |
|          792180401 |      6.3 | 0.0406 | 3.10E+44 |    4.51E-02 |  -1.35E+00 |      5.50E+45 |     45.7 |    17.7405362059206 |   9.57E+26 | 8.29E+01 | 3.57E+01 |      4.36E-04 |     5.22E+05 | 111.297 | 3.96198708997569E+043 |           1.40E+43 |                3.45E-12 |              1.22E-12 |          nan |      nan |      nan |             nan |      nan |      nan |       nan |      nan |      nan |          3.01 |  0.04 |  0.03 |           1.11 |     0.16 |  0.08 |        2.35 |  0.98 |  1.13 |         10 | 0.00E+00 | 4.30E-01 |        79.84 |  0.16 |  2.72 |     0.15 |  0.08 |     0.09 |          792180401 |          0.66 |  2053142.0604664 |      6.312419 | 0.05 | 0.09 |           5 |     0 |    0 |            2.3 |    0 |    0 |             1.8 |    0 |    0 |           1 | 0 | 0 |          1 | 0 |    0 |      1000 |      0 |  639.66 |         120 |     0 | 41.11 |
|          792180501 |      6.3 | 0.0406 | 2.58E+44 |    2.47E-02 |  -1.61E+00 |      5.50E+45 |     45.7 |      21.35717184949 |   9.57E+26 | 6.17E+01 | 3.16E+01 |      4.36E-04 |     2.19E+05 | 112.297 | 1.57013539198129E+043 |           6.37E+42 |                1.37E-12 |              5.54E-13 |          nan |      nan |      nan |             nan |      nan |      nan |       nan |      nan |      nan |          3.16 |  0.15 |  0.16 |           1.43 |     0.39 |  0.11 |         0.5 |  1.04 |     0 |         10 |        0 |     3.79 |        70.06 |  9.06 |  3.77 |     0.49 |  0.15 |     0.11 |          792180501 |          0.19 | 1705461.81471459 |      6.231842 | 0.05 | 0.04 |          12 |     0 |    0 |            2.5 |    0 |    0 |             2.2 |    0 |    0 |           1 | 0 | 0 |          1 | 0 |    0 |       700 |      0 |  527.71 |         110 |     0 | 60.68 |
|          792180601 |      6.3 | 0.0406 | 2.74E+44 |    4.80E-02 |  -1.32E+00 |      5.50E+45 |     45.7 |    20.0485395767932 |   9.57E+26 | 5.32E+01 | 3.71E+01 |      4.36E-04 |     5.38E+05 | 117.033 | 3.93167029545318E+043 |           1.32E+43 |                3.42E-12 |              1.14E-12 |          nan |      nan |      nan |             nan |      nan |      nan |       nan |      nan |      nan |           3.3 |  0.08 |  0.06 |           1.48 |     0.49 |  0.11 |        2.92 |  1.63 |  1.85 |         10 |        0 |     1.77 |        74.39 |  2.52 |  2.21 |     0.29 |  0.08 |     0.08 |          792180601 |          0.19 | 1816782.75966616 |      6.259303 | 0.05 | 0.06 |           8 |     0 |    0 |            2.1 |    0 |    0 |             1.8 |    0 |    0 |           3 | 0 | 0 |          1 | 0 |    0 |       600 |      0 |       0 |         110 |     0 |     0 |



** Fmax results plot for all free parameters

PATH
=/home/steff075/phd_ecm/results-for-all/IRAS_Lum2-10_ecm_freepars.vsz=


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/IRAS_Lum2-10_ecm_freepars.png

* *IRAS and 1H0707 ECM parameters together with L_{(2-10keV)} and L_{Edd}*

PATH =
=/home/steff075/phd_ecm/results-for-all/1H_AND_IRAS_Lum2-10_ecm_freepars.vsz=



** All ECM parameters
PATH =
=/home/steff075/phd_ecm/results-for-all/1H_AND_IRAS_Lum2-10_ecm_freepars.vsz=

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H_AND_IRAS_Lum2-10_ecm_freepars.png


pdf at:

http://www.star.bris.ac.uk/steff/ecm/1H_AND_IRAS_Lum2-10_ecm_freepars.pdf

** All RELXILL parameters


PATH =
=/home/steff075/phd_ecm/results-for-all/1H_AND_IRAS_Lum2-10_relxill_correlated.vsz=

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H_AND_IRAS_Lum2-10_relxill_correlated.png

And also to include the soft lag (removing the near contant RF)


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H_AND_IRAS_Lum2-10_relxill_correlated2.png


** Luminosity (2-10 keV) versus All Gamma

PATH =
=/home/steff075/phd_ecm/results-for-all/1H_AND_IRAS_ecm_gammaVL2-10.vsz=


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H_AND_IRAS_ecm_gammaVL2-10.png

** L_{Edd}  versus All Gamma


PATH =
=/home/steff075/phd_ecm/results-for-all/1H_AND_IRAS_ecm_gammaVLedd.vsz=


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H_AND_IRAS_ecm_gammaVLedd.png

** L_{Edd}  versus H2, Tmax. Tshift and logM


PATH =
=/home/steff075/phd_ecm/results-for-all/1H_AND_IRAS_ecm_gammaVLedd.vsz=


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H_AND_IRAS_ecm_MassVLedd.png

* *IRAS and 1H0707 ECM parameters SINGLE OBS ONLY with L_{(2-10keV)} and L_{Edd}*

1H0707 PATH To csv = =1H0707-495_results_fmax_single.csv=

IRAS PATH to csv = =IRAS_results_single_for_fmax.ods=

AND =1H_AND_IRAS_results_relxill_single_obs.vsz=

** Luminosity (2-10) versus RELXILL

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H_AND_IRAS_results_relxill_single_obs.png


** Luminosity (2-10) versus ECM

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H_AND_IRAS_results_ecm_single_obs.png

* *IRAS and 1H0707 ECM parameters Combination spectra OBS ONLY with L_{(2-10keV)} and L_{Edd}*

1H0707 PATH To csv = =1H0707-495_results_fmax_combinations.ods=

IRAS PATH to csv = =IRAS_results_combinations_for_fmax.ods=

AND =1H_AND_IRAS_results_relxill_combination_obs.vsz=

AND =1H_AND_IRAS_results_ecm_combination_obs.vsz=


** Luminosity (2-10) versus RELXILL

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H_AND_IRAS_results_relxill_combonation_obs.png


** Luminosity (2-10) versus ECM

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H_AND_IRAS_results_ecm_combination_obs.png

** Lag versus ECM freepars

PATH =
=/home/steff075/phd_ecm/results-for-all/1H_and_IRAS_lag_V_ecm_freepar.vsz=


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/1H_and_IRAS_lag_V_ecm_freepar.png

pdf at:

http://www.star.bris.ac.uk/steff/ecm/1H_and_IRAS_lag_V_ecm_freepar.pdf

* IRAS and 1H0707 ind-obs correlations

PATH =
=/home/steff075/phd_ecm/results-spectral/spearman_ECM_indobs.py=

*Moderate correlations found*

#+BEGIN_EXAMPLE
Lag - h2 SpearmanrResult(correlation=0.4176100720242651, pvalue=0.017397748687698847)
Lag - g2 SpearmanrResult(correlation=0.44625356679446826, pvalue=0.010464190370222873)
Lag - xi SpearmanrResult(correlation=-0.23259925942484017, pvalue=0.20016320767621765)

Lag_freq - h2 SpearmanrResult(correlation=-0.3701372066792565, pvalue=0.0370496493409622)

Edd_frac - Cvr SpearmanrResult(correlation=-0.6122673744025592, pvalue=0.00019588083146469086)

L2_10 - Cvr SpearmanrResult(correlation=-0.4116245234587626, pvalue=0.019247811495704783)
L2_10 - h2 SpearmanrResult(correlation=-0.2001690462654116, pvalue=0.27201240171726976)
L2_10 - g1 SpearmanrResult(correlation=0.23294837081152178, pvalue=0.19946955553486928)
L2_10 - g2 SpearmanrResult(correlation=-0.22851554818194678, pvalue=0.20840145460223602)
L2_10 - xi SpearmanrResult(correlation=0.2838015865570663, pvalue=0.11546115253645785)
L2_10 - b SpearmanrResult(correlation=-0.12905732065311087, pvalue=0.48145461310718984)
L2_10 - tmax SpearmanrResult(correlation=0.31308522806133804, pvalue=0.0810228517022941)
L2_10 - tshift SpearmanrResult(correlation=0.2213251963903714, pvalue=0.2234675781368824)

g2 - Fe SpearmanrResult(correlation=-0.3942223329441335, pvalue=0.02557369624624326)

xi - nH SpearmanrResult(correlation=-0.46929897392183756, pvalue=0.006734782575648992)

b - inc SpearmanrResult(correlation=-0.48965580122099384, pvalue=0.004448639480651619)

tmax - Fe SpearmanrResult(correlation=0.4074232913500254, pvalue=0.020641453312916783)

tshift - Fe SpearmanrResult(correlation=0.4486233994640729, pvalue=0.010014047868650955)

g1 - tshift SpearmanrResult(correlation=0.3809837089191086, pvalue=0.03145233280411848)
g1 - tmax SpearmanrResult(correlation=0.5907594693990914, pvalue=0.00037115806452657946)
g2 - h2 SpearmanrResult(correlation=0.48212990516860066, pvalue=0.005200748114674018)
g2 - xi SpearmanrResult(correlation=-0.48187893472395027, pvalue=0.005227599261777844)
g2 - b SpearmanrResult(correlation=0.35497672455365503, pvalue=0.04619358520274698)
g2 - tshift SpearmanrResult(correlation=-0.5940679921921527, pvalue=0.00033739169488348873)
g2 - tmax SpearmanrResult(correlation=-0.5494083702583216, pvalue=0.001126695569602602)

b - tmax SpearmanrResult(correlation=-0.41114715000785734, pvalue=0.019402127715839036)
xi - h2 SpearmanrResult(correlation=-0.4227995248404496, pvalue=0.015915783815082168)

xi - g2 SpearmanrResult(correlation=-0.4818789347239502, pvalue=0.00522759926177785)

tshift - g1 SpearmanrResult(correlation=0.3809837089191086, pvalue=0.03145233280411848)

tshift - tmax SpearmanrResult(correlation=0.3599779492833517, pvalue=0.042996943484295023)

tmax - g2 SpearmanrResult(correlation=-0.5494083702583217, pvalue=0.0011266955696025995)

tmax - b SpearmanrResult(correlation=-0.41114715000785734, pvalue=0.019402127715839036)
tmax - tshift SpearmanrResult(correlation=0.3599779492833517, pvalue=0.042996943484295023)

#+END_EXAMPLE

** g1 - tmax

PATH =
=/home/steff075/phd_ecm/results-spectral/ecm_correlate_g1_tmax.py=

#+BEGIN_EXAMPLE
tmax - g1 SpearmanrResult(correlation=0.5907594693990914, pvalue=0.00037115806452657946)
mean_g1: 2.643
sigma_g1: 0.534
mean_tmax: 518.688
sigma_tmax: 206.529

#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/ecm_g1_tmax_polyfit_indobs.png

pdf at:

http://www.star.bris.ac.uk/steff/ecm/ecm_g1_tmax_polyfit_indobs.pdf

** g2 - tmax

PATH =
=/home/steff075/phd_ecm/results-spectral/ecm_correlate_g2_tmax.py=

#+BEGIN_EXAMPLE
tmax - g2 SpearmanrResult(correlation=-0.5494083702583217, pvalue=0.0011266955696025995)
mean_g2: 1.692
sigma_g2: 0.468
mean_tmax: 518.688
sigma_tmax: 206.529
#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/ecm_g2_tmax_polyfit_indobs.png

pdf at:

http://www.star.bris.ac.uk/steff/ecm/ecm_g2_tmax_polyfit_indobs.pdf



** g2 - tshift

PATH =
=/home/steff075/phd_ecm/results-spectral/ecm_correlate_g2_tshift.py=

#+BEGIN_EXAMPLE
tshift - g2 SpearmanrResult(correlation=-0.5940679921921527, pvalue=0.00033739169488348873)
mean_g2: 1.692
sigma_g2: 0.468
mean_tshift: 69.381
sigma_tshift: 48.774

#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/ecm_g2_tshift_polyfit_indobs.png

pdf at:

http://www.star.bris.ac.uk/steff/ecm/ecm_g2_tshift_polyfit_indobs.pdf


** tmax - tshift

PATH =
=/home/steff075/phd_ecm/results-spectral/ecm_correlate_tmax_tshift.py=

#+BEGIN_EXAMPLE
tmax - tshift SpearmanrResult(correlation=-0.5494083702583217, pvalue=0.0011266955696025995)

mean_tmax: 518.688
sigma_tmax: 206.529

mean_tshift: 69.381
sigma_tshift: 48.774

#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/ecm_tshift_tmax_polyfit_indobs.png

pdf at:

http://www.star.bris.ac.uk/steff/ecm/ecm_tshift_tmax_polyfit_indobs.pdf

** h2 - Lag

PATH =
=/home/steff075/phd_ecm/results-spectral/ecm_correlate_lag_h2.py=

#+BEGIN_EXAMPLE
Lag - h2 SpearmanrResult(correlation=0.4176100720242651, pvalue=0.017397748687698847)
mean_Lag: 104.937
sigma_Lag: 121.287
mean_h2: 10.958
sigma_h2: 5.439

#+END_EXAMPLE

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/ecm_lag_h2_polyfit_indobs.png

pdf at:

http://www.star.bris.ac.uk/steff/ecm/ecm_lag_h2_polyfit_indobs.pdf




* *IRAS 13224-3809 Table Model fits and EMCEE on best fits*

PATH = =/data/typhon1/reverb/table-model-ecm-fits/IRAS13224-3809=

** Creating the table model

Note: for IRAS 13224-3809, code submit-blob-delta.pl has been run for

Fixed:
+-----+-------+
| Par | Value |
+-----+-------+
| h1  |     2 |
+-----+-------+
| A   |     1 |
+-----+-------+
| p   |     0 |
+-----+-------+
| q2  |   0.5 |
+-----+-------+


Variable:

+--------+-----+------+
| Par    | min |  max |
+--------+-----+------+
| h2     |   3 |   20 |
+--------+-----+------+
| gamma1 | 1.8 |  3.1 |
+--------+-----+------+
| gamma2 | 1.7 |  3.0 |
+--------+-----+------+
| xi     |   0 |    3 |
+--------+-----+------+
| b      |   1 |    3 |
+--------+-----+------+
| tmax   | 100 | 1500 |
+--------+-----+------+
| tshift |   0 |  150 |
+--------+-----+------+

Therefore that table model should be created within this parameter
space


*Run* table-models.py for above par range (took around 48 hrs)

*Output* = =tab_rev.mod= (size = 18 gb)

** Combined

#+BEGIN_EXAMPLE
source("fit-table-model-comb.sl");

t_g = 2.266633e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.07707608
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         4.732302           0         100
  2  lag_freq(1).log_mass   0     0         6.662795         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         12.84473           3          20
  7  lag_freq(1).Gamma1     0     0         2.632042           2         3.3
  8  lag_freq(1).Gamma2     0     0         1.700001         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0     1.588869e-08           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.491961           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         306.6571         100        1400
 15  lag_freq(1).t_shift    0     0         19.30878          10         120
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -2.0576e-03     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-comb-time-lags-fmax.fits


#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 4.732302e+00 | +1.144688e-01 | -1.488593e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.662795e+00 | +8.380432e-05 | -9.762414e-03 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 1.284473e+01 | +9.136535e-01 | -1.806116e-09 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 2.632042e+00 | +2.260046e-01 | -2.363843e-05 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 1.700001e+00 | +4.211279e-07 | -6.393035e-07 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 1.588869e-08 | +3.000000e+00 | -1.588869e-08 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 2.491961e+00 | +1.937396e-09 | -1.013972e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 3.066571e+02 | +4.210223e+01 | -5.282591e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 1.930878e+01 | +6.891744e-01 | -8.991385e-10 |
+----------------------+--------------+---------------+---------------+


*Using the new =tab_rev.mod= (dated 26 Mar 2021)*

Fitting above pars

#+BEGIN_EXAMPLE
t_g = 2.267404e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.004649935
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0          4.13536           0         100
  2  lag_freq(1).log_mass   0     0         6.662943         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         12.72686           3          20
  7  lag_freq(1).Gamma1     0     0         2.624423           2         3.1
  8  lag_freq(1).Gamma2     0     0         1.700001         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0        0.9999687           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.480987           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         305.2251         100        1500
 15  lag_freq(1).t_shift    0     0         19.44606          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -2.0576e-03     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-comb-time-lags-fmax.fits

#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 4.135360e+00 | +1.931898e+00 | -1.784514e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.662943e+00 | +7.492548e-03 | -1.898795e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 1.272686e+01 | +3.830257e-08 | -4.994069e-05 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 2.624423e+00 | +2.360134e-01 | -9.455370e-11 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 1.700001e+00 | +2.208611e-02 | -7.825400e-07 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 9.999687e-01 | +2.000031e+00 | -9.999687e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 2.480987e+00 | +5.190126e-01 | -4.522483e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 3.052251e+02 | +4.093020e+01 | -3.048097e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 1.944606e+01 | +1.039852e+00 | -7.181914e-07 |
+----------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_comb.gif


pdf at

http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_comb.pdf

[detached from 5693.pts-37.hm00]


*Fixed Mass = 6.45*

#+BEGIN_EXAMPLE
t_g = 1.388628e+01
 Parameters[Variable] = 15[8]
            Data bins = 7
           Chi-square = 2.484217
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         5.341513           0         100
  2  lag_freq(1).log_mass   0     1             6.45           0           0
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         11.95972           3          20
  7  lag_freq(1).Gamma1     0     0         2.452446           2         3.1
  8  lag_freq(1).Gamma2     0     0         1.700001         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         1.999828           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.999999           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         473.1669         100        1500
 15  lag_freq(1).t_shift    0     0         20.07109          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -2.0576e-03     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-comb-tim     e-lags-fmax.fits

#+END_EXAMPLE

+---------------------+--------------+---------------+---------------+
| lag_freq(1).norm    | 5.341513e+00 | +9.758022e-01 | -8.869498e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).h2      | 1.195972e+01 | +1.038526e-01 | -2.370650e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1  | 2.452446e+00 | +4.234613e-02 | -7.398753e-02 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2  | 1.700001e+00 | +6.266345e-02 | -5.535083e-07 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).xi      | 1.999828e+00 | +4.143519e-01 | -1.999828e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).b       | 2.999999e+00 | +1.108256e-06 | -8.375640e-02 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_max   | 4.731669e+02 | +2.314837e+01 | -2.314734e+01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift | 2.007109e+01 | +9.878160e-02 | -2.438382e-01 |
+---------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_comb_fm.gif

** Combined EMCEE

PATH =/data/typhon1/reverb/IRAS13224-3809=

Run = =emcee-combined.sl= for 200 walkers and 10000 iterations

OUTPUT = =IRAS_test_chain.fits=

Once this chain is created please ensure you COMMENT OUT the following
code (around line 98) otherwise chain will run again!

#+BEGIN_EXAMPLE
emcee(200, 10000; output="IRAS_test_chain.fits", serial);
#+END_EXAMPLE


Now fit the emcee

#+BEGIN_EXAMPLE
isis
.source("emcee-combined.sl");


#+END_EXAMPLE

The following steps were completed:


*Norm Walkers*

#+BEGIN_EXAMPLE
% Read the chain-file
(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("IRAS_test_chain.fits");

close_plot; % start with a fresh plot window
_for i (0, nw-1, 0) { % loop over all walkers and plot their path
  chain_plot(0,i, nw, chain; oplot);
};

% Make good image of the paths of the walkers
variable pid = open_plot("IRAS_comb_tm_walkers_norm.ps/cps");
charsize(1.3); %good font size
_pgscf(2); %make font roman
chain_plot(0,i,nw,chain);
close_plot(pid);
#+END_EXAMPLE


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_comb_tm_walkers_norm-1.png


*Mass Walkers*

#+BEGIN_EXAMPLE
% Read the chain-file
(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("IRAS_test_chain.fits");

close_plot; % start with a fresh plot window
_for i (0, nw-1, 1) { % loop over all walkers and plot their path
  chain_plot(0,i, nw, chain; oplot);
};

% Make good image of the paths of the walkers
variable pid = open_plot("IRAS_comb_tm_walkers.ps/cps");
charsize(1.3); %good font size
_pgscf(2); %make font roman
chain_plot(1,i,nw,chain);
close_plot(pid);
#+END_EXAMPLE


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_comb_tm_walkers-1.png


*Acceptence rate*

#+BEGIN_EXAMPLE
% Obtain acceptance Rate
frac_update = read_chain("IRAS_comb_tm_chain.fits"; frac_update);
xlabel("Iteration Step");
ylabel("Acceptance Rate");
popt.dsym = [6];
popt.dcol = 4;
plot([0:length(frac_update)-1], frac_update);
plot(([0:length(frac_update)-1], frac_update); dsym=6, dcol=2);

% Make good image of the acceptance Rate
variable pid = open_plot("IRAS_comb_tm_mass_accept_rate.ps/cps");
charsize(1.3); %good font size
_pgscf(2); %make font roman
xlabel("Iteration Step");
ylabel("Acceptance Rate");
plot([0:length(frac_update)-1], frac_update);
close_plot(pid);
#+END_EXAMPLE


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_comb_tm_mass_accept_rate-1.png

*Norm probability*

#+BEGIN_EXAMPLE
% Obtain the probability distributions of the norm
chain_hist(0, chain; fcut = 0.3, pmin = 0, pmax = 100, nbin = nbin); % norm

% Make good image of the Norm probability
variable pid = open_plot("IRAS_comb_tm_norm_prob.ps/cps");
charsize(1.3); %good font size
_pgscf(2); %make font roman
chain_hist(0,chain; fcut = 0.3, min = 0, pmax = 100, nbin=300);
close_plot(pid);
#+END_EXAMPLE


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_comb_tm_norm_prob-1.png


*Mass probability*

#+BEGIN_EXAMPLE
% Obtain the probability distributions of the log_mass and other parameters
chain_hist(1, chain; fcut = 0.3, pmin = 5.0, pmax = 8.0, nbin = nbin); % log_mass

% Make good image of the Mass probability
variable pid = open_plot("IRAS_comb_tm_mass_prob.ps/cps");
charsize(1.3); %good font size
_pgscf(2); %make font roman
chain_hist(1,chain; fcut = .3);
close_plot(pid);
#+END_EXAMPLE


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_comb_tm_mass_prob-1.png






*Contours: paths in 2D*

#+BEGIN_EXAMPLE
% Contours: paths in 2D
%where 1 = x and 0 = y axis parameters
chain_hist2d(1, 0, chain; nbinx = 200, nbiny = 200, xlo = 5.0, xhi = 8.0, ylo = 0, yhi = 100);

%Make good image of the Contours
variable pid = open_plot("IRAS_comb_tm_chain_hist2d.ps/cps");
charsize(1.3); %good font size
_pgscf(2); %make font roman
chain_hist2d(1,0,chain; nbinx = 300, nbiny = 300, xlo = 5.0, xhi = 8.0, ylo = 0, yhi = 100);
close_plot(pid);
#+END_EXAMPLE


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_comb_tm_chain_hist2d-1.png


*Statistics*

#+BEGIN_EXAMPLE
(frac_update, min_statistic, med_statistic, max_statistic) = read_chain("IRAS_test_chain.fits"; chain_stats);

% Chain statistics starting at s=iteration where the fit converged
s=600; % start at this iteration step
min(min_statistic[[s:]]);

% Plot the statistic array
n=length(max_statistic)-1;
yrange(min(min_statistic[[s:]])*.9, max(max_statistic[[s:]])*1.1);
variable pid = open_plot("IRAS_comb_tm_statistics.ps/cps");
charsize(1.3); %good font size
_pgscf(2); %make font roman
plot([s:n], min_statistic[[600:]]); % Black
oplot([s:n], max_statistic[[600:]]); % Red
oplot([s:n], med_statistic[[600:]]); % Green
close_plot(pid);
#+END_EXAMPLE


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_comb_tm_statistics-1.png


*Mass distribution confidence (error analysis)*

#+BEGIN_EXAMPLE
variable p = 1; % index of the parameter of interest (here: norm(0))
variable lvl = 0.90; % confidence interval to find
variable fcut = 0.2; % throw away the first fcut-fraction of the chain
variable nbin = 300; % number of histogram bins
chain_hist(p, chain; fcut = fcut, nbin = nbin);
%close_plot;

variable pmin=5.5, pmax=7.0;
%(pmin,pmax,,) = cursor_box();
%pmin; %pmax;

% histogram to get the parameter's probability distribution
variable lo, hi;
(lo, hi) = linear_grid(pmin, pmax, nbin);
variable hist = 1.*histogram(chain[p], lo, hi);
variable nmax = where_max(hist)[0];% find maximum

% do a linear regression of the first and last n bins
variable n = 10;
variable ind = [[0:n-1], [nbin-n:nbin-1]];
variable lin = linear_regression(0.5*(lo+hi)[ind], hist[ind]);% linear regression

% subtract the linear continuum from the probability distribution
variable newhist = hist - (lin.a + lin.b*.5*(lo+hi));
newhist /= sum(newhist);% finally, normalize!

% Determine confidence interval
variable li = [:nmax], ri = [nmax+1:];
variable conf_min = lo[li][wherefirst(cumsum(newhist[li]) > .5 - .5*lvl)];
variable conf_max = hi[ri][wherefirst(cumsum(newhist[ri]) > .5*lvl)];
variable conf_mean = conf_min + ((conf_max - conf_min) / 2);
conf_min; conf_max; conf_mean;

%% Plot the parameter with conf regions

%variable pid = open_plot("IRAS_comb_tm_logmass_conf68.ps/cps");
variable pid = open_plot("IRAS_comb_tm_logmass_conf90.ps/cps");
chain_hist(1, chain; fcut = fcut, nbin = nbin, pmin=pmin, pmax=pmax);
_pgmove(conf_min, 0);
_pgsls(2); % line style - dashed
_pgsci(1); % line color
_pgslw(1); % line width
_pgdraw(conf_min, 100);
_pgmove(conf_max, 0);
_pgsls(2); % line style - dashed
_pgsci(1);
_pgslw(1);
_pgdraw(conf_max, 100);
_pgmove(conf_mean, 0);
_pgsls(1); % line style - solid
_pgsci(4);
_pgslw(2);
_pgdraw(conf_mean, 100);
charsize(1.3); %good font size
_pgscf(2); %make font roman
%close_plot;
close_plot(pid);
#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_comb_tm_logmass_conf90-1.png
** Combined EMCEE - by reading the lag-files AND TM and importing emcee on rough par file

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/IRAS13224-3809/fit-tm-emcee-comb.sl=


Run chain  200 walkers and 20,000 iterations = =IRAS_tm_emcee_comb.fits=

Best table model fit is

#+BEGIN_EXAMPLE
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         4.732302           0         100
  2  lag_freq(1).log_mass   0     0         6.662795         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         12.84473           3          20
  7  lag_freq(1).Gamma1     0     0         2.632042           2         3.3
  8  lag_freq(1).Gamma2     0     0         1.700001         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0     1.588869e-08           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.491961           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         306.6571         100        1400
 15  lag_freq(1).t_shift    0     0         19.30878          10         120
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -2.0576e-03     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-comb-time-lags-fmax.fits



#+END_EXAMPLE

Dont start at the best fit - provide a rough parfile =tm_comb_test.par=

#+BEGIN_EXAMPLE
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         4.732302           0         100
  2  lag_freq(1).log_mass   0     0              6.2         5.5           7
  3  lag_freq(1).i          0     1               64          64          64
  4  lag_freq(1).a          0     1            0.998       0.998       0.998
  5  lag_freq(1).h1         0     1                2           2           2
  6  lag_freq(1).h2         0     0               10           3          20
  7  lag_freq(1).Gamma1     0     0              2.4         1.8         3.3
  8  lag_freq(1).Gamma2     0     0              1.8         1.4         3.2
  9  lag_freq(1).Fe         0     1                1           1           1
 10  lag_freq(1).xi         0     0                1           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0                2           1           3
 13  lag_freq(1).q2         0     1              0.5         0.5         0.5
 14  lag_freq(1).t_max      0     0              400          50        1500
 15  lag_freq(1).t_shift    0     0               30          10         150
#+END_EXAMPLE

#+BEGIN_EXAMPLE
Run code:

source("fit-tm-emcee-comb.sl");

emcee(200, 50000; output="IRAS_tm_emcee_comb.fits", serial);

screen 76235




#+END_EXAMPLE

*logM*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/IRAS_tm_comb_walkers-1.png


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/IRAS_tm_comb_mass_accept_rate-1.png


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/IRAS_tm_comb_mass_prob-1.png


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/IRAS_tm_comb_chain_hist2d-1.png



*Norm*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/IRAS_tm_comb_norm_prob-1.png

*h2*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/IRAS_tm_comb_h2_prob-1.png

*g1*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/IRAS_tm_comb_g1_prob-1.png

*g2*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/IRAS_tm_comb_g2_prob-1.png

*xi*


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/IRAS_tm_comb_xi_prob-1.png

*b*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/IRAS_tm_comb_b_prob-1.png

*tmax*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/IRAS_tm_comb_tmax_prob-1.png

*tshift*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/IRAS_tm_comb_tshift_prob-1.png



*Statistics*

#+BEGIN_EXAMPLE
26.1899

#+END_EXAMPLE



#+ATTR_HTML: :width 700
#+CAPTION: The 90% confidence probability for IRAS13224-3809 Mass value where $\mu = 6.\pm0.0$ (solid blue line) with the error range between the black dashed lines.
http://www.star.bris.ac.uk/steff/ecm/


pdf at:


http://www.star.bris.ac.uk/steff/ecm/


** Combined EMCEE - by reading the lag-files AND TM and importing emcee on BC4 fit par file

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/IRAS13224-3809/fit-tm-emcee-comb.sl=


Run chain  200 walkers and 50,000 iterations = =IRAS_tm_bc_emcee_comb.fits=

Best table model fit is

#+BEGIN_EXAMPLE
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.480212e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         6.338148           5           7
  3  lag_freq(1).i          0     1               64          64          64
  4  lag_freq(1).a          0     1            0.998       0.998       0.998
  5  lag_freq(1).h1         0     1                2           2           2
  6  lag_freq(1).h2         0     0                5           3          20
  7  lag_freq(1).Gamma1     0     0              2.6         1.8         3.3
  8  lag_freq(1).Gamma2     0     0              1.9         1.4         3.2
  9  lag_freq(1).Fe         0     1                1           1           1
 10  lag_freq(1).xi         0     0                0           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0                3           1           3
 13  lag_freq(1).q2         0     1              0.5         0.5         0.5
 14  lag_freq(1).t_max      0     0             1300          50        1500
 15  lag_freq(1).t_shift    0     0               10          10         150
#+END_EXAMPLE

#+BEGIN_EXAMPLE
Run code:

source("combined-emcee.sl");

emcee(200, 50000; output="IRAS_tm_bc_emcee_comb.fits", serial);


[detached from 96180.pts-40.hm00]





#+END_EXAMPLE

*logM*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/IRAS_comb_tm_bc_walkers-1.png


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/IRAS_comb_tm_bc_mass_accept_rate-1.png


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/IRAS_comb_tm_bc_mass_prob-1.png


*Norm*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/IRAS_comb_tm_bc_norm_prob-1.png


*2d Contours mass*

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/IRAS_comb_tm_bc_chain_hist2d-1.png


pdf at:
http://www.star.bris.ac.uk/steff/ecm/IRAS_comb_tm_bc_chain_hist2d.pdf


*Statistics*

#+BEGIN_EXAMPLE
chi^2
1.4716217928016013

#+END_EXAMPLE


#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/IRAS_comb_tm_bc_statistics-1.png

#+ATTR_HTML: :width 700
#+CAPTION: The 90% confidence probability for IRAS13224-3809 Mass value where $\mu = 6.338\pm0.0015$ (solid blue line) with the error range between the black dashed lines.
http://www.star.bris.ac.uk/steff/ecm/IRAS_comb_tm_bc_logmass-1.png


pdf at:


http://www.star.bris.ac.uk/steff/ecm/IRAS_comb_tm_bc_logmass.pdf



** Hi-flux

#+BEGIN_EXAMPLE
source("fit-table-model-hiflux.sl");

t_g = 1.377127e+01
  Parameter 15 = 1.200000e+02 (1.163234e+02 - 1.200000e+02)
t_g = 1.377127e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 6.738602
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         99.83985           0         100
  2  lag_freq(1).log_mass   0     0         6.446388         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0                3           3          20
  7  lag_freq(1).Gamma1     0     0         2.890678           2         3.3
  8  lag_freq(1).Gamma2     0     0          1.70611         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         2.999995           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0                3           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         1332.858         100        1400
 15  lag_freq(1).t_shift    0     0              120          10         120
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  2.9503e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-hiflux-time-lags-fmax.fits

| lag_freq(1).norm     | 9.983985e+01 | +1.601488e-01 | -9.939548e+01 |
| lag_freq(1).log_mass | 6.446388e+00 | +1.436866e-02 | -2.620441e-02 |
| lag_freq(1).h2       | 3.000000e+00 | +4.467267e-01 | -1.905883e-07 |
| lag_freq(1).Gamma1   | 2.890678e+00 | +8.877882e-03 | -3.454519e-01 |
| lag_freq(1).Gamma2   | 1.706110e+00 | +4.391283e-01 | -5.665756e-03 |
| lag_freq(1).xi       | 2.999995e+00 | +5.491180e-06 | -1.419264e+00 |
| lag_freq(1).b        | 3.000000e+00 | +3.076736e-07 | -9.255865e-01 |
| lag_freq(1).t_max    | 1.332858e+03 | +6.714186e+01 | -1.278723e+02 |
| lag_freq(1).t_shift  | 1.200000e+02 | +1.543271e-05 | -3.676605e+00 |


#+END_EXAMPLE


Note - this file does not exits closest was:

/data/typhon1/reverb/lag-files/i64/a0.998/h02.0+03.0/g2.9+1.7/A01.0/x3.0/p00.0/b03.0/q0.5/tmax1000>


*Using the new =tab_rev.mod= (dated 26 Mar 2021)*

Fitting above pars

#+BEGIN_EXAMPLE
source("fit-table-model-hiflux.sl");

t_g = 1.137024e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 4.269998
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0        0.8457984           0         100
  2  lag_freq(1).log_mass   0     0         6.363184         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         4.883709           3          20
  7  lag_freq(1).Gamma1     0     0         3.099993           2         3.1
  8  lag_freq(1).Gamma2     0     0         1.700001         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0                3           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.667292           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         956.3312         100        1500
 15  lag_freq(1).t_shift    0     0              150          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  2.9503e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-hiflux-time-lags-fmax.fits

#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 8.457984e-01 | +1.947179e-01 | -4.885763e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.363184e+00 | +3.401927e-03 | -2.260601e-10 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 4.883709e+00 | +1.212768e+00 | -1.883709e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 3.099993e+00 | +7.321025e-06 | -7.166319e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 1.700001e+00 | +7.231154e-01 | -1.346755e-06 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 3.000000e+00 | +4.231444e-07 | -3.000000e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 2.667292e+00 | +3.327084e-01 | -9.728799e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 9.563312e+02 | +5.436688e+02 | -2.740510e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 1.500000e+02 | +1.239231e-05 | -3.174526e+01 |
+----------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_hiflux.gif


pdf at

http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_hiflux.pdf



*Fixed Mass = 6.45*

#+BEGIN_EXAMPLE
t_g = 1.388628e+01
 Parameters[Variable] = 15[8]
            Data bins = 7
           Chi-square = 5.248781
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0        0.5219995           0         100
  2  lag_freq(1).log_mass   0     1             6.45           0           0
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         3.000003           3          20
  7  lag_freq(1).Gamma1     0     0         3.099999           2         3.1
  8  lag_freq(1).Gamma2     0     0         1.700256         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0                3           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0                3           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         1490.793         100        1500
 15  lag_freq(1).t_shift    0     0              120          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  2.9503e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-hiflux-time-lags-fmax.fits

#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 8.457984e-01 | +1.947179e-01 | -4.885763e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.363184e+00 | +3.401927e-03 | -2.260601e-10 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 4.883709e+00 | +1.212768e+00 | -1.883709e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 3.099993e+00 | +7.321025e-06 | -7.166319e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 1.700001e+00 | +7.231154e-01 | -1.346755e-06 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 3.000000e+00 | +4.231444e-07 | -3.000000e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 2.667292e+00 | +3.327084e-01 | -9.728799e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 9.563312e+02 | +5.436688e+02 | -2.740510e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 1.500000e+02 | +1.239231e-05 | -3.174526e+01 |
+----------------------+--------------+---------------+---------------+


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_hiflux_fm.gif

** Hi-cts

#+BEGIN_EXAMPLE
source("fit-table-model-hicts.sl");

 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 9.270033
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         10.52776           0         100
  2  lag_freq(1).log_mass   0     0         6.369684         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         4.748396           3          20
  7  lag_freq(1).Gamma1     0     0              3.1           2         3.1
  8  lag_freq(1).Gamma2     0     0         1.799994         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0             2.84           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.967694           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         904.0258         100        1500
 15  lag_freq(1).t_shift    0     0              150          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  2.6946e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-hi-cts-time-lags-fmax.fits

#+END_EXAMPLE

*Using the new =tab_rev.mod= (dated 26 Mar 2021)*

#+BEGIN_EXAMPLE
source("fit-table-model-hicts.sl");

t_g = 2.258305e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.0001664559
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0          8.05824           0         100
  2  lag_freq(1).log_mass   0     0         6.661197         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         16.18591           3          20
  7  lag_freq(1).Gamma1     0     0         2.508673           2         3.1
  8  lag_freq(1).Gamma2     0     0         1.700179         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         2.261321           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.169902           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         300.1996         100        1500
 15  lag_freq(1).t_shift    0     0         23.76894          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  2.6946e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-hi-cts-time-lags-fmax.fits

#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 8.058240e+00 | +4.628137e+00 | -5.121612e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.661197e+00 | +7.761449e-03 | -1.739973e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 1.618591e+01 | +3.601088e-01 | -3.109219e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 2.508673e+00 | +3.247528e-01 | -1.095191e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 1.700179e+00 | +2.083230e-01 | -1.789196e-04 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 2.261321e+00 | +7.386790e-01 | -2.261321e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 2.169902e+00 | +8.300981e-01 | -4.443907e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 3.001996e+02 | +3.207877e+01 | -4.182110e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 2.376894e+01 | +3.485007e-01 | -1.051925e+00 |
+----------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_hicts.gif


pdf at

http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_hicts.pdf



110576.pts-31.hm00


############################################################################

*Fixed Mass = 6.45*

#+BEGIN_EXAMPLE
t_g = 1.388628e+01
 Parameters[Variable] = 15[8]
            Data bins = 7
           Chi-square = 2.738021
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0          8.43276           0         100
  2  lag_freq(1).log_mass   0     1             6.45           0           0
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         13.63786           3          20
  7  lag_freq(1).Gamma1     0     0         2.436819           2         3.1
  8  lag_freq(1).Gamma2     0     0              1.7         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0        0.2348964           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0                3           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         477.5951         100        1500
 15  lag_freq(1).t_shift    0     0         22.24637          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  2.6946e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-hi-cts-time-lags-fmax.fits

#+END_EXAMPLE

+---------------------+--------------+---------------+---------------+
| lag_freq(1).norm    | 8.432760e+00 | +1.567501e+00 | -2.290023e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).h2      | 1.363786e+01 | +2.285016e-01 | -3.478649e-02 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1  | 2.436819e+00 | +1.056327e-01 | -1.903619e-02 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2  | 1.700000e+00 | +1.362838e-01 | -1.827710e-09 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).xi      | 2.348964e-01 | +2.204556e+00 | -2.348964e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).b       | 3.000000e+00 | +9.819222e-08 | -1.936244e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_max   | 4.775951e+02 | +2.444939e+01 | -3.716006e+01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift | 2.224637e+01 | +3.432078e-01 | -1.414469e-01 |
+---------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_hicts_fm.gif

q** Med-flux

#+BEGIN_EXAMPLE
source("fit-table-model-medflux.sl");

t_g = 1.332647e+01
 Parameters[Variable] = 15[9]
            Data bins = 14
           Chi-square = 30.36228
   Reduced chi-square = 6.072456
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         22.18546           0         100
  2  lag_freq(1).log_mass   0     0         6.432129         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         3.000035           3          20
  7  lag_freq(1).Gamma1     0     0         3.097217           2         3.3
  8  lag_freq(1).Gamma2     0     0         1.700002         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0                3           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         1.113838           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         585.7269         100        1400
 15  lag_freq(1).t_shift    0     0         76.98525          10         120
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -1.0490e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-medflux-time-lags-fmax.fits

#+END_EXAMPLE

*Using the new =tab_rev.mod= (dated 26 Mar 2021)*

#+BEGIN_EXAMPLE
source("fit-table-model-medflux.sl");

t_g = 3.273227e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.0002449356
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         3.309378           0         100
  2  lag_freq(1).log_mass   0     0          6.82239         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         11.57545           3          20
  7  lag_freq(1).Gamma1     0     0         2.710795           2         3.1
  8  lag_freq(1).Gamma2     0     0         1.905334         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         1.257272           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.886473           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         322.8608         100        1500
 15  lag_freq(1).t_shift    0     0         19.70222          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -1.0490e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-medflux-time-lags-fmax.fits

#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 3.309378e+00 | +2.981917e+00 | -1.947388e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.822390e+00 | +1.282703e-02 | -3.630885e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 1.157545e+01 | +8.424547e+00 | -1.957831e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 2.710795e+00 | +3.879758e-01 | -1.038079e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 1.905334e+00 | +3.976811e-01 | -2.053338e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 1.257272e+00 | +1.742728e+00 | -1.257272e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 2.886473e+00 | +1.135273e-01 | -1.816674e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 3.228608e+02 | +4.024240e+01 | -8.350037e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 1.970222e+01 | +1.850180e+00 | -1.538526e+00 |
+----------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_medflux.gif

pdf at

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_medflux.pdf

[detached from 81110.pts-31.hm00]

#######################################################################


*Fixed Mass = 6.45*

#+BEGIN_EXAMPLE

t_g = 1.388628e+01
 Parameters[Variable] = 15[8]
            Data bins = 14
           Chi-square = 5.590536
   Reduced chi-square = 0.931756
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         3.525618           0         100
  2  lag_freq(1).log_mass   0     1             6.45           0           0
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         12.13651           3          20
  7  lag_freq(1).Gamma1     0     0         2.477265           2         3.1
  8  lag_freq(1).Gamma2     0     0         1.700001         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         2.000006           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.999998           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         532.3324         100        1500
 15  lag_freq(1).t_shift    0     0         20.00001          10         150

#+END_EXAMPLE

+---------------------+--------------+---------------+---------------+
| lag_freq(1).norm    | 3.525618e+00 | +7.040060e-01 | -1.021861e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).h2      | 1.213651e+01 | +3.369560e-01 | -8.938865e-02 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1  | 2.477265e+00 | +4.685835e-02 | -7.565444e-02 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2  | 1.700001e+00 | +4.888774e-02 | -1.499604e-06 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).xi      | 2.000006e+00 | +4.638072e-01 | -2.000006e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).b       | 2.999998e+00 | +1.789112e-06 | -2.947208e-02 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_max   | 5.323324e+02 | +5.726082e+01 | -4.176825e+01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift | 2.000001e+01 | +1.353968e-01 | -1.067726e-01 |
+---------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_medflux_fm.gif

** Lo-flux

#+BEGIN_EXAMPLE
source("fit-table-model-loflux.sl");

t_g = 2.082763e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.02018715
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         11.91372           0         100
  2  lag_freq(1).log_mass   0     0         6.626054         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0               20           3          20
  7  lag_freq(1).Gamma1     0     0         3.008606           2         3.3
  8  lag_freq(1).Gamma2     0     0         2.082934         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0          1.55504           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         1.829441           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         240.2559         100        1400
 15  lag_freq(1).t_shift    0     0          23.3559          10         120
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -2.8457e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-loflux-time-lags-fmax.fits

#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 1.191372e+01 | +5.411004e+01 | -1.095691e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.626054e+00 | +4.967111e-02 | -4.798411e-10 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 2.000000e+01 | +6.934631e-09 | -7.329049e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 3.008606e+00 | +9.043731e-02 | -8.376649e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 2.082934e+00 | +5.038142e-02 | -3.829341e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 1.555040e+00 | +1.444960e+00 | -1.555040e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 1.829441e+00 | +8.479980e-01 | -4.782494e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 2.402559e+02 | +1.159210e+02 | -8.977740e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 2.335590e+01 | +1.573317e-02 | -5.462878e+00 |
+----------------------+--------------+---------------+---------------+

*Using the new =tab_rev.mod= (dated 26 Mar 2021)*

#+BEGIN_EXAMPLE
source("fit-table-model-loflux.sl");

t_g = 2.075737e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.0002473591
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         3.088039           0         100
  2  lag_freq(1).log_mass   0     0         6.624586         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         19.99353           3          20
  7  lag_freq(1).Gamma1     0     0         3.031586           2         3.1
  8  lag_freq(1).Gamma2     0     0         2.001651         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0          1.55202           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         1.751708           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         186.9922         100        1500
 15  lag_freq(1).t_shift    0     0         23.36207          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -2.8457e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-loflux-time-lags-fmax.fits

#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 3.088039e+00 | +7.360257e+00 | -2.134007e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.624586e+00 | +5.112458e-02 | -1.253529e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 1.999353e+01 | +6.466840e-03 | -1.038462e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 3.031586e+00 | +6.789765e-02 | -9.738877e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 2.001651e+00 | +2.432363e-01 | -3.016513e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 1.552020e+00 | +1.447980e+00 | -1.552020e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 1.751708e+00 | +1.248292e+00 | -4.100678e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 1.869922e+02 | +5.245165e+02 | -8.699222e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 2.336207e+01 | +7.648339e-09 | -7.446931e+00 |
+----------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_loflux.gif

pdf atan2
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_loflux.pdf

[detached from 110576.pts-31.hm00]


################################################################################



*Fixed Mass = 6.45*

#+BEGIN_EXAMPLE
t_g = 1.388628e+01
 Parameters[Variable] = 15[8]
            Data bins = 7
           Chi-square = 1.175435
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         82.18691           0         100
  2  lag_freq(1).log_mass   0     1             6.45           0           0
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         3.263661           3          20
  7  lag_freq(1).Gamma1     0     0         3.099276           2         3.1
  8  lag_freq(1).Gamma2     0     0         1.700001         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0        0.9359743           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         1.371676           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         400.0002         100        1500
 15  lag_freq(1).t_shift    0     0         74.55731          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -2.8457e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-loflux-time-lags-fmax.fits

#+END_EXAMPLE

+---------------------+--------------+---------------+---------------+
| lag_freq(1).norm    | 8.218691e+01 | +1.781309e+01 | -8.174284e+01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).h2      | 3.263661e+00 | +1.028321e+00 | -2.636605e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1  | 3.099276e+00 | +2.860042e-04 | -1.074798e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2  | 1.700001e+00 | +9.587063e-01 | -5.540362e-07 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).xi      | 9.359743e-01 | +2.064026e+00 | -9.359743e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).b       | 1.371676e+00 | +1.628324e+00 | -3.716763e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_max   | 4.000002e+02 | +1.100000e+03 | -3.000002e+02 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift | 7.455731e+01 | +1.251989e+01 | -1.394854e+01 |
+---------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_loflux_fm.gif

** Lo-cts

#+BEGIN_EXAMPLE
source("fit-table-model-locts.sl");

t_g = 1.217635e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 9.379468
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         99.87735           0         100
  2  lag_freq(1).log_mass   0     0         6.392931         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         4.198229           3          20
  7  lag_freq(1).Gamma1     0     0         3.073227           2         3.3
  8  lag_freq(1).Gamma2     0     0         1.700001         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         2.999982           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         1.232641           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         749.1275         100        1400
 15  lag_freq(1).t_shift    0     0          83.8941          10         120
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -2.0648e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-lo-cts-time-lags-fmax.fits


#+END_EXAMPLE

*Using the new =tab_rev.mod= (dated 26 Mar 2021)*

#+BEGIN_EXAMPLE
source("fit-table-model-locts.sl");

t_g = 1.338172e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 9.336892
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         82.54899           0         100
  2  lag_freq(1).log_mass   0     0         6.433926         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0          3.00117           3          20
  7  lag_freq(1).Gamma1     0     0         3.099423           2         3.1
  8  lag_freq(1).Gamma2     0     0         1.700001         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0                3           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0          1.15592           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         600.0001         100        1500
 15  lag_freq(1).t_shift    0     0         77.02075          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -2.0648e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-lo-cts-time-lags-fmax.fits

#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 8.254899e+01 | +1.745101e+01 | -8.221574e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.433926e+00 | +1.241735e-02 | -2.787459e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 3.001170e+00 | +1.106032e+01 | -1.170482e-03 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 3.099423e+00 | +2.304516e-04 | -1.101182e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 1.700001e+00 | +5.703158e-01 | -6.444284e-07 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 3.000000e+00 | +9.193790e-08 | -3.000000e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 1.155920e+00 | +1.118465e+00 | -1.559204e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 6.000001e+02 | +3.060376e+02 | -1.346074e+02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 7.702075e+01 | +4.397099e+01 | -8.517974e+00 |
+----------------------+--------------+---------------+---------------+


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_locts.gif



#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_locts.pdf

[detached from 99351.pts-31.hm00]

############################################################################

*Fixed Mass = 6.45*

#+BEGIN_EXAMPLE
t_g = 1.388628e+01
 Parameters[Variable] = 15[8]
            Data bins = 7
           Chi-square = 13.94693
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0        0.4760014           0         100
  2  lag_freq(1).log_mass   0     1             6.45           0           0
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         3.000011           3          20
  7  lag_freq(1).Gamma1     0     0         3.000003           2         3.1
  8  lag_freq(1).Gamma2     0     0              1.7         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         2.999994           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         1.140694           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         599.9988         100        1500
 15  lag_freq(1).t_shift    0     0         76.55885          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -2.0648e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-lo-cts-time-lags-fmax.fits

#+END_EXAMPLE

+---------------------+--------------+---------------+---------------+
| lag_freq(1).norm    | 4.760014e-01 | +4.010075e+00 | -8.463544e-02 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).h2      | 3.000011e+00 | +9.965883e-02 | -1.116153e-05 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1  | 3.000003e+00 | +9.999682e-02 | -2.745382e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2  | 1.700000e+00 | +5.669860e-01 | -0.000000e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).xi      | 2.999994e+00 | +5.843603e-06 | -5.223728e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).b       | 1.140694e+00 | +1.233636e+00 | -1.406939e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_max   | 5.999988e+02 | +2.029333e+02 | -1.427379e+02 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift | 7.655885e+01 | +9.644460e+00 | -5.959815e+00 |
+---------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_locts_fm.gif

** OBS 0110890101

#+BEGIN_EXAMPLE
source("fit-table-model-0110890101.sl");

t_g = 4.919266e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.01417802
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         3.848533           0         100
  2  lag_freq(1).log_mass   0     0         6.999314         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0          19.3222           3          20
  7  lag_freq(1).Gamma1     0     0         2.681286           2         3.3
  8  lag_freq(1).Gamma2     0     0         2.016233         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0                3           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0          2.69468           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         130.1975         100        1400
 15  lag_freq(1).t_shift    0     0         47.66204          10         120
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  4.3472e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0110890101-time-lags-fmax.fits

#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 3.848533e+00 | +4.605539e+01 | -3.705696e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.999314e+00 | +6.856128e-04 | -1.209812e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 1.932220e+01 | +6.778022e-01 | -5.786449e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 2.681286e+00 | +4.185717e-01 | -6.812855e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 2.016233e+00 | +8.837675e-01 | -3.162325e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 3.000000e+00 | +3.441755e-07 | -3.000000e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 2.694680e+00 | +3.053202e-01 | -1.577122e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 1.301975e+02 | +3.851701e+02 | -3.019750e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 4.766204e+01 | +4.231029e+01 | -2.123007e+01 |
+----------------------+--------------+---------------+---------------+

*Using the =new tab_rev.mod= (dated 26 Mar 2021)*


#+BEGIN_EXAMPLE
t_g = 4.779468e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.0001358853
isis>
isis> list_par;
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         1.688552           0         100
  2  lag_freq(1).log_mass   0     0         6.986794         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         19.34016           3          20
  7  lag_freq(1).Gamma1     0     0         2.997425           2         3.1
  8  lag_freq(1).Gamma2     0     0         2.365381         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0          2.68055           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.936972           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         108.8604         100        1500
 15  lag_freq(1).t_shift    0     0         47.94336          10         150

Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  targe                                     t
  1       EPIC-PN          0       7/    7   -   1  4.3472e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0110890101-time-lags-fmax.fits

#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 1.691903e+00 | +2.335922e+00 | -1.547897e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.986763e+00 | +1.323666e-02 | -9.647458e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 1.933956e+01 | +6.604425e-01 | -1.633956e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 2.997304e+00 | +1.026509e-01 | -9.973036e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 2.365196e+00 | +5.348038e-01 | -6.651962e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 2.685336e+00 | +3.146636e-01 | -2.685336e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 2.937161e+00 | +6.283934e-02 | -1.840488e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 1.087645e+02 | +1.292852e+03 | -8.764535e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 4.794219e+01 | +4.489221e+01 | -2.253242e+01 |
+----------------------+--------------+---------------+---------------+


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_0110890101.gif


*Fixing logM = 6.45*

#+BEGIN_EXAMPLE
source("fit-table-model-0110890101.sl");

t_g = 1.388628e+01
 Parameters[Variable] = 15[8]
            Data bins = 7
           Chi-square = 0.1507395
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         7.542598           0         100
  2  lag_freq(1).log_mass   0     1             6.45           0           0
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         14.03289           3          20
  7  lag_freq(1).Gamma1     0     0         2.340834           2         3.1
  8  lag_freq(1).Gamma2     0     0         1.700002         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0                3           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.871125           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         398.5818         100        1500
 15  lag_freq(1).t_shift    0     0         23.91805          10         150

#+END_EXAMPLE

+---------------------+--------------+---------------+---------------+
| lag_freq(1).norm    | 7.542598e+00 | +1.177054e+01 | -7.458395e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).h2      | 1.403289e+01 | +2.983555e+00 | -7.419063e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1  | 2.340834e+00 | +7.591163e-01 | -7.838847e-02 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2  | 1.700002e+00 | +8.749476e-01 | -1.870652e-06 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).xi      | 3.000000e+00 | +3.518140e-07 | -3.000000e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).b       | 2.871125e+00 | +1.288754e-01 | -1.257572e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_max   | 3.985818e+02 | +1.101418e+03 | -2.985818e+02 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift | 2.391805e+01 | +1.521566e+01 | -7.432835e+00 |
+---------------------+--------------+---------------+---------------+


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_0110890101_fm.gif

** OBS 0673580101

#+BEGIN_EXAMPLE
source("fit-table-model-0673580101.sl");

t_g = 2.170134e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.3911509
isis> list_par;
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         24.97987           0         100
  2  lag_freq(1).log_mass   0     0         6.643901         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         19.58853           3          20
  7  lag_freq(1).Gamma1     0     0         3.089634           2         3.3
  8  lag_freq(1).Gamma2     0     0         1.700016         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0     0.0003107699           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.224684           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         361.2171         100        1400
 15  lag_freq(1).t_shift    0     0         48.84191          10         120

#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 2.497987e+01 | +7.502013e+01 | -2.473150e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.643901e+00 | +3.560994e-01 | -9.042282e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 1.958853e+01 | +4.114670e-01 | -1.658853e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 3.089634e+00 | +1.010431e-02 | -8.209585e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 1.700016e+00 | +8.955081e-01 | -1.579854e-05 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 3.107699e-04 | +2.999689e+00 | -3.107699e-04 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 2.224684e+00 | +7.753158e-01 | -1.224684e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 3.612171e+02 | +1.038488e+03 | -2.110886e+02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 4.884191e+01 | +5.166702e+01 | -3.311435e+01 |
+----------------------+--------------+---------------+---------------+


*Using the new =tab_rev.mod= (dated 26 Mar 2021)*


#+BEGIN_EXAMPLE
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.3891555
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         12.53853           0         100
  2  lag_freq(1).log_mass   0     0         6.652083         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         17.99053           3          20
  7  lag_freq(1).Gamma1     0     0         3.095373           2         3.1
  8  lag_freq(1).Gamma2     0     0         1.700004         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0     0.0006731615           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.216434           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         399.9999         100        1500
 15  lag_freq(1).t_shift    0     0         48.16216          10         150

#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 1.253853e+01 | +8.746147e+01 | -1.235366e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.652083e+00 | +2.893616e-01 | -3.330557e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 1.799053e+01 | +2.009471e+00 | -1.499053e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 3.095373e+00 | +4.441704e-03 | -6.520512e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 1.700004e+00 | +8.954819e-01 | -4.266880e-06 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 6.731615e-04 | +2.999327e+00 | -6.731615e-04 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 2.216434e+00 | +7.835660e-01 | -1.216434e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 3.999999e+02 | +5.999886e+02 | -2.999999e+02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 4.816216e+01 | +9.180698e+01 | -3.339189e+01 |
+----------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_0673580101.gif


*Fixing logM = 6.45*

#+BEGIN_EXAMPLE
 source("fit-table-model-0673580101.sl");

t_g = 1.388628e+01
 Parameters[Variable] = 15[8]
            Data bins = 7
           Chi-square = 1.059258
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         4.136586           0         100
  2  lag_freq(1).log_mass   0     1             6.45           0           0
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0               15           3          20
  7  lag_freq(1).Gamma1     0     0         3.091298           2         3.1
  8  lag_freq(1).Gamma2     0     0         1.700001         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         2.999999           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0                3           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         600.0004         100        1500
 15  lag_freq(1).t_shift    0     0              100          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  1.0741e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0673580101-time-lags-fmax.fits


#+END_EXAMPLE

+---------------------+--------------+---------------+---------------+
| lag_freq(1).norm    | 4.136586e+00 | +3.535663e+00 | -3.945561e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).h2      | 1.500000e+01 | +4.999998e+00 | -7.754521e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1  | 3.091298e+00 | +8.515137e-03 | -8.635777e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2  | 1.700001e+00 | +8.549897e-01 | -1.170662e-06 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).xi      | 2.999999e+00 | +5.304364e-07 | -2.999999e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).b       | 3.000000e+00 | +7.639286e-08 | -1.786949e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_max   | 6.000004e+02 | +7.999925e+02 | -3.999980e+02 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift | 1.000000e+02 | +3.997317e+01 | -2.314713e+01 |
+---------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_0673580101_fm.gif

** OBS 0673580201

#+BEGIN_EXAMPLE
source("fit-table-model-0673580201-.sl");

t_g = 1.261985e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.6191103
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         7.807826           0         100
  2  lag_freq(1).log_mass   0     0         6.408468         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         15.99996           3          20
  7  lag_freq(1).Gamma1     0     0         2.550846           2         3.3
  8  lag_freq(1).Gamma2     0     0         1.731635         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0     5.564635e-06           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0          2.81621           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0          415.471         100        1400
 15  lag_freq(1).t_shift    0     0         23.06354          10         120
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  5.7873e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0673580201-time-lags-fmax.fits

#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 7.807826e+00 | +9.219217e+01 | -5.288719e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.408468e+00 | +1.351321e-02 | -4.035608e-03 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 1.599996e+01 | +1.434272e+00 | -4.650337e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 2.550846e+00 | +4.537560e-01 | -7.917900e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 1.731635e+00 | +4.204400e-01 | -3.163508e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 5.564635e-06 | +2.999994e+00 | -5.564635e-06 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 2.816210e+00 | +1.837896e-01 | -4.925239e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 4.154710e+02 | +1.366266e+02 | -5.545280e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 2.306354e+01 | +1.989313e+00 | -5.419741e+00 |
+----------------------+--------------+---------------+---------------+


*Using the new =tab_rev.mod= (dated 26 Mar 2021)*

#+BEGIN_EXAMPLE
 Parameters[Variable] = 15[9]
            Data bins = 14
           Chi-square = 1.059472
   Reduced chi-square = 0.2118943
isis> list_par;
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         5.870274           0         100
  2  lag_freq(1).log_mass   0     0         6.407505         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         15.99999           3          20
  7  lag_freq(1).Gamma1     0     0         2.543642           2         3.1
  8  lag_freq(1).Gamma2     0     0         1.751052         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0     5.607962e-06           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0          2.88572           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         419.0463         100        1500
 15  lag_freq(1).t_shift    0     0         23.05877          10         150
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  5.7873e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0673580201-time-lags-fmax.fits

#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 7.807826e+00 | +9.219217e+01 | -5.288719e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.408468e+00 | +1.351321e-02 | -4.035608e-03 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 1.599996e+01 | +1.434272e+00 | -4.650337e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 2.550846e+00 | +4.537560e-01 | -7.917900e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 1.731635e+00 | +4.204400e-01 | -3.163508e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 5.564635e-06 | +2.999994e+00 | -5.564635e-06 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 2.816210e+00 | +1.837896e-01 | -4.925239e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 4.154710e+02 | +1.366266e+02 | -5.545280e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 2.306354e+01 | +1.989313e+00 | -5.419741e+00 |
+----------------------+--------------+---------------+---------------+


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_0673580201.gif


*Fixing logM = 6.45*

#+BEGIN_EXAMPLE
t_g = 1.388628e+01
 Parameters[Variable] = 15[8]
            Data bins = 7
           Chi-square = 0.5518173
isis> list_par;
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         9.696986           0         100
  2  lag_freq(1).log_mass   0     1             6.45           0           0
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         16.36815           3          20
  7  lag_freq(1).Gamma1     0     0         2.673529           2         3.1
  8  lag_freq(1).Gamma2     0     0         2.134984         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         2.999996           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.999999           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         432.5546         100        1500
 15  lag_freq(1).t_shift    0     0         24.62466          10         150

#+END_EXAMPLE

+---------------------+--------------+---------------+---------------+
| lag_freq(1).norm    | 9.699996e+00 | +6.355169e+00 | -7.933253e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).h2      | 1.636772e+01 | +8.529628e-01 | -6.167177e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1  | 2.673085e+00 | +4.252199e-01 | -3.363446e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2  | 2.134571e+00 | +3.797108e-01 | -4.345706e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).xi      | 2.999995e+00 | +5.424173e-06 | -2.999995e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).b       | 2.999998e+00 | +1.666001e-06 | -6.262429e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_max   | 4.326428e+02 | +5.178696e+01 | -1.357949e+02 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift | 2.462411e+01 | +6.379721e-01 | -7.546353e+00 |
+---------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_0673580201_fm.gif

** OBS 0673580301

#+BEGIN_EXAMPLE
source("fit-table-model-0673580301.sl");

t_g = 3.755228e+00
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 5.62683
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         71.96023           0         100
  2  lag_freq(1).log_mass   0     0          5.88205         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         3.000001           3          20
  7  lag_freq(1).Gamma1     0     0         2.800002           2         3.3
  8  lag_freq(1).Gamma2     0     0         1.705839         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0                3           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         1.000001           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         1225.201         100        1400
 15  lag_freq(1).t_shift    0     0              120          10         120
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  5.7873e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0673580201-time-lags-fmax.fits

#+END_EXAMPLE

*Using the new =tab_rev.mod= (dated 26 Mar 2021)*

#+BEGIN_EXAMPLE
source("fit-table-model-0673580301.sl");

t_g = 1.592958e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.0659203
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         6.201773           0         100
  2  lag_freq(1).log_mass   0     0         6.509618         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         10.36186           3          20
  7  lag_freq(1).Gamma1     0     0         2.562212           2         3.1
  8  lag_freq(1).Gamma2     0     0         2.119072         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         2.999967           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.982717           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         319.5552         100        1500
 15  lag_freq(1).t_shift    0     0         21.04529          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -2.6979e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0673580301-time-lags-fmax.fits

#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 6.201773e+00 | +1.738683e+01 | -3.859002e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.509618e+00 | +3.296282e-01 | -1.489014e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 1.036186e+01 | +9.638142e+00 | -1.147820e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 2.562212e+00 | +5.358756e-01 | -4.249232e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 2.119072e+00 | +5.293340e-01 | -4.190722e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 2.999967e+00 | +3.293845e-05 | -2.999967e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 2.982717e+00 | +1.728279e-02 | -1.542867e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 3.195552e+02 | +1.106793e+03 | -9.552096e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 2.104529e+01 | +3.465349e+00 | -4.210539e+00 |
+----------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_0673580301.gif


*Fixing logM = 6.45*

#+BEGIN_EXAMPLE
source("fit-table-model-0673580301.sl");

t_g = 1.388628e+01
 Parameters[Variable] = 15[8]
            Data bins = 7
           Chi-square = 0.2326534
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         99.96181           0         100
  2  lag_freq(1).log_mass   0     1             6.45           0           0
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         15.99429           3          20
  7  lag_freq(1).Gamma1     0     0         3.095784           2         3.1
  8  lag_freq(1).Gamma2     0     0          2.48565         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         1.788824           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.999995           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         400.0002         100        1500
 15  lag_freq(1).t_shift    0     0         24.72834          10         150

Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -2.6979e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0673580301-time-lags-fmax.fits


#+END_EXAMPLE

+---------------------+--------------+---------------+---------------+
| lag_freq(1).norm    | 9.996181e+01 | +3.818517e-02 | -9.784321e+01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).h2      | 1.599429e+01 | +4.005708e+00 | -4.499224e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1  | 3.095784e+00 | +1.519688e-03 | -3.545475e-10 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2  | 2.485650e+00 | +9.203010e-02 | -2.652493e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).xi      | 1.788824e+00 | +1.211176e+00 | -1.788824e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).b       | 2.999995e+00 | +4.967924e-06 | -9.999911e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_max   | 4.000002e+02 | +3.853798e-06 | -2.100264e-06 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift | 2.472834e+01 | +3.506701e-01 | -3.118962e+00 |
+---------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_0673580301_fm.gif

** OBS 0673580401

#+BEGIN_EXAMPLE
source("fit-table-model-0673580401.sl");

t_g = 2.705748e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 3.39492
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         97.31195           0         100
  2  lag_freq(1).log_mass   0     0         6.739701         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0               10           3          20
  7  lag_freq(1).Gamma1     0     0         3.091467           2         3.3
  8  lag_freq(1).Gamma2     0     0         2.600002         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         2.999991           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.999979           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         155.1047         100        1400
 15  lag_freq(1).t_shift    0     0         99.18072          10         120
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -9.2308e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0673580401-time-lags-fmax.fits
#+END_EXAMPLE

*Using the new =tab_rev.mod= (dated 26 Mar 2021)*

#+BEGIN_EXAMPLE
source("fit-table-model-0673580401.sl");

t_g = 2.317223e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.264921
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         11.53898           0         100
  2  lag_freq(1).log_mass   0     0         6.672382         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0          14.7335           3          20
  7  lag_freq(1).Gamma1     0     0         2.587889           2         3.1
  8  lag_freq(1).Gamma2     0     0         2.117448         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         1.898331           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.955815           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         333.9324         100        1500
 15  lag_freq(1).t_shift    0     0         23.85004          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -9.2308e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0673580401-time-lags-fmax.fits
#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 1.153898e+01 | +2.905006e+00 | -2.885903e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.672382e+00 | +1.868129e-03 | -1.778823e-03 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 1.473350e+01 | +9.281930e-02 | -9.667420e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 2.587889e+00 | +1.818688e-02 | -1.658278e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 2.117448e+00 | +1.677927e-02 | -1.709435e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 1.898331e+00 | +3.848996e-01 | -3.464579e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 2.955815e+00 | +4.418500e-02 | -7.492002e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 3.339324e+02 | +1.386853e+01 | -1.422483e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 2.385004e+01 | +9.568953e-02 | -9.355010e-02 |
+----------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_0673580401.gif



*Fixing logM = 6.45*

#+BEGIN_EXAMPLE
source("fit-table-model-0673580401.sl");

t_g = 1.388628e+01
 Parameters[Variable] = 15[8]
            Data bins = 7
           Chi-square = 2.273043
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         10.32723           0         100
  2  lag_freq(1).log_mass   0     1             6.45           0           0
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         14.41951           3          20
  7  lag_freq(1).Gamma1     0     0         2.251203           2         3.1
  8  lag_freq(1).Gamma2     0     0              1.7         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0                3           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0                3           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         476.9259         100        1500
 15  lag_freq(1).t_shift    0     0         23.53028          10         150


#+END_EXAMPLE

+---------------------+--------------+---------------+---------------+
| lag_freq(1).norm    | 1.032723e+01 | +4.909733e+00 | -5.415557e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).h2      | 1.441951e+01 | +1.801325e+00 | -1.772054e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1  | 2.251203e+00 | +2.931335e-01 | -4.412511e-02 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2  | 1.700000e+00 | +4.017615e-01 | -0.000000e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).xi      | 3.000000e+00 | +0.000000e+00 | -3.000000e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).b       | 3.000000e+00 | +0.000000e+00 | -1.693428e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_max   | 4.769259e+02 | +1.989208e+01 | -4.329306e+01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift | 2.353028e+01 | +2.131584e-01 | -1.703649e-01 |
+---------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_0673580401_fm.gif

** OBS 0780560101

#+BEGIN_EXAMPLE
source("fit-table-model-0780560101.sl");

t_g = 3.814536e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.01585396
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         4.167064           0         100
  2  lag_freq(1).log_mass   0     0         6.888856         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         12.90591           3          20
  7  lag_freq(1).Gamma1     0     0         2.590576           2         3.3
  8  lag_freq(1).Gamma2     0     0         1.700001         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         2.000056           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.626584           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0          195.748         100        1400
 15  lag_freq(1).t_shift    0     0         22.02289          10         120
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  9.8449e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0780560101-time-lags-fmax.fits


#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 4.167064e+00 | +2.109894e+01 | -3.480527e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.888856e+00 | +9.005029e-03 | -5.873125e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 1.290591e+01 | +7.094092e+00 | -9.905908e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 2.590576e+00 | +5.069604e-01 | -2.306601e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 1.700001e+00 | +8.650732e-01 | -8.652655e-07 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 2.000056e+00 | +9.999440e-01 | -2.000056e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 2.626584e+00 | +3.734162e-01 | -6.569879e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 1.957480e+02 | +5.230956e+02 | -9.574797e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 2.202289e+01 | +8.485108e+00 | -4.606902e+00 |
+----------------------+--------------+---------------+---------------+

*Using the new =tab_rev.mod= (dated 26 Mar 2021)*

#+BEGIN_EXAMPLE
source("fit-table-model-0780560101.sl");

t_g = 3.820475e+01
 Parameters[Variable] = 15[9]
            Data bins = 14
           Chi-square = 0.0008435934
   Reduced chi-square = 0.0001687187
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         4.287547           0         100
  2  lag_freq(1).log_mass   0     0         6.889531         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         13.01583           3          20
  7  lag_freq(1).Gamma1     0     0         2.584563           2         3.1
  8  lag_freq(1).Gamma2     0     0         1.712075         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         2.000036           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.606149           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         211.9755         100        1500
 15  lag_freq(1).t_shift    0     0         22.16148          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  9.8449e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0780560101-time-lags-fmax.fits


#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 4.246082e+00 | +5.152849e+01 | -3.654943e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.889482e+00 | +7.574777e-03 | -5.699446e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 1.299421e+01 | +7.005791e+00 | -9.994209e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 2.585873e+00 | +5.134398e-01 | -3.518284e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 1.712390e+00 | +8.805721e-01 | -1.239030e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 1.999819e+00 | +1.000181e+00 | -1.999819e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 2.609779e+00 | +3.902207e-01 | -1.443682e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 2.111489e+02 | +8.516475e+02 | -9.167285e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 2.213738e+01 | +6.666382e+00 | -3.576872e+00 |
+----------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_0780560101.gif


*Fixing logM = 6.45*

#+BEGIN_EXAMPLE
 source("fit-table-model-0780560101.sl");

t_g = 1.388628e+01
 Parameters[Variable] = 15[8]
            Data bins = 7
           Chi-square = 0.8497443
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         2.260524           0         100
  2  lag_freq(1).log_mass   0     1             6.45           0           0
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0               20           3          20
  7  lag_freq(1).Gamma1     0     0         2.799995           2         3.1
  8  lag_freq(1).Gamma2     0     0                2         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         2.583453           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0           2.8996           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         504.9662         100        1500
 15  lag_freq(1).t_shift    0     0         26.01915          10         150

#+END_EXAMPLE

+---------------------+--------------+---------------+---------------+
| lag_freq(1).norm    | 2.260524e+00 | +9.773948e+01 | -1.600359e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).h2      | 2.000000e+01 | +8.966629e-07 | -9.555229e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1  | 2.799995e+00 | +2.993444e-01 | -7.123919e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2  | 2.000000e+00 | +5.492127e-01 | -3.000000e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).xi      | 2.583453e+00 | +4.165474e-01 | -2.583453e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).b       | 2.899600e+00 | +1.003996e-01 | -9.498001e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_max   | 5.049662e+02 | +9.950338e+02 | -4.049662e+02 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift | 2.601915e+01 | +2.321786e+00 | -1.062711e+01 |
+---------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_0780560101_fm.gif

** OBS 0780561301

#+BEGIN_EXAMPLE
source("fit-table-model-0780561301.sl");

t_g = 1.772409e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.547634
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         20.79228           0         100
  2  lag_freq(1).log_mass   0     0         6.555978         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         8.974183           3          20
  7  lag_freq(1).Gamma1     0     0         2.594446           2         3.3
  8  lag_freq(1).Gamma2     0     0         1.746698         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         2.000002           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.999999           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         537.1005         100        1400
 15  lag_freq(1).t_shift    0     0               20          10         120
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  5.8692e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0780561301-time-lags-fmax.fits

#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 2.079228e+01 | +7.920772e+01 | -1.738575e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.555978e+00 | +1.409126e-02 | -1.097735e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 8.974183e+00 | +2.157438e-01 | -6.133876e-04 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 2.594446e+00 | +1.611723e-02 | -4.259792e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 1.746698e+00 | +1.476591e-01 | -4.669802e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 2.000002e+00 | +6.899758e-01 | -2.000002e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 2.999999e+00 | +8.012661e-07 | -1.469896e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 5.371005e+02 | +7.158685e+01 | -3.579351e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 2.000000e+01 | +3.854123e-01 | -1.226427e+00 |
+----------------------+--------------+---------------+---------------+

*Using the new =tab_rev.mod= (dated 26 Mar 2021)*

#+BEGIN_EXAMPLE
.source("fit-table-model-0780561301.sl");

t_g = 2.256806e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.0003908718
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         8.103452           0         100
  2  lag_freq(1).log_mass   0     0         6.660908         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         16.09022           3          20
  7  lag_freq(1).Gamma1     0     0         2.556173           2         3.1
  8  lag_freq(1).Gamma2     0     0         1.805894         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         2.618723           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.782103           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         408.2643         100        1500
 15  lag_freq(1).t_shift    0     0         23.55746          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  5.8692e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0780561301-time-lags-fmax.fits

#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 8.103452e+00 | +2.071335e+01 | -5.770622e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.660908e+00 | +8.936122e-03 | -1.314797e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 1.609022e+01 | +3.909783e+00 | -4.202124e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 2.556173e+00 | +5.415117e-01 | -2.003260e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 1.805894e+00 | +2.062187e-01 | -1.058942e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 2.618723e+00 | +3.812773e-01 | -2.618723e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 2.782103e+00 | +2.178970e-01 | -5.376322e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 4.082643e+02 | +1.296585e+02 | -9.164730e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 2.355746e+01 | +2.176244e+00 | -5.388666e+00 |
+----------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_0780561301.gif

pdf img =
http://www.star.bris.ac.uk/steff/ecm/IRAS_0780561301_ECM_TM.pdf



*Fixing logM = 6.45*

#+BEGIN_EXAMPLE
 source("fit-table-model-0780561301.sl");

t_g = 1.388628e+01
 Parameters[Variable] = 15[8]
            Data bins = 7
           Chi-square = 1.365492
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         5.127377           0         100
  2  lag_freq(1).log_mass   0     1             6.45           0           0
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         12.05277           3          20
  7  lag_freq(1).Gamma1     0     0         2.606618           2         3.1
  8  lag_freq(1).Gamma2     0     0              1.7         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0                2           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0                3           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         580.9558         100        1500
 15  lag_freq(1).t_shift    0     0         20.66598          10         150

#+END_EXAMPLE

+---------------------+--------------+---------------+---------------+
| lag_freq(1).norm    | 5.127377e+00 | +3.467595e+00 | -1.733810e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).h2      | 1.205277e+01 | +1.761454e+00 | -1.091304e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1  | 2.606618e+00 | +2.154375e-01 | -2.373907e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2  | 1.700000e+00 | +1.789245e-01 | -1.584818e-07 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).xi      | 2.000000e+00 | +1.000000e+00 | -2.000000e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).b       | 3.000000e+00 | +1.095592e-07 | -2.818580e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_max   | 5.809558e+02 | +7.424682e+01 | -9.575244e+01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift | 2.066598e+01 | +2.132438e+00 | -1.863278e+00 |
+---------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_0780561301_fm.gif

** OBS 0780561401

#+BEGIN_EXAMPLE
source("fit-table-model-0780561401.sl");

t_g = 1.569353e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 4.447543
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         9.763709           0         100
  2  lag_freq(1).log_mass   0     0         6.503135         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         5.349251           3          20
  7  lag_freq(1).Gamma1     0     0         2.000002           2         3.3
  8  lag_freq(1).Gamma2     0     0         2.898251         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0        0.7703921           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         1.755786           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         155.3281         100        1400
 15  lag_freq(1).t_shift    0     0              120          10         120
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -1.4683e-01     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0780561401-time-lags-fmax.fits

#+END_EXAMPLE


*Using the new =tab_rev.mod= (dated 26 Mar 2021)*

#+BEGIN_EXAMPLE
.source("fit-table-model-0780561401.sl");

t_g = 1.170041e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 4.713916
isis> list_par;
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         3.583624           0         100
  2  lag_freq(1).log_mass   0     0         6.375615         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0               19           3          20
  7  lag_freq(1).Gamma1     0     0         2.200001           2         3.1
  8  lag_freq(1).Gamma2     0     0         1.700002         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0                3           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.999999           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         699.9995         100        1500
 15  lag_freq(1).t_shift    0     0         23.17069          10         150

| lag_freq(1).norm     | 3.583266e+00 | +5.257338e+00 | -3.265321e+00 |
| lag_freq(1).log_mass | 6.375615e+00 | +1.646240e-01 | -8.756153e-01 |
| lag_freq(1).h2       | 1.900000e+01 | +1.000003e+00 | -1.600000e+01 |
| lag_freq(1).Gamma1   | 2.200001e+00 | +8.999986e-01 | -2.000014e-01 |
| lag_freq(1).Gamma2   | 1.700002e+00 | +1.199998e+00 | -1.515324e-06 |
| lag_freq(1).xi       | 3.000000e+00 | +1.845628e-08 | -3.000000e+00 |
| lag_freq(1).b        | 2.999999e+00 | +1.181029e-06 | -1.999999e+00 |
| lag_freq(1).t_max    | 6.999995e+02 | +8.000005e+02 | -5.999995e+02 |
| lag_freq(1).t_shift  | 2.316837e+01 | +5.009140e+01 | -1.316837e+01 |

#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_0780561401.gif

pdf img =
http://www.star.bris.ac.uk/steff/ecm/IRAS_0780561401_ECM_TM.pdf


*Fixing logM = 6.45*

#+BEGIN_EXAMPLE
source("fit-table-model-0780561401.sl");

t_g = 1.388628e+01
 Parameters[Variable] = 15[8]
            Data bins = 7
           Chi-square = 0.0002550771
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         83.78306           0         100
  2  lag_freq(1).log_mass   0     1             6.45           0           0
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         12.27763           3          20
  7  lag_freq(1).Gamma1     0     0         2.894984           2         3.1
  8  lag_freq(1).Gamma2     0     0         2.394057         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         2.986471           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.498348           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         136.3836         100        1500
 15  lag_freq(1).t_shift    0     0         21.57312          10         150


#+END_EXAMPLE

+---------------------+--------------+---------------+---------------+
| lag_freq(1).norm    | 8.378306e+01 | +1.621694e+01 | -5.291978e+01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).h2      | 1.227763e+01 | +5.046513e-09 | -1.536006e-02 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1  | 2.894984e+00 | +1.699402e-03 | -1.390043e-02 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2  | 2.394057e+00 | +1.396247e-02 | -7.992567e-04 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).xi      | 2.986471e+00 | +1.352890e-02 | -1.212416e-09 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).b       | 2.498348e+00 | +1.572250e-05 | -1.398736e-03 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_max   | 1.363836e+02 | +1.310988e-06 | -1.580128e-08 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift | 2.157312e+01 | +4.873919e-08 | -3.996974e-05 |
+---------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_0780561401_fm.gif

** OBS 0780561501

#+BEGIN_EXAMPLE
source("fit-table-model-0780561501.sl");

t_g = 1.052309e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.35898
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         3.652673           0         100
  2  lag_freq(1).log_mass   0     0         6.329557         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0          4.36217           3          20
  7  lag_freq(1).Gamma1     0     0         3.057341           2         3.3
  8  lag_freq(1).Gamma2     0     0         1.723719         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         1.964724           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0                3           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         793.5574         100        1400
 15  lag_freq(1).t_shift    0     0         10.00001          10         120
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  3.2839e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0780561501-time-lags-fmax.fits

#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 3.652673e+00 | +3.140866e+00 | -3.178739e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.329557e+00 | +8.664494e-02 | -8.239696e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 4.362170e+00 | +5.607093e+00 | -1.362170e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 3.057341e+00 | +4.235266e-02 | -1.057341e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 1.723719e+00 | +7.239294e-01 | -2.371877e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 1.964724e+00 | +1.035276e+00 | -1.964724e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 3.000000e+00 | +1.121458e-07 | -1.937500e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 7.935574e+02 | +6.064426e+02 | -1.980870e+02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 1.000001e+01 | +8.014608e+01 | -6.986390e-06 |
+----------------------+--------------+---------------+---------------+


*Using the new =tab_rev.mod= (dated 26 Mar 2021)*

#+BEGIN_EXAMPLE
.source("fit-table-model-0780561501.sl");

t_g = 3.101003e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.0004238106
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         5.434941           0         100
  2  lag_freq(1).log_mass   0     0         6.798916         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         19.49576           3          20
  7  lag_freq(1).Gamma1     0     0         2.541242           2         3.1
  8  lag_freq(1).Gamma2     0     0         1.955535         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         2.718432           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.820977           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         378.0949         100        1500
 15  lag_freq(1).t_shift    0     0         26.22128          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  3.2839e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0780561501-time-lags-fmax.fits

#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 5.434941e+00 | +4.587644e+01 | -4.818587e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.798916e+00 | +2.548617e-02 | -1.298916e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 1.949576e+01 | +5.042420e-01 | -7.534981e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 2.541242e+00 | +5.583370e-01 | -1.834044e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 1.955535e+00 | +1.076635e-01 | -2.555352e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 2.718432e+00 | +2.815682e-01 | -2.718432e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 2.820977e+00 | +1.790226e-01 | -1.259075e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 3.780949e+02 | +1.121905e+03 | -2.247062e+02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 2.622128e+01 | +3.798863e+00 | -8.110640e+00 |
+----------------------+--------------+---------------+---------------+


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_0780561501.gif

pdf img =
http://www.star.bris.ac.uk/steff/ecm/IRAS_0780561501_ECM_TM.pdf


*Fixing logM = 6.45*

#+BEGIN_EXAMPLE
.source("fit-table-model-0780561501.sl");

t_g = 1.388628e+01
 Parameters[Variable] = 15[8]
            Data bins = 7
           Chi-square = 0.3793219
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         1.908206           0         100
  2  lag_freq(1).log_mass   0     1             6.45           0           0
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         12.84425           3          20
  7  lag_freq(1).Gamma1     0     0         2.819808           2         3.1
  8  lag_freq(1).Gamma2     0     0         1.824425         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         2.212997           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0                3           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         537.2098         100        1500
 15  lag_freq(1).t_shift    0     0               20          10         150

#+END_EXAMPLE

+---------------------+--------------+---------------+---------------+
| lag_freq(1).norm    | 1.908206e+00 | +9.809179e+01 | -1.279367e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).h2      | 1.284425e+01 | +7.155745e+00 | -1.456171e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1  | 2.819808e+00 | +2.797615e-01 | -5.378249e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2  | 1.824425e+00 | +6.922708e-01 | -1.244250e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).xi      | 2.212997e+00 | +7.870033e-01 | -2.212997e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).b       | 3.000000e+00 | +9.682450e-10 | -1.452964e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_max   | 5.372098e+02 | +1.741924e+02 | -3.919113e+02 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift | 2.000000e+01 | +3.924338e+00 | -3.660859e+00 |
+---------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_0780561501_fm.gif

** OBS 0780561601

#+BEGIN_EXAMPLE
source("fit-table-model-0780561601.sl");

t_g = 1.059068e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 6.587936
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         6.152317           0         100
  2  lag_freq(1).log_mass   0     0         6.332338         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         4.997897           3          20
  7  lag_freq(1).Gamma1     0     0         2.599999           2         3.3
  8  lag_freq(1).Gamma2     0     0         2.788305         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         2.999998           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.694494           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0          357.053         100        1400
 15  lag_freq(1).t_shift    0     0         119.9997          10         120
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -1.1123e-01     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0780561601-time-lags-fmax.fits


#+END_EXAMPLE

*Using the new =tab_rev.mod= (dated 26 Mar 2021)*

#+BEGIN_EXAMPLE
.source("fit-table-model-0780561601.sl");

t_g = 5.773777e+00
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.2273864
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         36.52723           0         100
  2  lag_freq(1).log_mass   0     0         6.068874         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         13.51889           3          20
  7  lag_freq(1).Gamma1     0     0         3.036715           2         3.1
  8  lag_freq(1).Gamma2     0     0         2.538863         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0     4.175537e-09           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0                3           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         172.7856         100        1500
 15  lag_freq(1).t_shift    0     0          21.8749          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -1.1123e-01     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0780561601-time-lags-fmax.fits

#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 3.652723e+01 | +2.572599e+01 | -2.296917e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.068874e+00 | +1.729094e-01 | -1.250543e-06 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 1.351889e+01 | +4.681948e-02 | -6.131014e-09 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 3.036715e+00 | +3.955220e-04 | -1.051259e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 2.538863e+00 | +1.518361e-01 | -4.801151e-10 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 4.175537e-09 | +3.000000e+00 | -4.175537e-09 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 3.000000e+00 | +4.566481e-10 | -1.896097e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 1.727856e+02 | +1.418342e+01 | -4.539136e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 2.187490e+01 | +6.133417e-06 | -5.682563e-01 |
+----------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_0780561601.gif

pdf img = http://www.star.bris.ac.uk/steff/ecm/IRAS_0780561601_ECM_TM.pdf


*Fixing logM = 6.45*

#+BEGIN_EXAMPLE

t_g = 1.388628e+01
  Parameter 15 = 2.029561e+01 (2.010838e+01 - 2.040980e+01)
t_g = 1.388628e+01
 Parameters[Variable] = 15[8]
            Data bins = 7
           Chi-square = 0.03841183
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         44.72235           0         100
  2  lag_freq(1).log_mass   0     1             6.45           0           0
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         11.10239           3          20
  7  lag_freq(1).Gamma1     0     0         3.030117           2         3.1
  8  lag_freq(1).Gamma2     0     0         2.535332         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0                3           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.999706           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         125.9764         100        1500
 15  lag_freq(1).t_shift    0     0         20.29561          10         150


#+END_EXAMPLE

+---------------------+--------------+---------------+---------------+
| lag_freq(1).norm    | 4.472235e+01 | +3.907755e+01 | -3.583759e+01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).h2      | 1.110239e+01 | +2.153202e+00 | -2.825525e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1  | 3.030117e+00 | +1.285625e-02 | -1.626349e-03 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2  | 2.535332e+00 | +2.097189e-10 | -1.778497e-10 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).xi      | 3.000000e+00 | +2.446822e-08 | -5.330691e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).b       | 2.999706e+00 | +2.942781e-04 | -1.524844e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_max   | 1.259764e+02 | +9.851795e+00 | -1.761068e+01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift | 2.029561e+01 | +1.141811e-01 | -1.872388e-01 |
+---------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_0780561601_fm.gif

** OBS 0780561701

#+BEGIN_EXAMPLE
source("fit-table-model-0780561701.sl");

t_g = 1.332644e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 2.374504
isis> list_par;
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         3.755578           0         100
  2  lag_freq(1).log_mass   0     0         6.432128         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         3.249341           3          20
  7  lag_freq(1).Gamma1     0     0         3.074163           2         3.3
  8  lag_freq(1).Gamma2     0     0              1.7         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0                3           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0                2           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         433.3339         100        1400
 15  lag_freq(1).t_shift    0     0         78.90976          10         120
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  3.6279e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0780561701-time-lags-fmax.fits

#+END_EXAMPLE

*Using the new =tab_rev.mod= (dated 26 Mar 2021)*

#+BEGIN_EXAMPLE
.source("fit-table-model-0780561701.sl");

t_g = 1.151749e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 1.553377
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0        0.3536584           0         100
  2  lag_freq(1).log_mass   0     0         6.368772         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         4.963062           3          20
  7  lag_freq(1).Gamma1     0     0              3.1           2         3.1
  8  lag_freq(1).Gamma2     0     0         2.000002         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         2.999999           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.999997           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         1200.001         100        1500
 15  lag_freq(1).t_shift    0     0         149.9996          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  3.6279e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0780561701-time-lags-fmax.fits

#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 3.536584e-01 | +2.075519e-01 | -1.686553e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.368772e+00 | +1.643004e-01 | -2.775570e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 4.963062e+00 | +8.327142e+00 | -1.963062e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 3.100000e+00 | +2.849460e-08 | -8.911101e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 2.000002e+00 | +7.233005e-01 | -3.000017e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 2.999999e+00 | +6.174618e-07 | -2.999999e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 2.999997e+00 | +2.748308e-06 | -1.607797e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 1.200001e+03 | +2.999992e+02 | -2.998915e+02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 1.499996e+02 | +4.038913e-04 | -8.200818e+01 |
+----------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_0780561701.gif

pdf img =
http://www.star.bris.ac.uk/steff/ecm/IRAS_0780561701_ECM_TM.pdf


*Fixing logM = 6.45*

#+BEGIN_EXAMPLE
t_g = 1.388628e+01
 Parameters[Variable] = 15[8]
            Data bins = 7
           Chi-square = 1.784261
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         0.397976           0         100
  2  lag_freq(1).log_mass   0     1             6.45           0           0
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0          3.20506           3          20
  7  lag_freq(1).Gamma1     0     0         3.099993           2         3.1
  8  lag_freq(1).Gamma2     0     0         2.000001         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         2.999998           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0                3           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         988.4113         100        1500
 15  lag_freq(1).t_shift    0     0         120.0635          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  3.6279e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0780561701-time-lags-fmax.fits

#+END_EXAMPLE

+---------------------+--------------+---------------+---------------+
| lag_freq(1).norm    | 3.979760e-01 | +2.960047e+01 | -2.171765e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).h2      | 3.205060e+00 | +1.270827e+00 | -2.050602e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1  | 3.099993e+00 | +6.629157e-06 | -8.678933e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2  | 2.000001e+00 | +7.299702e-01 | -3.000005e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).xi      | 2.999998e+00 | +1.640974e-06 | -2.999998e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).b       | 3.000000e+00 | +1.031230e-07 | -1.596976e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_max   | 9.884113e+02 | +5.115887e+02 | -6.889215e+01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift | 1.200635e+02 | +2.928608e+01 | -5.230066e+01 |
+---------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_0780561701_fm.gif

** OBS 0792180101

#+BEGIN_EXAMPLE
source("fit-table-model-0792180101.sl");

t_g = 4.352816e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 4.72857
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         1.091229           0         100
  2  lag_freq(1).log_mass   0     0         6.946184         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0                3           3          20
  7  lag_freq(1).Gamma1     0     0         2.900001           2         3.3
  8  lag_freq(1).Gamma2     0     0         2.405106         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0                3           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.999986           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         271.4968         100        1400
 15  lag_freq(1).t_shift    0     0         89.99996          10         120
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  3.7906e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0792180101-time-lags-fmax.fits

#+END_EXAMPLE

*Using the new =tab_rev.mod= (dated 26 Mar 2021)*

#+BEGIN_EXAMPLE
.source("fit-table-model-0792180101.sl");

t_g = 3.964229e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.02145439
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         8.120736           0         100
  2  lag_freq(1).log_mass   0     0         6.905573         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         4.081938           3          20
  7  lag_freq(1).Gamma1     0     0          2.56368           2         3.1
  8  lag_freq(1).Gamma2     0     0         1.903771         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0     4.558658e-12           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.775865           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         282.1426         100        1500
 15  lag_freq(1).t_shift    0     0         15.97987          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  3.7906e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0792180101-time-lags-fmax.fits

#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 8.120736e+00 | +4.685907e+00 | -6.099204e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.905573e+00 | +3.865663e-02 | -6.317518e-06 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 4.081938e+00 | +1.579039e-01 | -1.081938e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 2.563680e+00 | +5.348602e-01 | -1.747579e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 1.903771e+00 | +3.032245e-01 | -2.037710e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 4.558658e-12 | +3.000000e+00 | -4.558658e-12 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 2.775865e+00 | +2.241349e-01 | -7.341263e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 2.821426e+02 | +8.700580e+01 | -1.361990e+02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 1.597987e+01 | +1.108462e+01 | -8.431650e-03 |
+----------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_0792180101.gif

pdf img =
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180101_ECM_TM.pdf


*Fixing logM = 6.45*

#+BEGIN_EXAMPLE
t_g = 1.388628e+01
 Parameters[Variable] = 15[8]
            Data bins = 7
           Chi-square = 0.2772562
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         8.911827           0         100
  2  lag_freq(1).log_mass   0     1             6.45           0           0
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         13.71036           3          20
  7  lag_freq(1).Gamma1     0     0         2.411681           2         3.1
  8  lag_freq(1).Gamma2     0     0              1.7         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         1.503672           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.999996           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         489.4482         100        1500
 15  lag_freq(1).t_shift    0     0         22.69992          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  3.7906e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0792180101-time-lags-fmax.fits

#+END_EXAMPLE

+---------------------+--------------+---------------+---------------+
| lag_freq(1).norm    | 8.911827e+00 | +7.720964e+00 | -3.893189e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).h2      | 1.371036e+01 | +2.431880e-01 | -2.335057e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1  | 2.411681e+00 | +1.939969e-01 | -1.197026e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2  | 1.700000e+00 | +2.928010e-04 | -4.965097e-07 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).xi      | 1.503672e+00 | +1.496328e+00 | -1.503672e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).b       | 2.999996e+00 | +3.963599e-06 | -3.019155e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_max   | 4.894482e+02 | +1.844579e+02 | -6.903698e+01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift | 2.269992e+01 | +3.437594e-01 | -2.739695e-01 |
+---------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_0792180101_fm.gif

** OBS 0792180201

#+BEGIN_EXAMPLE
source("fit-table-model-0792180201.sl");

t_g = 3.240401e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.09349819
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         20.10338           0         100
  2  lag_freq(1).log_mass   0     0         6.818013         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         9.408771           3          20
  7  lag_freq(1).Gamma1     0     0              2.6           2         3.3
  8  lag_freq(1).Gamma2     0     0         2.062183         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         2.999585           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.999997           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         228.7541         100        1400
 15  lag_freq(1).t_shift    0     0         21.27002          10         120
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  1.4370e-01     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0792180201-time-lags-fmax.fits

#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 2.010338e+01 | +5.659036e+00 | -1.867009e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.818013e+00 | +4.975204e-03 | -1.372302e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 9.408771e+00 | +3.019356e-01 | -4.523175e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 2.600000e+00 | +8.002509e-02 | -8.889521e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 2.062183e+00 | +3.173782e-02 | -9.674811e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 2.999585e+00 | +4.153191e-04 | -9.395994e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 2.999997e+00 | +3.079557e-06 | -4.968498e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 2.287541e+02 | +1.968905e+01 | -3.150131e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 2.127002e+01 | +7.815880e-02 | -6.342459e-01 |
+----------------------+--------------+---------------+---------------+

*Using the new =tab_rev.mod= (dated 26 Mar 2021)*

#+BEGIN_EXAMPLE
.source("fit-table-model-0792180201.sl");

t_g = 3.160241e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.0006801594
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         8.895055           0         100
  2  lag_freq(1).log_mass   0     0         6.807134         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         9.429879           3          20
  7  lag_freq(1).Gamma1     0     0         2.943837           2         3.1
  8  lag_freq(1).Gamma2     0     0         2.438428         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         2.950318           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.999937           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         194.9883         100        1500
 15  lag_freq(1).t_shift    0     0         21.17921          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  1.4370e-01     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0792180201-time-lags-fmax.fits

#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 8.895055e+00 | +9.110495e+01 | -7.479108e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.807134e+00 | +8.623124e-02 | -4.935335e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 9.429879e+00 | +5.378373e+00 | -8.137568e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 2.943837e+00 | +1.547890e-01 | -7.481917e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 2.438428e+00 | +4.930446e-03 | -7.384281e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 2.950318e+00 | +4.968191e-02 | -2.950318e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 2.999937e+00 | +6.269474e-05 | -1.603628e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 1.949883e+02 | +4.680852e+01 | -2.954765e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 2.117921e+01 | +3.462188e+00 | -1.078268e+00 |
+----------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_0792180201.gif

pdf img = http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180201_ECM_TM.pdf


*Fixing logM = 6.45*

#+BEGIN_EXAMPLE
t_g = 1.388628e+01
 Parameters[Variable] = 15[8]
            Data bins = 7
           Chi-square = 0.6175756
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         11.55019           0         100
  2  lag_freq(1).log_mass   0     1             6.45           0           0
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         12.44264           3          20
  7  lag_freq(1).Gamma1     0     0         2.631192           2         3.1
  8  lag_freq(1).Gamma2     0     0         1.700001         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         0.999951           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.639011           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         258.2487         100        1500
 15  lag_freq(1).t_shift    0     0         18.87054          10         150

#+END_EXAMPLE

+---------------------+--------------+---------------+---------------+
| lag_freq(1).norm    | 1.155019e+01 | +7.365117e+00 | -5.775096e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).h2      | 1.244264e+01 | +1.204668e-01 | -8.948213e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1  | 2.631192e+00 | +2.914084e-01 | -8.523435e-02 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2  | 1.700001e+00 | +6.546102e-02 | -1.180506e-06 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).xi      | 9.999510e-01 | +1.030139e+00 | -9.999510e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).b       | 2.639011e+00 | +1.804944e-01 | -4.262698e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_max   | 2.582487e+02 | +2.441946e+01 | -3.017976e+01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift | 1.887054e+01 | +1.545000e+00 | -1.396470e+00 |
+---------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_0792180201_fm.gif

** OBS 0792180301

#+BEGIN_EXAMPLE
source("fit-table-model-0792180301.sl");

t_g = 1.120571e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.003786744
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         72.49211           0         100
  2  lag_freq(1).log_mass   0     0         6.356854         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0          5.87769           3          20
  7  lag_freq(1).Gamma1     0     0         3.099201           2         3.3
  8  lag_freq(1).Gamma2     0     0         2.144989         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0        0.4296864           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         1.766992           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         500.0011         100        1400
 15  lag_freq(1).t_shift    0     0         106.1551          10         120
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -1.6014e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0792180301-time-lags-fmax.fits

#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 7.249211e+01 | +2.750789e+01 | -7.214982e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.356854e+00 | +1.410589e-01 | -1.171230e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 5.877690e+00 | +1.202091e+01 | -2.877690e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 3.099201e+00 | +4.555979e-04 | -1.422386e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 2.144989e+00 | +7.298050e-01 | -4.449887e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 4.296864e-01 | +2.570314e+00 | -4.296864e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 1.766992e+00 | +1.233008e+00 | -7.669925e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 5.000011e+02 | +8.992151e+02 | -3.498013e+02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 1.061551e+02 | +1.384488e+01 | -3.217458e+01 |
+----------------------+--------------+---------------+---------------+

*Using the new =tab_rev.mod= (dated 26 Mar 2021)*

#+BEGIN_EXAMPLE
.source("fit-table-model-0792180301.sl");

t_g = 1.120398e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 0.003764931
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         72.49108           0         100
  2  lag_freq(1).log_mass   0     0         6.356786         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         5.880833           3          20
  7  lag_freq(1).Gamma1     0     0         3.099201           2         3.1
  8  lag_freq(1).Gamma2     0     0         2.145164         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0        0.4293108           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         1.767533           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         499.9996         100        1500
 15  lag_freq(1).t_shift    0     0         106.1694          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -1.6014e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0792180301-time-lags-fmax.fits

#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 7.249108e+01 | +2.750892e+01 | -7.207947e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.356786e+00 | +1.582090e-01 | -1.262212e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 5.880833e+00 | +8.749002e+00 | -2.880833e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 3.099201e+00 | +4.554137e-04 | -2.653878e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 2.145164e+00 | +7.161235e-01 | -4.451636e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 4.293108e-01 | +2.570689e+00 | -4.293108e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 1.767533e+00 | +1.232467e+00 | -7.675326e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 4.999996e+02 | +5.998501e+02 | -2.999998e+02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 1.061694e+02 | +3.379348e+01 | -3.699180e+01 |
+----------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_0792180301.gif

pdf img =
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180301_ECM_TM.pdf

*Fixing logM = 6.45*

#+BEGIN_EXAMPLE

t_g = 1.388628e+01
 Parameters[Variable] = 15[8]
            Data bins = 7
           Chi-square = 0.00288522
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         49.16498           0         100
  2  lag_freq(1).log_mass   0     1             6.45           0           0
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         3.364063           3          20
  7  lag_freq(1).Gamma1     0     0         3.098798           2         3.1
  8  lag_freq(1).Gamma2     0     0         2.085472         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0        0.4811134           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         1.726556           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         378.5046         100        1500
 15  lag_freq(1).t_shift    0     0         86.23811          10         150

#+END_EXAMPLE

+---------------------+--------------+---------------+---------------+
| lag_freq(1).norm    | 4.916498e+01 | +5.083502e+01 | -4.873227e+01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).h2      | 3.364063e+00 | +1.004962e+00 | -3.640629e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1  | 3.098798e+00 | +1.201525e-03 | -1.348927e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2  | 2.085472e+00 | +7.562287e-01 | -3.854725e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).xi      | 4.811134e-01 | +2.518887e+00 | -4.811134e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).b       | 1.726556e+00 | +1.273444e+00 | -7.265558e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_max   | 3.785046e+02 | +1.121495e+03 | -1.785057e+02 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift | 8.623811e+01 | +3.374453e+01 | -1.438627e+01 |
+---------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_0792180301_fm.gif

** OBS 0792180401

#+BEGIN_EXAMPLE
source("fit-table-model-0792180401.sl");

t_g = 1.369762e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 7.828555
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         31.15846           0         100
  2  lag_freq(1).log_mass   0     0         6.444059         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         3.000001           3          20
  7  lag_freq(1).Gamma1     0     0         2.800327           2         3.3
  8  lag_freq(1).Gamma2     0     0         1.701951         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0                3           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0          2.99999           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0             1400         100        1400
 15  lag_freq(1).t_shift    0     0              120          10         120
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  3.1215e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0792180401-time-lags-fmax.fits

#+END_EXAMPLE

*Using the new =tab_rev.mod= (dated 26 Mar 2021)*

#+BEGIN_EXAMPLE
.source("fit-table-model-0792180401.sl");

t_g = 1.130201e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 5.288735
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0        0.9057827           0         100
  2  lag_freq(1).log_mass   0     0          6.36057         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         4.807283           3          20
  7  lag_freq(1).Gamma1     0     0         3.099996           2         3.1
  8  lag_freq(1).Gamma2     0     0              1.7         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         2.999981           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0          2.46032           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         958.1044         100        1500
 15  lag_freq(1).t_shift    0     0              150          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  3.1215e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0792180401-time-lags-fmax.fits

| lag_freq(1).norm     | 9.057827e-01 | +2.549652e-01 | -5.550007e-01 |
| lag_freq(1).log_mass | 6.360570e+00 | +3.747314e-02 | -2.912606e-07 |
| lag_freq(1).h2       | 4.807283e+00 | +1.632554e+00 | -1.807283e+00 |
| lag_freq(1).Gamma1   | 3.099996e+00 | +3.583069e-06 | -7.181153e-01 |
| lag_freq(1).Gamma2   | 1.700000e+00 | +7.986493e-01 | -8.541148e-09 |
| lag_freq(1).xi       | 2.999981e+00 | +1.923906e-05 | -2.999981e+00 |
| lag_freq(1).b        | 2.460320e+00 | +5.396803e-01 | -1.032798e+00 |
| lag_freq(1).t_max    | 9.581044e+02 | +5.418956e+02 | -5.775365e+01 |
| lag_freq(1).t_shift  | 1.500000e+02 | +2.646199e-05 | -3.188029e+01 |
#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_0792180401.gif

pdf img =
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180401_ECM_TM.pdf


*Fixing logM = 6.45*

#+BEGIN_EXAMPLE
t_g = 1.388628e+01
 Parameters[Variable] = 15[8]
            Data bins = 7
           Chi-square = 6.378741
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         0.558509           0         100
  2  lag_freq(1).log_mass   0     1             6.45           0           0
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         3.000014           3          20
  7  lag_freq(1).Gamma1     0     0         3.099996           2         3.1
  8  lag_freq(1).Gamma2     0     0         1.700013         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         2.999962           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.999917           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0             1500         100        1500
 15  lag_freq(1).t_shift    0     0              120          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  3.1215e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0792180401-time-lags-fmax.fits

#+END_EXAMPLE

+---------------------+--------------+---------------+---------------+
| lag_freq(1).norm    | 5.585090e-01 | +1.920201e-01 | -1.610350e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).h2      | 3.000014e+00 | +5.542589e-01 | -1.371876e-05 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1  | 3.099996e+00 | +3.707169e-06 | -5.046339e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2  | 1.700013e+00 | +6.733462e-01 | -1.349090e-05 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).xi      | 2.999962e+00 | +3.767740e-05 | -1.138895e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).b       | 2.999917e+00 | +8.310146e-05 | -1.278499e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_max   | 1.500000e+03 | +0.000000e+00 | -5.708142e+02 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift | 1.200000e+02 | +1.137181e+01 | -5.616879e+00 |
+---------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_0792180401_fm.gif

** OBS 0792180501

#+BEGIN_EXAMPLE
source("fit-table-model-0792180501.sl");

t_g = 1.222378e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 7.592602
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         7.885513           0         100
  2  lag_freq(1).log_mass   0     0          6.39462         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         4.414862           3          20
  7  lag_freq(1).Gamma1     0     0         3.088138           2         3.3
  8  lag_freq(1).Gamma2     0     0              1.7         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         2.999998           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0                2           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         781.7522         100        1400
 15  lag_freq(1).t_shift    0     0         84.45221          10         120
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  1.9312e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0792180501-time-lags-fmax.fits

#+END_EXAMPLE

*Using the new =tab_rev.mod= (dated 26 Mar 2021)*

#+BEGIN_EXAMPLE
.source("fit-table-model-0792180501.sl");


t_g = 1.128822e+01
 Parameters[Variable] = 15[9]
            Data bins = 14
           Chi-square = 10.73606
   Reduced chi-square = 2.147211
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         21.44368           0         100
  2  lag_freq(1).log_mass   0     0          6.36004         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0          5.75849           3          20
  7  lag_freq(1).Gamma1     0     0         3.099999           2         3.1
  8  lag_freq(1).Gamma2     0     0         1.794363         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0         2.999998           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         2.999999           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         902.4802         100        1500
 15  lag_freq(1).t_shift    0     0              150          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  1.9312e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0792180501-time-lags-fmax.fits


#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 2.144368e+01 | +4.020689e+01 | -2.010345e+01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.360040e+00 | +2.352676e-02 | -6.780563e-03 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 5.758490e+00 | +1.078931e+00 | -1.174803e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 3.099999e+00 | +9.247529e-07 | -5.155650e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 1.794363e+00 | +1.422632e-01 | -9.436301e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 2.999998e+00 | +1.567736e-06 | -2.999998e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 2.999999e+00 | +1.065927e-06 | -8.782892e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 9.024802e+02 | +6.195955e-06 | -1.749441e-05 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 1.500000e+02 | +1.171824e-05 | -1.589649e+00 |
+----------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_0792180501.gif

pdf img =
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180501_ECM_TM.pdf


*Fixing logM = 6.45*

#+BEGIN_EXAMPLE
t_g = 1.388628e+01
 Parameters[Variable] = 15[8]
            Data bins = 7
           Chi-square = 6.471411
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         0.582405           0         100
  2  lag_freq(1).log_mass   0     1             6.45           0           0
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         3.367828           3          20
  7  lag_freq(1).Gamma1     0     0              3.1           2         3.1
  8  lag_freq(1).Gamma2     0     0         1.700001         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0                3           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0                3           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         1399.999         100        1500
 15  lag_freq(1).t_shift    0     0         120.7723          10         150

#+END_EXAMPLE

+---------------------+--------------+---------------+---------------+
| lag_freq(1).norm    | 5.824050e-01 | +2.018716e-01 | -1.455860e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).h2      | 3.367828e+00 | +8.305833e-01 | -3.678279e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1  | 3.100000e+00 | +3.134605e-08 | -5.462091e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2  | 1.700001e+00 | +6.954416e-01 | -1.094111e-06 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).xi      | 3.000000e+00 | +4.988952e-07 | -3.000000e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).b       | 3.000000e+00 | +9.205552e-08 | -1.117456e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_max   | 1.399999e+03 | +1.000014e+02 | -4.553208e+02 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift | 1.207723e+02 | +1.166009e+01 | -1.065727e+01 |
+---------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_0792180501_fm.gif

** OBS 0792180601

#+BEGIN_EXAMPLE
source("fit-table-model-0792180601.sl");

t_g = 1.246035e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 3.837049
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0         95.98616           0         100
  2  lag_freq(1).log_mass   0     0         6.402944         5.5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         4.063412           3          20
  7  lag_freq(1).Gamma1     0     0         3.098224           2         3.3
  8  lag_freq(1).Gamma2     0     0         1.700007         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0                3           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0         1.498855           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         434.7639         100        1400
 15  lag_freq(1).t_shift    0     0         85.07222          10         120
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  2.1112e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0792180601-time-lags-fmax.fits

#+END_EXAMPLE

*Using the new =tab_rev.mod= (dated 26 Mar 2021)*

#+BEGIN_EXAMPLE
.source("fit-table-model-0792180201.sl");


t_g = 1.168243e+01
 Parameters[Variable] = 15[9]
            Data bins = 7
           Chi-square = 1.232846
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0        0.4997435           0         200
  2  lag_freq(1).log_mass   0     0         6.374947           5           7
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0          4.66739           3          20
  7  lag_freq(1).Gamma1     0     0         3.099972           2         3.1
  8  lag_freq(1).Gamma2     0     0         2.165431         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0                3           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0                3           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         1200.001         100        1500
 15  lag_freq(1).t_shift    0     0              150          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  2.1112e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0792180601-time-lags-fmax.fits
#+END_EXAMPLE

+----------------------+--------------+---------------+---------------+
| lag_freq(1).norm     | 4.997435e-01 | +2.420662e-01 | -1.540445e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).log_mass | 6.374947e+00 | +8.547918e-11 | -5.747745e-02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).h2       | 4.667390e+00 | +2.037677e+00 | -1.667390e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1   | 3.099972e+00 | +2.822938e-05 | -8.052963e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2   | 2.165431e+00 | +4.927764e-01 | -4.654314e-01 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).xi       | 3.000000e+00 | +2.204771e-07 | -3.000000e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).b        | 3.000000e+00 | +1.022385e-07 | -1.288276e+00 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_max    | 1.200001e+03 | +2.999989e+02 | -2.024779e+02 |
+----------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift  | 1.500000e+02 | +5.280044e-06 | -3.716426e+01 |
+----------------------+--------------+---------------+---------------+


#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_0792180601.gif

pdf img =
http://www.star.bris.ac.uk/steff/ecm/IRAS_0792180601_ECM_TM.pdf


*Fixing logM = 6.45*

#+BEGIN_EXAMPLE
t_g = 1.388628e+01
 Parameters[Variable] = 15[8]
            Data bins = 7
           Chi-square = 1.710523
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0        0.4990489           0         200
  2  lag_freq(1).log_mass   0     1             6.45           0           0
  3  lag_freq(1).i          0     1               64           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     0         3.000002           3          20
  7  lag_freq(1).Gamma1     0     0              3.1           2         3.1
  8  lag_freq(1).Gamma2     0     0         2.059266         1.7         2.9
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     0                3           0           3
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     0                3           1           3
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     0         999.9241         100        1500
 15  lag_freq(1).t_shift    0     0         121.2538          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  2.1112e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0792180601-time-lags-fmax.fits

#+END_EXAMPLE

+---------------------+--------------+---------------+---------------+
| lag_freq(1).norm    | 4.990489e-01 | +2.448967e-01 | -1.578085e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).h2      | 3.000002e+00 | +9.011592e-01 | -2.449257e-06 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma1  | 3.100000e+00 | +1.745595e-07 | -7.494057e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).Gamma2  | 2.059266e+00 | +5.573314e-01 | -3.592656e-01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).xi      | 3.000000e+00 | +3.937702e-07 | -3.000000e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).b       | 3.000000e+00 | +9.736687e-08 | -1.328993e+00 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_max   | 9.999241e+02 | +5.000759e+02 | -9.980393e+01 |
+---------------------+--------------+---------------+---------------+
| lag_freq(1).t_shift | 1.212538e+02 | +1.136612e+01 | -9.305610e+00 |
+---------------------+--------------+---------------+---------------+

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_0792180601_fm.gif

** *Table Model Results*

*** Variable Mass fitting

These results are included in:

PATH =
=/home/steff075/phd_ecm/results-for-all/IRAS_results_complete.ods=
(and the csv file for this)

Also, for individual observations only =/home/steff075/phd_ecm/results-for-all/IRAS_results_complete_indobs.ods=

| *IRAS 13224-3809* |  $\chi^2$ |       $logM$ |             + |             - |        $h_2$ |             + |             - |   $\Gamma_1$ |             + |             - |   $\Gamma_2$ |             + |             - |        $\xi$ |             + |             - |          $b$ |             + |             - | $T_\text{max}$ |             + |             - | $T_\text{shift}$ |             + |             - |   |
|          Combined |  0.004649 | 6.662943e+00 | +7.492548e-03 | -1.898795e-02 | 1.272686e+01 | +3.830257e-08 | -4.994069e-05 | 2.624423e+00 | +2.360134e-01 | -9.455370e-11 | 1.700001e+00 | +2.208611e-02 | -7.825400e-07 | 9.999687e-01 | +2.000031e+00 | -9.999687e-01 | 2.480987e+00 | +5.190126e-01 | -4.522483e-01 |   3.052251e+02 | +4.093020e+01 | -3.048097e+01 |     1.944606e+01 | +1.039852e+00 | -7.181914e-07 |   |
|           Hi-flux |  4.269998 | 6.363184e+00 | +3.401927e-03 | -2.260601e-10 | 4.883709e+00 | +1.212768e+00 | -1.883709e+00 | 3.099993e+00 | +7.321025e-06 | -7.166319e-01 | 1.700001e+00 | +7.231154e-01 | -1.346755e-06 | 3.000000e+00 | +4.231444e-07 | -3.000000e+00 | 2.667292e+00 | +3.327084e-01 | -9.728799e-01 |   9.563312e+02 | +5.436688e+02 | -2.740510e+01 |     1.500000e+02 | +1.239231e-05 | -3.174526e+01 |   |
|         Hi-cts>20 |  0.000166 | 6.661197e+00 | +7.761449e-03 | -1.739973e-02 | 1.618591e+01 | +3.601088e-01 | -3.109219e+00 | 2.508673e+00 | +3.247528e-01 | -1.095191e-02 | 1.700179e+00 | +2.083230e-01 | -1.789196e-04 | 2.261321e+00 | +7.386790e-01 | -2.261321e+00 | 2.169902e+00 | +8.300981e-01 | -4.443907e-01 |   3.001996e+02 | +3.207877e+01 | -4.182110e+01 |     2.376894e+01 | +3.485007e-01 | -1.051925e+00 |   |
|          Med-spec |  0.000244 | 6.822390e+00 | +1.282703e-02 | -3.630885e-02 | 1.157545e+01 | +8.424547e+00 | -1.957831e+00 | 2.710795e+00 | +3.879758e-01 | -1.038079e-01 | 1.905334e+00 | +3.976811e-01 | -2.053338e-01 | 1.257272e+00 | +1.742728e+00 | -1.257272e+00 | 2.886473e+00 | +1.135273e-01 | -1.816674e-01 |   3.228608e+02 | +4.024240e+01 | -8.350037e+01 |     1.970222e+01 | +1.850180e+00 | -1.538526e+00 |   |
|           Lo-spec |  0.000247 | 6.624586e+00 | +5.112458e-02 | -1.253529e-02 | 1.999353e+01 | +6.466840e-03 | -1.038462e+01 | 3.031586e+00 | +6.789765e-02 | -9.738877e-01 | 2.001651e+00 | +2.432363e-01 | -3.016513e-01 | 1.552020e+00 | +1.447980e+00 | -1.552020e+00 | 1.751708e+00 | +1.248292e+00 | -4.100678e-01 |   1.869922e+02 | +5.245165e+02 | -8.699222e+01 |     2.336207e+01 | +7.648339e-09 | -7.446931e+00 |   |
|         Lo-cts<20 |   9.33689 | 6.433926e+00 | +1.241735e-02 | -2.787459e-01 | 3.001170e+00 | +1.106032e+01 | -1.170482e-03 | 3.099423e+00 | +2.304516e-04 | -1.101182e-01 | 1.700001e+00 | +5.703158e-01 | -6.444284e-07 | 3.000000e+00 | +9.193790e-08 | -3.000000e+00 | 1.155920e+00 | +1.118465e+00 | -1.559204e-01 |   6.000001e+02 | +3.060376e+02 | -1.346074e+02 |     7.702075e+01 | +4.397099e+01 | -8.517974e+00 |   |
|        0110890101 |  0.000135 | 6.986763e+00 | +1.323666e-02 | -9.647458e-01 | 1.933956e+01 | +6.604425e-01 | -1.633956e+01 | 2.997304e+00 | +1.026509e-01 | -9.973036e-01 | 2.365196e+00 | +5.348038e-01 | -6.651962e-01 | 2.685336e+00 | +3.146636e-01 | -2.685336e+00 | 2.937161e+00 | +6.283934e-02 | -1.840488e+00 |   1.087645e+02 | +1.292852e+03 | -8.764535e+00 |     4.794219e+01 | +4.489221e+01 | -2.253242e+01 |   |
|        0673580101 |  0.389155 | 6.652083e+00 | +2.893616e-01 | -3.330557e-01 | 1.799053e+01 | +2.009471e+00 | -1.499053e+01 | 3.095373e+00 | +4.441704e-03 | -6.520512e-01 | 1.700004e+00 | +8.954819e-01 | -4.266880e-06 | 6.731615e-04 | +2.999327e+00 | -6.731615e-04 | 2.216434e+00 | +7.835660e-01 | -1.216434e+00 |   3.999999e+02 | +5.999886e+02 | -2.999999e+02 |     4.816216e+01 | +9.180698e+01 | -3.339189e+01 |   |
|        0673580201 | 0.2118943 | 6.408468e+00 | +1.351321e-02 | -4.035608e-03 | 1.599996e+01 | +1.434272e+00 | -4.650337e+00 | 2.550846e+00 | +4.537560e-01 | -7.917900e-02 | 1.731635e+00 | +4.204400e-01 | -3.163508e-02 | 5.564635e-06 | +2.999994e+00 | -5.564635e-06 | 2.816210e+00 | +1.837896e-01 | -4.925239e-01 |   4.154710e+02 | +1.366266e+02 | -5.545280e+01 |     2.306354e+01 | +1.989313e+00 | -5.419741e+00 |   |
|        0673580301 |   0.06592 | 6.509618e+00 | +3.296282e-01 | -1.489014e-01 | 1.036186e+01 | +9.638142e+00 | -1.147820e+00 | 2.562212e+00 | +5.358756e-01 | -4.249232e-01 | 2.119072e+00 | +5.293340e-01 | -4.190722e-01 | 2.999967e+00 | +3.293845e-05 | -2.999967e+00 | 2.982717e+00 | +1.728279e-02 | -1.542867e+00 |   3.195552e+02 | +1.106793e+03 | -9.552096e+01 |     2.104529e+01 | +3.465349e+00 | -4.210539e+00 |   |
|        0673580401 |  0.264921 | 6.672382e+00 | +1.868129e-03 | -1.778823e-03 | 1.473350e+01 | +9.281930e-02 | -9.667420e-02 | 2.587889e+00 | +1.818688e-02 | -1.658278e-02 | 2.117448e+00 | +1.677927e-02 | -1.709435e-02 | 1.898331e+00 | +3.848996e-01 | -3.464579e-01 | 2.955815e+00 | +4.418500e-02 | -7.492002e-02 |   3.339324e+02 | +1.386853e+01 | -1.422483e+01 |     2.385004e+01 | +9.568953e-02 | -9.355010e-02 |   |
|        0780560101 |  0.000843 | 6.889482e+00 | +7.574777e-03 | -5.699446e-01 | 1.299421e+01 | +7.005791e+00 | -9.994209e+00 | 2.585873e+00 | +5.134398e-01 | -3.518284e-01 | 1.712390e+00 | +8.805721e-01 | -1.239030e-02 | 1.999819e+00 | +1.000181e+00 | -1.999819e+00 | 2.609779e+00 | +3.902207e-01 | -1.443682e+00 |   2.111489e+02 | +8.516475e+02 | -9.167285e+01 |     2.213738e+01 | +6.666382e+00 | -3.576872e+00 |   |
|        0780561301 |   0.00039 | 6.660908e+00 | +8.936122e-03 | -1.314797e-01 | 1.609022e+01 | +3.909783e+00 | -4.202124e+00 | 2.556173e+00 | +5.415117e-01 | -2.003260e-01 | 1.805894e+00 | +2.062187e-01 | -1.058942e-01 | 2.618723e+00 | +3.812773e-01 | -2.618723e+00 | 2.782103e+00 | +2.178970e-01 | -5.376322e-01 |   4.082643e+02 | +1.296585e+02 | -9.164730e+01 |     2.355746e+01 | +2.176244e+00 | -5.388666e+00 |   |
|        0780561401 |  4.713916 | 6.375615e+00 | +1.646240e-01 | -8.756153e-01 | 1.900000e+01 | +1.000003e+00 | -1.600000e+01 | 2.200001e+00 | +8.999986e-01 | -2.000014e-01 | 1.700002e+00 | +1.199998e+00 | -1.515324e-06 | 3.000000e+00 | +1.845628e-08 | -3.000000e+00 | 2.999999e+00 | +1.181029e-06 | -1.999999e+00 |   6.999995e+02 | +8.000005e+02 | -5.999995e+02 |     2.316837e+01 | +5.009140e+01 | -1.316837e+01 |   |
|        0780561501 |   0.00042 | 6.798916e+00 | +2.548617e-02 | -1.298916e+00 | 1.949576e+01 | +5.042420e-01 | -7.534981e+00 | 2.541242e+00 | +5.583370e-01 | -1.834044e-01 | 1.955535e+00 | +1.076635e-01 | -2.555352e-01 | 2.718432e+00 | +2.815682e-01 | -2.718432e+00 | 2.820977e+00 | +1.790226e-01 | -1.259075e+00 |   3.780949e+02 | +1.121905e+03 | -2.247062e+02 |     2.622128e+01 | +3.798863e+00 | -8.110640e+00 |   |
|        0780561601 |    0.2273 | 6.068874e+00 | +1.729094e-01 | -1.250543e-06 | 1.351889e+01 | +4.681948e-02 | -6.131014e-09 | 3.036715e+00 | +3.955220e-04 | -1.051259e-02 | 2.538863e+00 | +1.518361e-01 | -4.801151e-10 | 4.175537e-09 | +3.000000e+00 | -4.175537e-09 | 3.000000e+00 | +4.566481e-10 | -1.896097e-02 |   1.727856e+02 | +1.418342e+01 | -4.539136e+01 |     2.187490e+01 | +6.133417e-06 | -5.682563e-01 |   |
|        0780561701 |    1.5533 | 6.368772e+00 | +1.643004e-01 | -2.775570e-01 | 4.963062e+00 | +8.327142e+00 | -1.963062e+00 | 3.100000e+00 | +2.849460e-08 | -8.911101e-01 | 2.000002e+00 | +7.233005e-01 | -3.000017e-01 | 2.999999e+00 | +6.174618e-07 | -2.999999e+00 | 2.999997e+00 | +2.748308e-06 | -1.607797e+00 |   1.200001e+03 | +2.999992e+02 | -2.998915e+02 |     1.499996e+02 | +4.038913e-04 | -8.200818e+01 |   |
|        0792180101 |  0.021454 | 6.905573e+00 | +3.865663e-02 | -6.317518e-06 | 4.081938e+00 | +1.579039e-01 | -1.081938e+00 | 2.563680e+00 | +5.348602e-01 | -1.747579e-01 | 1.903771e+00 | +3.032245e-01 | -2.037710e-01 | 4.558658e-12 | +3.000000e+00 | -4.558658e-12 | 2.775865e+00 | +2.241349e-01 | -7.341263e-01 |   2.821426e+02 | +8.700580e+01 | -1.361990e+02 |     1.597987e+01 | +1.108462e+01 | -8.431650e-03 |   |
|        0792180201 |  0.000680 | 6.807134e+00 | +8.623124e-02 | -4.935335e-02 | 9.429879e+00 | +5.378373e+00 | -8.137568e-02 | 2.943837e+00 | +1.547890e-01 | -7.481917e-01 | 2.438428e+00 | +4.930446e-03 | -7.384281e-01 | 2.950318e+00 | +4.968191e-02 | -2.950318e+00 | 2.999937e+00 | +6.269474e-05 | -1.603628e+00 |   1.949883e+02 | +4.680852e+01 | -2.954765e+01 |     2.117921e+01 | +3.462188e+00 | -1.078268e+00 |   |
|        0792180301 |   0.00376 | 6.356786e+00 | +1.582090e-01 | -1.262212e-01 | 5.880833e+00 | +8.749002e+00 | -2.880833e+00 | 3.099201e+00 | +4.554137e-04 | -2.653878e-01 | 2.145164e+00 | +7.161235e-01 | -4.451636e-01 | 4.293108e-01 | +2.570689e+00 | -4.293108e-01 | 1.767533e+00 | +1.232467e+00 | -7.675326e-01 |   4.999996e+02 | +5.998501e+02 | -2.999998e+02 |     1.061694e+02 | +3.379348e+01 | -3.699180e+01 |   |
|        0792180401 |  5.288735 | 6.360570e+00 | +3.747314e-02 | -2.912606e-07 | 4.807283e+00 | +1.632554e+00 | -1.807283e+00 | 3.099996e+00 | +3.583069e-06 | -7.181153e-01 | 1.700000e+00 | +7.986493e-01 | -8.541148e-09 | 2.999981e+00 | +1.923906e-05 | -2.999981e+00 | 2.460320e+00 | +5.396803e-01 | -1.032798e+00 |   9.581044e+02 | +5.418956e+02 | -5.775365e+01 |     1.500000e+02 | +2.646199e-05 | -3.188029e+01 |   |
|        0792180501 |  2.147211 | 6.360040e+00 | +2.352676e-02 | -6.780563e-03 | 5.758490e+00 | +1.078931e+00 | -1.174803e+00 | 3.099999e+00 | +9.247529e-07 | -5.155650e-01 | 1.794363e+00 | +1.422632e-01 | -9.436301e-02 | 2.999998e+00 | +1.567736e-06 | -2.999998e+00 | 2.999999e+00 | +1.065927e-06 | -8.782892e-01 |   9.024802e+02 | +6.195955e-06 | -1.749441e-05 |     1.500000e+02 | +1.171824e-05 | -1.589649e+00 |   |
|        0792180601 |  1.232846 | 6.374947e+00 | +8.547918e-11 | -5.747745e-02 | 4.667390e+00 | +2.037677e+00 | -1.667390e+00 | 3.099972e+00 | +2.822938e-05 | -8.052963e-01 | 2.165431e+00 | +4.927764e-01 | -4.654314e-01 | 3.000000e+00 | +2.204771e-07 | -3.000000e+00 | 3.000000e+00 | +1.022385e-07 | -1.288276e+00 |   1.200001e+03 | +2.999989e+02 | -2.024779e+02 |     1.500000e+02 | +5.280044e-06 | -3.716426e+01 |   |


*** Fixed mass = 6.45 fitting

** Mass Posterior density (lags taken to fmax and fitted via the table model)

This is an independent check of the mass results using python emcee

This uses all the indiviual observation's table model mass data

PATH = =/home/steff075/phd_ecm/results-for-all/emcee/posterior_density_IRAS.py=

#+BEGIN_EXAMPLE
nwalkers = 100
Running MCMC chain...")
sampler.run_mcmc(state, 100000);

Mean acceptance fraction: 0.324
Mean autocorrelation time: 237.484steps
Mass mean: 6.563
Mass median: 6.510
Mass sigma: 0.249
#+END_EXAMPLE

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS-mass-density-histogram-tm.png

pdf img =
http://www.star.bris.ac.uk/steff/ecm/IRAS-mass-density-histogram-tm.pdf

** Table model fits versus BC4 fits on ECM freepars

PATH =
=/home/steff075/phd_ecm/results-for-all/IRAS_Lum2-10_ecm_V_tm.vsz=

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_Lum2-10_ecm_V_tm.png

** Fixed Mass results logM = 6.45
Using the mean of the indepenedent tests of the BH mass probability
for the fmax fits and the new table model fits where M = 6.45

These results are included in

PATH = =results-for-all/IRAS_results_complete.ods=

| *IRAS 13224-3809* | $\chi^2$ |        $h_2$ |            + |            - |   $\Gamma_1$ |            + |            - |   $\Gamma_2$ |            + |            - |        $\xi$ |            + |            - |          $b$ |            + |             - | $T_\text{max}$ |            + |            - | $T_\text{shift}$ |             + |             - |
|          Combined |   2.4842 | 1.195972e+01 | 1.038526e-01 | 2.370650e-01 | 2.452446e+00 | 4.234613e-02 | 7.398753e-02 | 1.700001e+00 | 6.266345e-02 |   535083e-07 | 1.999828e+00 | 4.143519e-01 | 1.999828e+00 | 2.999999e+00 | 1.108256e-06 |  8.375640e-02 |   4.731669e+02 | 2.314837e+01 | 2.314734e+01 |     2.007109e+01 |  9.878160e-02 |  2.438382e-01 |
|           Hi-flux |   5.2487 | 4.883709e+00 | 1.212768e+00 | 1.883709e+00 | 3.099993e+00 | 7.321025e-06 | 7.166319e-01 | 1.700001e+00 | 7.231154e-01 | 1.346755e-06 | 3.000000e+00 | 4.231444e-07 | 3.000000e+00 | 2.667292e+00 | 3.327084e-01 |  9.728799e-01 |   9.563312e+02 | 5.436688e+02 | 2.740510e+01 |     1.500000e+02 |  1.239231e-05 |  3.174526e+01 |
|         Hi-cts>20 |   2.7380 | 1.363786e+01 | 2.285016e-01 | 3.478649e-02 | 2.436819e+00 | 1.056327e-01 | 1.903619e-02 | 1.700000e+00 | 1.362838e-01 | 1.827710e-09 | 2.348964e-01 | 2.204556e+00 | 2.348964e-01 | 3.000000e+00 | 9.819222e-08 |  1.936244e-01 |   4.775951e+02 | 2.444939e+01 | 3.716006e+01 |     2.224637e+01 |  3.432078e-01 |  1.414469e-01 |
|          Med-spec |   0.9317 | 1.213651e+01 | 3.369560e-01 | 8.938865e-02 | 2.477265e+00 | 4.685835e-02 | 7.565444e-02 | 1.700001e+00 | 4.888774e-02 | 1.499604e-06 | 2.000006e+00 | 4.638072e-01 | 2.000006e+00 | 2.999998e+00 | 1.789112e-06 |  2.947208e-02 |   5.323324e+02 | 5.726082e+01 | 4.176825e+01 |     2.000001e+01 |  1.353968e-01 |  1.067726e-01 |
|           Lo-spec |   1.1754 | 3.263661e+00 | 1.028321e+00 | 2.636605e-01 | 3.099276e+00 | 2.860042e-04 | 1.074798e+00 | 1.700001e+00 | 9.587063e-01 | 5.540362e-07 | 9.359743e-01 | 2.064026e+00 | 9.359743e-01 | 1.371676e+00 | 1.628324e+00 |  3.716763e-01 |   4.000002e+02 | 1.100000e+03 | 3.000002e+02 |     7.455731e+01 |  1.251989e+01 |  1.394854e+01 |
|         Lo-cts<20 |   13.946 | 3.000011e+00 | 9.965883e-02 | 1.116153e-05 | 3.000003e+00 | 9.999682e-02 | 2.745382e-01 | 1.700000e+00 | 5.669860e-01 | 0.000000e+00 | 2.999994e+00 | 5.843603e-06 | 5.223728e-01 | 1.140694e+00 | 1.233636e+00 |  1.406939e-01 |   5.999988e+02 | 2.029333e+02 | 1.427379e+02 |     7.655885e+01 |  9.644460e+00 |  5.959815e+00 |
|        0110890101 |   0.1507 | 1.403289e+01 | 2.983555e+00 | 7.419063e+00 | 2.340834e+00 | 7.591163e-01 | 7.838847e-02 | 1.700002e+00 | 8.749476e-01 | 1.870652e-06 | 3.000000e+00 | 3.518140e-07 | 3.000000e+00 | 2.871125e+00 | 1.288754e-01 |  1.257572e+00 |   3.985818e+02 | 1.101418e+03 | 2.985818e+02 |     2.391805e+01 |  1.521566e+01 |  7.432835e+00 |
|        0673580101 |   1.0592 | 1.500000e+01 | 4.999998e+00 | 7.754521e+00 | 3.091298e+00 | 8.515137e-03 | 8.635777e-01 | 1.700001e+00 | 8.549897e-01 | 1.170662e-06 | 2.999999e+00 | 5.304364e-07 | 2.999999e+00 | 3.000000e+00 | 7.639286e-08 |  1.786949e+00 |   6.000004e+02 | 7.999925e+02 | 3.999980e+02 |     1.000000e+02 |  3.997317e+01 |  2.314713e+01 |
|        0673580201 |   0.5518 | 1.636772e+01 | 8.529628e-01 | 6.167177e+00 | 2.673085e+00 | 4.252199e-01 | 3.363446e-01 | 2.134571e+00 | 3.797108e-01 | 4.345706e-01 | 2.999995e+00 | 5.424173e-06 | 2.999995e+00 | 2.999998e+00 | 1.666001e-06 |  6.262429e-01 |   4.326428e+02 | 5.178696e+01 | 1.357949e+02 |     2.462411e+01 |  6.379721e-01 |  7.546353e+00 |
|        0673580301 |   0.2326 | 1.599429e+01 | 4.005708e+00 | 4.499224e+00 | 3.095784e+00 | 1.519688e-03 | 3.545475e-10 | 2.485650e+00 | 9.203010e-02 | 2.652493e-01 | 1.788824e+00 | 1.211176e+00 | 1.788824e+00 | 2.999995e+00 | 4.967924e-06 |  9.999911e-01 |   4.000002e+02 | 3.853798e-06 | 2.100264e-06 |     2.472834e+01 |  3.506701e-01 |  3.118962e+00 |
|        0673580401 |   2.2730 | 1.441951e+01 | 1.801325e+00 | 1.772054e-01 | 2.251203e+00 | 2.931335e-01 | 4.412511e-02 | 1.700000e+00 | 4.017615e-01 | 0.000000e+00 | 3.000000e+00 | 0.000000e+00 | 3.000000e+00 | 3.000000e+00 | 0.000000e+00 |  1.693428e-01 |   4.769259e+02 | 1.989208e+01 | 4.329306e+01 |     2.353028e+01 |  2.131584e-01 |  1.703649e-01 |
|        0780560101 |   0.8497 | 2.000000e+01 | 8.966629e-07 | 9.555229e+00 | 2.799995e+00 | 2.993444e-01 | 7.123919e-01 | 2.000000e+00 | 5.492127e-01 | 3.000000e-01 | 2.583453e+00 | 4.165474e-01 | 2.583453e+00 | 2.899600e+00 | 1.003996e-01 |  9.498001e-01 |   5.049662e+02 | 9.950338e+02 | 4.049662e+02 |     2.601915e+01 |  2.321786e+00 |  1.062711e+01 |
|        0780561301 |   1.3654 | 1.205277e+01 | 1.761454e+00 | 1.091304e+00 | 2.606618e+00 | 2.154375e-01 | 2.373907e-01 | 1.700000e+00 | 1.789245e-01 | 1.584818e-07 | 2.000000e+00 | 1.000000e+00 | 2.000000e+00 | 3.000000e+00 | 1.095592e-07 |  2.818580e-01 |   5.809558e+02 | 7.424682e+01 | 9.575244e+01 |     2.066598e+01 |  2.132438e+00 |  1.863278e+00 |
|        0780561401 |   0.0002 | 1.227763e+01 | 5.046513e-09 | 1.536006e-02 | 2.894984e+00 | 1.699402e-03 | 1.390043e-02 | 2.394057e+00 | 1.396247e-02 | 7.992567e-04 | 2.986471e+00 | 1.352890e-02 | 1.212416e-09 | 2.498348e+00 | 1.572250e-05 |  1.398736e-03 |   1.363836e+02 | 1.310988e-06 | 1.580128e-08 |     2.157312e+01 |  4.873919e-08 |  3.996974e-05 |
|        0780561501 |   0.3793 | 1.284425e+01 | 7.155745e+00 | 1.456171e+00 | 2.819808e+00 | 2.797615e-01 | 5.378249e-01 | 1.824425e+00 | 6.922708e-01 | 1.244250e-01 | 2.212997e+00 | 7.870033e-01 | 2.212997e+00 | 3.000000e+00 | 9.682450e-10 |  1.452964e+00 |   5.372098e+02 | 1.741924e+02 | 3.919113e+02 |     2.000000e+01 |  3.924338e+00 |  3.660859e+00 |
|        0780561601 |   0.0384 | 1.110239e+01 | 2.153202e+00 | 2.825525e-01 | 3.030117e+00 | 1.285625e-02 | 1.626349e-03 | 2.535332e+00 | 2.097189e-10 | 1.778497e-10 | 3.000000e+00 | 2.446822e-08 | 5.330691e-01 | 2.999706e+00 | 2.942781e-04 |  1.524844e-01 |   1.259764e+02 | 9.851795e+00 | 1.761068e+01 |     2.029561e+01 |  1.141811e-01 |  1.872388e-01 |
|        0780561701 |   1.7842 | 3.205060e+00 | 1.270827e+00 | 2.050602e-01 | 3.099993e+00 | 6.629157e-06 | 8.678933e-01 | 2.000001e+00 | 7.299702e-01 | 3.000005e-01 | 2.999998e+00 | 1.640974e-06 | 2.999998e+00 | 3.000000e+00 | 1.031230e-07 |  1.596976e+00 |   9.884113e+02 | 5.115887e+02 | 6.889215e+01 |     1.200635e+02 |  2.928608e+01 |  5.230066e+01 |
|        0792180101 |   0.2772 | 1.371036e+01 | 2.431880e-01 | 2.335057e+00 | 2.411681e+00 | 1.939969e-01 | 1.197026e-01 | 1.700000e+00 | 2.928010e-04 | 4.965097e-07 | 1.503672e+00 | 1.496328e+00 | 1.503672e+00 | 2.999996e+00 | 3.963599e-06 |  3.019155e-01 |   4.894482e+02 | 1.844579e+02 | 6.903698e+01 |     2.269992e+01 |  3.437594e-01 |  2.739695e-01 |
|        0792180201 |   0.6175 | 1.244264e+01 | 1.204668e-01 | 8.948213e-01 | 2.631192e+00 | 2.914084e-01 | 8.523435e-02 | 1.700001e+00 | 6.546102e-02 | 1.180506e-06 | 9.999510e-01 | 1.030139e+00 | 9.999510e-01 | 2.639011e+00 | 1.804944e-01 |  4.262698e-01 |   2.582487e+02 | 2.441946e+01 | 3.017976e+01 |     1.887054e+01 |  1.545000e+00 |  1.396470e+00 |
|        0792180301 |   0.0028 | 3.364063e+00 | 1.004962e+00 | 3.640629e-01 | 3.098798e+00 | 1.201525e-03 | 1.348927e-01 | 2.085472e+00 | 7.562287e-01 | 3.854725e-01 | 4.811134e-01 | 2.518887e+00 | 4.811134e-01 | 1.726556e+00 | 1.273444e+00 | -7.265558e-01 |   3.785046e+02 | 1.121495e+03 | 1.785057e+02 |     8.623811e+01 |  3.374453e+01 |  1.438627e+01 |
|        0792180401 |   6.3787 | 3.000014e+00 | 5.542589e-01 | 1.371876e-05 | 3.099996e+00 | 3.707169e-06 | 5.046339e-01 | 1.700013e+00 | 6.733462e-01 | 1.349090e-05 | 2.999962e+00 | 3.767740e-05 | 1.138895e+00 | 2.999917e+00 | 8.310146e-05 |  1.278499e+00 |   1.500000e+03 | 0.000000e+00 | 5.708142e+02 |     1.200000e+02 |  1.137181e+01 |  5.616879e+00 |
|        0792180501 |   6.4714 | 3.367828e+00 | 8.305833e-01 | 3.678279e-01 | 3.100000e+00 | 3.134605e-08 | 5.462091e-01 | 1.700001e+00 | 6.954416e-01 | 1.094111e-06 | 3.000000e+00 | 4.988952e-07 | 3.000000e+00 | 3.000000e+00 | 9.205552e-08 |  1.117456e+00 |   1.399999e+03 | 1.000014e+02 | 4.553208e+02 |     1.207723e+02 |  1.166009e+01 |  1.065727e+01 |
|        0792180601 |   1.7105 | 3.000002e+00 | 9.011592e-01 | 2.449257e-06 | 3.100000e+00 | 1.745595e-07 | 7.494057e-01 | 2.059266e+00 | 5.573314e-01 | 3.592656e-01 | 3.000000e+00 | 3.937702e-07 | 3.000000e+00 | 3.000000e+00 | 9.736687e-08 |  1.328993e+00 |   9.999241e+02 | 5.000759e+02 | 9.980393e+01 |     1.212538e+02 | +1.136612e+01 | -9.305610e+00 |


*Loading the fixed Mass results into all fits*

PATH =
=/home/steff075/phd_ecm/results-for-all/IRAS_Lum2-10_ecm_V_tm.vsz=

#+ATTR_HTML::width 600
http://www.star.bris.ac.uk/steff/ecm/IRAS_Lum2-10_ecm_V_tm_FM6pt45.png


* *IRAS Simultaneous Mass on grouped data fits*

*Strategy*

Load one set at a time using all 15 main pars and run conf
until model converges and fits well.

Save the par file, e.g: =save_par("conf_mass_fit_1data");

Then add the next set of pars for the next observation and run conf
again on all pars using par3 as the main mass par tied to the other
mass values above then save those pars e.g: =save_par("conf_mass_fit_2data");

Continue buidling the full par file

** Combined data + hiflux

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/IRAS13224-3809/sim-fit-grouped.sl=

Importing =sim_fit_2group.par=

#+BEGIN_EXAMPLE
isis
source("sim-fit-grouped.sl");

[detached from 27996.pts-37.hm00]


Parameters[Variable] = 32[17]
            Data bins = 14
           Chi-square = 17.23446
sds(1)*lag_freq(1) + sds(2)*lag_freq(2)
 idx  param             tie-to  freeze         value         min         max
  1  sds(1).dataset         0     1                1           1           1
  2  lag_freq(1).norm       0     0        0.6819258           0          10
  3  lag_freq(1).log_mass   0     0         6.377162         5.5           8
  4  lag_freq(1).i          0     1               64          64          64
  5  lag_freq(1).a          0     1            0.998       0.998       0.998
  6  lag_freq(1).h1         0     1                2           2           2
  7  lag_freq(1).h2         0     0         4.608382           3          20
  8  lag_freq(1).Gamma1     0     0         3.131955         1.8       3.299
  9  lag_freq(1).Gamma2     0     0              1.4         1.4         3.2
 10  lag_freq(1).Fe         0     1                1           1           1
 11  lag_freq(1).xi         0     0         2.999998           0           3
 12  lag_freq(1).p          0     1                0           0           0
 13  lag_freq(1).b          0     0         1.593473           1           3
 14  lag_freq(1).q2         0     1              0.5         0.5         0.5
 15  lag_freq(1).t_max      0     0         699.9997          50        1500
 16  lag_freq(1).t_shift    0     0              150          10         150
 17  sds(2).dataset         0     1                2           2           2
 18  lag_freq(2).norm       0     0         0.461324           0          10
 19  lag_freq(2).log_mass   3     0         6.377162         5.5           8
 20  lag_freq(2).i          4     1               64          64          64
 21  lag_freq(2).a          5     1            0.998       0.998       0.998
 22  lag_freq(2).h1         6     1                2           2           2
 23  lag_freq(2).h2         0     0         4.380734           3          20
 24  lag_freq(2).Gamma1     0     0         3.103362         1.8       3.299
 25  lag_freq(2).Gamma2     0     0         1.400001         1.4         3.2
 26  lag_freq(2).Fe        10     1                1           1           1
 27  lag_freq(2).xi         0     0         1.971872           0           3
 28  lag_freq(2).p         12     1                0           0           0
 29  lag_freq(2).b          0     0                3           1           3
 30  lag_freq(2).q2        14     1              0.5         0.5         0.5
 31  lag_freq(2).t_max      0     0         800.0004          50        1500
 32  lag_freq(2).t_shift    0     0              150          10         150

#+END_EXAMPLE

** Combined data + hiflux + hi-cts

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/IRAS13224-3809/sim-fit-grouped.sl=

Importing =sim_fit_3group.par=

#+BEGIN_EXAMPLE
isis
source("sim-fit-grouped.sl");

[detached from 27996.pts-37.hm00]

#+END_EXAMPLE

| lag_freq(1).norm     | 7.843460e-01 | +8.634537e-02 | -1.154905e-01 |
| lag_freq(1).log_mass | 6.371929e+00 | +2.120794e-04 | -4.331825e-04 |
| lag_freq(1).h2       | 4.212303e+00 | +7.976422e-02 | -8.537938e-02 |
| lag_freq(1).Gamma1   | 2.600000e+00 | +8.855890e-02 | -7.171464e-02 |
| lag_freq(1).Gamma2   | 1.900000e+00 | +5.696959e-02 | -1.279677e-01 |
| lag_freq(1).xi       | 0.000000e+00 | +2.199969e+00 | -0.000000e+00 |
| lag_freq(1).b        | 3.000000e+00 | +0.000000e+00 | -3.632409e-01 |
| lag_freq(1).t_max    | 1.499951e+03 | +4.861988e-02 | -7.079901e+02 |
| lag_freq(1).t_shift  | 1.000000e+01 | +4.055246e-01 | -0.000000e+00 |
| lag_freq(2).norm     | 4.047650e-01 | +1.968455e-01 | -9.439009e-02 |
| lag_freq(2).h2       | 4.000000e+00 | +1.093755e+00 | -5.505247e-01 |
| lag_freq(2).Gamma1   | 3.103900e+00 | +1.819771e-02 | -3.196858e-01 |
| lag_freq(2).Gamma2   | 1.400073e+00 | +1.035112e+00 | -7.324219e-05 |
| lag_freq(2).xi       | 0.000000e+00 | +3.000000e+00 | -0.000000e+00 |
| lag_freq(2).b        | 2.000000e+00 | +9.094932e-01 | -4.132627e-01 |
| lag_freq(2).t_max    | 5.750000e+02 | +9.250000e+02 | -1.207537e+02 |
| lag_freq(2).t_shift  | 1.445856e+02 | +5.414363e+00 | -1.715991e+01 |
| lag_freq(3).norm     | 4.527668e-01 | +3.871796e-02 | -9.658697e-02 |
| lag_freq(3).h2       | 4.647223e+00 | +3.189170e-01 | -1.720677e-01 |
| lag_freq(3).Gamma1   | 3.114273e+00 | +7.888360e-03 | -4.944404e-01 |
| lag_freq(3).Gamma2   | 1.600000e+00 | +3.307266e-01 | -2.000000e-01 |
| lag_freq(3).xi       | 3.000000e+00 | +0.000000e+00 | -3.000000e+00 |
| lag_freq(3).b        | 3.000000e+00 | +0.000000e+00 | -5.932030e-01 |
| lag_freq(3).t_max    | 9.070060e+02 | +1.149376e+02 | -5.780530e+01 |
| lag_freq(3).t_shift  | 1.500000e+02 | +0.000000e+00 | -5.594319e+00 |

** Combined data + hiflux + hi-cts + medflux

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/IRAS13224-3809/sim-fit-grouped.sl=

Importing =sim_fit_4group.par=

#+BEGIN_EXAMPLE
isis
source("sim-fit-grouped.sl");

source("confloop_4data.sl");

#+END_EXAMPLE

| lag_freq(1).norm     | 7.843460e-01 | +8.982415e-02 | -1.097043e-01 |
| lag_freq(1).log_mass | 6.380559e+00 | +2.196654e-03 | -5.899329e-03 |
| lag_freq(1).h2       | 4.102680e+00 | +5.697334e-02 | -1.213748e-01 |
| lag_freq(1).Gamma1   | 2.600000e+00 | +8.497763e-02 | -8.049823e-02 |
| lag_freq(1).Gamma2   | 1.900000e+00 | +6.753227e-02 | -1.192600e-01 |
| lag_freq(1).xi       | 1.500000e+00 | +8.389967e-01 | -1.500000e+00 |
| lag_freq(1).b        | 3.000000e+00 | +0.000000e+00 | -3.559920e-01 |
| lag_freq(1).t_max    | 1.499951e+03 | +4.900000e-02 | -2.073900e+02 |
| lag_freq(1).t_shift  | 1.000000e+01 | +4.824277e-01 | -0.000000e+00 |
| lag_freq(2).norm     | 4.047650e-01 | +1.393571e-01 | -6.054915e-02 |
| lag_freq(2).h2       | 4.000000e+00 | +6.288610e-01 | -5.928837e-01 |
| lag_freq(2).Gamma1   | 3.103900e+00 | +1.437355e-02 | -4.210425e-01 |
| lag_freq(2).Gamma2   | 1.400073e+00 | +8.878878e-01 | -7.300000e-05 |
| lag_freq(2).xi       | 0.000000e+00 | +3.000000e+00 | -0.000000e+00 |
| lag_freq(2).b        | 2.730712e+00 | +2.692885e-01 | -9.862436e-01 |
| lag_freq(2).t_max    | 5.750000e+02 | +6.082796e+02 | -1.392357e+02 |
| lag_freq(2).t_shift  | 1.498308e+02 | +1.692000e-01 | -1.563161e+01 |
| lag_freq(3).norm     | 4.527668e-01 | +1.054751e-01 | -4.473980e-02 |
| lag_freq(3).h2       | 4.647223e+00 | +1.187630e-01 | -5.777764e-01 |
| lag_freq(3).Gamma1   | 3.114273e+00 | +8.467305e-03 | -4.822223e-01 |
| lag_freq(3).Gamma2   | 1.600000e+00 | +4.829587e-01 | -2.000000e-01 |
| lag_freq(3).xi       | 3.000000e+00 | +0.000000e+00 | -7.168263e-01 |
| lag_freq(3).b        | 3.000000e+00 | +0.000000e+00 | -5.595048e-01 |
| lag_freq(3).t_max    | 9.070060e+02 | +9.074774e+01 | -4.543943e+01 |
| lag_freq(3).t_shift  | 1.500000e+02 | +0.000000e+00 | -1.034785e+01 |
| lag_freq(4).norm     | 3.605045e-01 | +3.694778e-02 | -7.758689e-02 |
| lag_freq(4).h2       | 4.318068e+00 | +3.115970e-01 | -1.637252e-01 |
| lag_freq(4).Gamma1   | 3.096495e+00 | +1.040980e-02 | -2.977370e-01 |
| lag_freq(4).Gamma2   | 1.600000e+00 | +6.063631e-01 | -2.000000e-01 |
| lag_freq(4).xi       | 2.250000e+00 | +7.500000e-01 | -2.250000e+00 |
| lag_freq(4).b        | 1.500000e+00 | +1.165241e+00 | -4.500773e-01 |
| lag_freq(4).t_max    | 7.139515e+02 | +1.273889e+02 | -7.439883e+01 |
| lag_freq(4).t_shift  | 1.500000e+02 | +0.000000e+00 | -1.665891e+01 |

** Combined data + hiflux + hi-cts + medflux + loflux

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/IRAS13224-3809/sim-fit-grouped.sl=

Importing =sim_fit_5group.par=

#+BEGIN_EXAMPLE
isis
source("sim-fit-grouped.sl");


Run conf by:

source("l");

#+END_EXAMPLE


| lag_freq(1).norm     | 7.843460e-01 | +1.259780e-01 | -8.427536e-02 |
| lag_freq(1).log_mass | 6.380559e+00 | +2.459556e-03 | -4.321105e-03 |
| lag_freq(1).h2       | 4.102680e+00 | +8.044573e-02 | -7.992297e-02 |
| lag_freq(1).Gamma1   | 2.600000e+00 | +1.212905e-01 | -7.379169e-02 |
| lag_freq(1).Gamma2   | 1.900000e+00 | +5.590357e-02 | -1.487392e-01 |
| lag_freq(1).xi       | 1.500000e+00 | +8.389995e-01 | -1.500000e+00 |
| lag_freq(1).b        | 3.000000e+00 | +0.000000e+00 | -3.559830e-01 |
| lag_freq(1).t_max    | 1.499951e+03 | +4.900000e-02 | -2.073938e+02 |
| lag_freq(1).t_shift  | 1.000000e+01 | +4.824147e-01 | -0.000000e+00 |
| lag_freq(2).norm     | 4.047650e-01 | +7.968757e-02 | -8.524822e-02 |
| lag_freq(2).h2       | 4.000000e+00 | +4.575453e-01 | -7.333077e-01 |
| lag_freq(2).Gamma1   | 3.103900e+00 | +2.024016e-02 | -5.977402e-01 |
| lag_freq(2).Gamma2   | 1.400073e+00 | +7.310380e-01 | -7.300000e-05 |
| lag_freq(2).xi       | 0.000000e+00 | +2.918411e+00 | -0.000000e+00 |
| lag_freq(2).b        | 2.730712e+00 | +2.692880e-01 | -9.183435e-01 |
| lag_freq(2).t_max    | 5.750000e+02 | +5.823570e+02 | -9.643424e+01 |
| lag_freq(2).t_shift  | 1.498308e+02 | +1.692000e-01 | -1.563158e+01 |
| lag_freq(3).norm     | 4.527668e-01 | +1.054752e-01 | -4.473971e-02 |
| lag_freq(3).h2       | 4.647223e+00 | +1.187646e-01 | -5.777673e-01 |
| lag_freq(3).Gamma1   | 3.114273e+00 | +8.467455e-03 | -4.822253e-01 |
| lag_freq(3).Gamma2   | 1.600000e+00 | +4.829568e-01 | -2.000000e-01 |
| lag_freq(3).xi       | 3.000000e+00 | +0.000000e+00 | -7.168387e-01 |
| lag_freq(3).b        | 3.000000e+00 | +0.000000e+00 | -5.595057e-01 |
| lag_freq(3).t_max    | 9.070060e+02 | +9.074824e+01 | -4.543967e+01 |
| lag_freq(3).t_shift  | 1.500000e+02 | +0.000000e+00 | -1.034767e+01 |
| lag_freq(4).norm     | 3.605045e-01 | +8.727491e-02 | -3.407639e-02 |
| lag_freq(4).h2       | 4.318068e+00 | +2.389295e-01 | -1.654381e-01 |
| lag_freq(4).Gamma1   | 3.096495e+00 | +1.304147e-02 | -2.976905e-01 |
| lag_freq(4).Gamma2   | 1.400098e+00 | +7.067460e-01 | -9.765625e-05 |
| lag_freq(4).xi       | 2.250000e+00 | +7.500000e-01 | -2.250000e+00 |
| lag_freq(4).b        | 1.500000e+00 | +5.313194e-01 | -5.000000e-01 |
| lag_freq(4).t_max    | 7.139515e+02 | +1.279061e+02 | -8.021627e+01 |
| lag_freq(4).t_shift  | 1.500000e+02 | +0.000000e+00 | -1.630614e+01 |
| lag_freq(5).norm     | 2.253153e-02 | +3.282202e-01 | -2.253153e-02 |
| lag_freq(5).h2       | 7.250000e+00 | +1.008483e+01 | -4.250000e+00 |
| lag_freq(5).Gamma1   | 1.800586e+00 | +1.370638e+00 | -5.859375e-04 |
| lag_freq(5).Gamma2   | 1.740000e+00 | +1.285428e+00 | -3.400000e-01 |
| lag_freq(5).xi       | 5.625000e-01 | +2.437500e+00 | -5.625000e-01 |
| lag_freq(5).b        | 1.001953e+00 | +1.998047e+00 | -1.953125e-03 |
| lag_freq(5).t_max    | 1.394107e+03 | +1.058932e+02 | -1.344107e+03 |
| lag_freq(5).t_shift  | 2.000000e+01 | +1.300000e+02 | -1.000000e+01 |

** Combined data + hiflux + hi-cts + medflux + loflux + lo-cts

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/IRAS13224-3809/sim-fit-grouped.sl=

Importing =sim-fit-grouped-6.sloup.par=

#+BEGIN_EXAMPLE

source("sim-fit-grouped-6.sl");


confloop_6group.csv

 Parameters[Variable] = 96[49]
            Data bins = 42
           Chi-square = 646.581

#+END_EXAMPLE

| lag_freq(1).norm     | 7.843460e-01 | +1.259780e-01 | -8.427536e-02 |
| lag_freq(1).log_mass | 5.606347e+00 | +7.945597e-04 | -2.852574e-03 |
| lag_freq(1).h2       | 1.890608e+01 | +2.466148e-01 | -1.275040e+00 |
| lag_freq(1).Gamma1   | 2.200000e+00 | +5.308519e-02 | -1.988003e-01 |
| lag_freq(1).Gamma2   | 2.053573e+00 | +1.523611e-01 | -2.598504e-01 |
| lag_freq(1).xi       | 2.999634e+00 | +3.662109e-04 | -2.999634e+00 |
| lag_freq(1).b        | 3.000000e+00 | +0.000000e+00 | -9.182101e-01 |
| lag_freq(1).t_max    | 2.312439e+02 | +4.651347e+01 | -1.156491e+02 |
| lag_freq(1).t_shift  | 3.555631e+01 | +6.536509e+00 | -1.028233e+01 |
| lag_freq(2).norm     | 1.235245e-05 | +4.201106e-02 | -1.235245e-05 |
| lag_freq(2).h2       | 4.000000e+00 | +1.600000e+01 | -1.000000e+00 |
| lag_freq(2).Gamma1   | 3.103900e+00 | +1.951000e-01 | -1.303900e+00 |
| lag_freq(2).Gamma2   | 1.400073e+00 | +1.799927e+00 | -7.300000e-05 |
| lag_freq(2).xi       | 0.000000e+00 | +3.000000e+00 | -0.000000e+00 |
| lag_freq(2).b        | 2.730712e+00 | +2.692880e-01 | -1.730712e+00 |
| lag_freq(2).t_max    | 5.750000e+02 | +9.250000e+02 | -3.751007e+02 |
| lag_freq(2).t_shift  | 1.498308e+02 | +1.692000e-01 | -1.398308e+02 |
| lag_freq(3).norm     | 6.908673e-06 | +2.349282e-02 | -6.908673e-06 |
| lag_freq(3).h2       | 4.647223e+00 | +1.535278e+01 | -1.647223e+00 |
| lag_freq(3).Gamma1   | 3.114273e+00 | +1.847270e-01 | -1.314273e+00 |
| lag_freq(3).Gamma2   | 1.600000e+00 | +1.600000e+00 | -2.000000e-01 |
| lag_freq(3).xi       | 3.000000e+00 | +0.000000e+00 | -3.000000e+00 |
| lag_freq(3).b        | 3.000000e+00 | +0.000000e+00 | -2.000000e+00 |
| lag_freq(3).t_max    | 9.070060e+02 | +5.929940e+02 | -7.070045e+02 |
| lag_freq(3).t_shift  | 1.500000e+02 | +0.000000e+00 | -1.400000e+02 |
| lag_freq(4).norm     | 1.100172e-05 | +4.383295e-02 | -1.100172e-05 |
| lag_freq(4).h2       | 4.318068e+00 | +1.568193e+01 | -1.318068e+00 |
| lag_freq(4).Gamma1   | 3.096495e+00 | +2.025050e-01 | -1.296495e+00 |
| lag_freq(4).Gamma2   | 1.400098e+00 | +1.799902e+00 | -9.800000e-05 |
| lag_freq(4).xi       | 2.250000e+00 | +7.500000e-01 | -2.250000e+00 |
| lag_freq(4).b        | 1.500000e+00 | +1.500000e+00 | -5.000000e-01 |
| lag_freq(4).t_max    | 7.139515e+02 | +7.860485e+02 | -5.139511e+02 |
| lag_freq(4).t_shift  | 1.500000e+02 | +0.000000e+00 | -1.400000e+02 |
| lag_freq(5).norm     | 5.391702e-01 | +5.259385e-01 | -3.313006e-01 |
| lag_freq(5).h2       | 1.893750e+01 | +1.062500e+00 | -1.593750e+01 |
| lag_freq(5).Gamma1   | 1.800586e+00 | +4.971745e-01 | -5.860000e-04 |
| lag_freq(5).Gamma2   | 1.740000e+00 | +7.772393e-01 | -3.400000e-01 |
| lag_freq(5).xi       | 2.999680e+00 | +3.204346e-04 | -2.999680e+00 |
| lag_freq(5).b        | 2.999437e+00 | +5.627568e-04 | -1.999437e+00 |
| lag_freq(5).t_max    | 2.180134e+02 | +1.281987e+03 | -1.492675e+02 |
| lag_freq(5).t_shift  | 5.806449e+01 | +3.588058e+00 | -1.300071e+01 |
| lag_freq(6).norm     | 5.887151e-07 | +1.695554e-02 | -5.887151e-07 |
| lag_freq(6).h2       | 4.150000e+00 | +1.585000e+01 | -1.150000e+00 |
| lag_freq(6).Gamma1   | 3.005860e+00 | +2.931400e-01 | -1.205860e+00 |
| lag_freq(6).Gamma2   | 1.740000e+00 | +1.460000e+00 | -3.400000e-01 |
| lag_freq(6).xi       | 2.925000e+00 | +7.500000e-02 | -2.925000e+00 |
| lag_freq(6).b        | 1.001953e+00 | +1.998047e+00 | -1.953000e-03 |
| lag_freq(6).t_max    | 7.501200e+02 | +7.498800e+02 | -7.001200e+02 |
| lag_freq(6).t_shift  | 8.000000e+01 | +7.000000e+01 | -7.000000e+01 |

* *IRAS 13224-3809 Simultaneous Mass fits where log M ranges 5.5 - 8.0*

Load one set at a time using all 15 main pars and run conf
until model converges and fits well.

Save the par file, e.g: =save_par("conf_mass_fit_1data");

Then add the next set of pars for the next observation and run conf
again on all pars using par3 as the main mass par tied to the other
mass values above then save those pars e.g:
=save_par("conf_mass_fit_2data") and then continue buidling the full
par file for all data sets.

** First data set

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/IRAS13224-3809/mass-fit-1data.sl=

gedit =conf_mass_fit_1data.csv=

| lag_freq(1).norm     | 9.861464e+00 | +1.385365e-01 | -9.640589e+00 |
| lag_freq(1).log_mass | 6.672443e+00 | +1.054291e+00 | -1.172443e+00 |
| lag_freq(1).h2       | 1.270286e+01 | +4.028380e+00 | -4.258851e+00 |
| lag_freq(1).Gamma1   | 2.677456e+00 | +5.195343e-01 | -6.399324e-01 |
| lag_freq(1).Gamma2   | 2.169216e+00 | +3.083037e-01 | -7.692163e-01 |
| lag_freq(1).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(1).b        | 2.840875e+00 | +1.591253e-01 | -9.099115e-01 |
| lag_freq(1).t_max    | 2.707563e+02 | +1.139671e+02 | -2.115660e+01 |
| lag_freq(1).t_shift  | 2.274087e+01 | +8.405726e+00 | -6.248664e+00 |

This data set fit perfectly. Note - No further fits will be plotted at this stage as we need to fit
'all' data sets to obtain a single mass value first!

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_tm_sim_1data-1.png

** 2 data sets

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/IRAS13224-3809/mass-fit-2data.sl=

gedit =conf_mass_fit_2data.csv=

[detached from 91784.pts-3.hm00]

| lag_freq(1).norm     | 1.950143e-01 | +6.249737e-01 | -1.950143e-01 |
| lag_freq(1).log_mass | 7.827654e+00 | +5.444007e-02 | -1.180257e-01 |
| lag_freq(1).h2       | 4.412086e+00 | +1.558791e+01 | -1.412086e+00 |
| lag_freq(1).Gamma1   | 2.677456e+00 | +6.215440e-01 | -8.774560e-01 |
| lag_freq(1).Gamma2   | 2.169216e+00 | +1.030784e+00 | -7.692160e-01 |
| lag_freq(1).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(1).b        | 2.999981e+00 | +1.942444e-05 | -1.999981e+00 |
| lag_freq(1).t_max    | 2.707563e+02 | +5.292437e+02 | -2.207563e+02 |
| lag_freq(1).t_shift  | 1.001244e+01 | +1.399876e+02 | -1.244226e-02 |
| lag_freq(2).norm     | 2.358049e-01 | +1.571496e-01 | -1.465662e-01 |
| lag_freq(2).h2       | 1.635143e+01 | +3.648570e+00 | -8.755434e+00 |
| lag_freq(2).Gamma1   | 2.988228e+00 | +1.743010e-01 | -1.188228e+00 |
| lag_freq(2).Gamma2   | 1.403005e+00 | +1.539608e+00 | -3.004750e-03 |
| lag_freq(2).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(2).b        | 2.999378e+00 | +6.215820e-04 | -1.999378e+00 |
| lag_freq(2).t_max    | 2.462311e+02 | +5.537689e+02 | -1.962311e+02 |
| lag_freq(2).t_shift  | 4.822261e+01 | +5.639504e+01 | -1.729339e+01 |

** 3 data sets

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/IRAS13224-3809/mass-fit-3data.sl=

gedit =conf_mass_fit_3data.csv=

| lag_freq(1).norm     | 1.950143e-01 | +4.609888e-01 | -1.950143e-01 |
| lag_freq(1).log_mass | 7.789282e+00 | +3.266138e-02 | -3.555862e-02 |
| lag_freq(1).h2       | 5.118129e+00 | +1.488187e+01 | -2.118129e+00 |
| lag_freq(1).Gamma1   | 2.677456e+00 | +6.215440e-01 | -8.439615e-01 |
| lag_freq(1).Gamma2   | 2.169216e+00 | +1.030784e+00 | -7.692160e-01 |
| lag_freq(1).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(1).b        | 2.999981e+00 | +1.900000e-05 | -1.999981e+00 |
| lag_freq(1).t_max    | 2.707563e+02 | +5.292437e+02 | -2.207563e+02 |
| lag_freq(1).t_shift  | 1.001244e+01 | +1.399876e+02 | -1.244000e-02 |
| lag_freq(2).norm     | 2.358049e-01 | +1.856714e-01 | -1.480740e-01 |
| lag_freq(2).h2       | 1.999644e+01 | +3.563057e-03 | -1.017660e+01 |
| lag_freq(2).Gamma1   | 2.097057e+00 | +1.071975e+00 | -2.970570e-01 |
| lag_freq(2).Gamma2   | 1.403005e+00 | +8.388935e-01 | -3.005000e-03 |
| lag_freq(2).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(2).b        | 2.999378e+00 | +6.220000e-04 | -1.999378e+00 |
| lag_freq(2).t_max    | 2.462311e+02 | +5.537689e+02 | -1.962311e+02 |
| lag_freq(2).t_shift  | 4.822261e+01 | +6.424453e+01 | -1.551915e+01 |
| lag_freq(3).norm     | 4.281726e-01 | +3.398772e-01 | -1.810208e-01 |
| lag_freq(3).h2       | 6.337858e+00 | +3.084681e+00 | -2.165824e+00 |
| lag_freq(3).Gamma1   | 2.988228e+00 | +1.551512e-01 | -8.620776e-01 |
| lag_freq(3).Gamma2   | 1.403005e+00 | +8.662969e-01 | -3.005000e-03 |
| lag_freq(3).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(3).b        | 2.999371e+00 | +6.290563e-04 | -1.343449e+00 |
| lag_freq(3).t_max    | 2.462311e+02 | +5.537689e+02 | -9.291273e+01 |
| lag_freq(3).t_shift  | 1.000467e+01 | +5.699944e+00 | -4.665846e-03 |

** 4 data sets

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/IRAS13224-3809/mass-fit-4data.sl=

gedit =conf_mass_fit_4data.csv=

[detached from 91784.pts-3.hm00]

| lag_freq(1).norm     | 1.950143e-01 | +4.609884e-01 | -1.950143e-01 |
| lag_freq(1).log_mass | 7.789282e+00 | +2.814082e-02 | -5.149458e-02 |
| lag_freq(1).h2       | 5.118129e+00 | +1.488187e+01 | -2.118129e+00 |
| lag_freq(1).Gamma1   | 2.677456e+00 | +6.215440e-01 | -8.439610e-01 |
| lag_freq(1).Gamma2   | 2.169216e+00 | +1.030784e+00 | -7.692160e-01 |
| lag_freq(1).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(1).b        | 2.999981e+00 | +1.900000e-05 | -1.999981e+00 |
| lag_freq(1).t_max    | 2.707563e+02 | +5.292437e+02 | -2.207563e+02 |
| lag_freq(1).t_shift  | 1.001244e+01 | +1.399876e+02 | -1.244000e-02 |
| lag_freq(2).norm     | 2.358049e-01 | +1.856710e-01 | -1.480740e-01 |
| lag_freq(2).h2       | 1.999644e+01 | +3.560000e-03 | -1.017660e+01 |
| lag_freq(2).Gamma1   | 2.097057e+00 | +1.071975e+00 | -2.970570e-01 |
| lag_freq(2).Gamma2   | 1.403005e+00 | +8.388936e-01 | -3.005000e-03 |
| lag_freq(2).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(2).b        | 2.999378e+00 | +6.220000e-04 | -1.999378e+00 |
| lag_freq(2).t_max    | 2.462311e+02 | +5.537689e+02 | -1.962311e+02 |
| lag_freq(2).t_shift  | 4.822261e+01 | +6.424450e+01 | -1.551914e+01 |
| lag_freq(3).norm     | 4.281726e-01 | +3.398767e-01 | -1.810210e-01 |
| lag_freq(3).h2       | 6.337858e+00 | +3.084697e+00 | -2.165820e+00 |
| lag_freq(3).Gamma1   | 2.988228e+00 | +1.551512e-01 | -8.620758e-01 |
| lag_freq(3).Gamma2   | 1.403005e+00 | +8.662951e-01 | -3.005000e-03 |
| lag_freq(3).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(3).b        | 2.999371e+00 | +6.290000e-04 | -1.343447e+00 |
| lag_freq(3).t_max    | 2.462311e+02 | +5.537689e+02 | -9.291288e+01 |
| lag_freq(3).t_shift  | 1.000467e+01 | +5.699952e+00 | -4.670000e-03 |
| lag_freq(4).norm     | 2.140863e-01 | +3.059605e-01 | -2.140863e-01 |
| lag_freq(4).h2       | 4.668929e+00 | +1.159375e+01 | -1.668929e+00 |
| lag_freq(4).Gamma1   | 2.988228e+00 | +3.107720e-01 | -1.188228e+00 |
| lag_freq(4).Gamma2   | 1.403005e+00 | +1.796995e+00 | -3.005000e-03 |
| lag_freq(4).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(4).b        | 2.999371e+00 | +6.290000e-04 | -1.999371e+00 |
| lag_freq(4).t_max    | 2.462311e+02 | +5.537689e+02 | -1.189929e+02 |
| lag_freq(4).t_shift  | 1.000467e+01 | +1.144691e+02 | -4.670000e-03 |

** 5 data sets

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/IRAS13224-3809/mass-fit-5data.sl=

gedit =conf_mass_fit_5data.csv=

[detached from 93522.pts-7.hm00]

| lag_freq(1).norm     | 1.950143e-01 | +4.609884e-01 | -1.950143e-01 |
| lag_freq(1).log_mass | 7.789282e+00 | +1.719745e-02 | -1.856702e-02 |
| lag_freq(1).h2       | 5.118129e+00 | +1.488187e+01 | -2.118129e+00 |
| lag_freq(1).Gamma1   | 2.677456e+00 | +6.215440e-01 | -8.439610e-01 |
| lag_freq(1).Gamma2   | 2.169216e+00 | +1.030784e+00 | -7.692160e-01 |
| lag_freq(1).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(1).b        | 2.999981e+00 | +1.900000e-05 | -1.999981e+00 |
| lag_freq(1).t_max    | 2.707563e+02 | +5.292437e+02 | -2.207563e+02 |
| lag_freq(1).t_shift  | 1.001244e+01 | +1.399876e+02 | -1.244000e-02 |
| lag_freq(2).norm     | 2.358049e-01 | +1.856710e-01 | -1.480740e-01 |
| lag_freq(2).h2       | 1.999644e+01 | +3.560000e-03 | -1.017660e+01 |
| lag_freq(2).Gamma1   | 2.097057e+00 | +1.071975e+00 | -2.970570e-01 |
| lag_freq(2).Gamma2   | 1.403005e+00 | +8.388936e-01 | -3.005000e-03 |
| lag_freq(2).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(2).b        | 2.999378e+00 | +6.220000e-04 | -1.999378e+00 |
| lag_freq(2).t_max    | 2.462311e+02 | +5.537689e+02 | -1.962311e+02 |
| lag_freq(2).t_shift  | 4.822261e+01 | +6.424450e+01 | -1.551914e+01 |
| lag_freq(3).norm     | 4.281726e-01 | +3.398767e-01 | -1.810210e-01 |
| lag_freq(3).h2       | 6.337858e+00 | +3.084697e+00 | -2.165820e+00 |
| lag_freq(3).Gamma1   | 2.988228e+00 | +1.551512e-01 | -8.620758e-01 |
| lag_freq(3).Gamma2   | 1.403005e+00 | +8.662951e-01 | -3.005000e-03 |
| lag_freq(3).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(3).b        | 2.999371e+00 | +6.290000e-04 | -1.343447e+00 |
| lag_freq(3).t_max    | 2.462311e+02 | +5.537689e+02 | -9.291288e+01 |
| lag_freq(3).t_shift  | 1.000467e+01 | +5.699952e+00 | -4.670000e-03 |
| lag_freq(4).norm     | 2.140863e-01 | +3.059605e-01 | -2.140863e-01 |
| lag_freq(4).h2       | 4.668929e+00 | +1.159375e+01 | -1.668929e+00 |
| lag_freq(4).Gamma1   | 2.988228e+00 | +3.107720e-01 | -1.188228e+00 |
| lag_freq(4).Gamma2   | 1.403005e+00 | +1.796995e+00 | -3.005000e-03 |
| lag_freq(4).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(4).b        | 2.999371e+00 | +6.290000e-04 | -1.999371e+00 |
| lag_freq(4).t_max    | 2.462311e+02 | +5.537689e+02 | -1.189929e+02 |
| lag_freq(4).t_shift  | 1.000467e+01 | +1.144691e+02 | -4.670000e-03 |
| lag_freq(5).norm     | 5.904434e-01 | +1.370329e-01 | -2.708911e-01 |
| lag_freq(5).h2       | 5.503394e+00 | +1.191491e+00 | -1.468333e+00 |
| lag_freq(5).Gamma1   | 3.089056e+00 | +5.708241e-02 | -5.647101e-01 |
| lag_freq(5).Gamma2   | 1.570542e+00 | +2.783152e-01 | -1.705415e-01 |
| lag_freq(5).xi       | 9.694770e-01 | +1.921801e+00 | -9.694770e-01 |
| lag_freq(5).b        | 2.999990e+00 | +9.828125e-06 | -4.585426e-01 |
| lag_freq(5).t_max    | 9.905777e+01 | +4.175909e+01 | -2.260339e+01 |
| lag_freq(5).t_shift  | 1.000055e+01 | +4.524713e+00 | -5.541064e-04 |

** 6 data sets

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/IRAS13224-3809/mass-fit-6data.sl=

gedit =conf_mass_fit_6data.csv=

| lag_freq(1).norm     | 1.950143e-01 | +4.609884e-01 | -1.950143e-01 |
| lag_freq(1).log_mass | 7.789282e+00 | +1.585321e-02 | -1.733923e-02 |
| lag_freq(1).h2       | 5.118129e+00 | +1.488187e+01 | -2.118129e+00 |
| lag_freq(1).Gamma1   | 2.677456e+00 | +6.215440e-01 | -8.439610e-01 |
| lag_freq(1).Gamma2   | 2.169216e+00 | +1.030784e+00 | -7.692160e-01 |
| lag_freq(1).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(1).b        | 2.999981e+00 | +1.900000e-05 | -1.999981e+00 |
| lag_freq(1).t_max    | 2.707563e+02 | +5.292437e+02 | -2.207563e+02 |
| lag_freq(1).t_shift  | 1.001244e+01 | +1.399876e+02 | -1.244000e-02 |
| lag_freq(2).norm     | 2.358049e-01 | +1.856710e-01 | -1.480740e-01 |
| lag_freq(2).h2       | 1.999644e+01 | +3.560000e-03 | -1.017660e+01 |
| lag_freq(2).Gamma1   | 2.097057e+00 | +1.071975e+00 | -2.970570e-01 |
| lag_freq(2).Gamma2   | 1.403005e+00 | +8.388936e-01 | -3.005000e-03 |
| lag_freq(2).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(2).b        | 2.999378e+00 | +6.220000e-04 | -1.999378e+00 |
| lag_freq(2).t_max    | 2.462311e+02 | +5.537689e+02 | -1.962311e+02 |
| lag_freq(2).t_shift  | 4.822261e+01 | +6.424450e+01 | -1.551914e+01 |
| lag_freq(3).norm     | 4.281726e-01 | +3.398767e-01 | -1.810210e-01 |
| lag_freq(3).h2       | 6.337858e+00 | +3.084697e+00 | -2.165820e+00 |
| lag_freq(3).Gamma1   | 2.988228e+00 | +1.551512e-01 | -8.620758e-01 |
| lag_freq(3).Gamma2   | 1.403005e+00 | +8.662951e-01 | -3.005000e-03 |
| lag_freq(3).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(3).b        | 2.999371e+00 | +6.290000e-04 | -1.343447e+00 |
| lag_freq(3).t_max    | 2.462311e+02 | +5.537689e+02 | -9.291288e+01 |
| lag_freq(3).t_shift  | 1.000467e+01 | +5.699952e+00 | -4.670000e-03 |
| lag_freq(4).norm     | 2.140863e-01 | +3.059605e-01 | -2.140863e-01 |
| lag_freq(4).h2       | 4.668929e+00 | +1.159375e+01 | -1.668929e+00 |
| lag_freq(4).Gamma1   | 2.988228e+00 | +3.107720e-01 | -1.188228e+00 |
| lag_freq(4).Gamma2   | 1.403005e+00 | +1.796995e+00 | -3.005000e-03 |
| lag_freq(4).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(4).b        | 2.999371e+00 | +6.290000e-04 | -1.999371e+00 |
| lag_freq(4).t_max    | 2.462311e+02 | +5.537689e+02 | -1.189929e+02 |
| lag_freq(4).t_shift  | 1.000467e+01 | +1.144691e+02 | -4.670000e-03 |
| lag_freq(5).norm     | 5.904434e-01 | +1.370330e-01 | -2.708910e-01 |
| lag_freq(5).h2       | 5.503394e+00 | +1.191492e+00 | -1.468332e+00 |
| lag_freq(5).Gamma1   | 3.089056e+00 | +5.708275e-02 | -5.647091e-01 |
| lag_freq(5).Gamma2   | 1.570542e+00 | +2.783148e-01 | -1.705420e-01 |
| lag_freq(5).xi       | 9.694770e-01 | +1.921801e+00 | -9.694770e-01 |
| lag_freq(5).b        | 2.999990e+00 | +1.000000e-05 | -4.585423e-01 |
| lag_freq(5).t_max    | 9.905777e+01 | +4.175908e+01 | -2.260338e+01 |
| lag_freq(5).t_shift  | 1.000055e+01 | +4.524717e+00 | -5.500000e-04 |
| lag_freq(6).norm     | 2.581938e-01 | +2.916862e-01 | -1.826550e-01 |
| lag_freq(6).h2       | 1.527182e+01 | +4.728181e+00 | -3.822611e+00 |
| lag_freq(6).Gamma1   | 1.800315e+00 | +1.355338e+00 | -3.147109e-04 |
| lag_freq(6).Gamma2   | 1.480941e+00 | +4.761093e-01 | -8.094083e-02 |
| lag_freq(6).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(6).b        | 2.999990e+00 | +1.000000e-05 | -8.246669e-01 |
| lag_freq(6).t_max    | 9.905777e+01 | +9.406586e+01 | -3.732121e+01 |
| lag_freq(6).t_shift  | 1.000055e+01 | +2.286041e+01 | -5.500000e-04 |

** 7 data sets

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/IRAS13224-3809/mass-fit-7data.sl=

gedit =conf_mass_fit_7data.csv=

| lag_freq(1).norm     | 1.950143e-01 | +4.609884e-01 | -1.950143e-01 |
| lag_freq(1).log_mass | 7.789282e+00 | +1.589567e-02 | -1.823049e-02 |
| lag_freq(1).h2       | 5.118129e+00 | +1.488187e+01 | -2.118129e+00 |
| lag_freq(1).Gamma1   | 2.677456e+00 | +6.215440e-01 | -8.439610e-01 |
| lag_freq(1).Gamma2   | 2.169216e+00 | +1.030784e+00 | -7.692160e-01 |
| lag_freq(1).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(1).b        | 2.999981e+00 | +1.900000e-05 | -1.999981e+00 |
| lag_freq(1).t_max    | 2.707563e+02 | +5.292437e+02 | -2.207563e+02 |
| lag_freq(1).t_shift  | 1.001244e+01 | +1.399876e+02 | -1.244000e-02 |
| lag_freq(2).norm     | 2.358049e-01 | +1.856710e-01 | -1.480740e-01 |
| lag_freq(2).h2       | 1.999644e+01 | +3.560000e-03 | -1.017660e+01 |
| lag_freq(2).Gamma1   | 2.097057e+00 | +1.071975e+00 | -2.970570e-01 |
| lag_freq(2).Gamma2   | 1.403005e+00 | +8.388936e-01 | -3.005000e-03 |
| lag_freq(2).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(2).b        | 2.999378e+00 | +6.220000e-04 | -1.999378e+00 |
| lag_freq(2).t_max    | 2.462311e+02 | +5.537689e+02 | -1.962311e+02 |
| lag_freq(2).t_shift  | 4.822261e+01 | +6.424450e+01 | -1.551914e+01 |
| lag_freq(3).norm     | 4.281726e-01 | +3.398767e-01 | -1.810210e-01 |
| lag_freq(3).h2       | 6.337858e+00 | +3.084697e+00 | -2.165820e+00 |
| lag_freq(3).Gamma1   | 2.988228e+00 | +1.551512e-01 | -8.620758e-01 |
| lag_freq(3).Gamma2   | 1.403005e+00 | +8.662951e-01 | -3.005000e-03 |
| lag_freq(3).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(3).b        | 2.999371e+00 | +6.290000e-04 | -1.343447e+00 |
| lag_freq(3).t_max    | 2.462311e+02 | +5.537689e+02 | -9.291288e+01 |
| lag_freq(3).t_shift  | 1.000467e+01 | +5.699952e+00 | -4.670000e-03 |
| lag_freq(4).norm     | 2.140863e-01 | +3.059605e-01 | -2.140863e-01 |
| lag_freq(4).h2       | 4.668929e+00 | +1.159375e+01 | -1.668929e+00 |
| lag_freq(4).Gamma1   | 2.988228e+00 | +3.107720e-01 | -1.188228e+00 |
| lag_freq(4).Gamma2   | 1.403005e+00 | +1.796995e+00 | -3.005000e-03 |
| lag_freq(4).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(4).b        | 2.999371e+00 | +6.290000e-04 | -1.999371e+00 |
| lag_freq(4).t_max    | 2.462311e+02 | +5.537689e+02 | -1.189929e+02 |
| lag_freq(4).t_shift  | 1.000467e+01 | +1.144691e+02 | -4.670000e-03 |
| lag_freq(5).norm     | 5.904434e-01 | +1.370330e-01 | -2.708910e-01 |
| lag_freq(5).h2       | 5.503394e+00 | +1.191492e+00 | -1.468332e+00 |
| lag_freq(5).Gamma1   | 3.089056e+00 | +5.708275e-02 | -5.647091e-01 |
| lag_freq(5).Gamma2   | 1.570542e+00 | +2.783148e-01 | -1.705420e-01 |
| lag_freq(5).xi       | 9.694770e-01 | +1.921801e+00 | -9.694770e-01 |
| lag_freq(5).b        | 2.999990e+00 | +1.000000e-05 | -4.585423e-01 |
| lag_freq(5).t_max    | 9.905777e+01 | +4.175908e+01 | -2.260338e+01 |
| lag_freq(5).t_shift  | 1.000055e+01 | +4.524717e+00 | -5.500000e-04 |
| lag_freq(6).norm     | 2.581938e-01 | +2.916862e-01 | -1.826551e-01 |
| lag_freq(6).h2       | 1.527182e+01 | +4.728180e+00 | -3.822612e+00 |
| lag_freq(6).Gamma1   | 1.800315e+00 | +1.355338e+00 | -3.150000e-04 |
| lag_freq(6).Gamma2   | 1.480941e+00 | +4.761094e-01 | -8.094100e-02 |
| lag_freq(6).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(6).b        | 2.999990e+00 | +1.000000e-05 | -8.246668e-01 |
| lag_freq(6).t_max    | 9.905777e+01 | +9.406585e+01 | -3.732121e+01 |
| lag_freq(6).t_shift  | 1.000055e+01 | +2.286040e+01 | -5.500000e-04 |
| lag_freq(7).norm     | 1.157238e+00 | +3.612924e-01 | -2.657274e-01 |
| lag_freq(7).h2       | 1.433818e+01 | +5.568612e+00 | -1.771459e+00 |
| lag_freq(7).Gamma1   | 3.102168e+00 | +2.246068e-02 | -9.524224e-01 |
| lag_freq(7).Gamma2   | 1.400316e+00 | +8.684513e-01 | -3.161758e-04 |
| lag_freq(7).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(7).b        | 2.999512e+00 | +4.882757e-04 | -1.259391e+00 |
| lag_freq(7).t_max    | 7.996982e+02 | +3.018071e-01 | -4.484334e+02 |
| lag_freq(7).t_shift  | 1.207394e+02 | +2.533872e+00 | -2.412116e+01 |

** 8 data sets

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/IRAS13224-3809/mass-fit-8data.sl=

gedit =conf_mass_fit_8data.csv=

| lag_freq(1).norm     | 1.950143e-01 | +5.151155e-01 | -1.950143e-01 |
| lag_freq(1).log_mass | 7.808351e+00 | +4.344107e-03 | -1.260054e-02 |
| lag_freq(1).h2       | 5.118129e+00 | +1.488187e+01 | -2.118129e+00 |
| lag_freq(1).Gamma1   | 2.677456e+00 | +6.215440e-01 | -8.774560e-01 |
| lag_freq(1).Gamma2   | 2.169216e+00 | +1.030784e+00 | -7.692160e-01 |
| lag_freq(1).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(1).b        | 2.999981e+00 | +1.900000e-05 | -1.999981e+00 |
| lag_freq(1).t_max    | 2.707563e+02 | +5.292437e+02 | -2.207563e+02 |
| lag_freq(1).t_shift  | 1.001244e+01 | +1.399876e+02 | -1.244000e-02 |
| lag_freq(2).norm     | 2.358049e-01 | +2.122862e-01 | -1.398070e-01 |
| lag_freq(2).h2       | 1.999644e+01 | +3.560000e-03 | -1.071785e+01 |
| lag_freq(2).Gamma1   | 2.995086e+00 | +1.652956e-01 | -1.086908e+00 |
| lag_freq(2).Gamma2   | 1.403005e+00 | +1.384824e+00 | -3.005000e-03 |
| lag_freq(2).xi       | 2.998569e+00 | +1.430766e-03 | -2.998569e+00 |
| lag_freq(2).b        | 2.999378e+00 | +6.220000e-04 | -1.999378e+00 |
| lag_freq(2).t_max    | 1.481155e+02 | +6.518845e+02 | -9.811555e+01 |
| lag_freq(2).t_shift  | 4.822261e+01 | +7.214102e+00 | -1.364444e+01 |
| lag_freq(3).norm     | 4.281726e-01 | +4.260588e-01 | -1.776308e-01 |
| lag_freq(3).h2       | 6.337858e+00 | +2.270321e+00 | -2.774394e+00 |
| lag_freq(3).Gamma1   | 2.988228e+00 | +1.543811e-01 | -8.391726e-01 |
| lag_freq(3).Gamma2   | 1.643405e+00 | +8.268310e-01 | -2.434050e-01 |
| lag_freq(3).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(3).b        | 2.999371e+00 | +6.290000e-04 | -1.509855e+00 |
| lag_freq(3).t_max    | 2.462311e+02 | +5.537689e+02 | -8.454851e+01 |
| lag_freq(3).t_shift  | 1.000467e+01 | +5.483929e+00 | -4.670000e-03 |
| lag_freq(4).norm     | 4.159169e+00 | +1.530891e+00 | -8.788757e-01 |
| lag_freq(4).h2       | 9.281084e+00 | +1.310285e+00 | -6.315008e-01 |
| lag_freq(4).Gamma1   | 2.188677e+00 | +6.282213e-02 | -1.697279e-01 |
| lag_freq(4).Gamma2   | 2.834949e+00 | +1.853618e-01 | -7.317349e-02 |
| lag_freq(4).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(4).b        | 2.999921e+00 | +7.862500e-05 | -2.182555e-01 |
| lag_freq(4).t_max    | 1.684038e+02 | +5.257702e+00 | -9.014998e+00 |
| lag_freq(4).t_shift  | 1.694443e+01 | +8.033739e-01 | -5.298584e-01 |
| lag_freq(5).norm     | 5.904434e-01 | +1.676049e-01 | -2.550050e-01 |
| lag_freq(5).h2       | 5.503394e+00 | +1.083035e+00 | -1.533007e+00 |
| lag_freq(5).Gamma1   | 2.940138e+00 | +2.059814e-01 | -6.327363e-01 |
| lag_freq(5).Gamma2   | 1.570542e+00 | +5.655292e-01 | -1.705420e-01 |
| lag_freq(5).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(5).b        | 2.999990e+00 | +1.000000e-05 | -7.139143e-01 |
| lag_freq(5).t_max    | 9.905777e+01 | +6.798159e+01 | -3.021724e+01 |
| lag_freq(5).t_shift  | 1.000055e+01 | +3.400337e+00 | -5.500000e-04 |
| lag_freq(6).norm     | 2.581938e-01 | +3.459173e-01 | -1.875697e-01 |
| lag_freq(6).h2       | 1.527182e+01 | +4.728180e+00 | -3.498128e+00 |
| lag_freq(6).Gamma1   | 1.800315e+00 | +1.349122e+00 | -3.150000e-04 |
| lag_freq(6).Gamma2   | 1.480941e+00 | +5.192471e-01 | -8.094100e-02 |
| lag_freq(6).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(6).b        | 2.999990e+00 | +1.000000e-05 | -7.906050e-01 |
| lag_freq(6).t_max    | 9.905777e+01 | +9.191659e+01 | -3.638981e+01 |
| lag_freq(6).t_shift  | 1.000055e+01 | +5.648342e+00 | -5.500000e-04 |
| lag_freq(7).norm     | 1.500817e+00 | +6.362851e-01 | -2.772856e-01 |
| lag_freq(7).h2       | 1.433818e+01 | +3.074387e+00 | -1.995917e+00 |
| lag_freq(7).Gamma1   | 3.102168e+00 | +1.808117e-02 | -1.119539e+00 |
| lag_freq(7).Gamma2   | 1.400316e+00 | +1.086264e+00 | -3.160000e-04 |
| lag_freq(7).xi       | 2.908431e+00 | +9.156900e-02 | -2.908431e+00 |
| lag_freq(7).b        | 2.999512e+00 | +4.880000e-04 | -9.675682e-01 |
| lag_freq(7).t_max    | 7.996982e+02 | +3.018000e-01 | -5.405526e+02 |
| lag_freq(7).t_shift  | 1.207394e+02 | +2.227356e+00 | -4.872117e+00 |
| lag_freq(8).norm     | 1.772895e+00 | +2.103352e+00 | -7.327137e-01 |
| lag_freq(8).h2       | 1.999983e+01 | +1.727850e-04 | -7.119550e-01 |
| lag_freq(8).Gamma1   | 3.102168e+00 | +4.042949e-02 | -9.787341e-01 |
| lag_freq(8).Gamma2   | 1.400316e+00 | +9.227212e-01 | -3.160000e-04 |
| lag_freq(8).xi       | 2.908431e+00 | +9.156900e-02 | -2.908431e+00 |
| lag_freq(8).b        | 2.999878e+00 | +1.220000e-04 | -4.250392e-01 |
| lag_freq(8).t_max    | 4.248491e+02 | +2.101266e+02 | -1.329273e+02 |
| lag_freq(8).t_shift  | 1.207394e+02 | +1.693850e+00 | -4.936586e+00 |

** 9 data sets

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/IRAS13224-3809/mass-fit-9data.sl=

gedit =conf_mass_fit_8data.csv=

| lag_freq(1).norm     | 1.950143e-01 | +4.808130e-01 | -1.950143e-01 |
| lag_freq(1).log_mass | 7.798961e+00 | +6.678664e-03 | -4.355829e-03 |
| lag_freq(1).h2       | 5.118129e+00 | +1.488187e+01 | -2.118129e+00 |
| lag_freq(1).Gamma1   | 2.677456e+00 | +6.215440e-01 | -8.667192e-01 |
| lag_freq(1).Gamma2   | 2.169216e+00 | +1.030784e+00 | -7.692160e-01 |
| lag_freq(1).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(1).b        | 2.999981e+00 | +1.900000e-05 | -1.999981e+00 |
| lag_freq(1).t_max    | 2.707563e+02 | +5.292437e+02 | -2.207563e+02 |
| lag_freq(1).t_shift  | 1.001244e+01 | +1.399876e+02 | -1.244000e-02 |
| lag_freq(2).norm     | 2.358049e-01 | +1.678219e-01 | -1.514265e-01 |
| lag_freq(2).h2       | 1.999644e+01 | +3.560000e-03 | -1.059115e+01 |
| lag_freq(2).Gamma1   | 2.995086e+00 | +1.700685e-01 | -1.192752e+00 |
| lag_freq(2).Gamma2   | 1.403005e+00 | +1.496690e+00 | -3.005000e-03 |
| lag_freq(2).xi       | 2.998569e+00 | +1.431000e-03 | -2.998569e+00 |
| lag_freq(2).b        | 2.999378e+00 | +6.220000e-04 | -1.999378e+00 |
| lag_freq(2).t_max    | 1.481155e+02 | +6.518845e+02 | -9.811550e+01 |
| lag_freq(2).t_shift  | 4.822261e+01 | +8.444882e+00 | -1.335395e+01 |
| lag_freq(3).norm     | 4.281726e-01 | +3.757168e-01 | -1.771155e-01 |
| lag_freq(3).h2       | 6.337858e+00 | +2.500603e+00 | -2.336189e+00 |
| lag_freq(3).Gamma1   | 2.988228e+00 | +1.541340e-01 | -9.078925e-01 |
| lag_freq(3).Gamma2   | 1.460851e+00 | +9.075643e-01 | -6.085125e-02 |
| lag_freq(3).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(3).b        | 2.999371e+00 | +6.290000e-04 | -1.409597e+00 |
| lag_freq(3).t_max    | 2.462311e+02 | +5.537689e+02 | -8.920770e+01 |
| lag_freq(3).t_shift  | 1.000467e+01 | +5.330527e+00 | -4.670000e-03 |
| lag_freq(4).norm     | 4.159169e+00 | +1.984463e+00 | -7.917739e-01 |
| lag_freq(4).h2       | 9.281084e+00 | +1.147387e+00 | -5.919702e-01 |
| lag_freq(4).Gamma1   | 2.188677e+00 | +6.252924e-02 | -1.215991e-01 |
| lag_freq(4).Gamma2   | 2.834949e+00 | +1.802978e-01 | -6.949635e-02 |
| lag_freq(4).xi       | 2.423692e-01 | +2.757631e+00 | -2.423692e-01 |
| lag_freq(4).b        | 2.999921e+00 | +7.900000e-05 | -1.687801e-01 |
| lag_freq(4).t_max    | 1.684038e+02 | +7.484328e+00 | -6.343656e+00 |
| lag_freq(4).t_shift  | 1.694443e+01 | +1.124430e+00 | -3.983674e-01 |
| lag_freq(5).norm     | 5.904434e-01 | +1.767250e-01 | -2.420316e-01 |
| lag_freq(5).h2       | 5.503394e+00 | +1.258872e+00 | -1.369840e+00 |
| lag_freq(5).Gamma1   | 2.940138e+00 | +2.044945e-01 | -5.184625e-01 |
| lag_freq(5).Gamma2   | 1.570542e+00 | +3.634072e-01 | -1.705420e-01 |
| lag_freq(5).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(5).b        | 2.999990e+00 | +1.000000e-05 | -5.460550e-01 |
| lag_freq(5).t_max    | 9.905777e+01 | +5.138653e+01 | -2.420285e+01 |
| lag_freq(5).t_shift  | 1.000055e+01 | +3.542840e+00 | -5.500000e-04 |
| lag_freq(6).norm     | 2.581938e-01 | +3.178806e-01 | -1.867869e-01 |
| lag_freq(6).h2       | 1.527182e+01 | +4.728180e+00 | -3.703626e+00 |
| lag_freq(6).Gamma1   | 1.800315e+00 | +1.353600e+00 | -3.150000e-04 |
| lag_freq(6).Gamma2   | 1.480941e+00 | +5.078122e-01 | -8.094100e-02 |
| lag_freq(6).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(6).b        | 2.999990e+00 | +1.000000e-05 | -8.162663e-01 |
| lag_freq(6).t_max    | 9.905777e+01 | +9.387698e+01 | -3.743532e+01 |
| lag_freq(6).t_shift  | 1.000055e+01 | +5.720797e+00 | -5.500000e-04 |
| lag_freq(7).norm     | 1.500817e+00 | +3.893841e-01 | -3.669197e-01 |
| lag_freq(7).h2       | 1.433818e+01 | +5.485186e+00 | -1.857180e+00 |
| lag_freq(7).Gamma1   | 3.102168e+00 | +2.391170e-02 | -7.777748e-01 |
| lag_freq(7).Gamma2   | 1.400316e+00 | +1.117299e+00 | -3.160000e-04 |
| lag_freq(7).xi       | 2.999285e+00 | +7.153828e-04 | -2.999285e+00 |
| lag_freq(7).b        | 2.999985e+00 | +1.525000e-05 | -8.611695e-01 |
| lag_freq(7).t_max    | 7.996982e+02 | +3.018000e-01 | -5.828901e+02 |
| lag_freq(7).t_shift  | 1.207394e+02 | +2.074547e+00 | -3.970624e+00 |
| lag_freq(8).norm     | 3.086599e+00 | +1.606661e+00 | -1.386581e+00 |
| lag_freq(8).h2       | 1.999983e+01 | +1.700000e-04 | -4.092328e-01 |
| lag_freq(8).Gamma1   | 2.451084e+00 | +6.961870e-01 | -3.458101e-01 |
| lag_freq(8).Gamma2   | 1.400316e+00 | +4.377873e-01 | -3.160000e-04 |
| lag_freq(8).xi       | 2.999821e+00 | +1.788457e-04 | -8.733289e-01 |
| lag_freq(8).b        | 2.999878e+00 | +1.220000e-04 | -2.558540e-01 |
| lag_freq(8).t_max    | 3.743867e+02 | +9.203486e+01 | -6.740840e+01 |
| lag_freq(8).t_shift  | 1.207394e+02 | +1.881427e+00 | -3.570329e+00 |
| lag_freq(9).norm     | 1.772895e+00 | +7.007982e-01 | -6.374391e-01 |
| lag_freq(9).h2       | 9.566044e+00 | +1.391810e+00 | -8.128267e-01 |
| lag_freq(9).Gamma1   | 3.087021e+00 | +4.896315e-02 | -4.728772e-01 |
| lag_freq(9).Gamma2   | 1.400039e+00 | +3.820653e-01 | -3.950000e-05 |
| lag_freq(9).xi       | 2.999821e+00 | +1.788457e-04 | -5.435423e-01 |
| lag_freq(9).b        | 2.999939e+00 | +6.103888e-05 | -6.996623e-01 |
| lag_freq(9).t_max    | 2.037467e+02 | +5.695423e+01 | -3.746544e+00 |
| lag_freq(9).t_shift  | 1.021850e+02 | +1.407842e+00 | -5.309288e+00 |

** 10 data sets

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/IRAS13224-3809/mass-fit-10data.sl=

gedit =conf_mass_fit_10data.csv=

[detached from 93522.pts-7.hm00]

** 11 data sets

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/IRAS13224-3809/mass-fit-11data.sl=

gedit =conf_mass_fit_11data.csv=

[detached from 119818.pts-7.hm00]

| lag_freq(1).norm     | 7.313036e-02 | +1.622278e-01 | -7.313036e-02 |
| lag_freq(1).log_mass | 6.289299e+00 | +1.017946e-02 | -1.068521e-02 |
| lag_freq(1).h2       | 9.354387e+00 | +1.064561e+01 | -6.354387e+00 |
| lag_freq(1).Gamma1   | 2.988228e+00 | +3.107720e-01 | -1.188228e+00 |
| lag_freq(1).Gamma2   | 1.406009e+00 | +1.793991e+00 | -6.009500e-03 |
| lag_freq(1).xi       | 2.997138e+00 | +2.861531e-03 | -2.997138e+00 |
| lag_freq(1).b        | 2.999641e+00 | +3.585874e-04 | -1.999641e+00 |
| lag_freq(1).t_max    | 1.906654e+02 | +6.093346e+02 | -1.406654e+02 |
| lag_freq(1).t_shift  | 4.500933e+01 | +4.498391e+01 | -3.500933e+01 |
| lag_freq(2).norm     | 3.598097e-06 | +9.084724e-02 | -3.598097e-06 |
| lag_freq(2).h2       | 1.999644e+01 | +3.560000e-03 | -1.699644e+01 |
| lag_freq(2).Gamma1   | 2.995086e+00 | +3.039140e-01 | -1.195086e+00 |
| lag_freq(2).Gamma2   | 1.403005e+00 | +1.796995e+00 | -3.005000e-03 |
| lag_freq(2).xi       | 2.998569e+00 | +1.431000e-03 | -2.998569e+00 |
| lag_freq(2).b        | 2.999378e+00 | +6.220000e-04 | -1.999378e+00 |
| lag_freq(2).t_max    | 1.481155e+02 | +6.518845e+02 | -9.811550e+01 |
| lag_freq(2).t_shift  | 4.822261e+01 | +4.177798e+01 | -3.822261e+01 |
| lag_freq(3).norm     | 1.242174e+00 | +5.638126e-01 | -4.686373e-01 |
| lag_freq(3).h2       | 6.106437e+00 | +8.604554e-01 | -5.842686e-01 |
| lag_freq(3).Gamma1   | 2.988228e+00 | +1.518424e-01 | -4.851002e-01 |
| lag_freq(3).Gamma2   | 1.400238e+00 | +3.159891e-01 | -2.377002e-04 |
| lag_freq(3).xi       | 2.999821e+00 | +1.788457e-04 | -2.999821e+00 |
| lag_freq(3).b        | 1.999686e+00 | +8.388346e-01 | -2.987081e-01 |
| lag_freq(3).t_max    | 6.084534e+02 | +1.568476e+02 | -2.550534e+02 |
| lag_freq(3).t_shift  | 1.000029e+01 | +1.525732e+00 | -2.918750e-04 |
| lag_freq(4).norm     | 5.198961e-01 | +2.522084e-01 | -1.510493e-01 |
| lag_freq(4).h2       | 1.464054e+01 | +5.359458e+00 | -5.507182e+00 |
| lag_freq(4).Gamma1   | 1.800047e+00 | +6.250065e-01 | -4.744592e-05 |
| lag_freq(4).Gamma2   | 3.006783e+00 | +2.708313e-02 | -7.158253e-01 |
| lag_freq(4).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(4).b        | 2.999921e+00 | +7.900000e-05 | -6.806815e-01 |
| lag_freq(4).t_max    | 1.092019e+02 | +6.324825e+01 | -2.382419e+01 |
| lag_freq(4).t_shift  | 1.694443e+01 | +5.056476e+00 | -3.896046e+00 |
| lag_freq(5).norm     | 3.483333e-01 | +1.229165e-01 | -1.024068e-01 |
| lag_freq(5).h2       | 1.999965e+01 | +3.463434e-04 | -3.407718e+00 |
| lag_freq(5).Gamma1   | 1.952190e+00 | +2.104154e-01 | -1.521901e-01 |
| lag_freq(5).Gamma2   | 2.996969e+00 | +3.260322e-02 | -1.938337e-01 |
| lag_freq(5).xi       | 1.514808e-02 | +2.984852e+00 | -1.514808e-02 |
| lag_freq(5).b        | 1.000061e+00 | +6.678074e-01 | -6.103485e-05 |
| lag_freq(5).t_max    | 3.788791e+02 | +3.067533e+02 | -2.158682e+02 |
| lag_freq(5).t_shift  | 1.000055e+01 | +1.583479e+00 | -5.500000e-04 |
| lag_freq(6).norm     | 7.879449e-06 | +9.635453e-02 | -7.879449e-06 |
| lag_freq(6).h2       | 1.527182e+01 | +4.728180e+00 | -1.227182e+01 |
| lag_freq(6).Gamma1   | 1.800315e+00 | +1.498685e+00 | -3.150000e-04 |
| lag_freq(6).Gamma2   | 1.480941e+00 | +1.719059e+00 | -8.094100e-02 |
| lag_freq(6).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(6).b        | 2.999990e+00 | +1.000000e-05 | -1.999990e+00 |
| lag_freq(6).t_max    | 9.905777e+01 | +7.009422e+02 | -4.905777e+01 |
| lag_freq(6).t_shift  | 1.000055e+01 | +7.999932e+01 | -5.500000e-04 |
| lag_freq(7).norm     | 5.980552e-01 | +1.869898e-01 | -1.511897e-01 |
| lag_freq(7).h2       | 8.669090e+00 | +8.122149e-01 | -1.487134e+00 |
| lag_freq(7).Gamma1   | 3.102168e+00 | +2.473033e-02 | -4.922023e-01 |
| lag_freq(7).Gamma2   | 1.400020e+00 | +5.581860e-01 | -1.975000e-05 |
| lag_freq(7).xi       | 2.999633e+00 | +3.669096e-04 | -1.247218e+00 |
| lag_freq(7).b        | 1.499878e+00 | +6.958247e-01 | -4.998780e-01 |
| lag_freq(7).t_max    | 7.999906e+02 | +9.431250e-03 | -2.098188e+02 |
| lag_freq(7).t_shift  | 5.829445e+01 | +7.217426e+00 | -2.585201e+01 |
| lag_freq(8).norm     | 8.238248e-01 | +3.647705e-01 | -2.642581e-01 |
| lag_freq(8).h2       | 1.070688e+01 | +8.721019e-01 | -2.278003e+00 |
| lag_freq(8).Gamma1   | 1.800020e+00 | +9.728389e-02 | -1.986951e-05 |
| lag_freq(8).Gamma2   | 1.885438e+00 | +1.526079e-01 | -8.426099e-02 |
| lag_freq(8).xi       | 2.227108e+00 | +6.389598e-01 | -2.227108e+00 |
| lag_freq(8).b        | 2.999878e+00 | +1.220000e-04 | -5.537893e-01 |
| lag_freq(8).t_max    | 2.771239e+02 | +1.584313e+02 | -7.710345e+01 |
| lag_freq(8).t_shift  | 9.889029e+01 | +1.146544e+01 | -1.486469e+01 |
| lag_freq(9).norm     | 2.787311e-01 | +1.790461e-01 | -8.636099e-02 |
| lag_freq(9).h2       | 5.124979e+00 | +2.121095e+00 | -2.124979e+00 |
| lag_freq(9).Gamma1   | 3.102168e+00 | +3.029390e-02 | -1.182813e+00 |
| lag_freq(9).Gamma2   | 1.400316e+00 | +1.410060e+00 | -3.160000e-04 |
| lag_freq(9).xi       | 7.271078e-01 | +2.272892e+00 | -7.271078e-01 |
| lag_freq(9).b        | 2.499969e+00 | +5.000305e-01 | -1.499969e+00 |
| lag_freq(9).t_max    | 7.928944e+02 | +7.105639e+00 | -4.261774e+02 |
| lag_freq(9).t_shift  | 1.207394e+02 | +2.926060e+01 | -8.913155e+01 |
| lag_freq(10).norm    | 6.826879e-01 | +2.021134e-01 | -1.575506e-01 |
| lag_freq(10).h2      | 7.249958e+00 | +1.559183e+00 | -3.354409e+00 |
| lag_freq(10).Gamma1  | 3.049943e+00 | +7.423157e-02 | -4.957941e-01 |
| lag_freq(10).Gamma2  | 2.975119e+00 | +4.750728e-02 | -2.823409e-01 |
| lag_freq(10).xi      | 7.499553e-01 | +2.250045e+00 | -7.499553e-01 |
| lag_freq(10).b       | 2.999878e+00 | +1.220000e-04 | -6.884406e-01 |
| lag_freq(10).t_max   | 2.000154e+02 | +8.089724e+01 | -1.559417e-02 |
| lag_freq(10).t_shift | 9.283210e+01 | +3.225925e+00 | -1.037763e+01 |
| lag_freq(11).norm    | 2.216119e-01 | +1.506356e-01 | -1.033145e-01 |
| lag_freq(11).h2      | 7.249958e+00 | +2.690952e+00 | -2.184685e+00 |
| lag_freq(11).Gamma1  | 3.102168e+00 | +4.560536e-02 | -1.004481e+00 |
| lag_freq(11).Gamma2  | 1.400316e+00 | +1.252386e+00 | -3.160000e-04 |
| lag_freq(11).xi      | 7.271078e-01 | +2.272892e+00 | -7.271078e-01 |
| lag_freq(11).b       | 2.499969e+00 | +5.000305e-01 | -1.499969e+00 |
| lag_freq(11).t_max   | 6.343149e+02 | +1.656851e+02 | -2.970153e+02 |
| lag_freq(11).t_shift | 1.207394e+02 | +2.926060e+01 | -2.982396e+01 |

** 12 data sets

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/IRAS13224-3809/mass-fit-12data.sl=

gedit =conf_mass_fit_12data.csv=

[detached from 119818.pts-7.hm00]

| lag_freq(1).norm     | 7.313036e-02 | +1.622278e-01 | -7.313036e-02 |
| lag_freq(1).log_mass | 6.289299e+00 | +1.208641e-02 | -6.698678e-03 |
| lag_freq(1).h2       | 9.354387e+00 | +1.064561e+01 | -6.354387e+00 |
| lag_freq(1).Gamma1   | 2.988228e+00 | +3.107720e-01 | -1.188228e+00 |
| lag_freq(1).Gamma2   | 1.406009e+00 | +1.793991e+00 | -6.009000e-03 |
| lag_freq(1).xi       | 2.997138e+00 | +2.862000e-03 | -2.997138e+00 |
| lag_freq(1).b        | 2.999641e+00 | +3.590000e-04 | -1.999641e+00 |
| lag_freq(1).t_max    | 1.906654e+02 | +6.093346e+02 | -1.406654e+02 |
| lag_freq(1).t_shift  | 4.500933e+01 | +4.498391e+01 | -3.500933e+01 |
| lag_freq(2).norm     | 3.598097e-06 | +9.084725e-02 | -3.598097e-06 |
| lag_freq(2).h2       | 1.999644e+01 | +3.560000e-03 | -1.699644e+01 |
| lag_freq(2).Gamma1   | 2.995086e+00 | +3.039140e-01 | -1.195086e+00 |
| lag_freq(2).Gamma2   | 1.403005e+00 | +1.796995e+00 | -3.005000e-03 |
| lag_freq(2).xi       | 2.998569e+00 | +1.431000e-03 | -2.998569e+00 |
| lag_freq(2).b        | 2.999378e+00 | +6.220000e-04 | -1.999378e+00 |
| lag_freq(2).t_max    | 1.481155e+02 | +6.518845e+02 | -9.811550e+01 |
| lag_freq(2).t_shift  | 4.822261e+01 | +4.177798e+01 | -3.822261e+01 |
| lag_freq(3).norm     | 1.242174e+00 | +5.638149e-01 | -4.686361e-01 |
| lag_freq(3).h2       | 6.106437e+00 | +8.604517e-01 | -5.842703e-01 |
| lag_freq(3).Gamma1   | 2.988228e+00 | +1.518424e-01 | -4.851001e-01 |
| lag_freq(3).Gamma2   | 1.400238e+00 | +3.159902e-01 | -2.380000e-04 |
| lag_freq(3).xi       | 2.999821e+00 | +1.790000e-04 | -2.999821e+00 |
| lag_freq(3).b        | 1.999686e+00 | +8.388317e-01 | -2.987092e-01 |
| lag_freq(3).t_max    | 6.084534e+02 | +1.568481e+02 | -2.550531e+02 |
| lag_freq(3).t_shift  | 1.000029e+01 | +1.525738e+00 | -2.900000e-04 |
| lag_freq(4).norm     | 5.198961e-01 | +2.522060e-01 | -1.510499e-01 |
| lag_freq(4).h2       | 1.464054e+01 | +5.359460e+00 | -5.507149e+00 |
| lag_freq(4).Gamma1   | 1.800047e+00 | +6.250087e-01 | -4.700000e-05 |
| lag_freq(4).Gamma2   | 3.006783e+00 | +2.708325e-02 | -7.158240e-01 |
| lag_freq(4).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(4).b        | 2.999921e+00 | +7.900000e-05 | -6.806762e-01 |
| lag_freq(4).t_max    | 1.092019e+02 | +6.324799e+01 | -2.382425e+01 |
| lag_freq(4).t_shift  | 1.694443e+01 | +5.056410e+00 | -3.896044e+00 |
| lag_freq(5).norm     | 3.483333e-01 | +1.229166e-01 | -1.024068e-01 |
| lag_freq(5).h2       | 1.999965e+01 | +3.500000e-04 | -3.407722e+00 |
| lag_freq(5).Gamma1   | 1.952190e+00 | +2.104151e-01 | -1.521900e-01 |
| lag_freq(5).Gamma2   | 2.996969e+00 | +3.260363e-02 | -1.938333e-01 |
| lag_freq(5).xi       | 1.514808e-02 | +2.984852e+00 | -1.514808e-02 |
| lag_freq(5).b        | 1.000061e+00 | +6.678083e-01 | -6.100000e-05 |
| lag_freq(5).t_max    | 3.788791e+02 | +3.067526e+02 | -2.158684e+02 |
| lag_freq(5).t_shift  | 1.000055e+01 | +1.583476e+00 | -5.500000e-04 |
| lag_freq(6).norm     | 7.879449e-06 | +9.635448e-02 | -7.879449e-06 |
| lag_freq(6).h2       | 1.527182e+01 | +4.728180e+00 | -1.227182e+01 |
| lag_freq(6).Gamma1   | 1.800315e+00 | +1.498685e+00 | -3.150000e-04 |
| lag_freq(6).Gamma2   | 1.480941e+00 | +1.719059e+00 | -8.094100e-02 |
| lag_freq(6).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(6).b        | 2.999990e+00 | +1.000000e-05 | -1.999990e+00 |
| lag_freq(6).t_max    | 9.905777e+01 | +7.009422e+02 | -4.905777e+01 |
| lag_freq(6).t_shift  | 1.000055e+01 | +7.999932e+01 | -5.500000e-04 |
| lag_freq(7).norm     | 5.980552e-01 | +1.869897e-01 | -1.511898e-01 |
| lag_freq(7).h2       | 8.669090e+00 | +8.122136e-01 | -1.487136e+00 |
| lag_freq(7).Gamma1   | 3.102168e+00 | +2.473036e-02 | -4.922021e-01 |
| lag_freq(7).Gamma2   | 1.400020e+00 | +5.581859e-01 | -2.000000e-05 |
| lag_freq(7).xi       | 2.999633e+00 | +3.670000e-04 | -1.247214e+00 |
| lag_freq(7).b        | 1.499878e+00 | +6.958249e-01 | -4.998780e-01 |
| lag_freq(7).t_max    | 7.999906e+02 | +9.400000e-03 | -2.098189e+02 |
| lag_freq(7).t_shift  | 5.829445e+01 | +7.217431e+00 | -2.585203e+01 |
| lag_freq(8).norm     | 8.238248e-01 | +3.647694e-01 | -2.642584e-01 |
| lag_freq(8).h2       | 1.070688e+01 | +8.720995e-01 | -2.277999e+00 |
| lag_freq(8).Gamma1   | 1.800020e+00 | +9.728384e-02 | -2.000000e-05 |
| lag_freq(8).Gamma2   | 1.885438e+00 | +1.526089e-01 | -8.426075e-02 |
| lag_freq(8).xi       | 2.227108e+00 | +6.389603e-01 | -2.227108e+00 |
| lag_freq(8).b        | 2.999878e+00 | +1.220000e-04 | -5.537897e-01 |
| lag_freq(8).t_max    | 2.771239e+02 | +1.584313e+02 | -7.710346e+01 |
| lag_freq(8).t_shift  | 9.889029e+01 | +1.146541e+01 | -1.486467e+01 |
| lag_freq(9).norm     | 2.787311e-01 | +1.790464e-01 | -8.636093e-02 |
| lag_freq(9).h2       | 5.124979e+00 | +2.121093e+00 | -2.124979e+00 |
| lag_freq(9).Gamma1   | 3.102168e+00 | +3.029386e-02 | -1.182813e+00 |
| lag_freq(9).Gamma2   | 1.400316e+00 | +1.410061e+00 | -3.160000e-04 |
| lag_freq(9).xi       | 7.271078e-01 | +2.272892e+00 | -7.271078e-01 |
| lag_freq(9).b        | 2.499969e+00 | +5.000310e-01 | -1.499969e+00 |
| lag_freq(9).t_max    | 7.928944e+02 | +7.105600e+00 | -4.261775e+02 |
| lag_freq(9).t_shift  | 1.207394e+02 | +2.926060e+01 | -8.913157e+01 |
| lag_freq(10).norm    | 6.826879e-01 | +2.021138e-01 | -1.575504e-01 |
| lag_freq(10).h2      | 7.249958e+00 | +1.559180e+00 | -3.354404e+00 |
| lag_freq(10).Gamma1  | 3.049943e+00 | +7.423175e-02 | -4.957929e-01 |
| lag_freq(10).Gamma2  | 2.975119e+00 | +4.750677e-02 | -2.823415e-01 |
| lag_freq(10).xi      | 7.499553e-01 | +2.250045e+00 | -7.499553e-01 |
| lag_freq(10).b       | 2.999878e+00 | +1.220000e-04 | -6.884415e-01 |
| lag_freq(10).t_max   | 2.000154e+02 | +8.089730e+01 | -1.559418e-02 |
| lag_freq(10).t_shift | 9.283210e+01 | +3.225916e+00 | -1.037762e+01 |
| lag_freq(11).norm    | 2.216119e-01 | +1.506356e-01 | -1.033145e-01 |
| lag_freq(11).h2      | 7.249958e+00 | +2.690949e+00 | -2.184686e+00 |
| lag_freq(11).Gamma1  | 3.102168e+00 | +4.560537e-02 | -1.004482e+00 |
| lag_freq(11).Gamma2  | 1.400316e+00 | +1.252387e+00 | -3.160000e-04 |
| lag_freq(11).xi      | 7.271078e-01 | +2.272892e+00 | -7.271078e-01 |
| lag_freq(11).b       | 2.499969e+00 | +5.000310e-01 | -1.499969e+00 |
| lag_freq(11).t_max   | 6.343149e+02 | +1.656851e+02 | -2.970152e+02 |
| lag_freq(11).t_shift | 1.207394e+02 | +2.926060e+01 | -2.982396e+01 |
| lag_freq(12).norm    | 4.962282e-01 | +1.288363e-01 | -1.629478e-01 |
| lag_freq(12).h2      | 8.975963e+00 | +2.159837e+00 | -8.342884e-01 |
| lag_freq(12).Gamma1  | 3.102168e+00 | +3.212498e-02 | -4.216724e-01 |
| lag_freq(12).Gamma2  | 1.400079e+00 | +4.871210e-01 | -7.900000e-05 |
| lag_freq(12).xi      | 2.999600e+00 | +3.997444e-04 | -9.875741e-01 |
| lag_freq(12).b       | 1.749985e+00 | +8.010216e-01 | -6.899924e-01 |
| lag_freq(12).t_max   | 7.999798e+02 | +2.022523e-02 | -1.355378e+02 |
| lag_freq(12).t_shift | 1.499964e+02 | +3.571851e-03 | -4.609822e+01 |

** 13 data sets

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/IRAS13224-3809/mass-fit-13data.sl=

gedit =conf_mass_fit_13data.csv=

[detached from 85510.pts-4.hm00]

| lag_freq(1).norm     | 7.313036e-02 | +1.660890e-01 | -7.313036e-02 |
| lag_freq(1).log_mass | 6.298605e+00 | +7.331963e-03 | -7.438612e-03 |
| lag_freq(1).h2       | 9.354387e+00 | +1.064561e+01 | -6.354387e+00 |
| lag_freq(1).Gamma1   | 2.988228e+00 | +3.107720e-01 | -1.188228e+00 |
| lag_freq(1).Gamma2   | 1.406009e+00 | +1.793991e+00 | -6.009000e-03 |
| lag_freq(1).xi       | 2.997138e+00 | +2.862000e-03 | -2.997138e+00 |
| lag_freq(1).b        | 2.999641e+00 | +3.590000e-04 | -1.999641e+00 |
| lag_freq(1).t_max    | 1.906654e+02 | +6.093346e+02 | -1.406654e+02 |
| lag_freq(1).t_shift  | 4.500933e+01 | +4.498391e+01 | -3.500933e+01 |
| lag_freq(2).norm     | 3.598097e-06 | +9.406807e-02 | -3.598097e-06 |
| lag_freq(2).h2       | 1.999644e+01 | +3.560000e-03 | -1.699644e+01 |
| lag_freq(2).Gamma1   | 2.995086e+00 | +3.039140e-01 | -1.195086e+00 |
| lag_freq(2).Gamma2   | 1.403005e+00 | +1.796995e+00 | -3.005000e-03 |
| lag_freq(2).xi       | 2.998569e+00 | +1.431000e-03 | -2.998569e+00 |
| lag_freq(2).b        | 2.999378e+00 | +6.220000e-04 | -1.999378e+00 |
| lag_freq(2).t_max    | 1.481155e+02 | +6.518845e+02 | -9.811550e+01 |
| lag_freq(2).t_shift  | 4.822261e+01 | +4.177798e+01 | -3.822261e+01 |
| lag_freq(3).norm     | 1.242174e+00 | +7.456772e-01 | -4.170009e-01 |
| lag_freq(3).h2       | 6.106437e+00 | +4.042510e-01 | -9.649412e-01 |
| lag_freq(3).Gamma1   | 2.988228e+00 | +1.493946e-01 | -5.115989e-01 |
| lag_freq(3).Gamma2   | 1.400238e+00 | +5.357634e-01 | -2.380000e-04 |
| lag_freq(3).xi       | 2.999821e+00 | +1.790000e-04 | -1.569069e+00 |
| lag_freq(3).b        | 1.999686e+00 | +4.610964e-01 | -4.897905e-01 |
| lag_freq(3).t_max    | 6.084534e+02 | +1.915466e+02 | -2.239500e+02 |
| lag_freq(3).t_shift  | 1.000029e+01 | +2.753170e+00 | -2.900000e-04 |
| lag_freq(4).norm     | 5.198961e-01 | +2.508474e-01 | -1.509012e-01 |
| lag_freq(4).h2       | 1.464054e+01 | +5.359460e+00 | -5.322336e+00 |
| lag_freq(4).Gamma1   | 1.800047e+00 | +6.082930e-01 | -4.700000e-05 |
| lag_freq(4).Gamma2   | 3.006783e+00 | +2.705670e-02 | -7.088542e-01 |
| lag_freq(4).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(4).b        | 2.999921e+00 | +7.900000e-05 | -6.074376e-01 |
| lag_freq(4).t_max    | 1.092019e+02 | +7.006708e+01 | -2.374034e+01 |
| lag_freq(4).t_shift  | 1.694443e+01 | +3.646081e+00 | -3.931674e+00 |
| lag_freq(5).norm     | 3.483333e-01 | +1.269884e-01 | -1.007428e-01 |
| lag_freq(5).h2       | 1.999965e+01 | +3.500000e-04 | -3.726941e+00 |
| lag_freq(5).Gamma1   | 1.952190e+00 | +1.901698e-01 | -1.521900e-01 |
| lag_freq(5).Gamma2   | 2.996969e+00 | +3.215239e-02 | -1.736501e-01 |
| lag_freq(5).xi       | 1.514808e-02 | +2.984852e+00 | -1.514808e-02 |
| lag_freq(5).b        | 1.000061e+00 | +7.025901e-01 | -6.100000e-05 |
| lag_freq(5).t_max    | 3.788791e+02 | +2.712640e+02 | -2.242171e+02 |
| lag_freq(5).t_shift  | 1.000055e+01 | +1.560955e+00 | -5.500000e-04 |
| lag_freq(6).norm     | 7.879449e-06 | +8.603569e-02 | -7.879449e-06 |
| lag_freq(6).h2       | 1.527182e+01 | +4.728180e+00 | -1.227182e+01 |
| lag_freq(6).Gamma1   | 1.800315e+00 | +1.498685e+00 | -3.150000e-04 |
| lag_freq(6).Gamma2   | 1.480941e+00 | +1.719059e+00 | -8.094100e-02 |
| lag_freq(6).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(6).b        | 2.999990e+00 | +1.000000e-05 | -1.999990e+00 |
| lag_freq(6).t_max    | 9.905777e+01 | +7.009422e+02 | -4.905777e+01 |
| lag_freq(6).t_shift  | 1.000055e+01 | +7.999932e+01 | -5.500000e-04 |
| lag_freq(7).norm     | 1.263360e+00 | +5.191479e-01 | -2.253314e-01 |
| lag_freq(7).h2       | 8.669090e+00 | +7.090535e-01 | -3.963025e-01 |
| lag_freq(7).Gamma1   | 3.102168e+00 | +1.745558e-02 | -3.897533e-01 |
| lag_freq(7).Gamma2   | 1.400020e+00 | +4.222930e-01 | -2.000000e-05 |
| lag_freq(7).xi       | 2.999633e+00 | +3.670000e-04 | -7.801707e-01 |
| lag_freq(7).b        | 1.499878e+00 | +5.411171e-01 | -2.410941e-01 |
| lag_freq(7).t_max    | 7.999906e+02 | +9.400000e-03 | -1.836127e+02 |
| lag_freq(7).t_shift  | 2.124549e+01 | +2.232997e+00 | -4.897210e+00 |
| lag_freq(8).norm     | 8.238248e-01 | +3.557227e-01 | -2.670405e-01 |
| lag_freq(8).h2       | 1.070688e+01 | +8.245187e-01 | -3.045470e+00 |
| lag_freq(8).Gamma1   | 1.800020e+00 | +1.041464e-01 | -2.000000e-05 |
| lag_freq(8).Gamma2   | 1.885438e+00 | +1.149263e-01 | -8.877449e-02 |
| lag_freq(8).xi       | 2.227108e+00 | +6.676418e-01 | -2.227108e+00 |
| lag_freq(8).b        | 2.999878e+00 | +1.220000e-04 | -5.874653e-01 |
| lag_freq(8).t_max    | 2.771239e+02 | +1.663770e+02 | -7.710346e+01 |
| lag_freq(8).t_shift  | 9.889029e+01 | +9.402201e+00 | -1.511694e+01 |
| lag_freq(9).norm     | 2.787311e-01 | +1.955045e-01 | -8.366776e-02 |
| lag_freq(9).h2       | 5.124979e+00 | +1.760498e+00 | -2.124979e+00 |
| lag_freq(9).Gamma1   | 3.102168e+00 | +2.936731e-02 | -1.228545e+00 |
| lag_freq(9).Gamma2   | 1.400316e+00 | +1.419247e+00 | -3.160000e-04 |
| lag_freq(9).xi       | 7.271078e-01 | +2.272892e+00 | -7.271078e-01 |
| lag_freq(9).b        | 2.499969e+00 | +5.000310e-01 | -1.499969e+00 |
| lag_freq(9).t_max    | 7.928944e+02 | +7.105600e+00 | -4.223507e+02 |
| lag_freq(9).t_shift  | 1.207394e+02 | +2.926060e+01 | -9.186256e+01 |
| lag_freq(10).norm    | 6.826879e-01 | +2.026438e-01 | -1.574494e-01 |
| lag_freq(10).h2      | 7.249958e+00 | +1.530739e+00 | -3.910658e+00 |
| lag_freq(10).Gamma1  | 3.049943e+00 | +7.446945e-02 | -4.616537e-01 |
| lag_freq(10).Gamma2  | 2.975119e+00 | +4.733202e-02 | -2.777967e-01 |
| lag_freq(10).xi      | 7.499553e-01 | +2.250045e+00 | -7.499553e-01 |
| lag_freq(10).b       | 2.999878e+00 | +1.220000e-04 | -5.049803e-01 |
| lag_freq(10).t_max   | 2.000154e+02 | +6.045339e+01 | -1.559418e-02 |
| lag_freq(10).t_shift | 9.148783e+01 | +2.971172e+00 | -7.944821e+00 |
| lag_freq(11).norm    | 2.216119e-01 | +1.677584e-01 | -9.980657e-02 |
| lag_freq(11).h2      | 7.249958e+00 | +2.351085e+00 | -2.486831e+00 |
| lag_freq(11).Gamma1  | 3.102168e+00 | +4.405576e-02 | -1.070265e+00 |
| lag_freq(11).Gamma2  | 1.400316e+00 | +1.271599e+00 | -3.160000e-04 |
| lag_freq(11).xi      | 7.271078e-01 | +2.272892e+00 | -7.271078e-01 |
| lag_freq(11).b       | 2.937496e+00 | +6.250387e-02 | -1.937496e+00 |
| lag_freq(11).t_max   | 7.171574e+02 | +8.284255e+01 | -3.530361e+02 |
| lag_freq(11).t_shift | 1.207394e+02 | +2.926060e+01 | -2.894733e+01 |
| lag_freq(12).norm    | 4.962282e-01 | +1.173669e-01 | -1.669624e-01 |
| lag_freq(12).h2      | 8.975963e+00 | +9.032290e-01 | -1.366216e+00 |
| lag_freq(12).Gamma1  | 3.102168e+00 | +3.292840e-02 | -3.867825e-01 |
| lag_freq(12).Gamma2  | 1.400079e+00 | +5.311112e-01 | -7.900000e-05 |
| lag_freq(12).xi      | 2.999600e+00 | +4.000000e-04 | -7.288685e-01 |
| lag_freq(12).b       | 1.749985e+00 | +9.920887e-01 | -6.395534e-01 |
| lag_freq(12).t_max   | 7.999798e+02 | +2.020000e-02 | -1.447793e+02 |
| lag_freq(12).t_shift | 1.499964e+02 | +3.600000e-03 | -4.496743e+01 |
| lag_freq(13).norm    | 2.481141e-01 | +1.058832e-01 | -8.021353e-02 |
| lag_freq(13).h2      | 5.987982e+00 | +2.638422e+00 | -2.987982e+00 |
| lag_freq(13).Gamma1  | 3.102168e+00 | +3.162500e-02 | -6.728691e-01 |
| lag_freq(13).Gamma2  | 1.400079e+00 | +7.423732e-01 | -7.900000e-05 |
| lag_freq(13).xi      | 2.999600e+00 | +4.000000e-04 | -2.999600e+00 |
| lag_freq(13).b       | 2.999652e+00 | +3.484150e-04 | -6.347469e-01 |
| lag_freq(13).t_max   | 5.003270e+02 | +9.263747e+01 | -3.374726e+01 |
| lag_freq(13).t_shift | 1.499964e+02 | +3.600000e-03 | -2.948465e+01 |

** 14 data sets

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/IRAS13224-3809/mass-fit-14data.sl=

gedit =conf_mass_fit_14data.csv=

[detached from 40101.pts-4.hm00]

| lag_freq(1).norm     | 7.313036e-02 | +1.660890e-01 | -7.313036e-02 |
| lag_freq(1).log_mass | 6.298605e+00 | +6.910428e-03 | -6.903715e-03 |
| lag_freq(1).h2       | 9.354387e+00 | +1.064561e+01 | -6.354387e+00 |
| lag_freq(1).Gamma1   | 2.988228e+00 | +3.107720e-01 | -1.188228e+00 |
| lag_freq(1).Gamma2   | 1.406009e+00 | +1.793991e+00 | -6.009000e-03 |
| lag_freq(1).xi       | 2.997138e+00 | +2.862000e-03 | -2.997138e+00 |
| lag_freq(1).b        | 2.999641e+00 | +3.590000e-04 | -1.999641e+00 |
| lag_freq(1).t_max    | 1.906654e+02 | +6.093346e+02 | -1.406654e+02 |
| lag_freq(1).t_shift  | 4.500933e+01 | +4.498391e+01 | -3.500933e+01 |
| lag_freq(2).norm     | 3.598097e-06 | +9.406814e-02 | -3.598097e-06 |
| lag_freq(2).h2       | 1.999644e+01 | +3.560000e-03 | -1.699644e+01 |
| lag_freq(2).Gamma1   | 2.995086e+00 | +3.039140e-01 | -1.195086e+00 |
| lag_freq(2).Gamma2   | 1.403005e+00 | +1.796995e+00 | -3.005000e-03 |
| lag_freq(2).xi       | 2.998569e+00 | +1.431000e-03 | -2.998569e+00 |
| lag_freq(2).b        | 2.999378e+00 | +6.220000e-04 | -1.999378e+00 |
| lag_freq(2).t_max    | 1.481155e+02 | +6.518845e+02 | -9.811550e+01 |
| lag_freq(2).t_shift  | 4.822261e+01 | +4.177798e+01 | -3.822261e+01 |
| lag_freq(3).norm     | 1.242174e+00 | +7.456776e-01 | -4.170013e-01 |
| lag_freq(3).h2       | 6.106437e+00 | +4.042463e-01 | -9.649492e-01 |
| lag_freq(3).Gamma1   | 2.988228e+00 | +1.493946e-01 | -5.115996e-01 |
| lag_freq(3).Gamma2   | 1.400238e+00 | +5.357671e-01 | -2.380000e-04 |
| lag_freq(3).xi       | 2.999821e+00 | +1.790000e-04 | -1.569060e+00 |
| lag_freq(3).b        | 1.999686e+00 | +4.610922e-01 | -4.897944e-01 |
| lag_freq(3).t_max    | 6.084534e+02 | +1.915466e+02 | -2.239495e+02 |
| lag_freq(3).t_shift  | 1.000029e+01 | +2.753194e+00 | -2.900000e-04 |
| lag_freq(4).norm     | 5.198961e-01 | +2.508474e-01 | -1.509013e-01 |
| lag_freq(4).h2       | 1.464054e+01 | +5.359460e+00 | -5.322333e+00 |
| lag_freq(4).Gamma1   | 1.800047e+00 | +6.082928e-01 | -4.700000e-05 |
| lag_freq(4).Gamma2   | 3.006783e+00 | +2.705670e-02 | -7.088540e-01 |
| lag_freq(4).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(4).b        | 2.999921e+00 | +7.900000e-05 | -6.074366e-01 |
| lag_freq(4).t_max    | 1.092019e+02 | +7.006718e+01 | -2.374033e+01 |
| lag_freq(4).t_shift  | 1.694443e+01 | +3.646070e+00 | -3.931675e+00 |
| lag_freq(5).norm     | 3.483333e-01 | +1.269885e-01 | -1.007428e-01 |
| lag_freq(5).h2       | 1.999965e+01 | +3.500000e-04 | -3.726945e+00 |
| lag_freq(5).Gamma1   | 1.952190e+00 | +1.901695e-01 | -1.521900e-01 |
| lag_freq(5).Gamma2   | 2.996969e+00 | +3.215238e-02 | -1.736498e-01 |
| lag_freq(5).xi       | 1.514808e-02 | +2.984852e+00 | -1.514808e-02 |
| lag_freq(5).b        | 1.000061e+00 | +7.025906e-01 | -6.100000e-05 |
| lag_freq(5).t_max    | 3.788791e+02 | +2.712635e+02 | -2.242172e+02 |
| lag_freq(5).t_shift  | 1.000055e+01 | +1.560955e+00 | -5.500000e-04 |
| lag_freq(6).norm     | 7.879449e-06 | +8.603554e-02 | -7.879449e-06 |
| lag_freq(6).h2       | 1.527182e+01 | +4.728180e+00 | -1.227182e+01 |
| lag_freq(6).Gamma1   | 1.800315e+00 | +1.498685e+00 | -3.150000e-04 |
| lag_freq(6).Gamma2   | 1.480941e+00 | +1.719059e+00 | -8.094100e-02 |
| lag_freq(6).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(6).b        | 2.999990e+00 | +1.000000e-05 | -1.999990e+00 |
| lag_freq(6).t_max    | 9.905777e+01 | +7.009422e+02 | -4.905777e+01 |
| lag_freq(6).t_shift  | 1.000055e+01 | +7.999932e+01 | -5.500000e-04 |
| lag_freq(7).norm     | 1.263360e+00 | +5.191486e-01 | -2.253311e-01 |
| lag_freq(7).h2       | 8.669090e+00 | +7.090474e-01 | -3.963068e-01 |
| lag_freq(7).Gamma1   | 3.102168e+00 | +1.745571e-02 | -3.897519e-01 |
| lag_freq(7).Gamma2   | 1.400020e+00 | +4.222916e-01 | -2.000000e-05 |
| lag_freq(7).xi       | 2.999633e+00 | +3.670000e-04 | -7.801658e-01 |
| lag_freq(7).b        | 1.499878e+00 | +5.411192e-01 | -2.410932e-01 |
| lag_freq(7).t_max    | 7.999906e+02 | +9.400000e-03 | -1.836134e+02 |
| lag_freq(7).t_shift  | 2.124549e+01 | +2.233005e+00 | -4.897170e+00 |
| lag_freq(8).norm     | 8.238248e-01 | +3.557225e-01 | -2.670406e-01 |
| lag_freq(8).h2       | 1.070688e+01 | +8.245187e-01 | -3.045483e+00 |
| lag_freq(8).Gamma1   | 1.800020e+00 | +1.041466e-01 | -2.000000e-05 |
| lag_freq(8).Gamma2   | 1.885438e+00 | +1.149259e-01 | -8.877460e-02 |
| lag_freq(8).xi       | 2.227108e+00 | +6.676422e-01 | -2.227108e+00 |
| lag_freq(8).b        | 2.999878e+00 | +1.220000e-04 | -5.874656e-01 |
| lag_freq(8).t_max    | 2.771239e+02 | +1.663771e+02 | -7.710346e+01 |
| lag_freq(8).t_shift  | 9.889029e+01 | +9.402180e+00 | -1.511694e+01 |
| lag_freq(9).norm     | 2.787311e-01 | +1.955046e-01 | -8.366776e-02 |
| lag_freq(9).h2       | 5.124979e+00 | +1.760494e+00 | -2.124979e+00 |
| lag_freq(9).Gamma1   | 3.102168e+00 | +2.936731e-02 | -1.228546e+00 |
| lag_freq(9).Gamma2   | 1.400316e+00 | +1.419247e+00 | -3.160000e-04 |
| lag_freq(9).xi       | 7.271078e-01 | +2.272892e+00 | -7.271078e-01 |
| lag_freq(9).b        | 2.499969e+00 | +5.000310e-01 | -1.499969e+00 |
| lag_freq(9).t_max    | 7.928944e+02 | +7.105600e+00 | -4.223506e+02 |
| lag_freq(9).t_shift  | 1.207394e+02 | +2.926060e+01 | -9.186263e+01 |
| lag_freq(10).norm    | 6.826879e-01 | +2.026445e-01 | -1.574491e-01 |
| lag_freq(10).h2      | 7.249958e+00 | +1.530735e+00 | -3.910668e+00 |
| lag_freq(10).Gamma1  | 3.049943e+00 | +7.446937e-02 | -4.616529e-01 |
| lag_freq(10).Gamma2  | 2.975119e+00 | +4.733208e-02 | -2.777973e-01 |
| lag_freq(10).xi      | 7.499553e-01 | +2.250045e+00 | -7.499553e-01 |
| lag_freq(10).b       | 2.999878e+00 | +1.220000e-04 | -5.049781e-01 |
| lag_freq(10).t_max   | 2.000154e+02 | +6.045314e+01 | -1.559418e-02 |
| lag_freq(10).t_shift | 9.148783e+01 | +2.971157e+00 | -7.944806e+00 |
| lag_freq(11).norm    | 2.216119e-01 | +1.677583e-01 | -9.980662e-02 |
| lag_freq(11).h2      | 7.249958e+00 | +2.351083e+00 | -2.486831e+00 |
| lag_freq(11).Gamma1  | 3.102168e+00 | +4.405568e-02 | -1.070265e+00 |
| lag_freq(11).Gamma2  | 1.400316e+00 | +1.271599e+00 | -3.160000e-04 |
| lag_freq(11).xi      | 7.271078e-01 | +2.272892e+00 | -7.271078e-01 |
| lag_freq(11).b       | 2.937496e+00 | +6.250400e-02 | -1.937496e+00 |
| lag_freq(11).t_max   | 7.171574e+02 | +8.284260e+01 | -3.530361e+02 |
| lag_freq(11).t_shift | 1.207394e+02 | +2.926060e+01 | -2.894735e+01 |
| lag_freq(12).norm    | 4.962282e-01 | +1.173666e-01 | -1.669626e-01 |
| lag_freq(12).h2      | 8.975963e+00 | +9.032235e-01 | -1.366225e+00 |
| lag_freq(12).Gamma1  | 3.102168e+00 | +3.292832e-02 | -3.867822e-01 |
| lag_freq(12).Gamma2  | 1.400079e+00 | +5.311121e-01 | -7.900000e-05 |
| lag_freq(12).xi      | 2.999600e+00 | +4.000000e-04 | -7.288654e-01 |
| lag_freq(12).b       | 1.749985e+00 | +9.920916e-01 | -6.395528e-01 |
| lag_freq(12).t_max   | 7.999798e+02 | +2.020000e-02 | -1.447794e+02 |
| lag_freq(12).t_shift | 1.499964e+02 | +3.600000e-03 | -4.496743e+01 |
| lag_freq(13).norm    | 2.481141e-01 | +1.058838e-01 | -8.021325e-02 |
| lag_freq(13).h2      | 5.987982e+00 | +2.638405e+00 | -2.987982e+00 |
| lag_freq(13).Gamma1  | 3.102168e+00 | +3.162480e-02 | -6.728682e-01 |
| lag_freq(13).Gamma2  | 1.400079e+00 | +7.423727e-01 | -7.900000e-05 |
| lag_freq(13).xi      | 2.999600e+00 | +4.000000e-04 | -2.999600e+00 |
| lag_freq(13).b       | 2.999652e+00 | +3.480000e-04 | -6.347455e-01 |
| lag_freq(13).t_max   | 5.003270e+02 | +9.263717e+01 | -3.374718e+01 |
| lag_freq(13).t_shift | 1.499964e+02 | +3.600000e-03 | -2.948448e+01 |
| lag_freq(14).norm    | 5.932696e-01 | +1.479402e-01 | -1.597841e-01 |
| lag_freq(14).h2      | 1.140072e+01 | +1.288831e+00 | -9.450873e-01 |
| lag_freq(14).Gamma1  | 1.881385e+00 | +4.075940e-01 | -8.138550e-02 |
| lag_freq(14).Gamma2  | 1.400079e+00 | +2.530505e-01 | -7.900000e-05 |
| lag_freq(14).xi      | 2.999600e+00 | +4.000000e-04 | -2.999600e+00 |
| lag_freq(14).b       | 2.999652e+00 | +3.480000e-04 | -6.055680e-01 |
| lag_freq(14).t_max   | 5.003270e+02 | +1.473833e+02 | -5.691121e+01 |
| lag_freq(14).t_shift | 1.499964e+02 | +3.600000e-03 | -1.144928e+01 |

** 15 data sets

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/IRAS13224-3809/mass-fit-15data.sl=

gedit =conf_mass_fit_15data.csv=

[detached from 40101.pts-4.hm00]

| lag_freq(1).norm     | 7.313036e-02 | +1.660890e-01 | -7.313036e-02 |
| lag_freq(1).log_mass | 6.298605e+00 | +6.309034e-03 | -7.113188e-03 |
| lag_freq(1).h2       | 9.354387e+00 | +1.064561e+01 | -6.354387e+00 |
| lag_freq(1).Gamma1   | 2.988228e+00 | +3.107720e-01 | -1.188228e+00 |
| lag_freq(1).Gamma2   | 1.406009e+00 | +1.793991e+00 | -6.009000e-03 |
| lag_freq(1).xi       | 2.997138e+00 | +2.862000e-03 | -2.997138e+00 |
| lag_freq(1).b        | 2.999641e+00 | +3.590000e-04 | -1.999641e+00 |
| lag_freq(1).t_max    | 1.906654e+02 | +6.093346e+02 | -1.406654e+02 |
| lag_freq(1).t_shift  | 4.500933e+01 | +4.498391e+01 | -3.500933e+01 |
| lag_freq(2).norm     | 3.598097e-06 | +9.406814e-02 | -3.598097e-06 |
| lag_freq(2).h2       | 1.999644e+01 | +3.560000e-03 | -1.699644e+01 |
| lag_freq(2).Gamma1   | 2.995086e+00 | +3.039140e-01 | -1.195086e+00 |
| lag_freq(2).Gamma2   | 1.403005e+00 | +1.796995e+00 | -3.005000e-03 |
| lag_freq(2).xi       | 2.998569e+00 | +1.431000e-03 | -2.998569e+00 |
| lag_freq(2).b        | 2.999378e+00 | +6.220000e-04 | -1.999378e+00 |
| lag_freq(2).t_max    | 1.481155e+02 | +6.518845e+02 | -9.811550e+01 |
| lag_freq(2).t_shift  | 4.822261e+01 | +4.177798e+01 | -3.822261e+01 |
| lag_freq(3).norm     | 1.242174e+00 | +7.456776e-01 | -4.170013e-01 |
| lag_freq(3).h2       | 6.106437e+00 | +4.042463e-01 | -9.649492e-01 |
| lag_freq(3).Gamma1   | 2.988228e+00 | +1.493946e-01 | -5.115996e-01 |
| lag_freq(3).Gamma2   | 1.400238e+00 | +5.357671e-01 | -2.380000e-04 |
| lag_freq(3).xi       | 2.999821e+00 | +1.790000e-04 | -1.569060e+00 |
| lag_freq(3).b        | 1.999686e+00 | +4.610922e-01 | -4.897944e-01 |
| lag_freq(3).t_max    | 6.084534e+02 | +1.915466e+02 | -2.239495e+02 |
| lag_freq(3).t_shift  | 1.000029e+01 | +2.753194e+00 | -2.900000e-04 |
| lag_freq(4).norm     | 5.198961e-01 | +2.508474e-01 | -1.509013e-01 |
| lag_freq(4).h2       | 1.464054e+01 | +5.359460e+00 | -5.322333e+00 |
| lag_freq(4).Gamma1   | 1.800047e+00 | +6.082928e-01 | -4.700000e-05 |
| lag_freq(4).Gamma2   | 3.006783e+00 | +2.705670e-02 | -7.088540e-01 |
| lag_freq(4).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(4).b        | 2.999921e+00 | +7.900000e-05 | -6.074366e-01 |
| lag_freq(4).t_max    | 1.092019e+02 | +7.006718e+01 | -2.374033e+01 |
| lag_freq(4).t_shift  | 1.694443e+01 | +3.646070e+00 | -3.931675e+00 |
| lag_freq(5).norm     | 3.483333e-01 | +1.269885e-01 | -1.007428e-01 |
| lag_freq(5).h2       | 1.999965e+01 | +3.500000e-04 | -3.726945e+00 |
| lag_freq(5).Gamma1   | 1.952190e+00 | +1.901695e-01 | -1.521900e-01 |
| lag_freq(5).Gamma2   | 2.996969e+00 | +3.215238e-02 | -1.736498e-01 |
| lag_freq(5).xi       | 1.514808e-02 | +2.984852e+00 | -1.514808e-02 |
| lag_freq(5).b        | 1.000061e+00 | +7.025906e-01 | -6.100000e-05 |
| lag_freq(5).t_max    | 3.788791e+02 | +2.712635e+02 | -2.242172e+02 |
| lag_freq(5).t_shift  | 1.000055e+01 | +1.560955e+00 | -5.500000e-04 |
| lag_freq(6).norm     | 7.879449e-06 | +8.603554e-02 | -7.879449e-06 |
| lag_freq(6).h2       | 1.527182e+01 | +4.728180e+00 | -1.227182e+01 |
| lag_freq(6).Gamma1   | 1.800315e+00 | +1.498685e+00 | -3.150000e-04 |
| lag_freq(6).Gamma2   | 1.480941e+00 | +1.719059e+00 | -8.094100e-02 |
| lag_freq(6).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(6).b        | 2.999990e+00 | +1.000000e-05 | -1.999990e+00 |
| lag_freq(6).t_max    | 9.905777e+01 | +7.009422e+02 | -4.905777e+01 |
| lag_freq(6).t_shift  | 1.000055e+01 | +7.999932e+01 | -5.500000e-04 |
| lag_freq(7).norm     | 1.263360e+00 | +5.191486e-01 | -2.253311e-01 |
| lag_freq(7).h2       | 8.669090e+00 | +7.090474e-01 | -3.963068e-01 |
| lag_freq(7).Gamma1   | 3.102168e+00 | +1.745571e-02 | -3.897519e-01 |
| lag_freq(7).Gamma2   | 1.400020e+00 | +4.222916e-01 | -2.000000e-05 |
| lag_freq(7).xi       | 2.999633e+00 | +3.670000e-04 | -7.801658e-01 |
| lag_freq(7).b        | 1.499878e+00 | +5.411192e-01 | -2.410932e-01 |
| lag_freq(7).t_max    | 7.999906e+02 | +9.400000e-03 | -1.836134e+02 |
| lag_freq(7).t_shift  | 2.124549e+01 | +2.233005e+00 | -4.897170e+00 |
| lag_freq(8).norm     | 8.238248e-01 | +3.557225e-01 | -2.670406e-01 |
| lag_freq(8).h2       | 1.070688e+01 | +8.245187e-01 | -3.045483e+00 |
| lag_freq(8).Gamma1   | 1.800020e+00 | +1.041466e-01 | -2.000000e-05 |
| lag_freq(8).Gamma2   | 1.885438e+00 | +1.149259e-01 | -8.877460e-02 |
| lag_freq(8).xi       | 2.227108e+00 | +6.676422e-01 | -2.227108e+00 |
| lag_freq(8).b        | 2.999878e+00 | +1.220000e-04 | -5.874656e-01 |
| lag_freq(8).t_max    | 2.771239e+02 | +1.663771e+02 | -7.710346e+01 |
| lag_freq(8).t_shift  | 9.889029e+01 | +9.402180e+00 | -1.511694e+01 |
| lag_freq(9).norm     | 2.787311e-01 | +1.955046e-01 | -8.366776e-02 |
| lag_freq(9).h2       | 5.124979e+00 | +1.760494e+00 | -2.124979e+00 |
| lag_freq(9).Gamma1   | 3.102168e+00 | +2.936731e-02 | -1.228546e+00 |
| lag_freq(9).Gamma2   | 1.400316e+00 | +1.419247e+00 | -3.160000e-04 |
| lag_freq(9).xi       | 7.271078e-01 | +2.272892e+00 | -7.271078e-01 |
| lag_freq(9).b        | 2.499969e+00 | +5.000310e-01 | -1.499969e+00 |
| lag_freq(9).t_max    | 7.928944e+02 | +7.105600e+00 | -4.223506e+02 |
| lag_freq(9).t_shift  | 1.207394e+02 | +2.926060e+01 | -9.186263e+01 |
| lag_freq(10).norm    | 6.826879e-01 | +2.026445e-01 | -1.574491e-01 |
| lag_freq(10).h2      | 7.249958e+00 | +1.530735e+00 | -3.910668e+00 |
| lag_freq(10).Gamma1  | 3.049943e+00 | +7.446937e-02 | -4.616529e-01 |
| lag_freq(10).Gamma2  | 2.975119e+00 | +4.733208e-02 | -2.777973e-01 |
| lag_freq(10).xi      | 7.499553e-01 | +2.250045e+00 | -7.499553e-01 |
| lag_freq(10).b       | 2.999878e+00 | +1.220000e-04 | -5.049781e-01 |
| lag_freq(10).t_max   | 2.000154e+02 | +6.045314e+01 | -1.559418e-02 |
| lag_freq(10).t_shift | 9.148783e+01 | +2.971157e+00 | -7.944806e+00 |
| lag_freq(11).norm    | 2.216119e-01 | +1.677583e-01 | -9.980662e-02 |
| lag_freq(11).h2      | 7.249958e+00 | +2.351083e+00 | -2.486831e+00 |
| lag_freq(11).Gamma1  | 3.102168e+00 | +4.405568e-02 | -1.070265e+00 |
| lag_freq(11).Gamma2  | 1.400316e+00 | +1.271599e+00 | -3.160000e-04 |
| lag_freq(11).xi      | 7.271078e-01 | +2.272892e+00 | -7.271078e-01 |
| lag_freq(11).b       | 2.937496e+00 | +6.250400e-02 | -1.937496e+00 |
| lag_freq(11).t_max   | 7.171574e+02 | +8.284260e+01 | -3.530361e+02 |
| lag_freq(11).t_shift | 1.207394e+02 | +2.926060e+01 | -2.894735e+01 |
| lag_freq(12).norm    | 4.962282e-01 | +1.173666e-01 | -1.669626e-01 |
| lag_freq(12).h2      | 8.975963e+00 | +9.032235e-01 | -1.366225e+00 |
| lag_freq(12).Gamma1  | 3.102168e+00 | +3.292832e-02 | -3.867822e-01 |
| lag_freq(12).Gamma2  | 1.400079e+00 | +5.311121e-01 | -7.900000e-05 |
| lag_freq(12).xi      | 2.999600e+00 | +4.000000e-04 | -7.288654e-01 |
| lag_freq(12).b       | 1.749985e+00 | +9.920916e-01 | -6.395528e-01 |
| lag_freq(12).t_max   | 7.999798e+02 | +2.020000e-02 | -1.447794e+02 |
| lag_freq(12).t_shift | 1.499964e+02 | +3.600000e-03 | -4.496743e+01 |
| lag_freq(13).norm    | 2.481141e-01 | +1.058838e-01 | -8.021325e-02 |
| lag_freq(13).h2      | 5.987982e+00 | +2.638405e+00 | -2.987982e+00 |
| lag_freq(13).Gamma1  | 3.102168e+00 | +3.162480e-02 | -6.728682e-01 |
| lag_freq(13).Gamma2  | 1.400079e+00 | +7.423727e-01 | -7.900000e-05 |
| lag_freq(13).xi      | 2.999600e+00 | +4.000000e-04 | -2.999600e+00 |
| lag_freq(13).b       | 2.999652e+00 | +3.480000e-04 | -6.347455e-01 |
| lag_freq(13).t_max   | 5.003270e+02 | +9.263717e+01 | -3.374718e+01 |
| lag_freq(13).t_shift | 1.499964e+02 | +3.600000e-03 | -2.948448e+01 |
| lag_freq(14).norm    | 5.932696e-01 | +1.479404e-01 | -1.597841e-01 |
| lag_freq(14).h2      | 1.140072e+01 | +1.288832e+00 | -9.450848e-01 |
| lag_freq(14).Gamma1  | 1.881385e+00 | +4.075945e-01 | -8.138500e-02 |
| lag_freq(14).Gamma2  | 1.400079e+00 | +2.530501e-01 | -7.900000e-05 |
| lag_freq(14).xi      | 2.999600e+00 | +4.000000e-04 | -2.999600e+00 |
| lag_freq(14).b       | 2.999652e+00 | +3.480000e-04 | -6.055676e-01 |
| lag_freq(14).t_max   | 5.003270e+02 | +1.473832e+02 | -5.691116e+01 |
| lag_freq(14).t_shift | 1.499964e+02 | +3.600000e-03 | -1.144931e+01 |
| lag_freq(15).norm    | 7.402610e-01 | +2.789267e-01 | -1.897767e-01 |
| lag_freq(15).h2      | 7.052896e+00 | +7.672868e-01 | -4.052896e+00 |
| lag_freq(15).Gamma1  | 3.142876e+00 | +1.464273e-02 | -2.152648e-02 |
| lag_freq(15).Gamma2  | 1.400079e+00 | +1.065058e+00 | -7.900000e-05 |
| lag_freq(15).xi      | 2.999634e+00 | +3.663574e-04 | -2.999634e+00 |
| lag_freq(15).b       | 1.999826e+00 | +1.000174e+00 | -9.107367e-01 |
| lag_freq(15).t_max   | 7.250818e+02 | +7.491825e+01 | -1.878666e+02 |
| lag_freq(15).t_shift | 1.499964e+02 | +3.600000e-03 | -3.894433e+01 |

** 16 data sets

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/IRAS13224-3809/mass-fit-16data.sl=

gedit =conf_mass_fit_16data.csv=

| lag_freq(1).norm     | 7.313036e-02 | +1.660890e-01 | -7.313036e-02 |
| lag_freq(1).log_mass | 6.298605e+00 | +5.684125e-03 | -7.131390e-03 |
| lag_freq(1).h2       | 9.354387e+00 | +1.064561e+01 | -6.354387e+00 |
| lag_freq(1).Gamma1   | 2.988228e+00 | +3.107720e-01 | -1.188228e+00 |
| lag_freq(1).Gamma2   | 1.406009e+00 | +1.793991e+00 | -6.009000e-03 |
| lag_freq(1).xi       | 2.997138e+00 | +2.862000e-03 | -2.997138e+00 |
| lag_freq(1).b        | 2.999641e+00 | +3.590000e-04 | -1.999641e+00 |
| lag_freq(1).t_max    | 1.906654e+02 | +6.093346e+02 | -1.406654e+02 |
| lag_freq(1).t_shift  | 4.500933e+01 | +4.498391e+01 | -3.500933e+01 |
| lag_freq(2).norm     | 3.598097e-06 | +9.406814e-02 | -3.598097e-06 |
| lag_freq(2).h2       | 1.999644e+01 | +3.560000e-03 | -1.699644e+01 |
| lag_freq(2).Gamma1   | 2.995086e+00 | +3.039140e-01 | -1.195086e+00 |
| lag_freq(2).Gamma2   | 1.403005e+00 | +1.796995e+00 | -3.005000e-03 |
| lag_freq(2).xi       | 2.998569e+00 | +1.431000e-03 | -2.998569e+00 |
| lag_freq(2).b        | 2.999378e+00 | +6.220000e-04 | -1.999378e+00 |
| lag_freq(2).t_max    | 1.481155e+02 | +6.518845e+02 | -9.811550e+01 |
| lag_freq(2).t_shift  | 4.822261e+01 | +4.177798e+01 | -3.822261e+01 |
| lag_freq(3).norm     | 1.242174e+00 | +7.456776e-01 | -4.170013e-01 |
| lag_freq(3).h2       | 6.106437e+00 | +4.042463e-01 | -9.649492e-01 |
| lag_freq(3).Gamma1   | 2.988228e+00 | +1.493946e-01 | -5.115996e-01 |
| lag_freq(3).Gamma2   | 1.400238e+00 | +5.357671e-01 | -2.380000e-04 |
| lag_freq(3).xi       | 2.999821e+00 | +1.790000e-04 | -1.569060e+00 |
| lag_freq(3).b        | 1.999686e+00 | +4.610922e-01 | -4.897944e-01 |
| lag_freq(3).t_max    | 6.084534e+02 | +1.915466e+02 | -2.239495e+02 |
| lag_freq(3).t_shift  | 1.000029e+01 | +2.753194e+00 | -2.900000e-04 |
| lag_freq(4).norm     | 5.198961e-01 | +2.508474e-01 | -1.509013e-01 |
| lag_freq(4).h2       | 1.464054e+01 | +5.359460e+00 | -5.322333e+00 |
| lag_freq(4).Gamma1   | 1.800047e+00 | +6.082928e-01 | -4.700000e-05 |
| lag_freq(4).Gamma2   | 3.006783e+00 | +2.705670e-02 | -7.088540e-01 |
| lag_freq(4).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(4).b        | 2.999921e+00 | +7.900000e-05 | -6.074366e-01 |
| lag_freq(4).t_max    | 1.092019e+02 | +7.006718e+01 | -2.374033e+01 |
| lag_freq(4).t_shift  | 1.694443e+01 | +3.646070e+00 | -3.931675e+00 |
| lag_freq(5).norm     | 3.483333e-01 | +1.269885e-01 | -1.007428e-01 |
| lag_freq(5).h2       | 1.999965e+01 | +3.500000e-04 | -3.726945e+00 |
| lag_freq(5).Gamma1   | 1.952190e+00 | +1.901695e-01 | -1.521900e-01 |
| lag_freq(5).Gamma2   | 2.996969e+00 | +3.215238e-02 | -1.736498e-01 |
| lag_freq(5).xi       | 1.514808e-02 | +2.984852e+00 | -1.514808e-02 |
| lag_freq(5).b        | 1.000061e+00 | +7.025906e-01 | -6.100000e-05 |
| lag_freq(5).t_max    | 3.788791e+02 | +2.712635e+02 | -2.242172e+02 |
| lag_freq(5).t_shift  | 1.000055e+01 | +1.560955e+00 | -5.500000e-04 |
| lag_freq(6).norm     | 7.879449e-06 | +8.603554e-02 | -7.879449e-06 |
| lag_freq(6).h2       | 1.527182e+01 | +4.728180e+00 | -1.227182e+01 |
| lag_freq(6).Gamma1   | 1.800315e+00 | +1.498685e+00 | -3.150000e-04 |
| lag_freq(6).Gamma2   | 1.480941e+00 | +1.719059e+00 | -8.094100e-02 |
| lag_freq(6).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(6).b        | 2.999990e+00 | +1.000000e-05 | -1.999990e+00 |
| lag_freq(6).t_max    | 9.905777e+01 | +7.009422e+02 | -4.905777e+01 |
| lag_freq(6).t_shift  | 1.000055e+01 | +7.999932e+01 | -5.500000e-04 |
| lag_freq(7).norm     | 1.263360e+00 | +5.191486e-01 | -2.253311e-01 |
| lag_freq(7).h2       | 8.669090e+00 | +7.090474e-01 | -3.963068e-01 |
| lag_freq(7).Gamma1   | 3.102168e+00 | +1.745571e-02 | -3.897519e-01 |
| lag_freq(7).Gamma2   | 1.400020e+00 | +4.222916e-01 | -2.000000e-05 |
| lag_freq(7).xi       | 2.999633e+00 | +3.670000e-04 | -7.801658e-01 |
| lag_freq(7).b        | 1.499878e+00 | +5.411192e-01 | -2.410932e-01 |
| lag_freq(7).t_max    | 7.999906e+02 | +9.400000e-03 | -1.836134e+02 |
| lag_freq(7).t_shift  | 2.124549e+01 | +2.233005e+00 | -4.897170e+00 |
| lag_freq(8).norm     | 8.238248e-01 | +3.557225e-01 | -2.670406e-01 |
| lag_freq(8).h2       | 1.070688e+01 | +8.245187e-01 | -3.045483e+00 |
| lag_freq(8).Gamma1   | 1.800020e+00 | +1.041466e-01 | -2.000000e-05 |
| lag_freq(8).Gamma2   | 1.885438e+00 | +1.149259e-01 | -8.877460e-02 |
| lag_freq(8).xi       | 2.227108e+00 | +6.676422e-01 | -2.227108e+00 |
| lag_freq(8).b        | 2.999878e+00 | +1.220000e-04 | -5.874656e-01 |
| lag_freq(8).t_max    | 2.771239e+02 | +1.663771e+02 | -7.710346e+01 |
| lag_freq(8).t_shift  | 9.889029e+01 | +9.402180e+00 | -1.511694e+01 |
| lag_freq(9).norm     | 2.787311e-01 | +1.955046e-01 | -8.366776e-02 |
| lag_freq(9).h2       | 5.124979e+00 | +1.760494e+00 | -2.124979e+00 |
| lag_freq(9).Gamma1   | 3.102168e+00 | +2.936731e-02 | -1.228546e+00 |
| lag_freq(9).Gamma2   | 1.400316e+00 | +1.419247e+00 | -3.160000e-04 |
| lag_freq(9).xi       | 7.271078e-01 | +2.272892e+00 | -7.271078e-01 |
| lag_freq(9).b        | 2.499969e+00 | +5.000310e-01 | -1.499969e+00 |
| lag_freq(9).t_max    | 7.928944e+02 | +7.105600e+00 | -4.223506e+02 |
| lag_freq(9).t_shift  | 1.207394e+02 | +2.926060e+01 | -9.186263e+01 |
| lag_freq(10).norm    | 6.826879e-01 | +2.026445e-01 | -1.574491e-01 |
| lag_freq(10).h2      | 7.249958e+00 | +1.530735e+00 | -3.910668e+00 |
| lag_freq(10).Gamma1  | 3.049943e+00 | +7.446937e-02 | -4.616529e-01 |
| lag_freq(10).Gamma2  | 2.975119e+00 | +4.733208e-02 | -2.777973e-01 |
| lag_freq(10).xi      | 7.499553e-01 | +2.250045e+00 | -7.499553e-01 |
| lag_freq(10).b       | 2.999878e+00 | +1.220000e-04 | -5.049781e-01 |
| lag_freq(10).t_max   | 2.000154e+02 | +6.045314e+01 | -1.559418e-02 |
| lag_freq(10).t_shift | 9.148783e+01 | +2.971157e+00 | -7.944806e+00 |
| lag_freq(11).norm    | 2.216119e-01 | +1.677583e-01 | -9.980662e-02 |
| lag_freq(11).h2      | 7.249958e+00 | +2.351083e+00 | -2.486831e+00 |
| lag_freq(11).Gamma1  | 3.102168e+00 | +4.405568e-02 | -1.070265e+00 |
| lag_freq(11).Gamma2  | 1.400316e+00 | +1.271599e+00 | -3.160000e-04 |
| lag_freq(11).xi      | 7.271078e-01 | +2.272892e+00 | -7.271078e-01 |
| lag_freq(11).b       | 2.937496e+00 | +6.250400e-02 | -1.937496e+00 |
| lag_freq(11).t_max   | 7.171574e+02 | +8.284260e+01 | -3.530361e+02 |
| lag_freq(11).t_shift | 1.207394e+02 | +2.926060e+01 | -2.894735e+01 |
| lag_freq(12).norm    | 4.962282e-01 | +1.173666e-01 | -1.669626e-01 |
| lag_freq(12).h2      | 8.975963e+00 | +9.032235e-01 | -1.366225e+00 |
| lag_freq(12).Gamma1  | 3.102168e+00 | +3.292832e-02 | -3.867822e-01 |
| lag_freq(12).Gamma2  | 1.400079e+00 | +5.311121e-01 | -7.900000e-05 |
| lag_freq(12).xi      | 2.999600e+00 | +4.000000e-04 | -7.288654e-01 |
| lag_freq(12).b       | 1.749985e+00 | +9.920916e-01 | -6.395528e-01 |
| lag_freq(12).t_max   | 7.999798e+02 | +2.020000e-02 | -1.447794e+02 |
| lag_freq(12).t_shift | 1.499964e+02 | +3.600000e-03 | -4.496743e+01 |
| lag_freq(13).norm    | 2.481141e-01 | +1.058838e-01 | -8.021325e-02 |
| lag_freq(13).h2      | 5.987982e+00 | +2.638405e+00 | -2.987982e+00 |
| lag_freq(13).Gamma1  | 3.102168e+00 | +3.162480e-02 | -6.728682e-01 |
| lag_freq(13).Gamma2  | 1.400079e+00 | +7.423727e-01 | -7.900000e-05 |
| lag_freq(13).xi      | 2.999600e+00 | +4.000000e-04 | -2.999600e+00 |
| lag_freq(13).b       | 2.999652e+00 | +3.480000e-04 | -6.347455e-01 |
| lag_freq(13).t_max   | 5.003270e+02 | +9.263717e+01 | -3.374718e+01 |
| lag_freq(13).t_shift | 1.499964e+02 | +3.600000e-03 | -2.948448e+01 |
| lag_freq(14).norm    | 5.932696e-01 | +1.479404e-01 | -1.597841e-01 |
| lag_freq(14).h2      | 1.140072e+01 | +1.288832e+00 | -9.450848e-01 |
| lag_freq(14).Gamma1  | 1.881385e+00 | +4.075945e-01 | -8.138500e-02 |
| lag_freq(14).Gamma2  | 1.400079e+00 | +2.530501e-01 | -7.900000e-05 |
| lag_freq(14).xi      | 2.999600e+00 | +4.000000e-04 | -2.999600e+00 |
| lag_freq(14).b       | 2.999652e+00 | +3.480000e-04 | -6.055676e-01 |
| lag_freq(14).t_max   | 5.003270e+02 | +1.473832e+02 | -5.691116e+01 |
| lag_freq(14).t_shift | 1.499964e+02 | +3.600000e-03 | -1.144931e+01 |
| lag_freq(15).norm    | 7.402610e-01 | +2.789268e-01 | -1.897766e-01 |
| lag_freq(15).h2      | 7.052896e+00 | +7.672870e-01 | -4.052896e+00 |
| lag_freq(15).Gamma1  | 3.142876e+00 | +1.464266e-02 | -2.152671e-02 |
| lag_freq(15).Gamma2  | 1.400079e+00 | +1.065058e+00 | -7.900000e-05 |
| lag_freq(15).xi      | 2.999634e+00 | +3.660000e-04 | -2.999634e+00 |
| lag_freq(15).b       | 1.999826e+00 | +1.000174e+00 | -9.107366e-01 |
| lag_freq(15).t_max   | 7.250818e+02 | +7.491820e+01 | -1.878667e+02 |
| lag_freq(15).t_shift | 1.499964e+02 | +3.600000e-03 | -3.894433e+01 |
| lag_freq(16).norm    | 9.753598e-01 | +1.962093e-01 | -2.782204e-01 |
| lag_freq(16).h2      | 8.024738e+00 | +9.266196e-01 | -1.134995e+00 |
| lag_freq(16).Gamma1  | 3.142876e+00 | +1.629476e-02 | -1.149262e-02 |
| lag_freq(16).Gamma2  | 1.400079e+00 | +5.895631e-01 | -7.900000e-05 |
| lag_freq(16).xi      | 2.999634e+00 | +3.660000e-04 | -2.999634e+00 |
| lag_freq(16).b       | 1.999826e+00 | +5.918353e-01 | -8.286337e-01 |
| lag_freq(16).t_max   | 7.998537e+02 | +1.463246e-01 | -1.952124e+02 |
| lag_freq(16).t_shift | 1.071799e+02 | +1.063697e+01 | -1.301722e+01 |

** 17 data sets

PATH =
=/data/typhon1/reverb/table-model-ecm-fits/IRAS13224-3809/mass-fit-17data.sl=

gedit =conf_mass_fit_17data.csv=

| lag_freq(1).norm     | 7.313036e-02 | +1.660890e-01 | -7.313036e-02 |
| lag_freq(1).log_mass | 6.298605e+00 | +4.496081e-03 | -8.057811e-03 |
| lag_freq(1).h2       | 9.354387e+00 | +1.064561e+01 | -6.354387e+00 |
| lag_freq(1).Gamma1   | 2.988228e+00 | +3.107720e-01 | -1.188228e+00 |
| lag_freq(1).Gamma2   | 1.406009e+00 | +1.793991e+00 | -6.009000e-03 |
| lag_freq(1).xi       | 2.997138e+00 | +2.862000e-03 | -2.997138e+00 |
| lag_freq(1).b        | 2.999641e+00 | +3.590000e-04 | -1.999641e+00 |
| lag_freq(1).t_max    | 1.906654e+02 | +6.093346e+02 | -1.406654e+02 |
| lag_freq(1).t_shift  | 4.500933e+01 | +4.498391e+01 | -3.500933e+01 |
| lag_freq(2).norm     | 3.598097e-06 | +9.406814e-02 | -3.598097e-06 |
| lag_freq(2).h2       | 1.999644e+01 | +3.560000e-03 | -1.699644e+01 |
| lag_freq(2).Gamma1   | 2.995086e+00 | +3.039140e-01 | -1.195086e+00 |
| lag_freq(2).Gamma2   | 1.403005e+00 | +1.796995e+00 | -3.005000e-03 |
| lag_freq(2).xi       | 2.998569e+00 | +1.431000e-03 | -2.998569e+00 |
| lag_freq(2).b        | 2.999378e+00 | +6.220000e-04 | -1.999378e+00 |
| lag_freq(2).t_max    | 1.481155e+02 | +6.518845e+02 | -9.811550e+01 |
| lag_freq(2).t_shift  | 4.822261e+01 | +4.177798e+01 | -3.822261e+01 |
| lag_freq(3).norm     | 1.242174e+00 | +7.456776e-01 | -4.170013e-01 |
| lag_freq(3).h2       | 6.106437e+00 | +4.042463e-01 | -9.649492e-01 |
| lag_freq(3).Gamma1   | 2.988228e+00 | +1.493946e-01 | -5.115996e-01 |
| lag_freq(3).Gamma2   | 1.400238e+00 | +5.357671e-01 | -2.380000e-04 |
| lag_freq(3).xi       | 2.999821e+00 | +1.790000e-04 | -1.569060e+00 |
| lag_freq(3).b        | 1.999686e+00 | +4.610922e-01 | -4.897944e-01 |
| lag_freq(3).t_max    | 6.084534e+02 | +1.915466e+02 | -2.239495e+02 |
| lag_freq(3).t_shift  | 1.000029e+01 | +2.753194e+00 | -2.900000e-04 |
| lag_freq(4).norm     | 5.198961e-01 | +2.508474e-01 | -1.509013e-01 |
| lag_freq(4).h2       | 1.464054e+01 | +5.359460e+00 | -5.322333e+00 |
| lag_freq(4).Gamma1   | 1.800047e+00 | +6.082928e-01 | -4.700000e-05 |
| lag_freq(4).Gamma2   | 3.006783e+00 | +2.705670e-02 | -7.088540e-01 |
| lag_freq(4).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(4).b        | 2.999921e+00 | +7.900000e-05 | -6.074366e-01 |
| lag_freq(4).t_max    | 1.092019e+02 | +7.006718e+01 | -2.374033e+01 |
| lag_freq(4).t_shift  | 1.694443e+01 | +3.646070e+00 | -3.931675e+00 |
| lag_freq(5).norm     | 3.483333e-01 | +1.269885e-01 | -1.007428e-01 |
| lag_freq(5).h2       | 1.999965e+01 | +3.500000e-04 | -3.726945e+00 |
| lag_freq(5).Gamma1   | 1.952190e+00 | +1.901695e-01 | -1.521900e-01 |
| lag_freq(5).Gamma2   | 2.996969e+00 | +3.215238e-02 | -1.736498e-01 |
| lag_freq(5).xi       | 1.514808e-02 | +2.984852e+00 | -1.514808e-02 |
| lag_freq(5).b        | 1.000061e+00 | +7.025906e-01 | -6.100000e-05 |
| lag_freq(5).t_max    | 3.788791e+02 | +2.712635e+02 | -2.242172e+02 |
| lag_freq(5).t_shift  | 1.000055e+01 | +1.560955e+00 | -5.500000e-04 |
| lag_freq(6).norm     | 7.879449e-06 | +8.603554e-02 | -7.879449e-06 |
| lag_freq(6).h2       | 1.527182e+01 | +4.728180e+00 | -1.227182e+01 |
| lag_freq(6).Gamma1   | 1.800315e+00 | +1.498685e+00 | -3.150000e-04 |
| lag_freq(6).Gamma2   | 1.480941e+00 | +1.719059e+00 | -8.094100e-02 |
| lag_freq(6).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(6).b        | 2.999990e+00 | +1.000000e-05 | -1.999990e+00 |
| lag_freq(6).t_max    | 9.905777e+01 | +7.009422e+02 | -4.905777e+01 |
| lag_freq(6).t_shift  | 1.000055e+01 | +7.999932e+01 | -5.500000e-04 |
| lag_freq(7).norm     | 1.263360e+00 | +5.191486e-01 | -2.253311e-01 |
| lag_freq(7).h2       | 8.669090e+00 | +7.090474e-01 | -3.963068e-01 |
| lag_freq(7).Gamma1   | 3.102168e+00 | +1.745571e-02 | -3.897519e-01 |
| lag_freq(7).Gamma2   | 1.400020e+00 | +4.222916e-01 | -2.000000e-05 |
| lag_freq(7).xi       | 2.999633e+00 | +3.670000e-04 | -7.801658e-01 |
| lag_freq(7).b        | 1.499878e+00 | +5.411192e-01 | -2.410932e-01 |
| lag_freq(7).t_max    | 7.999906e+02 | +9.400000e-03 | -1.836134e+02 |
| lag_freq(7).t_shift  | 2.124549e+01 | +2.233005e+00 | -4.897170e+00 |
| lag_freq(8).norm     | 8.238248e-01 | +3.557225e-01 | -2.670406e-01 |
| lag_freq(8).h2       | 1.070688e+01 | +8.245187e-01 | -3.045483e+00 |
| lag_freq(8).Gamma1   | 1.800020e+00 | +1.041466e-01 | -2.000000e-05 |
| lag_freq(8).Gamma2   | 1.885438e+00 | +1.149259e-01 | -8.877460e-02 |
| lag_freq(8).xi       | 2.227108e+00 | +6.676422e-01 | -2.227108e+00 |
| lag_freq(8).b        | 2.999878e+00 | +1.220000e-04 | -5.874656e-01 |
| lag_freq(8).t_max    | 2.771239e+02 | +1.663771e+02 | -7.710346e+01 |
| lag_freq(8).t_shift  | 9.889029e+01 | +9.402180e+00 | -1.511694e+01 |
| lag_freq(9).norm     | 2.787311e-01 | +1.955046e-01 | -8.366776e-02 |
| lag_freq(9).h2       | 5.124979e+00 | +1.760494e+00 | -2.124979e+00 |
| lag_freq(9).Gamma1   | 3.102168e+00 | +2.936731e-02 | -1.228546e+00 |
| lag_freq(9).Gamma2   | 1.400316e+00 | +1.419247e+00 | -3.160000e-04 |
| lag_freq(9).xi       | 7.271078e-01 | +2.272892e+00 | -7.271078e-01 |
| lag_freq(9).b        | 2.499969e+00 | +5.000310e-01 | -1.499969e+00 |
| lag_freq(9).t_max    | 7.928944e+02 | +7.105600e+00 | -4.223506e+02 |
| lag_freq(9).t_shift  | 1.207394e+02 | +2.926060e+01 | -9.186263e+01 |
| lag_freq(10).norm    | 6.826879e-01 | +2.026445e-01 | -1.574491e-01 |
| lag_freq(10).h2      | 7.249958e+00 | +1.530735e+00 | -3.910668e+00 |
| lag_freq(10).Gamma1  | 3.049943e+00 | +7.446937e-02 | -4.616529e-01 |
| lag_freq(10).Gamma2  | 2.975119e+00 | +4.733208e-02 | -2.777973e-01 |
| lag_freq(10).xi      | 7.499553e-01 | +2.250045e+00 | -7.499553e-01 |
| lag_freq(10).b       | 2.999878e+00 | +1.220000e-04 | -5.049781e-01 |
| lag_freq(10).t_max   | 2.000154e+02 | +6.045314e+01 | -1.559418e-02 |
| lag_freq(10).t_shift | 9.148783e+01 | +2.971157e+00 | -7.944806e+00 |
| lag_freq(11).norm    | 2.216119e-01 | +1.677583e-01 | -9.980662e-02 |
| lag_freq(11).h2      | 7.249958e+00 | +2.351083e+00 | -2.486831e+00 |
| lag_freq(11).Gamma1  | 3.102168e+00 | +4.405568e-02 | -1.070265e+00 |
| lag_freq(11).Gamma2  | 1.400316e+00 | +1.271599e+00 | -3.160000e-04 |
| lag_freq(11).xi      | 7.271078e-01 | +2.272892e+00 | -7.271078e-01 |
| lag_freq(11).b       | 2.937496e+00 | +6.250400e-02 | -1.937496e+00 |
| lag_freq(11).t_max   | 7.171574e+02 | +8.284260e+01 | -3.530361e+02 |
| lag_freq(11).t_shift | 1.207394e+02 | +2.926060e+01 | -2.894735e+01 |
| lag_freq(12).norm    | 4.962282e-01 | +1.173666e-01 | -1.669626e-01 |
| lag_freq(12).h2      | 8.975963e+00 | +9.032235e-01 | -1.366225e+00 |
| lag_freq(12).Gamma1  | 3.102168e+00 | +3.292832e-02 | -3.867822e-01 |
| lag_freq(12).Gamma2  | 1.400079e+00 | +5.311121e-01 | -7.900000e-05 |
| lag_freq(12).xi      | 2.999600e+00 | +4.000000e-04 | -7.288654e-01 |
| lag_freq(12).b       | 1.749985e+00 | +9.920916e-01 | -6.395528e-01 |
| lag_freq(12).t_max   | 7.999798e+02 | +2.020000e-02 | -1.447794e+02 |
| lag_freq(12).t_shift | 1.499964e+02 | +3.600000e-03 | -4.496743e+01 |
| lag_freq(13).norm    | 2.481141e-01 | +1.058838e-01 | -8.021325e-02 |
| lag_freq(13).h2      | 5.987982e+00 | +2.638405e+00 | -2.987982e+00 |
| lag_freq(13).Gamma1  | 3.102168e+00 | +3.162480e-02 | -6.728682e-01 |
| lag_freq(13).Gamma2  | 1.400079e+00 | +7.423727e-01 | -7.900000e-05 |
| lag_freq(13).xi      | 2.999600e+00 | +4.000000e-04 | -2.999600e+00 |
| lag_freq(13).b       | 2.999652e+00 | +3.480000e-04 | -6.347455e-01 |
| lag_freq(13).t_max   | 5.003270e+02 | +9.263717e+01 | -3.374718e+01 |
| lag_freq(13).t_shift | 1.499964e+02 | +3.600000e-03 | -2.948448e+01 |
| lag_freq(14).norm    | 5.932696e-01 | +1.479404e-01 | -1.597841e-01 |
| lag_freq(14).h2      | 1.140072e+01 | +1.288832e+00 | -9.450848e-01 |
| lag_freq(14).Gamma1  | 1.881385e+00 | +4.075945e-01 | -8.138500e-02 |
| lag_freq(14).Gamma2  | 1.400079e+00 | +2.530501e-01 | -7.900000e-05 |
| lag_freq(14).xi      | 2.999600e+00 | +4.000000e-04 | -2.999600e+00 |
| lag_freq(14).b       | 2.999652e+00 | +3.480000e-04 | -6.055676e-01 |
| lag_freq(14).t_max   | 5.003270e+02 | +1.473832e+02 | -5.691116e+01 |
| lag_freq(14).t_shift | 1.499964e+02 | +3.600000e-03 | -1.144931e+01 |
| lag_freq(15).norm    | 7.402610e-01 | +2.789268e-01 | -1.897766e-01 |
| lag_freq(15).h2      | 7.052896e+00 | +7.672870e-01 | -4.052896e+00 |
| lag_freq(15).Gamma1  | 3.142876e+00 | +1.464266e-02 | -2.152671e-02 |
| lag_freq(15).Gamma2  | 1.400079e+00 | +1.065058e+00 | -7.900000e-05 |
| lag_freq(15).xi      | 2.999634e+00 | +3.660000e-04 | -2.999634e+00 |
| lag_freq(15).b       | 1.999826e+00 | +1.000174e+00 | -9.107366e-01 |
| lag_freq(15).t_max   | 7.250818e+02 | +7.491820e+01 | -1.878667e+02 |
| lag_freq(15).t_shift | 1.499964e+02 | +3.600000e-03 | -3.894433e+01 |
| lag_freq(16).norm    | 9.753598e-01 | +1.962093e-01 | -2.782204e-01 |
| lag_freq(16).h2      | 8.024738e+00 | +9.266197e-01 | -1.134994e+00 |
| lag_freq(16).Gamma1  | 3.142876e+00 | +1.629472e-02 | -1.149258e-02 |
| lag_freq(16).Gamma2  | 1.400079e+00 | +5.895629e-01 | -7.900000e-05 |
| lag_freq(16).xi      | 2.999634e+00 | +3.660000e-04 | -2.999634e+00 |
| lag_freq(16).b       | 1.999826e+00 | +5.918343e-01 | -8.286340e-01 |
| lag_freq(16).t_max   | 7.998537e+02 | +1.463000e-01 | -1.952123e+02 |
| lag_freq(16).t_shift | 1.071799e+02 | +1.063697e+01 | -1.301723e+01 |
| lag_freq(17).norm    | 9.753598e-01 | +1.575592e-01 | -4.181177e-01 |
| lag_freq(17).h2      | 8.024738e+00 | +5.023318e-01 | -1.624214e+00 |
| lag_freq(17).Gamma1  | 3.144025e+00 | +2.399468e-02 | -9.037012e-03 |
| lag_freq(17).Gamma2  | 1.400079e+00 | +1.017508e+00 | -7.900000e-05 |
| lag_freq(17).xi      | 2.999634e+00 | +3.660000e-04 | -9.983929e-01 |
| lag_freq(17).b       | 1.999826e+00 | +5.790062e-01 | -9.673732e-01 |
| lag_freq(17).t_max   | 7.998537e+02 | +1.463000e-01 | -3.731331e+02 |
| lag_freq(17).t_shift | 1.071799e+02 | +1.725088e+01 | -9.055733e+00 |

* IRAS 13224-3809 individual sim fits on all data

From the complete file =conf_mass_fit_17data.par= copy the first data
set as =sim_fit_OBSID.par

Use =mass-fit-1data.sl= etc for each data set

Freeze all pars including the mass

Insert the nearest lag file according to the data fit

** 0110890101

#+BEGIN_EXAMPLE
 Parameters[Variable] = 16[0]
            Data bins = 14
           Chi-square = 8.325641
   Reduced chi-square = 0.5946887
isis> plot_data({1}, popt);
isis> list_par;
sds(1)*lag_freq(1)
 idx  param             tie-to  freeze         value         min         max
  1  sds(1).dataset         0     1                1           0           0
  2  lag_freq(1).norm       0     1       0.07313036           0          10
  3  lag_freq(1).log_mass   0     1         6.298605         5.5           8
  4  lag_freq(1).i          0     1               64          64          64
  5  lag_freq(1).a          0     1            0.998       0.998       0.998
  6  lag_freq(1).h1         0     1                2           2           2
  7  lag_freq(1).h2         0     1         9.354387           3          20
  8  lag_freq(1).Gamma1     0     1         2.988228         1.8       3.299
  9  lag_freq(1).Gamma2     0     1         1.406009         1.4         3.2
 10  lag_freq(1).Fe         0     1                1           1           1
 11  lag_freq(1).xi         0     1         2.997138           0           3
 12  lag_freq(1).p          0     1                0           0           0
 13  lag_freq(1).b          0     1         2.999641           1           3
 14  lag_freq(1).q2         0     1              0.5         0.5         0.5
 15  lag_freq(1).t_max      0     1         190.6654          50         800
 16  lag_freq(1).t_shift    0     1         45.00933          10         150

Errors are

| lag_freq(1).norm     | 7.313036e-02 | +1.660890e-01 | -7.313036e-02 |
| lag_freq(1).log_mass | 6.298605e+00 | +4.496081e-03 | -8.057811e-03 |
| lag_freq(1).h2       | 9.354387e+00 | +1.064561e+01 | -6.354387e+00 |
| lag_freq(1).Gamma1   | 2.988228e+00 | +3.107720e-01 | -1.188228e+00 |
| lag_freq(1).Gamma2   | 1.406009e+00 | +1.793991e+00 | -6.009000e-03 |
| lag_freq(1).xi       | 2.997138e+00 | +2.862000e-03 | -2.997138e+00 |
| lag_freq(1).b        | 2.999641e+00 | +3.590000e-04 | -1.999641e+00 |
| lag_freq(1).t_max    | 1.906654e+02 | +6.093346e+02 | -1.406654e+02 |
| lag_freq(1).t_shift  | 4.500933e+01 | +4.498391e+01 | -3.500933e+01 |

#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_sim_fit_0110890101.gif

pdf at

http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_sim_fit_0110890101.pdf

** 0110890101 EMCEE

PATH
=/data/typhon1/reverb/table-model-ecm-fits/IRAS13224-3809/fit-tm-0110890101.sl=


#+BEGIN_EXAMPLE

load_par("sim_fit_0110890101.par");

lag_freq(1)
 idx  param              tie-to  freeze         value         min         max
  1  lag_freq(1).norm        0     0       0.07313036           0          10
  2  lag_freq(1).log_mass    0     1         6.298605         5.5           7
  3  lag_freq(1).i           0     1               64          64          64
  4  lag_freq(1).a           0     1            0.998       0.998       0.998
  5  lag_freq(1).h1          0     1                2           2           2
  6  lag_freq(1).h2          0     0         9.354387           3          20
  7  lag_freq(1).Gamma1      0     0         2.988228         1.8       3.299
  8  lag_freq(1).Gamma2      0     0         1.406009         1.4         3.2
  9  lag_freq(1).Fe          0     1                1           1           1
 10  lag_freq(1).xi          0     0         2.997138           0           3
 11  lag_freq(1).p           0     1                0           0           0
 12  lag_freq(1).b           0     0         2.999641           1           3
 13  lag_freq(1).q2          0     1              0.5         0.5         0.5
 14  lag_freq(1).t_max       0     0         190.6654          50         800
 15  lag_freq(1).t_shift     0     0         45.00933          10         150


But provide a rough starting point

lag_freq(1)
 idx  param              tie-to  freeze         value         min         max
  1  lag_freq(1).norm        0     0       0.07313036           0          10
  2  lag_freq(1).log_mass    0     1         6.298605         5.5           7
  3  lag_freq(1).i           0     1               64          64          64
  4  lag_freq(1).a           0     1            0.998       0.998       0.998
  5  lag_freq(1).h1          0     1                2           2           2
  6  lag_freq(1).h2          0     0               12           3          20
  7  lag_freq(1).Gamma1      0     0             2.68         1.8       3.299
  8  lag_freq(1).Gamma2      0     0              1.8         1.4         3.2
  9  lag_freq(1).Fe          0     1                1           1           1
 10  lag_freq(1).xi          0     0              2.0           0           3
 11  lag_freq(1).p           0     1                0           0           0
 12  lag_freq(1).b           0     0              2.0           1           3
 13  lag_freq(1).q2          0     1              0.5         0.5         0.5
 14  lag_freq(1).t_max       0     0              400          50        1500
 15  lag_freq(1).t_shift     0     0               20          10         150




% Run the chain
emcee(200, 10000; output="IRAS_tm_0110890101.fits", serial);

 Using IRAS_tm_0110890101.fits for output file


#+END_EXAMPLE



#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/

pdf at

http://www.star.bris.ac.uk/steff/ecm/

** 0673580101

#+BEGIN_EXAMPLE
 Parameters[Variable] = 16[0]
            Data bins = 14
           Chi-square = 26.78513
   Reduced chi-square = 1.913223
sds(2)*lag_freq(2)
 idx  param             tie-to  freeze         value         min         max
  1  sds(2).dataset         0     1                2           0           0
  2  lag_freq(2).norm       0     1     3.598097e-06           0          10
  3  lag_freq(2).log_mass   0     1         6.298605         5.5           8
  4  lag_freq(2).i          0     1               64          64          64
  5  lag_freq(2).a          0     1            0.998       0.998       0.998
  6  lag_freq(2).h1         0     1                2           2           2
  7  lag_freq(2).h2         0     1         19.99644           3          20
  8  lag_freq(2).Gamma1     0     1         2.995086         1.8       3.299
  9  lag_freq(2).Gamma2     0     1         1.403005         1.4         3.2
 10  lag_freq(2).Fe         0     1                1           1           1
 11  lag_freq(2).xi         0     1         2.998569           0           3
 12  lag_freq(2).p          0     1                0           0           0
 13  lag_freq(2).b          0     1         2.999378           1           3
 14  lag_freq(2).q2         0     1              0.5         0.5         0.5
 15  lag_freq(2).t_max      0     1         148.1155          50         800
 16  lag_freq(2).t_shift    0     1         48.22261          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  1.0741e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0673580101-ti      me-lags-fmax.fits

#######   Model did NOT fit with this sim-fit ######


Free all pars except M and fit :


 Parameters[Variable] = 15[8]
            Data bins = 21
           Chi-square = 10.56566
   Reduced chi-square = 0.8127435
lag_freq(2)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(2).norm       0     0        0.2360214           0          10
  2  lag_freq(2).log_mass   0     1         6.298605         5.5           8
  3  lag_freq(2).i          0     1               64          64          64
  4  lag_freq(2).a          0     1            0.998       0.998       0.998
  5  lag_freq(2).h1         0     1                2           2           2
  6  lag_freq(2).h2         0     0               20           3          20
  7  lag_freq(2).Gamma1     0     0          3.10021         1.8       3.299
  8  lag_freq(2).Gamma2     0     0         1.400001         1.4         3.2
  9  lag_freq(2).Fe         0     1                1           1           1
 10  lag_freq(2).xi         0     0         1.999997           0           3
 11  lag_freq(2).p          0     1                0           0           0
 12  lag_freq(2).b          0     0         2.999999           1           3
 13  lag_freq(2).q2         0     1              0.5         0.5         0.5
 14  lag_freq(2).t_max      0     0         799.9994          50         800
 15  lag_freq(2).t_shift    0     0              140          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  1.0741e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0673580101-time-lags-fmax.fits


source("conf_mass_fit_0673580101.sl");

 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 2.991647
   Reduced chi-square = 0.4273782

lag_freq(2)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(2).norm       0     0        0.2798097           0          10
  2  lag_freq(2).log_mass   0     1         6.298605         5.5           8
  3  lag_freq(2).i          0     1               64          64          64
  4  lag_freq(2).a          0     1            0.998       0.998       0.998
  5  lag_freq(2).h1         0     1                2           2           2
  6  lag_freq(2).h2         0     0         19.99994           3          20
  7  lag_freq(2).Gamma1     0     0         3.107843         1.8       3.299
  8  lag_freq(2).Gamma2     0     0         1.400005         1.4         3.2
  9  lag_freq(2).Fe         0     1                1           1           1
 10  lag_freq(2).xi         0     0         2.243191           0           3
 11  lag_freq(2).p          0     1                0           0           0
 12  lag_freq(2).b          0     0         2.999999           1           3
 13  lag_freq(2).q2         0     1              0.5         0.5         0.5
 14  lag_freq(2).t_max      0     0         605.1932          50         800
 15  lag_freq(2).t_shift    0     0         119.9999          10         150


saved as conf_mass_fit_0673580101.par

gedit conf_mass_fit_0673580101.csv

| lag_freq(2).norm    | 2.798097e-01 | +9.720190e+00 | -9.998758e-02 |
| lag_freq(2).h2      | 1.999994e+01 | +6.475451e-05 | -6.058233e-01 |
| lag_freq(2).Gamma1  | 3.107843e+00 | +9.035928e-02 | -5.467353e-01 |
| lag_freq(2).Gamma2  | 1.400005e+00 | +5.350375e-01 | -4.558321e-06 |
| lag_freq(2).xi      | 2.243191e+00 | +7.568094e-01 | -1.773530e+00 |
| lag_freq(2).b       | 2.999999e+00 | +6.269820e-07 | -9.586561e-01 |
| lag_freq(2).t_max   | 6.051932e+02 | +1.948068e+02 | -7.054701e+01 |
| lag_freq(2).t_shift | 1.199999e+02 | +3.000009e+01 | -7.481830e+00 |


Freeze all pars in parfile and then Refit and plot:


#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_sim_fit_0673580101.gif

pdf at

http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_sim_fit_0673580101.pdf

** 0673580201

#+BEGIN_EXAMPLE
 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 4.637089
   Reduced chi-square = 0.6624414

isis> list_par;
lag_freq(3)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(3).norm       0     1         1.242174           0          10
  2  lag_freq(3).log_mass   0     1         6.298605         5.5           8
  3  lag_freq(3).i          0     1               64          64          64
  4  lag_freq(3).a          0     1            0.998       0.998       0.998
  5  lag_freq(3).h1         0     1                2           2           2
  6  lag_freq(3).h2         0     1         6.106437           3          20
  7  lag_freq(3).Gamma1     0     1         2.988228         1.8       3.299
  8  lag_freq(3).Gamma2     0     1         1.400238         1.4         3.2
  9  lag_freq(3).Fe         0     1                1           1           1
 10  lag_freq(3).xi         0     1         2.999821           0           3
 11  lag_freq(3).p          0     1                0           0           0
 12  lag_freq(3).b          0     1         1.999686           1           3
 13  lag_freq(3).q2         0     1              0.5         0.5         0.5
 14  lag_freq(3).t_max      0     1         608.4534          50         800
 15  lag_freq(3).t_shift    0     1         10.00029          10         150

| lag_freq(3).norm     | 1.242174e+00 | +7.456776e-01 | -4.170013e-01 |
| lag_freq(3).h2       | 6.106437e+00 | +4.042463e-01 | -9.649492e-01 |
| lag_freq(3).Gamma1   | 2.988228e+00 | +1.493946e-01 | -5.115996e-01 |
| lag_freq(3).Gamma2   | 1.400238e+00 | +5.357671e-01 | -2.380000e-04 |
| lag_freq(3).xi       | 2.999821e+00 | +1.790000e-04 | -1.569060e+00 |
| lag_freq(3).b        | 1.999686e+00 | +4.610922e-01 | -4.897944e-01 |
| lag_freq(3).t_max    | 6.084534e+02 | +1.915466e+02 | -2.239495e+02 |
| lag_freq(3).t_shift  | 1.000029e+01 | +2.753194e+00 | -2.900000e-04 |

#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_sim_fit_0673580201.gif

pdf at

http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_sim_fit_0673580201.pdf

** 0673580301

#+BEGIN_EXAMPLE
 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 19.27501
   Reduced chi-square = 2.753572

isis> list_par;
lag_freq(4)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(4).norm       0     1        0.5198961           0          10
  2  lag_freq(4).log_mass   0     1         6.298605         5.5           8
  3  lag_freq(4).i          0     1               64          64          64
  4  lag_freq(4).a          0     1            0.998       0.998       0.998
  5  lag_freq(4).h1         0     1                2           2           2
  6  lag_freq(4).h2         0     1         14.64054           3          20
  7  lag_freq(4).Gamma1     0     1         1.800047         1.8       3.299
  8  lag_freq(4).Gamma2     0     1         3.006783         1.4         3.2
  9  lag_freq(4).Fe         0     1                1           1           1
 10  lag_freq(4).xi         0     1         0.969477           0           3
 11  lag_freq(4).p          0     1                0           0           0
 12  lag_freq(4).b          0     1         2.999921           1           3
 13  lag_freq(4).q2         0     1              0.5         0.5         0.5
 14  lag_freq(4).t_max      0     1         109.2019          50         800
 15  lag_freq(4).t_shift    0     1         16.94443          10         150

| lag_freq(4).norm     | 5.198961e-01 | +2.508474e-01 | -1.509013e-01 |
| lag_freq(4).h2       | 1.464054e+01 | +5.359460e+00 | -5.322333e+00 |
| lag_freq(4).Gamma1   | 1.800047e+00 | +6.082928e-01 | -4.700000e-05 |
| lag_freq(4).Gamma2   | 3.006783e+00 | +2.705670e-02 | -7.088540e-01 |
| lag_freq(4).xi       | 9.694770e-01 | +2.030523e+00 | -9.694770e-01 |
| lag_freq(4).b        | 2.999921e+00 | +7.900000e-05 | -6.074366e-01 |
| lag_freq(4).t_max    | 1.092019e+02 | +7.006718e+01 | -2.374033e+01 |
| lag_freq(4).t_shift  | 1.694443e+01 | +3.646070e+00 | -3.931675e+00 |


Can this fit be improved?

Fit again using model freepars but keep mass fixed at 6.298605

-- No better fit found at this mass --


#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_sim_fit_0673580301.gif

pdf at

http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_sim_fit_0673580301.pdf

** 0673580401

#+BEGIN_EXAMPLE
 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 15.73866
   Reduced chi-square = 2.24838
lag_freq(5)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(5).norm       0     1        0.3483333           0          10
  2  lag_freq(5).log_mass   0     1         6.298605         5.5           8
  3  lag_freq(5).i          0     1               64          64          64
  4  lag_freq(5).a          0     1            0.998       0.998       0.998
  5  lag_freq(5).h1         0     1                2           2           2
  6  lag_freq(5).h2         0     1         19.99965           3          20
  7  lag_freq(5).Gamma1     0     1          1.95219         1.8       3.299
  8  lag_freq(5).Gamma2     0     1         2.996969         1.4         3.2
  9  lag_freq(5).Fe         0     1                1           1           1
 10  lag_freq(5).xi         0     1       0.01514808           0           3
 11  lag_freq(5).p          0     1                0           0           0
 12  lag_freq(5).b          0     1         1.000061           1           3
 13  lag_freq(5).q2         0     1              0.5         0.5         0.5
 14  lag_freq(5).t_max      0     1         378.8791          50         800
 15  lag_freq(5).t_shift    0     1         10.00055          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -9.2308e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0673580401-time-lags-fmax.fits

| lag_freq(5).norm     | 3.483333e-01 | +1.269885e-01 | -1.007428e-01 |
| lag_freq(5).h2       | 1.999965e+01 | +3.500000e-04 | -3.726945e+00 |
| lag_freq(5).Gamma1   | 1.952190e+00 | +1.901695e-01 | -1.521900e-01 |
| lag_freq(5).Gamma2   | 2.996969e+00 | +3.215238e-02 | -1.736498e-01 |
| lag_freq(5).xi       | 1.514808e-02 | +2.984852e+00 | -1.514808e-02 |
| lag_freq(5).b        | 1.000061e+00 | +7.025906e-01 | -6.100000e-05 |
| lag_freq(5).t_max    | 3.788791e+02 | +2.712635e+02 | -2.242172e+02 |
| lag_freq(5).t_shift  | 1.000055e+01 | +1.560955e+00 | -5.500000e-04 |


Can this fit be improved?

Fit again using model freepars but keep mass fixed at 6.298605

-- No better fit found at this mass --


#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_sim_fit_0673580401.gif

pdf at

http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_sim_fit_0673580401.pdf

** 0780560101

#+BEGIN_EXAMPLE

Parameters[Variable] = 15[8]
            Data bins = 7
           Chi-square = 2.754625
lag_freq(6)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(6).norm       0     0         1.713637           0          10
  2  lag_freq(6).log_mass   0     1         6.298605         5.5           8
  3  lag_freq(6).i          0     1               64          64          64
  4  lag_freq(6).a          0     1            0.998       0.998       0.998
  5  lag_freq(6).h1         0     1                2           2           2
  6  lag_freq(6).h2         0     0         14.99999           3          20
  7  lag_freq(6).Gamma1     0     0          3.09389         1.8       3.299
  8  lag_freq(6).Gamma2     0     0         1.702076         1.4         3.2
  9  lag_freq(6).Fe         0     1                1           1           1
 10  lag_freq(6).xi         0     0         2.999996           0           3
 11  lag_freq(6).p          0     1                0           0           0
 12  lag_freq(6).b          0     0         2.665816           1           3
 13  lag_freq(6).q2         0     1              0.5         0.5         0.5
 14  lag_freq(6).t_max      0     0         516.0388          50         800
 15  lag_freq(6).t_shift    0     0         19.99998          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  9.8449e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0780560101-time-lags-fmax.fits

source("conf_mass_fit_0780560101.sl");

 Parameters[Variable] = 15[8]
            Data bins = 7
           Chi-square = 1.222218
lag_freq(6)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(6).norm       0     0         4.538556           0          10
  2  lag_freq(6).log_mass   0     1         6.298605         5.5           8
  3  lag_freq(6).i          0     1               64          64          64
  4  lag_freq(6).a          0     1            0.998       0.998       0.998
  5  lag_freq(6).h1         0     1                2           2           2
  6  lag_freq(6).h2         0     0               20           3          20
  7  lag_freq(6).Gamma1     0     0         3.155197         1.8       3.299
  8  lag_freq(6).Gamma2     0     0         2.190571         1.4         3.2
  9  lag_freq(6).Fe         0     1                1           1           1
 10  lag_freq(6).xi         0     0         2.999997           0           3
 11  lag_freq(6).p          0     1                0           0           0
 12  lag_freq(6).b          0     0                3           1           3
 13  lag_freq(6).q2         0     1              0.5         0.5         0.5
 14  lag_freq(6).t_max      0     0         663.5191          50         800
 15  lag_freq(6).t_shift    0     0         19.99998          10         150


| lag_freq(6).norm    | 4.538556e+00 | +5.461444e+00 | -3.957849e+00 |
| lag_freq(6).h2      | 2.000000e+01 | +8.547716e-07 | -6.560162e+00 |
| lag_freq(6).Gamma1  | 3.155197e+00 | +3.899585e-02 | -1.067496e+00 |
| lag_freq(6).Gamma2  | 2.190571e+00 | +1.440300e-01 | -7.526769e-01 |
| lag_freq(6).xi      | 2.999997e+00 | +3.041341e-06 | -2.999997e+00 |
| lag_freq(6).b       | 3.000000e+00 | +3.044783e-07 | -1.630020e+00 |
| lag_freq(6).t_max   | 6.635191e+02 | +1.116836e+02 | -2.489371e+02 |
| lag_freq(6).t_shift | 1.999998e+01 | +5.644551e+00 | -2.956030e+00 |

Fix pars and refit

source("sim-fit-0780560101.sl");

 Parameters[Variable] = 15[0]
            Data bins = 14
           Chi-square = 2.444436
   Reduced chi-square = 0.1746026
lag_freq(6)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(6).norm       0     1         4.538556           0          10
  2  lag_freq(6).log_mass   0     1         6.298605         5.5           8
  3  lag_freq(6).i          0     1               64          64          64
  4  lag_freq(6).a          0     1            0.998       0.998       0.998
  5  lag_freq(6).h1         0     1                2           2           2
  6  lag_freq(6).h2         0     1               20           3          20
  7  lag_freq(6).Gamma1     0     1         3.155197         1.8       3.299
  8  lag_freq(6).Gamma2     0     1         2.190571         1.4         3.2
  9  lag_freq(6).Fe         0     1                1           1           1
 10  lag_freq(6).xi         0     1         2.999997           0           3
 11  lag_freq(6).p          0     1                0           0           0
 12  lag_freq(6).b          0     1                3           1           3
 13  lag_freq(6).q2         0     1              0.5         0.5         0.5
 14  lag_freq(6).t_max      0     1         663.5191          50         800
 15  lag_freq(6).t_shift    0     1         19.99998          10         150
Current Spectrum List:


#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_sim_fit_0780560101.gif

pdf at

http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_sim_fit_0780560101.pdf

** 0780561301

#+BEGIN_EXAMPLE
 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 13.77234
   Reduced chi-square = 1.967477
lag_freq(7)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(7).norm       0     1          1.26336           0          10
  2  lag_freq(7).log_mass   0     1         6.298605         5.5           8
  3  lag_freq(7).i          0     1               64          64          64
  4  lag_freq(7).a          0     1            0.998       0.998       0.998
  5  lag_freq(7).h1         0     1                2           2           2
  6  lag_freq(7).h2         0     1          8.66909           3          20
  7  lag_freq(7).Gamma1     0     1         3.102168         1.8       3.299
  8  lag_freq(7).Gamma2     0     1          1.40002         1.4         3.2
  9  lag_freq(7).Fe         0     1                1           1           1
 10  lag_freq(7).xi         0     1         2.999633           0           3
 11  lag_freq(7).p          0     1                0           0           0
 12  lag_freq(7).b          0     1         1.499878           1           3
 13  lag_freq(7).q2         0     1              0.5         0.5         0.5
 14  lag_freq(7).t_max      0     1         799.9906          50         800
 15  lag_freq(7).t_shift    0     1         21.24549          10         150

| lag_freq(7).norm     | 1.263360e+00 | +5.191486e-01 | -2.253311e-01 |
| lag_freq(7).h2       | 8.669090e+00 | +7.090474e-01 | -3.963068e-01 |
| lag_freq(7).Gamma1   | 3.102168e+00 | +1.745571e-02 | -3.897519e-01 |
| lag_freq(7).Gamma2   | 1.400020e+00 | +4.222916e-01 | -2.000000e-05 |
| lag_freq(7).xi       | 2.999633e+00 | +3.670000e-04 | -7.801658e-01 |
| lag_freq(7).b        | 1.499878e+00 | +5.411192e-01 | -2.410932e-01 |
| lag_freq(7).t_max    | 7.999906e+02 | +9.400000e-03 | -1.836134e+02 |
| lag_freq(7).t_shift  | 2.124549e+01 | +2.233005e+00 | -4.897170e+00 |
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_sim_fit_0780561301.gif

pdf at

http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_sim_fit_0780561301.pdf

** 0780561401

#+BEGIN_EXAMPLE
 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 6.733436
   Reduced chi-square = 0.9619194

lag_freq(8)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(8).norm       0     1        0.8238248           0          10
  2  lag_freq(8).log_mass   0     1         6.298605         5.5           8
  3  lag_freq(8).i          0     1               64          64          64
  4  lag_freq(8).a          0     1            0.998       0.998       0.998
  5  lag_freq(8).h1         0     1                2           2           2
  6  lag_freq(8).h2         0     1         10.70688           3          20
  7  lag_freq(8).Gamma1     0     1          1.80002         1.8       3.299
  8  lag_freq(8).Gamma2     0     1         1.885438         1.4         3.2
  9  lag_freq(8).Fe         0     1                1           1           1
 10  lag_freq(8).xi         0     1         2.227108           0           3
 11  lag_freq(8).p          0     1                0           0           0
 12  lag_freq(8).b          0     1         2.999878           1           3
 13  lag_freq(8).q2         0     1              0.5         0.5         0.5
 14  lag_freq(8).t_max      0     1         277.1239          50         800
 15  lag_freq(8).t_shift    0     1         98.89029          10         150

| lag_freq(8).norm     | 8.238248e-01 | +3.557225e-01 | -2.670406e-01 |
| lag_freq(8).h2       | 1.070688e+01 | +8.245187e-01 | -3.045483e+00 |
| lag_freq(8).Gamma1   | 1.800020e+00 | +1.041466e-01 | -2.000000e-05 |
| lag_freq(8).Gamma2   | 1.885438e+00 | +1.149259e-01 | -8.877460e-02 |
| lag_freq(8).xi       | 2.227108e+00 | +6.676422e-01 | -2.227108e+00 |
| lag_freq(8).b        | 2.999878e+00 | +1.220000e-04 | -5.874656e-01 |
| lag_freq(8).t_max    | 2.771239e+02 | +1.663771e+02 | -7.710346e+01 |
| lag_freq(8).t_shift  | 9.889029e+01 | +9.402180e+00 | -1.511694e+01 |
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_sim_fit_0780561401.gif

pdf at

http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_sim_fit_0780561401.pdf

** 0780561501

#+BEGIN_EXAMPLE

 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 3.541882
   Reduced chi-square = 0.5059832
lag_freq(9)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(9).norm       0     1        0.2787311           0          10
  2  lag_freq(9).log_mass   0     1         6.298605         5.5           8
  3  lag_freq(9).i          0     1               64          64          64
  4  lag_freq(9).a          0     1            0.998       0.998       0.998
  5  lag_freq(9).h1         0     1                2           2           2
  6  lag_freq(9).h2         0     1         5.124979           3          20
  7  lag_freq(9).Gamma1     0     1         3.102168         1.8       3.299
  8  lag_freq(9).Gamma2     0     1         1.400316         1.4         3.2
  9  lag_freq(9).Fe         0     1                1           1           1
 10  lag_freq(9).xi         0     1        0.7271078           0           3
 11  lag_freq(9).p          0     1                0           0           0
 12  lag_freq(9).b          0     1         2.499969           1           3
 13  lag_freq(9).q2         0     1              0.5         0.5         0.5
 14  lag_freq(9).t_max      0     1         792.8944          50         800
 15  lag_freq(9).t_shift    0     1         120.7394          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  3.2839e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0780561501-time-lags-fmax.fits

| lag_freq(9).norm     | 2.787311e-01 | +1.955046e-01 | -8.366776e-02 |
| lag_freq(9).h2       | 5.124979e+00 | +1.760494e+00 | -2.124979e+00 |
| lag_freq(9).Gamma1   | 3.102168e+00 | +2.936731e-02 | -1.228546e+00 |
| lag_freq(9).Gamma2   | 1.400316e+00 | +1.419247e+00 | -3.160000e-04 |
| lag_freq(9).xi       | 7.271078e-01 | +2.272892e+00 | -7.271078e-01 |
| lag_freq(9).b        | 2.499969e+00 | +5.000310e-01 | -1.499969e+00 |
| lag_freq(9).t_max    | 7.928944e+02 | +7.105600e+00 | -4.223506e+02 |
| lag_freq(9).t_shift  | 1.207394e+02 | +2.926060e+01 | -9.186263e+01 |

#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_sim_fit_0780561501.gif

pdf at

http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_sim_fit_0780561501.pdf

** 0780561601

#+BEGIN_EXAMPLE
 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 9.699274
   Reduced chi-square = 1.385611
lag_freq(10)
 idx  param              tie-to  freeze         value         min         max
  1  lag_freq(10).norm       0     1        0.6826879           0          10
  2  lag_freq(10).log_mass   0     1         6.298605         5.5           8
  3  lag_freq(10).i          0     1               64          64          64
  4  lag_freq(10).a          0     1            0.998       0.998       0.998
  5  lag_freq(10).h1         0     1                2           2           2
  6  lag_freq(10).h2         0     1         7.249958           3          20
  7  lag_freq(10).Gamma1     0     1         3.049943         1.8       3.299
  8  lag_freq(10).Gamma2     0     1         2.975119         1.4         3.2
  9  lag_freq(10).Fe         0     1                1           1           1
 10  lag_freq(10).xi         0     1        0.7499553           0           3
 11  lag_freq(10).p          0     1                0           0           0
 12  lag_freq(10).b          0     1         2.999878           1           3
 13  lag_freq(10).q2         0     1              0.5         0.5         0.5
 14  lag_freq(10).t_max      0     1         200.0154          50         800
 15  lag_freq(10).t_shift    0     1         91.48783          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -1.1123e-01     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0780561601-time-lags-fmax.fits

| lag_freq(10).norm    | 6.826879e-01 | +2.026445e-01 | -1.574491e-01 |
| lag_freq(10).h2      | 7.249958e+00 | +1.530735e+00 | -3.910668e+00 |
| lag_freq(10).Gamma1  | 3.049943e+00 | +7.446937e-02 | -4.616529e-01 |
| lag_freq(10).Gamma2  | 2.975119e+00 | +4.733208e-02 | -2.777973e-01 |
| lag_freq(10).xi      | 7.499553e-01 | +2.250045e+00 | -7.499553e-01 |
| lag_freq(10).b       | 2.999878e+00 | +1.220000e-04 | -5.049781e-01 |
| lag_freq(10).t_max   | 2.000154e+02 | +6.045314e+01 | -1.559418e-02 |
| lag_freq(10).t_shift | 9.148783e+01 | +2.971157e+00 | -7.944806e+00 |


Can the fit be improved?

Thaw pars and run with fixed mass

- - no better fit found  - -

#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_sim_fit_0780561601.gif

pdf at

http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_sim_fit_0780561601.pdf

** 0780561701

#+BEGIN_EXAMPLE
 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 3.474134
   Reduced chi-square = 0.4963048
lag_freq(11)
 idx  param              tie-to  freeze         value         min         max
  1  lag_freq(11).norm       0     1        0.2216119           0          10
  2  lag_freq(11).log_mass   0     1         6.298605         5.5           8
  3  lag_freq(11).i          0     1               64          64          64
  4  lag_freq(11).a          0     1            0.998       0.998       0.998
  5  lag_freq(11).h1         0     1                2           2           2
  6  lag_freq(11).h2         0     1         7.249958           3          20
  7  lag_freq(11).Gamma1     0     1         3.102168         1.8       3.299
  8  lag_freq(11).Gamma2     0     1         1.400316         1.4         3.2
  9  lag_freq(11).Fe         0     1                1           1           1
 10  lag_freq(11).xi         0     1        0.7271078           0           3
 11  lag_freq(11).p          0     1                0           0           0
 12  lag_freq(11).b          0     1         2.937496           1           3
 13  lag_freq(11).q2         0     1              0.5         0.5         0.5
 14  lag_freq(11).t_max      0     1         717.1574          50         800
 15  lag_freq(11).t_shift    0     1         120.7394          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  3.6279e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0780561701-time-lags-fmax.fits

| lag_freq(11).norm    | 2.216119e-01 | +1.677583e-01 | -9.980662e-02 |
| lag_freq(11).h2      | 7.249958e+00 | +2.351083e+00 | -2.486831e+00 |
| lag_freq(11).Gamma1  | 3.102168e+00 | +4.405568e-02 | -1.070265e+00 |
| lag_freq(11).Gamma2  | 1.400316e+00 | +1.271599e+00 | -3.160000e-04 |
| lag_freq(11).xi      | 7.271078e-01 | +2.272892e+00 | -7.271078e-01 |
| lag_freq(11).b       | 2.937496e+00 | +6.250400e-02 | -1.937496e+00 |
| lag_freq(11).t_max   | 7.171574e+02 | +8.284260e+01 | -3.530361e+02 |
| lag_freq(11).t_shift | 1.207394e+02 | +2.926060e+01 | -2.894735e+01 |

Explore a better fit - -



#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_sim_fit_0780561701.gif

pdf at

http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_sim_fit_0780561701.pdf

** 0792180101

#+BEGIN_EXAMPLE
 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 17.317
   Reduced chi-square = 2.473857
lag_freq(12)
 idx  param              tie-to  freeze         value         min         max
  1  lag_freq(12).norm       0     1        0.4962282           0          10
  2  lag_freq(12).log_mass   0     1         6.298605         5.5           8
  3  lag_freq(12).i          0     1               64          64          64
  4  lag_freq(12).a          0     1            0.998       0.998       0.998
  5  lag_freq(12).h1         0     1                2           2           2
  6  lag_freq(12).h2         0     1         8.975963           3          20
  7  lag_freq(12).Gamma1     0     1         3.102168         1.8       3.299
  8  lag_freq(12).Gamma2     0     1         1.400079         1.4         3.2
  9  lag_freq(12).Fe         0     1                1           1           1
 10  lag_freq(12).xi         0     1           2.9996           0           3
 11  lag_freq(12).p          0     1                0           0           0
 12  lag_freq(12).b          0     1         1.749985           1           3
 13  lag_freq(12).q2         0     1              0.5         0.5         0.5
 14  lag_freq(12).t_max      0     1         799.9798          50         800
 15  lag_freq(12).t_shift    0     1         149.9964          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  3.7906e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0792180101-time-lags-fmax.fits

| lag_freq(12).norm    | 4.962282e-01 | +1.173666e-01 | -1.669626e-01 |
| lag_freq(12).h2      | 8.975963e+00 | +9.032235e-01 | -1.366225e+00 |
| lag_freq(12).Gamma1  | 3.102168e+00 | +3.292832e-02 | -3.867822e-01 |
| lag_freq(12).Gamma2  | 1.400079e+00 | +5.311121e-01 | -7.900000e-05 |
| lag_freq(12).xi      | 2.999600e+00 | +4.000000e-04 | -7.288654e-01 |
| lag_freq(12).b       | 1.749985e+00 | +9.920916e-01 | -6.395528e-01 |
| lag_freq(12).t_max   | 7.999798e+02 | +2.020000e-02 | -1.447794e+02 |
| lag_freq(12).t_shift | 1.499964e+02 | +3.600000e-03 | -4.496743e+01 |
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_sim_fit_0792180101.gif

pdf at

http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_sim_fit_0792180101.pdf

** 0792180201

#+BEGIN_EXAMPLE
 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 18.11256
   Reduced chi-square = 2.587509
pgxwin_server: Another server is already active.
lag_freq(13)
 idx  param              tie-to  freeze         value         min         max
  1  lag_freq(13).norm       0     1        0.2481141           0          10
  2  lag_freq(13).log_mass   0     1         6.298605         5.5           8
  3  lag_freq(13).i          0     1               64          64          64
  4  lag_freq(13).a          0     1            0.998       0.998       0.998
  5  lag_freq(13).h1         0     1                2           2           2
  6  lag_freq(13).h2         0     1         5.987982           3          20
  7  lag_freq(13).Gamma1     0     1         3.102168         1.8       3.299
  8  lag_freq(13).Gamma2     0     1         1.400079         1.4         3.2
  9  lag_freq(13).Fe         0     1                1           1           1
 10  lag_freq(13).xi         0     1           2.9996           0           3
 11  lag_freq(13).p          0     1                0           0           0
 12  lag_freq(13).b          0     1         2.999652           1           3
 13  lag_freq(13).q2         0     1              0.5         0.5         0.5
 14  lag_freq(13).t_max      0     1          500.327          50         800
 15  lag_freq(13).t_shift    0     1         149.9964          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  1.4370e-01     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0792180201-time-lags-fmax.fits

| lag_freq(13).norm    | 2.481141e-01 | +1.058838e-01 | -8.021325e-02 |
| lag_freq(13).h2      | 5.987982e+00 | +2.638405e+00 | -2.987982e+00 |
| lag_freq(13).Gamma1  | 3.102168e+00 | +3.162480e-02 | -6.728682e-01 |
| lag_freq(13).Gamma2  | 1.400079e+00 | +7.423727e-01 | -7.900000e-05 |
| lag_freq(13).xi      | 2.999600e+00 | +4.000000e-04 | -2.999600e+00 |
| lag_freq(13).b       | 2.999652e+00 | +3.480000e-04 | -6.347455e-01 |
| lag_freq(13).t_max   | 5.003270e+02 | +9.263717e+01 | -3.374718e+01 |
| lag_freq(13).t_shift | 1.499964e+02 | +3.600000e-03 | -2.948448e+01 |


#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_sim_fit_0792180201.gif

pdf at

http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_sim_fit_0792180201.pdf

** 0792180301

#+BEGIN_EXAMPLE
 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 1.661558
   Reduced chi-square = 0.2373654
lag_freq(14)
 idx  param              tie-to  freeze         value         min         max
  1  lag_freq(14).norm       0     1        0.5932696           0          10
  2  lag_freq(14).log_mass   0     1         6.298605         5.5           8
  3  lag_freq(14).i          0     1               64          64          64
  4  lag_freq(14).a          0     1            0.998       0.998       0.998
  5  lag_freq(14).h1         0     1                2           2           2
  6  lag_freq(14).h2         0     1         11.40072           3          20
  7  lag_freq(14).Gamma1     0     1         1.881385         1.8       3.299
  8  lag_freq(14).Gamma2     0     1         1.400079         1.4         3.2
  9  lag_freq(14).Fe         0     1                1           1           1
 10  lag_freq(14).xi         0     1           2.9996           0           3
 11  lag_freq(14).p          0     1                0           0           0
 12  lag_freq(14).b          0     1         2.999652           1           3
 13  lag_freq(14).q2         0     1              0.5         0.5         0.5
 14  lag_freq(14).t_max      0     1          500.327          50         800
 15  lag_freq(14).t_shift    0     1         149.9964          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  -1.6014e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0792180301-time-lags-fmax.fits

| lag_freq(14).norm    | 5.932696e-01 | +1.479404e-01 | -1.597841e-01 |
| lag_freq(14).h2      | 1.140072e+01 | +1.288832e+00 | -9.450848e-01 |
| lag_freq(14).Gamma1  | 1.881385e+00 | +4.075945e-01 | -8.138500e-02 |
| lag_freq(14).Gamma2  | 1.400079e+00 | +2.530501e-01 | -7.900000e-05 |
| lag_freq(14).xi      | 2.999600e+00 | +4.000000e-04 | -2.999600e+00 |
| lag_freq(14).b       | 2.999652e+00 | +3.480000e-04 | -6.055676e-01 |
| lag_freq(14).t_max   | 5.003270e+02 | +1.473832e+02 | -5.691116e+01 |
| lag_freq(14).t_shift | 1.499964e+02 | +3.600000e-03 | -1.144931e+01 |
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_sim_fit_0792180301.gif

pdf at

http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_sim_fit_0792180301.pdf

** 0792180401

#+BEGIN_EXAMPLE
isis> () = eval_counts;
 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 10.14437
   Reduced chi-square = 1.449196

lag_freq(15)
 idx  param              tie-to  freeze         value         min         max
  1  lag_freq(15).norm       0     1         0.740261           0          10
  2  lag_freq(15).log_mass   0     1         6.298605         5.5           8
  3  lag_freq(15).i          0     1               64          64          64
  4  lag_freq(15).a          0     1            0.998       0.998       0.998
  5  lag_freq(15).h1         0     1                2           2           2
  6  lag_freq(15).h2         0     1         7.052896           3          20
  7  lag_freq(15).Gamma1     0     1         3.142876         1.8       3.299
  8  lag_freq(15).Gamma2     0     1         1.400079         1.4         3.2
  9  lag_freq(15).Fe         0     1                1           1           1
 10  lag_freq(15).xi         0     1         2.999634           0           3
 11  lag_freq(15).p          0     1                0           0           0
 12  lag_freq(15).b          0     1         1.999826           1           3
 13  lag_freq(15).q2         0     1              0.5         0.5         0.5
 14  lag_freq(15).t_max      0     1         725.0818          50         800
 15  lag_freq(15).t_shift    0     1         149.9964          10         150
isis> list_data;
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  3.1215e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0792180401-time-lags-fmax.fits

| lag_freq(15).norm    | 7.402610e-01 | +2.789268e-01 | -1.897766e-01 |
| lag_freq(15).h2      | 7.052896e+00 | +7.672870e-01 | -4.052896e+00 |
| lag_freq(15).Gamma1  | 3.142876e+00 | +1.464266e-02 | -2.152671e-02 |
| lag_freq(15).Gamma2  | 1.400079e+00 | +1.065058e+00 | -7.900000e-05 |
| lag_freq(15).xi      | 2.999634e+00 | +3.660000e-04 | -2.999634e+00 |
| lag_freq(15).b       | 1.999826e+00 | +1.000174e+00 | -9.107366e-01 |
| lag_freq(15).t_max   | 7.250818e+02 | +7.491820e+01 | -1.878667e+02 |
| lag_freq(15).t_shift | 1.499964e+02 | +3.600000e-03 | -3.894433e+01 |

#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_sim_fit_0792180401.gif

pdf at

http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_sim_fit_0792180401.pdf

** 0792180501

#+BEGIN_EXAMPLE
 Parameters[Variable] = 15[0]
            Data bins = 7
           Chi-square = 6.953235
   Reduced chi-square = 0.9933193
lag_freq(16)
 idx  param              tie-to  freeze         value         min         max
  1  lag_freq(16).norm       0     1        0.9753598           0          10
  2  lag_freq(16).log_mass   0     1         6.298605         5.5           8
  3  lag_freq(16).i          0     1               64          64          64
  4  lag_freq(16).a          0     1            0.998       0.998       0.998
  5  lag_freq(16).h1         0     1                2           2           2
  6  lag_freq(16).h2         0     1         8.024738           3          20
  7  lag_freq(16).Gamma1     0     1         3.142876         1.8       3.299
  8  lag_freq(16).Gamma2     0     1         1.400079         1.4         3.2
  9  lag_freq(16).Fe         0     1                1           1           1
 10  lag_freq(16).xi         0     1         2.999634           0           3
 11  lag_freq(16).p          0     1                0           0           0
 12  lag_freq(16).b          0     1         1.999826           1           3
 13  lag_freq(16).q2         0     1              0.5         0.5         0.5
 14  lag_freq(16).t_max      0     1         799.8537          50         800
 15  lag_freq(16).t_shift    0     1         107.1799          10         150
Current Spectrum List:
 id    instrument part/m  src    use/nbins   A   R     totcts   exp(ksec)  target
  1       EPIC-PN          0       7/    7   -   1  1.9312e-02     0.001
file:  /data/typhon1/reverb/IRAS13224-3809/IRAS13224-3809-time-lag-fits/IRAS13224-3809-0792180501-time-lags-fmax.fits



| lag_freq(16).norm    | 9.753598e-01 | +1.962093e-01 | -2.782204e-01 |
| lag_freq(16).h2      | 8.024738e+00 | +9.266197e-01 | -1.134994e+00 |
| lag_freq(16).Gamma1  | 3.142876e+00 | +1.629472e-02 | -1.149258e-02 |
| lag_freq(16).Gamma2  | 1.400079e+00 | +5.895629e-01 | -7.900000e-05 |
| lag_freq(16).xi      | 2.999634e+00 | +3.660000e-04 | -2.999634e+00 |
| lag_freq(16).b       | 1.999826e+00 | +5.918343e-01 | -8.286340e-01 |
| lag_freq(16).t_max   | 7.998537e+02 | +1.463000e-01 | -1.952123e+02 |
| lag_freq(16).t_shift | 1.071799e+02 | +1.063697e+01 | -1.301723e+01 |
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_sim_fit_0792180501.gif

pdf at

http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_sim_fit_0792180501.pdf

** 0792180601

#+BEGIN_EXAMPLE
 Parameters[Variable] = 15[0]
            Data bins = 14
           Chi-square = 14.68617
   Reduced chi-square = 1.049012


lag_freq(17)
 idx  param              tie-to  freeze         value         min         max
  1  lag_freq(17).norm       0     1        0.9753598           0          10
  2  lag_freq(17).log_mass   0     1         6.298605         5.5           8
  3  lag_freq(17).i          0     1               64          64          64
  4  lag_freq(17).a          0     1            0.998       0.998       0.998
  5  lag_freq(17).h1         0     1                2           2           2
  6  lag_freq(17).h2         0     1         8.024738           3          20
  7  lag_freq(17).Gamma1     0     1         3.144025         1.8       3.299
  8  lag_freq(17).Gamma2     0     1         1.400079         1.4         3.2
  9  lag_freq(17).Fe         0     1                1           1           1
 10  lag_freq(17).xi         0     1         2.999634           0           3
 11  lag_freq(17).p          0     1                0           0           0
 12  lag_freq(17).b          0     1         1.999826           1           3
 13  lag_freq(17).q2         0     1              0.5         0.5         0.5
 14  lag_freq(17).t_max      0     1         799.8537          50         800
 15  lag_freq(17).t_shift    0     1         107.1799          10         150


| lag_freq(17).norm    | 9.753598e-01 | +1.575592e-01 | -4.181177e-01 |
| lag_freq(17).h2      | 8.024738e+00 | +5.023318e-01 | -1.624214e+00 |
| lag_freq(17).Gamma1  | 3.144025e+00 | +2.399468e-02 | -9.037012e-03 |
| lag_freq(17).Gamma2  | 1.400079e+00 | +1.017508e+00 | -7.900000e-05 |
| lag_freq(17).xi      | 2.999634e+00 | +3.660000e-04 | -9.983929e-01 |
| lag_freq(17).b       | 1.999826e+00 | +5.790062e-01 | -9.673732e-01 |
| lag_freq(17).t_max   | 7.998537e+02 | +1.463000e-01 | -3.731331e+02 |
| lag_freq(17).t_shift | 1.071799e+02 | +1.725088e+01 | -9.055733e+00 |
#+END_EXAMPLE

#+ATTR_ORG: :width 800
#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_sim_fit_0792180601.gif

pdf at

http://www.star.bris.ac.uk/steff/ecm/IRAS13224-3809_sim_fit_0792180601.pdf


** *IRAS Results - individual observation simultaneous fits*

*Mass result*

log$M = 6.298605^{+0.004}_{-0.008}$

$M_{\odot} = 1.99^{+1.01}_{-1.02} \times 10^6$

*Individual observation fits*

Recorded in =/home/steff075/phd_ecm/results-spectral/IRAS_flux_lag_relxill_indobs.ods=

|  IRAS_obs | IRAS_E1_h2 |        + |        - | IRAS_E1_g1 |        + |        - | IRAS_E1_g2 |        + |        - | IRAS_E1_xi |        + |        - | IRAS_E1_b |        + |        - | IRAS_E1_tmax |        + |        - | IRAS_E1_tshift |        + |        - | IRAS_E1_Chi |
| 110890101 |   9.35E+00 | 1.06E+01 | 6.35E+00 |   2.99E+00 | 3.11E-01 | 1.19E+00 |   1.41E+00 | 1.79E+00 | 6.01E-03 |   3.00E+00 | 2.86E-03 | 3.00E+00 |  3.00E+00 | 3.59E-04 | 2.00E+00 |     1.91E+02 | 6.09E+02 | 1.41E+02 |       4.50E+01 | 4.50E+01 | 3.50E+01 |    5.90E-01 |
| 673580101 |   2.00E+01 | 3.56E-03 | 1.70E+01 |   3.11E+00 | 9.04E-02 | 5.47E-01 |   1.40E+00 | 5.35E-01 | 4.56E-06 |   2.24E+00 | 7.57E-01 | 1.77E+00 |  3.00E+00 | 6.27E-07 | 9.59E-01 |     6.05E+02 | 1.95E+02 | 7.05E+01 |       1.20E+02 | 3.00E+00 | 7.48E+00 |    4.30E-01 |
| 673580201 |   6.11E+00 | 4.04E-01 | 9.65E-01 |   2.99E+00 | 1.49E-01 | 5.12E-01 |   1.40E+00 | 5.36E-01 | 2.38E-04 |   3.00E+00 | 1.79E-04 | 1.57E+00 |  2.00E+00 | 4.61E-01 | 4.90E-01 |     6.08E+02 | 1.92E+02 | 2.24E+02 |       1.00E+01 | 2.75E+00 | 2.90E-04 |    6.60E-01 |
| 673580301 |   1.46E+01 | 5.36E+00 | 5.32E+00 |   1.80E+00 | 6.08E-01 | 4.70E-05 |   3.01E+00 | 2.71E-02 | 7.09E-01 |   9.69E-01 | 2.03E+00 | 9.69E-01 |  3.00E+00 | 7.90E-05 | 6.07E-01 |     1.09E+02 | 7.01E+01 | 2.37E+01 |       1.69E+01 | 3.65E+00 | 3.93E+00 |    2.75E+00 |
| 673580401 |   2.00E+01 | 3.50E-04 | 3.73E+00 |   1.95E+00 | 1.90E-01 | 1.52E-01 |   3.00E+00 | 3.22E-02 | 1.74E-01 |   1.51E-02 | 2.98E+00 | 1.51E-02 |  1.00E+00 | 7.03E-01 | 6.10E-05 |     3.79E+02 | 2.71E+02 | 2.24E+02 |       1.00E+01 | 1.56E+00 | 5.50E-04 |    2.25E+00 |
| 780560101 |   2.00E+01 | 8.55E-07 | 6.56E+00 |   3.16E+00 | 3.90E-02 | 1.07E+00 |   2.19E+00 | 1.44E-01 | 7.53E-01 |   3.00E+00 | 3.04E-06 | 3.00E+00 |  3.00E+00 | 3.04E-07 | 1.63E+00 |     6.64E+02 | 1.12E+02 | 2.49E+02 |       2.00E+01 | 5.64E+00 | 2.96E+00 |    1.70E-01 |
| 780561301 |   8.67E+00 | 7.09E-01 | 3.96E-01 |   3.10E+00 | 1.75E-02 | 3.90E-01 |   1.40E+00 | 4.22E-01 | 2.00E-05 |   3.00E+00 | 3.67E-04 | 7.80E-01 |  1.50E+00 | 5.41E-01 | 2.41E-01 |     8.00E+02 | 9.40E-03 | 1.84E+02 |       2.12E+01 | 2.23E+00 | 4.90E+00 |    1.97E+00 |
| 780561401 |   1.07E+01 | 8.25E-01 | 3.05E+00 |   1.80E+00 | 1.04E-01 | 2.00E-05 |   1.89E+00 | 1.15E-01 | 8.88E-02 |   2.23E+00 | 6.68E-01 | 2.23E+00 |  3.00E+00 | 1.22E-04 | 5.87E-01 |     2.77E+02 | 1.66E+02 | 7.71E+01 |       9.89E+01 | 9.40E+00 | 1.51E+01 |    9.60E-01 |
| 780561501 |   5.12E+00 | 1.76E+00 | 2.12E+00 |   3.10E+00 | 2.94E-02 | 1.23E+00 |   1.40E+00 | 1.42E+00 | 3.16E-04 |   7.27E-01 | 2.27E+00 | 7.27E-01 |  2.50E+00 | 5.00E-01 | 1.50E+00 |     7.93E+02 | 7.11E+00 | 4.22E+02 |       1.21E+02 | 2.93E+01 | 9.19E+01 |    5.10E-01 |
| 780561601 |   7.25E+00 | 1.53E+00 | 3.91E+00 |   3.05E+00 | 7.45E-02 | 4.62E-01 |   2.98E+00 | 4.73E-02 | 2.78E-01 |   7.50E-01 | 2.25E+00 | 7.50E-01 |  3.00E+00 | 1.22E-04 | 5.05E-01 |     2.00E+02 | 6.05E+01 | 1.56E-02 |       9.15E+01 | 2.97E+00 | 7.94E+00 |    1.39E+00 |
| 780561701 |   7.25E+00 | 2.35E+00 | 2.49E+00 |   3.10E+00 | 4.41E-02 | 1.07E+00 |   1.40E+00 | 1.27E+00 | 3.16E-04 |   7.27E-01 | 2.27E+00 | 7.27E-01 |  2.94E+00 | 6.25E-02 | 1.94E+00 |     7.17E+02 | 8.28E+01 | 3.53E+02 |       1.21E+02 | 2.93E+01 | 2.89E+01 |    5.00E-01 |
| 792180101 |   8.98E+00 | 9.03E-01 | 1.37E+00 |   3.10E+00 | 3.29E-02 | 3.87E-01 |   1.40E+00 | 5.31E-01 | 7.90E-05 |   3.00E+00 | 4.00E-04 | 7.29E-01 |  1.75E+00 | 9.92E-01 | 6.40E-01 |     8.00E+02 | 2.02E-02 | 1.45E+02 |       1.50E+02 | 3.60E-03 | 4.50E+01 |    2.47E+00 |
| 792180201 |   5.99E+00 | 2.64E+00 | 2.99E+00 |   3.10E+00 | 3.16E-02 | 6.73E-01 |   1.40E+00 | 7.42E-01 | 7.90E-05 |   3.00E+00 | 4.00E-04 | 3.00E+00 |  3.00E+00 | 3.48E-04 | 6.35E-01 |     5.00E+02 | 9.26E+01 | 3.37E+01 |       1.50E+02 | 3.60E-03 | 2.95E+01 |    2.59E+00 |
| 792180301 |   1.14E+01 | 1.29E+00 | 9.45E-01 |   1.88E+00 | 4.08E-01 | 8.14E-02 |   1.40E+00 | 2.53E-01 | 7.90E-05 |   3.00E+00 | 4.00E-04 | 3.00E+00 |  3.00E+00 | 3.48E-04 | 6.06E-01 |     5.00E+02 | 1.47E+02 | 5.69E+01 |       1.50E+02 | 3.60E-03 | 1.14E+01 |    2.40E-01 |
| 792180401 |   7.05E+00 | 7.67E-01 | 4.05E+00 |   3.14E+00 | 1.46E-02 | 2.15E-02 |   1.40E+00 | 1.07E+00 | 7.90E-05 |   3.00E+00 | 3.66E-04 | 3.00E+00 |  2.00E+00 | 1.00E+00 | 9.11E-01 |     7.25E+02 | 7.49E+01 | 1.88E+02 |       1.50E+02 | 3.60E-03 | 3.89E+01 |    1.45E+00 |
| 792180501 |   8.02E+00 | 9.27E-01 | 1.13E+00 |   3.14E+00 | 1.63E-02 | 1.15E-02 |   1.40E+00 | 5.90E-01 | 7.90E-05 |   3.00E+00 | 3.66E-04 | 3.00E+00 |  2.00E+00 | 5.92E-01 | 8.29E-01 |     8.00E+02 | 1.46E-01 | 1.95E+02 |       1.07E+02 | 1.06E+01 | 1.30E+01 |    9.90E-01 |
| 792180601 |   8.02E+00 | 5.02E-01 | 1.62E+00 |   3.14E+00 | 2.40E-02 | 9.04E-03 |   1.40E+00 | 1.02E+00 | 7.90E-05 |   3.00E+00 | 3.66E-04 | 9.98E-01 |  2.00E+00 | 5.79E-01 | 9.67E-01 |     8.00E+02 | 1.46E-01 | 3.73E+02 |       1.07E+02 | 1.73E+01 | 9.06E+00 |    1.05E+00 |

* Results - simultaneous fits V L2-10 First fit where logM ranged 5.5-8.0

PATH = =/home/steff075/phd_ecm/results-spectral/IRAS_flux_lag_relxill_indobs.ods=

VEUSZ = =/home/steff075/phd_ecm/results-spectral/IRAS_L2-10_V_ECM1_indobs.vsz=

#+ATTR_HTML: :width 700
http://www.star.bris.ac.uk/steff/ecm/IRAS_L2-10_V_ECM1_indobs.png


** Exploring Spearman Rank correlation tests on First fits (ECM1)

PATH =
=/home/steff075/phd_ecm/results-spectral/IRAS_flux_lag_relxill_indobs.csv=

PATH =
=/home/steff075/phd_ecm/results-spectral/spearman_ECM1.py=

** ECM fits and basic AGN properties

#+BEGIN_EXAMPLE
.00-.19“very weak”
.20-.39“weak”
.40-.59“moderate”
.60-.79“strong”
.80-1.0“very strong”
#+END_EXAMPLE


| Spearmans | Lag         | and | L2_10:       |  0.390 |
| Spearmans | Lag         | and | Ref_F:       |  0.386 |
| Spearmans | Lag         | and | Plaw_F:      |  0.389 |
| Spearmans | Lag         | and | Gamma_Relx:  | -0.240 |
| Spearmans | Lag         | and | Gamma_Plaw:  |  0.155 |
| Spearmans | Lag         | and | xi:          | -0.240 |
| Spearmans | Lag         | and | Fe:          |  0.166 |
| Spearmans | Lag         | and | RF:          |  0.306 |
| Spearmans | Lag         | and | Cvr:         | -0.432 |
| Spearmans | Lag         | and | nH:          | -0.284 |
| Spearmans | Lag         | and | h2_ecm1:     |  0.556 |
| Spearmans | Lag         | and | g1_ecm1:     | -0.299 |
| Spearmans | Lag         | and | g2_ecm1:     |  0.453 |
| Spearmans | Lag         | and | xi_ecm1:     | -0.331 |
| Spearmans | Lag         | and | b_ecm1:      |  0.102 |
| Spearmans | Lag         | and | tmax_ecm1:   | -0.336 |
| Spearmans | Lag         | and | tshift_ecm1: | -0.122 |

| Spearmans | L2_10       | and | Ref_F:       |  0.963 |
| Spearmans | L2_10       | and | Plaw_F:      |  0.996 |
| Spearmans | L2_10       | and | Gamma_Relx:  | -0.333 |
| Spearmans | L2_10       | and | Gamma_Plaw:  |  0.832 |
| Spearmans | L2_10       | and | xi:          | -0.098 |
| Spearmans | L2_10       | and | Fe:          |  0.132 |
| Spearmans | L2_10       | and | RF:          |  0.000 |
| Spearmans | L2_10       | and | Cvr:         | -0.826 |
| Spearmans | L2_10       | and | nH:          | -0.348 |
| Spearmans | L2_10       | and | h2_ecm1:     | -0.127 |
| Spearmans | L2_10       | and | g1_ecm1:     |  0.346 |
| Spearmans | L2_10       | and | g2_ecm1:     | -0.066 |
| Spearmans | L2_10       | and | xi_ecm1:     |  0.073 |
| Spearmans | L2_10       | and | b_ecm1:      | -0.210 |
| Spearmans | L2_10       | and | tmax_ecm1:   |  0.144 |
| Spearmans | L2_10       | and | tshift_ecm1: | -0.070 |

| Spearmans | h2_ecm1     | and | Ref_F:       | -0.023 |
| Spearmans | h2_ecm1     | and | Plaw_F:      | -0.113 |
| Spearmans | h2_ecm1     | and | Gamma_Relx:  | -0.019 |
| Spearmans | h2_ecm1     | and | Gamma_Plaw:  | -0.178 |
| Spearmans | h2_ecm1     | and | xi:          |  0.021 |
| Spearmans | h2_ecm1     | and | Fe:          |  0.049 |
| Spearmans | h2_ecm1     | and | RF:          |  0.307 |
| Spearmans | h2_ecm1     | and | Cvr:         |  0.055 |
| Spearmans | h2_ecm1     | and | nH:          | -0.039 |
| Spearmans | h2_ecm1     | and | g1_ecm1:     | -0.199 |
| Spearmans | h2_ecm1     | and | g2_ecm1:     |  0.525 |
| Spearmans | h2_ecm1     | and | xi_ecm1:     | -0.086 |
| Spearmans | h2_ecm1     | and | b_ecm1:      |  0.193 |
| Spearmans | h2_ecm1     | and | tmax_ecm1:   | -0.336 |
| Spearmans | h2_ecm1     | and | tshift_ecm1: | -0.366 |

| Spearmans | g1_ecm1     | and | Ref_F:       |  0.294 |
| Spearmans | g1_ecm1     | and | Plaw_F:      |  0.320 |
| Spearmans | g1_ecm1     | and | Gamma_Relx:  |  0.188 |
| Spearmans | g1_ecm1     | and | Gamma_Plaw:  |  0.467 |
| Spearmans | g1_ecm1     | and | xi:          | -0.062 |
| Spearmans | g1_ecm1     | and | Fe:          |  0.324 |
| Spearmans | g1_ecm1     | and | RF:          |  0.182 |
| Spearmans | g1_ecm1     | and | Cvr:         | -0.210 |
| Spearmans | g1_ecm1     | and | nH:          | -0.152 |
| Spearmans | g1_ecm1     | and | h2_ecm1:     | -0.199 |
| Spearmans | g1_ecm1     | and | g2_ecm1:     | -0.466 |
| Spearmans | g1_ecm1     | and | xi_ecm1:     |  0.384 |
| Spearmans | g1_ecm1     | and | b_ecm1:      | -0.226 |
| Spearmans | g1_ecm1     | and | tmax_ecm1:   |  0.716 |
| Spearmans | g1_ecm1     | and | tshift_ecm1: |  0.303 |

| Spearmans | g2_ecm1     | and | Ref_F:       |  0.034 |
| Spearmans | g2_ecm1     | and | Plaw_F:      | -0.052 |
| Spearmans | g2_ecm1     | and | Gamma_Relx:  | -0.131 |
| Spearmans | g2_ecm1     | and | Gamma_Plaw:  | -0.122 |
| Spearmans | g2_ecm1     | and | xi:          |  0.143 |
| Spearmans | g2_ecm1     | and | Fe:          | -0.513 |
| Spearmans | g2_ecm1     | and | RF:          |  0.179 |
| Spearmans | g2_ecm1     | and | Cvr:         |  0.093 |
| Spearmans | g2_ecm1     | and | nH:          | -0.192 |
| Spearmans | g2_ecm1     | and | h2_ecm1:     |  0.525 |
| Spearmans | g2_ecm1     | and | g1_ecm1:     | -0.466 |
| Spearmans | g2_ecm1     | and | xi_ecm1:     | -0.453 |
| Spearmans | g2_ecm1     | and | b_ecm1:      |  0.319 |
| Spearmans | g2_ecm1     | and | tmax_ecm1:   | -0.725 |
| Spearmans | g2_ecm1     | and | tshift_ecm1: | -0.648 |

| Spearmans | xi_ecm1     | and | Ref_F:       |  0.096 |
| Spearmans | xi_ecm1     | and | Plaw_F:      |  0.057 |
| Spearmans | xi_ecm1     | and | Gamma_Relx:  | -0.061 |
| Spearmans | xi_ecm1     | and | Gamma_Plaw:  |  0.167 |
| Spearmans | xi_ecm1     | and | xi:          |  0.023 |
| Spearmans | xi_ecm1     | and | Fe:          |  0.186 |
| Spearmans | xi_ecm1     | and | RF:          | -0.200 |
| Spearmans | xi_ecm1     | and | Cvr:         |  0.010 |
| Spearmans | xi_ecm1     | and | nH:          | -0.211 |
| Spearmans | xi_ecm1     | and | h2_ecm1:     | -0.086 |
| Spearmans | xi_ecm1     | and | g1_ecm1:     |  0.384 |
| Spearmans | xi_ecm1     | and | g2_ecm1:     | -0.453 |
| Spearmans | xi_ecm1     | and | b_ecm1:      | -0.070 |
| Spearmans | xi_ecm1     | and | tmax_ecm1:   |  0.373 |
| Spearmans | xi_ecm1     | and | tshift_ecm1: |  0.204 |

| Spearmans | b_ecm1      | and | Ref_F:       | -0.203 |
| Spearmans | b_ecm1      | and | Plaw_F:      | -0.225 |
| Spearmans | b_ecm1      | and | Gamma_Relx:  |  0.329 |
| Spearmans | b_ecm1      | and | Gamma_Plaw:  | -0.261 |
| Spearmans | b_ecm1      | and | xi:          |  0.453 |
| Spearmans | b_ecm1      | and | Fe:          | -0.064 |
| Spearmans | b_ecm1      | and | RF:          |  0.190 |
| Spearmans | b_ecm1      | and | Cvr:         |  0.355 |
| Spearmans | b_ecm1      | and | nH:          |  0.363 |
| Spearmans | b_ecm1      | and | h2_ecm1:     |  0.193 |
| Spearmans | b_ecm1      | and | g1_ecm1:     | -0.226 |
| Spearmans | b_ecm1      | and | g2_ecm1:     |  0.319 |
| Spearmans | b_ecm1      | and | xi_ecm1:     | -0.070 |
| Spearmans | b_ecm1      | and | tmax_ecm1:   | -0.661 |
| Spearmans | b_ecm1      | and | tshift_ecm1: |  0.096 |

| Spearmans | tmax_ecm1   | and | Ref_F:       |  0.078 |
| Spearmans | tmax_ecm1   | and | Plaw_F:      |  0.131 |
| Spearmans | tmax_ecm1   | and | Gamma_Relx:  |  0.165 |
| Spearmans | tmax_ecm1   | and | Gamma_Plaw:  |  0.286 |
| Spearmans | tmax_ecm1   | and | xi:          | -0.246 |
| Spearmans | tmax_ecm1   | and | Fe:          |  0.361 |
| Spearmans | tmax_ecm1   | and | RF:          |  0.000 |
| Spearmans | tmax_ecm1   | and | Cvr:         | -0.124 |
| Spearmans | tmax_ecm1   | and | nH:          | -0.176 |
| Spearmans | tmax_ecm1   | and | h2_ecm1:     | -0.336 |
| Spearmans | tmax_ecm1   | and | g1_ecm1:     |  0.716 |
| Spearmans | tmax_ecm1   | and | g2_ecm1:     | -0.725 |
| Spearmans | tmax_ecm1   | and | xi_ecm1:     |  0.373 |
| Spearmans | tmax_ecm1   | and | b_ecm1:      | -0.661 |
| Spearmans | tmax_ecm1   | and | tshift_ecm1: |  0.348 |

| Spearmans | tshift_ecm1 | and | Ref_F:       | -0.166 |
| Spearmans | tshift_ecm1 | and | Plaw_F:      | -0.091 |
| Spearmans | tshift_ecm1 | and | Gamma_Relx:  |  0.219 |
| Spearmans | tshift_ecm1 | and | Gamma_Plaw:  | -0.150 |
| Spearmans | tshift_ecm1 | and | xi:          | -0.067 |
| Spearmans | tshift_ecm1 | and | Fe:          |  0.590 |
| Spearmans | tshift_ecm1 | and | RF:          |  0.386 |
| Spearmans | tshift_ecm1 | and | Cvr:         |  0.142 |
| Spearmans | tshift_ecm1 | and | nH:          |  0.059 |
| Spearmans | tshift_ecm1 | and | h2_ecm1:     | -0.366 |
| Spearmans | tshift_ecm1 | and | g1_ecm1:     |  0.303 |
| Spearmans | tshift_ecm1 | and | g2_ecm1:     | -0.648 |
| Spearmans | tshift_ecm1 | and | xi_ecm1:     |  0.204 |
| Spearmans | tshift_ecm1 | and | b_ecm1:      |  0.096 |
| Spearmans | tshift_ecm1 | and | tmax_ecm1:   |  0.348 |

** Spearman rank Moderate to strong corellations

#+BEGIN_EXAMPLE
.00-.19“very weak”
.20-.39“weak”
.40-.59“moderate”
.60-.79“strong”
.80-1.0“very strong”
#+END_EXAMPLE

Moderate - strong correlations (>.40) found between

| Lag - Cvr     | SpearmanrResult(correlation=-0.4319021656082865 | pvalue=0.08340933862791564)  |
| Lag - h2_ecm1 | SpearmanrResult(correlation=0.555969344811282   | pvalue=0.020481135099672428) |
| Lag - g2_ecm1 | SpearmanrResult(correlation=0.45312588628861783 | pvalue=0.06775638535177562)  |


| L2_10 - Ref_F      | SpearmanrResult(correlation=0.9625998130564097  | pvalue=6.51633966694767e-10)   |
| L2_10 - Plaw_F     | SpearmanrResult(correlation=0.99570834165835    | pvalue=6.363931936172397e-17)  |
| L2_10 - Gamma_Plaw | SpearmanrResult(correlation=0.8316978421212846  | pvalue=3.4912430328966594e-05) |
| L2_10 - Cvr        | SpearmanrResult(correlation=-0.8257674927681159 | pvalue=4.444707192842008e-05)  |


| h2_ecm1 - g2_ecm1 | SpearmanrResult(correlation=0.5253239790418237 | pvalue=0.030349525575553957) |


| g1_ecm1 - Gamma_Plaw | SpearmanrResult(correlation=0.46696038883297253 | pvalue=0.058791624010789884) |
| g1_ecm1 - g2_ecm1    | SpearmanrResult(correlation=-0.4663514192636886 | pvalue=0.05916662363093624)  |
| g1_ecm1 - tmax_ecm1  | SpearmanrResult(correlation=0.7160191247855962  | pvalue=0.001226021225033345) |


| g2_ecm1 - Fe          | SpearmanrResult(correlation=-0.5134228187919464  | pvalue=0.03503821988780533)   |
| g2_ecm1 - h2_ecm1     | SpearmanrResult(correlation=0.5253239790418236   | pvalue=0.030349525575553985)  |
| g2_ecm1 - xi_ecm1     | SpearmanrResult(correlation=-0.45307416645595383 | pvalue=0.06779168188735703)   |
| g2_ecm1 - tmax_ecm1   | SpearmanrResult(correlation=-0.7247406932769532  | pvalue=0.0009979848189088224) |
| g2_ecm1 - tshift_ecm1 | SpearmanrResult(correlation=-0.6475854933316029  | pvalue=0.004944481048392249)  |


| b_ecm1 - xi           | SpearmanrResult(correlation=0.4533833486261615  | pvalue=0.06758087976007977)   |
| b_ecm1 - tmax_ecm1    | SpearmanrResult(correlation=-0.6610951902229746 | pvalue=0.0038575062757827032) |


| tmax_ecm1 - b_ecm1    | SpearmanrResult(correlation=-0.6610951902229746 | pvalue=0.0038575062757827032) |
| tmax_ecm1 - g1_ecm1   | SpearmanrResult(correlation=0.7160191247855962  | pvalue=0.001226021225033345)  |
| tmax_ecm1 - g2_ecm1   | SpearmanrResult(correlation=-0.7247406932769532 | pvalue=0.0009979848189088224) |
| tmax_ecm1 - xi_ecm1   | SpearmanrResult(correlation=0.37325801802131486 | pvalue=0.14002152088414505)   |


| tshift_ecm1 - Fe      | SpearmanrResult(correlation=0.589765359998424   | pvalue=0.012709369570523581)  |
| tshift_ecm1 - g2_ecm1 | SpearmanrResult(correlation=-0.6475854933316029 | pvalue=0.004944481048392249)  |


** Spectral fits and ECM properties


| h2_ecm1 - Gamma_Relx     | SpearmanrResult(correlation=-0.0191358024691358   | pvalue=0.9418894521331052)   |
| h2_ecm1 - xi             | SpearmanrResult(correlation=0.02091035146414114   | pvalue=0.9365103716783775)   |
| h2_ecm1 - Fe             | SpearmanrResult(correlation=0.048934288458690425  | pvalue=0.8520496814274638)   |
| h2_ecm1 - RF             | SpearmanrResult(correlation=0.30731814857642953   | pvalue=0.23017843510785177)  |
| h2_ecm1 - inc            | SpearmanrResult(correlation=-0.38991655377251416  | pvalue=0.1218150733424089)   |

| g1_ecm1 - Gamma_Relx     | SpearmanrResult(correlation=0.1881396989881851    | pvalue=0.4695997572488857)   |
| g1_ecm1 - xi             | SpearmanrResult(correlation=-0.062274662037571676 | pvalue=0.8123178445388005)   |
| g1_ecm1 - Fe             | SpearmanrResult(correlation=0.32353129711418394   | pvalue=0.20524387009705267)  |
| g1_ecm1 - RF             | SpearmanrResult(correlation=0.1815239636166217    | pvalue=0.48563959291404624)  |
| g1_ecm1 - inc            | SpearmanrResult(correlation=0.07223860796358314   | pvalue=0.7829167455736485)   |

| g2_ecm1 - Gamma_Relx     | SpearmanrResult(correlation=-0.13097118381590672  | pvalue=0.6163407759911422)   |
| g2_ecm1 - xi             | SpearmanrResult(correlation=0.14339426781285375   | pvalue=0.5829733992440121)   |
| g2_ecm1 - Fe             | SpearmanrResult(correlation=-0.5134228187919464   | pvalue=0.03503821988780533)  |
| g2_ecm1 - RF             | SpearmanrResult(correlation=0.1791338219725595    | pvalue=0.491498989163055)    |
| g2_ecm1 - inc            | SpearmanrResult(correlation=-0.0229430828500566   | pvalue=0.9303518811339727)   |

| xi_ecm1 - Gamma_Relx     | SpearmanrResult(correlation=-0.06063920357694635  | pvalue=0.817167484430096)    |
| xi_ecm1 - xi             | SpearmanrResult(correlation=0.023342489046196315  | pvalue=0.9291422436999989)   |
| xi_ecm1 - Fe             | SpearmanrResult(correlation=0.1863709337194704    | pvalue=0.47386222610899786)  |
| xi_ecm1 - RF             | SpearmanrResult(correlation=-0.20012015621390297  | pvalue=0.441235973025903)    |
| xi_ecm1 - inc            | SpearmanrResult(correlation=0.002746175181905449  | pvalue=0.9916540856246108)   |

| b_ecm1- Gamma_Relx       | SpearmanrResult(correlation=0.32887198616444274   | pvalue=0.19743192440181695)  |
| b_ecm1 - xi              | SpearmanrResult(correlation=0.4533833486261615    | pvalue=0.06758087976007977)  |
| b_ecm1 - Fe              | SpearmanrResult(correlation=-0.06402617565070177  | pvalue=0.807131213104553)    |
| b_ecm1 - RF              | SpearmanrResult(correlation=0.1898798643376554    | pvalue=0.46542482295492515)  |
| b_ecm1 - inc             | SpearmanrResult(correlation=-0.5758489657838027   | pvalue=0.015560862333544874) |

| tmax_ecm1 - Gamma_Relx   | SpearmanrResult(correlation=0.165325869730688     | pvalue=0.5260012758155517)   |
| tmax_ecm1 - xi           | SpearmanrResult(correlation=-0.24553310552084523  | pvalue=0.3421633709209394)   |
| tmax_ecm1 - Fe           | SpearmanrResult(correlation=0.36092664007816394   | pvalue=0.15464976536811625)  |
| tmax_ecm1 - RF           | SpearmanrResult(correlation=0.0                   | pvalue=1.0)                  |
| tmax_ecm1 - inc          | SpearmanrResult(correlation=0.18013986636202717   | pvalue=0.48902855170986215)  |

| tshift_ecm1 - Gamma_Relx | SpearmanrResult(correlation=0.21946889866599767   | pvalue=0.39735302698087094)  |
| tshift_ecm1 - xi         | SpearmanrResult(correlation=-0.06670999495469307  | pvalue=0.7991985992295694)   |
| tshift_ecm1 - Fe         | SpearmanrResult(correlation=0.589765359998424     | pvalue=0.012709369570523581) |
| tshift_ecm1 - RF         | SpearmanrResult(correlation=0.3858184197923403    | pvalue=0.12613126543007852)  |
| tshift_ecm1 - inc        | SpearmanrResult(correlation=-0.27795831231122115  | pvalue=0.28004205990404424)  |

* *IRAS sim fit plots of correlation*

** H2 versus time lag

PATH =
=/home/steff075/phd_ecm/results-spectral/plot_IRAS_ECM_h2_lag.py=

Importing = =IRAS_flux_lag_relxill_indobs.csv=

#+BEGIN_EXAMPLE
import pandas as pd
from scipy.stats import spearmanr
from scipy import stats
import numpy as np
from pylab import *
import scipy.optimize as optimization
from scipy.optimize import curve_fit
import matplotlib.pyplot as plt

plt.style.use('classic')
plt.rcParams['font.family'] = 'serif'

# Import the spreadsheet
df = pd.read_csv("IRAS_flux_lag_relxill_indobs.csv")

Lag = df.iloc[:, 6]
Lag_err = df.iloc[:, 7]
h2_ecm1 = df.iloc[:, 47]
h2_hierr = df.iloc[:, 49]
h2_loerr = df.iloc[:, 48]

stats.spearmanr(Lag, h2_ecm1, nan_policy='omit')
print('Lag - h2_ecm1', stats.spearmanr(Lag, h2_ecm1))

xdata = Lag
xerr = Lag_err
ydata = h2_ecm1
yerr_hi = h2_hierr
yerr_lo = h2_loerr
asymmetric_y_error = np.array(list(zip(yerr_hi,h2_loerr))).T

m, b = np.polyfit(xdata, ydata, 1) # m = slope, b = intercept
plt.errorbar(xdata, ydata, yerr=asymmetric_y_error, xerr=xerr, fmt='.', markersize=8,ecolor = 'grey')
plt.plot(xdata, m*xdata + b, "k", alpha=0.5, lw=1, color = 'r')
plt.xscale('linear')
plt.yscale('linear')
plt.xlabel(r'Time lag (s)', fontsize=15)
plt.ylabel(r'$H_2 (r_g)$', fontsize=15)
plt.show(block=False)

#plt.show()
plt.savefig('IRAS_ECM_h2_lag.png')
plt.savefig('IRAS_ECM_h2_lag.pdf')
plt.close()


## Main Results ####

Lag - h2_ecm1 SpearmanrResult(correlation=0.555969344811282, pvalue=0.020481135099672428)

m (slope) =  0.00794746555976485

b (intercept) =  0.00794746555976485

mean_h2: 10.501

sigma_h2: 4.907

mean_lag: 115.024

sigma_lag: 140.643

#+END_EXAMPLE

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS_ECM_h2_lag.png


pdf at:

http://www.star.bris.ac.uk/steff/ecm/IRAS_ECM_h2_lag.pdf


*Consider the lags < 250s*

PATH = =plot_IRAS_ECM_h2_lag_lessthan250s.py=

#+BEGIN_EXAMPLE
Lag - h2_ecm1 SpearmanrResult(correlation=0.6834149431758018, pvalue=0.004972634730447582)

m (slope) =  0.0614113314826957

b (intercept) =  0.0614113314826957

#+END_EXAMPLE

#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS_ECM_h2_lag_less250.png


pdf at:

http://www.star.bris.ac.uk/steff/ecm/IRAS_ECM_h2_lag_less250.pdf

** $\Gamma_1$ versus $\Gamma_2$

Correlations found:

| g1ecm1 - g2ecm1 | SpearmanrResult(correlation=-0.4663514192636886 | pvalue=0.05916662363093624) |

PATH =
=/home/steff075/phd_ecm/results-spectral/plot_IRAS_ECM_Gamma1_Gamma2.py=

#+BEGIN_EXAMPLE
g1_ecm1 - g2_ecm1 SpearmanrResult(correlation=-0.4663514192636886, pvalue=0.05916662363093624)
g1 mean: 2.803
g1 sigma: 0.527
g2 mean: 1.758
g2 sigma: 0.611
m (slope) =  -0.5917499365207394
b (intercept) =  3.4162873220713674

#+END_EXAMPLE


#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS_ECM_g1_g2.png


pdf at:

http://www.star.bris.ac.uk/steff/ecm/IRAS_ECM_g1_g2.pdf

** $\Gamma_1$ versus $T_{\text{max}}$

Correlations found:


| g1ecm1 - tmaxecm1 | SpearmanrResult(correlation=0.7160191247855962  | pvalue=0.001226021225033345)  |
| g2ecm1 - tmaxecm1 | SpearmanrResult(correlation=-0.7247406932769532 | pvalue=0.0009979848189088224) |

PATH =
=/home/steff075/phd_ecm/results-spectral/plot_IRAS_ECM_Gamma1_Tmax.py=

#+BEGIN_EXAMPLE
g1_ecm1 - tmax_ecm1 SpearmanrResult(correlation=0.7160191247855962, pvalue=0.001226021225033345)
g1 mean: 2.803
g1 sigma: 0.527
tmax mean: 556.941
tmax sigma: 235.242
m (slope) =  276.3258452699234
b (intercept) =  -217.5839133595207
#+END_EXAMPLE


#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS_ECM_g1_tmax.png


pdf at:

http://www.star.bris.ac.uk/steff/ecm/IRAS_ECM_g1_tmax.pdf

** $\Gamma_2$ versus $T_{\text{max}}$

Correlations found:


| g1ecm1 - tmaxecm1 | SpearmanrResult(correlation=0.7160191247855962  | pvalue=0.001226021225033345)  |
| g2ecm1 - tmaxecm1 | SpearmanrResult(correlation=-0.7247406932769532 | pvalue=0.0009979848189088224) |

PATH =
=/home/steff075/phd_ecm/results-spectral/plot_IRAS_ECM_Gamma2_Tmax.py=

#+BEGIN_EXAMPLE
g2_ecm1 - tmax_ecm1 SpearmanrResult(correlation=-0.7247406932769532, pvalue=0.0009979848189088224)
g2 mean: 1.758
g2 sigma: 0.611
tmax mean: 556.941
tmax sigma: 235.242
m (slope) =  -256.5531520762646
b (intercept) =  1007.8710696493401

#+END_EXAMPLE


#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS_ECM_g2_tmax.png


pdf at:

http://www.star.bris.ac.uk/steff/ecm/IRAS_ECM_g2_tmax.pdf

** $\Gamma_2$ versus $T_{\text{shift}}$

Correlations found:

|g2ecm1 - tshiftecm1 |	SpearmanrResult(correlation=-0.6475854933316029 |pvalue=0.004944481048392249)|

PATH =
=/home/steff075/phd_ecm/results-spectral/plot_IRAS_ECM_Gamma2_Tshift.py=

#+BEGIN_EXAMPLE
g2_ecm1 - tmax_ecm1 SpearmanrResult(correlation=-0.7247406932769532, pvalue=0.0009979848189088224)
g2 mean: 1.758
g2 sigma: 0.611
tshift mean: 122.372
tshift sigma: 144.713
m (slope) =  11.665028992716504
b (intercept) =  101.8694431586842
#+END_EXAMPLE


#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS_ECM_g2_tshift.png


pdf at:

http://www.star.bris.ac.uk/steff/ecm/IRAS_ECM_g2_tshift.pdf

** $b$ versus $T_{\text{max}}$

Correlations found:

|g2ecm1 - tshiftecm1 |	SpearmanrResult(correlation=-0.661 |pvalue=0.0038|

PATH =
=/home/steff075/phd_ecm/results-spectral/plot_IRAS_ECM_Gamma2_Tmax.py=

#+BEGIN_EXAMPLE
b_ecm1 - tmax_ecm1 SpearmanrResult(correlation=-0.6610951902229746, pvalue=0.0038575062757827032)
tmax mean: 556.941
tmax sigma: 235.242
b mean: 2.452
b sigma: 0.640

m (slope) =  -164.39134266967002
b (intercept) =  960.0867691705024
#+END_EXAMPLE


#+ATTR_HTML::width 800
http://www.star.bris.ac.uk/steff/ecm/IRAS_ECM_b_tmax.png


pdf at:

http://www.star.bris.ac.uk/steff/ecm/IRAS_ECM_b_tmax.pdf



* *1H0707-495 and IRAS13224-3809*

** ECM Model Correlations found

Moderate tostrong correlations (>.40) found between
*1H0707-495075*
| Lag                | Cvr-Frac $H_2$    $\Gamma_1$     $t_{\text{max}}$                                             |
| L2-10              | $F_{\text{Reflection}}$ $F_{\text{Powerlaw}}$   $\Gamma_{\text{Powerlaw}}$   $t_{\text{max}}$ |
| $\Gamma_1$         | $\xi$   $t_{\text{max}}$                                                                      |
| $\Gamma_2$         | $H_2$ $\xi$                                                                                   |
| $\xi$              | $\xi_{\text{Relxill}}$                                                                        |
| $t_{\text{max}}$   | $RF$   $\Gamma_1$  $Edd_{\text{fraction}}$    Lag  Cvr-Frac   L2-10                           |
| $t_{\text{shift}}$ | $H_2$                                                                                         |


Moderate to strong correlations (>.40) found between
*IRAS13224-3809*
| *Par*            | *Correlates with*                                                          |
| Lag              | Cvr-Frac $H_2$    $\Gamma_2$                                               |
| L2-10            | $F_{\text{Reflection}}$ $F_{\text{Powerlaw}}$   $\Gamma_{\text{Powerlaw}}$ |
| $\Gamma_1$       | $\Gamma_{\text{Powerlaw}}$ $\Gamma_2$                                      |
| $\Gamma_2$       | $Fe$  $H_2$ $\xi$ $t_{\text{max}}$ $t_{\text{shift}}$                      |
| b                | $\xi$        $t_{\text{max}}$                                              |
| $t_{\text{max}}$ | $b$   $\Gamma_1$   $\Gamma_2$     $\xi$                                    |
| tshift           | $Fe$         $\Gamma_2$                                                    |
|                  |                                                                            |

* *MCG 6-30-15*
** *MCG-6-30-15 Initial fits*

Mass is logM 6.30

*** Run codes for $i = 35^\circ$

Note this was conducted in the *GPU partition of BC4*

Load modules

#+BEGIN_EXAMPLE
module load CUDA
module load cURL
#+END_EXAMPLE

*Run code-img*

#+BEGIN_EXAMPLE
./code-img -i35 -a0.998 -r400 -s8192
#+END_EXAMPLE

*Run code-s*

#+BEGIN_EXAMPLE
./code-s -a0.998 -h2.0 -i35 -p1
#+END_EXAMPLE

Now set up to run for all other source heights and run up to 20 as
outlined for above AGN.

*Run code-x*

#+BEGIN_EXAMPLE


#+END_EXAMPLE

*Run blob.c*

#+BEGIN_EXAMPLE


#+END_EXAMPLE

*** Lo - Flux

USE =MCG-6-30-15-lo-flux-lag-freq-fits.sl=

=MCG-6-30-15_lo_flux_best_fit.par=

#+BEGIN_EXAMPLE

sbatch MCG-6-30-15-submit-lag-freq.sh
Submitted batch job 2842369

sacct -j 2842369

python find-MCG-best-fit.py
Best fit is 22.67523 in file MCG-6-30-15_lo_flux_best_fit_03.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.370167e-05           0           1
  2  lag_freq(1).log_mass   0     0                6           6           8
  3  lag_freq(1).i          0     1               35           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.6           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              425           0           0
 15  lag_freq(1).t_shift    0     1              130           0           0


sbatch MCG-6-30-15-submit-lag-freq.sh
Submitted batch job 2846883

sacct -j 2846883

 python find-MCG-best-fit.py
Best fit is 19.63886 in file MCG-6-30-15_lo_flux_best_fit_09.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.558825e-05           0           1
  2  lag_freq(1).log_mass   0     0                6           6           8
  3  lag_freq(1).i          0     1               35           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.8           0           0
  8  lag_freq(1).Gamma2     0     1              1.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              395           0           0
 15  lag_freq(1).t_shift    0     1              130           0           0

python find-MCG-best-fit.py
Best fit is 19.63363 in file MCG-6-30-15_lo_flux_best_fit_09.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0       1.6445e-05           0           1
  2  lag_freq(1).log_mass   0     0                6           6           8
  3  lag_freq(1).i          0     1               35           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.9           0           0
  8  lag_freq(1).Gamma2     0     1              1.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              395           0           0
 15  lag_freq(1).t_shift    0     1              130           0           0




#+END_EXAMPLE

*Create new lags for this fit*

Now use: =MCG-6-30-15-time-lags-lo-flux.fits= & rsp files created 6
Dec 2019

#+BEGIN_EXAMPLE

#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/

>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

Now fix the Mass to 6.30 in the par file:

#+BEGIN_EXAMPLE

#+END_EXAMPLE

#+ATTR_HTML: :width 600

*** Hi - Flux

#+BEGIN_EXAMPLE
sbatch MCG-6-30-15-submit-lag-freq.sh
Submitted batch job 2672104

sacct -j 2672104

python find-best-fit-MCG-6-30-15-hi-flux.py
Best fit is 12.82653 in file MCG-6-30-15_hi_flux_best_fit_32.txt

No improvement  -  Fit frozen parameters above x80:

batch MCG-6-30-15-submit-lag-freq.sh
Submitted batch job 2676115

sacct -j 2676115

python find-best-fit-MCG-6-30-15-hi-flux.py
Best fit is 10.63004 in file MCG-6-30-15_hi_flux_best_fit_64.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     8.012981e-06           0           1
  2  lag_freq(1).log_mass   0     0         6.299622           6           8
  3  lag_freq(1).i          0     1               35           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.9           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              150           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0

No better fit found !
#+END_EXAMPLE


*Create new lags for this fit*

Now use: =MCG-6-30-15-time-lags-hi-flux.fits= & rsp files created 6
Dec 2019

#+BEGIN_EXAMPLE

#+END_EXAMPLE



#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/

>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>.

Now fix the Mass to 6.30 in the par file:

#+BEGIN_EXAMPLE


#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/

*** Combined Lags

*Create new lags for this fit*

Now use =MCG-6-30-15-combined-lag-freq-fits.sl=

use: =MCG-6-30-15-time-lags-combined.fits= & rsp files created 6 Dec 2019

and =MCG-6-30-15_best_fit.par=

#+BEGIN_EXAMPLE
 sbatch MCG-6-30-15-submit-lag-freq.sh
Submitted batch job 2916234

python find-MCG-best-fit.py
Best fit is 2.524465 in file MCG-6-30-15_best_fit_29.txt

 Parameters[Variable] = 15[2]
            Data bins = 7
           Chi-square = 2.524465
   Reduced chi-square = 0.504893
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     9.289223e-06           0           1
  2  lag_freq(1).log_mass   0     0         6.634565           6           8
  3  lag_freq(1).i          0     1               35           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.1           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              125           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/MCG-6-30-15_best_fit_ecm.PNG

** *MCG-6-30-15 New model fits (since June 2020)*

*** Combined variable mass fit

#+BEGIN_EXAMPLE
MCG-comb-fit-error1.sl
sacct -j 3938180

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.5, 2.6, 2.7, 2.8, 2.9, 3.0, 3.1, 3.2, 3.3]; % Gamma1
vals_to_fit[3] = [1.6, 1.8, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9, 3.0, 3.1, 3.2]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.0, 100.0, 125.0, 150.0, 200.0, 220.0, 240.0, 250.0, 280.0, 300.0, 340.0, 350.0, 380.0, 400\
.0, 420.0, 450.0, 480.0, 500.0, 520.0, 540.0, 550.0, 580.0, 600.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10.0, 15.0, 20.0, 25.0, 35.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0, 110.0, 120.0];\
 % t_shift

######

 This many pars will take over 2 hrs to run

######

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.693291e-06           0       0.001
  2  lag_freq(1).log_mass   0     0              6.5           6         6.5
  3  lag_freq(1).i          0     1               35           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.6           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              150           0           0
 15  lag_freq(1).t_shift    0     1               50           0           0

Obsid MCG_comb1
chi^2 = 6.701545e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+2.025813e+00 -0.000000e+00)
Parameter Gamma1 = 2.600000e+00 (+3.682946e-01 -0.000000e+00)
Parameter Gamma2 = 2.000000e+00 (+1.892104e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.500000e+02 (+8.156632e+01 -1.146841e+01)
Parameter t_shift = 5.000000e+01 (+1.333421e+01 -5.333448e+00)

.............................

MCG-comb-fit-error1.sl
Submitted batch job 3938576

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.742583e-06           0       0.001
  2  lag_freq(1).log_mass   0     0         6.433108           6         6.5
  3  lag_freq(1).i          0     1               35           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              220           0           0
 15  lag_freq(1).t_shift    0     1               60           0           0

bsid MCG_comb1
chi^2 = 4.599826e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+1.605048e-01 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.500000e+00 (+1.946990e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.384357e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.200000e+02 (+4.086380e+01 -1.572334e+01)
Parameter t_shift = 6.000000e+01 (+3.335652e+00 -1.573319e+01)

.............................
MCG-comb-fit-error1.sl
Submitted batch job 3938593

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.671407e-06           0       0.001
  2  lag_freq(1).log_mass   0     0         6.432954           6         6.5
  3  lag_freq(1).i          0     1               35           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.4           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                1           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              220           0           0
 15  lag_freq(1).t_shift    0     1               60           0           0


Obsid MCG_comb1
chi^2 = 5.250874e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+9.608152e-01 -0.000000e+00)
Parameter Gamma1 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.700000e+00 (+3.376082e-01 -2.456367e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.200000e+02 (+4.114392e+01 -8.360169e+01)
Parameter t_shift = 6.000000e+01 (+5.326445e+00 -1.580339e+01)

.............................

MCG-comb-fit-error1.sl
Submitted batch job 3938604

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.662452e-06           0       0.001
  2  lag_freq(1).log_mass   0     0         6.434303           6         6.5
  3  lag_freq(1).i          0     1               35           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              220           0           0
 15  lag_freq(1).t_shift    0     1               60           0           0


Obsid MCG_comb1
chi^2 = 4.022929e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.146200e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.700000e+00 (+4.959102e-02 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.528456e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.200000e+02 (+3.379186e+01 --1.893785e+03)
Parameter t_shift = 6.000000e+01 (+9.669825e-02 -1.673189e+01)

.............................

MCG-comb-fit-error1.sl
Submitted batch job 3938632

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.139995e-06           0       0.001
  2  lag_freq(1).log_mass   0     0         6.462815           6         6.5
  3  lag_freq(1).i          0     1               35           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              210           0           0
 15  lag_freq(1).t_shift    0     1               60           0           0


Obsid MCG_comb1
chi^2 = 2.217142e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.075907e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+8.317108e-02 -0.000000e+00)
Parameter Gamma2 = 1.700000e+00 (+5.076413e-02 -2.620971e-01)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+8.901138e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.098862e-01)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.100000e+02 (+2.228597e+01 -4.743970e+00)
Parameter t_shift = 6.000000e+01 (+9.367583e-02 -1.945313e+01)

.............................

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.1, 2.2, 2.3]; % Gamma1
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [110.0, 125.0, 150.0, 200.0, 204.0, 206.0, 210.0, 212.0, 214.0, 220.0, 230.0, 240.0, 250.0, 28\
0.0, 300.0, 340.0, 350.0, 380.0, 400.0, 420.0, 450.0, 500.0, 520.0, 550.0, 600.0]; % t_max (zero doesn't seem t\
o work)
vals_to_fit[10] = [5.0, 10.0, 15.0, 20.0, 25.0, 35.0, 40.0, 50.0, 55.0, 58.0, 60.0, 62.0, 66.0, 70.0, 80.0, 90.\
0, 100.0, 110.0, 120.0]; % t_shift


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.537836e-06           0       0.001
  2  lag_freq(1).log_mass   0     0         6.479364           6         6.5
  3  lag_freq(1).i          0     1               35           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              210           0           0
 15  lag_freq(1).t_shift    0     1               60           0           0

Obsid MCG_comb1
chi^2 = 9.495096e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+2.884346e-01 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.900000e+00 (+2.917342e-02 -5.804686e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.979922e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.100000e+02 (+9.166459e-02 -3.816671e+00)
Parameter t_shift = 6.000000e+01 (+9.166459e-02 -7.213341e+00)

...................................................................

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.1, 2.2, 2.3, 2.4]; % Gamma1
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0, 2.0, 3.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [110.0, 150.0, 200.0, 204.0, 206.0, 208.0, 210.0, 211.0, 212.0, 214.0, 220.0, 230.0, 240.0, 25\
0.0, 280.0, 300.0, 350.0, 380.0, 400.0, 420.0, 500.0, 550.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [5.0, 10.0, 15.0, 20.0, 25.0, 35.0, 40.0, 50.0, 55.0, 58.0, 59.0, 60.0, 61.0, 62.0, 63.0, 66.\
0, 70.0, 80.0, 90.0, 100.0, 110.0, 120.0]; % t_shift





#+END_EXAMPLE

*** Results

Best fit was

#+BEGIN_EXAMPLE

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.537836e-06           0       0.001
  2  lag_freq(1).log_mass   0     0         6.479364           6         6.5
  3  lag_freq(1).i          0     1               35           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              210           0           0
 15  lag_freq(1).t_shift    0     1               60           0           0

Obsid MCG_comb1
chi^2 = 9.495096e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+2.884346e-01 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.900000e+00 (+2.917342e-02 -5.804686e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.979922e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.100000e+02 (+9.166459e-02 -3.816671e+00)
Parameter t_shift = 6.000000e+01 (+9.166459e-02 -7.213341e+00)

        % re-make a postscript plot of the best fit
        variable pid = open_plot(path_to_fits + "/" + obsid + "_best_fit.ps/cps");
        charsize(1.35);
        nice_width;
        _pgsci(1);
        _pgsls(2);
        _pgscf(2);
        _pgmove(-10000, 0);
        _pgdraw(1, 0);
        plot_data(1,popt);
        close_plot(pid);

.......................

convert -rotate "90" MCG_comb1_best_fit.ps MCG_comb_ecm.png

##### Pull into Lyra WWW (from Lyra) #####

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/MCG-6-30-15/MCG_comb_ecm.png    /home/WWW/steff/ecm


#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/MCG_comb_ecm.png


*** Lo Flux

#+BEGIN_EXAMPLE
MCG-loflux-fit-error1.sl
Submitted batch job 3938583

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.710076e-06           0       0.001
  2  lag_freq(1).log_mass   0     0         6.435301           6         6.5
  3  lag_freq(1).i          0     1               35           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              220           0           0
 15  lag_freq(1).t_shift    0     1               60           0           0

Obsid MCG_loflux1
chi^2 = 2.561998e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.206582e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.700000e+00 (+7.241129e-02 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.229766e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.200000e+02 (+4.542030e+01 -1.378503e+01)
Parameter t_shift = 6.000000e+01 (+4.851532e+00 -1.457107e+01)

.............................

MCG-loflux-fit-error1.sl
Submitted batch job 3938599

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.192252e-06           0       0.001
  2  lag_freq(1).log_mass   0     0         6.463349           6         6.5
  3  lag_freq(1).i          0     1               35           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              210           0           0
 15  lag_freq(1).t_shift    0     1               60           0           0



Obsid MCG_loflux1
chi^2 = 1.322981e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.305981e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.700000e+00 (+7.543647e-02 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.100000e+02 (+3.448783e+01 -3.475910e+00)
Parameter t_shift = 6.000000e+01 (+1.365225e-01 -1.738454e+01)

.............................

MCG-loflux-fit-error1.sl
Submitted batch job 3938638

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.301074e-05           0       0.001
  2  lag_freq(1).log_mass   0     0                6           6         6.5
  3  lag_freq(1).i          0     1               35           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.8           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              350           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


Obsid MCG_loflux1
chi^2 = 6.298985e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.968360e-01 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.800000e+00 (+1.059871e-02 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.378393e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.500000e+02 (+6.099109e+00 -7.832028e+00)
Parameter t_shift = 2.000000e+01 (+3.902982e-01 -4.609702e+00)

.............................



lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.582735e-06           0       0.001
  2  lag_freq(1).log_mass   0     0         6.479325           6         6.5
  3  lag_freq(1).i          0     1               35           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              210           0           0
 15  lag_freq(1).t_shift    0     1               60           0           0


Obsid MCG_loflux1
chi^2 = 7.492505e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+8.300376e-01 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.900000e+00 (+3.518489e-02 -3.496529e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.330912e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.100000e+02 (+1.345749e-01 -3.730850e+00)
Parameter t_shift = 6.000000e+01 (+1.345749e-01 -1.914650e+01)

#+END_EXAMPLE

*** Results

Best fit was

#+BEGIN_EXAMPLE


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.582735e-06           0       0.001
  2  lag_freq(1).log_mass   0     0         6.479325           6         6.5
  3  lag_freq(1).i          0     1               35           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              210           0           0
 15  lag_freq(1).t_shift    0     1               60           0           0


Obsid MCG_loflux1
chi^2 = 7.492505e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+8.300376e-01 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.900000e+00 (+3.518489e-02 -3.496529e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.330912e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.100000e+02 (+1.345749e-01 -3.730850e+00)
Parameter t_shift = 6.000000e+01 (+1.345749e-01 -1.914650e+01)



convert -rotate "90" MCG_loflux1_best_fit.ps MCG_loflux_ecm.png

##### Pull into Lyra WWW (from Lyra) #####

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/MCG-6-30-15/MCG_loflux_ecm.png    /home/WWW/steff/ecm
#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/MCG_loflux_ecm.png

*** Hi Flux

#+BEGIN_EXAMPLE

MCG-hiflux-fit-error1.sl
Submitted batch job 3938581

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.387394e-06           0       0.001
  2  lag_freq(1).log_mass   0     0          6.41854           6         6.5
  3  lag_freq(1).i          0     1               35           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              220           0           0
 15  lag_freq(1).t_shift    0     1               60           0           0

Obsid MCG_hiflux1
chi^2 = 2.003124e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.130342e+00 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.600000e+00 (+4.037815e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.200000e+02 (+7.867018e+01 -1.475061e+02)
Parameter t_shift = 6.000000e+01 (+0.000000e+00 -3.455713e+01)

.............................

MCG-hiflux-fit-error1.sl
Submitted batch job 3938602

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.832874e-06           0       0.001
  2  lag_freq(1).log_mass   0     0         6.449897           6         6.5
  3  lag_freq(1).i          0     1               35           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                4           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              210           0           0
 15  lag_freq(1).t_shift    0     1               55           0           0


Obsid MCG_hiflux1
chi^2 = 1.318103e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 4.000000e+00 (+4.027373e-01 -0.000000e+00)
Parameter Gamma1 = 2.200000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.500000e+00 (+3.742974e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.100000e+02 (+1.528760e+02 -1.817236e+00)
Parameter t_shift = 5.500000e+01 (+5.363412e+00 -2.870181e+01)


.............................

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.783155e-06           0       0.001
  2  lag_freq(1).log_mass   0     0         6.460093           6         6.5
  3  lag_freq(1).i          0     1               35           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.1           0           0
  8  lag_freq(1).Gamma2     0     1              1.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              210           0           0
 15  lag_freq(1).t_shift    0     1               55           0           0

Obsid MCG_hiflux1
chi^2 = 5.815923e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+1.745311e-01 -0.000000e+00)
Parameter Gamma1 = 2.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.500000e+00 (+3.034461e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.100000e+02 (+8.607754e+01 -3.307715e+00)
Parameter t_shift = 5.500000e+01 (+5.340909e+00 -2.994150e+01)


#+END_EXAMPLE

*** Results

Best fit was

#+BEGIN_EXAMPLE

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.783155e-06           0       0.001
  2  lag_freq(1).log_mass   0     0         6.460093           6         6.5
  3  lag_freq(1).i          0     1               35           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.1           0           0
  8  lag_freq(1).Gamma2     0     1              1.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              210           0           0
 15  lag_freq(1).t_shift    0     1               55           0           0

Obsid MCG_hiflux1
chi^2 = 5.815923e-01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+1.745311e-01 -0.000000e+00)
Parameter Gamma1 = 2.100000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 1.500000e+00 (+3.034461e-01 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 2.100000e+02 (+8.607754e+01 -3.307715e+00)
Parameter t_shift = 5.500000e+01 (+5.340909e+00 -2.994150e+01)


.......................

convert -rotate "90" MCG_hiflux1_best_fit.ps MCG_hiflux_ecm.png

##### Pull into Lyra WWW (from Lyra) #####

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/MCG-6-30-15/MCG_hiflux_ecm.png    /home/WWW/steff/ecm

#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/MCG_hiflux_ecm.png

* *Mrk 335**
** *Mrk 335 Initial fits*

Mass is logM 7.23

*** Run codes for $i = 45^\circ$

Note this was conducted in the *GPU partition of BC4*

Load modules

#+BEGIN_EXAMPLE
module load CUDA
module load cURL
#+END_EXAMPLE

*Run code-img*

#+BEGIN_EXAMPLE
./code-img -i45 -a0.998 -r400 -s8192
#+END_EXAMPLE

*Run code-s*

#+BEGIN_EXAMPLE
./code-s -a0.998 -h2.0 -i45 -p1
#+END_EXAMPLE

Now set up to run for all other source heights

#+BEGIN_EXAMPLE
sbatch submit-code-s.sh
#+END_EXAMPLE

*Run code-x* via the =submit-lag-files.sh= code before attempting to
fit

*** Combined Lags

#+BEGIN_EXAMPLE
sbatch Mrk335-submit-lag-freq.sh
Submitted batch job 2808772

sacct -j 2808772

python find-Mrk335-best-fit.py
Best fit is 16.83653 in file Mrk335_combined_best_fit_17.txt

lag_freq(1)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.719209e-06           0           1
  2  lag_freq(1).log_mass   0     0         7.201236           6           8
  3  lag_freq(1).i          0     1               45           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.9           0           0
  8  lag_freq(1).Gamma2     0     1              1.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              150           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

Created new lag fits & response files for updated lags!  (5 Dec 2019)

sbatch Mrk335-submit-lag-freq.sh
Submitted batch job 2856486

sacct -j 2856486

 python find-Mrk335-best-fit.py
Best fit is 5.317989 in file Mrk335_combined_best_fit_12.txt

lag_freq(1)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.404051e-06           0           1
  2  lag_freq(1).log_mass   0     0         6.766381           6           8
  3  lag_freq(1).i          0     1               45           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.5           0           0
  8  lag_freq(1).Gamma2     0     1              2.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              190           0           0
 15  lag_freq(1).t_shift    0     1               80           0           0

sbatch Mrk335-submit-lag-freq.sh
Submitted batch job 2872216

 python find-Mrk335-best-fit.py
Best fit is 4.914169 in file Mrk335_combined_best_fit_01.txt

lag_freq(1)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     2.478312e-06           0           1
  2  lag_freq(1).log_mass   0     0         6.743388           6           8
  3  lag_freq(1).i          0     1               45           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              3.1           0           0
  8  lag_freq(1).Gamma2     0     1              2.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              200           0           0
 15  lag_freq(1).t_shift    0     1               87           0           0

sbatch Mrk335-submit-lag-freq.sh
Submitted batch job 2894495

sacct -j 2894495

python find-Mrk335-best-fit.py
Best fit is 3.676963 in file Mrk335_combined_best_fit_01.txt

lag_freq(1)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.412709e-06           0           1
  2  lag_freq(1).log_mass   0     0         6.796935           6           8
  3  lag_freq(1).i          0     1               45           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.7           0           0
  8  lag_freq(1).Gamma2     0     1              2.2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              150           0           0
 15  lag_freq(1).t_shift    0     1               87           0           0


#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk335_best_joint_fit_01.PNG

*** Lo Flux

=Mrk335-time-lags-lo-flux.fits= and =Mrk335-time-lags-lo-flux.rsp=

#+BEGIN_EXAMPLE

sbatch Mrk335-submit-lag-freq.sh
Submitted batch job 2841168

sacct -j 2841168

python find-Mrk335-best-fit.py
Best fit is 9.096856 in file Mrk335_lo_flux_best_fit_11.txt

lag_freq(1)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     7.038397e-05           0           1
  2  lag_freq(1).log_mass   0     0         7.789799           6           8
  3  lag_freq(1).i          0     1               45           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              3.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              100           0           0
 15  lag_freq(1).t_shift    0     1               40           0           0

sbatch Mrk335-submit-lag-freq.sh
Submitted batch job 2846858


sacct -j 2846858

python find-Mrk335-best-fit.py
Best fit is 9.974123 in file Mrk335_lo_flux_best_fit_18.txt


lag_freq(1)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.493468e-06           0           1
  2  lag_freq(1).log_mass   0     0         7.844237           6           8
  3  lag_freq(1).i          0     1               45           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.6           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1               50           0           0
 15  lag_freq(1).t_shift    0     1               38           0           0

#+END_EXAMPLE

Run new lags created 5 Dec 2019

#+BEGIN_EXAMPLE
sbatch Mrk335-submit-lag-freq.sh
Submitted batch job 2918561

sacct -j 2918561

python find-Mrk335-best-fit.py
Best fit is 2.831563 in file Mrk335_lo_flux_best_fit_01.txt

lag_freq(1)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0                0           0           1
  2  lag_freq(1).log_mass   0     0            7.845           6           8
  3  lag_freq(1).i          0     1               45           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.4           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1               50           0           0
 15  lag_freq(1).t_shift    0     1               15           0           0


python find-Mrk335-best-fit.py
Best fit is 2.788072 in file Mrk335_lo_flux_best_fit_02.txt

lag_freq(1)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.476687e-07           0           1
  2  lag_freq(1).log_mass   0     0         7.861352           6           8
  3  lag_freq(1).i          0     1               45           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.4           0           0
  8  lag_freq(1).Gamma2     0     1              1.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1               75           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


sbatch Mrk335-submit-lag-freq.sh
Submitted batch job 2919292

sacct -j 2919292

python find-Mrk335-best-fit.py
Best fit is 2.673038 in file Mrk335_lo_flux_best_fit_00.txt

lag_freq(1)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.045173e-06           0           1
  2  lag_freq(1).log_mass   0     0                8           6           8
  3  lag_freq(1).i          0     1               45           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              3.1           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              300           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0

python find-Mrk335-best-fit.py
Best fit is 2.2744 in file Mrk335_lo_flux_best_fit_03.txt

lag_freq(1)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     3.292708e-06           0           1
  2  lag_freq(1).log_mass   0     0         7.733333           6           8
  3  lag_freq(1).i          0     1               45           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.5           0           0
  8  lag_freq(1).Gamma2     0     1              1.9           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1               50           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0

python find-Mrk335-best-fit.py
Best fit is 1.051625 in file Mrk335_lo_flux_best_fit_02.txt

lag_freq(1)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.644365e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.066358           6           8
  3  lag_freq(1).i          0     1               45           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              3.1           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1               70           0           0
 15  lag_freq(1).t_shift    0     1               18           0           0

python find-Mrk335-best-fit.py
Best fit is 1.047656 in file Mrk335_lo_flux_best_fit_02.txt


lag_freq(1)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.910652e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.046093           6           8
  3  lag_freq(1).i          0     1               45           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              3.1           0           0
  8  lag_freq(1).Gamma2     0     1              2.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1               75           0           0
 15  lag_freq(1).t_shift    0     1               18           0           0

#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk335_best_lo_flux_fit.png

** *Mrk 335 New model fits (since June 2020)*
*** Combined variable mass fit

#+BEGIN_EXAMPLE
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     5.464489e-06           0       0.001
  2  lag_freq(1).log_mass   0     0         6.738539           6           8
  3  lag_freq(1).i          0     1               45           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              150           0           0
 15  lag_freq(1).t_shift    0     1               90           0           0

Obsid Mrk335_comb1
chi^2 = 4.666948e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+4.237073e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -6.064829e-01)
Parameter Gamma2 = 2.500000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.500000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 9.000000e+01 (+0.000000e+00 -3.051303e+01)



...................................................




#+END_EXAMPLE

*** Lo Flux

#+BEGIN_EXAMPLE
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.100474e-06           0       0.001
  2  lag_freq(1).log_mass   0     0          6.93853         6.8         7.8
  3  lag_freq(1).i          0     1               45           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.3           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              100           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0


Obsid Mrk335_loflux1
chi^2 = 1.591602e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.000000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 3.000000e+01 (+0.000000e+00 -0.000000e+00)

#+END_EXAMPLE

*** Hi Flux

#+BEGIN_EXAMPLE
lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.986049e-06           0       0.001
  2  lag_freq(1).log_mass   0     0         6.759648           6           8
  3  lag_freq(1).i          0     1               45           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              150           0           0
 15  lag_freq(1).t_shift    0     1               90           0           0


Obsid Mrk335_hiflux1
chi^2 = 1.918240e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+4.440311e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.400000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.500000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 9.000000e+01 (+0.000000e+00 -0.000000e+00)


...................................................




...................................................




...................................................


#+END_EXAMPLE
*** OBS 0306870101 2006

PATH = =/home/steff075/phd_ecm/Mrk335/lagfreq_single_script.sl=


Lags found

#+BEGIN_EXAMPLE
7.272727e-05,2.272727e-05,3.246800e+02,2.470253e+02
1.388430e-04,4.338843e-05,4.413164e+01,1.088097e+02
2.650639e-04,8.283246e-05,-1.413810e+02,5.630428e+01
5.060310e-04,1.581347e-04,-8.343145e+00,3.475208e+01
9.660592e-04,3.018935e-04,-2.815184e+01,2.481506e+01
1.844295e-03,5.763421e-04,7.264772e+00,9.809402e+00
3.520927e-03,1.100290e-03,-4.903463e+00,3.689522e+00
#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk335_lagfreq_0306870101.gif


check lags

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("Mrk335-time-lags-0306870101.fits");
r=load_rmf("Mrk335-time-lags-0306870101.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

ECM Fitting

Mrk335-time-lags-0306870101.fits & rsp

#+BEGIN_EXAMPLE
Mrk335-0306870101-fit-error.sl
Submitted batch job 4059140



#+END_EXAMPLE


*** OBS 0600540501 2009

PATH = =/home/steff075/phd_ecm/Mrk335/lagfreq_single_script.sl=


Lags found

#+BEGIN_EXAMPLE
7.272727e-05,2.272727e-05,1.725291e+03,3.606506e+02
1.388430e-04,4.338843e-05,2.849755e+00,2.317234e+02
2.650639e-04,8.283246e-05,5.598420e+01,8.996495e+01
5.060310e-04,1.581347e-04,1.372198e+01,6.182149e+01
9.660592e-04,3.018935e-04,3.928077e+01,2.623641e+01
1.844295e-03,5.763421e-04,1.696357e+01,1.076202e+01
3.520927e-03,1.100290e-03,-4.246081e+00,4.342496e+00

#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk335_lagfreq_0600540501.gif


ECM Fitting


#+BEGIN_EXAMPLE

#+END_EXAMPLE


*** OBS 0600540601 2009

PATH = =/home/steff075/phd_ecm/Mrk335/lagfreq_single_script.sl=


Lags found

#+BEGIN_EXAMPLE
7.272727e-05,2.272727e-05,-8.531770e+02,2.035839e+02
1.388430e-04,4.338843e-05,4.106827e+01,1.645540e+02
2.650639e-04,8.283246e-05,6.682276e+01,1.088002e+02
5.060310e-04,1.581347e-04,-7.414501e+01,7.158433e+01
9.660592e-04,3.018935e-04,-2.590329e+01,2.777072e+01
1.844295e-03,5.763421e-04,-8.295297e+00,1.066801e+01
3.520927e-03,1.100290e-03,4.162206e-01,3.851889e+00

#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk335_lagfreq_0600540601.gif

ECM Fitting


#+BEGIN_EXAMPLE

#+END_EXAMPLE

* *Mrk 766*
** *Mrk 766 Initial fits*

Mass is log 6.822

*** Run codes for $i = 38^\circ$

Note this was conducted in the *GPU partition of BC4*

Load modules

#+BEGIN_EXAMPLE
module load CUDA
module load cURL
#+END_EXAMPLE

*Run code-img*

#+BEGIN_EXAMPLE
./code-img -i38 -a0.998 -r400 -s8192
#+END_EXAMPLE

*Run code-s*

#+BEGIN_EXAMPLE
./code-s -a0.998 -h2.0 -i38 -p1
#+END_EXAMPLE

Now set up to run for all other source heights

#+BEGIN_EXAMPLE
emacs submit-code-s.sh

#+END_EXAMPLE

Submit code

#+BEGIN_EXAMPLE
sbatch submit-code-s.sh
#+END_EXAMPLE

Run these all the way to 20$r_g$

*Run code-x* via the =submit-lag-files.sh= code before attempting to
fit

*** OBS 0304030101 (2005)
Soft negative lag of 160 \pm 1.01s at 2.65E-4 Hz

*In Lyra - Generate fits and response for this observation*

Remake the fits and response files with script =GenerateTimeLagFitsFiles.py=
Dont forget to change the name of the fits response files in
=create_spectra_template.py= AND =create_spectra.py= line 28 accordingly. Run fits files to check:
#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("Mrk766-0304030101-time-lags.fits");
r=load_rmf("Mrk766-0304030101-time-lags.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE

Copy to BC4

#+BEGIN_EXAMPLE
mv Mrk766-0304030101-time-lags.fits Mrk766-time-lag-fits
mv Mrk766-0304030101-time-lags.rsp Mrk766-time-lag-fits

cd Mrk766-time-lag-fits

scp  Mrk766-0304030101-time-lags.fits Mrk766-0304030101-time-lags.rsp so14935@bc4login.acrc.bris.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/Mrk766-time-lag-fits
#+END_EXAMPLE

In BC4 use
=/mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation/Mrk766-time-lag-fits/Mrk766-0304030101-time-lags.fits=
and the .rsp

Edit and use =Mrk766-0304030101-lag-freq-fits.sl=

#+BEGIN_EXAMPLE
sbatch 1H0707-submit-lag-freq.sh
Submitted batch job 2522222

sacct -j 2522222

python find-best-fit-Mrk766-0304030101.py
Best fit is 0.3065244 in file Mrk766_0304030101_best_fit_12.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     6.180662e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.277257           6           8
  3  lag_freq(1).i          0     1               38           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1                2           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              550           0           0
 15  lag_freq(1).t_shift    0     1               35           0           0

#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk766_0304030101_ecm.PNG

*** Combined Lags

Use =Mrk766-combined-lag-freq-fits.sl=

=Mrk766-submit-lag-freq.sh=

=find-best-fit-Mrk766-combined.py=

#+BEGIN_EXAMPLE
Lets begin with

sacct -j 2521325

python find-best-fit-Mrk766-combined.py
Best fit is 1.122698 in file Mrk766_comb_best_fit_07.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      1.62514e-05           0           1
  2  lag_freq(1).log_mass   0     0          6.13751           6           8
  3  lag_freq(1).i          0     1               38           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              1.6           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              600           0           0
 15  lag_freq(1).t_shift    0     1               70           0           0


#+END_EXAMPLE

Redo the combined lags as these were shorter obs and down to 8e-5 Hz

#+BEGIN_EXAMPLE

python find-Mrk766-best-fit.py
Best fit is 4.529456 in file Mrk766_combined_best_fit_01.txt

lag_freq(1)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.710899e-06           0           1
  2  lag_freq(1).log_mass   0     1            6.822           5           8
  3  lag_freq(1).i          0     1               38           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.2           0           0
  8  lag_freq(1).Gamma2     0     1              1.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              150           0           0
 15  lag_freq(1).t_shift    0     1               20           0           0


sbatch Mrk766-submit-lag-freq.sh
Submitted batch job 2880902

sacct -j 2880902

python find-Mrk766-best-fit.py
Best fit is 3.392113 in file Mrk766_combined_best_fit_17.txt

lag_freq(1)
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     7.687268e-06           0           1
  2  lag_freq(1).log_mass   0     1            6.822           5           8
  3  lag_freq(1).i          0     1               38           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.1           0           0
  8  lag_freq(1).Gamma2     0     1              1.4           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                2           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              125           0           0
 15  lag_freq(1).t_shift    0     1               15           0           0


#+END_EXAMPLE

#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk766_best_fit_02.png

*** 2000 Lags

    Use =Mrk766-2000-lag-freq-fits.sl=

    =Mrk766-submit-lag-freq.sh=

    =find-best-fit-Mrk766-2000.py=

    #+BEGIN_EXAMPLE

    sacct -j 2525323

    python find-best-fit-Mrk766-2000.py
    Best fit is 80.91905 in file Mrk766_2000_best_fit_24.txt

    This was the best fit after several attempts!
    This particluar lag is very difficult to fit - perhaps try rerunning the lagfreq at a higher frequency!!


    #+END_EXAMPLE

    #+ATTR_ORG: :width 600
    #+ATTR_HTML: :width 600
    http://www.star.bris.ac.uk/steff/ecm/

*** 2005 Lags

Use =Mrk766-2005-lag-freq-fits.sl=

=Mrk766-submit-lag-freq.sh=

=find-best-fit-Mrk766-2005.py=

#+BEGIN_EXAMPLE

sacct -j 2525323

python find-best-fit-Mrk766-2005.py
Best fit is 1.506165 in file Mrk766_2005_best_fit_20.txt

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0      1.23125e-05           0           1
  2  lag_freq(1).log_mass   0     0         6.329614           6           8
  3  lag_freq(1).i          0     1               38           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.9           0           0
  8  lag_freq(1).Gamma2     0     1              2.6           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                2           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              600           0           0
 15  lag_freq(1).t_shift    0     1               35           0           0


#+END_EXAMPLE

#+ATTR_ORG: :width 600
#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/Mrk766_2005_best_fit_20.PNG

* *NGC 5548*
** *NGC 5548 Initial fits*

Mass is logM 7.72

*** Run codes for $i = 47^\circ$

Note this was completed for Mrk766

*** Combined Lags
** *NGC 5548 New model fits (since June 2020)*
*** Combined variable mass fit

#+BEGIN_EXAMPLE


lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.047313e-05           0       0.001
  2  lag_freq(1).log_mass   0     0         7.825733           6           8
  3  lag_freq(1).i          0     1               45           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                7           0           0
  7  lag_freq(1).Gamma1     0     1              2.1           0           0
  8  lag_freq(1).Gamma2     0     1              2.5           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                3           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                1           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              150           0           0
 15  lag_freq(1).t_shift    0     1              120           0           0

Obsid NGC5548_comb1
chi^2 = 1.113517e+01 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 7.000000e+00 (+2.947242e-01 -1.606709e-01)
Parameter Gamma1 = 2.100000e+00 (+2.196075e-01 -0.000000e+00)
Parameter Gamma2 = 2.500000e+00 (+0.000000e+00 -6.679544e-02)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 3.000000e+00 (+0.000000e+00 -7.580503e-01)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.500000e+02 (+1.786078e+01 -0.000000e+00)
Parameter t_shift = 1.200000e+02 (+0.000000e+00 -1.285569e+01)
...................................................

## Convert ps to png and rotate #######

convert -rotate "90" 1 2

display 2

##### Pull into Lyra WWW (from Lyra) #####

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/IRAS13224-3809/IRAS_comb1_best_fit.ps .


#+END_EXAMPLE


#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/

*** Lo Flux

#+BEGIN_EXAMPLE

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     4.783656e-06           0       0.001
  2  lag_freq(1).log_mass   0     0         7.603891           6           8
  3  lag_freq(1).i          0     1               45           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                5           0           0
  7  lag_freq(1).Gamma1     0     1              2.3           0           0
  8  lag_freq(1).Gamma2     0     1              2.7           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              350           0           0
 15  lag_freq(1).t_shift    0     1               30           0           0

Obsid NGC5548_loflux1
chi^2 = 7.873604e-02 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 5.000000e+00 (+3.349515e+00 -0.000000e+00)
Parameter Gamma1 = 2.300000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Gamma2 = 2.700000e+00 (+0.000000e+00 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 3.500000e+02 (+0.000000e+00 -0.000000e+00)
Parameter t_shift = 3.000000e+01 (+0.000000e+00 -0.000000e+00)

## Convert ps to png and rotate #######

convert -rotate "90" 1 2

display 2

##### Pull into Lyra WWW (from Lyra) #####

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/NGC5548/NGC5548_loflux1_best_fit.png .

#+END_EXAMPLE


#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/NGC5548_loflux1_best_fit.png

*** Hi Flux

#+BEGIN_EXAMPLE

lag_freq
 idx  param             tie-to  freeze         value         min         max
  1  lag_freq(1).norm       0     0     1.353527e-05           0       0.001
  2  lag_freq(1).log_mass   0     0          7.12385           6           8
  3  lag_freq(1).i          0     1               45           0           0
  4  lag_freq(1).a          0     1            0.998           0           0
  5  lag_freq(1).h1         0     1                2           0           0
  6  lag_freq(1).h2         0     1                3           0           0
  7  lag_freq(1).Gamma1     0     1              2.8           0           0
  8  lag_freq(1).Gamma2     0     1              2.1           0           0
  9  lag_freq(1).Fe         0     1                1           0           0
 10  lag_freq(1).xi         0     1                0           0           0
 11  lag_freq(1).p          0     1                0           0           0
 12  lag_freq(1).b          0     1                3           0           0
 13  lag_freq(1).q2         0     1              0.5           0           0
 14  lag_freq(1).t_max      0     1              100           0           0
 15  lag_freq(1).t_shift    0     1               10           0           0


Obsid NGC5548_hiflux1
chi^2 = 7.402158e+00 / dof = 1
N.B. dof modified because some frozen parameters are stepped through
Parameter h1 = 2.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter h2 = 3.000000e+00 (+1.975472e+00 -0.000000e+00)
Parameter Gamma1 = 2.800000e+00 (+0.000000e+00 -6.115922e-03)
Parameter Gamma2 = 2.100000e+00 (+9.764316e-02 -0.000000e+00)
Parameter Fe = 1.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter xi = 1.000000e+00 (+4.324393e-01 -0.000000e+00)
Parameter p = 0.000000e+00 (+0.000000e+00 -0.000000e+00)
Parameter b = 3.000000e+00 (+0.000000e+00 -1.169702e+00)
Parameter q2 = 5.000000e-01 (+0.000000e+00 -0.000000e+00)
Parameter t_max = 1.000000e+02 (+9.877359e+01 -0.000000e+00)
Parameter t_shift = 1.000000e+01 (+4.427769e+00 -6.823656e+00)

...................................................

NGC5548-hiflux-fit-error1.sl
Submitted batch job 3947855




...................................................





...................................................




...................................................



 Convert ps to png and rotate #######

convert -rotate "90" 1 2

display 2

##### Pull into Lyra WWW (from Lyra) #####

scp so14935@bc4login.acrc.bristol.ac.uk:/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation/IRAS13224-3809/IRAS_comb1_best_fit.ps .

#+END_EXAMPLE


#+ATTR_HTML: :width 800
http://www.star.bris.ac.uk/steff/ecm/

*** OBS 0089960301 2001

PATH = =/home/steff075/phd_ecm/NGC5548/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
7.272727e-05,2.272727e-05,9.631914e+01,2.019475e+02
1.388430e-04,4.338843e-05,1.106403e+02,1.066068e+02
2.650639e-04,8.283246e-05,-1.973033e+02,9.871722e+01
5.060310e-04,1.581347e-04,-1.838513e+02,6.724591e+01
9.660592e-04,3.018935e-04,5.569731e+00,2.987445e+01
1.844295e-03,5.763421e-04,7.379114e+00,1.301121e+01
3.520927e-03,1.100290e-03,8.062755e+00,4.826287e+00
#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC5548_lagfreq_0089960301.gif

check lags

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC5548-time-lags-0089960301.fits");
r=load_rmf("NGC5548-time-lags-0089960301.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE


ECM Fitting


#+BEGIN_EXAMPLE

#+END_EXAMPLE

*** OBS 0720110801 2013

PATH = =/home/steff075/phd_ecm/NGC5548/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.454545e-04,4.545455e-05,6.069343e+02,5.068137e+02
2.776860e-04,8.677686e-05,-1.567099e+01,1.645573e+02
5.301277e-04,1.656649e-04,3.521268e+01,6.155750e+01
1.012062e-03,3.162694e-04,1.068552e+01,2.493061e+01
1.932118e-03,6.037870e-04,-1.073009e+01,1.294980e+01
3.688590e-03,1.152684e-03,-1.586955e-01,5.037210e+00
7.041853e-03,2.200579e-03,-3.090205e+00,1.851804e+00

#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC5548_lagfreq_0720110801.gif



check lags

#+BEGIN_EXAMPLE
isis
Ignore_PHA_Response_Keywords = 1;
d=load_data("NGC5548-time-lags-0720110801.fits");
r=load_rmf("NGC5548-time-lags-0720110801.rsp");
assign_rmf(1,1);
xlog;
plot_data(d; xlabel="Frequency (Hz)", ylabel="Time lag (s)");
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
#+END_EXAMPLE



ECM Fitting


#+BEGIN_EXAMPLE

#+END_EXAMPLE

*** OBS 0720110901 2013

PATH = =/home/steff075/phd_ecm/NGC5548/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.454545e-04,4.545455e-05,-3.626445e+02,5.098829e+02
2.776860e-04,8.677686e-05,5.741868e+02,1.616317e+02
5.301277e-04,1.656649e-04,1.239051e+01,9.251184e+01
1.012062e-03,3.162694e-04,1.428330e+01,3.228947e+01
1.932118e-03,6.037870e-04,4.817239e+00,1.039943e+01
3.688590e-03,1.152684e-03,-9.333514e-01,4.288221e+00
7.041853e-03,2.200579e-03,9.219651e-01,1.808279e+00

#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC5548_lagfreq_0720110901.gif

ECM Fitting


#+BEGIN_EXAMPLE

#+END_EXAMPLE

*** OBS 0720111001 2013

PATH = =/home/steff075/phd_ecm/NGC5548/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.454545e-04,4.545455e-05,-9.007772e+02,3.956308e+02
2.776860e-04,8.677686e-05,9.145325e+01,1.352273e+02
5.301277e-04,1.656649e-04,-1.383364e+02,6.903083e+01
1.012062e-03,3.162694e-04,-2.448148e+01,2.524391e+01
1.932118e-03,6.037870e-04,1.511059e+01,1.308230e+01
3.688590e-03,1.152684e-03,6.367425e+00,4.650255e+00
7.041853e-03,2.200579e-03,1.898381e+00,1.781210e+00

#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC5548_lagfreq_0720111001.gif

ECM Fitting


#+BEGIN_EXAMPLE

#+END_EXAMPLE


*** OBS 0720111101 2013

PATH = =/home/steff075/phd_ecm/NGC5548/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.454545e-04,4.545455e-05,-3.570893e+02,1.072130e+03
2.776860e-04,8.677686e-05,-1.865259e+02,9.647297e+01
5.301277e-04,1.656649e-04,2.536789e+02,1.284444e+02
1.012062e-03,3.162694e-04,1.197118e+01,4.758873e+01
1.932118e-03,6.037870e-04,-9.698985e+00,1.568299e+01
3.688590e-03,1.152684e-03,6.465185e+00,7.599556e+00
7.041853e-03,2.200579e-03,3.331020e+00,2.781307e+00
#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC5548_lagfreq_0720111101.gif

ECM Fitting


#+BEGIN_EXAMPLE

#+END_EXAMPLE





*** OBS 0720111201 2013

PATH = =/home/steff075/phd_ecm/NGC5548/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.163636e-04,3.636364e-05,1.828407e+03,9.161909e+02
2.221488e-04,6.942149e-05,1.032708e+02,1.957612e+02
4.241022e-04,1.325319e-04,2.289901e+02,8.527416e+01
8.096496e-04,2.530155e-04,5.516119e+01,4.552406e+01
1.545695e-03,4.830296e-04,-3.168433e+01,1.445437e+01
2.950872e-03,9.221474e-04,-1.072436e+01,7.044423e+00
5.633482e-03,1.760463e-03,-2.365719e+00,2.671825e+00

#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC5548_lagfreq_0720111201.gif

ECM Fitting


#+BEGIN_EXAMPLE

#+END_EXAMPLE




*** OBS 0720111301 2013

PATH = =/home/steff075/phd_ecm/NGC5548/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.163636e-04,3.636364e-05,-1.208789e+03,6.391379e+02
2.221488e-04,6.942149e-05,3.542547e+02,6.389630e+02
4.241022e-04,1.325319e-04,-3.962065e+00,1.012673e+02
8.096496e-04,2.530155e-04,-2.556802e+01,4.067357e+01
1.545695e-03,4.830296e-04,4.101978e+00,2.050129e+01
2.950872e-03,9.221474e-04,-1.359716e+01,6.715585e+00
5.633482e-03,1.760463e-03,-6.173146e-01,2.528601e+00

#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC5548_lagfreq_0720111301.gif

ECM Fitting


#+BEGIN_EXAMPLE

#+END_EXAMPLE






*** OBS 0720111401 2013

PATH = =/home/steff075/phd_ecm/NGC5548/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.163636e-04,3.636364e-05,-1.224481e+02,6.243776e+02
2.221488e-04,6.942149e-05,-1.937361e+02,2.035040e+02
4.241022e-04,1.325319e-04,1.949866e+02,1.334895e+02
8.096496e-04,2.530155e-04,3.877891e+01,5.038903e+01
1.545695e-03,4.830296e-04,-9.869043e+00,1.867082e+01
2.950872e-03,9.221474e-04,-2.089046e+00,7.724961e+00
5.633482e-03,1.760463e-03,2.837040e+00,2.832626e+00

#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC5548_lagfreq_0720111401.gif

ECM Fitting


#+BEGIN_EXAMPLE

#+END_EXAMPLE







*** OBS 0720111501 2013

PATH = =/home/steff075/phd_ecm/NGC5548/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.163636e-04,3.636364e-05,1.585951e+02,8.505354e+02
2.221488e-04,6.942149e-05,2.171545e+02,3.183820e+02
4.241022e-04,1.325319e-04,-5.380455e+01,8.410219e+01
8.096496e-04,2.530155e-04,-5.454395e+01,4.060678e+01
1.545695e-03,4.830296e-04,2.911284e+01,1.481412e+01
2.950872e-03,9.221474e-04,-9.041252e+00,7.203361e+00
5.633482e-03,1.760463e-03,-1.715040e+00,2.814506e+00

#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC5548_lagfreq_0720111501.gif

ECM Fitting


#+BEGIN_EXAMPLE

#+END_EXAMPLE






*** OBS 0720111601 2014

PATH = =/home/steff075/phd_ecm/NGC5548/lagfreq_single_script.sl=

Lags found

#+BEGIN_EXAMPLE
1.163636e-04,3.636364e-05,-1.138730e+03,1.957372e+02
2.221488e-04,6.942149e-05,4.311405e+02,2.701153e+02
4.241022e-04,1.325319e-04,-2.475621e+02,1.866469e+02
8.096496e-04,2.530155e-04,-6.869018e+01,4.736292e+01
1.545695e-03,4.830296e-04,1.128169e+01,1.345481e+01
2.950872e-03,9.221474e-04,1.159506e+01,6.780881e+00
5.633482e-03,1.760463e-03,-2.055725e-01,2.634437e+00

#+END_EXAMPLE


#+ATTR_HTML: :width 600
http://www.star.bris.ac.uk/steff/ecm/NGC5548_lagfreq_0720111601.gif

ECM Fitting


#+BEGIN_EXAMPLE

#+END_EXAMPLE

* Removing files from BC4

Ref email 12 Sep 2020 (Simon B)

#+BEGIN_EXAMPLE
mmlsquota --block-size auto

                         Block Limits                                               |     File Limits
Filesystem Fileset    type         blocks      quota      limit   in_doubt    grace |    files   quota    limit in_doubt    grace  Remarks
gpfs       root       USR         no limits
gpfs       home       USR           13.3G        20G        21G       480M     none |   121285       0        0      120     none
gpfs       scratch    USR          6.478T        10T        10T     28.72G     none | 67005789       0        0   104392     none
gpfs       private-mrcieu USR         no limits
gpfs       private-crab USR         no limits
gpfs       private-mulholland_group USR         no limits
gpfs       private-fluids USR         no limits
gpfs       private-bridge USR         no limits
gpfs       private-epxlp USR         no limits
gpfs       private-acrg USR         no limits
gpfs       NJT_grp_space USR         no limits

[so14935@bc4gpulogin1 lag-files]$ ls
i10  i30  i35  i38  i40  i45  i53  i58  i64

rm -r i10

                         Block Limits                                               |     File Limits
Filesystem Fileset    type         blocks      quota      limit   in_doubt    grace |    files   quota    limit in_doubt    grace  Remarks
gpfs       root       USR         no limits
gpfs       home       USR           13.3G        20G        21G       480M     none |   121285       0        0      120     none
gpfs       scratch    USR          6.448T        10T        10T     28.46G     none | 66742660       0        0   102302     none

rm -r i38

                         Block Limits                                               |     File Limits
Filesystem Fileset    type         blocks      quota      limit   in_doubt    grace |    files   quota    limit in_doubt    grace  Remarks
gpfs       root       USR         no limits
gpfs       home       USR           13.3G        20G        21G       480M     none |   121285       0        0      120     none
gpfs       scratch    USR          6.424T        10T        10T     29.32G     none | 66523838       0        0   101443     none

rm -r i58





#+END_EXAMPLE
* Useful Linux

#+BEGIN_EXAMPLE

find . -type f -empty  =   Find empty directories

find . -type d -empty -exec rmdir {} \;    = find empty directories and delete them!


find . -type f -empty | wc -l  =  how many empty directories are locaed under the current directory?


find . -type f -not -empty | wc -l  =  How many non-empty files are located under the current directory (and sub-directories)?





#+END_EXAMPLE

* Common commands (for speed)

#+BEGIN_EXAMPLE


anaconda-navigator &

ssh steff075@lyra -XY

ssh steff075@mensa -XY

ssh steff075@hercules -XY

source("confidence_.sl");

save_par("relxill_");

eval_counts;
list_par;

>>>>>>>>>>cp phd_ecm_logbook.html /home/WWW/steff

cp timing_analysis.html /home/WWW/steff

cp agn_spectral_modelling.html /home/WWW/steff

cp ecm_model.html /home/WWW/steff

cp linux_notes.html /home/WWW/steff

/homeb/WWW/steff/ecm/

cd /mnt/storage/scratch/so14935/x-ray-rev2/x-ray-reverberation

<<<  copy from windows to Lyra machine using PuTTY >>>>>>>

pscp.exe <filename> steff075@137.222.58.204:/homeb/steff075/phd_ecm/1h0707/extended-corona


set_par(14,150,1);
set_par(15,52,1);
() = fit_counts;
() = eval_counts;
plot_data(1, popt);
_pgsci(1);
_pgsls(2);
_pgmove(-10000, 0);
_pgdraw(1, 0);
() = eval_counts;
list_par;

#+END_EXAMPLE

Fixed Mass

* Scripts
** chsrc

#+BEGIN_EXAMPLE


#+END_EXAMPLE

** Plot spectra and unfold

PATH =/homeb/steff075/phd_ecm/1h0707/all_spectra.sl= and =multi_spectra_unfold.sl=

#+BEGIN_EXAMPLE
% Load the required spectra
load_data("/data/scratch3/steff/1H0707-495/0110890201/PROC/PN_time_0.3-10_pi_grp.fits");
load_data("/data/scratch3/steff/1H0707-495/0148010301/PROC/PN_time_0.3-10_pi_grp.fits");
load_data("/data/scratch3/steff/1H0707-495/0506200201/PROC/PN_time_0.3-10_pi_grp.fits");
load_data("/data/scratch3/steff/1H0707-495/0506200301/PROC/PN_time_0.3-10_pi_grp.fits");
load_data("/data/scratch3/steff/1H0707-495/0506200401/PROC/PN_time_0.3-10_pi_grp.fits");
load_data("/data/scratch3/steff/1H0707-495/0506200501/PROC/PN_time_0.3-10_pi_grp.fits");
load_data("/data/scratch3/steff/1H0707-495/0511580101/PROC/PN_time_0.3-10_pi_grp.fits");
load_data("/data/scratch3/steff/1H0707-495/0511580201/PROC/PN_time_0.3-10_pi_grp.fits");
load_data("/data/scratch3/steff/1H0707-495/0511580301/PROC/PN_time_0.3-10_pi_grp.fits");
load_data("/data/scratch3/steff/1H0707-495/0511580401/PROC/PN_time_0.3-10_pi_grp.fits");
load_data("/data/scratch3/steff/1H0707-495/0554710801/PROC/PN_time_0.3-10_pi_grp.fits");
load_data("/data/scratch3/steff/1H0707-495/0653510301/PROC/PN_time_0.3-10_pi_grp.fits");
load_data("/data/scratch3/steff/1H0707-495/0653510401/PROC/PN_time_0.3-10_pi_grp.fits");
load_data("/data/scratch3/steff/1H0707-495/0653510501/PROC/PN_time_0.3-10_pi_grp.fits");
load_data("/data/scratch3/steff/1H0707-495/0653510601/PROC/PN_time_0.3-10_pi_grp.fits");

% Rebin as required
rebin_data(1, 40);
rebin_data(2, 80);
rebin_data(3, 80);
rebin_data(4, 80);
rebin_data(5, 80);
rebin_data(6, 80);
rebin_data(7, 80);
rebin_data(8, 80);
rebin_data(9, 80);
rebin_data(10, 80);
rebin_data(11, 80);
rebin_data(12, 80);
rebin_data(13, 80);
rebin_data(14, 80);
rebin_data(15, 80);

%set required energy ranges
xnotice_en(all_data(),0.3, 10.0);
ignore_en(all_data(),0,0.3);
ignore_en(all_data(),10,20);

% Fit a model
%fancy_plot_unit=(“keV”);
%fit_fun("wabs*(powerlaw+laor(1)+laor(2)+diskbb)");

% Plot all spectra
open_plot("1H0707-495_Spectra_all.gif/gif");
title ("1H0707-495 Folded Spectra 2000-2011");
%set_par(1,0.000119498);
%set_par(2,0.004,0);
%set_par(3,2.2,0);
%set_par(4,2.5e-05);
%set_par(5,6.37);
%thaw(6,9);
%set_par(9,35,0);
%set_par(11,0.09,0);
%thaw(12);
%set_par(16,1077,1);
%set_par(17,0.13,1);
%tie(9,15);
% Set Plotting functions and styles
popt.xrange = [0.3, 10.0];
popt.yrange = [1.0e-5, 10, -10.0, 10.0];
%popt.res = 1;
xlog;
ylog;
%group(2; min_sn=2.0);
popt.dcol=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15];
popt.decol=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15];
popt.dsym=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1];

%()=eval_counts;
%()=fit_counts;
%plot_comps(1, popt,&plot_data);
plot_data({1,2,3,4,5,6,7,8,9,10,11,12,13,14,15}, popt);
%list_par;
close_plot;

% Plot all Unfolded spectra
open_plot("1H0707-495_Spectra_all_unfolded.gif/gif");
title ("1H0707-495 Unfolded Spectra 2000-2011");
plot_unfold({1,2,3,4,5,6,7,8,9,10,11,12,13,14,15};power=3, dsym=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],dcol=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,14],yrange = [1.0e-5, 5e-03]);
close_plot;

% Create ps image of plot
variable pid = open_plot("1H0707-495_Unfolded_Spectra_all.ps/cps");
plot_unfold({1,2,3,4,5,6,7,8,9,10,11,12,13,14,15};power=3, dsym=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],dcol=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,14],yrange = [1.0e-5, 5e-03]);
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
close_plot(pid);

#+END_EXAMPLE

** Confidence

#+BEGIN_EXAMPLE
% This should find the confidence intervals of a list of parameters.
% If a new best fit is found it will re-fit that parameter repeatedly until a confidence
% interval is measured. If any parameters need to be refit, the entire list is
% recomputed until all parameters are at their best-fit values.

% List of paramers to run on.
variable p = [1,2,3,4,5,6,7,8,11,15,16,17,19];

variable all_good, good, i, lo, hi;

do {
	vmessage("\n\n--Starting to determine confidence intervals--\n");
	all_good = 1;
	for (i=0; i<length(p); i++) {
		do {
			good = 1;
			(lo, hi) = conf(p[i]);
			vmessage("  ... parameter %i = %e (%e - %e)", p[i], get_par(p[i]), lo, hi);
			if (lo == hi) {
				% this means that a better fit was found
				vmessage("Found a better fit!");
				() = fit_counts;
				good = 0;
				all_good = 0;
			}
		} while (good == 0);
		vmessage("Parameter %i = %e (%e - %e)", p[i], get_par(p[i]), lo, hi);
	}
} while (all_good == 0);

eval_counts;
list_par;

#+END_EXAMPLE


To print outputs to csv file use:

#+BEGIN_EXAMPLE
% List of paramers to run on.
variable p = [1,2,3,4,5,6,7,8,11,15,16,17,19];

variable all_good, good, i, lo, hi;

do {
	vmessage("\n\n--Starting to determine confidence intervals--\n");
	all_good = 1;
	fp = fopen("Conf_2009.csv","w");% Create the file
	for (i=0; i<length(p); i++) {
		do {
			good = 1;
			(lo, hi) = conf(p[i]);
			vmessage("  ... parameter %i = %e (%e - %e)", p[i], get_par(p[i]), lo, hi);
			() = fprintf(fp, "%s,%e,+%e,-%e\n", get_par_info(p[i]).name, get_par(p[i]), hi-get_par(p[i]), get_par(p[i])-lo);
			if (lo == hi) {
				% this means that a better fit was found
				vmessage("Found a better fit!");
				() = fit_counts;
				good = 0;
				all_good = 0;
			}
		} while (good == 0);
		vmessage("Parameter %i = %e (%e - %e)", p[i], get_par(p[i]), lo, hi);
	}
	() = fclose(fp);
} while (all_good == 0);

#+END_EXAMPLE

** Confidence (=conf_loop= using 16 cores)

#+BEGIN_EXAMPLE
% List of paramers to run on.
variable p = [2,3,7,8,9,11,13,15,16];

variable all_good, good, i, pmin, pmax;

vmessage("\n\n--Starting to determine confidence intervals--\n");

fp = fopen("confloop_TEST_1data.csv","w");% Create the file

(pmin, pmax) = conf_loop(p; num_slaves=16);

for (i = 0;i<length(p); i++){
	vmessage("  Parameter %i = %e (%e - %e)", p[i], get_par(p[i]), pmin[i], pmax[i]);
	() = fprintf(fp, "%s,%e,+%e,-%e\n", get_par_info(p[i]).name, get_par(p[i]), pmax[i]-get_par(p[i]), get_par(p[i])-pmin[i]);
}

() = fclose(fp);

save_par("confloop_1data.par");
()=eval_counts;
list_par;
#+END_EXAMPLE

** Pandas AGN Parameter files for clear results

#+BEGIN_EXAMPLE
import pandas as pd

df = pd.read_csv('/homeb/steff075/phd_ecm/NGC6860/Conf_2009.csv', names=['Parameter', 'Value','Plus','Minus'])

#suppress displaying long numbers in scientific notation
pd.set_option('display.float_format', lambda x: '%.2f' % x)
df

#+END_EXAMPLE

** Lag-frequency script

PATH =/data/scratch3/steff/phd_ecm/1h0707/lagfreq_comb_script.sl=
all_spectra.sl
#+BEGIN_EXAMPLE
%declare observation ID's
variable obs_id =
["0506440101"];

variable i;
variable j;
variable k;

%declare frequency bins
variable n_bins = 7;
variable df_f = 1.0/1.1;
variable lo = Double_Type[n_bins];
variable hi = Double_Type[n_bins];
lo[0]=0.00005;
hi[0]=(lo[0] + lo[0]*df_f);

for(i=1;i<n_bins;i++){
    lo[i]=hi[i-1];
    hi[i]=lo[i]+lo[i]*df_f;
 }

%logarithmic frequency bin centre
variable rb_freq = 10^(0.5*(log10(lo)+log10(hi)));

%declare arrays
variable rb_n = Integer_Type[n_bins];
variable lag = Double_Type[n_bins];
variable g_a_real = Double_Type[n_bins];
variable g_a_imag = Double_Type[n_bins];
variable g_a = Double_Type[n_bins];
variable g_b = Double_Type[n_bins];
variable g_c = Double_Type[n_bins];
variable g = Double_Type[n_bins];
variable delta_phi = Double_Type[n_bins];
variable delta_lag = Double_Type[n_bins];

%loop through observarions
for(k=0; k<length(obs_id); k++){

() = chdir("/data/scratch3/steff/REJ1034+396/" + obs_id[k] + "/PROC");

%Read data:
variable lc_soft = fits_read_table("PN_time_soft_lccorr.fits");
variable lc_hard = fits_read_table("PN_time_hard_lccorr.fits");

%exclude non-numbers:
variable ix_soft = where(not isnan(lc_soft.rate));
variable ix_hard = where(not isnan(lc_hard.rate));

%Pass to new variables:
variable time_soft = lc_soft.time[ix_soft];
variable time_hard = lc_hard.time[ix_hard];
variable rate_soft = lc_soft.rate[ix_soft];
variable rate_hard = lc_hard.rate[ix_hard];
variable error_soft = lc_soft.error[ix_soft];
variable error_hard = lc_hard.error[ix_hard];

% Compute soft dft:
variable dft_soft = fft(rate_soft,-1);
variable freq = [[0:length(dft_soft)-1]]/(double(length(dft_soft))*(time_soft[1]-time_soft[0]));
variable dft_real_soft = Real(dft_soft[[0:length(freq)-1]]);
variable dft_imag_soft = Imag(dft_soft[[0:length(freq)-1]]);

% Compute hard dft:
variable dft_hard = fft(rate_hard,-1);
variable dft_real_hard = Real(dft_hard[[0:length(freq)-1]]);
variable dft_imag_hard = Imag(dft_hard[[0:length(freq)-1]]);

%Calculate and sum CPS for each frequency bin in each observation.
for(i=0; i< n_bins; i++)
{
	for (j=0; j<length(freq); j++)
	{
		if(freq[j] > lo[i] && freq[j] <= hi[i])
		{
			g_a_real[i] += dft_real_soft[j]*dft_real_hard[j] + dft_imag_soft[j]*dft_imag_hard[j];
			g_a_imag[i] += dft_imag_soft[j]*dft_real_hard[j] - dft_real_soft[j]*dft_imag_hard[j];
			g_b[i] += dft_real_soft[j]*dft_real_soft[j] + dft_imag_soft[j]*dft_imag_soft[j];
			g_c[i] += dft_real_hard[j]*dft_real_hard[j] + dft_imag_hard[j]*dft_imag_hard[j];
			rb_n[i] ++;
		}
	}
}
}

%Plot variables including frequency error bars
variable x = (hi+lo)/2;
variable dxp = hi-x;
variable dxm = x-lo;

%Average CPS in each frequency bin for all observations. Calculate coherence, g[i], for each frequency bin.
for(i=0;i<n_bins;i++)
{
	%Lag error
	g_a[i] = (g_a_real[i]*g_a_real[i] + g_a_imag[i]*g_a_imag[i])/(double(rb_n[i])*double(rb_n[i]));
	g_b[i] /= double(rb_n[i]);
        g_c[i] /= double(rb_n[i]);
	g[i] = g_a[i]/(g_b[i]*g_c[i]);
	delta_phi[i] = sqrt((1.0-g[i])/(2.0*g[i]))/sqrt(double(rb_n[i]));
	delta_lag[i] = delta_phi[i]/(2.0*PI*rb_freq[i]);

	%Lag
	g_a_real[i] /= rb_n[i];
	g_a_imag[i] /= rb_n[i];
	lag[i] = atan2(g_a_imag[i] , g_a_real[i])/(2.0*PI*rb_freq[i]);
}

% Plot results:
%change to combined directory
() = chdir("/homeb/steff075/phd_ecm/REJ1034+396");
%open_plot("REJ1034+396_lagfreq_2007.gif/gif");
window(1);
xlog;
ylin;
popt.res = 1;
popt.ylabel = ["\fr","Time lag (s)"];
popt.xlabel = ["\fr","Frequency (Hz)"];
charsize(1.2);
ylabel("Time Lag (s)");
xlabel("Frequency (Hz)");
%title("REJ1034+396 2007 lag-frequency >5e-5 Hz");
connect_points(0);
plotxy(x,dxm,dxp,lag,delta_lag,delta_lag; dcol=1, decol=4, dsym=6, mcol=2, xrange=[4e-5,1e-2],yrange=[-400,1200]);
_pgqcf (2);
_pgsfs(3);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);

%Print lag values to screen
for (i=0; i<length(x); i++) {
  () = printf("%e,%e,%e\n", x[i], lag[i], delta_lag[i]);
}
%close_plot;

% Print lag freq values to csv file
fp = fopen("time_lags_2007.csv","w");% Create the file
for (i=0; i<length(x); i++) {
  fprintf(fp,"%e,%e,%e\n", x[i], lag[i], delta_lag[i]);
}
fclose(fp);

% Create ps image
variable pid = open_plot("REJ1034+396_lagfreq_2007.ps/cps");
charsize(1.2); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
plotxy(x,dxm,dxp,lag,delta_lag,delta_lag; dcol=1, decol=4, dsym=6, mcol=2, xrange=[4e-5,1e-2],yrange=[-400,1200]);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgdraw(1,0);
close_plot(pid);
#+END_EXAMPLE

** Combined spectra script

#+BEGIN_EXAMPLE

%declare path
variable path_to_data = "/data/scratch3/steff/1H0707-495";

variable obsid = ["0506200201","0506200301","0506200401","0506200501"];
variable i;

% Read in all data sets
for (i=0; i<length(obsid); i++) {
  () = chdir(path_to_data + "/" + obsid[i] + "/PROC");
  () = load_data("PN_time_0.3-10_pi_grp.fits");
}

match_dataset_grids (all_data());
chdir(path_to_data);

% Now group and rebin the data
variable g;
g = combine_datasets(all_data());


% See which datasets have been combined
print(combination_members(g));

% Rebin to a minimum number of counts per bin
rebin_combined(g, 100);

% Then notice a specific energy range
%xnotice_en(all_data(),0.3,10.0);
%ignore_en(all_data(),0.1,0.3);
%ignore_en(all_data(),10.0,20.0);

% Fit a model and plot the result
%fit_fun("powerlaw+diskbb+laor");
fit_fun("(powerlaw+laor+diskbb)*edge");
popt.yrange = [1.0e-4, 10.0, -10.0, 10.0];
xlog;
ylog;
title ("1H0707-495 Combined 2007 Spectrum");
popt.dsym = 1;
popt.rsym = 1;
popt.res = 4;
xnotice_en(all_data(),0.3,10.0);
ignore_en(all_data(),0.1,0.3);
ignore_en(all_data(),10.0,20.0);
popt.ccol=14;
charsize(1.2);
set_par(1,0.000119498);
set_par(2,2.18896);
set_par(3,2.591446e-05);
set_par(4,6.377239);
set_par(5,3.998935,0);
set_par(8,33.56053,0);
set_par(9,30);
set_par(10,0.13);
set_par(11,7.2);
set_par(12,2);
set_fit_method("subplex");
()=fit_counts;
() = eval_counts;
plot_comps({{g}}, popt, &plot_data);
plot_comps(1-4,popt,&plot_data);

list_par;
data_flux(1,0.3,10);
list_data;

%model_flux(g,0.3,10 [unit=erg, pc=174,100,000,print]);
()=chdir("/data/scratch3/steff/1H0707-495/combined/");
variable pid = open_plot("1H0707-495_spec_comb2007.ps/cps");
plot_comps(1-4,popt,&plot_data);
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman

%close_plot(pid);


#+END_EXAMPLE
** Create spectra script
#+BEGIN_EXAMPLE
!  /opt/data.cluster/astrosoft/lib/python2.7/
#! alternative /usr/bin/python

# Script to create a "spectrum" corresponding to lag-frequency plots
# and a response matrix containing the frequency binning
# Spectra are usually plotted as energy on x-axis and counts / s / keV on y-axis
# Our x-axis will correspond to Frequency (Hz)
# Our y-axis will correspond to Time lag (sec)
# This means our y values need to be multiplied by the bin width
# The "exposure time" is set to one second
# Note steff's method: ##! /opt/local/bin/python3.5

from astropy.io import fits
import numpy as np
import sys, os

# Time lag values
time_lag = np.array([8.517445e+01 , 2.423430e+02 , 5.911962e+01 , -1.908393e+01 , -2.845252e+01 , -3.785675e+00 , -1.539097e+00])
time_lag_err = np.array([8.862303e+01 , 3.531911e+01 , 1.859498e+01 , 9.756367e+00 , 4.501351e+00 , 2.387277e+00 , 1.035855e+00])
# Frequency bins should be contiguous with no gaps between them
freq_low = np.array([0.00010472724 , 0.0001692562 , 0.0003231255 , 0.0006168759 , 0.0011776723 , 0.0022482835 , 0.004292177])
freq_high = np.array([0.0001692562 , 0.0003231255 , 0.0006168759 , 0.0011776723 , 0.0022482835 , 0.004292177 , 0.006196830200000001])

os.system("rm -f time_lags.fits")
os.system("rm -f time_lags.rsp")

# Name of output file stem (.fits and .rsp get added to this stem)
output_file = '2008_comb_time_lags'

# Multiply lags and associated errors by bin widths
time_lag = time_lag * (freq_high - freq_low)
time_lag_err = time_lag_err  * (freq_high - freq_low)

# Create the "spectrum"
# See http://heasarc.gsfc.nasa.gov/docs/heasarc/ofwg/docs/spectra/ogip_92_007/ogip_92_007.html
# And the example on that site too

channels = np.arange(1, len(time_lag)+1)
zeros = np.zeros(len(time_lag))
ones = np.ones(len(time_lag))

col1 = fits.Column(name='CHANNEL', format='I', array=channels)
col2 = fits.Column(name='COUNTS', format='E', array=time_lag)
col3 = fits.Column(name='STAT_ERR', format='E', array=time_lag_err)
col4 = fits.Column(name='GROUPING', format='I', array=zeros)

spechdr = fits.Header()
spechdr['SYS_ERR'] = 0
spechdr['QUALITY'] = 0
spechdr['POISSERR'] = False
spechdr['EXPOSURE'] = 1.0
spechdr['AREASCAL'] = 1.0
spechdr['BACKSCAL'] = 1.0
spechdr['EXTNAME'] = 'SPECTRUM'
spechdr['DETCHANS'] = len(time_lag)
spechdr['HDUCLASS'] = 'OGIP'
spechdr['HDUCLAS1'] = 'SPECTRUM'
spechdr['HDUVERS'] = '1.2.1'
spechdr['BACKFILE'] = 'none'
spechdr['CORRFILE'] = 'none'
spechdr['RESPFILE'] = output_file + '.rsp'
spechdr['ANCRFILE'] = 'none'
spechdr['CHANTYPE'] = 'PI'
spechdr['TELESCOP'] = 'XMM-NEWTON'
spechdr['INSTRUME'] = 'EPIC-PN'
spechdr['FILTER'] = 'none'

cols = fits.ColDefs([col1, col2, col3, col4])

tbhdu = fits.BinTableHDU.from_columns(cols, name='SPECTRUM', header=spechdr)

prihdr = fits.Header()
prihdr['HDUCLASS'] = 'OGIP'
prihdr['HDUCLAS1'] = 'SPECTRUM'
prihdr['HDUVERS'] = '1.2.1'
prihdu = fits.PrimaryHDU(header=prihdr)

thdulist = fits.HDUList([prihdu, tbhdu])
thdulist.writeto(output_file + '.fits')

print("Created spectrum")

# Create the "response"
# See http://heasarc.gsfc.nasa.gov/docs/heasarc/caldb/docs/memos/cal_gen_92_002/cal_gen_92_002.html
# Our response matrix will be diagonal

rsp_col1 = fits.Column(name='ENERG_LO', format='E', array=freq_low)
rsp_col2 = fits.Column(name='ENERG_HI', format='E', array=freq_high)
rsp_col3 = fits.Column(name='N_GRP', format='I', array=ones)
rsp_col4 = fits.Column(name='F_CHAN', format='I', array=channels)
rsp_col5 = fits.Column(name='N_CHAN', format='I', array=ones)
rsp_col6 = fits.Column(name='MATRIX', format='E', array=ones)

rspcols = fits.ColDefs([rsp_col1, rsp_col2, rsp_col3, rsp_col4, rsp_col5, rsp_col6])

rsphdr = fits.Header()
rsphdr['EXTNAME'] = 'MATRIX'
rsphdr['TELESCOP'] = 'XMM-NEWTON'
rsphdr['INSTRUME'] = 'EPIC-PN'
rsphdr['FILTER'] = 'none'
rsphdr['CHANTYPE'] = 'PI'
rsphdr['DETCHANS'] = len(time_lag)
rsphdr['HDUCLASS'] = 'OGIP'
rsphdr['HDUCLAS1'] = 'RESPONSE'
rsphdr['HDUCLAS2'] = 'RSP_MATRIX'
rsphdr['HDUCLAS3'] = 'FULL'
rsphdr['HDUVERS'] = '1.3.0'

rsphdu = fits.BinTableHDU.from_columns(rspcols, name='MATRIX', header=rsphdr)

ebin_col1 = fits.Column(name='CHANNEL', format='I', array=channels)
ebin_col2 = fits.Column(name='E_MIN', format='E', array=freq_low)
ebin_col3 = fits.Column(name='E_MAX', format='E', array=freq_high)

ebin_cols = fits.ColDefs([ebin_col1, ebin_col2, ebin_col3])

ebin_hdr = fits.Header()
ebin_hdr['EXTNAME'] = 'EBOUNDS'
ebin_hdr['TELESCOP'] = 'XMM-NEWTON'
ebin_hdr['INSTRUME'] = 'EPIC-PN'
ebin_hdr['FILTER'] = 'none'
ebin_hdr['CHANTYPE'] = 'PI'
ebin_hdr['DETCHANS'] = len(time_lag)
ebin_hdr['HDUCLASS'] = 'OGIP'
ebin_hdr['HDUCLAS1'] = 'RESPONSE'
ebin_hdr['HDUCLAS2'] = 'EBOUNDS'
ebin_hdr['HDUVERS'] = '1.2.0'

ebin_hdu = fits.BinTableHDU.from_columns(ebin_cols, name='EBOUNDS', header=ebin_hdr)

rsp_prihdr = fits.Header()
rsp_prihdr['HDUCLASS'] = 'OGIP'
rsp_prihdr['HDUCLAS1'] = 'SPECTRUM'
rsp_prihdr['HDUVERS'] = '1.2.1'
rsp_prihdu = fits.PrimaryHDU(header=rsp_prihdr)

rsp_thdulist = fits.HDUList([rsp_prihdu, rsphdu, ebin_hdu])
rsp_thdulist.writeto(output_file + '.rsp')

print("Created response")

#+END_EXAMPLE

** Create spectra template
#+BEGIN_EXAMPLE
#!  /opt/data.cluster/astrosoft/lib/python2.7/
#! alternative /usr/bin/python

# Script to create a "spectrum" corresponding to lag-frequency plots
# and a response matrix containing the frequency binning
# Spectra are usually plotted as energy on x-axis and counts / s / keV on y-axis
# Our x-axis will correspond to Frequency (Hz)
# Our y-axis will correspond to Time lag (sec)
# This means our y values need to be multiplied by the bin width
# The "exposure time" is set to one second
# Note steff's method: ##! /opt/local/bin/python3.5

from astropy.io import fits
import numpy as np
import sys, os

# Time lag values
TIMELAG
TIMELAGERROR
# Frequency bins should be contiguous with no gaps between them
LOWFREQUENCY
HIGHFREQUENCY

os.system("rm -f time_lags.fits")
os.system("rm -f time_lags.rsp")

# Name of output file stem (.fits and .rsp get added to this stem)
output_file = '2008_comb_time_lags'

# Multiply lags and associated errors by bin widths
time_lag = time_lag * (freq_high - freq_low)
time_lag_err = time_lag_err  * (freq_high - freq_low)

# Create the "spectrum"
# See http://heasarc.gsfc.nasa.gov/docs/heasarc/ofwg/docs/spectra/ogip_92_007/ogip_92_007.html
# And the example on that site too

channels = np.arange(1, len(time_lag)+1)
zeros = np.zeros(len(time_lag))
ones = np.ones(len(time_lag))

col1 = fits.Column(name='CHANNEL', format='I', array=channels)
col2 = fits.Column(name='COUNTS', format='E', array=time_lag)
col3 = fits.Column(name='STAT_ERR', format='E', array=time_lag_err)
col4 = fits.Column(name='GROUPING', format='I', array=zeros)

spechdr = fits.Header()
spechdr['SYS_ERR'] = 0
spechdr['QUALITY'] = 0
spechdr['POISSERR'] = False
spechdr['EXPOSURE'] = 1.0
spechdr['AREASCAL'] = 1.0
spechdr['BACKSCAL'] = 1.0
spechdr['EXTNAME'] = 'SPECTRUM'
spechdr['DETCHANS'] = len(time_lag)
spechdr['HDUCLASS'] = 'OGIP'
spechdr['HDUCLAS1'] = 'SPECTRUM'
spechdr['HDUVERS'] = '1.2.1'
spechdr['BACKFILE'] = 'none'
spechdr['CORRFILE'] = 'none'
spechdr['RESPFILE'] = output_file + '.rsp'
spechdr['ANCRFILE'] = 'none'
spechdr['CHANTYPE'] = 'PI'
spechdr['TELESCOP'] = 'XMM-NEWTON'
spechdr['INSTRUME'] = 'EPIC-PN'
spechdr['FILTER'] = 'none'

cols = fits.ColDefs([col1, col2, col3, col4])

tbhdu = fits.BinTableHDU.from_columns(cols, name='SPECTRUM', header=spechdr)

prihdr = fits.Header()
prihdr['HDUCLASS'] = 'OGIP'
prihdr['HDUCLAS1'] = 'SPECTRUM'
prihdr['HDUVERS'] = '1.2.1'
prihdu = fits.PrimaryHDU(header=prihdr)

thdulist = fits.HDUList([prihdu, tbhdu])
thdulist.writeto(output_file + '.fits')

print("Created spectrum")

# Create the "response"
# See http://heasarc.gsfc.nasa.gov/docs/heasarc/caldb/docs/memos/cal_gen_92_002/cal_gen_92_002.html
# Our response matrix will be diagonal

rsp_col1 = fits.Column(name='ENERG_LO', format='E', array=freq_low)
rsp_col2 = fits.Column(name='ENERG_HI', format='E', array=freq_high)
rsp_col3 = fits.Column(name='N_GRP', format='I', array=ones)
rsp_col4 = fits.Column(name='F_CHAN', format='I', array=channels)
rsp_col5 = fits.Column(name='N_CHAN', format='I', array=ones)
rsp_col6 = fits.Column(name='MATRIX', format='E', array=ones)

rspcols = fits.ColDefs([rsp_col1, rsp_col2, rsp_col3, rsp_col4, rsp_col5, rsp_col6])

rsphdr = fits.Header()
rsphdr['EXTNAME'] = 'MATRIX'
rsphdr['TELESCOP'] = 'XMM-NEWTON'
rsphdr['INSTRUME'] = 'EPIC-PN'
rsphdr['FILTER'] = 'none'
rsphdr['CHANTYPE'] = 'PI'
rsphdr['DETCHANS'] = len(time_lag)
rsphdr['HDUCLASS'] = 'OGIP'
rsphdr['HDUCLAS1'] = 'RESPONSE'
rsphdr['HDUCLAS2'] = 'RSP_MATRIX'
rsphdr['HDUCLAS3'] = 'FULL'
rsphdr['HDUVERS'] = '1.3.0'

rsphdu = fits.BinTableHDU.from_columns(rspcols, name='MATRIX', header=rsphdr)

ebin_col1 = fits.Column(name='CHANNEL', format='I', array=channels)
ebin_col2 = fits.Column(name='E_MIN', format='E', array=freq_low)
ebin_col3 = fits.Column(name='E_MAX', format='E', array=freq_high)

ebin_cols = fits.ColDefs([ebin_col1, ebin_col2, ebin_col3])

ebin_hdr = fits.Header()
ebin_hdr['EXTNAME'] = 'EBOUNDS'
ebin_hdr['TELESCOP'] = 'XMM-NEWTON'
ebin_hdr['INSTRUME'] = 'EPIC-PN'
ebin_hdr['FILTER'] = 'none'
ebin_hdr['CHANTYPE'] = 'PI'
ebin_hdr['DETCHANS'] = len(time_lag)
ebin_hdr['HDUCLASS'] = 'OGIP'
ebin_hdr['HDUCLAS1'] = 'RESPONSE'
ebin_hdr['HDUCLAS2'] = 'EBOUNDS'
ebin_hdr['HDUVERS'] = '1.2.0'

ebin_hdu = fits.BinTableHDU.from_columns(ebin_cols, name='EBOUNDS', header=ebin_hdr)

rsp_prihdr = fits.Header()
rsp_prihdr['HDUCLASS'] = 'OGIP'
rsp_prihdr['HDUCLAS1'] = 'SPECTRUM'
rsp_prihdr['HDUVERS'] = '1.2.1'
rsp_prihdu = fits.PrimaryHDU(header=rsp_prihdr)

rsp_thdulist = fits.HDUList([rsp_prihdu, rsphdu, ebin_hdu])
rsp_thdulist.writeto(output_file + '.rsp')

print("Created response")

#+END_EXAMPLE
** Generate time lag fits files script
#+BEGIN_EXAMPLE
# This python script takes a data table produced by isis in the form freq,lag,lagerror and produces a .fits and .rsp file of the data which can be used for example in model fitting

import csv, os

Frequencies=[]
Lags=[]
LagErrors=[]
LowFrequencies=[]
HighFrequencies=[]

# Read in data produced from isis into arrays
with open('lag_values_2008.txt','r') as f:
    reader=csv.reader(f,delimiter=',')
    for Frequency,Lag,LagError in reader:
        Frequencies.append(Frequency)
        Lags.append(Lag)
        LagErrors.append(LagError)

NumberOfFrequencies = len(Frequencies)

# Split the frequencies into bins
LowFrequencies.append(float(float(Frequencies[0])*0.9))
for i in range(0,NumberOfFrequencies-1):
    HighFrequencies.append((float(Frequencies[i]) + float(Frequencies[i+1]))/2)
    if(i!=0):
        LowFrequencies.append(float(HighFrequencies[i-1]))
LowFrequencies.append(float(HighFrequencies[NumberOfFrequencies-2]))

HighFrequencies.append(float(float(Frequencies[NumberOfFrequencies-1])*1.1))

#Store the data in a comma separated format
LowFrequenciesString = " , ".join(str(x) for x in LowFrequencies)
HighFrequenciesString = " , ".join(str(x) for x in HighFrequencies)
LagsString = " , ".join(str(x) for x in Lags)
LagErrorsString = " , ".join(str(x) for x in LagErrors)

# Add the relevant header/ finishing material to the strings
LowFreq = str("freq_low = np.array(["+LowFrequenciesString+"])")
HighFreq = str("freq_high = np.array(["+HighFrequenciesString+"])")
TLag = str("time_lag = np.array(["+LagsString+"])")
TLagErr = str("time_lag_err = np.array(["+LagErrorsString+"])")

# Open a template 'create_spectra.py' file and replace the placeholders (Caps words) with the actual strings you want
f1=open("create_spectra_template.py","r") # Opens a segment analysis template file.
f2=open("create_spectra.py","w") # Opens a local version which will be run.
for line in f1: # For each line in the template file...
    line=line.replace("LOWFREQUENCY",str(LowFreq))
    line=line.replace("HIGHFREQUENCY",str(HighFreq))
    line=line.replace("TIMELAGERROR",str(TLagErr))
    line=line.replace("TIMELAG",str(TLag))
    f2.write(line)
f1.close()
f2.close()

#Call and run create_spectra.py
print ("Running 'create_spectra.py'")
os.system("/homeb/steff075/anaconda3/bin/python create_spectra.py")

print ("Fits and Respnse files completed!")
#+BEGIN_EXAMPLE
#!  /opt/data.cluster/astrosoft/lib/python2.7/
#! alternative /usr/bin/python

# Script to create a "spectrum" corresponding to lag-frequency plots
# and a response matrix containing the frequency binning
# Spectra are usually plotted as energy on x-axis and counts / s / keV on y-axis
# Our x-axis will correspond to Frequency (Hz)
# Our y-axis will correspond to Time lag (sec)
# This means our y values need to be multiplied by the bin width
# The "exposure time" is set to one second
# Note steff's method: ##! /opt/local/bin/python3.5

from astropy.io import fits
import numpy as np
import sys, os

# Time lag values
TIMELAG
TIMELAGERROR
# Frequency bins should be contiguous with no gaps between them
LOWFREQUENCY
HIGHFREQUENCY

os.system("rm -f time_lags.fits")
os.system("rm -f time_lags.rsp")

# Name of output file stem (.fits and .rsp get added to this stem)
output_file = '2008_comb_time_lags'

# Multiply lags and associated errors by bin widths
time_lag = time_lag * (freq_high - freq_low)
time_lag_err = time_lag_err  * (freq_high - freq_low)

# Create the "spectrum"
# See http://heasarc.gsfc.nasa.gov/docs/heasarc/ofwg/docs/spectra/ogip_92_007/ogip_92_007.html
# And the example on that site too

channels = np.arange(1, len(time_lag)+1)
zeros = np.zeros(len(time_lag))
ones = np.ones(len(time_lag))

col1 = fits.Column(name='CHANNEL', format='I', array=channels)
col2 = fits.Column(name='COUNTS', format='E', array=time_lag)
col3 = fits.Column(name='STAT_ERR', format='E', array=time_lag_err)
col4 = fits.Column(name='GROUPING', format='I', array=zeros)

spechdr = fits.Header()
spechdr['SYS_ERR'] = 0
spechdr['QUALITY'] = 0
spechdr['POISSERR'] = False
spechdr['EXPOSURE'] = 1.0
spechdr['AREASCAL'] = 1.0
spechdr['BACKSCAL'] = 1.0
spechdr['EXTNAME'] = 'SPECTRUM'
spechdr['DETCHANS'] = len(time_lag)
spechdr['HDUCLASS'] = 'OGIP'
spechdr['HDUCLAS1'] = 'SPECTRUM'
spechdr['HDUVERS'] = '1.2.1'
spechdr['BACKFILE'] = 'none'
spechdr['CORRFILE'] = 'none'
spechdr['RESPFILE'] = output_file + '.rsp'
spechdr['ANCRFILE'] = 'none'
spechdr['CHANTYPE'] = 'PI'
spechdr['TELESCOP'] = 'XMM-NEWTON'
spechdr['INSTRUME'] = 'EPIC-PN'
spechdr['FILTER'] = 'none'

cols = fits.ColDefs([col1, col2, col3, col4])

tbhdu = fits.BinTableHDU.from_columns(cols, name='SPECTRUM', header=spechdr)

prihdr = fits.Header()
prihdr['HDUCLASS'] = 'OGIP'
prihdr['HDUCLAS1'] = 'SPECTRUM'
prihdr['HDUVERS'] = '1.2.1'
prihdu = fits.PrimaryHDU(header=prihdr)

thdulist = fits.HDUList([prihdu, tbhdu])
thdulist.writeto(output_file + '.fits')

print("Created spectrum")

# Create the "response"
# See http://heasarc.gsfc.nasa.gov/docs/heasarc/caldb/docs/memos/cal_gen_92_002/cal_gen_92_002.html
# Our response matrix will be diagonal

rsp_col1 = fits.Column(name='ENERG_LO', format='E', array=freq_low)
rsp_col2 = fits.Column(name='ENERG_HI', format='E', array=freq_high)
rsp_col3 = fits.Column(name='N_GRP', format='I', array=ones)
rsp_col4 = fits.Column(name='F_CHAN', format='I', array=channels)
rsp_col5 = fits.Column(name='N_CHAN', format='I', array=ones)
rsp_col6 = fits.Column(name='MATRIX', format='E', array=ones)

rspcols = fits.ColDefs([rsp_col1, rsp_col2, rsp_col3, rsp_col4, rsp_col5, rsp_col6])

rsphdr = fits.Header()
rsphdr['EXTNAME'] = 'MATRIX'
rsphdr['TELESCOP'] = 'XMM-NEWTON'
rsphdr['INSTRUME'] = 'EPIC-PN'
rsphdr['FILTER'] = 'none'
rsphdr['CHANTYPE'] = 'PI'
rsphdr['DETCHANS'] = len(time_lag)
rsphdr['HDUCLASS'] = 'OGIP'
rsphdr['HDUCLAS1'] = 'RESPONSE'
rsphdr['HDUCLAS2'] = 'RSP_MATRIX'
rsphdr['HDUCLAS3'] = 'FULL'
rsphdr['HDUVERS'] = '1.3.0'

rsphdu = fits.BinTableHDU.from_columns(rspcols, name='MATRIX', header=rsphdr)

ebin_col1 = fits.Column(name='CHANNEL', format='I', array=channels)
ebin_col2 = fits.Column(name='E_MIN', format='E', array=freq_low)
ebin_col3 = fits.Column(name='E_MAX', format='E', array=freq_high)

ebin_cols = fits.ColDefs([ebin_col1, ebin_col2, ebin_col3])

ebin_hdr = fits.Header()
ebin_hdr['EXTNAME'] = 'EBOUNDS'
ebin_hdr['TELESCOP'] = 'XMM-NEWTON'
ebin_hdr['INSTRUME'] = 'EPIC-PN'
ebin_hdr['FILTER'] = 'none'
ebin_hdr['CHANTYPE'] = 'PI'
ebin_hdr['DETCHANS'] = len(time_lag)
ebin_hdr['HDUCLASS'] = 'OGIP'
ebin_hdr['HDUCLAS1'] = 'RESPONSE'
ebin_hdr['HDUCLAS2'] = 'EBOUNDS'
ebin_hdr['HDUVERS'] = '1.2.0'

ebin_hdu = fits.BinTableHDU.from_columns(ebin_cols, name='EBOUNDS', header=ebin_hdr)

rsp_prihdr = fits.Header()
rsp_prihdr['HDUCLASS'] = 'OGIP'
rsp_prihdr['HDUCLAS1'] = 'SPECTRUM'
rsp_prihdr['HDUVERS'] = '1.2.1'
rsp_prihdu = fits.PrimaryHDU(header=rsp_prihdr)

rsp_thdulist = fits.HDUList([rsp_prihdu, rsphdu, ebin_hdu])
rsp_thdulist.writeto(output_file + '.rsp')

print("Created response")

#+END_EXAMPLE
** code-img.c
Integrates from observer to disk.

Example ./code-img -i55 -a0.998 -r400 -s8192 Where i = inclination angle (default 30 degrees) [integer] a = spin (default 0.998) [double] r = outer radius (default 400) [integer] s = image size (default 1024) [integer]
#+BEGIN_EXAMPLE
// Integration from observer to disc
// PC, AJY - October 2018
// October 2018:
//      Updated to be passed parameters on the command line
//      Example ./code-img -i55 -a0.998 -r400 -s8192
//      Where i = inclination angle (default 30 degrees) [integer]
//            a = spin (default 0.998) [double]
//            r = outer radius (default 400) [integer]
//            s = image size (default 1024) [integer]

//Main C libraries
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <math.h>
#include <fitsio.h>
#include <assert.h>
#include <unistd.h>

#ifdef MAC
#include <OpenCL/cl.h>
#else
#include <CL/cl.h>
#endif

#include "cl-setup.h"

#define PI M_PI

int main(int argc, char **argv)
{
    // Kernel File path
    char filename[300] = "code-img.cl";

    // Declare Main Parameters
    // Use default values or update with quantities provided on the command line
    double M = 1.0;
    double a = 0.998;
    int inc = 30;
    int int_img_size = 400;
    int nsteps = 1024;

	// Read parameter values specified on command line
	int j;
	opterr = 0;
	while ((j = getopt(argc, argv, "i::a::r::s::")) != -1)
	{
		switch (j)
		{
			case 'i':
				sscanf(optarg, "%i", &inc);
				break;
			case 'a':
				sscanf(optarg, "%lf", &a);
				break;
			case 'r':
				sscanf(optarg, "%i", &int_img_size);
				break;
			case 's':
				sscanf(optarg, "%i", &nsteps);
				break;
			case '?':
				fprintf (stderr, "Unknown option `-%c'.\n", optopt);
				return 1;
			default:
				abort();
		}
	}

    double iin = PI*(double)inc/180.0;
    double img_size = (double)int_img_size;
    double phiin = 0.0;

	// Output file path
    char output[300];
    sprintf(output, "img-i%02i-a0p%03i-r%03i-%04i.fits", inc, (int)(a*1000.0), int_img_size, nsteps);
    printf("Output file = %s\n", output);

    //Declare Output FITS Image Variables
    unsigned int size_output = nsteps * nsteps;
    unsigned int mem_output = sizeof(double) * size_output;

    double* output_host_r = (double*) malloc(mem_output);
    double* output_host_phi = (double*) malloc(mem_output);
    double* output_host_t = (double*) malloc(mem_output);
    double* output_host_g = (double*) malloc(mem_output);
    double* output_host_fe = (double*) malloc(mem_output);
    double* output_host_fo = (double*) malloc(mem_output);

    //Declare OpenCL variables
    cl_platform_id platformID;
    cl_device_id deviceID;
    cl_context context;
    cl_program program;
    cl_kernel kernel;
    cl_command_queue d_queue;

    //Declaring OpenCL Variables
    cl_mem output_device_r;
    cl_mem output_device_phi;
    cl_mem output_device_t;
    cl_mem output_device_g;
    cl_mem output_device_fe;
    cl_mem output_device_fo;

    cl_int err;

    //Create the OpenCL Context Environment
    SelectDevice(&platformID,&deviceID,1);
    const cl_context_properties context_config[3] = {CL_CONTEXT_PLATFORM,(cl_context_properties)platformID,0};
    context = clCreateContext(context_config, 1, &deviceID, NULL, NULL, &err);  debug(err);

    //This makes sure the device that the context is running is the device which was selected earlier
    size_t device_name_len;
    char * device_name;

    //Querys device name and then uses that to select device
    clGetDeviceInfo(deviceID, CL_DEVICE_NAME, 0, NULL, &device_name_len);
    device_name = (char*) malloc(device_name_len);
    clGetDeviceInfo(deviceID, CL_DEVICE_NAME, device_name_len, device_name, NULL);
    printf("%s\n",device_name);

    //Creates the command queue
    d_queue = clCreateCommandQueue(context, deviceID, 0, &err);  debug(err);

    /**LOAD KERNEL CODE**/
    //Essentially load a file into a string
    FILE *fp;
    char *source_str;
    int source_num=0;
    size_t source_size;
    fp = fopen(filename,"r");
    if(!fp) {fprintf(stderr,"Failed to load kernel. \n");exit(1);}
    fseek(fp, 0L, SEEK_END);
    source_num = ftell(fp);
    fseek(fp, 0, SEEK_SET);

    source_str = (char*)malloc(source_num);
    source_size = fread(source_str,1,source_num,fp);
    fclose(fp);

    //Create and compile the kernel from the character array
    program = clCreateProgramWithSource(context, 1, (const char **) &source_str, (const size_t *)&source_size, &err);  debug(err);

    printf("About to build...\n");

    //Acts as the debugger for the kernel, if the build fails this will return a log of the errors.
    if (clBuildProgram(program, 1, &deviceID, NULL, NULL, NULL) != CL_SUCCESS)
    {
        // Determine size of log
        size_t log_size;
        clGetProgramBuildInfo(program, deviceID, CL_PROGRAM_BUILD_LOG, 0, NULL, &log_size);

        // Allocate memory for log
        char *log = (char *)malloc(log_size);

        // Get the low
        clGetProgramBuildInfo(program, deviceID, CL_PROGRAM_BUILD_LOG, log_size, log, NULL);

        // Print the log
        printf("CL Compilation failed:\n%s\n", log);
    }

    //Creates the Kernel after the build. The name "kernel_prog" refers to the function in the kernel file to be called
    kernel = clCreateKernel(program, "kernel_prog", &err);  debug(err);

    //Allocate memory within the GPU context, makes the global arrays for returning data back to the CPU environment,
    output_device_r   = clCreateBuffer(context, CL_MEM_READ_WRITE, mem_output, NULL, &err);  debug(err);
    output_device_phi = clCreateBuffer(context, CL_MEM_READ_WRITE, mem_output, NULL, &err);  debug(err);
    output_device_t   = clCreateBuffer(context, CL_MEM_READ_WRITE, mem_output, NULL, &err);  debug(err);
    output_device_g   = clCreateBuffer(context, CL_MEM_READ_WRITE, mem_output, NULL, &err);  debug(err);
    output_device_fe  = clCreateBuffer(context, CL_MEM_READ_WRITE, mem_output, NULL, &err);  debug(err);
    output_device_fo  = clCreateBuffer(context, CL_MEM_READ_WRITE, mem_output, NULL, &err);  debug(err);

    //Set Kernel Arguments, same as entering the values into a function.
    err = clSetKernelArg(kernel, 0,  sizeof(double), &M);                       debug(err);
    err = clSetKernelArg(kernel, 1,  sizeof(double), &a);                       debug(err);
    err = clSetKernelArg(kernel, 2,  sizeof(double), &iin);                     debug(err);
    err = clSetKernelArg(kernel, 3,  sizeof(double), &phiin);                   debug(err);
    err = clSetKernelArg(kernel, 4,  sizeof(int)   , &nsteps);                  debug(err);
    err = clSetKernelArg(kernel, 5,  sizeof(double), &img_size);                debug(err);
    err = clSetKernelArg(kernel, 6,  sizeof(cl_mem), &output_device_r);         debug(err);
    err = clSetKernelArg(kernel, 7,  sizeof(cl_mem), &output_device_phi);       debug(err);
    err = clSetKernelArg(kernel, 8,  sizeof(cl_mem), &output_device_t);         debug(err);
    err = clSetKernelArg(kernel, 9,  sizeof(cl_mem), &output_device_g);         debug(err);
    err = clSetKernelArg(kernel, 10, sizeof(cl_mem), &output_device_fe);        debug(err);
    err = clSetKernelArg(kernel, 11, sizeof(cl_mem), &output_device_fo);        debug(err);

    //Set WorkSize up so that it processes along the 500x500 array
    size_t localWorkSize[2], globalWorkSize[2];

    //512 is a binary multiple allowed for the global worksize
    globalWorkSize[0] = nsteps;
    globalWorkSize[1] = nsteps;
    //16 is required as its a factor of 512 which is a requirement for the local WorkSize
    localWorkSize[0] = 16;
    localWorkSize[1] = 16;

    printf("Reached Kernel execution\n");

    //Execute the kernel across the GPU cores
    err = clEnqueueNDRangeKernel(d_queue, kernel, 2, NULL, globalWorkSize, localWorkSize, 0, NULL, NULL);  debug(err);
    printf("Waiting for all kernels to finish\n");

    //Wait until all kernels are finished
    err = clFinish(d_queue);  debug(err);
    printf("Finished command Queue\n");

    //Read back from the GPU the information it has calculated

    err = clEnqueueReadBuffer( d_queue, output_device_r,   CL_TRUE, 0, mem_output, output_host_r,   0, NULL, NULL );  debug(err);
    err = clEnqueueReadBuffer( d_queue, output_device_phi, CL_TRUE, 0, mem_output, output_host_phi, 0, NULL, NULL );  debug(err);
    err = clEnqueueReadBuffer( d_queue, output_device_t,   CL_TRUE, 0, mem_output, output_host_t,   0, NULL, NULL );  debug(err);
    err = clEnqueueReadBuffer( d_queue, output_device_g,   CL_TRUE, 0, mem_output, output_host_g,   0, NULL, NULL );  debug(err);
    err = clEnqueueReadBuffer( d_queue, output_device_fe,  CL_TRUE, 0, mem_output, output_host_fe,  0, NULL, NULL );  debug(err);
    err = clEnqueueReadBuffer( d_queue, output_device_fo,  CL_TRUE, 0, mem_output, output_host_fo,  0, NULL, NULL );  debug(err);

    /************ calculate img and save into FITs file 1D array **************/
    fitsfile *fptr;
    int status = 0;
    long fpixel, nelements;
    int bitpix   =  DOUBLE_IMG;
    long naxis = 2;
    long naxes[2] = { nsteps, nsteps };

    fpixel = 1;
    nelements = naxes[0] * naxes[1];
    fits_create_file(&fptr, output, &status);

    /***** save image_g into FITS file *****/
    fits_create_img(fptr, bitpix, naxis, naxes, &status);
    fits_write_img(fptr, TDOUBLE, fpixel, nelements, output_host_r, &status);

    fits_create_img(fptr,  bitpix, naxis, naxes, &status);
    fits_write_img(fptr, TDOUBLE, fpixel, nelements, output_host_phi, &status);

    fits_create_img(fptr,  bitpix, naxis, naxes, &status);
    fits_write_img(fptr, TDOUBLE, fpixel, nelements, output_host_t, &status);

    fits_create_img(fptr,  bitpix, naxis, naxes, &status);
    fits_write_img(fptr, TDOUBLE, fpixel, nelements, output_host_g, &status);
// fits_create_img(fptr,  bitpix, naxis, naxes, &status);
// fits_write_img(fptr, TDOUBLE, fpixel, nelements, output_host_fe, &status);
// fits_create_img(fptr,  bitpix, naxis, naxes, &status);
// fits_write_img(fptr, TDOUBLE, fpixel, nelements, output_host_fo, &status);

    fits_close_file(fptr, &status);

    //FREE MEMORY
    clReleaseMemObject(output_device_r);
    clReleaseMemObject(output_device_phi);
    clReleaseMemObject(output_device_t);
    clReleaseMemObject(output_device_g);
    clReleaseMemObject(output_device_fe);
    clReleaseMemObject(output_device_fo);

    clReleaseProgram(program);
    clReleaseKernel(kernel);
    clReleaseCommandQueue(d_queue);
    clReleaseContext(context);

    free (output_host_r);
    free (output_host_phi);
    free (output_host_t);
    free (output_host_g);
    free (output_host_fe);
    free (output_host_fo);

    return 0;
}

#+END_EXAMPLE

** code-s.c
Integrates from single X-ray source to disk. This does require reflionx.mod to be in the directory that the code is being run from.

./code-s -a0.998 -h2.0 -i53 -p1

Where -p1 or -p2 specifies which GPU to run on (so you can run on both simultaneously)
#+BEGIN_EXAMPLE
// Integration from X-ray source to disk
// PC, AJY - October 2018
// October 2018:
//      Updated to be passed parameters on the command line
//      Example ./code-s -a0.998 -h5.0 -i53
//      Where a = spin (default 0.998) [double]
//			  h = source height (default 5.0) [double]
//			  i = disk inclination angle (default 30) [integer]
// 			  p = GPU platform (default 1) [integer; should be 1 or 2]


//Main C libraries
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <math.h>
#include <fitsio.h>
#include <assert.h>
#include <unistd.h>

#ifdef MAC
#include <OpenCL/cl.h>
#else
#include <CL/cl.h>
#endif

#include "cl-setup.h"


#define sqr(x)((x)*(x))
#define PI M_PI


/****** Declare function of mod *******/


void printerror( int status)
{
    if (status)
    {
        fits_report_error(stderr, status);
        exit( status );
    }
    return;
}


double mod(double x, double y)
{
    double ans;
    ans = x - (y* (int)(x/y));
    return ans;
}


int mod_int(double x, double y)
{
    int ans;
    ans = x - (y* (int)(x/y));
    return ans;
}

/****** Declare function of sig *******/
double sig(double r, double a, double i)
{
    double ans;
    ans = sqr(r) + sqr(a*cos(i));
    return ans;
}

/****** Declare function of del *******/
double del(double r, double a, double M)
{
    double ans;
    ans = sqr(r) - 2.0*M*r + sqr(a);
    return ans;
}

/****** Declare function of A *******/
double A(double r, double a, double M, double i)
{
    double ans;
    ans = sqr(sqr(r)+sqr(a))-sqr(a)*del(r,a,M)*sqr(sin(i));
    return ans;
}

int main(int argc, char **argv)
{
    double a, h, i;
    int c, int_i, p;
    a = 0.998;
    h = 5.0;
    int_i = 30;
    opterr = 0;
    p = 1;
    while ((c = getopt(argc, argv, "h::i::a::p::")) != -1)
    {
		switch (c)
    	{
    		case 'h':
        		sscanf(optarg, "%lf", &h);
		  		break;

    	  	case 'i':
	  			sscanf(optarg, "%i", &int_i);
		  		break;

			case 'a':
				sscanf(optarg, "%lf", &a);
				break;

			case 'p':
				sscanf(optarg, "%i", &p);
				break;

			case '?':
				fprintf (stderr, "Unknown option `-%c'.\n", optopt);
				return 1;
			default:
				abort();
		}
    }
    i = (double)int_i;

    char h_v[3], i_v[3];
    if(mod(h*10,10) == 0){sprintf(h_v, "%i", (int)h);}else{sprintf(h_v, "%ip%i", (int)h, mod_int(h*10,10));}

    //Kernel File path

    char filename[300] = "code-s.cl";
    char output[300];

    sprintf(output, "s-x0-h%s-a0p%03i-i%02i.fits", h_v, (int)(a*1000.0), int_i);
	printf("Output file=%s\n", output);

 //   char output[] = "s-x0-h1p5-a0p998-i53.fits";
    //Declare Main Parameters
    double M       = 1.0;
    double io      = i*PI/180.0;
    double hs      = h;
    double xs      = 0.05;//0.05; //on rotational axis xs = 0.05
    double phi_sky = 0.0;
    double r_out   = 400.0; //*********************************************
    double rmin    = M + sqrt(sqr(M)-sqr(a));
    double phis    = 0.0*PI/180.0;//0.0;
    double dphi    = 2.0*PI/150;
    double nh      = 1.0E+15;
    double r_sky   = 1000.0;
    double Fe, E, N;
    int nsteps_xa = 1024*4;//(int)(2.0/interval + 1.0);
    double interval = (double)(2.0/(nsteps_xa - 1.0));
    int nsteps_xb = 4*nsteps_xa;//4*nsteps_xa;//always > "exact" nsteps_xb which is > (int)(2.0*PI/interval);
    int nsteps_p = 1600;

	/********* Read REFLIONX FITS-file and calculate Fe (emittied total flux in the source frame) ******/
    int j;
    double Ec = 300.0;

    double *energy_min = (double*)malloc(365*sizeof(double));
    double *energy_max = (double*)malloc(365*sizeof(double));
    double *energy_avg = (double*)malloc(365*sizeof(double));

    fitsfile *fptr;
    int status = 0;
    int bitpix   =  DOUBLE_IMG;
    long frow = 1;
    long felem = 1;
    long nelem = 365;
    int hdutype;
    int anynull, nfound;
    float nullval;

    fits_open_file(&fptr, "reflionx.mod", READONLY, &status);
    fits_movabs_hdu(fptr, 3, &hdutype, &status);
    fits_read_col(fptr, TDOUBLE, 1, frow, felem, nelem, &nullval, energy_min, &anynull, &status);
    fits_read_col(fptr, TDOUBLE, 2, frow, felem, nelem, &nullval, energy_max, &anynull, &status);
    fits_close_file(fptr, &status);

    for(j=0; j<365; j++)
    {
        energy_avg[j] = (energy_min[j]+energy_max[j])/2.0;
    }


    //Declare Output FITS Image Variables
    unsigned int size_output_1 = nsteps_xa*nsteps_xb;
    unsigned int mem_output_1 = sizeof(double) * size_output_1;

    double* output_host_dr = (double*) malloc(mem_output_1);
    double* output_host_dphi = (double*) malloc(mem_output_1);
    double* output_host_dt = (double*) malloc(mem_output_1);
    double* output_host_dg = (double*) malloc(mem_output_1);
    double* output_host_cosne = (double*) malloc(mem_output_1);
    double* output_host_i = (double*) malloc(mem_output_1);


    //Declare OpenCL variables

    cl_platform_id platformID;
    cl_device_id deviceID;
    cl_context context;
    cl_program program;
    cl_kernel kernel;
    cl_command_queue d_queue;

    cl_mem output_device_dr;
    cl_mem output_device_dphi;
    cl_mem output_device_dt;
    cl_mem output_device_dg;
    cl_mem output_device_cosne;
    cl_mem output_device_i;


    cl_int err;

    //Create the OpenCL Context Environment
    SelectDevice(&platformID,&deviceID,p);
    const cl_context_properties context_config[3] = {CL_CONTEXT_PLATFORM,(cl_context_properties)platformID,0};
    context = clCreateContext(context_config, 1, &deviceID, NULL, NULL, &err);  debug(err);

    //This makes sure the device that the context is running is the device which was selected earlier
    size_t device_name_len;
    char * device_name;
    clGetDeviceInfo(deviceID, CL_DEVICE_NAME, 0, NULL, &device_name_len);
    device_name = (char*) malloc(device_name_len);

    clGetDeviceInfo(deviceID, CL_DEVICE_NAME, device_name_len, device_name, NULL);
    printf("%s\n",device_name);

    //Creates the command queue
    d_queue = clCreateCommandQueue(context, deviceID, 0, &err); debug(err);

    /**LOAD KERNEL CODE**/
    //Essentially load a file into a string
    FILE *fp;
    char *source_str;
    int source_num=0;
    size_t source_size;
    fp = fopen(filename,"r");
    if(!fp) {fprintf(stderr,"Failed to load kernel. \n");exit(1);}
    fseek(fp, 0L, SEEK_END);
    source_num = ftell(fp);
    fseek(fp, 0, SEEK_SET);

    source_str = (char*)malloc(source_num);
    source_size = fread(source_str,1,source_num,fp);
    fclose(fp);

    //printf("%s",source_str);

    //Create and compile the kernel from the character array
    program = clCreateProgramWithSource(context, 1, (const char **) &source_str, (const size_t *)&source_size, &err);
    debug(err);

    printf("About to build...\n");

    //Acts as the debugger for the kernel, if the build fails this will return a log of the errors.
    if (clBuildProgram(program, 1, &deviceID, NULL, NULL, NULL) != CL_SUCCESS)
    {
        // Determine size of log
        size_t log_size;
        clGetProgramBuildInfo(program, deviceID, CL_PROGRAM_BUILD_LOG, 0, NULL, &log_size);

        // Allocate memory for log
	char *log = (char *)malloc(log_size);

        // Get the low
	clGetProgramBuildInfo(program, deviceID, CL_PROGRAM_BUILD_LOG, log_size, log, NULL);

        // Print the log
	printf("CL Compilation failed:\n%s\n", log);
    }

    //Creates the Kernel after the build. The name "kernel_prog" refers to the function in the kernel file to be called
    kernel = clCreateKernel(program, "kernel_prog", &err); debug(err);

    //Allocate memory within the GPU context, makes the global arrays for returning data back to the CPU environment,
    output_device_dr    = clCreateBuffer(context, CL_MEM_READ_WRITE, mem_output_1, NULL, &err);
    output_device_dphi  = clCreateBuffer(context, CL_MEM_READ_WRITE, mem_output_1, NULL, &err);
    output_device_dt    = clCreateBuffer(context, CL_MEM_READ_WRITE, mem_output_1, NULL, &err);
    output_device_dg    = clCreateBuffer(context, CL_MEM_READ_WRITE, mem_output_1, NULL, &err);
    output_device_cosne = clCreateBuffer(context, CL_MEM_READ_WRITE, mem_output_1, NULL, &err);
    output_device_i     = clCreateBuffer(context, CL_MEM_READ_WRITE, mem_output_1, NULL, &err);
    debug(err);

    //Set Kernel Arguments, same as entering the values into a function.
    err = clSetKernelArg(kernel, 0, sizeof(double), &M);     debug(err);
    err = clSetKernelArg(kernel, 1, sizeof(double), &a);     debug(err);
    err = clSetKernelArg(kernel, 2, sizeof(double), &hs);    debug(err);
    err = clSetKernelArg(kernel, 3, sizeof(double), &xs);    debug(err);
    err = clSetKernelArg(kernel, 4, sizeof(double), &phis);  debug(err);
    err = clSetKernelArg(kernel, 5, sizeof(double), &nh);    debug(err);
    err = clSetKernelArg(kernel, 6, sizeof(double), &Fe);    debug(err);


    err = clSetKernelArg(kernel, 7, sizeof(int), &nsteps_xa);                debug(err);
    err = clSetKernelArg(kernel, 8, sizeof(int), &nsteps_xb);                debug(err);
    err = clSetKernelArg(kernel, 9, sizeof(double), &interval);              debug(err);
    err = clSetKernelArg(kernel, 10, sizeof(double), &r_sky);                debug(err);
    err = clSetKernelArg(kernel, 11, sizeof(cl_mem), &output_device_dr);     debug(err);
    err = clSetKernelArg(kernel, 12, sizeof(cl_mem), &output_device_dphi);   debug(err);
    err = clSetKernelArg(kernel, 13, sizeof(cl_mem), &output_device_dt);     debug(err);
    err = clSetKernelArg(kernel, 14, sizeof(cl_mem), &output_device_dg);     debug(err);
    err = clSetKernelArg(kernel, 15, sizeof(cl_mem), &output_device_cosne);  debug(err);
    err = clSetKernelArg(kernel, 16, sizeof(cl_mem), &output_device_i);      debug(err);


    //Set WorkSize up so that it processes along the 500x500 array
    size_t localWorkSize[2], globalWorkSize[2];

    //512 is a binary multiple allowed for the global worksize
    globalWorkSize[0] = nsteps_xa;
    globalWorkSize[1] = nsteps_xb;
    //16 is required as its a factor of 512 which is a requirement for the local WorkSize
    localWorkSize[0] = 16;//16;
    localWorkSize[1] = 16;//16;

    printf("Reached Kernel execution\n");

    //Execute the kernel across the GPU cores
    err = clEnqueueNDRangeKernel(d_queue, kernel, 2, NULL, globalWorkSize, localWorkSize, 0, NULL, NULL);    debug(err);
    printf("Waiting for all kernels to finish\n");

    //Wait until all kernels are finished
    err = clFinish(d_queue);debug(err);

    printf("Finished command Queue\n");

    //Read back from the GPU the information it has calculated

    err = clEnqueueReadBuffer( d_queue, output_device_dr,    CL_TRUE, 0,mem_output_1, output_host_dr,    0, NULL, NULL );  debug(err);
    err = clEnqueueReadBuffer( d_queue, output_device_dphi,  CL_TRUE, 0,mem_output_1, output_host_dphi,  0, NULL, NULL );  debug(err);
    err = clEnqueueReadBuffer( d_queue, output_device_dt,    CL_TRUE, 0,mem_output_1, output_host_dt,    0, NULL, NULL );  debug(err);
    err = clEnqueueReadBuffer( d_queue, output_device_dg,    CL_TRUE, 0,mem_output_1, output_host_dg,    0, NULL, NULL );  debug(err);
    err = clEnqueueReadBuffer( d_queue, output_device_cosne, CL_TRUE, 0,mem_output_1, output_host_cosne, 0, NULL, NULL );  debug(err);
    err = clEnqueueReadBuffer( d_queue, output_device_i,     CL_TRUE, 0,mem_output_1, output_host_i,     0, NULL, NULL );  debug(err);

    /************ save into table FITs file **************/
    double *data_r     = (double*)malloc(nsteps_xa*nsteps_xb*sizeof(double));
    double *data_phi   = (double*)malloc(nsteps_xa*nsteps_xb*sizeof(double));
    double *data_t     = (double*)malloc(nsteps_xa*nsteps_xb*sizeof(double));
    double *data_g     = (double*)malloc(nsteps_xa*nsteps_xb*sizeof(double));
    double *data_cosne = (double*)malloc(nsteps_xa*nsteps_xb*sizeof(double));

    double *dr   = (double*)malloc(600*sizeof(double));
    double *rbin = (double*)malloc(600*sizeof(double));

    double *data_ot       = (double*)malloc(1*sizeof(double));
    double *data_og       = (double*)malloc(1*sizeof(double));
    double *data_o_factor = (double*)malloc(1*sizeof(double));

    double *data_ot1       = (double*)malloc(nsteps_xa*nsteps_xb*sizeof(double));
    double *data_og1       = (double*)malloc(nsteps_xa*nsteps_xb*sizeof(double));
    double *data_o_factor1 = (double*)malloc(nsteps_xa*nsteps_xb*sizeof(double));

    double *io_pattern    = (double*)malloc(nsteps_p*nsteps_p*sizeof(double));
    double *count_pattern = (double*)malloc(nsteps_p*nsteps_p*sizeof(double));

    int n_rbin =0;
    int j1;
    rbin[0] = rmin;
    for(j1=0; j1<598; j1++)
    {
        if(rbin[j1] <= r_out)
	{
             dr[j1] = 0.01*rbin[j1];
	     rbin[j1+1] = rbin[j1]+dr[j1];
             n_rbin += 1;
	}
	else{j1 = 599;}
    }

    int n_phibin = (2.0*PI/dphi);
    int nbins = n_rbin*n_phibin;
    double *data_rbin     = (double*)malloc(nbins*sizeof(double));
    double *data_dr       = (double*)malloc(nbins*sizeof(double));
    double *data_phibin   = (double*)malloc(nbins*sizeof(double));
    double *data_tbin     = (double*)malloc(nbins*sizeof(double));
    double *data_cosnebin = (double*)malloc(nbins*sizeof(double));
    double *data_countbin = (double*)malloc(nbins*sizeof(double));
    double *data_fbin     = (double*)malloc(nbins*sizeof(double));
    double *data_gbin     = (double*)malloc(nbins*sizeof(double));
    double *data_areabin  = (double*)malloc(nbins*sizeof(double));

    j1 = 0;
    int j2 = 0;
    int j21 = 0;

    int n_total = 0;
    int x1, x2, al, be;
    data_ot[0] = 0.0;
    data_og[0] = 0.0;
    double edge = 0.02;

    for(j=0; j<nbins; j++)
    {
        data_rbin[j]     = rbin[(int)(j/n_phibin)];
        data_dr[j]       = dr[(int)(j/n_phibin)];
        data_phibin[j]   = mod(j,n_phibin)*dphi;
        data_cosnebin[j] = 0.0;
        data_tbin[j]     = 0.0;
        data_countbin[j] = 0.0;
        data_gbin[j]     = 0.0;
        data_areabin[j]  = sqrt(A(data_rbin[j],a,M,M_PI/2.0)/del(data_rbin[j],a,M))/sqrt(1-sqr((A(data_rbin[j],a,M,M_PI/2.0)/(sig(data_rbin[j],a,M_PI/2.0)*sqrt(del(data_rbin[j],a,M))))*(sqrt(M)/(pow(data_rbin[j],1.5)+a*sqrt(M))- 2.0*M*a*data_rbin[j]/A(data_rbin[j],a,M,M_PI/2.0))))*data_dr[j]*dphi ;
        data_fbin[j]     = 0.0;
	//	printf("j= %i/%i r= %lf dr=%lf phi= %lf\n", j, nbins, data_rbin[j], data_dr[j], data_phibin[j]);
    }

    for(j=0; j<nsteps_xa*nsteps_xb; j++)
    {
        data_r[j1]   = 0.0;
        data_phi[j1] = 0.0;
        data_t[j1]   = 0.0;
        data_g[j1]   = 0.0;
        data_cosne[j1] = 0.0;
        n_total += 1;

        if( output_host_dr[j] <= r_out && output_host_dr[j] > rmin && output_host_i[j] >= PI/2.0)
        {
	     data_r[j1]     = output_host_dr[j];
	     data_phi[j1]   = output_host_dphi[j];
	     data_t[j1]     = output_host_dt[j];
             data_g[j1]     = output_host_dg[j];
             data_cosne[j1] = output_host_cosne[j];

	     for(j2=0; j2<n_rbin; j2++)
	     {
	          if(data_r[j1]>=rbin[j2] && data_r[j1]<rbin[j2]+dr[j2] && data_r[j1] <= r_out)
		  {
		       x1 = (j2*n_phibin);
		       //printf("j2= %i phibin= %i X1= %i\n", j2, n_phibin, x1);
		       if(data_phi[j1] >= 0.0)
		       {
			    x2 = (int)(mod(data_phi[j1], 2.0*PI)/dphi);
                       }
                       else
                       {
		            x2 = (int)((mod(data_phi[j1], 2.0*PI) + 2.0*PI)/dphi);
		       }

                       // printf("j= %i/%i data_r= %lf x1= %i dataphi= %lf x2= %i bin= %i/%i\n", j, nsteps_xa*nsteps_xb, data_r[j1], x1, data_phi[j1], x2, x1+x2, nbins);
		       if(x1+x2 >= 0 && x1+x2 < nbins)
		       {
                           data_cosnebin[x1+x2] += data_cosne[j1];
			   data_tbin[x1+x2]     += data_t[j1];
			   data_gbin[x1+x2]     += data_g[j1];
			   data_countbin[x1+x2] += 1.0;
			   j1 += 1;
		       }
		  }
	     }
        }
        if(output_host_dr[j]>=r_sky && output_host_dphi[j] >= phi_sky-edge/2.0 && output_host_dphi[j] <= phi_sky+edge/2.0 && output_host_i[j] >= io-edge/2.0 && output_host_i[j]<= io+edge/2.0)
	{
             data_ot1[j21+1] =  output_host_dt[j];
             data_og1[j21+1] = output_host_dg[j];
             j21 += 1;
	}
    }
/*
    for(j = 1; j <= j21; j+= 1)
    {
        data_ot[0] += data_ot1[j]/j21;
        data_og[0] += data_og1[j]/j21;
    }
  */
    double to_min = 20000.0;
    for(j = 1; j <= j21; j+= 1)
    {
        if(data_ot1[j] < to_min)
	{
	    data_ot[0] = data_ot1[j];
	    data_og[0] = data_og1[j];
	    to_min     =  data_ot[0];
	}
    }

    data_o_factor[0] = ((double)j21/n_total)/(edge*edge);

    for(j=0; j< nbins; j++)
    {
        if(data_countbin[j] > 0.0)
	{
	    data_gbin[j]     = data_gbin[j]/data_countbin[j];
	    data_tbin[j]     = data_tbin[j]/data_countbin[j];
 	    data_cosnebin[j] = data_cosnebin[j]/data_countbin[j];
	    data_fbin[j]     = (data_countbin[j]/n_total);
        }
    }

    fits_create_file(&fptr, output, &status);

    char extname1[] = "s-o";
    char extname2[] = "s-d";
    char extname3[] = "s-d-bin";
    int ncolumns1 = 3;
    int ncolumns2 = 4;
    int ncolumns3 = 7;
    int nrows1 = 1;
    int nrows2 = j1; //nsteps_xa*nsteps_xb+1;
    int nrows3 = nbins;

    char *ttype1[] = { "time", "g", "o_factor" };
    char *tform1[] = { "1D", "1D" , "1D"};
    char *tunit1[] = { "\0", "\0" , "\0"};
    char *ttype2[] = { "r", "phi", "time", "g"};
    char *tform2[] = { "1D", "1D", "1D", "1D"};
    char *tunit2[] = { "\0", "\0", "\0", "\0" };
    char *ttype3[] = { "rbin", "phibin", "tbin", "iobin", "countbin", "gbin", "areabin" };
    char *tform3[] = { "1D", "1D", "1D", "1D", "1D", "1D", "1D" };
    char *tunit3[] = { "\0", "\0", "\0", "\0", "\0", "\0", "\0" };

    fits_create_tbl( fptr, BINARY_TBL, nrows1, ncolumns1, ttype1, tform1, tunit1, extname1, &status);
    fits_write_col(fptr, TDOUBLE, 1, frow, felem, nrows1, data_ot,&status);
    fits_write_col(fptr, TDOUBLE, 2, frow, felem, nrows1, data_og,&status);
    fits_write_col(fptr, TDOUBLE, 3, frow, felem, nrows1, data_o_factor,&status);
    fits_create_tbl( fptr, BINARY_TBL, nrows2, ncolumns2, ttype2, tform2,tunit2, extname2, &status);
    fits_write_col(fptr, TDOUBLE, 1, frow, felem, nrows2, data_r,&status);
    fits_write_col(fptr, TDOUBLE, 2, frow, felem, nrows2, data_phi,&status);
    fits_write_col(fptr, TDOUBLE, 3, frow, felem, nrows2, data_t,&status);
    fits_write_col(fptr, TDOUBLE, 4, frow, felem, nrows2, data_g,&status);

    fits_create_tbl( fptr, BINARY_TBL, nrows3, ncolumns3, ttype3, tform3,tunit3, extname3, &status);
    fits_write_col(fptr, TDOUBLE, 1, frow, felem, nrows3, data_rbin,&status);
    fits_write_col(fptr, TDOUBLE, 2, frow, felem, nrows3, data_phibin,&status);
    fits_write_col(fptr, TDOUBLE, 3, frow, felem, nrows3, data_tbin,&status);
    fits_write_col(fptr, TDOUBLE, 4, frow, felem, nrows3, data_cosnebin,&status);
    fits_write_col(fptr, TDOUBLE, 5, frow, felem, nrows3, data_fbin,&status);
    fits_write_col(fptr, TDOUBLE, 6, frow, felem, nrows3, data_gbin,&status);
    fits_write_col(fptr, TDOUBLE, 7, frow, felem, nrows3, data_areabin,&status);
    fits_close_file(fptr, &status);

    //FREE MEMORY
    clReleaseMemObject(output_device_dr);
    clReleaseMemObject(output_device_dphi);
    clReleaseMemObject(output_device_dt);
    clReleaseMemObject(output_device_dg);
    clReleaseMemObject(output_device_cosne);
    clReleaseMemObject(output_device_i);

    clReleaseProgram(program);
    clReleaseKernel(kernel);
    clReleaseCommandQueue(d_queue);
    clReleaseContext(context);

    free (output_host_dr);
    free (output_host_dphi);
    free (output_host_dt);
    free (output_host_dg);
    free (output_host_cosne);
    free (output_host_i);


    free(data_r);
    free(data_phi);
    free(data_t);
    free(data_g);

    free(data_cosne);
    free(data_rbin);
    free(data_phibin);
    free(data_tbin);
    free(data_cosnebin);
    free(data_countbin);
    free(data_areabin);
    free(data_gbin);
    free(io_pattern);
    free(count_pattern);
    return 0;
}

#+END_EXAMPLE

** code-x.c
This calculates the spectra for a given source height and disk inclination that have already been computed.

Example ./code-x -i53.0 -h4.0 -g2.0 -A1.0 -x0.0 -p0.0 Where i = inclination angle [double] g = photon index [double] A = iron abundance [double] x = log_10 (ionization parameter) [double] p = index of disk density profile [double]

The ionization parameter is specified at the innermost stable circular orbit. The density drops off as r^-p, and this goes into the calculation of the ionization parameter at an arbitrary radius.

N.B. spin=0.998 is currently hard-wired in r_out=400 is currently hard-wired in [?] img_size=400 is currently hard-wired in [?] not sure if this is used?
#+BEGIN_EXAMPLE
// Calculates the spectrum from a single X-ray point source
// Assumes code-img has already been run to produce a disk image
// Assumes code-s has already been run to produce a disk illumination image
// This code combines the two and produces the spectrum
// PC, AJY Nov 2018

// November 2019:
//      Example ./code-x -i55.0 -a0.998 -h4.0 -g2.0 -A1.0 -x0.0 -p0.0
//      Where	h = source height [double]
//				i = inclination angle (default 30 degrees) [double]
//				g = photon index [double]
//				A = iron abundance [double]
//				x = log_10 (ionization parameter) [double]
//				p = index of disk density profile [double]
//
// NB - r_out=400 is currently hard-wired in [?]
// NB - img_size=400 is currently hard-wired in [?] not sure if this is used?

#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include <unistd.h>
#include "fitsio.h"

#define PI M_PI
#define sqr(x)((x)*(x))

void printerror( int status)
{
    if (status)
    {
       fits_report_error(stderr, status);
       exit( status );
    }
    return;
}

double rms(double a, double M)
{
	double z1, z2, ans;
	z1 = 1.0 + pow((1.0 - sqr(a/M)),1.0/3.0)*(pow(1.0+a/M,1.0/3.0)+pow(1.0-a/M,1.0/3.0));
	z2 = sqrt(3.0*sqr(a/M) + sqr(z1));
	ans = M*(3.0 + z2 -sqrt((3.0 - z1)*(3.0 + z1 + 2.0*z2)));

	return ans;
}

double mod(double x, double y)
{	double ans;
	ans = x - (y* (int)(x/y));
	return ans;
}


int mod_int(double x, double y)
{	int ans;
	ans = x - (y* (int)(x/y));
	return ans;
}

int main (int argc, char **argv)
{

double a, p, h, i, g, A, x;
  int c;
  a = 0.998;
  h = 8.0;
  i = 30.0;
  g = 2.7;
  A = 5.0;
  x = 3.7;
  p = 1.5;
  opterr = 0;
	while ((c = getopt(argc, argv, "h::a::i::g::A::x::p::")) != -1)
		switch (c)
		{
      		case 'h':
				sscanf(optarg, "%lf", &h);
				break;

			case 'a':
				sscanf(optarg, "%lf", &a);
				break;
      		case 'i':
				sscanf(optarg, "%lf", &i);
				break;
      		case 'g':
				sscanf(optarg, "%lf", &g);
				break;
      		case 'A':
				sscanf(optarg, "%lf", &A);
				break;
		    case 'x':
				sscanf(optarg, "%lf", &x);
				break;
      		case 'p':
				sscanf(optarg, "%lf", &p);
				break;

      case '?':
	if (optopt == 'c' || optopt == 'p')
	  fprintf (stderr, "Option -%c requires an argument.\n", optopt);
	else if (isprint (optopt))
	  fprintf (stderr, "Unknown option `-%c'.\n", optopt);
	else
	  fprintf (stderr,
		   "Unknown option character `\\x%x'.\n",
		   optopt);
	return 1;
      	default:
	abort ();
      }


	char h_v[3], i_v[3], g_v[3], A_v[3], x_v[3], p_v[3];
	if(mod(h*10,10) == 0){sprintf(h_v, "%i", (int)h);}else{sprintf(h_v, "%ip%i", (int)h, mod_int(h*10,10));}
	if(mod(i*10,10) == 0){sprintf(i_v, "%i", (int)i);}else{sprintf(i_v, "%ip%i", (int)i, mod_int(i*10,10));}
	if(mod(g*10,10) == 0){sprintf(g_v, "%i", (int)g);}else{sprintf(g_v, "%ip%i", (int)g, mod_int(g*10,10));}
	if(mod(A*10,10) == 0){sprintf(A_v, "%i", (int)A);}else{sprintf(A_v, "%ip%i", (int)A, mod_int(A*10,10));}
	if(mod(x*10,10) == 0){sprintf(x_v, "%i", (int)x);}else{sprintf(x_v, "%ip%i", (int)x, mod_int(x*10,10));}
	if(mod(p*10,10) == 0){sprintf(p_v, "%i", (int)p);}else{sprintf(p_v, "%ip%i", (int)p, mod_int(p*10,10));}

	printf("h=%s i=%s g=%s A=%s x=%s p = %s\n", h_v, i_v, g_v, A_v, x_v, p_v);



double  *img_r, *data_t, *data_g, err_r, err_phi, min_gap, gap, M, *npoint, *data_E, *img_phi, *t_do, *g_do, *disk_r, x2, x1, y2, y1,*disk_phi, *data_T, *data_f, *disk_cosne, *disk_count, d_index, *t_sd, log_c_dr, *data_io, *data_area, c_dphi, energy_index, fix_sola, ph_index, *Aio, As, ne_avg, Ec, dphi, r_out, fix_rin_io;
	int nsteps, img_size, iobs, d_nsteps, j, j1, j2, j3, j4, j5, jx, z, x3, x4, count;

	char img_filename[255];
	char s_filename[255];
    char x_filename[255];
	sprintf(img_filename, "img-i%s-a0p998-r400-8192.fits", i_v);
    sprintf(s_filename, "s-x0-h%s-a0p998-i%s.fits", h_v, i_v);
	sprintf(x_filename, "x-h%s-a0p998-i%s-g%s-A%s-x%s-p%s.fits", h_v, i_v, g_v, A_v, x_v, p_v);

	ph_index = g;
	fix_sola = A;
	fix_rin_io = pow(10.0,x);
	d_index = p;

	r_out = 400;
//	As = 1.0e+24 //1.0;// //l=24, m=28, h=32
	// iobs should be set to zero in the new code
	iobs = 0; //0, 1, 2,3, 4 for inclination angle 15, 30, 45, 60, 80
	log_c_dr = 0.01;
	c_dphi= 150.0;
	nsteps = 1024*8;
	dphi = 2.0*PI/c_dphi;
	img_size = 400;

	Ec = 300.0;


	int n_phibin = 2.0*PI/dphi;
	int tbin = 1000;
	double dt = 1.0;
	double sub_Ebin = 10.0;
	M = 1;

/***************************************************************************************/

	fitsfile *fptr;
	int status = 0;
	int bitpix   =  DOUBLE_IMG;
	long naxis = 2;
	int hdutype;
 	long naxes[2] = { nsteps, nsteps };
  	int anynull, nfound;
	long nelements = nsteps*nsteps;
	long npixels  = naxes[0] * naxes[1];         /* number of pixels in the image */
  	int fpixel   = 1;
  	int frow      = 1;
	int felem     = 1;
	float nullval  = 0;                /* don't check for null values in the image */
	long naxes1[1], naxes2[1];

	img_r = (double *)malloc(nsteps*nsteps*sizeof(double));
	img_phi = (double *)malloc(nsteps*nsteps*sizeof(double));
	t_do = (double *)malloc(nsteps*nsteps*sizeof(double));
	g_do = (double *)malloc(nsteps*nsteps*sizeof(double));

	printf("Reading img file\n");

	if ( fits_open_file(&fptr, img_filename, READWRITE, &status) )
        printerror( status );

	if ( fits_movabs_hdu(fptr, 1, &hdutype, &status) )
	printerror( status );

	if ( fits_read_img(fptr, TDOUBLE, fpixel, npixels, &nullval,
             img_r, &anynull, &status) )
        printerror( status );

	if ( fits_movabs_hdu(fptr, 2, &hdutype, &status) )
	printerror( status );

	if ( fits_read_img(fptr, TDOUBLE, fpixel, npixels, &nullval,
             img_phi, &anynull, &status) )
        printerror( status );

	if ( fits_movabs_hdu(fptr, 3, &hdutype, &status) )
	printerror( status );

	if ( fits_read_img(fptr, TDOUBLE, fpixel, npixels, &nullval,
             t_do, &anynull, &status) )
	printerror( status );

        if ( fits_movabs_hdu(fptr, 4, &hdutype, &status) )
	printerror( status );

	if ( fits_read_img(fptr, TDOUBLE, fpixel, npixels, &nullval,
             g_do, &anynull, &status) )
	printerror( status );

	if (fits_close_file(fptr, &status))
      	printerror( status );

	printf("Reading s file\n");

	if ( fits_open_file(&fptr, s_filename, READWRITE, &status) )
        printerror( status );

	if ( fits_movabs_hdu(fptr, 4, &hdutype, &status) )
        printerror( status );

	if ( fits_read_keys_lng(fptr, "NAXIS", 1, 2, naxes1, &nfound, &status) )
      	printerror( status );

	printf("  ... read keys\n");

	int k = naxes1[1];

	disk_r = (double *)malloc(k*sizeof(double));
	disk_phi = (double *)malloc(k*sizeof(double));
	double *disk_g = (double *)malloc(k*sizeof(double));
	t_sd = (double *)malloc(k*sizeof(double));
data_io = (double *)malloc(k*sizeof(double));
	data_f = (double *)malloc(k*sizeof(double));
	data_g = (double *)malloc(k*sizeof(double));
	data_E = (double *)malloc(k*sizeof(double));
	data_t = (double *)malloc(k*sizeof(double));
	data_T = (double *)malloc(k*sizeof(double));
	npoint = (double *)malloc(k*sizeof(double));
	Aio = (double *)malloc(k*sizeof(double));
	data_area = (double *)malloc(k*sizeof(double));
	disk_cosne = (double *)malloc(k*sizeof(double));
double	*plot_io = (double *)malloc(400*sizeof(double));
double	*count_io = (double *)malloc(400*sizeof(double));
double	*r_io = (double *)malloc(400*sizeof(double));

	if( fits_read_col(fptr, TDOUBLE, 1, frow, felem, k, &nullval,  disk_r,
            &anynull, &status))
	    printerror( status );

	if( fits_read_col(fptr, TDOUBLE, 2, frow, felem, k, &nullval, disk_phi,
            &anynull, &status))
	    printerror( status );

	if( fits_read_col(fptr, TDOUBLE, 3, frow, felem, k, &nullval, t_sd,
            &anynull, &status))
	    printerror( status );

	if( fits_read_col(fptr, TDOUBLE, 4, frow, felem, k, &nullval, disk_cosne,
            &anynull, &status))
	  printerror( status );

	if( fits_read_col(fptr, TDOUBLE, 5, frow, felem, k, &nullval, data_f,
            &anynull, &status))
	  printerror( status );

	if( fits_read_col(fptr, TDOUBLE, 6, frow, felem, k, &nullval, disk_g,
            &anynull, &status))
	  printerror( status );

	if( fits_read_col(fptr, TDOUBLE, 7, frow, felem, k, &nullval, data_area,
            &anynull, &status))
	  printerror( status );

	printf("  ... read in a bunch of disk info\n");

if ( fits_movabs_hdu(fptr, 2, &hdutype, &status) )
        printerror( status );

	if ( fits_read_keys_lng(fptr, "NAXIS", 1, 2, naxes2, &nfound, &status) )
        printerror( status );

	int k0 = 1;//naxes2[1]; ;

	double *t_so = (double *)malloc(k0*sizeof(double));
	double *g_so = (double *)malloc(k0*sizeof(double));
	double *o_factor = (double *)malloc(k0*sizeof(double));

	if( fits_read_col(fptr, TDOUBLE, 1, frow, felem, k0, &nullval,  t_so,
            &anynull, &status))
	    printerror( status );

	if( fits_read_col(fptr, TDOUBLE, 2, frow, felem, k0, &nullval,  g_so,
            &anynull, &status))
	    printerror( status );

	  if( fits_read_col(fptr, TDOUBLE, 3, frow, felem, k0, &nullval,  o_factor,
            &anynull, &status))
	    printerror( status );

	if (fits_close_file(fptr, &status))
        printerror( status );

/******************************************************************
	read all values of sola abundance, photon index, and ionization parameter into 1 array, data[i]
	******************************************************************/

	printf("Reading reflionx\n");

	if ( fits_open_file(&fptr, "reflionx.mod", READONLY, &status) )
        printerror( status );

	double *data = (double*)malloc(1800*3*sizeof(double));
	double *e_min = (double*)malloc(365*sizeof(double));
	double *e_max = (double*)malloc(365*sizeof(double));
	double *e_avg = (double*)malloc(365*sizeof(double));
	double *sola = (double *)malloc(1800*sizeof(double));
	double *index = (double *)malloc(1800*sizeof(double));
	double *io = (double *)malloc(1800*sizeof(double));
	double *r_flux = (double *)malloc(365*sizeof(double));
	double *d_flux = (double *)malloc(365*sizeof(double));

        if ( fits_movabs_hdu(fptr, 4, &hdutype, &status) )
        printerror( status );

	int nelem     = 1800*3;

 	if( fits_read_col(fptr, TDOUBLE, 1, frow, felem, nelem, &nullval,  data,
            &anynull, &status))
	    printerror( status );

	/**********************************************************************
	seperate the values of sola abundance, photon index, and ionization parameter from data[j] and store them
	into the array sola[j], index[j], and io[j] respectively.
	**********************************************************************/

	j = 0;	for(j1=0; j1<1800*3; j1+=3.0){sola[j]=data[j1]; j+=1;}
	j = 0;	for(j1=1; j1<1800*3; j1+=3.0){index[j]=data[j1]; j+=1;}
	j = 0;	for(j1=2; j1<1800*3; j1+=3.0){io[j]=data[j1]; j+=1;}
	free(data);

	int n_min = 1799;
	int n_max = 0;
	for(j=0; j<1800; j++)
	{
		if(ph_index + 0.0001>= index[j] && ph_index - 0.0001<= index[j] && fix_sola + 0.0001 >= sola[j] && fix_sola - 0.0001 <= sola[j])
		{
			if(j<n_min) {n_min = j;}
			if(j>n_max) {n_max = j;}
			printf("index= %lf sola= %lf\n", index[j], sola[j]);
		}
	}
	free(index);
	free(sola);

	/**********************************************
	store all flux from refionx model into data[j]
	***********************************************/

	data = (double*)malloc(1800*365*sizeof(double));
	nelem = 1800*365;

	if ( fits_read_col(fptr, TDOUBLE, 2, frow, felem, nelem, &nullval,  data,
             &anynull, &status))
	     printerror( status );

	if ( fits_movabs_hdu(fptr, 3, &hdutype, &status) )
             printerror( status );

      	nelem = 365;

	if ( fits_read_col(fptr, TDOUBLE, 1, frow, felem, nelem, &nullval,  e_min,
             &anynull, &status))
	     printerror( status );

        if ( fits_read_col(fptr, TDOUBLE, 2, frow, felem, nelem, &nullval,  e_max,
             &anynull, &status))
	     printerror( status );

	if( fits_close_file(fptr, &status) )
            printerror( status );

	for(j=0; j<365; j++)
	{
		e_avg[j] = (e_min[j]+e_max[j])/2.0;
	}
	double En, Fe;
	Fe = 0.0;
	for(En = e_min[0]; En <e_max[364]; En+=0.0001)
	{
		Fe += pow(En,-ph_index+1.0)*exp(-En/Ec)*(0.0001);  // energy flux - keV unit

	}
/*****************************************************************************
	convert the value of ionization parameters to the values which are available in reflionx model -->i o para = {10.0, 20.0, 50.0, 100.0, 200.0, 500.0, 1000.0, 2000.0, 5000.0, 10000.0};
	/****************************************************************************/
	printf("k = %i\n",k);
	int cc;
	double  min_r, io_min;
	for(j=0; j<400; j++)
	{
		plot_io[j] = 0.0;
		count_io[j] = 0.0;
		r_io[j] = j;
	}

	min_r = 10.0;
	for(j=0; j<k; j++)
	{
		if(disk_r[j] > rms(a,M) && disk_r[j] <= min_r && data_f[j]>0.0)
		{
				min_r = disk_r[j];
				cc = j;
		}
	//	data_f[j] = data_f[j]/(data_area[j]/*disk_cosne[j]*/);
		data_f[j] = pow(disk_g[j], ph_index)*Fe*data_f[j]/(data_area[j]/*disk_cosne[j]*/);
		data_io[j] = 4.0*PI*(data_f[j])*(1.6*1.0E-9)/(pow(disk_r[j],-d_index));
	}
	As = fix_rin_io/data_io[cc];
	io_min = data_io[cc];
	for(j=0; j<k; j++)
	{
		data_io[j] = As*data_io[j];
		Aio[j] = 0.0;
		jx = (int)(disk_r[j]);
		plot_io[jx] += data_io[j];
		count_io[jx] += 1.0;


		printf("j=%i/%i r=%lf io_min=%lf io=%lf ", j, k, disk_r[cc], io_min*As, data_io[j]);
		if(disk_r[j] > rms(a,M) && data_io[j] >= 0.0 && data_io[j] <= 15.0 ) {Aio[j] =data_io[j]/10.0; data_io[j] = 10.0;}
		else if(disk_r[j] > rms(a,M) && data_io[j] > 15.0 && data_io[j] <= 35.0) {Aio[j] =data_io[j]/20.0; data_io[j] = 20.0; }
		else if(disk_r[j] > rms(a,M) && data_io[j] > 35.0 && data_io[j] <= 75.0) {Aio[j] =data_io[j]/50.0; data_io[j] = 50.0; }
		else if(disk_r[j] > rms(a,M) && data_io[j] > 75.0 && data_io[j] <= 150.0) {Aio[j] =data_io[j]/100.0; data_io[j] = 100.0;}
		else if(disk_r[j] > rms(a,M) && data_io[j] > 150.0 && data_io[j] <= 350.0) {Aio[j] =data_io[j]/200.0; data_io[j] = 200.0; }
		else if(disk_r[j] > rms(a,M) && data_io[j] > 350.0 && data_io[j] <= 750.0) {Aio[j] =data_io[j]/500.0; data_io[j] = 500.0; }
		else if(disk_r[j] > rms(a,M) && data_io[j] > 750.0 && data_io[j] <= 1500.0) {Aio[j] =data_io[j]/1000.0; data_io[j] = 1000.0; }
		else if(disk_r[j] > rms(a,M) && data_io[j] > 1500.0 && data_io[j] <= 3500.0) {Aio[j] =data_io[j]/2000; data_io[j] = 2000.0; }
		else if(disk_r[j] > rms(a,M) && data_io[j] > 3500.0 && data_io[j] <= 7500.0) {Aio[j] =data_io[j]/5000.0; data_io[j] = 5000.0; }
		else if(disk_r[j] > rms(a,M) && data_io[j] > 7500.0) {Aio[j] =data_io[j]/10000.0; data_io[j] =10000.0;}

		printf("newio=%lf Aio=%lf\n", data_io[j], Aio[j]);

	}

	for(j=0; j<k; j++)
	{
		data_t[j] = 0.0;
		data_g[j] = 0.0;
		npoint[j] = 0.0;
	}
	printf("rh=%lf rms= %lf\n",M + sqrt(sqr(M)-sqr(a)),rms(a,M));
/******** map the bins on the disks to the position on the observer's sky ********/
    double *dr = (double*)malloc(600*sizeof(double));
  double *rbin = (double*)malloc(600*sizeof(double));
int nod = 0;
int    nd = 0;
int nx = 0;
double minimum_d, d;
int position;

int n_rbin =0;

	rbin[0] = M + sqrt(sqr(M)-sqr(a));
	for(j1=0; j1<598; j1++)
	{
		if(rbin[j1] <= r_out)
		{
		dr[j1] = log_c_dr*rbin[j1];
		rbin[j1+1] = rbin[j1]+dr[j1];
		n_rbin += 1;
	//	printf("j=%i r= %lf, dr= %lf n_rbin= %i\n",j1, rbin[j1], dr[j1], n_rbin);
		}
		else{
			j1 = 599;
		}
	}

	for(z=0; z< nsteps*nsteps; z+=1)
	{
	if(img_r[z]>rbin[0] && img_r[z] < r_out)
	{

		for(j2=0; j2<n_rbin; j2++)
		{
			if(img_r[z]>=rbin[j2] && img_r[z]<rbin[j2]+dr[j2])
			{
				x3 = j2*n_phibin;
				//printf("j2= %i phibin= %i X1= %i\n", j2, n_phibin, x1);
			}
		}

		if(img_phi[z] >= 0.0)
		{x4 = (int)(mod(img_phi[z], 2.0*PI)/dphi);
		}else{x4 = (int)((mod(img_phi[z], 2.0*PI) + 2.0*PI)/dphi);}
	//	printf("r=%lf phi=%lf x3=%i x4=%i x3+x4 = %i < %i\n", img_r[z], img_phi[z], x3, x4, x3+x4, k);

		if(x3+x4 >= 0 && x3+x4 < k)//&&  Aio[x3+x4] > 0)
		{
	//	printf("x3+x4 =%i\n", x3+x4);
		data_t[x3+x4] += t_do[z];
		data_g[x3+x4] += g_do[z];
		npoint[x3+x4] += 1.0;
		nod +=1;
			if(Aio[x3+x4]>0.0)
			{
			nd += 1;
			}
		}
	}
	}
	printf("nd/nod= %i/%i missing=%i \n", nd, nod, nod-nd);

	double *r_spec_oframe = (double *)malloc(365*sizeof(double));
	double *r_spec_dframe = (double *)malloc(365*sizeof(double));
	double *d_spec = (double *)malloc(365*sizeof(double));
	double *N = (double *)malloc(365*tbin*sizeof(double));
	double *E = (double *)malloc(365*tbin*sizeof(double));
	double *T = (double *)malloc(365*tbin*sizeof(double));

	double *trf_f= (double *)malloc(tbin*sizeof(double));
	double *trf_t = (double *)malloc(tbin*sizeof(double));
	int bin;
	double f_ref;
	int c1 =0;
	int c2 =0;
	int c3 =0;
	int c4 =0;

	for(j=0; j<365; j++)
	{
		r_spec_oframe[j] = 0.0;
		r_spec_dframe[j] = 0.0;
		d_spec[j] = 0.0;
	}

	for(j=0; j<tbin; j++)
	{
		trf_f[j] = 0.0;
		trf_t[j] = (j)*dt;
		for(j3=0;j3<365;j3++)
		{
			T[365*j + j3] = (j+1)*dt;
			N[365*j + j3] = 0.0;
			E[365*j + j3] = e_min[j3];
		}
	}



	// Calculate reflection spectrum & 2D-response function ---------------------------------------------------------------------------------

	for(j=0; j<k; j++)
	{
		if(npoint[j] > 0.0 && Aio[j] > 0.0 && disk_r[j] > rms(a,M)  && disk_r[j] <= r_out)
		{
		data_t[j] = data_t[j]/npoint[j] + t_sd[j] - t_so[iobs];
		data_g[j] = data_g[j]/npoint[j];
		bin = (int)(data_t[j]/dt);





		for(j1=n_min; j1<=n_max; j1++)
		{
			f_ref = 0.0;
			if(data_io[j] >= io[j1] - 0.01 && data_io[j] <= io[j1] + 0.01)
			{
				for(j2=0; j2<365; j2++)
				{
					f_ref += data[(j1*365)+j2]*e_avg[j2];//*data_area[j];
				}

				for(j2=0; j2<365; j2++)
				{

					r_spec_dframe[j2] += ((data_f[j])/f_ref)*data[(j1*365)+j2]*sqr(e_avg[j2])/(e_max[j2]-e_min[j2]);

					for(j5=0; j5<sub_Ebin; j5++)
					{
						ne_avg = data_g[j]*(e_min[j2]+j5*(e_max[j2]-e_min[j2])/sub_Ebin);

						for(j4=0; j4<365; j4+= 1)
						{

							if(ne_avg > e_min[j4] && ne_avg <= e_max[j4])
							{
								r_spec_oframe[j4] +=  ((data_f[j])/f_ref)*pow(data_g[j],3.0)*((data[(j1*365)+j2]/sub_Ebin)/(2.0*PI))*sqr(2.0*r_out/1000.0)*(npoint[j]/sqr(4096.0))*sqr(ne_avg)/(e_max[j4]-e_min[j4]); // -> counts/s/keV * E^2
								N[365*bin + j4] += (data_f[j]/f_ref)*pow(data_g[j],3.0)*((data[(j1*365)+j2]/sub_Ebin)/(2.0*PI))*sqr(2.0*r_out/1000.0)*(npoint[j]/sqr(4096.0)); // -> counts/s


							}
						}
					}
				}
			}
		}

		}
	}

	// Calculate direct spectrum -------------------------------------------------------------------------------------------------------------

	double Eo, nE;
	for(Eo = e_min[0]; Eo<e_max[364]; Eo+=0.0001)
	{
		nE = g_so[iobs]*Eo;
		for(j4=0; j4<365; j4+= 1)
		{
			if(nE > e_min[j4] && nE <= e_max[j4])
			{
				d_spec[j4] += pow(g_so[iobs],ph_index)*(o_factor[iobs])*pow(nE,-ph_index+1.0)*exp(-nE/Ec)*nE*0.0001/(e_max[j4] - e_min[j4]);  // counts/s/keV * E^2

			}
		}
	}


	for(j=0; j<400; j++)
	{

		plot_io[j] = plot_io[j]/count_io[j];
	}

	plot_io[1] = 100000.0;

	free(disk_phi);
	free(img_phi);
	free(img_r);
	free(t_do);
	free(g_do);
	free(data_io);
	free(t_sd);

	if (fits_create_file(&fptr, x_filename, &status))
  	printerror( status );

	char extname3[] = "reflected spectra";
	char extname5[] = "direct spectra";
	char extname7[] = "trf-2D";
	char extname4[] = "plot-r-io";
	int ncolumns3 = 3;
	int ncolumns5 = 2;
	int ncolumns7 = 3;
	int nrows3 = 365;
	int nrows5 = 365;
	int nrows7 = 365*tbin;
	int nrows4 = 400;
	char *ttype3[] = { "energy_avg_r", "rflux_oframe", "rflux_dframe" };
	char *tform3[] = { "1D", "1D", "1D" };
	char *tunit3[] = { "\0", "\0", "\0" };
	char *ttype5[] = { "energy_avg_d", "dflux" };
	char *ttype4[] = { "r", "io" };
	char *tform5[] = { "1D", "1D" };
	char *tunit5[] = { "\0", "\0" };
	char *ttype7[] = { "E", "t", "N" };
	char *tform7[] = { "1D", "1D", "1D" };
	char *tunit7[] = { "\0", "\0", "\0" };

	if ( fits_create_tbl( fptr, BINARY_TBL, nrows3, ncolumns3, ttype3, tform3,
             tunit3, extname3, &status) )
        printerror( status );

     	fits_write_col(fptr, TDOUBLE, 1, frow, felem, nrows3, e_min,
                       &status);

	fits_write_col(fptr, TDOUBLE, 2, frow, felem, nrows3, r_spec_oframe,
                       &status);

	fits_write_col(fptr, TDOUBLE, 3, frow, felem, nrows3, r_spec_dframe,
                      &status);
	free(r_spec_oframe);
	free(r_spec_dframe);

	if ( fits_create_tbl( fptr, BINARY_TBL, nrows5, ncolumns5, ttype5, tform5,
             tunit5, extname5, &status) )
        printerror( status );

     	fits_write_col(fptr, TDOUBLE, 1, frow, felem, nrows5, e_min,
                       &status);
	free(e_avg);

	fits_write_col(fptr, TDOUBLE, 2, frow, felem, nrows5, d_spec,
                       &status);
	free(d_spec);

	if ( fits_create_tbl( fptr, BINARY_TBL, nrows7, ncolumns7, ttype7, tform7,
             tunit7, extname7, &status) )
        printerror( status );

     	fits_write_col(fptr, TDOUBLE, 1, frow, felem, nrows7, E,
                       &status);
	free(data_E);

    	fits_write_col(fptr, TDOUBLE, 2, frow, felem, nrows7, T,
                       &status);

    	fits_write_col(fptr, TDOUBLE, 3, frow, felem, nrows7, N,
                       &status);
	free(data_t);

	if ( fits_create_tbl( fptr, BINARY_TBL, nrows4, ncolumns5, ttype4, tform5,
             tunit5, extname4, &status) )
        printerror( status );

     	fits_write_col(fptr, TDOUBLE, 1, frow, felem, nrows4, r_io,
                       &status);
	free(disk_r);

	fits_write_col(fptr, TDOUBLE, 2, frow, felem, nrows4, plot_io,
                       &status);
	free(plot_io);


 	if (fits_close_file(fptr, &status))
        printerror( status );

return 0;
}

#+END_EXAMPLE

** submit-code-x.pl
This Perl script instructs the supercomputer to runa grid of code-x runs for different source heights, photon indices and ionization parameters.

Run by typing ./submit-code-x.pl

Note that this code assumes the GitHub repository (and compiled code) is in your home directory on BlueCrystal and that the output directory is in /mnt/storage/scratch/${LOGNAME}/2-blob-output where ${LOGNAME} is your login id (e.g., phajy for me). The output directory should itself contain a directory called submit-scripts where the auto-generated scripts are stored.
#+BEGIN_EXAMPLE
#! /usr/bin/perl -w

use strict;

# Parameters for 1H 0707-405
# Inclination angle of disk ("i")
my $inclination_low = 53.0;
my $inclination_high = 53.0;
my $inclination_delta = 1.0;
# Source height ("h")
my $source_height_low = 2.0;
my $source_height_high = 9.0;
my $source_height_delta = 1.0;
# Photon index ("g")
my $photon_index_low = 2.5;
my $photon_index_high = 3.3;
my $photon_index_delta = 0.2;
# Ionization parameter ("x");
my $ionization_low = 2.0;
my $ionization_high = 3.0;
my $ionization_delta = 0.5;

# For testing this code set do_not_submit to 1. This will produce the submit scripts but not actually submit them. Set this to 0 to actually submit the jobs.
my $do_not_submit = 0;

my $i;
my $h;
my $g;
my $x;

my $n = 0;

for ($i=$inclination_low; $i <= $inclination_high; $i += $inclination_delta)
{
	for ($h = $source_height_low; $h <= $source_height_high; $h += $source_height_delta)
	{
		for ($g = $photon_index_low; $g <= $photon_index_high; $g += $photon_index_delta)
		{
			for ($x = $ionization_low; $x <= $ionization_high; $x += $ionization_delta)
			{
				my $submit_file = sprintf("submit-scripts/code-x-%04i.csh", $n);
				open FP, ">$submit_file";
				printf FP "#! /bin/tcsh\n";
				printf FP "#\n";
				printf FP "#SBATCH --partition=serial\n";
				printf FP "#SBATCH --nodes=1\n";
				printf FP "#SBATCH --ntasks-per-node=1\n";
				printf FP "#SBATCH --mem=64GB\n";
				printf FP "#SBATCH --time=2:00:00\n";
				printf FP "#SBATCH --job-name=code-x\n";
				printf FP "\n";
				printf FP "module load CUDA\n";
				printf FP "module load cURL\n";
				printf FP "\n";
				printf FP "cd /mnt/storage/scratch/\$\{LOGNAME\}/x-ray-reverberation\n";
				printf FP "/mnt/storage/scratch/\$\{LOGNAME\}/x-ray-reverberation/code-x -i%04.1f -a0.998 -h%3.1f -g%3.1f -A1.0 -x%3.1f -p0.0\n", $i, $h, $g, $x;
				close FP;

		 	 	printf "sbatch $submit_file (code-x -i%04.1f -a0.998 -h%3.1f -g%3.1f -A1.0 -x%3.1f -p0.0)\n", $i, $h, $g, $x;
				if ($do_not_submit==0) {
					`sbatch $submit_file`;
				}

				`sleep 4`;
				$n = $n+1;
			}
		}
	}
}

#+END_EXAMPLE

** blob.c
This code calculates the reverberation signatures looking up the already computed blob to disk and observer to disk ray tracing runs.

To compile the code on Bluecrystal use make blob.

This model is described in Chainakun & Young (2017). The relevant parameters are as follows:

Parameter 	Description 	       Reasonable ranges
o       	1st source height         2 - 10
d 	        2nd source height         3 - 20
g        	Photon index 	        1.4 - 3.2
l        	RRF2 	                0.2 - 2
w        	q2 	                0.5 - 1.5
v        	time max 	        200 - 2000
s       	time shift                0 - 100

#+BEGIN_EXAMPLE
// Two blobs model code
// PC, AJY, SH Oct 2018
//
// This code calculates the reverberation signatures for the two blobs model
// It needs to look up the observer to disk integration
// It needs to look up the source to disk integrations for the two source heights
// It needs to look up the source-to-disk-to-observer output (from code-x)
//
// Notes
// AJY - note that the time delay for different heights and inclination angles is hard wired in
//
// November 2018:
//      Example ./blob -i55 -a0.998 -r400 -s8192  ***update
//      Where i = inclination angle (default 30 degrees) [integer]  ***update
//            a = spin (default 0.998) [double]  ***update
//            r = outer radius (default 400) [integer]  ***update
//            s = image size (default 1024) [integer]  ***update
//
// Inclination of 53 degrees hard wired in

#include <stdio.h>
#include <stdlib.h>
#include <math.h>
//#include <gsl/gsl_rng.h>
//#include <gsl/gsl_randist.h>
//#include <time.h>
#include "fitsio.h"
#include <unistd.h>
#define PI M_PI
#define sqr(x)((x)*(x))

void printerror( int status)
{
    if (status)
    {
       fits_report_error(stderr, status);
       exit( status );
    }
    return;
}

double mod(double x, double y)
{	double ans;
	ans = x - (y* (int)(x/y));
	return ans;
}

int mod_int(double x, double y)
{	int ans;
	ans = x - (y* (int)(x/y));
	return ans;
}

double *cal_psd_std(double s[], double f[], double avg, int N, double dt)	//<---- See page 1240 of Vaughan, Fabian & Nanadra (2003) for the normalisation
{
	int k, j, j1;
	j1 = 0;
	double x = -5.0;
	double *s_real = (double *)malloc(491*sizeof(double));
	double *s_img = (double *)malloc(491*sizeof(double));
	double *ans = (double *)malloc(491*sizeof(double));

	for(j=0; j<491; j++)
	{
		for(k=0; k<=N-1; k++)
		{
			s_real[j] += s[k]*cos(2.0*PI*f[j]*k*dt);
			s_img[j] += s[k]*sin(2.0*PI*f[j]*k*dt);
		}
		ans[j] = 2.0*(sqr(s_real[j])+sqr(s_img[j]))/sqr(avg);  	//<---- See page 1240 of Vaughan, Fabian & Nanadra (2003) for the normalisation
		//printf("rh= %lf rs=%lf rh=%lf dt=%lf f= %lf lag= %lf\n", rh, rs, rh, dt, f[j], lag[j]);
		x += 0.01;
	}
	return ans;

}

double *res_conv(double a[], double res[], double r, int N )
{
	int t1, t2;
	double *ans = (double *)malloc(N*sizeof(double));
	for(t1=0; t1<N; t1++)
	{
		for(t2=0; t2<=t1; t2++)
		{
			ans[t1] += a[t2]*(res[t1-t2]);//  + a2[t2]*r2s*(s_res_2[t1-t2]);
		}
		//ans[t1] = a[t1]+ r*ans[t1];
	}
	return ans;
}

double *cal_coh_std(double s[], double h[], double f[], int N, double dt)
{
	int k, j, j1;
	j1 = 0;
	double x = -5.0;
	double *s_real = (double *)malloc(491*sizeof(double));
	double *s_img = (double *)malloc(491*sizeof(double));
	double *h_real = (double *)malloc(491*sizeof(double));
	double *h_img = (double *)malloc(491*sizeof(double));
	double *c_real = (double *)malloc(491*sizeof(double));
	double *c_img = (double *)malloc(491*sizeof(double));
	double *ans = (double *)malloc(491*sizeof(double));
	double *abs_s = (double *)malloc(491*sizeof(double));
	double *abs_h = (double *)malloc(491*sizeof(double));

	for(j=0; j<491; j++)
	{
		dt = 1.0;
		for(j1=0; j1<10; j1++)
		{
			for(k=0; k<=(N/10-1); k++)
			{
				s_real[j] += s[j1*(N/10)+k]*cos(2.0*PI*f[j]*k*dt);
				s_img[j] += s[j1*(N/10)+k]*sin(2.0*PI*f[j]*k*dt);
				h_real[j] += h[j1*(N/10)+k]*cos(2.0*PI*f[j]*k*dt);
				h_img[j] += h[j1*(N/10)+k]*sin(2.0*PI*f[j]*k*dt);
			}

		c_real[j] += (s_real[j]*h_real[j]+s_img[j]*h_img[j])/10.0;
		c_img[j] += (h_real[j]*s_img[j]-s_real[j]*h_img[j])/10.0;
		abs_s[j] += sqr(s_real[j])+sqr(s_img[j]);
		abs_h[j] += sqr(h_real[j])+sqr(h_img[j]);

		s_real[j] = 0.0;
		s_img[j] = 0.0;
		h_real[j] = 0.0;
		h_img[j] = 0.0;

		}


		ans[j] = (sqr(c_img[j])+sqr(c_real[j]))/(   (abs_s[j]/10.0)  *  (abs_h[j]/10.0)   );
		//printf("rh= %lf rs=%lf rh=%lf dt=%lf f= %lf lag= %lf\n", rh, rs, rh, dt, f[j], lag[j]);
		x += 0.01;
	}
	return ans;

}


double *cal_tl_std(double s[], double h[], double f[], int N, double dt)
{
	int k, j, j1;
	j1 = 0;
	double x = -5.0;
	double *s_real = (double *)malloc(491*sizeof(double));
	double *s_img = (double *)malloc(491*sizeof(double));
	double *h_real = (double *)malloc(491*sizeof(double));
	double *h_img = (double *)malloc(491*sizeof(double));
	double *c_real = (double *)malloc(491*sizeof(double));
	double *c_img = (double *)malloc(491*sizeof(double));
	double *ans = (double *)malloc(491*sizeof(double));

	for(j=0; j<491; j++)
	{
		for(k=0; k<=N-1; k++)
		{
			s_real[j] += s[k]*cos(2.0*PI*f[j]*k*dt);
			s_img[j] += s[k]*sin(2.0*PI*f[j]*k*dt);
			h_real[j] += h[k]*cos(2.0*PI*f[j]*k*dt);
			h_img[j] += h[k]*sin(2.0*PI*f[j]*k*dt);
		}
		c_real[j] = s_real[j]*h_real[j]+s_img[j]*h_img[j];
		c_img[j] = h_real[j]*s_img[j]-s_real[j]*h_img[j];
		ans[j] = -atan2(c_img[j],c_real[j])/(2.0*PI*f[j]);
		//printf("rh= %lf rs=%lf rh=%lf dt=%lf f= %lf lag= %lf\n", rh, rs, rh, dt, f[j], lag[j]);
		x += 0.01;
	}
	return ans;

}

int main (int argc, char **argv)
{

	double  p, o, d, i, g, e, A, x, y, l, b, m, w, v, q ;
  	int j;

  	o = 4.0;		// height of first source (lower)
  	d = 8.0;		// height of second source (upper)
	i = 53.0;		// inclination angle of disk
  	g = 2.0;		// photon index of first source
  	e = 2.0;		// photon index of second source
  	A = 1.0;		// iron abundance
  	x = 0.0;		// log_10(ionization parameter)
  	p = 0.0;		// density profile
  	y = 1.0;		// r1s [?] <-- RRF source 1 [?]
  	l = 0.5;		// r2s [?] <-- RRF source 2 [?]
  	b = 1.0;		// brightness ratio (brightness of second source compared to first)
  	w = 1.0; 		// q2 (q1 is fixed at 1)
  	v = 1000.0; 	// tmax
	q = 0.0; 		// delta_t source's response (delay between source 1 and 2)

  	opterr = 0;
	while ((j = getopt(argc, argv, "o::d::i::g::e::A::x::p::y::l::b::w::v::q::")) != -1)
	switch (j)
   	{
		case 'o':
			sscanf(optarg, "%lf", &o);
			break;

      	case 'd':
			sscanf(optarg, "%lf", &d);
			break;

      	case 'i':
			sscanf(optarg, "%lf", &i);
			break;

      	case 'g':
			sscanf(optarg, "%lf", &g);
			break;

	    case 'e':
			sscanf(optarg, "%lf", &e);
			break;

      	case 'A':
			sscanf(optarg, "%lf", &A);
			break;

      	case 'x':
			sscanf(optarg, "%lf", &x);
			break;

      	case 'p':
			sscanf(optarg, "%lf", &p);
			break;

      case 'y':
	sscanf(optarg, "%lf", &y);
	break;
      case 'l':
	sscanf(optarg, "%lf", &l);
	break;
      case 'b':
	sscanf(optarg, "%lf", &b);
	break;

      	case 'w':
			sscanf(optarg, "%lf", &w);
			break;

      case 'v':
			sscanf(optarg, "%lf", &v);
			break;

      	case 'q':
			sscanf(optarg, "%lf", &q);
			break;

		case '?':
			if (optopt == 'j' || optopt == 'p')
	  			fprintf (stderr, "Option -%c requires an argument.\n", optopt);
			else if (isprint (optopt))
	  			fprintf (stderr, "Unknown option `-%c'.\n", optopt);
			else
		  	fprintf (stderr, "Unknown option character `\\x%x'.\n",
		   optopt);
			return 1;

      	default:
		abort ();
	}


	char o_v[3], d_v[3], i_v[3], g_v[3], e_v[3], A_v[3], x_v[3], p_v[3], y_v[3], l_v[3], b_v[3], w_v[8], v_v[8], q_v[8];
	if(mod(o*10,10) == 0){sprintf(o_v, "%i", (int)o);}else{sprintf(o_v, "%ip%i", (int)o, mod_int(o*10,10));}
	if(mod(d*10,10) == 0){sprintf(d_v, "%i", (int)d);}else{sprintf(d_v, "%ip%i", (int)d, mod_int(d*10,10));}
	if(mod(i*10,10) == 0){sprintf(i_v, "%i", (int)i);}else{sprintf(i_v, "%ip%i", (int)i, mod_int(i*10,10));}
	if(mod(g*10,10) == 0){sprintf(g_v, "%i", (int)g);}else{sprintf(g_v, "%ip%i", (int)g, mod_int(g*10,10));}
	if(mod(e*10,10) == 0){sprintf(e_v, "%i", (int)e);}else{sprintf(e_v, "%ip%i", (int)e, mod_int(e*10,10));}
	if(mod(A*10,10) == 0){sprintf(A_v, "%i", (int)A);}else{sprintf(A_v, "%ip%i", (int)A, mod_int(A*10,10));}
	if(mod(x*10,10) == 0){sprintf(x_v, "%i", (int)x);}else{sprintf(x_v, "%ip%i", (int)x, mod_int(x*10,10));}
	if(mod(p*10,10) == 0){sprintf(p_v, "%i", (int)p);}else{sprintf(p_v, "%ip%i", (int)p, mod_int(p*10,10));}
	if(mod(y*10,10) == 0){sprintf(y_v, "%i", (int)y);}else{sprintf(y_v, "%ip%i", (int)y, mod_int(y*10,10));}
	if(mod(l*10,10) == 0){sprintf(l_v, "%i", (int)l);}else{sprintf(l_v, "%ip%i", (int)l, mod_int(l*10,10));}
	if(mod(b*10,10) == 0){sprintf(b_v, "%i", (int)b);}else{sprintf(b_v, "%ip%i", (int)b, mod_int(b*10,10));}
 	if(mod(w*10,10) == 0){sprintf(w_v, "%i", (int)w);}else{sprintf(w_v, "%ip%i", (int)w, mod_int(w*10,10));}
	if(mod(v*10,10) == 0){sprintf(v_v, "%i", (int)v);}else{sprintf(v_v, "%ip%i", (int)v, mod_int(v*10,10));}
	if(mod(q*10,10) == 0){sprintf(q_v, "%i", (int)q);}else{sprintf(q_v, "%ip%i", (int)q, mod_int(q*10,10));}

	printf("h1=%s h2=%s i=%s g1=%s g2=%s A=%s x=%s p=%s rs1=%s rs2=%s b=%s w=%s v=%s q=%s\n", o_v, d_v, i_v, g_v, e_v, A_v, x_v, p_v, y_v, l_v, b_v, w_v, v_v, q_v);

    char x_filename_a1[255];
	char x_filename_a2[255];
	char lag_filename[255];
	sprintf(x_filename_a1, "x-h%s-a0p998-i%s-g%s-A%s-x%s-p%s.fits", o_v, i_v, g_v, A_v, x_v, p_v);
 	sprintf(x_filename_a2, "x-h%s-a0p998-i%s-g%s-A%s-x%s-p%s.fits", d_v, i_v, e_v, A_v, x_v, p_v);
	sprintf(lag_filename, "lag2b-h%s+%s-a0p998-i%s-g%s+%s-A%s-x%s-p%s-rs%s+%s-b%s-q%s-tmax%s-tshift%s.fits", o_v, d_v, i_v, g_v, e_v, A_v, x_v, p_v, y_v, l_v, b_v, w_v, v_v, q_v);

// char lag_filename[] = "test.fits";//"tl_FeL_2s_2h_30h.fits";//"t-x0-h10-a0p998-i45-g2-A1-x1-p0-r1.fits";

///////////////////////////////////////////////////////////////////////////////

	int t1, t2, ts, tmax, dt_res, j1, n, k, height1, height2;
	double R, r1s, r2s, r1h, r2h, bf, q2, Mb;
	fitsfile *fptr;

	int N = 1024*10;	//Number of bins

	double gamma_a1=g;
	double gamma_a2=e;

	bf = b;
	r1s = y;
	r2s = l;
	// Mb = pow(10.0,m);// BH mass (Solar mass unit)
	q2 = w;
	tmax = v;
	dt_res = q;

	int n_source = 2;

//	double s_emin = 0.3;
//	double s_emax = 3.0;
//	double h_emin = 4.0;
//	double h_emax = 6.5;

	double s_emin = 0.3;
	double s_emax = 0.8;
	double h_emin = 1.0;
	double h_emax = 4.0;

/////////// i=53 //////////////////////
	double t0[] = {1014.63, 1011.62, 1009.86, 1008.51, 1007.38, 1006.35, 1005.39, 1004.45, 1003.59, 1002.82, 1001.96, 1001.18, 1000.39, 999.628, 998.904, 998.133, 997.461, 996.737, 996.006};

/////////// i=30 //////////////////////
//double t0[] ={1014.14, 1010.85, 1008.82, 1007.18, 1005.76, 1004.56, 1003.24, 1002.1, 1000.93, 999.878, 998.75, 997.732, 996.675, 995.665, 994.649, 993.604, 992.637, 991.699, 990.702};

	// double t0[] ={0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0};

/////////// i=15 //////////////////////

	// AJY - should typecast to integers?
	height1=o-2;
	height2=d-2;
	int dt0 = t0[height1] - t0[height2];

/*
r1s = 0.221063;
r2s = 0.114598;

	double s_emin = 2.0;
	double s_emax = 4.0;
	double h_emin = 5.0;
	double h_emax = 7.0;

*/


/*
	r1s = 0.115297;
	r2s = 0.081744;
	R = 1.0e-3;
*/

 	double *in_real_s = (double *)malloc(N*sizeof(double));
	double *in_real_h = (double *)malloc(N*sizeof(double));

	double M0 = 1.9891*pow(10.0,30.0);
	double G = 6.67*pow(10.0,-11.0);
	double c = 2.99792458*pow(10.0,8.0);
	double tg = 1.0;//G*Mb*M0/pow(c,3.0);//1; // lenght of bin in second
	double dt = 1.0;//G*Mb*M0/pow(c,3.0);//1; // lenght of bin in second
	double s_sum_1 = 0.0;
	double h_sum_1 = 0.0;
	double s_sum_2 = 0.0;
	double h_sum_2 = 0.0;

	double *dcounts_1 = (double *)malloc(365*sizeof(double));
	double *rcounts_1 = (double *)malloc(365*sizeof(double));
	double *tcounts_1 = (double *)malloc(365*sizeof(double));
	double *dcounts_2 = (double *)malloc(365*sizeof(double));
	double *rcounts_2 = (double *)malloc(365*sizeof(double));
	double *tcounts_2 = (double *)malloc(365*sizeof(double));
	double *emin = (double*)malloc(365*sizeof(double));
	double *emax = (double*)malloc(365*sizeof(double));

	int status = 0;
	int bitpix   =  DOUBLE_IMG;
	int hdutype;
  	int anynull, nfound;
  	int fpixel   = 1;
  	int frow      = 1;
	int felem     = 1;
	float nullval  = 0;
	long naxes0[1];
	long naxes1[1];
	long naxes2[1];
	long naxes3[1];

	if ( fits_open_file(&fptr, "reflionx.mod", READONLY, &status) )
        printerror( status );
	if ( fits_movabs_hdu(fptr, 3, &hdutype, &status) )
             printerror( status );

	int nelem = 365;

	if ( fits_read_col(fptr, TDOUBLE, 1, frow, felem, nelem, &nullval,  emin,
             &anynull, &status))
	     printerror( status );

    if ( fits_read_col(fptr, TDOUBLE, 2, frow, felem, nelem, &nullval,  emax,
             &anynull, &status))
	     printerror( status );

	if( fits_close_file(fptr, &status) )
            printerror( status );

	if ( fits_open_file(&fptr, x_filename_a1, READWRITE, &status) )
        printerror( status );

	if ( fits_movabs_hdu(fptr, 2, &hdutype, &status) )
        printerror( status );

	if( fits_read_col(fptr, TDOUBLE, 2, frow, felem, 365, &nullval, rcounts_1,
            &anynull, &status))
	    printerror( status );

	if ( fits_movabs_hdu(fptr, 3, &hdutype, &status) )
        printerror( status );

	if( fits_read_col(fptr, TDOUBLE, 2, frow, felem, 365, &nullval, dcounts_1,
            &anynull, &status))
	    printerror( status );

	if ( fits_movabs_hdu(fptr, 4, &hdutype, &status) )
        printerror( status );

	if ( fits_read_keys_lng(fptr, "NAXIS", 1, 2, naxes1, &nfound, &status) )
      	printerror( status );

	k = naxes1[1];
	double	*data_e_1 = (double *)malloc(k*sizeof(double));
	double	*data_t_1 = (double *)malloc(k*sizeof(double));
	double	*data_n_1 = (double *)malloc(k*sizeof(double));

	if( fits_read_col(fptr, TDOUBLE, 1, frow, felem, k, &nullval, data_e_1,
            &anynull, &status))
	    printerror( status );

	if( fits_read_col(fptr, TDOUBLE, 2, frow, felem, k, &nullval, data_t_1,
            &anynull, &status))
	    printerror( status );

	if( fits_read_col(fptr, TDOUBLE, 3, frow, felem, k, &nullval, data_n_1,
            &anynull, &status))
	    printerror( status );

	if( fits_close_file(fptr, &status) )
            printerror( status );

	if ( fits_open_file(&fptr, x_filename_a2, READWRITE, &status) )
        printerror( status );

	if ( fits_movabs_hdu(fptr, 2, &hdutype, &status) )
        printerror( status );

	if( fits_read_col(fptr, TDOUBLE, 2, frow, felem, 365, &nullval, rcounts_2,
            &anynull, &status))
	    printerror( status );

	if ( fits_movabs_hdu(fptr, 3, &hdutype, &status) )
        printerror( status );

	if( fits_read_col(fptr, TDOUBLE, 2, frow, felem, 365, &nullval, dcounts_2,
            &anynull, &status))
	    printerror( status );

	if ( fits_movabs_hdu(fptr, 4, &hdutype, &status) )
        printerror( status );

	if ( fits_read_keys_lng(fptr, "NAXIS", 1, 2, naxes1, &nfound, &status) )
      	printerror( status );

	k = naxes1[1];
	double	*data_e_2 = (double *)malloc(k*sizeof(double));
	double	*data_t_2 = (double *)malloc(k*sizeof(double));
	double	*data_n_2 = (double *)malloc(k*sizeof(double));

	if( fits_read_col(fptr, TDOUBLE, 1, frow, felem, k, &nullval, data_e_2,
            &anynull, &status))
	    printerror( status );

	if( fits_read_col(fptr, TDOUBLE, 2, frow, felem, k, &nullval, data_t_2,
            &anynull, &status))
	    printerror( status );

	if( fits_read_col(fptr, TDOUBLE, 3, frow, felem, k, &nullval, data_n_2,
            &anynull, &status))
	    printerror( status );

	if( fits_close_file(fptr, &status) )
            printerror( status );

	double *t = (double *)malloc(N*sizeof(double));
	double *s_res_1 = (double *)malloc(N*sizeof(double));
	double *s_res_2 = (double *)malloc(N*sizeof(double));
	double *h_res_1 = (double *)malloc(N*sizeof(double));
	double *h_res_2 = (double *)malloc(N*sizeof(double));
	double *pf_res_1 = (double *)malloc(N*sizeof(double));
	double *pf_res_2 = (double *)malloc(N*sizeof(double));

	double *f = (double *)malloc(N*sizeof(double));
	double *nlag = (double *)malloc(N*sizeof(double));
	double *ax = (double *)malloc(N*sizeof(double));
	double *s = (double *)malloc(N*sizeof(double));
	double *h = (double *)malloc(N*sizeof(double));
	double *nh = (double *)malloc(N*sizeof(double));
	double *s_real = (double *)malloc(N*sizeof(double));
	double *s_img = (double *)malloc(N*sizeof(double));
	double *h_real = (double *)malloc(N*sizeof(double));
	double *h_img = (double *)malloc(N*sizeof(double));
	double *c_real = (double *)malloc(N*sizeof(double));
	double *c_img = (double *)malloc(N*sizeof(double));
	double *ff = (double *)malloc(N*sizeof(double *));

	double *P = (double *)malloc(N*sizeof(double *));
	double *per = (double *)malloc(N*sizeof(double *));
	double **a = (double **)malloc(n_source*sizeof(double *));

	for ( j = 0; j < n_source; j++ )
	{
		a[j] = (double *)malloc(N*sizeof(double));
	}

	// Calculate rh -------------------------------------------------------------------------------------------------------------

	double s_rcounts_1 = 0.0;
	double s_rcounts_2 = 0.0;
	double h_rcounts_1 = 0.0;
	double h_rcounts_2 = 0.0;
	double s_dcounts_1 = 0.0;
	double s_dcounts_2 = 0.0;
	double h_dcounts_1 = 0.0;
	double h_dcounts_2 = 0.0;
	double s_ratio_1, s_ratio_2, h_ratio_1, h_ratio_2, cf_1, cf_2;

	for(j=0; j<365; j++)
	{
		if(emin[j] > s_emin && emax[j] <= s_emax)
		{
			s_rcounts_1 += rcounts_1[j]/sqr(0.5*(emin[j]+emax[j])); // -> counts/s/keV
			s_dcounts_1 += dcounts_1[j]/sqr(0.5*(emin[j]+emax[j]));
			s_rcounts_2 += rcounts_2[j]/sqr(0.5*(emin[j]+emax[j])); // -> counts/s/keV
			s_dcounts_2 += dcounts_2[j]/sqr(0.5*(emin[j]+emax[j]));

		}else if(emin[j] > h_emin && emax[j] <= h_emax)
		{
			h_rcounts_1 += rcounts_1[j]/sqr(0.5*(emin[j]+emax[j]));
			h_dcounts_1 += dcounts_1[j]/sqr(0.5*(emin[j]+emax[j]));
			h_rcounts_2 += rcounts_2[j]/sqr(0.5*(emin[j]+emax[j]));
			h_dcounts_2 += dcounts_2[j]/sqr(0.5*(emin[j]+emax[j]));
		}
	}
	s_ratio_1 = s_rcounts_1/s_dcounts_1;
	h_ratio_1 = h_rcounts_1/h_dcounts_1;
	s_ratio_2 = s_rcounts_2/s_dcounts_2;
	h_ratio_2 = h_rcounts_2/h_dcounts_2;

	/* when the soft rs is assumed */
	r1h = r1s*h_ratio_1/s_ratio_1;
	cf_1 = s_ratio_1/r1s;
	r2h = r2s*h_ratio_2/s_ratio_2;
	cf_2 = s_ratio_2/r2s;

	printf("r1s= %lf r1h=%lf r2s= %lf r2h= %lf", r1s, r1h, r2s, r2h);

/* when the hard rf is assumed */
//	rs = rh*s_ratio/h_ratio;
//	cf = h_rcounts/(rh*h_dcounts);

	for(j=0; j<365; j++)
	{
		dcounts_1[j] = dcounts_1[j]*cf_1/sqr(0.5*(emin[j]+emax[j])); // -> counts/s/keV
		rcounts_1[j] = rcounts_1[j]/sqr(0.5*(emin[j]+emax[j])); // -> counts/s/keV
		tcounts_1[j] = dcounts_1[j] + rcounts_1[j];
		dcounts_2[j] = R*dcounts_2[j]*cf_2/sqr(0.5*(emin[j]+emax[j])); // -> counts/s/keV
		rcounts_2[j] = R*rcounts_2[j]/sqr(0.5*(emin[j]+emax[j])); // -> counts/s/keV
		tcounts_2[j] = dcounts_2[j] + rcounts_2[j];
		// printf("h= %lf s= %lf\n", rcounts_2[j], rcounts_1[j]);
	}

//***************************** Generate signal a[j] and compute the response functions h_res[j] and s_res[j] *****
	for(j=0; j<N; j++)
	{
		s_res_1[j] = 0.0;
		h_res_1[j] = 0.0;
		s_res_2[j] = 0.0;
		h_res_2[j] = 0.0;
		t[j]  = j;
		f[j] = 0.0;
		s[j] = 0.0;
		h[j] = 0.0;
		nh[j] = 0.0;
		h_real[j] = 0.0;
		h_img[j] = 0.0;
		s_real[j] = 0.0;
		s_img[j] = 0.0;
		c_real[j] = 0.0;
		c_img[j] = 0.0;
	}

	// AJY - implicit typecasting for dt0?

	for(j=0; j<N-dt0; j++)
	{

		for(j1=0; j1<k; j1++)
		{
			if(data_e_1[j1] >= h_emin && data_e_1[j1] <= h_emax && data_t_1[j1] >= t[j] && data_t_1[j1] < t[j] + 1.0)
			{
				h_res_1[j+dt0] += data_n_1[j1];
				h_sum_1 += data_n_1[j1];
				h_res_2[j] += data_n_2[j1];
				h_sum_2 += data_n_2[j1];
			}if(data_e_1[j1] >= s_emin && data_e_1[j1] <= s_emax && data_t_1[j1] >= t[j] && data_t_1[j1] < t[j] + 1.0)
			{
				s_res_1[j+dt0] += data_n_1[j1];
				s_sum_1 += data_n_1[j1];
				s_res_2[j] += data_n_2[j1];
				s_sum_2 += data_n_2[j1];
			}
		}
	}

	double *lc1, *lc2, *lag, *coh, *per_s, *per_h, *a1, *a2, *a0, *s1, *s2, *s3, *h1, *h2, *h3, fv, avg_s_lc, avg_h_lc, cf1, cf2;//, *a, *a2;
//	fv = pow(2.0,-1.5)*0.5/(2.0*PI);
	cf1 = 0.0;
	cf2 = 0.0;
	avg_s_lc = 0.0;
	avg_h_lc = 0.0;
	fv = 1.0e-3;
//	lc1 = gen_lc(N,fv,0.03);

//	fv = pow(200.0,-1.5)*0.5/(2.0*PI);
	fv = 1.0e-3;
//	lc2 = gen_lc(N,fv,0.03);

	for(j=0; j<N; j+=1)
	{
		s_res_1[j] = (s_res_1[j]/s_sum_1);
		h_res_1[j] = (h_res_1[j]/h_sum_1);
		s_res_2[j] = (s_res_2[j]/s_sum_2);
		h_res_2[j] = (h_res_2[j]/h_sum_2);
		if( j>=1 && j<2)
		{
			//ax[j] = lc1[j]+1.0;
			ax[j] = 1.0;

		}else{
			ax[j] = 0.0;
			//a2[j] = 0.0;
		}
	}

	ts = 1;
	//tmax =  2000; //1000

	for(j=0; j<N-50; j+=1)
	{
		if( j>=1 && j<=tmax)
		{
		//pf_res_1[j+dt0] = pow(ts,-1)*pow(2.71828182846,-ts/tmax);
			pf_res_1[j] = pow(ts,-1)*pow(2.71828182846,-ts/tmax);
			pf_res_2[j+dt_res] = pow(ts,-q2)*pow(2.71828182846,-ts/tmax);
			cf1 += pf_res_1[j];
			cf2 += pf_res_2[j];
			ts += 1;


		}else{
			pf_res_1[j] = 0.0;
			pf_res_2[j] = 0.0;
		}

	}

	for(j=0; j<N; j+=1)
	{
		pf_res_1[j] = pf_res_1[j]/cf1;
		pf_res_2[j] = pf_res_2[j]/cf2;
	}

	/***********************************************************/

	double *F1s = (double *)malloc(N*sizeof(double));
	double *F1h = (double *)malloc(N*sizeof(double));
	double *F2s = (double *)malloc(N*sizeof(double));
	double *F2h = (double *)malloc(N*sizeof(double));
	double *F1s_ax = (double *)malloc(N*sizeof(double));
	double *F1h_ax = (double *)malloc(N*sizeof(double));
	double *F2s_ax = (double *)malloc(N*sizeof(double));
	double *F2h_ax = (double *)malloc(N*sizeof(double));
	double	*bin_lag = (double *)malloc(N*sizeof(double));
	double	*cbin_real = (double *)malloc(N*sizeof(double));
	double	*cbin_img = (double *)malloc(N*sizeof(double));
	double	*bin_f = (double *)malloc(N*sizeof(double));
	int ncount = 0;

	R=5.1;

	/////////////////////////////////  Scenario 4 ///////////////////////////

	a1 = res_conv(ax, pf_res_1, 1.0, N);
	a2 = res_conv(ax, pf_res_2, 1.0, N);

	double Fs1, Fs2, Fh1, Fh2;
	//Fs1 = (pow(s_emax,-gamma_a1+1.0)-pow(s_emin,-gamma_a1+1.0))/(-gamma_a1+1.0);
	//Fh1 = (pow(h_emax,-gamma_a1+1.0)-pow(h_emin,-gamma_a1+1.0))/(-gamma_a1+1.0);
	//Fs2 = (pow(s_emax,-gamma_a2+1.0)-pow(s_emin,-gamma_a2+1.0))/(-gamma_a2+1.0);
	//Fh2 = (pow(h_emax,-gamma_a2+1.0)-pow(h_emin,-gamma_a2+1.0))/(-gamma_a2+1.0);

	Fs1 = pow(s_emin,-gamma_a1+1.0)*exp(-s_emin/300.0);
	Fh1 = pow(h_emin,-gamma_a1+1.0)*exp(-h_emin/300.0);
	Fs2 = pow(s_emin,-gamma_a2+1.0)*exp(-s_emin/300.0);
	Fh2 = pow(h_emin,-gamma_a2+1.0)*exp(-h_emin/300.0);

	s1 = res_conv(a1, s_res_1, 1.0, N);
	h1 = res_conv(a1, h_res_1, 1.0, N);
	s2 = res_conv(a2, s_res_2, 1.0, N);
	h2 = res_conv(a2, h_res_2, 1.0, N);

	for(j=0;j<N;j++)
	{

	//	in_real_s[j] = Fs1*a1[j] + bf*Fs2*a2[j] + r1s*s1[j]*Fs1/(Fs1+Fs2);
	//	in_real_h[j] = Fh1*a1[j] + bf*Fh2*a2[j] + r1h*h1[j]*Fh1/(Fh1+Fh2);   //// test B

	//	in_real_s[j] = Fs1*(r1s*s1[j]) + bf*Fs2*(a2[j]);// + r2s*s2[j]);
	//	in_real_h[j] = Fh1*(r1h*h1[j]) + bf*Fh2*(a2[j]);// + r2h*h2[j]);    //// test C

	//	in_real_s[j] = Fs1*(r1s*s1[j]*Fs1/Fs2) + bf*Fs2*(a2[j]);// + r2s*s2[j]);
	//	in_real_h[j] = Fh1*(r1h*h1[j]*Fh1/Fh2) + bf*Fh2*(a2[j]);// + r2h*h2[j]);    //// c

	//	in_real_s[j] = Fs1*(a1[j] + r1s*s1[j]) + bf*Fs2*(a2[j]);// + r2s*s2[j]);
	//	in_real_h[j] = Fh1*(a1[j] + r1h*h1[j]) + bf*Fh2*(a2[j]);// + r2h*h2[j]);    //// B

		in_real_s[j] = Fs1*(a1[j] + r1s*s1[j]) + bf*Fs2*(a2[j] + r2s*s2[j]);
		in_real_h[j] = Fh1*(a1[j] + r1h*h1[j]) + bf*Fh2*(a2[j] + r2h*h2[j]);       //// A

	//	in_real_s[j] = Fs1*(a1[j] + r1s*s1[j]) + Fs2*(a2[j]);// + r2s*s2[j]);
	//	in_real_h[j] = Fh1*(a1[j] + r1h*h1[j]) + Fh2*(a2[j]);// + r2h*h2[j]);
	}


/****** Following is similar to the code above *********/
/*
	a1 = res_conv(ax, pf_res_1, 1.0, N);
	a2 = res_conv(ax, pf_res_2, 1.0, N);


	for(j=0;j<N;j++)
	{

		F1s[j] = a1[j]*(pow(s_emax,-gamma_a1+1.0)-pow(s_emin,-gamma_a1+1.0))/(-gamma_a1+1.0);
		F1h[j] = a1[j]*(pow(h_emax,-gamma_a1+1.0)-pow(h_emin,-gamma_a1+1.0))/(-gamma_a1+1.0);
		F2s[j] = a2[j]*(pow(s_emax,-gamma_a2+1.0)-pow(s_emin,-gamma_a2+1.0))/(-gamma_a2+1.0);
		F2h[j] = a2[j]*(pow(h_emax,-gamma_a2+1.0)-pow(h_emin,-gamma_a2+1.0))/(-gamma_a2+1.0);

		F1s_ax[j] = F1s[j]*a1[j];
		F1h_ax[j] = F1h[j]*a1[j];
		F2s_ax[j] = F2s[j]*a2[j];
		F2h_ax[j] = F2h[j]*a2[j];
	}


	s1 = res_conv(F1s, s_res_1, 1.0, N);
	h1 = res_conv(F1h, h_res_1, 1.0, N);
	s2 = res_conv(F2s, s_res_2, 1.0, N);
	h2 = res_conv(F2h, h_res_2, 1.0, N);



	for(j=0;j<N;j++)
	{

		in_real_s[j] = F1s[j] + r1s*s1[j] + F2s[j] + r2s*s2[j];
		in_real_h[j] = F1h[j] + r1h*h1[j] + F2h[j] + r2h*h2[j];
	}

*/




/****************************************************************/
/***********************  Scenario 2 ************************************/
/*

	a1 = res_conv(ax, pf_res_1, 1.0, N);
	a2 = res_conv(ax, pf_res_2, 1.0, N);
	s1 = res_conv(a1, s_res_1, 1.0, N);
	h1 = res_conv(a1, h_res_1, 1.0, N);
	s2 = res_conv(a2, s_res_2, 1.0, N);
	h2 = res_conv(a2, h_res_2, 1.0, N);

	for(j=0;j<N;j++)
	{
		in_real_s[j] = a1[j] + 0.8*(s1[j] + s2[j]);
		in_real_h[j] = a2[j];// + 0.1*(h1[j] + h2[j]);
	}
*/
/****************************************************************/

//	fftw_execute(fw_s);
//	fftw_execute(fw_h);

////////////////// No-binning //////////////////////




	double x1=-5.0;
	for(j=0; j<491; j++)
	{
		f[j] = pow(10.0,x1);
		x1+=0.01;
	}
	lag = cal_tl_std(in_real_s, in_real_h, f, N, dt);
	coh = cal_coh_std(in_real_s, in_real_h, f, N, dt);//cal_coh_std(a1, a2, f, N, dt);;//
	per_s = cal_psd_std(in_real_s, f, avg_s_lc, N, dt); 	//<---- See page 1240 of Vaughan, Fabian & Nanadra (2003) for the normalisation
	per_h = cal_psd_std(in_real_h, f, avg_h_lc, N, dt);	//<---- See page 1240 of Vaughan, Fabian & Nanadra (2003) for the normalisation


	for(j=0; j<491; j++)
	{
		f[j] = f[j]/tg;
		nlag[j] = lag[j]*tg;

	}

	printf("avg_s= %lf avg_h=%lf tg=%lf \n", avg_s_lc, avg_h_lc, tg);

/////////////////////// Binning (averaging) the periodogram and calculate time lags //////////////////////////////
/*

	double count = 0.0;
	double fmin = 1.0e-5;
	double df = 0.1;


	for(j1=0; j1<491; j1++)
	{
		if(fmin<1.0)
		{
			cbin_real[j1] = 0.0;
			cbin_img[j1] = 0.0;
			//for(j=0; j<N; j++)
			for(j=0; j<N; j++)
			{
				f[j] = ((double)j/N);
				//PSD[i] = sqrt(sqr(out_s[i][0]) + sqr(out_s[i][1]));
				if(f[j]> fmin && f[j] <= fmin + fmin*df)
				{
					cbin_real[j1] += (out_s[j][0]*out_h[j][0]+out_s[j][1]*out_h[j][1]);
					cbin_img[j1] +=  (out_h[j][0]*out_s[j][1]-out_s[j][0]*out_h[j][1]);
					count += 1.0;
				}
			}
			bin_f[j1] = (fmin + fmin + fmin*df)/2.0;
			bin_lag[j1] = atan2(cbin_img[j1]/count,cbin_real[j1]/count)/(2.0*PI*bin_f[j1] );
			count = 0.0;
			ncount +=1;
			fmin = fmin + fmin*df;
		}
		printf("fmin= %lf favg= %lf, fmax= %lf df= %lf cbin_img=%lf cbin_real=%lf lag= %lf\n", fmin, bin_f[j1], fmin + fmin + fmin*df, fmin*df, cbin_img[j1], cbin_real[j1], bin_lag[j1]);
	}
	printf("ncount= %i r1s=%lf r1h=%lf r2s=%lf r2h=%lf\n", ncount, r1s, r1h, r2s, r2h);

*/


//////////////////////////////////

	int ncolumns = 2;
	int nrows = 491;
	//int nrows = ncount;
	int nrows2 = N;

	long firstrow = 1;
	long firstelem = 1;
	char *ttype[] = { "fq", "lag", "coherence", "per_s", "per_h" };
	char *ttype2[] = { "time", "response" };
	char *ttype5[] = { "ff", "PSD", "per" };
	char *ttype4[] = { "emin", "rcount_h", "dcount_h", "tcount_h", "rcount_s", "dcount_s", "tcount_s" };
	char *tform[] = { "1D", "1D" };
	char *tform5[] = { "1D", "1D", "1D" };
	char *tform2[] = { "1D", "1D", "1D", "1D", "1D"};
	char *tform4[] = { "1D", "1D", "1D", "1D", "1D", "1D", "1D" };
	char *tunit[] = { "\0", "\0"};
	char *tunit5[] = { "\0", "\0", "\0" };
	char *tunit2[] = { "\0", "\0", "\0", "\0", "\0"};
	char *tunit4[] = { "\0", "\0", "\0", "\0", "\0", "\0", "\0" };
	char extname[] = "Lag_coh";
	char extname2[] = "Soft RESPONSE";
	char extname3[] = "Hard RESPONSE";
	char extname4[] = "spectra";
	char extname5[] = "lc-a1";


/************ calculate img and save into FITs file 1D array **************/

	if (fits_create_file(&fptr, lag_filename, &status))
  	    printerror( status );

	if ( fits_create_tbl( fptr, BINARY_TBL, nrows, 2, ttype, tform2,
                tunit2, extname, &status) )
          	printerror( status );

		fits_write_col(fptr, TDOUBLE, 1, firstrow, firstelem, nrows, f,
                   &status);

    		fits_write_col(fptr, TDOUBLE, 2, firstrow, firstelem, nrows, nlag,
                   &status);
 /*
    		fits_write_col(fptr, TDOUBLE, 3, firstrow, firstelem, nrows, coh,
                   &status);

    		fits_write_col(fptr, TDOUBLE, 4, firstrow, firstelem, nrows, per_s,
                   &status);

		fits_write_col(fptr, TDOUBLE, 5, firstrow, firstelem, nrows, per_h,
                   &status);



	if ( fits_create_tbl( fptr, BINARY_TBL, 365, 7, ttype4, tform4,
                tunit4, extname4, &status) )
          	printerror( status );

    		fits_write_col(fptr, TDOUBLE, 1, firstrow, firstelem, 365, emin,
                   &status);

    		fits_write_col(fptr, TDOUBLE, 2, firstrow, firstelem, 365, rcounts_2,
                   &status);

		fits_write_col(fptr, TDOUBLE, 3, firstrow, firstelem, 365, dcounts_2,
                   &status);

		fits_write_col(fptr, TDOUBLE, 4, firstrow, firstelem, 365, tcounts_2,
                   &status);

		fits_write_col(fptr, TDOUBLE, 5, firstrow, firstelem, 365, rcounts_1,
                   &status);

		fits_write_col(fptr, TDOUBLE, 6, firstrow, firstelem, 365, dcounts_1,
                   &status);

		fits_write_col(fptr, TDOUBLE, 7, firstrow, firstelem, 365, tcounts_1,
                   &status);



	if ( fits_create_tbl( fptr, BINARY_TBL, nrows2, ncolumns, ttype2, tform,
                tunit, extname2, &status) )
          	printerror( status );

    		fits_write_col(fptr, TDOUBLE, 1, firstrow, firstelem, nrows2, t,
                   &status);

    		fits_write_col(fptr, TDOUBLE, 2, firstrow, firstelem, nrows2, s_res_2,
                   &status);

	if ( fits_create_tbl( fptr, BINARY_TBL, nrows2, ncolumns, ttype2, tform,
                tunit, extname3, &status) )
          	printerror( status );

    		fits_write_col(fptr, TDOUBLE, 1, firstrow, firstelem, nrows2, t,
                   &status);

    		fits_write_col(fptr, TDOUBLE, 2, firstrow, firstelem, nrows2, h_res_2,
                   &status);

	if ( fits_create_tbl( fptr, BINARY_TBL, nrows2, 3, ttype5, tform5,
                tunit5, extname5, &status) )
          	printerror( status );

    		fits_write_col(fptr, TDOUBLE, 1, firstrow, firstelem, nrows2, ff,
                   &status);

    		fits_write_col(fptr, TDOUBLE, 2, firstrow, firstelem, nrows2, P,
                   &status);

		fits_write_col(fptr, TDOUBLE, 3, firstrow, firstelem, nrows2, per,
                   &status);
*/
   		if (fits_close_file(fptr, &status))
        	printerror( status );


	free(h);
	free(s);
	free(lag);
	free(emin);
	free(rcounts_1);
	free(dcounts_1);
	free(s_real);
	free(s_img);
	free(h_real);
	free(h_img);
	free(c_real);
	free(c_img);
	free(f);
	free(s_res_1);
	free(h_res_1);
	free(t);

 return 0;
}




#+END_EXAMPLE

** submit-blob.pl

This Perl script instructs the supercomputer to run a grid of two blobs models. Note that it includes appropriate module load commands in the PBS scripts it generates.

I think it makes most sense to run this script in the output directory because it will generate a lot of files!

The output will be placed in your scratch space on Bluecrystal in a sub-directory called 2-blobs-model that you will have to create (that'll be /mnt/storage/scratch/your_user_name/2-blobs-model`).

The script assumes the code is in your home directory in a sub-directory called x-ray-reverberation.

The script loops through all possible parameter combinations for the blob code over certain ranges and making sure that only relevant parameter combinations are computed (e.g., requiring height of upper source > height of lower source). The explanation of the parameters is described in the blob.c code.

#+BEGIN_EXAMPLE
#! /usr/bin/perl -w

use strict;

# Parameters for 1H 0707-405
my $epsilon = 0.001;
# First source height ("o")
my $first_source_height_low = 2.0;		# low value
my $first_source_height_high = 9.0;		# high value
my $source_height_delta = 1.0;			# step size (same for both sources)
# First source height ("d")
my $second_source_height_low = $first_source_height_low + $source_height_delta;
my $second_source_height_high = $first_source_height_high;
# Inclination angle of disk ("i")
my $inclination_low = 53.0;
my $inclination_high = 53.0;
my $inclination_delta = 1.0;
# Photon index of first source ("g")
my $first_source_photon_index_low = 2.5;
my $first_source_photon_index_high = 3.3;
my $first_source_photon_index_delta = 0.2;
# Photon index of second source ("e")
my $second_source_photon_index_low = 2.5;
my $second_source_photon_index_high = 3.3;
my $second_source_photon_index_delta = 0.2;
# Iron abundance ("A")
my $iron_abund_low = 1.0;
my $iron_abund_high = 1.0;
my $iron_abund_delta = 0.1;
# Ionization parameter ("x")
my $xi_low = 2.0;
my $xi_high = 3.0;
my $xi_delta = 0.5;
# Density profile index ("p") - density goes as r^-p
my $density_low = 0.0;
my $density_high = 0.0;
my $density_delta = 0.1;
# We're setting "y" and "l" to 1.0 which are the RRF for sources 1 and 2, respectively
# Brightness parameter is ratio of brightness of 2nd source compared to 1st
my $brightness_low = 1.0;
my $brightness_high = 3.0;
my $brightness_delta = 1.0;
# "q2" (q1 is fixed at 1)
my $q2_low = 0.5;
my $q2_high = 0.5;
my $q2_delta = 0.1;
# "v" is tmax;
my $tmax_low = 1000.0;
my $tmax_high = 1000.0;
my $tmax_delta = 100.0;
# "q" is the time shift between first and second source
my $tshift_low = 0.0;
my $tshift_high = 0.0;
my $tshift_delta = 100.0;

# For testing this code set do_not_submit to 1. This will produce the submit scripts but not actually submit them. Set this to 0 to actually submit the jobs.
my $do_not_submit = 0;

my $n = 0;
my $batch_size = 100; # how many jobs to run in one script
my $cur_batch_size = 0;

my ($o, $d, $i, $g, $e, $A, $x, $p, $y, $l, $b, $w, $v, $q);

# "o" is the first source height
for ($o = $first_source_height_low; $o <= $first_source_height_high + $epsilon; $o += $source_height_delta)
{
	# "d" is the second source height
	# Note that the second source height has to be larger than the first source height
	for ($d = $o + $source_height_delta; $d <= $second_source_height_high + $epsilon; $d += $source_height_delta)
	{
		# "i" is the inclination angle of the disk
		for ($i = $inclination_low; $i <= $inclination_high + $epsilon; $i += $inclination_delta)
		{
			# "g" is the first source photon index
			for ($g = $first_source_photon_index_low; $g <= $first_source_photon_index_high + $epsilon; $g += $first_source_photon_index_delta)
			{
				# "e" is the second source photon index
				for ($e = $second_source_photon_index_low; $e <= $second_source_photon_index_high + $epsilon; $e += $second_source_photon_index_delta)
				{
					# "A" is the iron abundance
					for ($A = $iron_abund_low; $A <= $iron_abund_high + $epsilon; $A += $iron_abund_delta)
					{
						# "x" is the ionization parameter
						for ($x = $xi_low; $x <= $xi_high + $epsilon; $x += $xi_delta)
						{
							# "p" is the density profile which goes as r^-p
							for ($p = $density_low; $p <= $density_high + $epsilon; $p += $density_delta)
							{
								# "y" is RRF for source 1
								$y = 1.0;
								# "l" is RRF for source 2
								$l = 1.0;
								# "b" is the brightness ratio of 2nd source compared to 1st
								for ($b = $brightness_low; $b <= $brightness_high + $epsilon; $b += $brightness_delta)
								{
									# "w" is q2, decay rate of second source (q1 is set to 1)
									for ($w = $q2_low; $w <= $q2_high + $epsilon; $w += $q2_delta)
									{
										# "v" is tmax
										for ($v = $tmax_low; $v <= $tmax_high + $epsilon; $v += $tmax_delta)
										{
											# "q" is delay between first and second source
											for ($q = $tshift_low; $q <= $tshift_high + $epsilon; $q += $tshift_delta)
											{
												my $submit_file = sprintf("submit-scripts/blob-%04i.csh", $n);
												if ($cur_batch_size==0) {
												  	open FP, ">$submit_file";
												  	printf FP "#! /bin/tcsh\n";
													printf FP "#\n";
													printf FP "#SBATCH --partition=serial\n";
													printf FP "#SBATCH --nodes=1\n";
													printf FP "#SBATCH --ntasks-per-node=1\n";
													printf FP "#SBATCH --mem=64GB\n";
													printf FP "#SBATCH --time=3:00:00\n";
													printf FP "#SBATCH --job-name=reverb\n";
													printf FP "\n";
													printf FP "module load CUDA\n";
													printf FP "module load cURL\n";
													printf FP "\n";
											  		printf FP "cd /mnt/storage/scratch/\${LOGNAME}/x-ray-reverberation\n";
											  		close FP;
											  	}
											  	open FP, ">>$submit_file";
											 	printf FP "/mnt/storage/scratch/\${LOGNAME}/x-ray-reverberation/blob -o$o -d$d -i$i -g$g -e$e -A$A -x$x -p$p -y$y -l$l -b$b -w$w -v$v -q$q\n";
									 		 	close FP;
									 		 	$cur_batch_size = $cur_batch_size + 1;
												if ($cur_batch_size >= $batch_size) {
											 	 	printf "sbatch $submit_file\n";

											 	 	if ($do_not_submit==0) {
										 				`sbatch $submit_file`;
										 				`sleep 4`;
										 			}
										 			$cur_batch_size = 0;
										 			$n = $n + 1;
										 		}
									 		 }
									 	}
									 }
								}
							}
						}
					}
				}
			}
		}
	}
}
# submit the last list of jobs if they haven't been queued already
if ($cur_batch_size > 0) {
	my $submit_file = sprintf("submit-scripts/blob-%04i.csh", $n);
	printf "sbatch $submit_file\n";

	if ($do_not_submit==0) {
		`sbatch $submit_file`;
	}
}

#+END_EXAMPLE
** Running the two blobs model

    Need to have the observer to disk integration done (run cosde-img).
    Need to have the source to disk integration done for all of the sources we are interested in (run code-s for a range of source heights).
    Need to calculate the spectra (run code-x for each source height).
    Use submit-blob.pl script to run blob code for all appropriate combinations)

We need to set up the submit_blob.pl script so that it will run the two blobs model for an appropriate range of parameters.
** Table models

#+BEGIN_EXAMPLE
#!/opt/local/bin/python2.7

# I run this code (on my Mac) using
# /opt/local/bin/python2.7 table-models.py

# We can use this to check to see if a file exists
import os.path
import sys

# HEASP has to be on the path - this is done by initialising HEASOFT first
from heasp import *

# I've installed astropy using Mac ports
from astropy.io import fits

# path to files containing the lag data
# path_to_rev = "/Users/phajy/Scratch/phxpc-table-model-2017-09-13/lag-data"
path_to_rev = "/Users/phajy/Scratch/steff-table-model"

# need to know grid size because we don't read in the grid until we find the first valid file
# the code checks that this value is correct in any case
n_e = 491
loaded_grid = False

# model parameters
rev_par_names = ["h1", "h2", "i", "gamma1", "gamma2", "A", "xi", "p", "r1", "r2", "b", "q2", "tmax", "tshift"]
# tabulated values
rev_par_values = [
	[2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0], 		# h1
	[3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0],			# h2
	[53.0],											# i
	[2.5, 2.7, 2.9, 3.1],							# gamma1
	[2.5, 2.7, 2.9, 3.1],							# gamma2
	[1.0],											# A
	[2.0, 2.5, 3.0],								# xi
	[0.0],											# p
	[1.0],											# r1
	[1.0],											# r2
	[1.0, 2.0, 3.0],								# b
	[0.5],											# q2
	[1000.0],										# tmax
	[0.0]											# tshift
	]
# initial values (gamma2 < gamma1), delta
rev_par_initial = [3.0, 8.0, 53.0,  2.9,  2.7,  1.0,  2.5,  0.0,  1.0,  1.0,  2.0,  0.5, 1000.0,  0.0]
rev_par_delta =   [0.5, 0.5, -1.0,  0.1,  0.1, -1.0, 0.25, -1.0, -1.0, -1.0,  0.5, -1.0,   -1.0, -1.0]

rev_tab = table()

# set table descriptors and the energy array
rev_tab.ModelName = "reverb"
rev_tab.ModelUnits = " "
rev_tab.isRedshift = True
rev_tab.isAdditive = True
rev_tab.isError = False

# all interpolated parameters
rev_tab.NumIntParams = len(rev_par_names)
rev_tab.NumAddParams = 0
print "Number of parameters = %i" % rev_tab.NumIntParams

# add the list of parameters to table model
cur_par = tableParameter()
for i in range(len(rev_par_names)):
	print "par[%i] = %s with %i values" % (i, rev_par_names[i], len(rev_par_values[i]))
	cur_par.clear()
	cur_par.Name = rev_par_names[i]
	cur_par.InterpolationMethod = 0 			# 0 - linear; 1 - logarithmic
	cur_par.InitialValue = rev_par_initial[i]
	cur_par.Delta = rev_par_delta[i]
	cur_par.Minimum = rev_par_values[i][0]
	cur_par.Bottom = rev_par_values[i][0]
	cur_par.Top = rev_par_values[i][-1]
	cur_par.Maximum = rev_par_values[i][-1]
	for j in range(len(rev_par_values[i])):
		cur_par.TabulatedValues.append(rev_par_values[i][j])
		# print "  tabulated value %e" % rev_par_values[i][j]
	rev_tab.pushParameter(cur_par)

# add spectra to table model
# the first time we do this we will also add the energy grid
index = []
for i in range(len(rev_par_names)):
	index.append(0)

cur_spec = tableSpectrum()
carry = 0
while (carry==0):
	#print "%i %i %i %i %i %i %i %i" % (index[0], index[1], index[2], index[3], index[4], index[5], index[6], index[7])

	# translate parameter values into filename - this will be problem specific
	# lag2b-h4+6-a0p998-i53-g2p7+3p1-A1-x2p5-p0-rs1+1-b3-q0p5-tmax1000-tshift0.fits
	# iras-h2+12-i60-g2p4+2p2-A20-x3-p0-rs1+0p2-b2p5-w30-v600-q0.fits
	# x-h2-a0p998-i53-g2p5-A1-x2-p0.fits
	# cur_file = "iras-h{0:1d}+{1:2d}-i60-g{2:1d}p{3:1d}+{4:1d}p{5:1d}-A20-x3-p0-rs{6:1d}+{7:1d}p{8:1d}-b2p5-w{9:2d}-v{10:3d}-q0.fits".format(int(rev_par_values[0][index[0]]), int(rev_par_values[1][index[1]]), int(rev_par_values[2][index[2]]), int(rev_par_values[2][index[2]]*10.0)%10, int(rev_par_values[3][index[3]]), int(rev_par_values[3][index[3]]*10.0)%10, int(rev_par_values[4][index[4]]), int(rev_par_values[5][index[5]]), int(rev_par_values[5][index[5]]*10.0)%10, int(rev_par_values[6][index[6]]), int(rev_par_values[7][index[7]]))
	# Part of filename for xi
	if ((rev_par_values[6][index[6]]*10.0)%10 == 0):
		xi_v = '{0:1d}' . format(int(rev_par_values[6][index[6]]))
	else:
		xi_v = '{0:1d}p{1:1d}' . format(int(rev_par_values[6][index[6]]), int(rev_par_values[6][index[6]]*10.0)%10)
	cur_file = 'lag2b-h{0:1d}+{1:1d}-a0p998-i{2:2d}-g{3:1d}p{4:1d}+{5:1d}p{6:1d}-A{7:1d}-x{8:s}-p{9:1d}-rs{10:1d}+{11:1d}-b{12:1d}-q{13:1d}p{14:1d}-tmax{15:4d}-tshift{16:1d}.fits' . format( \
		int(rev_par_values[0][index[0]]), \
		int(rev_par_values[1][index[1]]), \
		int(rev_par_values[2][index[2]]), \
		int(rev_par_values[3][index[3]]), int(rev_par_values[3][index[3]]*10.0)%10, \
		int(rev_par_values[4][index[4]]), int(rev_par_values[4][index[4]]*10.0)%10, \
		int(rev_par_values[5][index[5]]), \
		xi_v, \
		int(rev_par_values[7][index[7]]), \
		int(rev_par_values[8][index[8]]), \
		int(rev_par_values[9][index[9]]), \
		int(rev_par_values[10][index[10]]), \
		int(rev_par_values[11][index[11]]), int(rev_par_values[11][index[11]]*10.0)%10, \
		int(rev_par_values[12][index[12]]), \
		int(rev_par_values[13][index[13]]) \
		)
	print "  file = %s" % cur_file
	# clear current "spectrum" and add parameter values
	cur_spec.clear()
	for i in range(len(rev_par_names)):
		#print "adding value %e" % rev_par_values[i][index[i]]
   		cur_spec.ParameterValues.append(rev_par_values[i][index[i]])
	# see if file exists (non-existent file might mean we have an invalid choice of parameters)
	if os.path.isfile(path_to_rev + "/" + cur_file):
		#print "  exists"
		hdulist = fits.open(path_to_rev + "/" + cur_file)
		tabdata = hdulist[1].data
		#raw_input('Press enter to continue: ')
		# read in the energy grid (we only need to do this once)
		if loaded_grid == False:
			if (n_e != len(tabdata)):
				sys.exit("Check data table length")
			for i in range(len(tabdata)):
				rev_tab.Energies.append(tabdata[i][0])
			loaded_grid = True
		# put the time lags into the table model
		for i in range(n_e):
			cur_spec.Flux.append(tabdata[i][1])
	else:
		#print "  does not exist"
		# put zeros into the model if file does not exist (parameter choice is invalid)
		for i in range(n_e):
			cur_spec.Flux.append(0.0)
	rev_tab.pushSpectrum(cur_spec)

	# go to next file in the list
	#raw_input('Press enter to continue: ')
	carry = 1
	for i in range(len(rev_par_names)-1,-1,-1):
		if (carry == 1):
			index[i] = index[i] + 1
			carry = 0
			if (index[i] >= len(rev_par_values[i])):
				carry = 1
				index[i] = 0

# save table model
rev_tab.write("reverb.mod")
#+END_EXAMPLE

** setup-table.sl
To fit the table models you need =setup_table.sl= and the associated
parameter file =tlag.par=

=setup_table.sl= example

#+BEGIN_EXAMPLE
% Various bits of code to handle reverbeation table models in ISIS
% The model, internally, is in units of t_g.
% To fit the data, this needs to be scaled in frequency and normalisation.
% Updated 2017-02-16
% 	Scale to higher frequencies appropriate for binaries (lower mass).
% Updated 2019-01
%	Adjusted model so that reflection fraction are not included in the table model
%	Reflection fraction is now just a fit parameter in ISIS. This means we don't need
%	such big table models and can allow a broader range of reflection fractions

% Load the table model.

add_atable_model("reverb.mod", "tlag");

% Convolution model that scales the frequency bins and normalisation by mass.
% The model is called "scale_lf" for mass scaling the lag-frequency model.
% Parameter "norm" -- normalisation (/should/ always be 1 but can change if required).
% Parameter "log_mass" -- log_10 mass in units of Solar masses.
% This should be used, e.g., fit_fun("scale_lf(1, tlag)");

define scale_lf_fit(lo, hi, par, fun_value)
{
	variable norm = par[0];
	variable mass = 10.0^par[1];
	variable shift_lo = @lo;
	variable shift_hi = @hi;

	variable t_g = 492.703806 * (mass / 1.0E8);

	shift_lo = shift_lo * t_g;
	shift_hi = shift_hi * t_g;

	variable spec = rebin(lo, hi, shift_lo, shift_hi, fun_value);
	spec = norm * t_g * spec;
	return(spec);
}

add_slang_function("scale_lf", ["norm", "log_mass"]);
set_function_category("scale_lf", ISIS_FUN_OPERATOR);

% Set up a user-defined grid.
% This is important because when the convolution model shifts the spectrum up or down
% the model will need to be evaluated outside of the noticed range.
% 2017-02-17 - The grid has been updated so that we can scale to higher frequencies
%              which is required for binaries.

define extender (id, s) {
	% The table model covers an "energy" range from 1E-5 --> 7.76E-1.
	% Binning is logarithmic.
	% We want to evaluate the model over energy ranges from about 1E-6 --> 1E-1.
	% 5,000 bins should be more than we'll ever need.
	% Updating for binaries we want to go up to a frequency ("energy") of 10 Hz.
	% variable lam_lo = log10(_A(1.0E-1));
	variable lam_lo = log10(_A(10.0));
	variable lam_hi = log10(_A(1.0E-6));
	(s.bin_lo, s.bin_hi) = linear_grid(lam_lo, lam_hi, 5000);
	s.bin_lo = 10.0^s.bin_lo;
	s.bin_hi = 10.0^s.bin_hi;
	return s;
}

define use_extended_grid() {
	set_eval_grid_method (USER_GRID, all_data(), &extender);
}

% Load the data.

variable d = load_data("fully_comb_time_lags.fits");
variable r = load_rmf("fully_comb_time_lags.rsp");
assign_rmf(r, d);
use_extended_grid;

Label_By_Default = 0;
popt.xlabel="Frequency (Hz)";
popt.ylabel="Time lag (s)";
xlog;
popt.yrange=[-100, 200];
popt.xrange=[1e-4, 0.01];

load_par("tlag.par");
() = eval_counts;

plot_data(1, popt);
_pgsci(1);
_pgsls(2);
_pgmove(-4, 0);
_pgdraw(-1, 0);

#+END_EXAMPLE

=tlag.par= example
#+BEGIN_EXAMPLE
scale_lf(1, tlag)
 idx  param         tie-to  freeze         value         min         max
  1  tlag(1).norm       0     0       0.01831106           0       1e+10
  2  tlag(1).h1         0     0         6.886981           2           9
  3  tlag(1).h2         0     0         7.061849           3           9
  4  tlag(1).i          0     1               53          53          53
  5  tlag(1).gamma1     0     0         2.512999         2.5         3.1
  6  tlag(1).gamma2     0     0         2.500001         2.5         3.1
  7  tlag(1).A          0     1                1           1           1
  8  tlag(1).xi         0     0         2.999984           2           3
  9  tlag(1).p          0     1                0           0           0
 10  tlag(1).r1         0     1                1           1           1
 11  tlag(1).r2         0     1                1           1           1
 12  tlag(1).q2         0     0         1.764094           1           3
 13  tlag(1).b          0     1              0.5         0.5         0.5
 14  tlag(1).tmax       0     1             1000        1000        1000
 15  tlag(1).tshift     0     1                0           0           0
 16  tlag(1).redshift   0     1                0         -10          10
 17  scale_lf(1).norm   0     1                1           0           0
 18  scale_lf(1).mass   0     0         8.099397           5          10

#+END_EXAMPLE

** lag-freq-fits.sl

To run this script,

#+BEGIN_EXAMPLE
% Two blobs model fitting routines
%
% Author: Andy Young
% Date: 2019-01 -- 2019-04
%
% 2019-03 2019-04: updated so ISIS can ask for files to be generated when needed
% This is expected to be run as an isis-script
% isis-script lag-freq-fits.sl fit plot
% where fit = fit data
%       plot = make a nice plot of the current best fit
%       fit n m = fit data but only run if index mod m = n (so fit 2 5 would fit every 3 of 5); this allows simple parallelisation

% Some global variables and paths (update to your own path)
% variable path_to_lags = "/mnt/storage/scratch/phajy/x-ray-reverberation";
% Assumes the lags are in a subdirectory of the current directory
variable path_to_lags = getcwd;

variable list_of_files = {};
variable list_of_lags = {};
variable array_of_files = String_Type[0];

variable debug = 0; % non-zero to output more debugging information

% The new filename format is, e.g.,
% lag/i53/a0.998/h02.0+03.0/g2.5+2.5/A01.0/x2.0/p00.0/b02.0/q0.5/tmax1000/tshift0000/lag.fits

% Routine to look up the model
define lag_freq_fit(lo, hi, par)
{
	variable norm = par[0];
	variable mass = 10.0^par[1];

	variable i = par[2];
	variable a = par[3];
	variable h1 = par[4];
	variable h2 = par[5];
	variable g1 = par[6];
	variable g2 = par[7];
	variable abund = par[8];
	variable xi = par[9];
	variable p = par[10];
	variable b = par[11];
	variable q = par[12];
	variable tmax = par[13];
	variable tshift = par[14];

	% Now we need to generate the appropriate filename and see if it exists
	variable fp;
	variable filename = sprintf("lag-files/i%02.0f/a%05.3f/h%04.1f+%04.1f/g%03.1f+%03.1f/A%04.1f/x%03.1f/p%04.1f/b%04.1f/q%03.1f/tmax%04.0f/tshift%04.0f/lag.fits", i, a, h1, h2, g1, g2, abund, xi, p, b, q, tmax, tshift);
	if (debug>0) vmessage("Using filename %s", filename);

	variable t_g = 492.703806 * (mass / 1.0E8);

	% Read in the lag as a function of frequency
	% Note that units are tg^-1 (freq) and tg (lag)

	variable spec;
	variable ft;
	variable zero = 0;

	% see if we've already loaded in this file
	variable ix = where(array_of_files==filename);
	if (length(ix>0)) {
		% we have already seen this file
		% retrieve the saved values from memory
		if (debug>0) vmessage("Reading cached file %s (index %i)", filename, ix[0]);
		ft = list_of_lags[ix[0]];
		if (ft==NULL) {
			% null file means it didn't exist
			if (debug>0) vmessage("  ... but it doesn't exist");
			zero = 1;
		}
	} else {
		% we need to read in the file
		% check if file exists
		% vmessage("checking " + path_to_lags + "/" + filename);
		fp = fopen(path_to_lags + "/" + filename, "r");
	    if (fp == NULL)
	    {
	    	% file does not exist
	    	vmessage("File %s does not exist", filename);

	    	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	    	% note that in some instances the parameter values should produce zero in which case we don't need to create any files
	    	% second source height has to be higher than first
	    	if (h2>h1) {
		    	% decide if we can create the necessary files
				variable cmd;
				% do we have the first code-x file we need?
				variable code_x_a = sprintf("code-x-files/i%02.0f/a%05.3f/h%04.1f/g%3.1f/A%03.1f/x%03.1f/p%04.1f/rev.fits", i, a, h1, g1, abund, xi, p);
				if (debug>0) vmessage("Looking for %s", code_x_a);
				fp = fopen(code_x_a, "r");
				if (fp==NULL) {
					% file doesn't exist
					% try to create file
					cmd = sprintf("./code-x -i%0.1f -a%5.3f -h%0.1f -g%0.1f -A%0.1f -x%0.1f -p%0.1f", i, a, h1, g1, abund, xi, p);
					vmessage("   ...command to execute is %s", cmd);
					% plot_pause;
					() = system(cmd);
					% vmessage("   ...done!");
				} else {
					% file does exist
					() = fclose(fp);
					% vmessage("   ...found");
				}
				% do we have the second code-x file we need?
				variable code_x_b = sprintf("code-x-files/i%02.0f/a%05.3f/h%04.1f/g%3.1f/A%03.1f/x%03.1f/p%04.1f/rev.fits", i, a, h2, g2, abund, xi, p);
				if (debug>0) vmessage("Looking for %s", code_x_b);
				fp = fopen(code_x_b, "r");
				if (fp==NULL) {
					% file doesn't exist
					% try to create file
					cmd = sprintf("./code-x -i%0.1f -a%5.3f -h%0.1f -g%0.1f -A%0.1f -x%0.1f -p%0.1f", i, a, h2, g2, abund, xi, p);
					vmessage("   ...command to execute is %s", cmd);
					% plot_pause;
					() = system(cmd);
					% vmessage("   ...done!");
				} else {
					% file does exist
					() = fclose(fp);
					% vmessage("   ...found");
				}

				% run two blobs script
				cmd = sprintf("./blob -o%0.1f -d%0.1f -i%0.1f -g%0.1f -e%0.1f -A%0.1f -x%0.1f -p%0.1f -y1.0 -l1.0 -b%0.1f -w%0.1f -v%0.0f -q%0.0f", h1, h2, i, g1, g2, abund, xi, p, b, q, tmax, tshift);
				if (debug>0) vmessage("Run two blobs model %s", cmd);
				% plot_pause;
				() = system(cmd);
				% message("   ...done!");

				ft = fits_read_table(path_to_lags + "/" + filename);
				list_append(list_of_files, filename, -1);
				list_append(list_of_lags, ft, -1);
				array_of_files = list_to_array(list_of_files);
			} else {
		    	% output should be zeros; model is invalid (h2<=h1)
		    	vmessage("   ... should be null");
		    	zero = 1;
		    	% save file with NULL structure so we can skip quickly next time
		    	list_append(list_of_files, filename, -1);
				list_append(list_of_lags, NULL, -1);
				array_of_files = list_to_array(list_of_files);
			}
			%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	    } else {
	    	() = fclose(fp);

    		% vmessage("Reading file %s", filename);
			ft = fits_read_table(path_to_lags + "/" + filename);
			list_append(list_of_files, filename, -1);
			list_append(list_of_lags, ft, -1);
			array_of_files = list_to_array(list_of_files);
		}
	}

	if (zero==0) {
		% Shift all of the frequency bins
		variable fq = ft.fq / t_g;

		% Scale all time lags
		variable lag = ft.lag * t_g;

		% Overall normalizaton (which accounts for dilution, etc.)
		lag = lag * norm;

		% Frequency should now be in units of Hz
		% Lag should now be in units of seconds

		spec = rebin(lo, hi, _A(fq), _A(make_hi_grid(fq)), reverse(lag));
	} else {
		spec = Double_Type[length(lo)];
	}

	return(spec);
}

% New version will be:
add_slang_function("lag_freq", ["norm", "log_mass", "i", "a", "h1", "h2", "Gamma1", "Gamma2", "Fe", "xi", "p", "b", "q2", "t_max", "t_shift"]);

%rev_par_values = [
%	[2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0], 		# h1
%	[3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0],			# h2
%	[53.0],											# i
%	[2.5, 2.7, 2.9, 3.1],							# gamma1
%	[2.5, 2.7, 2.9, 3.1],							# gamma2
%	[1.0],											# A
%	[2.0, 2.5, 3.0],								# xi
%	[0.0],											# p
%	[1.0],											# r1
%	[1.0],											# r2
%	[1.0, 2.0, 3.0],								# b
%	[0.5],											# q2
%	[1000.0],										# tmax
%	[0.0]											# tshift
%	]
% initial values (gamma2 < gamma1), delta

% Load the data.

variable d = load_data("fully_comb_time_lags.fits");
variable r = load_rmf("fully_comb_time_lags.rsp");
assign_rmf(r, d);

Label_By_Default = 0;
popt.xlabel="Frequency (Hz)";
popt.ylabel="Time lag (s)";
xlog;
popt.yrange=[-100, 200];
popt.xrange=[1e-4, 0.01];

% load_par("new_tlag.par");
% load_par("v2_tlag.par");
load_par("best_fit.par");
() = eval_counts;

if (length(where(__argv=="plot"))==1) {
	load_par("best_fit.par");
	() = eval_counts;
	plot_data(1, popt);
	_pgsci(1);
	_pgsls(2);
	_pgmove(-4, 0);
	_pgdraw(-1, 0);
	list_par;
	plot_pause;
}

% Some routine to step through all possible combinations of parameters that we are interested in
variable n_pars = 8;
variable pars_to_fit = String_Type[n_pars];
variable vals_to_fit = Array_Type[n_pars];
variable index = Integer_Type[n_pars];
% Note I've changed the order before so that the code can run code-x for different source heights
% This makes the parallelisation more efficient
pars_to_fit[0] = "t_shift";
vals_to_fit[0] = [0.0, 50.0, 100.0];
pars_to_fit[1] = "t_max";
vals_to_fit[1] = [250.0, 500.0, 750.0, 1000.0];
pars_to_fit[2] = "Gamma1";
vals_to_fit[2] = [2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.7, 2.9, 3.1];
pars_to_fit[3] = "Gamma2";
vals_to_fit[3] = [2.0, 2.1, 2.2, 2.3, 2.34, 2.5, 2.7, 2.9, 3.1];
pars_to_fit[4] = "x";
vals_to_fit[4] = [0.0, 1.0, 2.0, 3.0];
pars_to_fit[5] = "b";
vals_to_fit[5] = [1.0, 2.0, 3.0];
pars_to_fit[6] = "h1";
vals_to_fit[6] = [2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0];
pars_to_fit[7] = "h2";
vals_to_fit[7] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0];

% see if we should be fitting to the data
if (length(where(__argv=="fit"))==1) {
	variable m = 0; % which one to run
	variable n = 1; % out of (n-1)
	if (debug>0) {
		vmessage("__argc=%i", __argc);
		print(__argv);
		if (debug>1) plot_pause;
	}
	if (__argc==4)
	{
		() = sscanf(__argv[2], "%i", &m);
		() = sscanf(__argv[3], "%i", &n);
	}
	vmessage("Fitting %i of %i", m, n);
	if (debug>1) plot_pause;
	variable ix = 0;
	variable total = 0;
	variable i, s;
	variable best_s = 1.0E10;
	variable done = 0;
	do {
		if (ix==m) {
			if (debug>0) vmessage("New fit %i of %i (total %i)", ix, n, total);
			if (debug>1) plot_pause;
			% set parameter values
			for (i=0; i<length(pars_to_fit); i++) {
				set_par(sprintf("lag_freq(1).%s", pars_to_fit[i]), vals_to_fit[i][index[i]]);
			 	% () = printf("Setting parameter lag_freq(1).%s to %e\n", pars_to_fit[i], vals_to_fit[i][index[i]]);
			}
			% do fit
			() = fit_counts(&s);
			% see if we have a new best fit and if so plot it
			if (s.statistic < best_s) {
				% plot_data(1, popt);
				best_s = s.statistic;
				save_par(sprintf("best_fit_%02i.par", m));
				list_par;
				vmessage("Best fit with statistic = %e", best_s);
				variable fp = fopen(sprintf("best_fit_%02i.txt",m),"w");
				() = fprintf(fp, "%e", s.statistic);
				() = fclose(fp);
				variable pid = open_plot(sprintf("best_fit_%02i.ps/cps",m));
				title(sprintf("Statistic = %e", s.statistic));
				plot_data(1, popt);
				_pgsci(1);
				_pgsls(2);
				_pgmove(-4, 0);
				_pgdraw(-1, 0);
				close_plot(pid);
				% plot_pause;
			}
		}
		ix = ix + 1;
		if (ix >= n) {
			ix = 0;
		}
		total = total + 1;

		% move on to next parameter combination
		done = 1;
		for (i=0; i<length(pars_to_fit); i++) {
			% vmessage("i = %i", i);
			if (done == 1)
			{
				% vmessage("i = %i index = %i len = %i", i, index[i], length(vals_to_fit[i]));
				index[i] = index[i] + 1;
				% vmessage("i = %i index = %i len = %i", i, index[i], length(vals_to_fit[i]));
				if (index[i] == length(vals_to_fit[i]))
				{
					index[i] = 0;
				} else {
					done = 0;
				}
			}
		}
		% vmessage("Done");
	} while (done==0);
}
#+END_EXAMPLE

** submit-lag-freq.sh

#+BEGIN_EXAMPLE
#! /bin/tcsh
#
#SBATCH --partition=serial
#SBATCH --nodes=1
#SBATCH --ntasks-per-node=1
#SBATCH --mem=4GB
#SBATCH --time=0-12:00:00
#SBATCH --job-name=lag-freq
#SBATCH --array=0-31

## Note that array should be from 0 to (n-1) and isis-script should be run with n at the end

module load CUDA
module load cURL

cd /mnt/storage/scratch/${LOGNAME}/x-ray-reverberation

isis-script lag-freq-fits.sl fit $SLURM_ARRAY_TASK_ID 32
#+END_EXAMPLE
** find-best-fit.py

#+BEGIN_EXAMPLE
#! /usr/bin/python3

# Look at all the best fits and pick the one with the smallest statistic

import glob
import os
import string

files = glob.glob('best_fit_??.txt')
best_stat = 1.0E10;
best_file = "";
for file in files:
	with open(file) as f:
		cur_stat = float(next(f))
		if (cur_stat < best_stat):
			best_stat = cur_stat
			best_file = file

print("Best fit is", best_stat, "in file", best_file)
os.system("cp " + best_file + " best_fit.txt")
best_file.replace(".txt", ".par")
os.system("cp " + best_file + " best_fit.par")
best_file.replace(".par", ".ps")
os.system("cp " + best_file + " best_fit.ps")
#+END_EXAMPLE

** Replot best lag fits file

#+BEGIN_EXAMPLE
Two blobs model fitting routines
%
% Author: Andy Young
% Date: 2019-01 -- 2019-04
%
% 2019-03 2019-04: updated so ISIS can ask for files to be generated when needed
% This is expected to be run as an isis-script
% isis-script lag-freq-fits.sl fit plot
% where fit = fit data
%       plot = make a nice plot of the current best fit
%       fit n m = fit data but only run if index mod m = n (so fit 2 5 would fit every 3 of 5); this allows simple parallelisation

% Some global variables and paths (update to your own path)
% variable path_to_lags = "/mnt/storage/scratch/phajy/x-ray-reverberation";
% Assumes the lags are in a subdirectory of the current directory
variable path_to_lags = getcwd;

variable list_of_files = {};
variable list_of_lags = {};
variable array_of_files = String_Type[0];

variable debug = 0; % non-zero to output more debugging information

% The new filename format is, e.g.,
% lag/i53/a0.998/h02.0+03.0/g2.5+2.5/A01.0/x2.0/p00.0/b02.0/q0.5/tmax1000/tshift0000/lag.fits

% Routine to look up the model
define lag_freq_fit(lo, hi, par)
{
	variable norm = par[0];
	variable mass = 10.0^par[1];

	variable i = par[2];
	variable a = par[3];
	variable h1 = par[4];
	variable h2 = par[5];
	variable g1 = par[6];
	variable g2 = par[7];
	variable abund = par[8];
	variable xi = par[9];
	variable p = par[10];
	variable b = par[11];
	variable q = par[12];
	variable tmax = par[13];
	variable tshift = par[14];

	% Now we need to generate the appropriate filename and see if it exists
	variable fp;
	variable filename = sprintf("lag-files/i%02.0f/a%05.3f/h%04.1f+%04.1f/g%03.1f+%03.1f/A%04.1f/x%03.1f/p%04.1f/b%04.1f/q%03.1f/tmax%04.0f/tshift%04.0f/lag.fits", i, a, h1, h2, g1, g2, abund, xi, p, b, q, tmax, tshift);
	if (debug>0) vmessage("Using filename %s", filename);

	variable t_g = 492.703806 * (mass / 1.0E8);

	% Read in the lag as a function of frequency
	% Note that units are tg^-1 (freq) and tg (lag)

	variable spec;
	variable ft;
	variable zero = 0;

	% see if we've already loaded in this file
	variable ix = where(array_of_files==filename);
	if (length(ix>0)) {
		% we have already seen this file
		% retrieve the saved values from memory
		if (debug>0) vmessage("Reading cached file %s (index %i)", filename, ix[0]);
		ft = list_of_lags[ix[0]];
		if (ft==NULL) {
			% null file means it didn't exist
			if (debug>0) vmessage("  ... but it doesn't exist");
			zero = 1;
		}
	} else {
		% we need to read in the file
		% check if file exists
		% vmessage("checking " + path_to_lags + "/" + filename);
		fp = fopen(path_to_lags + "/" + filename, "r");
	    if (fp == NULL)
	    {
	    	% file does not exist
	    	vmessage("File %s does not exist", filename);

	    	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	    	% note that in some instances the parameter values should produce zero in which case we don't need to create any files
	    	% second source height has to be higher than first
	    	if (h2>h1) {
		    	% decide if we can create the necessary files
				variable cmd;
				% do we have the first code-x file we need?
				variable code_x_a = sprintf("code-x-files/i%02.0f/a%05.3f/h%04.1f/g%3.1f/A%03.1f/x%03.1f/p%04.1f/rev.fits", i, a, h1, g1, abund, xi, p);
				if (debug>0) vmessage("Looking for %s", code_x_a);
				fp = fopen(code_x_a, "r");
				if (fp==NULL) {
					% file doesn't exist
					% try to create file
					cmd = sprintf("./code-x -i%0.1f -a%5.3f -h%0.1f -g%0.1f -A%0.1f -x%0.1f -p%0.1f", i, a, h1, g1, abund, xi, p);
					vmessage("   ...command to execute is %s", cmd);
					% plot_pause;
					() = system(cmd);
					% vmessage("   ...done!");
				} else {
					% file does exist
					() = fclose(fp);
					% vmessage("   ...found");
				}
				% do we have the second code-x file we need?
				variable code_x_b = sprintf("code-x-files/i%02.0f/a%05.3f/h%04.1f/g%3.1f/A%03.1f/x%03.1f/p%04.1f/rev.fits", i, a, h2, g2, abund, xi, p);
				if (debug>0) vmessage("Looking for %s", code_x_b);
				fp = fopen(code_x_b, "r");
				if (fp==NULL) {
					% file doesn't exist
					% try to create file
					cmd = sprintf("./code-x -i%0.1f -a%5.3f -h%0.1f -g%0.1f -A%0.1f -x%0.1f -p%0.1f", i, a, h2, g2, abund, xi, p);
					vmessage("   ...command to execute is %s", cmd);
					% plot_pause;
					() = system(cmd);
					% vmessage("   ...done!");
				} else {
					% file does exist
					() = fclose(fp);
					% vmessage("   ...found");
				}

				% run two blobs script
				cmd = sprintf("./blob -o%0.1f -d%0.1f -i%0.1f -g%0.1f -e%0.1f -A%0.1f -x%0.1f -p%0.1f -y1.0 -l1.0 -b%0.1f -w%0.1f -v%0.0f -q%0.0f", h1, h2, i, g1, g2, abund, xi, p, b, q, tmax, tshift);
				if (debug>0) vmessage("Run two blobs model %s", cmd);
				% plot_pause;
				() = system(cmd);
				% message("   ...done!");

				ft = fits_read_table(path_to_lags + "/" + filename);
				list_append(list_of_files, filename, -1);
				list_append(list_of_lags, ft, -1);
				array_of_files = list_to_array(list_of_files);
			} else {
		    	% output should be zeros; model is invalid (h2<=h1)
		    	vmessage("   ... should be null");
		    	zero = 1;
		    	% save file with NULL structure so we can skip quickly next time
		    	list_append(list_of_files, filename, -1);
				list_append(list_of_lags, NULL, -1);
				array_of_files = list_to_array(list_of_files);
			}
			%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	    } else {
	    	() = fclose(fp);

    		% vmessage("Reading file %s", filename);
			ft = fits_read_table(path_to_lags + "/" + filename);
			list_append(list_of_files, filename, -1);
			list_append(list_of_lags, ft, -1);
			array_of_files = list_to_array(list_of_files);
		}
	}

	if (zero==0) {
		% Shift all of the frequency bins
		variable fq = ft.fq / t_g;

		% Scale all time lags
		variable lag = ft.lag * t_g;

		% Overall normalizaton (which accounts for dilution, etc.)
		lag = lag * norm;

		% Frequency should now be in units of Hz
		% Lag should now be in units of seconds

		spec = rebin(lo, hi, _A(fq), _A(make_hi_grid(fq)), reverse(lag));
	} else {
		spec = Double_Type[length(lo)];
	}

	return(spec);
}

% New version will be:
add_slang_function("lag_freq", ["norm", "log_mass", "i", "a", "h1", "h2", "Gamma1", "Gamma2", "Fe", "xi", "p", "b", "q2", "t_max", "t_shift"]);

% Load the data.
Ignore_PHA_Response_Keywords = 1;
variable d = load_data("1H0707-495-time-lag-fits/1H0707-495-2010-time-lags.fits");
variable r = load_rmf("1H0707-495-time-lag-fits/1H0707-495-2010-time-lags.rsp");
assign_rmf(r, d);

Label_By_Default = 0;
popt.xlabel="Frequency (Hz)";
popt.ylabel="Time lag (s)";
xlog;
popt.yrange=[-100, 200];
popt.xrange=[1e-4, 7e-3];

load_par("1H0707_2010_best_fit_07.par");
() = eval_counts;

variable pid = open_plot("1H0707_2010_ecm.ps/cps");
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
plot_comps(1,popt,&plot_data);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgsci(1); % make line colour black
_pgdraw(1,0);
close_plot(pid);
#+END_EXAMPLE

** lag-freq-files.sl

#+BEGIN_EXAMPLE
% Two blobs model fitting routines
% The purpose of this code is to make sure all of the necessary files are present
% This only does the code-x runs because each "blob" run is unique and can be done by the fitting code
% Note that the parameter grid that is stepped through should be the same as used in the fitting code
%
% Author: Andy Young
% Date: 2019-08
%
% This is expected to be run as an isis-script
% isis-script lag-freq-fits.sl n m
% where n m = calculate file if index mod m = n (so 2 5 would calculate every 3 of 5); this allows simple parallelisation

% Some global variables and paths (update to your own path)
% variable path_to_lags = "/mnt/storage/scratch/phajy/x-ray-reverberation";
% Assumes the lags are in a subdirectory of the current directory
variable path_to_lags = getcwd;

variable debug = 0;

variable list_of_files = {};
variable array_of_files = String_Type[0];

variable m = 0; % which one to run
variable n = 1;
() = sscanf(__argv[1], "%i", &m);
() = sscanf(__argv[2], "%i", &n);
vmessage("m=%i n=%i", m, n);
variable count = 0;

% The new filename format is, e.g.,
% lag/i53/a0.998/h02.0+03.0/g2.5+2.5/A01.0/x2.0/p00.0/b02.0/q0.5/tmax1000/tshift0000/lag.fits

% Routine to look up the model
define lag_freq_fit(lo, hi, par)
{
	variable norm = par[0];
	variable mass = 10.0^par[1];

	variable i = par[2];
	variable a = par[3];
	variable h1 = par[4];
	variable h2 = par[5];
	variable g1 = par[6];
	variable g2 = par[7];
	variable abund = par[8];
	variable xi = par[9];
	variable p = par[10];
	variable b = par[11];
	variable q = par[12];
	variable tmax = par[13];
	variable tshift = par[14];

	% Now we need to generate the appropriate filename and see if it exists
	variable fp, ix;
	variable filename = sprintf("lag-files/i%02.0f/a%05.3f/h%04.1f+%04.1f/g%03.1f+%03.1f/A%04.1f/x%03.1f/p%04.1f/b%04.1f/q%03.1f/tmax%04.0f/tshift%04.0f/lag.fits", i, a, h1, h2, g1, g2, abund, xi, p, b, q, tmax, tshift);

	% check if file exists
	if (debug>0) vmessage("checking " + path_to_lags + "/" + filename);
	fp = fopen(path_to_lags + "/" + filename, "r");
    if (fp == NULL)
    {
    	% file does not exist
    	if (debug>0) vmessage("File %s does not exist", filename);

    	% note that in some instances the parameter values should produce zero in which case we don't need to create any files
    	% second source height has to be higher than first
    	if (h2>h1) {
	    	% decide if we can create the necessary files
			variable cmd;
			% do we have the first code-x file we need?
			variable code_x_a = sprintf("code-x-files/i%02.0f/a%05.3f/h%04.1f/g%3.1f/A%03.1f/x%03.1f/p%04.1f/rev.fits", i, a, h1, g1, abund, xi, p);
			if (debug>0) vmessage("Looking for %s", code_x_a);
			fp = fopen(code_x_a, "r");
			if (fp==NULL) {
				% file doesn't exist
				cmd = sprintf("./code-x -i%0.1f -a%5.3f -h%0.1f -g%0.1f -A%0.1f -x%0.1f -p%0.1f", i, a, h1, g1, abund, xi, p);
				% try to create file if we haven't already
				ix = where(array_of_files==cmd);
				if (length(ix>0)) {
					% we have already tried to create this file
				} else {
					if (count==m) {
						vmessage("   ...command to execute is %s", cmd);
						() = system(cmd); % <-- comment out for testing
					} else {
						if (debug>0) vmessage("   skipping");
					}
					% plot_pause;
					count = count + 1;
					if (count >= n) {
						count = 0;
					}
					list_append(list_of_files, cmd, -1);
					array_of_files = list_to_array(list_of_files);
				}
			}
			% do we have the second code-x file we need?
			variable code_x_b = sprintf("code-x-files/i%02.0f/a%05.3f/h%04.1f/g%3.1f/A%03.1f/x%03.1f/p%04.1f/rev.fits", i, a, h2, g2, abund, xi, p);
			if (debug>0) vmessage("Looking for %s", code_x_b);
			fp = fopen(code_x_b, "r");
			if (fp==NULL) {
				% file doesn't exist
				cmd = sprintf("./code-x -i%0.1f -a%5.3f -h%0.1f -g%0.1f -A%0.1f -x%0.1f -p%0.1f", i, a, h2, g2, abund, xi, p);
				% try to create file if we haven't already
				ix = where(array_of_files==cmd);
				if (length(ix>0)) {
					% we have already tried to create this file
				} else {
					if (count==m) {
						vmessage("   ...command to execute is %s", cmd);
						() = system(cmd); % <-- comment out for testing
					} else {
						if (debug>0) vmessage("   skipping");
					}
					% plot_pause;
					count = count + 1;
					if (count >= n) {
						count = 0;
					}
					list_append(list_of_files, cmd, -1);
					array_of_files = list_to_array(list_of_files);
				}
			}
		}
	}
	return 0;
}

add_slang_function("lag_freq", ["norm", "log_mass", "i", "a", "h1", "h2", "Gamma1", "Gamma2", "Fe", "xi", "p", "b", "q2", "t_max", "t_shift"]);

% Some routine to step through all possible combinations of parameters that we are interested in
variable n_pars = 8;
variable pars_to_fit = String_Type[n_pars];
variable vals_to_fit = Array_Type[n_pars];
variable index = Integer_Type[n_pars];
% Note I've changed the order before so that the code can run code-x for different source heights
% This makes the parallelisation more efficient
pars_to_fit[0] = "t_shift";
vals_to_fit[0] = [0.0, 50.0, 100.0, 150.0];
pars_to_fit[1] = "t_max";
vals_to_fit[1] = [250.0, 500.0, 750.0, 1000.0];
pars_to_fit[2] = "Gamma1";
vals_to_fit[2] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.7, 2.9, 3.1];
pars_to_fit[3] = "Gamma2";
vals_to_fit[3] = [1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.7, 2.9, 3.1];
pars_to_fit[4] = "x";
vals_to_fit[4] = [0.0, 1.0, 2.0, 3.0];
pars_to_fit[5] = "b";
vals_to_fit[5] = [1.0, 2.0, 3.0];
pars_to_fit[6] = "h1";
vals_to_fit[6] = [2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0];
pars_to_fit[7] = "h2";
vals_to_fit[7] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 16.0, 17.0, 18.0, 19.0, 20.0];

variable lo, hi;
(lo, hi) = linear_grid(1,10,10); % dummy grid

load_par("best_fit.par");

variable i;
variable done = 0;
do {
	% set parameter values
	for (i=0; i<length(pars_to_fit); i++) {
		set_par(sprintf("lag_freq(1).%s", pars_to_fit[i]), vals_to_fit[i][index[i]]);
	 	% () = printf("Setting parameter lag_freq(1).%s to %e\n", pars_to_fit[i], vals_to_fit[i][index[i]]);
	}

	%list_par;
	%plot_pause;

	% do fit
	() = eval_fun(lo, hi);

	% move on to next parameter combination
	done = 1;
	for (i=0; i<length(pars_to_fit); i++) {
		% vmessage("i = %i", i);
		if (done == 1)
		{
			% vmessage("i = %i index = %i len = %i", i, index[i], length(vals_to_fit[i]));
			index[i] = index[i] + 1;
			% vmessage("i = %i index = %i len = %i", i, index[i], length(vals_to_fit[i]));
			if (index[i] == length(vals_to_fit[i]))
			{
				index[i] = 0;
			} else {
				done = 0;
			}
		}
	}
} while (done==0);
#+END_EXAMPLE

** submit-lag-files.sh

#+BEGIN_EXAMPLE
#! /bin/tcsh
#
#SBATCH --partition=serial
#SBATCH --nodes=1
#SBATCH --ntasks-per-node=1
#SBATCH --mem=4GB
#SBATCH --time=0-12:00:00
#SBATCH --job-name=lag-files
#SBATCH --array=0-15

## Note that array should be from 0 to (n-1) and isis-script should be run with n at the end

module load CUDA
module load cURL

cd /mnt/storage/scratch/${LOGNAME}/x-ray-reverberation

isis-script lag-freq-files.sl $SLURM_ARRAY_TASK_ID 16
#+END_EXAMPLE

** PCA Code
#+BEGIN_EXAMPLE
# see http://sebastianraschka.com/Articles/2015_pca_in_3_steps.html


import pandas as pd
from matplotlib import pyplot as plt
import numpy as np
import math
from sklearn.preprocessing import StandardScaler


df = pd.read_csv(
    filepath_or_buffer='/homeb/steff075/phd_ecm/data-pca/ecm-model-pars.csv',
    header=1,
    sep=',')

df.columns=['height', 'gamma', 'Fe', 'xi', 'b', 'q2', 'tmax','tshift','class']
df.dropna(how="all", inplace=True) # drops the empty line at file-end

df.tail()


# split data table into data X and class labels y

X = df.iloc[:,0:8].values
y = df.iloc[:,8].values

label_dict = {1: 'Lo-source',
              2: 'Med-source',
              3: 'High-source'}

feature_dict = {0: 'Height',
                1: 'Gamma',
                2: 'Fe',
                3: 'xi',
                4: 'b',
                5: 'q2',
                6: 'tmax',
                7: 'tshift'}

with plt.style.context('seaborn-whitegrid'):
    plt.figure(figsize=(14, 20))
    for cnt in range(8):
        plt.subplot(6, 2, cnt+1)
        for lab in ('Lo-source', 'Hi-source'):
            plt.hist(X[y==lab, cnt],
                     label=lab,
                     bins=10,
                     alpha=0.3,)
        plt.xlabel(feature_dict[cnt])
    plt.legend(loc='upper right', fancybox=True, fontsize=9)

    plt.tight_layout()
    plt.show()


from sklearn.preprocessing import StandardScaler

X_std = StandardScaler().fit_transform(X)

#The mean vector is a d-dimensional vector where each value in this vector represents the sample mean
#of a feature column in the dataset.

mean_vec = np.mean(X_std, axis=0)
cov_mat = (X_std - mean_vec).T.dot((X_std - mean_vec)) / (X_std.shape[0]-1)
print('Covariance matrix \n%s' %cov_mat)

# Covariance Matrix

cov_mat = np.cov(X_std.T)


#Next, we perform an eigendecomposition on the covariance matrix:
eig_vals, eig_vecs = np.linalg.eig(cov_mat)

print('Eigenvectors \n%s' %eig_vecs)
print('\nEigenvalues \n%s' %eig_vals)


# Eigendecomposition of the standardized data based on the correlation matrix:

cor_mat1 = np.corrcoef(X_std.T)

eig_vals, eig_vecs = np.linalg.eig(cor_mat1)

print('Eigenvectors \n%s' %eig_vecs)
print('\nEigenvalues \n%s' %eig_vals)



# Eigendecomposition of the raw data based on the correlation matrix:

cor_mat2 = np.corrcoef(X.T)

eig_vals, eig_vecs = np.linalg.eig(cor_mat2)

print('Eigenvectors \n%s' %eig_vecs)
print('\nEigenvalues \n%s' %eig_vals)


# Singular Value Decomposition

u,s,v = np.linalg.svd(X_std.T)
u


# Selecting Principal Components


#Sorting Eigenpairs

#However, the eigenvectors only define the directions of the new axis, since they have all the same
#unit length 1, which can confirmed by the following two lines of code:

for ev in eig_vecs.T:
    np.testing.assert_array_almost_equal(1.0, np.linalg.norm(ev))
print('Everything ok!')


# rank the eigenvalues from highest to lowest in order choose the top k eigenvectors.

# Make a list of (eigenvalue, eigenvector) tuples
eig_pairs = [(np.abs(eig_vals[i]), eig_vecs[:,i]) for i in range(len(eig_vals))]

# Sort the (eigenvalue, eigenvector) tuples from high to low
eig_pairs.sort(key=lambda x: x[0], reverse=True)

# Visually confirm that the list is correctly sorted by decreasing eigenvalues
print('Eigenvalues in descending order:')
for i in eig_pairs:
    print(i[0])


#The explained variance tells us how much information (variance) can be attributed to each of
#the principal components.

tot = sum(eig_vals)
var_exp = [(i / tot)*100 for i in sorted(eig_vals, reverse=True)]
cum_var_exp = np.cumsum(var_exp)

with plt.style.context('seaborn-whitegrid'):
    plt.figure(figsize=(7, 5))

    plt.bar(range(8), var_exp, alpha=0.6, align='center',
            label='individual explained variance')
    plt.step(range(8), cum_var_exp, where='mid',
             label='cumulative explained variance')
    plt.ylabel('Explained variance ratio')
    plt.xlabel('Principal components')
    plt.legend(loc='best')
    plt.tight_layout()




#Projection Matrix

matrix_w = np.hstack((eig_pairs[0][1].reshape(8,1),
                      eig_pairs[1][1].reshape(8,1)))

print('Matrix W:\n', matrix_w)



#Projection onto the New Feature Space

Y = X_std.dot(matrix_w)

with plt.style.context('seaborn-whitegrid'):
    plt.figure(figsize=(8, 6))
    for lab, col in zip(('Hi-source', 'Med-source','Lo-source'),
                        ('red', 'green', 'blue')):
        plt.scatter(Y[y==lab, 0],
                    Y[y==lab, 1],
                    label=lab,
                    c=col)
    plt.xlabel('Principal Component 1')
    plt.ylabel('Principal Component 2')
    plt.legend(loc='lower right')
    plt.tight_layout()
    plt.show()
    plt.savefig('/home/steff075/phd_ecm/data-pca/ecm-pca.png')




#+END_EXAMPLE
** Joint fitting the ECM

#+BEGIN_EXAMPLE
% Two blobs model fitting routines
%
% Author: Andy Young
% Date: 2019-01 -- 2019-11
%
% 2019-11: updated to allow joint fits
% 2019-03 2019-04: updated so ISIS can ask for files to be generated when needed
% This is expected to be run as an isis-script
% isis-script lag-freq-fits.sl fit plot
% where fit = fit data
%       plot = make a nice plot of the current best fit
%       fit n m = fit data but only run if index mod m = n (so fit 2 5 would fit every 3 of 5); this allows simple parallelisation

% Some global variables and paths (update to your own path)
% variable path_to_lags = "/mnt/storage/scratch/phajy/x-ray-reverberation";
% Assumes the lags are in a subdirectory of the current directory
variable path_to_lags = getcwd;

variable list_of_files = {};
variable list_of_lags = {};
variable array_of_files = String_Type[0];
variable files_to_compute = String_Type[0];

variable debug = 0; % non-zero to output more debugging information

% The new filename format is, e.g.,
% lag/i53/a0.998/h02.0+03.0/g2.5+2.5/A01.0/x2.0/p00.0/b02.0/q0.5/tmax1000/tshift0000/lag.fits

% Routine to look up the model
define lag_freq_fit(lo, hi, par)
{
	variable norm = par[0];
	variable mass = 10.0^par[1];

	variable i = par[2];
	variable a = par[3];
	variable h1 = par[4];
	variable h2 = par[5];
	variable g1 = par[6];
	variable g2 = par[7];
	variable abund = par[8];
	variable xi = par[9];
	variable p = par[10];
	variable b = par[11];
	variable q = par[12];
	variable tmax = par[13];
	variable tshift = par[14];

	% Now we need to generate the appropriate filename and see if it exists
	variable fp;
	variable filename = sprintf("lag-files/i%02.0f/a%05.3f/h%04.1f+%04.1f/g%03.1f+%03.1f/A%04.1f/x%03.1f/p%04.1f/b%04.1f/q%03.1f/tmax%04.0f/tshift%04.0f/lag.fits", i, a, h1, h2, g1, g2, abund, xi, p, b, q, tmax, tshift);
	if (debug>0) vmessage("Using filename %s", filename);

	variable t_g = 492.703806 * (mass / 1.0E8);

	% Read in the lag as a function of frequency
	% Note that units are tg^-1 (freq) and tg (lag)

	variable spec;
	variable ft;
	variable zero = 0;

	% see if we've already loaded in this file
	variable ix = where(array_of_files==filename);
	if (length(ix>0)) {
		% we have already seen this file
		% retrieve the saved values from memory
		if (debug>0) vmessage("Reading cached file %s (index %i)", filename, ix[0]);
		ft = list_of_lags[ix[0]];
		if (ft==NULL) {
			% null file means it didn't exist
			if (debug>0) vmessage("  ... but it doesn't exist");
			zero = 1;
		}
	} else {
		% we need to read in the file
		% check if file exists
		% vmessage("checking " + path_to_lags + "/" + filename);
		fp = fopen(path_to_lags + "/" + filename, "r");
	    if (fp == NULL)
	    {
	    	% file does not exist
	    	if (debug>0) vmessage("File %s does not exist", filename);

	    	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	    	% note that in some instances the parameter values should produce zero in which case we don't need to create any files
	    	% second source height has to be higher than first
	    	if (h2>h1) {
		    	% decide if we can create the necessary files
				variable cmd;
				% do we have the first code-x file we need?
				variable code_x_a = sprintf("code-x-files/i%02.0f/a%05.3f/h%04.1f/g%3.1f/A%03.1f/x%03.1f/p%04.1f/rev.fits", i, a, h1, g1, abund, xi, p);
				if (debug>0) vmessage("Looking for %s", code_x_a);
				fp = fopen(code_x_a, "r");
				if (fp==NULL) {
					% file doesn't exist
					% try to create file
					cmd = sprintf("./code-x -i%0.1f -a%5.3f -h%0.1f -g%0.1f -A%0.1f -x%0.1f -p%0.1f", i, a, h1, g1, abund, xi, p);
					vmessage("   ...command to execute is %s", cmd);
					% plot_pause;
					() = system(cmd);
					% vmessage("   ...done!");
				} else {
					% file does exist
					() = fclose(fp);
					% vmessage("   ...found");
				}
				% do we have the second code-x file we need?
				variable code_x_b = sprintf("code-x-files/i%02.0f/a%05.3f/h%04.1f/g%3.1f/A%03.1f/x%03.1f/p%04.1f/rev.fits", i, a, h2, g2, abund, xi, p);
				if (debug>0) vmessage("Looking for %s", code_x_b);
				fp = fopen(code_x_b, "r");
				if (fp==NULL) {
					% file doesn't exist
					% try to create file
					cmd = sprintf("./code-x -i%0.1f -a%5.3f -h%0.1f -g%0.1f -A%0.1f -x%0.1f -p%0.1f", i, a, h2, g2, abund, xi, p);
					vmessage("   ...command to execute is %s", cmd);
					% plot_pause;
					() = system(cmd);
					% vmessage("   ...done!");
				} else {
					% file does exist
					() = fclose(fp);
					% vmessage("   ...found");
				}

				% run two blobs script
				cmd = sprintf("./blob -o%0.1f -d%0.1f -i%0.1f -g%0.1f -e%0.1f -A%0.1f -x%0.1f -p%0.1f -y1.0 -l1.0 -b%0.1f -w%0.1f -v%0.0f -q%0.0f", h1, h2, i, g1, g2, abund, xi, p, b, q, tmax, tshift);
				if (debug>0) vmessage("Run two blobs model %s", cmd);
				% plot_pause;
				() = system(cmd);
				% message("   ...done!");

				ft = fits_read_table(path_to_lags + "/" + filename);
				list_append(list_of_files, filename, -1);
				list_append(list_of_lags, ft, -1);
				array_of_files = list_to_array(list_of_files);
			} else {
		    	% output should be zeros; model is invalid (h2<=h1)
		    	if (debug>0) vmessage("   ... should be null");
		    	zero = 1;
		    	% save file with NULL structure so we can skip quickly next time
		    	list_append(list_of_files, filename, -1);
				list_append(list_of_lags, NULL, -1);
				array_of_files = list_to_array(list_of_files);
			}
			%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	    } else {
	    	() = fclose(fp);

    		% vmessage("Reading file %s", filename);
			ft = fits_read_table(path_to_lags + "/" + filename);
			list_append(list_of_files, filename, -1);
			list_append(list_of_lags, ft, -1);
			array_of_files = list_to_array(list_of_files);
		}
	}

	if (zero==0) {
		% Shift all of the frequency bins
		variable fq = ft.fq / t_g;

		% Scale all time lags
		variable lag = ft.lag * t_g;

		% Overall normalizaton (which accounts for dilution, etc.)
		lag = lag * norm;

		% Frequency should now be in units of Hz
		% Lag should now be in units of seconds

		spec = rebin(lo, hi, _A(fq), _A(make_hi_grid(fq)), reverse(lag));
	} else {
		spec = Double_Type[length(lo)];
	}

	return(spec);
}

% New version will be:
add_slang_function("lag_freq", ["norm", "log_mass", "i", "a", "h1", "h2", "Gamma1", "Gamma2", "Fe", "xi", "p", "b", "q2", "t_max", "t_shift"]);

% Fit function to select dataset
define sds_fit(lo, hi, par)
{
	if (abs(Isis_Active_Dataset-par[0])<0.01) {
		return(1.0);
	} else {
		return(0.0);
	}
}
add_slang_function("sds", ["dataset"]);

% "Dummy" function that just returns zero but can be used so that other models can use this as a parameter
define dummy_fit(lo, hi, par)
{
	return(0.0);
}
add_slang_function("dummy", ["a"]);

% For example
% set_par_fun("lag_freq(1).t_shift", "(lag_freq(1).h2-lag_freq(1).h1)*492.6*(10^(lag_freq(1).log_mass-8.0))/dummy(1).a");
% allows us to use "dummy" as a "beta" parameter for propagation speed between h1 and h2

%rev_par_values = [
%	[2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0], 		# h1
%	[3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0],			# h2
%	[53.0],											# i
%	[2.5, 2.7, 2.9, 3.1],							# gamma1
%	[2.5, 2.7, 2.9, 3.1],							# gamma2
%	[1.0],											# A
%	[2.0, 2.5, 3.0],								# xi
%	[0.0],											# p
%	[1.0],											# r1
%	[1.0],											# r2
%	[1.0, 2.0, 3.0],								# b
%	[0.5],											# q2
%	[1000.0],										# tmax
%	[0.0]											# tshift
%	]
% initial values (gamma2 < gamma1), delta

% Load the data.
Ignore_PHA_Response_Keywords = 1;
variable d_a = load_data("~/1H0707-495-time-lag-fits/1H0707-495-time-lags-lo-flux.fits");
variable r_a = load_rmf("~/1H0707-495-time-lag-fits/1H0707-495-time-lags-lo-flux.rsp");
assign_rmf(r_a, d_a);

variable d_b = load_data("~/1H0707-495-time-lag-fits/1H0707-495-time-lags-hi-flux.fits");
variable r_b = load_rmf("~/1H0707-495-time-lag-fits/1H0707-495-time-lags-hi-flux.rsp");
assign_rmf(r_b, d_b);

Label_By_Default = 0;
popt.xlabel="Frequency (Hz)";
popt.ylabel="Time lag (s)";
xlog;
popt.yrange=[-100, 300];
popt.xrange=[1e-4, 0.01];

% load_par("new_tlag.par");
% load_par("v2_tlag.par");
load_par("joint_best_fit.par"); % <-- note that this is re-loaded before parameters are set for each fit
() = eval_counts;

popt.dcol=[2,4];
popt.mcol=[2,4];

if (length(where(__argv=="plot"))==1) {
	load_par("joint_best_fit.par");
	() = eval_counts;
	() = fit_counts;
	plot_data(1, popt);
	_pgsci(1);
	_pgsls(2);
	_pgmove(-4, 0);
	_pgdraw(-1, 0);
	list_par;
	plot_pause;
}

% Some routine to step through all possible combinations of parameters that we are interested in
variable n_pars = 17;
variable pars_to_fit = String_Type[n_pars];
variable vals_to_fit = Array_Type[n_pars];
variable index = Integer_Type[n_pars];
% Note I've changed the order before so that the code can run code-x for different source heights
% This makes the parallelisation more efficient
%
% Maybe we want to use a number of grids
% A "course" grid for a first fit to get in the right ball park
% then a "fine" grid around the best fit to get decent error bars
%
% Remember to adjust n_pars to match!
%
%
pars_to_fit[0] = "lag_freq(1).t_max";
vals_to_fit[0] = [200.0, 400.0, 600.0];
pars_to_fit[1] = "lag_freq(2).t_max";
vals_to_fit[1] = [200.0, 400.0, 600.0];
pars_to_fit[2] = "lag_freq(1).Gamma1";
vals_to_fit[2] = [1.8, 1.9, 2.0, 2.1, 2.2, 2.3];
pars_to_fit[3] = "lag_freq(1).Gamma2";
vals_to_fit[3] = [1.8, 1.9, 2.0, 2.1, 2.2, 2.3];
pars_to_fit[4] = "lag_freq(2).Gamma1";
vals_to_fit[4] = [1.8, 1.9, 2.0, 2.1, 2.2, 2.3];
pars_to_fit[5] = "lag_freq(2).Gamma2";
vals_to_fit[5] = [1.8, 1.9, 2.0, 2.1, 2.2, 2.3];
pars_to_fit[6] = "lag_freq(1).x";
vals_to_fit[6] = [0.0, 3.0];
pars_to_fit[7] = "lag_freq(2).x";
vals_to_fit[7] = [0.0, 3.0];
pars_to_fit[8] = "lag_freq(1).b";
vals_to_fit[8] = [1.0, 3.0];
pars_to_fit[9] = "lag_freq(2).b";
vals_to_fit[9] = [1.0, 3.0];
pars_to_fit[10] = "lag_freq(1).h1";
vals_to_fit[10] = [2.0, 4.0, 6.0, 8.0];
pars_to_fit[11] = "lag_freq(1).h2";
vals_to_fit[11] = [4.0, 6.0, 8.0, 10.0];
pars_to_fit[12] = "lag_freq(2).h1";
vals_to_fit[12] = [2.0, 4.0, 6.0, 8.0];
pars_to_fit[13] = "lag_freq(2).h2";
vals_to_fit[13] = [4.0, 6.0, 8.0, 10.0];
pars_to_fit[14] = "lag_freq(1).q2";
vals_to_fit[14] = [0.5];
pars_to_fit[15] = "lag_freq(1).Fe";
vals_to_fit[15] = [1.0];
pars_to_fit[16] = "lag_freq(1).log_mass";
vals_to_fit[16] = [6.0, 6.2];
%pars_to_fit[17] = "dummy(1).a"; % <-- "beta" for propagation speed
%vals_to_fit[17] = [0.1, 1.0];
% see if we should be fitting to the data
if (length(where(__argv=="fit"))==1) {
	variable m = 0; % which one to run
	variable n = 1; % out of (n-1)
	if (debug>0) {
		vmessage("__argc=%i", __argc);
		print(__argv);
		if (debug>1) plot_pause;
	}
	if (__argc==4)
	{
		() = sscanf(__argv[2], "%i", &m);
		() = sscanf(__argv[3], "%i", &n);
	}
	vmessage("Fitting %i of %i", m, n);
	if (debug>1) plot_pause;
	variable ix = 0;
	variable total = 0;
	variable i, s;
	variable best_s = 1.0E10;
	variable done = 0;
	do {
		if (ix==m) {
			if (debug>0) vmessage("New fit %i of %i (total %i)", ix, n, total);
			if (debug>1) plot_pause;
			% reset parameters so they are sensible
			load_par("joint_best_fit.par");
			% set parameter values
			for (i=0; i<length(pars_to_fit); i++) {
				if (debug>5) () = printf("Setting parameter %s to %e\n", pars_to_fit[i], vals_to_fit[i][index[i]]);
				set_par(sprintf("%s", pars_to_fit[i]), vals_to_fit[i][index[i]]);
			}
			% do fit
			() = fit_counts(&s);
			% see if we have a new best fit and if so plot it
			if (s.statistic < best_s) {
				% plot_data(1, popt);
				best_s = s.statistic;
				save_par(sprintf("joint_best_fit_%02i.par", m));
				list_par;
				vmessage("Best fit with statistic = %e", best_s);
				variable fp = fopen(sprintf("joint_best_fit_%02i.txt",m),"w");
				() = fprintf(fp, "%e", s.statistic);
				() = fclose(fp);
				variable pid = open_plot(sprintf("joint_best_fit_%02i.ps/cps",m));
				title(sprintf("Statistic = %e", s.statistic));
				plot_data({1,2}, popt);
				_pgsci(1);
				_pgsls(2);
				_pgmove(-4, 0);
				_pgdraw(-1, 0);
				close_plot(pid);
				% plot_pause;
			}
		}
		ix = ix + 1;
		if (ix >= n) {
			ix = 0;
		}
		total = total + 1;
		% move on to next parameter combination
		done = 1;
		for (i=0; i<length(pars_to_fit); i++) {
			% vmessage("i = %i", i);
			if (done == 1)
			{
				% vmessage("i = %i index = %i len = %i", i, index[i], length(vals_to_fit[i]));
				index[i] = index[i] + 1;
				% vmessage("i = %i index = %i len = %i", i, index[i], length(vals_to_fit[i]));
				if (index[i] == length(vals_to_fit[i]))
				{
					index[i] = 0;
				} else {
					done = 0;
				}
			}
		}
		% vmessage("Done");
	} while (done==0);
}
#+END_EXAMPLE

New  Joint Fit Script =1H0707-495-joint-fit2.sl=

#+BEGIN_EXAMPLE
% Two blobs model fitting routines
%
% Author: Andy Young
% Date: 2019-01 -- 2019-11
%
% 2019-11: updated to allow joint fits
% 2019-03 2019-04: updated so ISIS can ask for files to be generated when needed
% This is expected to be run as an isis-script
% isis-script lag-freq-fits.sl fit plot
% where fit = fit data
%       plot = make a nice plot of the current best fit
%       fit n m = fit data but only run if index mod m = n (so fit 2 5 would fit every 3 of 5); this allows simple parallelisation

% Some global variables and paths (update to your own path)
% variable path_to_lags = "/mnt/storage/scratch/phajy/x-ray-reverberation";
% Assumes the lags are in a subdirectory of the current directory
variable path_to_lags = getcwd;

variable list_of_files = {};
variable list_of_lags = {};
variable array_of_files = String_Type[0];
variable files_to_compute = String_Type[0];

variable debug = 0; % non-zero to output more debugging information

% The new filename format is, e.g.,
% lag/i53/a0.998/h02.0+03.0/g2.5+2.5/A01.0/x2.0/p00.0/b02.0/q0.5/tmax1000/tshift0000/lag.fits

% Routine to look up the model
define lag_freq_fit(lo, hi, par)
{
	variable norm = par[0];
	variable mass = 10.0^par[1];

	variable i = par[2];
	variable a = par[3];
	variable h1 = par[4];
	variable h2 = par[5];
	variable g1 = par[6];
	variable g2 = par[7];
	variable abund = par[8];
	variable xi = par[9];
	variable p = par[10];
	variable b = par[11];
	variable q = par[12];
	variable tmax = par[13];
	variable tshift = par[14];

	% Now we need to generate the appropriate filename and see if it exists
	variable fp;
	variable filename = sprintf("lag-files/i%02.0f/a%05.3f/h%04.1f+%04.1f/g%03.1f+%03.1f/A%04.1f/x%03.1f/p%04.1f/b%04.1f/q%03.1f/tmax%04.0f/tshift%04.0f/lag.fits", i, a, h1, h2, g1, g2, abund, xi, p, b, q, tmax, tshift);
	if (debug>0) vmessage("Using filename %s", filename);

	variable t_g = 492.703806 * (mass / 1.0E8);

	% Read in the lag as a function of frequency
	% Note that units are tg^-1 (freq) and tg (lag)

	variable spec;
	variable ft;
	variable zero = 0;

	% see if we've already loaded in this file
	variable ix = where(array_of_files==filename);
	if (length(ix>0)) {
		% we have already seen this file
		% retrieve the saved values from memory
		if (debug>0) vmessage("Reading cached file %s (index %i)", filename, ix[0]);
		ft = list_of_lags[ix[0]];
		if (ft==NULL) {
			% null file means it didn't exist
			if (debug>0) vmessage("  ... but it doesn't exist");
			zero = 1;
		}
	} else {
		% we need to read in the file
		% check if file exists
		% vmessage("checking " + path_to_lags + "/" + filename);
		fp = fopen(path_to_lags + "/" + filename, "r");
	    if (fp == NULL)
	    {
	    	% file does not exist
	    	if (debug>0) vmessage("File %s does not exist", filename);

	    	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	    	% note that in some instances the parameter values should produce zero in which case we don't need to create any files
	    	% second source height has to be higher than first
	    	if (h2>h1) {
		    	% decide if we can create the necessary files
				variable cmd;
				% do we have the first code-x file we need?
				variable code_x_a = sprintf("code-x-files/i%02.0f/a%05.3f/h%04.1f/g%3.1f/A%03.1f/x%03.1f/p%04.1f/rev.fits", i, a, h1, g1, abund, xi, p);
				if (debug>0) vmessage("Looking for %s", code_x_a);
				fp = fopen(code_x_a, "r");
				if (fp==NULL) {
					% file doesn't exist
					% try to create file
					cmd = sprintf("./code-x -i%0.1f -a%5.3f -h%0.1f -g%0.1f -A%0.1f -x%0.1f -p%0.1f", i, a, h1, g1, abund, xi, p);
					vmessage("   ...command to execute is %s", cmd);
					% plot_pause;
					() = system(cmd);
					% vmessage("   ...done!");
				} else {
					% file does exist
					() = fclose(fp);
					% vmessage("   ...found");
				}
				% do we have the second code-x file we need?
				variable code_x_b = sprintf("code-x-files/i%02.0f/a%05.3f/h%04.1f/g%3.1f/A%03.1f/x%03.1f/p%04.1f/rev.fits", i, a, h2, g2, abund, xi, p);
				if (debug>0) vmessage("Looking for %s", code_x_b);
				fp = fopen(code_x_b, "r");
				if (fp==NULL) {
					% file doesn't exist
					% try to create file
					cmd = sprintf("./code-x -i%0.1f -a%5.3f -h%0.1f -g%0.1f -A%0.1f -x%0.1f -p%0.1f", i, a, h2, g2, abund, xi, p);
					vmessage("   ...command to execute is %s", cmd);
					% plot_pause;
					() = system(cmd);
					% vmessage("   ...done!");
				} else {
					% file does exist
					() = fclose(fp);
					% vmessage("   ...found");
				}

				% run two blobs script
				cmd = sprintf("./blob -o%0.1f -d%0.1f -i%0.1f -g%0.1f -e%0.1f -A%0.1f -x%0.1f -p%0.1f -y1.0 -l1.0 -b%0.1f -w%0.1f -v%0.0f -q%0.0f", h1, h2, i, g1, g2, abund, xi, p, b, q, tmax, tshift);
				if (debug>0) vmessage("Run two blobs model %s", cmd);
				% plot_pause;
				() = system(cmd);
				% message("   ...done!");

				ft = fits_read_table(path_to_lags + "/" + filename);
				list_append(list_of_files, filename, -1);
				list_append(list_of_lags, ft, -1);
				array_of_files = list_to_array(list_of_files);
			} else {
		    	% output should be zeros; model is invalid (h2<=h1)
		    	if (debug>0) vmessage("   ... should be null");
		    	zero = 1;
		    	% save file with NULL structure so we can skip quickly next time
		    	list_append(list_of_files, filename, -1);
				list_append(list_of_lags, NULL, -1);
				array_of_files = list_to_array(list_of_files);
			}
			%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	    } else {
	    	() = fclose(fp);

    		% vmessage("Reading file %s", filename);
			ft = fits_read_table(path_to_lags + "/" + filename);
			list_append(list_of_files, filename, -1);
			list_append(list_of_lags, ft, -1);
			array_of_files = list_to_array(list_of_files);
		}
	}

	if (zero==0) {
		% Shift all of the frequency bins
		variable fq = ft.fq / t_g;

		% Scale all time lags
		variable lag = ft.lag * t_g;

		% Overall normalizaton (which accounts for dilution, etc.)
		lag = lag * norm;

		% Frequency should now be in units of Hz
		% Lag should now be in units of seconds

		spec = rebin(lo, hi, _A(fq), _A(make_hi_grid(fq)), reverse(lag));
	} else {
		spec = Double_Type[length(lo)];
	}

	return(spec);
}

% New version will be:
add_slang_function("lag_freq", ["norm", "log_mass", "i", "a", "h1", "h2", "Gamma1", "Gamma2", "Fe", "xi", "p", "b", "q2", "t_max", "t_shift"]);

% Fit function to select dataset
define sds_fit(lo, hi, par)
{
	if (abs(Isis_Active_Dataset-par[0])<0.01) {
		return(1.0);
	} else {
		return(0.0);
	}
}
add_slang_function("sds", ["dataset"]);

% "Dummy" function that just returns zero but can be used so that other models can use this as a parameter
define dummy_fit(lo, hi, par)
{
	return(0.0);
}
add_slang_function("dummy", ["a"]);

% For example
% set_par_fun("lag_freq(1).t_shift", "(lag_freq(1).h2-lag_freq(1).h1)*492.6*(10^(lag_freq(1).log_mass-8.0))/dummy(1).a");
% allows us to use "dummy" as a "beta" parameter for propagation speed between h1 and h2

%rev_par_values = [
%	[2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0], 		# h1
%	[3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0],			# h2
%	[53.0],											# i
%	[2.5, 2.7, 2.9, 3.1],							# gamma1
%	[2.5, 2.7, 2.9, 3.1],							# gamma2
%	[1.0],											# A
%	[2.0, 2.5, 3.0],								# xi
%	[0.0],											# p
%	[1.0],											# r1
%	[1.0],											# r2
%	[1.0, 2.0, 3.0],								# b
%	[0.5],											# q2
%	[1000.0],										# tmax
%	[0.0]											# tshift
%	]
% initial values (gamma2 < gamma1), delta

% Load the data.
Ignore_PHA_Response_Keywords = 1;
variable d_a = load_data("1H0707-495-time-lag-fits/1H0707-495-time-lags-lo-flux.fits");
variable r_a = load_rmf("1H0707-495-time-lag-fits/1H0707-495-time-lags-lo-flux.rsp");
assign_rmf(r_a, d_a);

variable d_b = load_data("1H0707-495-time-lag-fits/1H0707-495-time-lags-hi-flux.fits");
variable r_b = load_rmf("1H0707-495-time-lag-fits/1H0707-495-time-lags-hi-flux.rsp");
assign_rmf(r_b, d_b);

Label_By_Default = 0;
popt.xlabel="Frequency (Hz)";
popt.ylabel="Time lag (s)";
xlog;
popt.yrange=[-200, 400];
popt.xrange=[1e-4, 0.01];

% load_par("new_tlag.par");
% load_par("v2_tlag.par");
load_par("best_fit.par"); % <-- note that this is re-loaded before parameters are set for each fit
() = eval_counts;

popt.dcol=[2,4];
popt.mcol=[2,4];

if (length(where(__argv=="plot"))==1) {
	load_par("best_fit.par");
	() = eval_counts;
	() = fit_counts;
	plot_data({1,2}, popt);
	_pgsci(1);
	_pgsls(2);
	_pgmove(-4, 0);
	_pgdraw(-1, 0);
	list_par;
	plot_pause;
}

% Some routine to step through all possible combinations of parameters that we are interested in
variable n_pars = 17;
variable pars_to_fit = String_Type[n_pars];
variable vals_to_fit = Array_Type[n_pars];
variable index = Integer_Type[n_pars];
% Note I've changed the order before so that the code can run code-x for different source heights
% This makes the parallelisation more efficient
%
% Maybe we want to use a number of grids
% A "course" grid for a first fit to get in the right ball park
% then a "fine" grid around the best fit to get decent error bars
%
% Remember to adjust n_pars to match!
%
%
pars_to_fit[0] = "lag_freq(1).t_max";
vals_to_fit[0] = [200.0, 400.0, 600.0, 700.0];
pars_to_fit[1] = "lag_freq(2).t_max";
vals_to_fit[1] = [200.0, 400.0, 600.0, 700.0];
pars_to_fit[2] = "lag_freq(1).Gamma1";
vals_to_fit[2] = [1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.5];
pars_to_fit[3] = "lag_freq(1).Gamma2";
vals_to_fit[3] = [1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.5];
pars_to_fit[4] = "lag_freq(2).Gamma1";
vals_to_fit[4] = [1.6, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.5];
pars_to_fit[5] = "lag_freq(2).Gamma2";
vals_to_fit[5] = [1.6, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.5];
pars_to_fit[6] = "lag_freq(1).x";
vals_to_fit[6] = [0.0, 3.0];
pars_to_fit[7] = "lag_freq(2).x";
vals_to_fit[7] = [0.0, 3.0];
pars_to_fit[8] = "lag_freq(1).b";
vals_to_fit[8] = [1.0, 3.0];
pars_to_fit[9] = "lag_freq(2).b";
vals_to_fit[9] = [1.0, 3.0];
pars_to_fit[10] = "lag_freq(1).h1";
vals_to_fit[10] = [2.0, 4.0, 6.0, 8.0];
pars_to_fit[11] = "lag_freq(1).h2";
vals_to_fit[11] = [4.0, 6.0, 8.0, 10.0];
pars_to_fit[12] = "lag_freq(2).h1";
vals_to_fit[12] = [2.0, 4.0, 6.0, 8.0];
pars_to_fit[13] = "lag_freq(2).h2";
vals_to_fit[13] = [4.0, 6.0, 8.0, 10.0];
pars_to_fit[14] = "lag_freq(1).q2";
vals_to_fit[14] = [0.5];
pars_to_fit[15] = "lag_freq(1).Fe";
vals_to_fit[15] = [1.0];
pars_to_fit[16] = "lag_freq(1).log_mass";
vals_to_fit[16] = [6.0, 6.2];
%pars_to_fit[17] = "dummy(1).a"; % <-- "beta" for propagation speed
%vals_to_fit[17] = [0.1, 1.0];
% see if we should be fitting to the data
if (length(where(__argv=="fit"))==1) {
	variable m = 0; % which one to run
	variable n = 1; % out of (n-1)
	if (debug>0) {
		vmessage("__argc=%i", __argc);
		print(__argv);
		if (debug>1) plot_pause;
	}
	if (__argc==4)
	{
		() = sscanf(__argv[2], "%i", &m);
		() = sscanf(__argv[3], "%i", &n);
	}
	vmessage("Fitting %i of %i", m, n);
	if (debug>1) plot_pause;
	variable ix = 0;
	variable total = 0;
	variable i, s;
	variable best_s = 1.0E10;
	variable done = 0;
	do {
		if (ix==m) {
			if (debug>0) vmessage("New fit %i of %i (total %i)", ix, n, total);
			if (debug>1) plot_pause;
			% reset parameters so they are sensible
			load_par("best_fit.par");
			% set parameter values
			for (i=0; i<length(pars_to_fit); i++) {
				if (debug>5) () = printf("Setting parameter %s to %e\n", pars_to_fit[i], vals_to_fit[i][index[i]]);
			set_par(sprintf("%s", pars_to_fit[i]), vals_to_fit[i][index[i]]);
			}
			% do fit
			() = fit_counts(&s);
			% see if we have a new best fit and if so plot it
			if (s.statistic < best_s) {
				% plot_data(1, popt);
				best_s = s.statistic;
				save_par(sprintf("best_fit_%02i.par", m));
				list_par;
				vmessage("Best fit with statistic = %e", best_s);
				variable fp = fopen(sprintf("best_fit_%02i.txt",m),"w");
				() = fprintf(fp, "%e", s.statistic);
				() = fclose(fp);
				variable pid = open_plot(sprintf("best_fit_%02i.ps/cps",m));
				title(sprintf("Statistic = %e", s.statistic));
				plot_data({1,2}, popt);
				_pgsci(1);
				_pgsls(2);
				_pgmove(-4, 0);
				_pgdraw(-1, 0);
				close_plot(pid);
				% plot_pause;
			}
		}
		ix = ix + 1;
		if (ix >= n) {
			ix = 0;
		}
		total = total + 1;
		% move on to next parameter combination
		done = 1;
		for (i=0; i<length(pars_to_fit); i++) {
			% vmessage("i = %i", i);
			if (done == 1)
			{
				% vmessage("i = %i index = %i len = %i", i, index[i], length(vals_to_fit[i]));
				index[i] = index[i] + 1;
				% vmessage("i = %i index = %i len = %i", i, index[i], length(vals_to_fit[i]));
				if (index[i] == length(vals_to_fit[i]))
				{
					index[i] = 0;
				} else {
					done = 0;
				}
			}
		}
		% vmessage("Done");
	} while (done==0);
}
#+END_EXAMPLE

** Joint fit par file
#+BEGIN_EXAMPLE
sds(1)*lag_freq(1) + sds(2)*lag_freq(2)
 idx  param             tie-to  freeze         value         min         max
  1  sds(1).dataset         0     1                1           0           0
  2  lag_freq(1).norm       0     0     3.855776e-05           0           1
  3  lag_freq(1).log_mass   0     1                6           5           8
  4  lag_freq(1).i          0     1               53           0           0
  5  lag_freq(1).a          0     1            0.998           0           0
  6  lag_freq(1).h1         0     1                2           0           0
  7  lag_freq(1).h2         0     1                4           0           0
  8  lag_freq(1).Gamma1     0     1              2.3           0           0
  9  lag_freq(1).Gamma2     0     1              1.8           0           0
 10  lag_freq(1).Fe         0     1                1           0           0
 11  lag_freq(1).xi         0     1                0           0           0
 12  lag_freq(1).p          0     1                0           0           0
 13  lag_freq(1).b          0     1                1           0           0
 14  lag_freq(1).q2         0     1              0.5           0           0
 15  lag_freq(1).t_max      0     1              400           0           0
 16  lag_freq(1).t_shift    0     1                0           0           0
 17  sds(2).dataset         0     1                2           0           0
 18  lag_freq(2).norm       0     0     3.855776e-05           0           1
 19  lag_freq(2).log_mass   3     0                6           5           8
 20  lag_freq(2).i          4     0               53           0           0
 21  lag_freq(2).a          5     0            0.998           0           0
 22  lag_freq(2).h1         0     1                2           0           0
 23  lag_freq(2).h2         0     1                4           0           0
 24  lag_freq(2).Gamma1     0     1              2.3           0           0
 25  lag_freq(2).Gamma2     0     1              1.8           0           0
 26  lag_freq(2).Fe        10     0                1           0           0
 27  lag_freq(2).xi         0     1                0           0           0
 28  lag_freq(2).p         12     0                0           0           0
 29  lag_freq(2).b         13     1                1           0           0
 30  lag_freq(2).q2        14     0              0.5           0           0
 31  lag_freq(2).t_max      0     1              400           0           0
 32  lag_freq(2).t_shift    0     1                0           0           0
#+END_EXAMPLE

** Replot just the BEST JOINT fits

For 1H0707-495:

=replot_1H0707_best_joint_flux.sl=

#+BEGIN_EXAMPLE
% Two blobs model fitting routines
%
% Author: Andy Young
% Date: 2019-01 -- 2019-04
%
% 2019-03 2019-04: updated so ISIS can ask for files to be generated when needed
% This is expected to be run as an isis-script
% isis-script lag-freq-fits.sl fit plot
% where fit = fit data
%       plot = make a nice plot of the current best fit
%       fit n m = fit data but only run if index mod m = n (so fit 2 5 would fit every 3 of 5); this allows simple parallelisation

% Some global variables and paths (update to your own path)
% variable path_to_lags = "/mnt/storage/scratch/phajy/x-ray-reverberation";
% Assumes the lags are in a subdirectory of the current directory
variable path_to_lags = getcwd;

variable list_of_files = {};
variable list_of_lags = {};
variable array_of_files = String_Type[0];

variable debug = 0; % non-zero to output more debugging information

% The new filename format is, e.g.,
% lag/i53/a0.998/h02.0+03.0/g2.5+2.5/A01.0/x2.0/p00.0/b02.0/q0.5/tmax1000/tshift0000/lag.fits

% Routine to look up the model
define lag_freq_fit(lo, hi, par)
{
	variable norm = par[0];
	variable mass = 10.0^par[1];

	variable i = par[2];
	variable a = par[3];
	variable h1 = par[4];
	variable h2 = par[5];
	variable g1 = par[6];
	variable g2 = par[7];
	variable abund = par[8];
	variable xi = par[9];
	variable p = par[10];
	variable b = par[11];
	variable q = par[12];
	variable tmax = par[13];
	variable tshift = par[14];

	% Now we need to generate the appropriate filename and see if it exists
	variable fp;
	variable filename = sprintf("lag-files/i%02.0f/a%05.3f/h%04.1f+%04.1f/g%03.1f+%03.1f/A%04.1f/x%03.1f/p%04.1f/b%04.1f/q%03.1f/tmax%04.0f/tshift%04.0f/lag.fits", i, a, h1, h2, g1, g2, abund, xi, p, b, q, tmax, tshift);
	if (debug>0) vmessage("Using filename %s", filename);

	variable t_g = 492.703806 * (mass / 1.0E8);

	% Read in the lag as a function of frequency
	% Note that units are tg^-1 (freq) and tg (lag)

	variable spec;
	variable ft;
	variable zero = 0;

	% see if we've already loaded in this file
	variable ix = where(array_of_files==filename);
	if (length(ix>0)) {
		% we have already seen this file
		% retrieve the saved values from memory
		if (debug>0) vmessage("Reading cached file %s (index %i)", filename, ix[0]);
		ft = list_of_lags[ix[0]];
		if (ft==NULL) {
			% null file means it didn't exist
			if (debug>0) vmessage("  ... but it doesn't exist");
			zero = 1;
		}
	} else {
		% we need to read in the file
		% check if file exists
		% vmessage("checking " + path_to_lags + "/" + filename);
		fp = fopen(path_to_lags + "/" + filename, "r");
	    if (fp == NULL)
	    {
	    	% file does not exist
	    	vmessage("File %s does not exist", filename);

	    	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	    	% note that in some instances the parameter values should produce zero in which case we don't need to create any files
	    	% second source height has to be higher than first
	    	if (h2>h1) {
		    	% decide if we can create the necessary files
				variable cmd;
				% do we have the first code-x file we need?
				variable code_x_a = sprintf("code-x-files/i%02.0f/a%05.3f/h%04.1f/g%3.1f/A%03.1f/x%03.1f/p%04.1f/rev.fits", i, a, h1, g1, abund, xi, p);
				if (debug>0) vmessage("Looking for %s", code_x_a);
				fp = fopen(code_x_a, "r");
				if (fp==NULL) {
					% file doesn't exist
					% try to create file
					cmd = sprintf("./code-x -i%0.1f -a%5.3f -h%0.1f -g%0.1f -A%0.1f -x%0.1f -p%0.1f", i, a, h1, g1, abund, xi, p);
					vmessage("   ...command to execute is %s", cmd);
					% plot_pause;
					() = system(cmd);
					% vmessage("   ...done!");
				} else {
					% file does exist
					() = fclose(fp);
					% vmessage("   ...found");
				}
				% do we have the second code-x file we need?
				variable code_x_b = sprintf("code-x-files/i%02.0f/a%05.3f/h%04.1f/g%3.1f/A%03.1f/x%03.1f/p%04.1f/rev.fits", i, a, h2, g2, abund, xi, p);
				if (debug>0) vmessage("Looking for %s", code_x_b);
				fp = fopen(code_x_b, "r");
				if (fp==NULL) {
					% file doesn't exist
					% try to create file
					cmd = sprintf("./code-x -i%0.1f -a%5.3f -h%0.1f -g%0.1f -A%0.1f -x%0.1f -p%0.1f", i, a, h2, g2, abund, xi, p);
					vmessage("   ...command to execute is %s", cmd);
					% plot_pause;
					() = system(cmd);
					% vmessage("   ...done!");
				} else {
					% file does exist
					() = fclose(fp);
					% vmessage("   ...found");
				}

				% run two blobs script
				cmd = sprintf("./blob -o%0.1f -d%0.1f -i%0.1f -g%0.1f -e%0.1f -A%0.1f -x%0.1f -p%0.1f -y1.0 -l1.0 -b%0.1f -w%0.1f -v%0.0f -q%0.0f", h1, h2, i, g1, g2, abund, xi, p, b, q, tmax, tshift);
				if (debug>0) vmessage("Run two blobs model %s", cmd);
				% plot_pause;
				() = system(cmd);
				% message("   ...done!");

				ft = fits_read_table(path_to_lags + "/" + filename);
				list_append(list_of_files, filename, -1);
				list_append(list_of_lags, ft, -1);
				array_of_files = list_to_array(list_of_files);
			} else {
		    	% output should be zeros; model is invalid (h2<=h1)
		    	vmessage("   ... should be null");
		    	zero = 1;
		    	% save file with NULL structure so we can skip quickly next time
		    	list_append(list_of_files, filename, -1);
				list_append(list_of_lags, NULL, -1);
				array_of_files = list_to_array(list_of_files);
			}
			%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	    } else {
	    	() = fclose(fp);

    		% vmessage("Reading file %s", filename);
			ft = fits_read_table(path_to_lags + "/" + filename);
			list_append(list_of_files, filename, -1);
			list_append(list_of_lags, ft, -1);
			array_of_files = list_to_array(list_of_files);
		}
	}

	if (zero==0) {
		% Shift all of the frequency bins
		variable fq = ft.fq / t_g;

		% Scale all time lags
		variable lag = ft.lag * t_g;

		% Overall normalizaton (which accounts for dilution, etc.)
		lag = lag * norm;

		% Frequency should now be in units of Hz
		% Lag should now be in units of seconds

		spec = rebin(lo, hi, _A(fq), _A(make_hi_grid(fq)), reverse(lag));
	} else {
		spec = Double_Type[length(lo)];
	}

	return(spec);
}

% New version will be:
add_slang_function("lag_freq", ["norm", "log_mass", "i", "a", "h1", "h2", "Gamma1", "Gamma2", "Fe", "xi", "p", "b", "q2", "t_max", "t_shift"]);

% Fit function to select dataset
define sds_fit(lo, hi, par)
{
	if (abs(Isis_Active_Dataset-par[0])<0.01) {
		return(1.0);
	} else {
		return(0.0);
	}
}
add_slang_function("sds", ["dataset"]);

% Load the data.
Ignore_PHA_Response_Keywords = 1;
variable d_a = load_data("1H0707-495-time-lag-fits/1H0707-495-time-lags-lo-flux.fits");
variable r_a = load_rmf("1H0707-495-time-lag-fits/1H0707-495-time-lags-lo-flux.rsp");
assign_rmf(r_a, d_a);

variable d_b = load_data("1H0707-495-time-lag-fits/1H0707-495-time-lags-hi-flux.fits");
variable r_b = load_rmf("1H0707-495-time-lag-fits/1H0707-495-time-lags-hi-flux.rsp");
assign_rmf(r_b, d_b);

popt.dsym=[16,16];
popt.dcol=[4,2];
popt.mcol=[4,2];

%load_par("1H0707_best_fit_lo_flux.par");
%load_par("1H0707_best_fit_hi_flux.par");
load_par("1H0707_best_joint_fit.par");
%set_par(2,6.31,1); % FIXED MASS OPTION
Label_By_Default = 0;
popt.xlabel="Frequency (Hz)";
popt.ylabel="Time lag (s)";
xlog;
popt.yrange=[-200, 400];
popt.xrange=[1e-4, 7e-3];
%() = fit_counts;
() = eval_counts;
plot_data({1,2}, popt);
_pgsci(1);
_pgsls(2);
_pgmove(-10000, 0);
_pgdraw(1, 0);
list_par;
list_data;


variable pid = open_plot("1H0707-495-joint-fit-ecm.png/png");
charsize(1.3); %good font size
nice_width; %good line ratios
_pgscf(2); %make font roman
plot_data({1,2},popt);
_pgmove(-10000,0);
_pgsls(2);
_pgslw(1);
_pgsci(1); % make line colour black
_pgdraw(1,0);
close_plot(pid);
#+END_EXAMPLE

Par file for above fit:

=1H0707_best_joint_fit.par=

#+BEGIN_EXAMPLE
sds(1)*lag_freq(1) + sds(2)*lag_freq(2)
 idx  param             tie-to  freeze         value         min         max
  1  sds(1).dataset         0     1                1           0           0
  2  lag_freq(1).norm       0     0     0.0001237919           0           1
  3  lag_freq(1).log_mass   0     1             6.24           5           8
  4  lag_freq(1).i          0     1               53           0           0
  5  lag_freq(1).a          0     1            0.998           0           0
  6  lag_freq(1).h1         0     1                2           0           0
  7  lag_freq(1).h2         0     1                3           0           0
  8  lag_freq(1).Gamma1     0     1              2.7           0           0
  9  lag_freq(1).Gamma2     0     1              2.3           0           0
 10  lag_freq(1).Fe         0     1                1           0           0
 11  lag_freq(1).xi         0     1                0           0           0
 12  lag_freq(1).p          0     1                0           0           0
 13  lag_freq(1).b          0     1                1           0           0
 14  lag_freq(1).q2         0     1              0.5           0           0
 15  lag_freq(1).t_max      0     1              200           0           0
 16  lag_freq(1).t_shift    0     1               10           0           0
 17  sds(2).dataset         0     1                2           0           0
 18  lag_freq(2).norm       0     0     4.435209e-05           0           1
 19  lag_freq(2).log_mass   0     1             6.05           5           8
 20  lag_freq(2).i          4     0               53           0           0
 21  lag_freq(2).a          5     0            0.998           0           0
 22  lag_freq(2).h1         0     1                2           0           0
 23  lag_freq(2).h2         0     1                3           0           0
 24  lag_freq(2).Gamma1     0     1              2.7           0           0
 25  lag_freq(2).Gamma2     0     1              2.6           0           0
 26  lag_freq(2).Fe        10     0                1           0           0
 27  lag_freq(2).xi         0     1                3           0           0
 28  lag_freq(2).p         12     0                0           0           0
 29  lag_freq(2).b          0     1                2           0           0
 30  lag_freq(2).q2        14     0              0.5           0           0
 31  lag_freq(2).t_max      0     1              550           0           0
 32  lag_freq(2).t_shift    0     1               85           0           0
#+END_EXAMPLE

** fit-and-error.sl

#+BEGIN_EXAMPLE
% Two blobs model fitting routines
% also includes calculation of error bars
%
% Author: Andy Young
% Date: 2020-06
%
%
% Some parameters / options

% Should we run the fit? Non-zero => run fit
variable run_fit = 1;

% Filename prefix for observation identifier
variable obsid = "1H0707_combined";

% Some global variables and paths (update to your own path)
% variable path_to_lags = "/mnt/storage/scratch/phajy/x-ray-reverberation";
% Assumes the lags are in a subdirectory of the current directory
variable path_to_lags = getcwd;

% Debugging - non-zero to output more information
% higher value means more diagnostic information
variable debug = 0;

% Only need to cache the last file read in because the script steps through
% discrete parameter values. The number of parameter combinations has between
% reduced to make this problem tractable. This vastly simplifies the code from
% previous versions and reduces the memory requirements significantly.

variable last_file_used = "";
variable last_lag_used = NULL;

% Lag-frequency fitting function
define lag_freq_fit(lo, hi, par)
{
	variable norm = par[0];
	variable mass = 10.0^par[1];

	variable i = par[2];
	variable a = par[3];
	variable h1 = par[4];
	variable h2 = par[5];
	variable g1 = par[6];
	variable g2 = par[7];
	variable abund = par[8];
	variable xi = par[9];
	variable p = par[10];
	variable b = par[11];
	variable q = par[12];
	variable tmax = par[13];
	variable tshift = par[14];

	% Now we need to generate the appropriate filename and see if it exists
	variable fp;
	variable filename = sprintf("lag-files/i%02.0f/a%05.3f/h%04.1f+%04.1f/g%03.1f+%03.1f/A%04.1f/x%03.1f/p%04.1f/b%04.1f/q%03.1f/tmax%04.0f/tshift%04.0f/lag.fits", i, a, h1, h2, g1, g2, abund, xi, p, b, q, tmax, tshift);
	if (debug>5) vmessage("Using filename %s", filename);

	variable t_g = 492.703806 * (mass / 1.0E8);

	% Read in the lag as a function of frequency
	% Note that units are tg^-1 (freq) and tg (lag)

	variable spec;
	variable ft;
	variable zero = 0;

	% see if we've already loaded in this file
	if (last_file_used == filename) {
		% we have already seen this file
		% retrieve the saved values from memory
		if (debug>5) vmessage("Using cached lag");
		ft = @last_lag_used;
	} else {
		% we need to read in the file
		% check if file exists
		if (debug>1) vmessage("checking " + path_to_lags + "/" + filename);
		fp = fopen(path_to_lags + "/" + filename, "r");
	  if (fp == NULL)
	  {
	  	% file does not exist
	    if (debug>0) vmessage("File %s does not exist so returning zero", filename);
			last_file_used = "";
			last_lag_used = NULL;
	   } else {
	   	() = fclose(fp);

    	if (debug > 0) vmessage("Reading file %s", filename);
			ft = fits_read_table(path_to_lags + "/" + filename);
			last_file_used = filename;
			last_lag_used = @ft;

			% Check for NaN which indicates a problem
			variable cn = where(isnan(ft.lag) == 1);
			if (length(cn)>0) {
				vmessage("File %s has NaN in it (%i).", filename, length(cn));
				plot_pause;
			} else {
				if (debug > 5) vmessage("Files %s is good.", filename);
			}
		}
	}

	if (last_file_used != "") {
		% Shift all of the frequency bins
		variable fq = ft.fq / t_g;

		% Scale all time lags
		variable lag = ft.lag * t_g;

		% Overall normalizaton (which accounts for dilution, etc.)
		lag = lag * norm;

		% Frequency should now be in units of Hz
		% Lag should now be in units of seconds

		spec = rebin(lo, hi, _A(fq), _A(make_hi_grid(fq)), reverse(lag));

		% Check for NaN which indicates a problem
		cn = where(isnan(spec)==1);
		if (length(cn)>0) {
			vmessage("Spectrum from file %s has NaN in it.", filename);
			plot_pause;
		}

	} else {
		spec = Double_Type[length(lo)];
	}

	return(spec);
}

% New version will be:
add_slang_function("lag_freq", ["norm", "log_mass", "i", "a", "h1", "h2", "Gamma1", "Gamma2", "Fe", "xi", "p", "b", "q2", "t_max", "t_shift"]);

% "Dummy" function that just returns zero
% Other models can use this as a parameter
define dummy_fit(lo, hi, par)
{
	return(0.0);
}
add_slang_function("dummy", ["a"]);

% For example
% set_par_fun("lag_freq(1).t_shift", "(lag_freq(1).h2-lag_freq(1).h1)*492.6*(10^(lag_freq(1).log_mass-8.0))/dummy(1).a");
% allows us to use "dummy" as a "beta" parameter for propagation speed between h1 and h2

% Load the data.
Ignore_PHA_Response_Keywords = 1;
variable d = load_data("1H0707-495-time-lag-fits/1H0707-495-combined-time-lags.fits");
variable r = load_rmf("1H0707-495-time-lag-fits/1H0707-495-combined-time-lags.rsp");
assign_rmf(r, d);

Label_By_Default = 0;
popt.xlabel="Frequency (Hz)";
popt.ylabel="Time lag (s)";
xlog;
popt.yrange=[-100, 300];
popt.xrange=[1e-4, 0.01];

% Step through all possible combinations of parameters
% Based on GX 339-4 fitting script

% Step through all possible combinations of parameters that we are interested in
variable pars_to_fit = ["h1", "h2", "Gamma1", "Gamma2", "Fe", "xi", "p", "b", "q2", "t_max", "t_shift"];
variable n_pars = length(pars_to_fit);
variable vals_to_fit = Array_Type[n_pars];
variable fit_statistics = Array_Type[n_pars];
variable index = Integer_Type[n_pars];

vals_to_fit[0] = [2.0]; % h1
vals_to_fit[1] = [3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]; % h2
vals_to_fit[2] = [2.2]; % Gamma1
vals_to_fit[3] = [1.7, 1.8, 1.9, 2.0, 2.1]; % Gamma2
vals_to_fit[4] = [1.0]; % Fe
vals_to_fit[5] = [0.0, 1.0, 2.0, 3.0]; % xi
vals_to_fit[6] = [0.0]; % p
vals_to_fit[7] = [1.0]; % b  <-- this should be expanded
vals_to_fit[8] = [0.5]; % q2
vals_to_fit[9] = [50.0, 100.0, 150.0, 200.0, 250.0, 275.0, 300.0, 325.0, 350.0, 375.0, 400.0, 425.0, 450.0, 500.0, 550.0, 600.0]; % t_max (zero doesn't seem to work)
vals_to_fit[10] = [10.0, 20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0]; % t_shift
variable fit_stats;
variable best_fit = NULL;
variable i, j;
variable done = 0;
if (run_fit != 0) {
	% Find best fit to data and calculate error bars on parameters
	% initialise the arrays for storing best chi^2 values for fit parameters
	for (i=0; i<length(pars_to_fit); i++) {
		fit_statistics[i] = Double_Type[length(vals_to_fit[i])];
		for (j=0; j<length(vals_to_fit[i]); j++) {
			fit_statistics[i][j] = 1.0E10; % <-- some maximum value larger than any reasonable value
		}
	}
	do {
		% Set up initial fit parameters
		fit_fun("lag_freq");
		set_par("lag_freq(1).norm", 4.0E-5, 0, 0.0, 1.0E-3); % <-- will need to be some sensible number
		set_par("lag_freq(1).log_mass", 6.3, 0, 6.0, 6.5); % <-- may need to update
		set_par("lag_freq(1).i", 53); % inclination angle
		set_par("lag_freq(1).a", 0.998); % spin
		% Freeze some parameters
		% freeze("lag_freq(1).log_mass");
		freeze("lag_freq(1).i");
		freeze("lag_freq(1).a");
		% set parameter values and freeze the specified parameters
		for (i=0; i<length(pars_to_fit); i++) {
			set_par(sprintf("lag_freq(1).%s", pars_to_fit[i]), vals_to_fit[i][index[i]], 1);
		 	if (debug > 0) {
		 		() = printf("Setting parameter lag_freq(1).%s to %e\n", pars_to_fit[i], vals_to_fit[i][index[i]]);
		 	}
		}
		if (debug > 0) {
			list_par;
			vmessage("About to fit this model");
			% plot_pause;
		}
		% do fit (often just allowing the normalisation to be variable)
		% note that there are some combinations of parameters that do not make sense, in which case we do /not/ want to perform the fit
		variable check_t_max = get_par("lag_freq(1).t_max");
		variable check_t_shift = get_par("lag_freq(1).t_shift");
		variable ok_to_fit = 1;
		if (check_t_shift >= check_t_max) {
			ok_to_fit = 0; % not OK to fit if t_shift is bigger than t_max
			if (debug > 2) vmessage("Skipping fit with t_shift >= t_max");
		}
		if (ok_to_fit != 0) {
			() = fit_counts(&fit_stats);
			if (best_fit == NULL) {
				best_fit = @fit_stats;
				best_fit.statistic = 1.0E10; % <-- to make sure it gets replaced
			}
			% store the statistic if it is the best so far for each parameter
			% this will be used to estimate the error range of each parameter
			for (i=0; i<length(pars_to_fit); i++) {
				if (fit_stats.statistic < fit_statistics[i][index[i]]) {
					fit_statistics[i][index[i]] = fit_stats.statistic;
				}
			}
			if (fit_stats.statistic < best_fit.statistic) {
				best_fit = @fit_stats;
				save_par(obsid + "_best_fit.par");
				variable pid = open_plot(obsid + "_best_fit.ps/cps");
				nice_width;
				plot_data(1, popt);
				%	plot_pause;
				close_plot(pid);
				vmessage("Improved fit...");
				list_par;
				if (debug > 0) {
					list_par;
					vmessage("Found a better fit");
					plot_pause;
				}
			}
		}
		% move on to next parameter combination unless we're gone through them all
		done = 1;
		for (i=0; i<length(pars_to_fit); i++) {
			if (debug > 0) vmessage("i = %i", i);
			if (done == 1)
			{
				% if (debug > 0) vmessage("i = %i index = %i len = %i", i, index[i], length(vals_to_fit[i]));
				index[i] = index[i] + 1;
				if (debug > 0) vmessage("i = %i index = %i len = %i", i, index[i], length(vals_to_fit[i]));
				if (index[i] == length(vals_to_fit[i]))
				{
					index[i] = 0;
				} else {
					done = 0;
				}
			}
		}
	} while (done==0);

	variable fp = fopen(obsid + "_fit_info.txt", "w");
	() = fprintf(fp, "Obsid " + obsid + "\n");
	% The 4 below is because some frozen parameters are stepped through so the actual number of degrees of freedom should be smaller
	% The value will depend on exactly what is being fit
	() = fprintf(fp, "chi^2 = %e / dof = %i\n", best_fit.statistic, best_fit.num_bins - best_fit.num_variable_params - 4);
	() = fprintf(fp, "N.B. dof modified because some frozen parameters are stepped through\n");

	% Now that the fitting is done we can look at the error bars on each parameter
	% Delta chi^2 = 2.706 corresponds to 90% confidence interval for a single parameter
	variable delta_chi;
	% Linearly interpolate to get an estimate of the confidence interval
	for (i=0; i<length(pars_to_fit); i++) {
		variable lo_ix = -1;
		variable hi_ix = -1;
		variable best_ix = -1;
		% vmessage("  -----");
		% vmessage("Parameter " + pars_to_fit[i]);
		for (j=0; j<length(vals_to_fit[i]); j++) {
			delta_chi = fit_statistics[i][j] - best_fit.statistic;
			% at the end of the following
			% lo_ix should point to the lower bound
			% best_ix should point to the best fit and
			% hi_ix should point to the higher bound
			% we can interpolate to guesstimate the error range
			if (delta_chi > 2.706 and best_ix == -1) {
				lo_ix = j;
			}
			if (delta_chi == 0.0) {
				best_ix = j;
			}
			if (delta_chi > 2.706 and best_ix > -1 and hi_ix == -1) {
				hi_ix = j;
			}
			vmessage("Value %e delta statistic %e", vals_to_fit[i][j], delta_chi);
		}
		% estimate error range
		variable lo_val, hi_val, best_val, lambda;
		best_val = vals_to_fit[i][best_ix];
		lo_val = best_val;
		% vmessage("indices are %i, %i, %i", lo_ix, best_ix, hi_ix);
		if (lo_ix >= 0 and lo_ix != best_ix) {
			lambda = (2.706 - (fit_statistics[i][lo_ix+1] - best_fit.statistic))/(fit_statistics[i][lo_ix] - fit_statistics[i][lo_ix+1]);
			% vmessage(" numerator = %e denom = %e", 2.706 - (fit_statistics[i][lo_ix+1] - best_fit.statistic), fit_statistics[i][lo_ix] - fit_statistics[i][lo_ix+1]);
			lo_val = vals_to_fit[i][lo_ix] + lambda * (vals_to_fit[i][lo_ix+1] - vals_to_fit[i][lo_ix]);
			% vmessage("lo = %e lambda = %e", lo_val, lambda);
		}
		hi_val = best_val;
		if (hi_ix >= 0 and hi_ix != best_ix) {
			lambda = (2.706 - (fit_statistics[i][hi_ix-1] - best_fit.statistic))/(fit_statistics[i][hi_ix] - fit_statistics[i][hi_ix-1]);
			hi_val = vals_to_fit[i][hi_ix-1] + lambda * (vals_to_fit[i][hi_ix] - vals_to_fit[i][hi_ix-1]);
			% vmessage("hi = %e lambda = %e", hi_val, lambda);
		}
		vmessage("Parameter %s = %e (+%e -%e)", pars_to_fit[i], best_val, hi_val-best_val, best_val-lo_val);
		() = fprintf(fp, "Parameter %s = %e (+%e -%e)\n", pars_to_fit[i], best_val, hi_val-best_val, best_val-lo_val);
	}

	() = fclose(fp);

} else {
	% Run in interactive mode, e.g., to explore best fit
	load_par(obsid + "_best_fit.par");
	() = eval_counts;

	% re-make a postscript plot of the best fit
	variable pid = open_plot(obsid + "_best_fit.ps/cps");
	_pgsci(1);
	_pgsls(2);
	_pgmove(-4, 0);
	_pgdraw(-1, 0);
	plot_data(1, popt);
	close_plot(pid);
}
#+END_EXAMPLE

** Initial PANDAS visualisations

#+BEGIN_EXAMPLE
import matplotlib.pyplot as plt
import pandas as pd


df= pd.read_csv("AGN_ECM_Results.csv", sep=',')
print (df)

dat = df.drop(["tmax", "Ts"], axis=1)
print (dat)

#+END_EXAMPLE

#+BEGIN_EXAMPLE
#First visualisation
df.set_index("AGN", drop=True, inplace=True)
df.plot.bar(figsize=[12,6])
plt.ylim(0, 50)
plt.savefig("ecm_vis1_included.pdf")
#+END_EXAMPLE


#+BEGIN_EXAMPLE
#Second visualisation
df.plot.barh(stacked=True, figsize=[12,6])
plt.savefig("ecm_vis2_included.png")
#+END_EXAMPLE

#+BEGIN_EXAMPLE
#Third visualisation
dat.set_index("AGN", drop=True, inplace=True)
dat.plot.bar(figsize=[12,6])
plt.title('Extended Corona Results')
plt.ylim(0,40)
plt.savefig("ecm_vis3.pdf")
#+END_EXAMPLE

#+BEGIN_EXAMPLE
#Fourth visualisation
dat.plot.bar(stacked=True, figsize=[12,6])
plt.title('Extended Corona Results')
plt.savefig("ecm_vis4.png")
#+END_EXAMPLE

** ECM Model plotting in Pandas

*Plotting $\Gamma_1$ and $\Gamma_2$*
#+BEGIN_EXAMPLE
import csv
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
plt.style.use('classic')
from astropy.io import fits as pyfits

plt.rcParams['font.family'] = 'serif'
#plt.rcParams['font.serif'] = ['Times New Roman'] + plt.rcParams['font.serif']

# Import csv with pandas and name cloumn headers
cols=['Freq', 'Lag']
df1 = pd.read_csv('gamma020+017-lag.csv', names=cols, header=None)
df2 = pd.read_csv('gamma021+019-lag.csv', names=cols, header=None)
df3 = pd.read_csv('gamma021+020-lag.csv', names=cols, header=None)
df4 = pd.read_csv('gamma021+021-lag.csv', names=cols, header=None)
df5 = pd.read_csv('gamma021+023-lag.csv', names=cols, header=None)
df6 = pd.read_csv('gamma021+025-lag.csv', names=cols, header=None)
df7 = pd.read_csv('gamma021+026-lag.csv', names=cols, header=None)


fig, ax = plt.subplots()
ax = plt.gca()
ax.get_yaxis().set_tick_params(direction='in')
ax.get_xaxis().set_tick_params(direction='in')
ax = plt.axes(xscale='log')

# Plot the data
for frame in [df1, df2, df3, df4, df5, df6, df7]:
    plt.plot(frame['Freq'], frame['Lag'])

plt.xlim(1e-5,1.0)
plt.xscale('log')
figsize=(8,6)
plt.xlabel(r'Frequency $(1/t_g)$', fontsize=14)
plt.ylabel(r'Time Lag $(t_g)$', fontsize=14)
labels = [r'$\Gamma_1 = 2.0, \Gamma_2 = 1.7$','$\Gamma_1 = 2.1, \Gamma_2 = 1.9$','$\Gamma_1 = 2.1, \Gamma_2 = 2.0$','$\Gamma_1 = 2.1, \Gamma_2 = 2.1$', '$\Gamma_1 = 2.1, \Gamma_2 = 2.3$', '$\Gamma_1 = 2.1, \Gamma_2 = 2.5$','$\Gamma_1 = 2.1, \Gamma_2 = 2.6$']
plt.legend(labels, loc='lower right', frameon=False, prop={"family":"serif"}, fontsize=15)
line = ([-1e-5, 1.0], [0,0])
plt.plot(line, linestyle='--', linewidth='0.3', color = 'black')
#plt.show()
fig.savefig('ecm_gamma.png')
plt.savefig('ecm_gamma.pdf')
plt.close()


#+END_EXAMPLE

*Plotting $t_\text{shift}$*

#+BEGIN_EXAMPLE
import csv
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
plt.style.use('classic')
from astropy.io import fits as pyfits


plt.rcParams['font.family'] = 'serif'
plt.rcParams['font.serif'] = ['Times New Roman'] + plt.rcParams['font.serif']

# Import csv with pandas and name cloumn headers
cols=['Freq', 'Lag']
df1 = pd.read_csv('tshift0000-lag.csv', names=cols, header=None)
df2 = pd.read_csv('tshift0020-lag.csv', names=cols, header=None)
df3 = pd.read_csv('tshift0050-lag.csv', names=cols, header=None)
df4 = pd.read_csv('tshift0100-lag.csv', names=cols, header=None)
df5 = pd.read_csv('tshift0125-lag.csv', names=cols, header=None)
df6 = pd.read_csv('tshift0150-lag.csv', names=cols, header=None)

fig, ax = plt.subplots()
ax = plt.gca()
ax.get_yaxis().set_tick_params(direction='in')
ax.get_xaxis().set_tick_params(direction='in')
ax = plt.axes(xscale='log')

# Plot the data
for frame in [df1, df2, df3, df4, df5, df6]:
    plt.plot(frame['Freq'], frame['Lag'])

plt.xlim(1e-5,1.0)
plt.ylim(-50,50.0)
figsize=(8,6)
plt.xlabel(r'Frequency $(1/t_g)$', fontsize=14)
plt.ylabel(r'Time Lag $(t_g)$', fontsize=14)
plt.xscale('log')
labels = [r'$t_{\mathrm{shift}} = 0$', '$t_{\mathrm{shift}} = 20t_g$', '$t_{\mathrm{shift}} = 50t_g$', '$t_{\mathrm{shift}} = 100t_g$', '$t_{\mathrm{shift}} = 125t_g$', '$t_{\mathrm{shift}} = 150t_g$']
plt.legend(labels, loc='lower left', frameon=False, fontsize='16',)
line = ([-1e-5, 1.0], [0,0])
plt.plot(line, linestyle='--', linewidth='0.3', color = 'black')
#plt.show()
fig.savefig('ecm_tshift.png')
plt.savefig('ecm_tshift.pdf')
plt.close()
#+END_EXAMPLE

** EMCEE for ISIS

#+BEGIN_EXAMPLE
% Two blobs model fitting routines for EMCEE following the Mike Nowak REF: https://www.sternwarte.uni-erlangen.de/wiki/index.php/Emcee
% This script includes the fitting routine (written by Andy Young) - fitting the 2 blobs model to a given data set via the best parameter fits found on BlueCrystal
%
% Date: December 2020
%
% Should we run the fit? Non-zero => run fit
variable run_fit = 1;

% Filename prefix for observation identifier
variable obsid = "1H0707_0506200401_fmax";

% Some global variables and paths (update to your own path)
% variable path_to_lags = "/mnt/storage/scratch/phajy/x-ray-reverberation";
% Assumes the lags are in a subdirectory of the current directory
%variable path_to_lags = "/mnt/storage/scratch/so14935/x-ray-rev4/x-ray-reverberation";
variable path_to_lags = "/data/typhon1/reverb";
variable path_to_fits = getcwd;

% load emcee asuming that "isis_emcee.sl" is located in the cwd
require("isis_emcee");
require("isisscripts");

% Debugging - non-zero to output more information
% higher value means more diagnostic information
variable debug = 0;

% Only need to cache the last file read in because the script steps through
% discrete parameter values. The number of parameter combinations has between
% reduced to make this problem tractable. This vastly simplifies the code from
% previous versions and reduces the memory requirements significantly.

variable last_file_used = "";
variable last_lag_used = NULL;

% Lag-frequency fitting function
define lag_freq_fit(lo, hi, par)
{
	variable norm = par[0];
	variable mass = 10.0^par[1];

	variable i = par[2];
	variable a = par[3];
	variable h1 = par[4];
	variable h2 = par[5];
	variable g1 = par[6];
	variable g2 = par[7];
	variable abund = par[8];
	variable xi = par[9];
	variable p = par[10];
	variable b = par[11];
	variable q = par[12];
	variable tmax = par[13];
	variable tshift = par[14];

	% Now we need to generate the appropriate filename and see if it exists
	variable fp;
	variable filename = sprintf("lag-files/i%02.0f/a%05.3f/h%04.1f+%04.1f/g%03.1f+%03.1f/A%04.1f/x%03.1f/p%04.1f/b%04.1f/q%03.1f/tmax%04.0f/tshift%04.0f/lag.fits", i, a, h1, h2, g1, g2, abund, xi, p, b, q, tmax, tshift);
	if (debug>5) vmessage("Using filename %s", filename);

	variable t_g = 492.703806 * (mass / 1.0E8);

	% Read in the lag as a function of frequency
	% Note that units are tg^-1 (freq) and tg (lag)

	variable spec;
	variable ft;
	variable zero = 0;

	% see if we've already loaded in this file
	if (last_file_used == filename) {
		% we have already seen this file
		% retrieve the saved values from memory
		if (debug>5) vmessage("Using cached lag");
		ft = @last_lag_used;
	} else {
		% we need to read in the file
		% check if file exists
		if (debug>1) vmessage("checking " + path_to_lags + "/" + filename);
		fp = fopen(path_to_lags + "/" + filename, "r");
	  if (fp == NULL)
	  {
	  	% file does not exist
	    if (debug>0) vmessage("File %s does not exist so returning zero", filename);
			last_file_used = "";
			last_lag_used = NULL;
	   } else {
	   	() = fclose(fp);

    	if (debug > 0) vmessage("Reading file %s", filename);
			ft = fits_read_table(path_to_lags + "/" + filename);
			last_file_used = filename;
			last_lag_used = @ft;

			% Check for NaN which indicates a problem
			variable cn = where(isnan(ft.lag) == 1);
			if (length(cn)>0) {
				vmessage("File %s has NaN in it (%i).", filename, length(cn));
				plot_pause;
			} else {
				if (debug > 5) vmessage("Files %s is good.", filename);
			}
		}
	}

	if (last_file_used != "") {
		% Shift all of the frequency bins
		variable fq = ft.fq / t_g;

		% Scale all time lags
		variable lag = ft.lag * t_g;

		% Overall normalizaton (which accounts for dilution, etc.)
		lag = lag * norm;

		% Frequency should now be in units of Hz
		% Lag should now be in units of seconds

		spec = rebin(lo, hi, _A(fq), _A(make_hi_grid(fq)), reverse(lag));

		% Check for NaN which indicates a problem
		cn = where(isnan(spec)==1);
		if (length(cn)>0) {
			vmessage("Spectrum from file %s has NaN in it.", filename);
			plot_pause;
		}

	} else {
		spec = Double_Type[length(lo)];
	}

	return(spec);
}

% New version will be:
add_slang_function("lag_freq", ["norm", "log_mass", "i", "a", "h1", "h2", "Gamma1", "Gamma2", "Fe", "xi", "p", "b", "q2", "t_max", "t_shift"]);

% Load the data.
Ignore_PHA_Response_Keywords = 1;
variable d = load_data("/data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-OBS-0506200401-time-lags-segs.fits");
variable r = load_rmf("/data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-OBS-0506200401-time-lags-segs.rsp");
assign_rmf(r, d);

%load_par("1H0707_0506200401_A_best_fit.par");
load_par("1H0707_0506200401_fmax_best_fit.par");
Label_By_Default = 0;
popt.xlabel="Frequency (Hz)";
popt.ylabel="Time lag (s)";
popt.yrange=[-500, 1800];
popt.xrange=[6e-5, 0.01];
%xlog;

% Instead of using fit_fun, run the emcee sampler for 500 walkers and 1000 iterations
emcee(500, 10000; output="1H0707_0506200401_fmax_chain.fits", serial);

% Read the chain-file
(nw, nfreepar, freepar, chain_statistic, chain) = read_chain("1H0707_0506200401_fmax_chain.fits");

close_plot; % start with a fresh plot window
_for i (0, nw-1, 1) { % loop over all walkers and plot their path
  chain_plot(1,i, nw, chain; oplot);
};

% Make good image of the paths of the walkers
variable pid = open_plot("1H0707_0506200401_fmax_walkers.ps/cps");
charsize(1.3); %good font size
_pgscf(2); %make font roman
chain_plot(1,i,nw,chain);
close_plot(pid);


% Obtain acceptance Rate
frac_update = read_chain("1H0707_0506200401_fmax_chain_500_5000.fits"; frac_update);
xlabel("Iteration Step");
ylabel("Acceptance Rate");
popt.dsym = [6];
popt.dcol = 4;
plot([0:length(frac_update)-1], frac_update);
plot(([0:length(frac_update)-1], frac_update); dsym=6, dcol=2);

% Make good image of the acceptance Rate
variable pid = open_plot("1H0707_0506200401_fmax_mass_accept_rate.ps/cps");
charsize(1.3); %good font size
_pgscf(2); %make font roman
xlabel("Iteration Step");
ylabel("Acceptance Rate");
plot([0:length(frac_update)-1], frac_update);
close_plot(pid);

% Obtain the probability distributions of the norm
chain_hist(0, chain; fcut = .3, pmin = 0, pmax = 0.001, nbin = 200); % norm

% Make good image of the Norm probability
variable pid = open_plot("1H0707_0506200401_fmax_norm_prob.ps/cps");
charsize(1.3); %good font size
_pgscf(2); %make font roman
chain_hist(0,chain; fcut = .3,min = 0, pmax = 0.001);
close_plot(pid);

% Obtain the probability distributions of the log_mass
chain_hist(1, chain; fcut = .3, pmin = 5, pmax = 7, nbin = 200); % log_mass

% Make good image of the Mass probability
variable pid = open_plot("1H0707_0506200401_fmax_mass_prob.ps/cps");
charsize(1.3); %good font size
_pgscf(2); %make font roman
chain_hist(1,chain; fcut = .3,min = 5.5, pmax = 6.5);
close_plot(pid);

% Contours: paths in 2D
%where 1 = x and 0 = y axis parameters
chain_hist2d(1, 0, chain; nbinx = 200, nbiny = 200);

%Make good image of the Contours
variable pid = open_plot("1H0707_0506200401_fmax_chain_hist2d.ps/cps");
charsize(1.3); %good font size
_pgscf(2); %make font roman
chain_hist2d(1,0,chain; nbinx = 200, nbiny = 200);
close_plot(pid);

(frac_update, min_statistic, med_statistic, max_statistic) = read_chain("1H0707_0506200401_fmax_chain.fits"; chain_stats);

% Chain statistics starting at s=iteration where the fit converged
s=600; % start at this iteration step
min(min_statistic[[s:]]);

% Plot the statistic array
n=length(max_statistic)-1;
yrange(min(min_statistic[[s:]])*.9, max(max_statistic[[s:]])*1.1);
variable pid = open_plot("1H0707_0506200401_fmax_statistics.ps/cps");
charsize(1.3); %good font size
_pgscf(2); %make font roman
plot([s:n], min_statistic[[600:]]);
oplot([s:n], max_statistic[[600:]]);
oplot([s:n], med_statistic[[600:]]);
close_plot(pid);


% Error analysis

variable p = 1; % index of the parameter of interest (here: norm(0))
variable lvl = .68; % confidence interval to find
variable fcut = .2; % throw away the first fcut-fraction of the chain
variable nbins = 200; % number of histogram bins
chain_hist(p, chain; fcut = fcut, nbin = nbins);
%close_plot;

variable pmin, pmax;
(pmin,pmax,,) = cursor_box();

pmin;
pmax;

% histogram to get the parameter's probability distribution

variable lo, hi;
(lo, hi) = linear_grid(pmin, pmax, nbins);
variable hist = 1.*histogram(chain[p], lo, hi);

% find maximum
variable nmax = where_max(hist)[0];

% do a linear regression of the first and last n bins
variable n = 10;
variable ind = [[0:n-1], [nbins-n:nbins-1]];

% linear regression
variable lin = linear_regression(0.5*(lo+hi)[ind], hist[ind]);

% subtract the linear continuum from the probability distribution
variable newhist = hist - (lin.a + lin.b*.5*(lo+hi));

% finally, normalize!
newhist /= sum(newhist);

% Determine confidence interval
variable li = [:nmax], ri = [nmax+1:];
variable conf_min = lo[li][wherefirst(cumsum(newhist[li]) > .5 - .5*lvl)];
variable conf_max = hi[ri][wherefirst(cumsum(newhist[ri]) > .5*lvl)];
variable conf_mean = conf_min + ((conf_max - conf_min) / 2);
conf_min;
conf_max;
conf_mean;


% Plot the parameter with conf regions
variable pid = open_plot("1H0707_0506200401_fmax_logmass_conf68.ps/cps");
chain_hist(1, chain; fcut = fcut, nbin = nbins, pmin=pmin, pmax=pmax);
_pgmove(conf_min, 0);
_pgsls(2); % line style
_pgsci(1); % line color
_pgslw(1); % line width
_pgdraw(conf_min, 100);

_pgmove(conf_max, 0);
_pgsls(2);
_pgsci(1);
_pgslw(1);
_pgdraw(conf_max, 100);

_pgmove(conf_mean, 0);
_pgsls(1);
_pgsci(4);
_pgslw(2);
_pgdraw(conf_mean, 100);

%close_plot;
charsize(1.3); %good font size
_pgscf(2); %make font roman
close_plot(pid);



#+END_EXAMPLE
** Table Model

*** Fitting code

#+BEGIN_EXAMPLE
% Two blobs model fitting routines
% Uses the new table model and emcee fitting
% Note that the table model uses bin integrated quantities
%
% Author: Andy Young
% Date: 2021-01

% Load the data.
Ignore_PHA_Response_Keywords = 1;
variable d = load_data("/data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-comb-time-lags-fmax.fits");
variable r = load_rmf("/data/typhon1/reverb/1H0707-495/1H0707-495-time-lag-fits/1H0707-495-comb-time-lags-fmax.rsp");
assign_rmf(r, d);

% Read in the table model
add_atable_model("tab_rev_comb.mod", "tab_rev");
%reverb_params = get_fun_params("tab_rev_comb(1)");

% Read in the default frequency binning ("energy" bcause it is a table model)
variable energy_grid = fits_read_table("tab_rev_comb.mod[2]");

% Here are the model parameters (from an example table model)
%idx  param            tie-to  freeze         value         min         max
% 1  tab_rev(1).norm       0     0                1           0       1e+10
% 2  tab_rev(1).h1         0     0                2           2           2
% 3  tab_rev(1).h2         0     0                6           3           8
% 4  tab_rev(1).i          0     0               53          53          53
% 5  tab_rev(1).gamma1     0     0              2.5         2.4         2.8
% 6  tab_rev(1).gamma2     0     0              2.6         2.4         2.6
% 7  tab_rev(1).A          0     0                1           1           1
% 8  tab_rev(1).xi         0     0                1           0           1
% 9  tab_rev(1).p          0     0                0           0           0
%10  tab_rev(1).r1         0     0                1           1           1
%11  tab_rev(1).r2         0     0                1           1           1
%12  tab_rev(1).b          0     0                2           2           2
%13  tab_rev(1).q2         0     0              0.5         0.5         0.5
%14  tab_rev(1).tmax       0     0              100         100         200
%15  tab_rev(1).tshift     0     0               70          10         100

% Lag-frequency fitting function
% Note this makes use of the table model
define lag_freq_fit(lo, hi, par)
{
	variable norm = par[0];
	variable mass = 10.0^par[1];

	variable i = par[2];
	variable a = par[3];
	variable h1 = par[4];
	variable h2 = par[5];
	variable g1 = par[6];
	variable g2 = par[7];
	variable abund = par[8];
	variable xi = par[9];
	variable p = par[10];
	variable b = par[11];
	variable q = par[12];
	variable tmax = par[13];
	variable tshift = par[14];

	variable t_g = 492.703806 * (mass / 1.0E8);

	% Read in the lag as a function of frequency
	% Note that units are tg^-1 (freq) and tg (lag)

	variable fq_lo = @energy_grid.energ_lo;
	variable fq_hi = @energy_grid.energ_hi;

	% Shift frequencies to convert t_g -> seconds
	vmessage("t_g = %e", t_g);
	fq_lo = fq_lo / t_g;
	fq_hi = fq_hi / t_g;

  variable parameters = [norm, h1, h2, i, g1, g2, abund, xi, p, 1.0, 1.0, b, q, tmax, tshift];

	% Note that because of how the model is currently encoded we want this energy binning to match precisely the model binning
	% eval_fun returns bin integrated quantities
	variable lags = eval_fun2("tab_rev", _A(energy_grid.energ_hi), _A(energy_grid.energ_lo), parameters);
	% lags = reverse(lags); % <-- shouldn't need this
	% Scale all time lags
	% We need to account for the fact that the bin widths change too and we're looking at bin integrated quantities
	% The bin widths change by a factor of 1 / t_g
	% so we don't need the following scaling
	% lags = lags * t_g;
	% Frequency should now be in units of Hz
	% Lag should now be in units of seconds but integrated over bin width
	% rebin assumes quantities are bin integrated
	% variable x = lags * (_A(fq_lo) - _A(fq_hi));
	variable spec = rebin(lo, hi, _A(fq_hi), _A(fq_lo), lags);
	% variable spec = new_x / (hi - lo);
	return(spec);
}
% New version will be:
add_slang_function("lag_freq", ["norm", "log_mass", "i", "a", "h1", "h2", "Gamma1", "Gamma2", "Fe", "xi", "p", "b", "q2", "t_max", "t_shift"]);
% "Dummy" function that just returns zero
% Other models can use this as a parameter
define dummy_fit(lo, hi, par)
{
	return(0.0);
}
add_slang_function("dummy", ["a"]);


% Plot the data and model
open_plot("1H0707-495_tm_comb.gif/gif");
title ("1H0707-495 Combined ECM-TM");
Label_By_Default = 0;
popt.xlabel="Frequency (Hz)";
popt.ylabel="Time lag (s)";
xlog;
popt.yrange=[-50, 200];
popt.xrange=[6e-5, 0.01];
charsize(1.15);
load_par("conf_comb.par");
%set_par(14, 140, 1, 100, 600); % set par 14 to 140, freeze, range 100 - 600
() = fit_counts;
() = eval_counts;

% Define variables to overplot the lag-file
% Comment this section out during the fitting routine
variable raw_lag = fits_read_table("/data/typhon1/reverb/lag-files/i53/a0.998/h02.0+03.0/g2.4+1.9/A01.0/x0.0/p00.0/b03.0/q0.5/tmax0350/tshift0010/lag.fits");
variable mass = 10.0^6.222582;
variable t_g = 492.703806 * (mass / 1.0E8);
variable scaled_lag = @raw_lag;
scaled_lag.fq = scaled_lag.fq / t_g;
scaled_lag.lag = scaled_lag.lag * t_g;

plot_data(1, popt);
oplot(scaled_lag.fq, scaled_lag.lag);
_pgscf(2); %make font roman
_pgsci(1);
_pgsls(2);
_pgmove(-5, 0);
_pgdraw(-1, 0);
list_par;
list_data;
close_plot;

% source("confidence.sl");
% .source("fit-table-model-comb.sl");

%variable pid = open_plot(1H0707-495_Comb_fmax_ECM_TM);
%charsize(1.3); %good font size
%nice_width; %good line ratios
%_pgscf(2); %make font roman
%plot_data(1, popt);
%close_plot(pid);


% Testing
% q = eval_fun(_A(energy_grid.energ_hi),_A(energy_grid.energ_lo));
% hplot(energy_grid.energ_lo, energy_grid.energ_hi, reverse(q));
#+END_EXAMPLE

* S-Language

https://www.jedsoft.org/slang/docs.html

To initiate in a termial

#+BEGIN_EXAMPLE
slsh
#+END_EXAMPLE

Or run an example in isis

use data in =/data/scratch3/steff/1H0707-495/0110890201/PROC=

#+BEGIN_EXAMPLE
require ("fits");
require ("histogram");
tbl = fits_read_table ("EPIC_clean.fits");
engrid = [min(tbl.energy):max(energy):#1024];
spectrum = hist1d (tbl.energy[where(tbl.status==0)], engrid);

#+END_EXAMPLE

* Nano

Basic guide to nano

https://wiki.gentoo.org/wiki/Nano/Basics_Guide

 Veusz

Veusz has been downloaded and installed on anaconda by

#+BEGIN_EXAMPLE
conda install -c conda-forge veusz
#+END_EXAMPLE

And can now be run via a terminal
#+BEGIN_EXAMPLE
~/anaconda3/bin/veusz
#+END_EXAMPLE

All images and Veusz files are saved in the =/homeb/steff075/graphs= directory

Also see https://veusz.github.io/docs/manual/api.html#using-veusz-from-other-programs

* XSTAR

*Plot Spectra using relxill*warmabs* *(USE MENSA !!)*

Using Xstar model warmab, more information about the warm absorber model can be found on-line

 https://heasarc.gsfc.nasa.gov/xanadu/xspec/models/xstar.html

 https://heasarc.gsfc.nasa.gov/docs/software/lheasoft/xstar/xstar.html

#+BEGIN_EXAMPLE

First initiate heasoft:

heainit
isis
require("xspec");
load_xspec_local_models("/data/scratch4/ayoung/xspec-local-models/relxill", "relxill");
load_xspec_local_models("/homeb/steff075/xspec_models/warmabs", "xstarmod");
fit_fun("warmabs*relxill");

        For Xspec load model using command:
        initpackage xstarmod lmodel_warmabs.dat /homeb/steff075/xspec_models/warmabs
        lmod xstarmod /homeb/steff075/xspec_models/warmabs

Model parameters
warmabs*relxill
 idx  param                 tie-to  freeze         value         min         max
  1  warmabs(1).column          0     0                0          -3           2  cm^-2
  2  warmabs(1).rlogxi          0     0                0          -4           5
  3  warmabs(1).Cabund          0     1                1           0        1000
  4  warmabs(1).Nabund          0     1                1           0        1000
  5  warmabs(1).Oabund          0     1                1           0        1000
  6  warmabs(1).Fabund          0     1                1           0        1000
  7  warmabs(1).Neabund         0     1                1           0        1000
  8  warmabs(1).Naabund         0     1                1           0        1000
  9  warmabs(1).Mgabund         0     1                1           0        1000
 10  warmabs(1).Alabund         0     1                1           0        1000
 11  warmabs(1).Siabund         0     1                1           0        1000
 12  warmabs(1).Pabund          0     1                1           0        1000
 13  warmabs(1).Sabund          0     1                1           0        1000
 14  warmabs(1).Clabund         0     1                1           0        1000
 15  warmabs(1).Arabund         0     1                1           0        1000
 16  warmabs(1).Kabund          0     1                1           0        1000
 17  warmabs(1).Caabund         0     1                1           0        1000
 18  warmabs(1).Scabund         0     1                1           0        1000
 19  warmabs(1).Tiabund         0     1                1           0        1000
 20  warmabs(1).Vabund          0     1                1           0        1000
 21  warmabs(1).Crabund         0     1                1           0        1000
 22  warmabs(1).Mnabund         0     1                1           0        1000
 23  warmabs(1).Feabund         0     1                1           0        1000
 24  warmabs(1).Coabund         0     1                1           0        1000
 25  warmabs(1).Niabund         0     1                1           0        1000
 26  warmabs(1).Cuabund         0     1                1           0        1000
 27  warmabs(1).Znabund         0     1                1           0        1000
 28  warmabs(1).write_outfile   0     1                1           0           1
 29  warmabs(1).outfile_idx     0     1                0           0       10000
 30  warmabs(1).vturb           0     1                0           0       10000  km/s
 31  warmabs(1).Redshift        0     1                0           0          10
 32  relxill(1).norm            0     0                1           0       1e+10
 33  relxill(1).Index1          0     1                3         -10          10
 34  relxill(1).Index2          0     1                3         -10          10
 35  relxill(1).Rbr             0     1               15           1         400
 36  relxill(1).a               0     0            0.998      -0.998       0.998
 37  relxill(1).Incl            0     1               30           5          80  deg
 38  relxill(1).Rin             0     1               -1        -100          -1
 39  relxill(1).Rout            0     1              400           1         400
 40  relxill(1).z               0     1                0           0          10
 41  relxill(1).gamma           0     0                2           1         3.4
 42  relxill(1).logxi           0     0              3.1           0         4.7
 43  relxill(1).Afe             0     0                1         0.5          10
 44  relxill(1).Ecut            0     1              300           5        1000  keV
 45  relxill(1).refl_frac       0     0                3           0          10
#+END_EXAMPLE
